{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_21", "train_show_freq": 200, "droprate": 0.320479210286747, "droprate_2": 0.0, "lr": 1.0310601609687267e-05, "weight_decay": 3.937957162810635e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_21", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0310601609687267e-05
epoch: 0 idx: 0 First Loss : 1.236645221710205, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0539095843609292, Second Loss : 1.036695332076419
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6623288439955106
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748989898989899
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6033705663335293
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6071428571428571
Test AUC: 0.6071, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0310601609687267e-05
epoch: 1 idx: 0 First Loss : 1.9789005517959595, Second Loss : 1.915989637374878
epoch: 1 idx: 200 First Loss : 1.1014871348196, Second Loss : 1.0888333737257108
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7058473625140292
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7580808080808081
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6467641583382324
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6569664902998236
Test AUC: 0.6570, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0310601609687267e-05
epoch: 2 idx: 0 First Loss : 2.1295278072357178, Second Loss : 2.0784430503845215
epoch: 2 idx: 200 First Loss : 1.1010672622800466, Second Loss : 1.086653889189312
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.721290684624018
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7636868686868686
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.675662600431119
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6928461199294532
Test AUC: 0.6928, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0310601609687267e-05
epoch: 3 idx: 0 First Loss : 2.197479009628296, Second Loss : 2.1403064727783203
epoch: 3 idx: 200 First Loss : 1.0907984596135012, Second Loss : 1.0761372782845995
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7320931537598204
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7677777777777778
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6926930237115423
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703042328042328
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 4 idx: 0 First Loss : 2.2755286693573, Second Loss : 2.203848361968994
epoch: 4 idx: 200 First Loss : 1.080567504117145, Second Loss : 1.0653781635102941
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410157126823793
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7042793454830493
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075066137566136
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 5 idx: 0 First Loss : 2.357867956161499, Second Loss : 2.275451421737671
epoch: 5 idx: 200 First Loss : 1.0702015926218151, Second Loss : 1.0552005155095414
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7403928170594837
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7524747474747474
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7124056927297667
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7124118165784833
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 6 idx: 0 First Loss : 2.4492709636688232, Second Loss : 2.348583221435547
epoch: 6 idx: 200 First Loss : 1.0582747235523529, Second Loss : 1.0434165811212501
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5555555555555556, precision 0.513189448441247, recall 0.38383838383838387, F1 0.3213641580586981, AUC 0.7387654320987654
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7514141414141413
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7132630315500686
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7115299823633157
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 7 idx: 0 First Loss : 2.547184944152832, Second Loss : 2.429486036300659
epoch: 7 idx: 200 First Loss : 1.0435577048665254, Second Loss : 1.0296188373100106
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.3907450980392157, recall 0.4254545454545455, F1 0.37666666666666665, AUC 0.7373961840628507
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7539898989898989
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6190476190476191, precision 0.7094290452499408, recall 0.44841269841269843, F1 0.4357506043177461, AUC 0.7075494806976289
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7087191358024691
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 8 idx: 0 First Loss : 2.664771795272827, Second Loss : 2.5231447219848633
epoch: 8 idx: 200 First Loss : 1.0276409388700527, Second Loss : 1.0147564899343162
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6597222222222222, precision 0.5964401294498382, recall 0.5554545454545454, F1 0.5194190035564787, AUC 0.7368237934904602
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.756010101010101
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6394557823129252, precision 0.6417989417989417, recall 0.5695179306290418, F1 0.5871619420006516, AUC 0.7013582696453066
  Second-Tier acc 0.5714285714285714, precision 0.5187499999999999, recall 0.4437830687830688, F1 0.44188583674264564, AUC 0.7071759259259259
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 9 idx: 0 First Loss : 2.785846471786499, Second Loss : 2.625171422958374
epoch: 9 idx: 200 First Loss : 1.0122028908029717, Second Loss : 1.0003160171173697
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6527777777777778, precision 0.6017543366940957, recall 0.5886868686868686, F1 0.58471959519537, AUC 0.7332996632996633
  Second-Tier acc 0.6458333333333334, precision 0.41798941798941797, recall 0.583030303030303, F1 0.4775641025641026, AUC 0.7568686868686868
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5986394557823129, precision 0.5587592200495427, recall 0.5851704879482656, F1 0.5685053297956523, AUC 0.704248726239467
  Second-Tier acc 0.6122448979591837, precision 0.5543133195307108, recall 0.5551146384479718, F1 0.5387545787545788, AUC 0.7141203703703703
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 10 idx: 0 First Loss : 2.9061639308929443, Second Loss : 2.733963966369629
epoch: 10 idx: 200 First Loss : 0.9978553846070719, Second Loss : 0.987155775414474
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6111111111111112, precision 0.5866749345459557, recall 0.6045117845117846, F1 0.5883353502756489, AUC 0.7314309764309764
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7528282828282827
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5782312925170068, precision 0.5430729477241104, recall 0.5825984714873603, F1 0.5499192066476515, AUC 0.7064471879286695
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.7254188712522046
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0310601609687267e-05
epoch: 11 idx: 0 First Loss : 3.0276238918304443, Second Loss : 2.84464693069458
epoch: 11 idx: 200 First Loss : 0.985186132106615, Second Loss : 0.975735409639368
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5625, precision 0.5532212885154062, recall 0.5669023569023569, F1 0.5442875387702973, AUC 0.7309147025813693
  Second-Tier acc 0.5, precision 0.5846394984326019, recall 0.5474747474747474, F1 0.4851851851851852, AUC 0.7720202020202019
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5034013605442177, precision 0.49178776381109707, recall 0.53777189888301, F1 0.481627158326017, AUC 0.7133242700372331
  Second-Tier acc 0.6122448979591837, precision 0.6240079365079366, recall 0.6902557319223986, F1 0.625359911406423, AUC 0.7430555555555557
Test AUC: 0.7431, Test F1: 0.6254 (Best Epoch: 11)
Current LR: 1.0310601609687267e-05
epoch: 12 idx: 0 First Loss : 3.1426303386688232, Second Loss : 2.9534082412719727
epoch: 12 idx: 200 First Loss : 0.9747022483312521, Second Loss : 0.9665654455288429
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5, precision 0.5335047529998441, recall 0.5356902356902357, F1 0.4920720255259134, AUC 0.7357912457912458
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.7819696969696969
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46258503401360546, precision 0.49267040149393093, recall 0.5266754850088183, F1 0.45484685565330724, AUC 0.7171945424260239
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.753968253968254
Test AUC: 0.7540, Test F1: 0.5624 (Best Epoch: 12)
Current LR: 1.0310601609687267e-05
epoch: 13 idx: 0 First Loss : 3.2484130859375, Second Loss : 3.0530989170074463
epoch: 13 idx: 200 First Loss : 0.9661359862790475, Second Loss : 0.9590718098985616
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4583333333333333, precision 0.5003367003367004, recall 0.4920538720538721, F1 0.44771241830065356, AUC 0.7396127946127947
  Second-Tier acc 0.4791666666666667, precision 0.5527065527065527, recall 0.5485858585858586, F1 0.4703762586115527, AUC 0.7965656565656566
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4557823129251701, precision 0.4891636141636142, recall 0.5225602586713697, F1 0.4495862884160757, AUC 0.7210035763276504
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7615189594356262
Test AUC: 0.7615, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0310601609687267e-05
epoch: 14 idx: 0 First Loss : 3.3453896045684814, Second Loss : 3.141371726989746
epoch: 14 idx: 200 First Loss : 0.9593838114726974, Second Loss : 0.953128600062163
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4583333333333333, precision 0.5206896551724137, recall 0.5033670033670034, F1 0.4523554996834253, AUC 0.7473961840628508
  Second-Tier acc 0.5, precision 0.5685185185185185, recall 0.5763636363636363, F1 0.49548708372237776, AUC 0.8029292929292929
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.49692270266982913, recall 0.52608759553204, F1 0.44905982905982905, AUC 0.7248432294728592
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7730379188712523
Test AUC: 0.7730, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0310601609687267e-05
epoch: 15 idx: 0 First Loss : 3.4302308559417725, Second Loss : 3.2214431762695312
epoch: 15 idx: 200 First Loss : 0.9536892181790587, Second Loss : 0.9482488429952246
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4513888888888889, precision 0.5236553030303029, recall 0.5150505050505051, F1 0.4487878787878788, AUC 0.7473288439955107
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333332, recall 0.563030303030303, F1 0.47474747474747475, AUC 0.8174242424242424
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.49937179678558996, recall 0.5219723691945913, F1 0.44207602339181284, AUC 0.7301219870664314
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7744708994708995
Test AUC: 0.7745, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0310601609687267e-05
epoch: 16 idx: 0 First Loss : 3.5020768642425537, Second Loss : 3.291327476501465
epoch: 16 idx: 200 First Loss : 0.9487191315842283, Second Loss : 0.944003183732912
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4513888888888889, precision 0.5381246535202344, recall 0.5215488215488215, F1 0.4513617503739084, AUC 0.7510157126823794
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8148484848484848
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5336860670194004, recall 0.5496031746031745, F1 0.46423786423786423, AUC 0.7325592788555751
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7762896825396824
Test AUC: 0.7745, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0310601609687267e-05
epoch: 17 idx: 0 First Loss : 3.5619688034057617, Second Loss : 3.3485922813415527
epoch: 17 idx: 200 First Loss : 0.9442211792813567, Second Loss : 0.94021462443382
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4583333333333333, precision 0.5468981311086575, recall 0.5381481481481482, F1 0.45945552591949096, AUC 0.7543658810325478
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8158080808080808
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.47619047619047616, precision 0.5674606562508894, recall 0.5731187536743092, F1 0.47784116195331144, AUC 0.7354558592984519
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7770612874779541
Test AUC: 0.7745, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0310601609687267e-05
epoch: 18 idx: 0 First Loss : 3.6127331256866455, Second Loss : 3.395838975906372
epoch: 18 idx: 200 First Loss : 0.9398680455120865, Second Loss : 0.9366242273997941
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.5359083795703514, recall 0.5313131313131313, F1 0.43719721139075984, AUC 0.7551346801346801
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8172727272727273
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4557823129251701, precision 0.5610058218753872, recall 0.5607730746619636, F1 0.45973909131803864, AUC 0.738995443856555
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7798170194003528
Test AUC: 0.7745, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0310601609687267e-05
epoch: 19 idx: 0 First Loss : 3.6520769596099854, Second Loss : 3.433091163635254
epoch: 19 idx: 200 First Loss : 0.9356394023958835, Second Loss : 0.9330729561283332
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4513888888888889, precision 0.5495321637426901, recall 0.5523569023569024, F1 0.45095907004274, AUC 0.7579180695847363
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8180808080808081
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.47619047619047616, precision 0.593482905982906, recall 0.5884038800705467, F1 0.4798474945533769, AUC 0.7419165196942975
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7845568783068785
Test AUC: 0.7846, Test F1: 0.4990 (Best Epoch: 19)