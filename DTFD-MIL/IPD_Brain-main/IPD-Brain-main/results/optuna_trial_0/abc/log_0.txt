{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.23528713869414652, "droprate_2": 0.0, "lr": 0.00010808282660622988, "weight_decay": 5.5870614795922917e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "disable_writer": true}{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4234403757087817, "droprate_2": 0.0, "lr": 0.00039822621487680803, "weight_decay": 0.00015783824975998856, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.2858922850804744, "droprate_2": 0.0, "lr": 4.704763739117484e-05, "weight_decay": 2.076165712628168e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available", "disable_writer": true}{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.32326735320128447, "droprate_2": 0.0, "lr": 5.0271745062140924e-05, "weight_decay": 6.616204742020689e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4742565602758537, "droprate_2": 0.0, "lr": 7.836573140256166e-05, "weight_decay": 0.0008167612255074853, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4700000560364926, "droprate_2": 0.0, "lr": 1.840148889904197e-05, "weight_decay": 4.206728239547461e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.840148889904197e-05{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.32013927182101465, "droprate_2": 0.0, "lr": 1.2597532804412108e-05, "weight_decay": 0.00010223719259177829, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.2597532804412108e-05{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 2, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 384, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.20385602191692953, "droprate_2": 0.0, "lr": 1.8990117649870046e-05, "weight_decay": 0.00016273669529867437, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.8990117649870046e-05{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "datasets/splits.csv", "dataset_csv": "datasets/IPD_Brain.csv", "num_cls": 3, "data_dir": "datasets/features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.37076959811185894, "droprate_2": 0.0, "lr": 4.0712702242819e-05, "weight_decay": 0.0009524709609379471, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "datasets/splits.csv", "disable_writer": true}{"name": "abc", "label_col": "label", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.37999325221141467, "droprate_2": 0.0, "lr": 8.54838571792669e-05, "weight_decay": 1.3943698174053112e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4758910781766805, "droprate_2": 0.0, "lr": 1.4387744454969407e-05, "weight_decay": 0.0005447716154610108, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.4387744454969407e-05
epoch: 0 idx: 0 First Loss : 0.978469967842102, Second Loss : 1.0503250360488892
epoch: 0 idx: 200 First Loss : 1.0544141674812753, Second Loss : 1.068055897358045
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49037563131313133
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5046969696969698
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.447145061728395
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4484126984126984
 
 test auc: 0.4484126984126984, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.4387744454969407e-05
epoch: 1 idx: 0 First Loss : 1.7294318675994873, Second Loss : 1.924170970916748
epoch: 1 idx: 200 First Loss : 1.0894633754717178, Second Loss : 1.1023857860422845
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49236426767676766
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5064646464646465
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45330756723985893
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43623236331569665
 
 test auc: 0.43623236331569665, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 1.4387744454969407e-05
epoch: 2 idx: 0 First Loss : 1.728027105331421, Second Loss : 1.9783539772033691
epoch: 2 idx: 200 First Loss : 1.0661072949716701, Second Loss : 1.0837818840101583
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4952683080808081
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5155050505050505
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45362447641093473
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4360670194003527
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 3 idx: 0 First Loss : 1.7180637121200562, Second Loss : 2.0114095211029053
epoch: 3 idx: 200 First Loss : 1.0462411641333234, Second Loss : 1.065899898830931
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4971559343434344
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5092929292929292
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4563216490299824
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4392636684303351
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 4 idx: 0 First Loss : 1.7185959815979004, Second Loss : 2.042912721633911
epoch: 4 idx: 200 First Loss : 1.0299568059877378, Second Loss : 1.0500134861291344
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49717803030303026
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4996969696969697
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45819899140211645
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44934964726631393
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 5 idx: 0 First Loss : 1.7241923809051514, Second Loss : 2.081040859222412
epoch: 5 idx: 200 First Loss : 1.0161011762064487, Second Loss : 1.0366119128554614
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4983491161616162
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5044949494949494
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46251515652557323
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45425485008818334
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 6 idx: 0 First Loss : 1.7409849166870117, Second Loss : 2.1191017627716064
epoch: 6 idx: 200 First Loss : 1.002832714968653, Second Loss : 1.024593779103673
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4961837121212122
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.4978282828282828
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46706211419753085
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.46164021164021163
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 7 idx: 0 First Loss : 1.7647745609283447, Second Loss : 2.1650753021240234
epoch: 7 idx: 200 First Loss : 0.9904547734417726, Second Loss : 1.013243969363063
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.296875, precision 0.36481481481481487, recall 0.4021464646464646, F1 0.25647451963241436, AUC 0.4921148989898991
  Second-Tier acc 0.3125, precision 0.30952380952380953, recall 0.42676767676767674, F1 0.2926652142338417, AUC 0.4899494949494949
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.29591836734693877, precision 0.4310645724258289, recall 0.3541666666666667, F1 0.19036278479002935, AUC 0.4737206514550265
  Second-Tier acc 0.2653061224489796, precision 0.09629629629629628, recall 0.30952380952380953, F1 0.14689265536723164, AUC 0.4623015873015872
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 8 idx: 0 First Loss : 1.7876288890838623, Second Loss : 2.2105138301849365
epoch: 8 idx: 200 First Loss : 0.9779361102044286, Second Loss : 1.002170839416447
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2760416666666667, precision 0.25060309351497095, recall 0.37752525252525254, F1 0.2576212220047836, AUC 0.484804292929293
  Second-Tier acc 0.2708333333333333, precision 0.24166666666666667, recall 0.37121212121212127, F1 0.2557354925775978, AUC 0.4859090909090909
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.28061224489795916, precision 0.3943903318903319, recall 0.34683641975308643, F1 0.23398837682108042, AUC 0.48506393298059963
  Second-Tier acc 0.22448979591836735, precision 0.08730158730158731, recall 0.2619047619047619, F1 0.13095238095238096, AUC 0.4791666666666667
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 9 idx: 0 First Loss : 1.8092689514160156, Second Loss : 2.2558324337005615
epoch: 9 idx: 200 First Loss : 0.9666257335327157, Second Loss : 0.9915221432844797
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2760416666666667, precision 0.25552264593360485, recall 0.3806818181818182, F1 0.2780111153536125, AUC 0.4826893939393939
  Second-Tier acc 0.3333333333333333, precision 0.2813186813186813, recall 0.4646464646464647, F1 0.33569739952718675, AUC 0.4743434343434343
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3112244897959184, precision 0.4277963131466316, recall 0.4112654320987654, F1 0.34396185900935333, AUC 0.49835345017636684
  Second-Tier acc 0.24489795918367346, precision 0.1714285714285714, recall 0.23985890652557318, F1 0.17388418782147005, AUC 0.49272486772486773
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 10 idx: 0 First Loss : 1.829401969909668, Second Loss : 2.2978405952453613
epoch: 10 idx: 200 First Loss : 0.9544794507584169, Second Loss : 0.9805467347452297
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.296875, precision 0.28113553113553114, recall 0.41053030303030297, F1 0.31068511796733206, AUC 0.4807102272727272
  Second-Tier acc 0.3541666666666667, precision 0.2713472485768501, recall 0.49747474747474746, F1 0.34662236987818384, AUC 0.46909090909090906
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3469387755102041, precision 0.4588405797101449, recall 0.42046957671957674, F1 0.4002367378348768, AUC 0.513578869047619
  Second-Tier acc 0.3469387755102041, precision 0.5617715617715618, recall 0.30798059964726626, F1 0.3101284958427815, AUC 0.5040233686067018
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 11 idx: 0 First Loss : 1.8444204330444336, Second Loss : 2.3438336849212646
epoch: 11 idx: 200 First Loss : 0.9434495439094988, Second Loss : 0.9710079798873384
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2864583333333333, precision 0.28606403013182674, recall 0.3894191919191919, F1 0.2987209475668929, AUC 0.4827241161616162
  Second-Tier acc 0.3333333333333333, precision 0.24440411373260737, recall 0.4696969696969697, F1 0.3197831978319783, AUC 0.46994949494949495
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3469387755102041, precision 0.4269410106267621, recall 0.4195326278659612, F1 0.40328598343993255, AUC 0.5240506503527337
  Second-Tier acc 0.3469387755102041, precision 0.5555555555555555, recall 0.2965167548500882, F1 0.30558422199289076, AUC 0.5166997354497355
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 12 idx: 0 First Loss : 1.864296555519104, Second Loss : 2.382969379425049
epoch: 12 idx: 200 First Loss : 0.9328688383843768, Second Loss : 0.9614529169873515
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2864583333333333, precision 0.3099756031444836, recall 0.37136363636363634, F1 0.3040566037735849, AUC 0.48666035353535353
  Second-Tier acc 0.2916666666666667, precision 0.20279720279720279, recall 0.41414141414141414, F1 0.27219564061669327, AUC 0.47515151515151516
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.336734693877551, precision 0.3919897816349385, recall 0.4034942680776014, F1 0.3835142118863049, AUC 0.5315944664902998
  Second-Tier acc 0.30612244897959184, precision 0.5167548500881834, recall 0.24889770723104057, F1 0.2670194003527337, AUC 0.5279982363315696
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 13 idx: 0 First Loss : 1.8885703086853027, Second Loss : 2.4189133644104004
epoch: 13 idx: 200 First Loss : 0.9230181738104096, Second Loss : 0.9524419432070421
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3020833333333333, precision 0.32294984604767213, recall 0.38262626262626265, F1 0.3151850201254925, AUC 0.4887784090909091
  Second-Tier acc 0.3125, precision 0.5301932367149759, recall 0.4274747474747475, F1 0.29230769230769227, AUC 0.4794444444444444
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3520408163265306, precision 0.39319579808374155, recall 0.41721781305114636, F1 0.3920554331513236, AUC 0.5364824459876544
  Second-Tier acc 0.30612244897959184, precision 0.5167548500881834, recall 0.24889770723104057, F1 0.2670194003527337, AUC 0.5318562610229277
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 14 idx: 0 First Loss : 1.907715082168579, Second Loss : 2.4526937007904053
epoch: 14 idx: 200 First Loss : 0.9135114884754615, Second Loss : 0.9440799709316806
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.296875, precision 0.3071428571428571, recall 0.37333333333333335, F1 0.30357744107744106, AUC 0.49145517676767675
  Second-Tier acc 0.2916666666666667, precision 0.34275503573749183, recall 0.3996969696969697, F1 0.2646460835481775, AUC 0.4872727272727273
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.37755102040816324, precision 0.4078658257062013, recall 0.4473104056437389, F1 0.4138728340240561, AUC 0.5403129133597884
  Second-Tier acc 0.30612244897959184, precision 0.35025062656641603, recall 0.24889770723104057, F1 0.2606060606060607, AUC 0.5393518518518519
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 15 idx: 0 First Loss : 1.9236669540405273, Second Loss : 2.483745574951172
epoch: 15 idx: 200 First Loss : 0.904381773420679, Second Loss : 0.9361404439258338
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3072916666666667, precision 0.31250203981118024, recall 0.38126262626262625, F1 0.30939593564099493, AUC 0.49327335858585863
  Second-Tier acc 0.2708333333333333, precision 0.25320020481310807, recall 0.3744444444444444, F1 0.22405372405372406, AUC 0.49439393939393944
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3979591836734694, precision 0.4214814814814815, recall 0.4714506172839506, F1 0.43403620386693736, AUC 0.5438161375661376
  Second-Tier acc 0.32653061224489793, precision 0.36015325670498083, recall 0.2612433862433862, F1 0.2720238095238095, AUC 0.537367724867725
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 16 idx: 0 First Loss : 1.9432072639465332, Second Loss : 2.5144033432006836
epoch: 16 idx: 200 First Loss : 0.895849799079385, Second Loss : 0.9287661799781062
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3072916666666667, precision 0.30800653594771243, recall 0.3776515151515151, F1 0.30544437602627256, AUC 0.49444444444444446
  Second-Tier acc 0.2916666666666667, precision 0.3090277777777778, recall 0.3877777777777778, F1 0.24429742493094542, AUC 0.499040404040404
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3979591836734694, precision 0.4104195882364896, recall 0.4685846560846561, F1 0.4254486770234802, AUC 0.546864666005291
  Second-Tier acc 0.32653061224489793, precision 0.36015325670498083, recall 0.2612433862433862, F1 0.2720238095238095, AUC 0.5476190476190476
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 17 idx: 0 First Loss : 1.9585587978363037, Second Loss : 2.5421504974365234
epoch: 17 idx: 200 First Loss : 0.8877137210312768, Second Loss : 0.9216670318140616
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.3080745503067272, recall 0.37737373737373736, F1 0.3049514196303187, AUC 0.4965656565656566
  Second-Tier acc 0.2916666666666667, precision 0.3090277777777778, recall 0.3877777777777778, F1 0.24429742493094542, AUC 0.501969696969697
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41836734693877553, precision 0.4195061728395062, recall 0.48826058201058203, F1 0.4392856876227164, AUC 0.5501818783068783
  Second-Tier acc 0.3877551020408163, precision 0.439426523297491, recall 0.32760141093474426, F1 0.3510971786833856, AUC 0.5537918871252204
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 18 idx: 0 First Loss : 1.9738925695419312, Second Loss : 2.5682413578033447
epoch: 18 idx: 200 First Loss : 0.8801315170596933, Second Loss : 0.915191423815133
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3020833333333333, precision 0.28464387464387464, recall 0.35563131313131313, F1 0.28693200663349916, AUC 0.4979040404040404
  Second-Tier acc 0.3125, precision 0.3444444444444445, recall 0.40111111111111114, F1 0.2636363636363636, AUC 0.5049494949494949
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.4254898960923057, recall 0.4944334215167549, F1 0.4459189882056768, AUC 0.5525070271164022
  Second-Tier acc 0.3877551020408163, precision 0.3886328725038402, recall 0.32760141093474426, F1 0.3434592227695676, AUC 0.5575947971781305
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4387744454969407e-05
epoch: 19 idx: 0 First Loss : 1.9851322174072266, Second Loss : 2.5921127796173096
epoch: 19 idx: 200 First Loss : 0.8727076408541321, Second Loss : 0.9087944717253026
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3072916666666667, precision 0.28932461873638343, recall 0.3589646464646465, F1 0.29112448327630697, AUC 0.4996780303030302
  Second-Tier acc 0.3125, precision 0.3444444444444445, recall 0.40111111111111114, F1 0.2636363636363636, AUC 0.5135858585858586
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.4139924085576259, recall 0.478505291005291, F1 0.4361904761904762, AUC 0.5557829034391535
  Second-Tier acc 0.3877551020408163, precision 0.3886328725038402, recall 0.32760141093474426, F1 0.3434592227695676, AUC 0.5634920634920635
 
 test auc: 0.4360670194003527, test F1: 0.14814814814814814  :  from epoch 2{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.23738314517732756, "droprate_2": 0.0, "lr": 0.0004445682281377563, "weight_decay": 0.0006651123799708482, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0004445682281377563
epoch: 0 idx: 0 First Loss : 1.085763931274414, Second Loss : 1.0139262676239014
epoch: 0 idx: 200 First Loss : 1.0690662070589871, Second Loss : 1.0655257306733534
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5046576879910213
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4944949494949495
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44316456006270816
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4506172839506173
 
 test auc: 0.4506172839506173, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.442015320765438, "droprate_2": 0.0, "lr": 2.7343785009698998e-05, "weight_decay": 0.0008693576577973519, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.7343785009698998e-05
epoch: 0 idx: 0 First Loss : 1.072001338005066, Second Loss : 1.1414926052093506
epoch: 0 idx: 200 First Loss : 1.1045441738705137, Second Loss : 1.1023067640724467
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5114365881032548
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5088383838383838
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4375734861845973
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.423886684303351
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 1 idx: 0 First Loss : 1.8455365896224976, Second Loss : 1.969739556312561
epoch: 1 idx: 200 First Loss : 1.0801639494611257, Second Loss : 1.0818564784319247
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5059371492704826
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5072222222222222
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4443464628649814
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43832671957671954
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 2 idx: 0 First Loss : 1.9109092950820923, Second Loss : 2.068629741668701
epoch: 2 idx: 200 First Loss : 1.0456279746038997, Second Loss : 1.050583289407972
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.506094276094276
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5057575757575757
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4507581324710954
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4435074955908289
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 3 idx: 0 First Loss : 1.9783073663711548, Second Loss : 2.1780853271484375
epoch: 3 idx: 200 First Loss : 1.0191420496103183, Second Loss : 1.0274125061818022
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5063916947250281
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5012626262626262
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45878649813835
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4514440035273368
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 4 idx: 0 First Loss : 2.051546096801758, Second Loss : 2.287019729614258
epoch: 4 idx: 200 First Loss : 0.9990480317924153, Second Loss : 1.010317829303184
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2569444444444444, precision 0.4202898550724638, recall 0.3434343434343434, F1 0.15753887762001353, AUC 0.5034848484848485
  Second-Tier acc 0.3125, precision 0.30952380952380953, recall 0.42676767676767674, F1 0.2926652142338417, AUC 0.4976767676767677
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.29931972789115646, precision 0.42988505747126443, recall 0.3611111111111111, F1 0.2010146716029069, AUC 0.46644743288261803
  Second-Tier acc 0.2857142857142857, precision 0.09929078014184396, recall 0.3333333333333333, F1 0.15300546448087432, AUC 0.46042768959435626
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 5 idx: 0 First Loss : 2.0915114879608154, Second Loss : 2.3689284324645996
epoch: 5 idx: 200 First Loss : 0.9777402826283702, Second Loss : 0.9912024113298649
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2222222222222222, precision 0.20383538030596857, recall 0.3005050505050505, F1 0.18859280037400653, AUC 0.49414702581369246
  Second-Tier acc 0.3333333333333333, precision 0.29320229320229324, recall 0.4621212121212121, F1 0.33457019171304886, AUC 0.4821212121212121
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3197278911564626, precision 0.33819444444444446, recall 0.4384920634920635, F1 0.3292106586224233, AUC 0.485137419165197
  Second-Tier acc 0.24489795918367346, precision 0.42276422764227645, recall 0.30357142857142855, F1 0.2074074074074074, AUC 0.4740961199294533
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 6 idx: 0 First Loss : 2.1219499111175537, Second Loss : 2.447007179260254
epoch: 6 idx: 200 First Loss : 0.9564356880253227, Second Loss : 0.9740571691399783
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2777777777777778, precision 0.28031267685342387, recall 0.3807070707070707, F1 0.3002347149798907, AUC 0.4885970819304153
  Second-Tier acc 0.3333333333333333, precision 0.24440411373260737, recall 0.4696969696969697, F1 0.3197831978319783, AUC 0.4716161616161616
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3129251700680272, precision 0.3888888888888889, recall 0.40850970017636684, F1 0.36411009940421707, AUC 0.5024617871840094
  Second-Tier acc 0.24489795918367346, precision 0.25269905533063425, recall 0.23478835978835977, F1 0.22584541062801933, AUC 0.4871031746031746
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 7 idx: 0 First Loss : 2.1529645919799805, Second Loss : 2.5258617401123047
epoch: 7 idx: 200 First Loss : 0.9374137547478747, Second Loss : 0.9587806814827433
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3125, precision 0.35185185185185186, recall 0.37572390572390574, F1 0.3376616705469178, AUC 0.4925813692480359
  Second-Tier acc 0.2916666666666667, precision 0.2916666666666667, recall 0.3996969696969697, F1 0.2935978247435422, AUC 0.4692929292929293
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.29931972789115646, precision 0.33874048264292167, recall 0.379482657260435, F1 0.3361501431173562, AUC 0.519663678228493
  Second-Tier acc 0.24489795918367346, precision 0.24472990777338602, recall 0.21186067019400354, F1 0.21777777777777776, AUC 0.5031415343915344
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 8 idx: 0 First Loss : 2.170417308807373, Second Loss : 2.5885396003723145
epoch: 8 idx: 200 First Loss : 0.9210296740653503, Second Loss : 0.9449222498012716
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3055555555555556, precision 0.3252136752136752, recall 0.35767676767676765, F1 0.3238585245164192, AUC 0.4999494949494949
  Second-Tier acc 0.3125, precision 0.32884748102139405, recall 0.39606060606060606, F1 0.3056372549019608, AUC 0.4704545454545455
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3469387755102041, precision 0.3723984319315752, recall 0.43378894767783654, F1 0.3781271500649797, AUC 0.5287086027826768
  Second-Tier acc 0.32653061224489793, precision 0.3536953242835596, recall 0.31988536155202824, F1 0.3331594354114135, AUC 0.51548721340388
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 9 idx: 0 First Loss : 2.180122137069702, Second Loss : 2.6382272243499756
epoch: 9 idx: 200 First Loss : 0.9060004459351153, Second Loss : 0.9328712236265935
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3263888888888889, precision 0.3264069264069264, recall 0.3783501683501684, F1 0.3294737657909013, AUC 0.5052861952861952
  Second-Tier acc 0.3125, precision 0.28931623931623934, recall 0.3841414141414141, F1 0.28414843414843416, AUC 0.48141414141414146
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3741496598639456, precision 0.3795417832684913, recall 0.4697971781305115, F1 0.3939989088925259, AUC 0.534801832255536
  Second-Tier acc 0.30612244897959184, precision 0.298139768728004, recall 0.27821869488536155, F1 0.2855403877923659, AUC 0.5261243386243386
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 10 idx: 0 First Loss : 2.198491334915161, Second Loss : 2.6914024353027344
epoch: 10 idx: 200 First Loss : 0.8928567187221192, Second Loss : 0.922351362619234
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.3037878787878788, recall 0.3642760942760943, F1 0.3111407551135904, AUC 0.5091638608305274
  Second-Tier acc 0.3125, precision 0.2870931537598204, recall 0.3841414141414141, F1 0.28061457992808103, AUC 0.48747474747474745
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3741496598639456, precision 0.36359460235429225, recall 0.45620223398001175, F1 0.3791634772026929, AUC 0.5380903390162649
  Second-Tier acc 0.3469387755102041, precision 0.29914529914529914, recall 0.3029100529100529, F1 0.3006535947712418, AUC 0.5315255731922398
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 11 idx: 0 First Loss : 2.207566022872925, Second Loss : 2.7314605712890625
epoch: 11 idx: 200 First Loss : 0.8808902630035705, Second Loss : 0.9135948587208986
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.33556777928931475, recall 0.39057239057239057, F1 0.3446798521526782, AUC 0.5121941638608306
  Second-Tier acc 0.3125, precision 0.2870931537598204, recall 0.3841414141414141, F1 0.28061457992808103, AUC 0.49404040404040406
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3945578231292517, precision 0.375042735042735, recall 0.4745002939447384, F1 0.3941215396051527, AUC 0.5422484322947286
  Second-Tier acc 0.3469387755102041, precision 0.2981481481481481, recall 0.3029100529100529, F1 0.29914529914529914, AUC 0.5393518518518517
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 12 idx: 0 First Loss : 2.2146031856536865, Second Loss : 2.7623822689056396
epoch: 12 idx: 200 First Loss : 0.8704266161264027, Second Loss : 0.9050516712372724
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.3463675213675214, recall 0.41077441077441074, F1 0.3568292103904469, AUC 0.5153198653198653
  Second-Tier acc 0.3125, precision 0.2772967772967773, recall 0.3841414141414141, F1 0.27676027676027676, AUC 0.5017676767676768
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.36785599485695913, recall 0.470679012345679, F1 0.3881177976952625, AUC 0.54737409367039
  Second-Tier acc 0.3469387755102041, precision 0.2977855477855478, recall 0.32076719576719576, F1 0.30427672955974844, AUC 0.5476741622574955
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 13 idx: 0 First Loss : 2.215182065963745, Second Loss : 2.787065267562866
epoch: 13 idx: 200 First Loss : 0.8609744462634052, Second Loss : 0.8974794933655813
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.3581022152450724, recall 0.430976430976431, F1 0.3652888330307685, AUC 0.5174747474747475
  Second-Tier acc 0.3125, precision 0.2772967772967773, recall 0.3841414141414141, F1 0.27676027676027676, AUC 0.5063636363636365
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.36054421768707484, precision 0.316163293274299, recall 0.41527042915931806, F1 0.3420256470500103, AUC 0.5505401234567902
  Second-Tier acc 0.30612244897959184, precision 0.2261904761904762, recall 0.27314814814814814, F1 0.24545454545454545, AUC 0.55054012345679
 
 test auc: 0.423886684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.7343785009698998e-05
epoch: 14 idx: 0 First Loss : 2.223207473754883, Second Loss : 2.8103036880493164
epoch: 14 idx: 200 First Loss : 0.8523477019918202, Second Loss : 0.8902850965807094
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3819444444444444, precision 0.34790937864401134, recall 0.4220875420875421, F1 0.35075394005875293, AUC 0.5215712682379349
  Second-Tier acc 0.3541666666666667, precision 0.3189696106362773, recall 0.41080808080808073, F1 0.3140350877192982, AUC 0.5097979797979798
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3469387755102041, precision 0.2975008443093549, recall 0.3934450323339212, F1 0.3243979451889162, AUC 0.5540674603174603
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.5513668430335097
 
 test auc: 0.5513668430335097, test F1: 0.2406926406926407  :  from epoch 14
 current learn rate 2.7343785009698998e-05
epoch: 15 idx: 0 First Loss : 2.234642744064331, Second Loss : 2.8264150619506836
epoch: 15 idx: 200 First Loss : 0.8441259133124456, Second Loss : 0.8839984766545876
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.362071101201536, recall 0.430976430976431, F1 0.3585295772979058, AUC 0.5272727272727273
  Second-Tier acc 0.3541666666666667, precision 0.3189696106362773, recall 0.41080808080808073, F1 0.3140350877192982, AUC 0.5179292929292929
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.29768286111347453, recall 0.38778659611992944, F1 0.3238095238095238, AUC 0.5549186752890457
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.5499338624338624
 
 test auc: 0.5499338624338624, test F1: 0.2406926406926407  :  from epoch 15
 current learn rate 2.7343785009698998e-05
epoch: 16 idx: 0 First Loss : 2.221561908721924, Second Loss : 2.842133045196533
epoch: 16 idx: 200 First Loss : 0.8360093033302631, Second Loss : 0.8781859673031452
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.362071101201536, recall 0.430976430976431, F1 0.3585295772979058, AUC 0.5311560044893379
  Second-Tier acc 0.4166666666666667, precision 0.3758241758241758, recall 0.45080808080808077, F1 0.36526789947842575, AUC 0.5220202020202019
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.36054421768707484, precision 0.30288860288860286, recall 0.39190182245737804, F1 0.3295353859168726, AUC 0.5562597981579462
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.5591931216931217
 
 test auc: 0.5591931216931217, test F1: 0.2406926406926407  :  from epoch 16
 current learn rate 2.7343785009698998e-05
epoch: 17 idx: 0 First Loss : 2.209821939468384, Second Loss : 2.848843574523926
epoch: 17 idx: 200 First Loss : 0.8286114889081215, Second Loss : 0.8726014689917663
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3888888888888889, precision 0.3556382978723404, recall 0.4208754208754209, F1 0.3517564402810304, AUC 0.5362121212121213
  Second-Tier acc 0.4166666666666667, precision 0.3853615520282187, recall 0.45080808080808077, F1 0.36437246963562747, AUC 0.5307070707070708
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.35374149659863946, precision 0.27330391616105904, recall 0.3801440329218107, F1 0.30578877596111353, AUC 0.5572151185577111
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.5555004409171076
 
 test auc: 0.5555004409171076, test F1: 0.2406926406926407  :  from epoch 17
 current learn rate 2.7343785009698998e-05
epoch: 18 idx: 0 First Loss : 2.1905910968780518, Second Loss : 2.8662190437316895
epoch: 18 idx: 200 First Loss : 0.8218750258750138, Second Loss : 0.8672715782683658
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3888888888888889, precision 0.3556382978723404, recall 0.4208754208754209, F1 0.3517564402810304, AUC 0.5421548821548822
  Second-Tier acc 0.4166666666666667, precision 0.3853615520282187, recall 0.45080808080808077, F1 0.36437246963562747, AUC 0.5348484848484848
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.35374149659863946, precision 0.26673827425707125, recall 0.3703703703703704, F1 0.2989849634994038, AUC 0.5573192239858906
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.5568231922398589
 
 test auc: 0.5568231922398589, test F1: 0.2406926406926407  :  from epoch 18
 current learn rate 2.7343785009698998e-05
epoch: 19 idx: 0 First Loss : 2.177335500717163, Second Loss : 2.8615336418151855
epoch: 19 idx: 200 First Loss : 0.815700227445668, Second Loss : 0.8623545282701058
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.35515151515151516, recall 0.41643097643097643, F1 0.34483629517380726, AUC 0.5453198653198653
  Second-Tier acc 0.4166666666666667, precision 0.3853615520282187, recall 0.45080808080808077, F1 0.36437246963562747, AUC 0.5441919191919192
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.26059438635112825, recall 0.35648148148148145, F1 0.29285714285714287, AUC 0.5573008524397413
  Second-Tier acc 0.30612244897959184, precision 0.21978021978021978, recall 0.27314814814814814, F1 0.2406926406926407, AUC 0.552524250440917
 
 test auc: 0.552524250440917, test F1: 0.2406926406926407  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.25543640379935806, "droprate_2": 0.0, "lr": 0.00017182231629004396, "weight_decay": 4.047401864231229e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00017182231629004396
epoch: 0 idx: 0 First Loss : 1.0443652868270874, Second Loss : 1.1450825929641724
epoch: 0 idx: 200 First Loss : 1.0675161727032259, Second Loss : 1.0722983068791194
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5022615039281706
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49439393939393933
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45794140701548103
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46593915343915343
 
 test auc: 0.46593915343915343, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00017182231629004396
epoch: 1 idx: 0 First Loss : 1.5600506067276, Second Loss : 1.5460100173950195
epoch: 1 idx: 200 First Loss : 0.9762844288378806, Second Loss : 0.9939149682646367
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.4998484848484848
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5031818181818182
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46625146972369197
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4740410052910053
 
 test auc: 0.4740410052910053, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017182231629004396
epoch: 2 idx: 0 First Loss : 2.03159236907959, Second Loss : 2.026029348373413
epoch: 2 idx: 200 First Loss : 0.9394660480505791, Second Loss : 0.9555793479455644
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2986111111111111, precision 0.3048888888888889, recall 0.4082491582491583, F1 0.28522713433199365, AUC 0.49540404040404046
  Second-Tier acc 0.3125, precision 0.4222222222222222, recall 0.42424242424242425, F1 0.2832080200501253, AUC 0.4942424242424243
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3197278911564626, precision 0.4326241134751773, recall 0.40277777777777773, F1 0.26794799321650653, AUC 0.4681866059180874
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.4646164021164021
 
 test auc: 0.4740410052910053, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017182231629004396
epoch: 3 idx: 0 First Loss : 2.4058940410614014, Second Loss : 2.476505994796753
epoch: 3 idx: 200 First Loss : 0.9208971923078174, Second Loss : 0.927906504206693
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.24305555555555555, precision 0.33304880824634997, recall 0.23680134680134682, F1 0.23914057894640417, AUC 0.4989955106621773
  Second-Tier acc 0.3125, precision 0.21159420289855072, recall 0.4419191919191919, F1 0.2861685214626391, AUC 0.4973232323232324
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.25170068027210885, precision 0.33756613756613757, recall 0.36427101704879483, F1 0.2578371215394809, AUC 0.49115103860474224
  Second-Tier acc 0.24489795918367346, precision 0.16166666666666665, recall 0.18253968253968253, F1 0.16801619433198378, AUC 0.490244708994709
 
 test auc: 0.4740410052910053, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017182231629004396
epoch: 4 idx: 0 First Loss : 2.37200665473938, Second Loss : 2.577045440673828
epoch: 4 idx: 200 First Loss : 0.9044418198737636, Second Loss : 0.908656096261977
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3680555555555556, precision 0.3392392738639712, recall 0.4075420875420876, F1 0.3509687808425537, AUC 0.49852413019079683
  Second-Tier acc 0.2708333333333333, precision 0.15546218487394958, recall 0.3888888888888889, F1 0.21424501424501421, AUC 0.4926262626262626
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3673469387755102, precision 0.36148668320348437, recall 0.45803938859494414, F1 0.36443210414247, AUC 0.5080038702723888
  Second-Tier acc 0.32653061224489793, precision 0.19424019607843138, recall 0.23192239858906524, F1 0.2114087843994897, AUC 0.5160383597883599
 
 test auc: 0.4740410052910053, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017182231629004396
epoch: 5 idx: 0 First Loss : 2.6884021759033203, Second Loss : 2.976374626159668
epoch: 5 idx: 200 First Loss : 0.9003129108618964, Second Loss : 0.8906328545799896
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3819444444444444, precision 0.3493827160493827, recall 0.4220875420875421, F1 0.3478835978835979, AUC 0.5031930415263748
  Second-Tier acc 0.2708333333333333, precision 0.16576576576576577, recall 0.3888888888888889, F1 0.21338383838383837, AUC 0.5097474747474747
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.36054421768707484, precision 0.31770034186653745, recall 0.41527042915931806, F1 0.3262720915704412, AUC 0.5224255339996081
  Second-Tier acc 0.3469387755102041, precision 0.2606951871657754, recall 0.25066137566137564, F1 0.24615664845173038, AUC 0.5375881834215167
 
 test auc: 0.5375881834215167, test F1: 0.24615664845173038  :  from epoch 5
 current learn rate 0.00017182231629004396
epoch: 6 idx: 0 First Loss : 2.7373077869415283, Second Loss : 3.033740997314453
epoch: 6 idx: 200 First Loss : 0.8931969325706844, Second Loss : 0.8822972094315794
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.40079050388328735, recall 0.4301683501683502, F1 0.3245698658934719, AUC 0.5355723905723906
  Second-Tier acc 0.25, precision 0.13105413105413105, recall 0.3611111111111111, F1 0.17841269841269844, AUC 0.5717171717171717
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3197278911564626, precision 0.20605829196894487, recall 0.24228395061728394, F1 0.22266284791069987, AUC 0.5205700078385264
  Second-Tier acc 0.32653061224489793, precision 0.25, recall 0.22685185185185186, F1 0.2193362193362193, AUC 0.5191247795414462
 
 test auc: 0.5191247795414462, test F1: 0.2193362193362193  :  from epoch 6
 current learn rate 0.00017182231629004396
epoch: 7 idx: 0 First Loss : 2.759460687637329, Second Loss : 3.0391461849212646
epoch: 7 idx: 200 First Loss : 0.8916437790395497, Second Loss : 0.8752880169945162
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.5679068462401795
  Second-Tier acc 0.2708333333333333, precision 0.47261904761904755, recall 0.3744444444444444, F1 0.20451959461247385, AUC 0.6271212121212121
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.36054421768707484, precision 0.16017797552836485, recall 0.22192827748383304, F1 0.18510534733328698, AUC 0.49790564373897706
  Second-Tier acc 0.32653061224489793, precision 0.14414414414414414, recall 0.19753086419753085, F1 0.16666666666666666, AUC 0.4927799823633157
 
 test auc: 0.4927799823633157, test F1: 0.16666666666666666  :  from epoch 7
 current learn rate 0.00017182231629004396
epoch: 8 idx: 0 First Loss : 3.19242000579834, Second Loss : 2.9166910648345947
epoch: 8 idx: 200 First Loss : 0.8889394642620704, Second Loss : 0.8714534543959692
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2777777777777778, precision 0.36385836385836384, recall 0.37888888888888883, F1 0.21467619666450075, AUC 0.593226711560045
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.647020202020202
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.36054421768707484, precision 0.19239130434782611, recall 0.22788065843621397, F1 0.19770408163265307, AUC 0.4947028708602783
  Second-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.46307319223985893
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 9 idx: 0 First Loss : 2.777496337890625, Second Loss : 2.965956926345825
epoch: 9 idx: 200 First Loss : 0.8829557056346473, Second Loss : 0.8642952994568579
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2777777777777778, precision 0.3989855072463768, recall 0.3837037037037037, F1 0.2176809513393867, AUC 0.5927497194163861
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.636010101010101
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3741496598639456, precision 0.15536723163841806, recall 0.22633744855967078, F1 0.1842546063651591, AUC 0.4788849696257104
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.472663139329806
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 10 idx: 0 First Loss : 2.7359676361083984, Second Loss : 2.927546262741089
epoch: 10 idx: 200 First Loss : 0.8758883539364853, Second Loss : 0.8586371393824478
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2916666666666667, precision 0.3717948717948718, recall 0.3877777777777778, F1 0.2313227513227513, AUC 0.6283333333333334
  Second-Tier acc 0.2708333333333333, precision 0.5277777777777778, recall 0.3744444444444444, F1 0.20341880341880345, AUC 0.6300505050505051
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.19488692232055063, recall 0.23765432098765435, F1 0.20944576614679708, AUC 0.47682123260826964
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.5102513227513227
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 11 idx: 0 First Loss : 2.828772783279419, Second Loss : 2.941121816635132
epoch: 11 idx: 200 First Loss : 0.880110939257762, Second Loss : 0.8530344679764592
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2986111111111111, precision 0.4491100632938278, recall 0.3970370370370371, F1 0.24296070052813712, AUC 0.6298540965207632
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6266666666666667
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3741496598639456, precision 0.21290491118077326, recall 0.24588477366255146, F1 0.217452260091854, AUC 0.4712546541250245
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.48815035273368607
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 12 idx: 0 First Loss : 2.801873207092285, Second Loss : 2.8766138553619385
epoch: 12 idx: 200 First Loss : 0.880064815785261, Second Loss : 0.842492812717118
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2777777777777778, precision 0.41786226685796274, recall 0.3837037037037037, F1 0.21665656213064857, AUC 0.6354433221099888
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6190909090909091
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.38095238095238093, precision 0.15426997245179064, recall 0.23045267489711932, F1 0.18481848184818483, AUC 0.4638631687242798
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.47227733686067025
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 13 idx: 0 First Loss : 2.6180126667022705, Second Loss : 2.785308599472046
epoch: 13 idx: 200 First Loss : 0.8740540109765924, Second Loss : 0.8338072256898086
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2777777777777778, precision 0.378319783197832, recall 0.37888888888888883, F1 0.21316313799973932, AUC 0.6320875420875421
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6192424242424243
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3945578231292517, precision 0.15718157181571815, recall 0.23868312757201646, F1 0.1895424836601307, AUC 0.46203826180678026
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.46048280423280424
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 14 idx: 0 First Loss : 2.542144536972046, Second Loss : 2.7278549671173096
epoch: 14 idx: 200 First Loss : 0.8731336556425705, Second Loss : 0.8246883051261417
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2777777777777778, precision 0.3871452991452991, recall 0.37888888888888883, F1 0.21297864355931465, AUC 0.6322222222222221
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6126262626262626
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.16, recall 0.24691358024691357, F1 0.1941747572815534, AUC 0.45188492063492064
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4519951499118166
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 15 idx: 0 First Loss : 2.680479049682617, Second Loss : 2.8137125968933105
epoch: 15 idx: 200 First Loss : 0.867137532276669, Second Loss : 0.8194185598299895
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2986111111111111, precision 0.43887802758770494, recall 0.3922222222222222, F1 0.23823613557994908, AUC 0.6322895622895623
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6145454545454545
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4217687074829932, precision 0.16272965879265092, recall 0.2551440329218107, F1 0.1987179487179487, AUC 0.44867602390750544
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.44830246913580246
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 16 idx: 0 First Loss : 2.8627424240112305, Second Loss : 2.9848155975341797
epoch: 16 idx: 200 First Loss : 0.8615009714036992, Second Loss : 0.8196242155758572
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2847222222222222, precision 0.4427008547008547, recall 0.3833333333333333, F1 0.22120909623421178, AUC 0.6328338945005612
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6108585858585859
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.1640625, recall 0.25925925925925924, F1 0.20095693779904308, AUC 0.44884749167156573
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.44196428571428575
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 17 idx: 0 First Loss : 2.6778345108032227, Second Loss : 2.839794874191284
epoch: 17 idx: 200 First Loss : 0.8510893567876319, Second Loss : 0.8102911059684277
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2777777777777778, precision 0.4260952380952381, recall 0.37888888888888883, F1 0.21257383966244725, AUC 0.6376599326599327
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6167676767676767
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.1640625, recall 0.25925925925925924, F1 0.20095693779904308, AUC 0.44783093278463654
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4409171075837743
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 18 idx: 0 First Loss : 2.5967254638671875, Second Loss : 2.830275297164917
epoch: 18 idx: 200 First Loss : 0.8443324060138895, Second Loss : 0.8043984548492527
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2777777777777778, precision 0.378319783197832, recall 0.37888888888888883, F1 0.21316313799973932, AUC 0.642003367003367
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6195959595959596
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.1640625, recall 0.25925925925925924, F1 0.20095693779904308, AUC 0.4459999020184206
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.43452380952380953
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8
 current learn rate 0.00017182231629004396
epoch: 19 idx: 0 First Loss : 2.541693925857544, Second Loss : 2.8707163333892822
epoch: 19 idx: 200 First Loss : 0.8399471343339732, Second Loss : 0.8009723216476671
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2986111111111111, precision 0.4483629397422501, recall 0.40185185185185185, F1 0.24627453445371109, AUC 0.6458641975308642
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6226262626262626
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.38095238095238093, precision 0.2577380952380952, recall 0.25977366255144035, F1 0.24189779538758507, AUC 0.4524421908681168
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4405864197530865
 
 test auc: 0.46307319223985893, test F1: 0.20657276995305163  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.3737947154079864, "droprate_2": 0.0, "lr": 8.440652820074645e-05, "weight_decay": 2.5262787690902626e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 8.440652820074645e-05
epoch: 0 idx: 0 First Loss : 1.121864914894104, Second Loss : 0.9171971678733826
epoch: 0 idx: 200 First Loss : 1.1082236978841657, Second Loss : 1.1094872715757853
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7564814814814814
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7464141414141414
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7084496864589457
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6863977072310407
 
 test auc: 0.6863977072310407, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 8.440652820074645e-05
epoch: 1 idx: 0 First Loss : 2.0274112224578857, Second Loss : 1.8718159198760986
epoch: 1 idx: 200 First Loss : 1.018988543407834, Second Loss : 1.0264187199411108
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486475869809203
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7502525252525253
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7280092592592592
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7097663139329806
 
 test auc: 0.7097663139329806, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 8.440652820074645e-05
epoch: 2 idx: 0 First Loss : 2.1683053970336914, Second Loss : 2.0334482192993164
epoch: 2 idx: 200 First Loss : 0.9740922821324263, Second Loss : 0.9864176079186041
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6180555555555556, precision 0.6132132132132132, recall 0.49569023569023574, F1 0.45798049023855475, AUC 0.7542592592592593
  Second-Tier acc 0.6041666666666666, precision 0.37719298245614036, recall 0.4715151515151515, F1 0.41269841269841273, AUC 0.7567171717171717
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6258503401360545, precision 0.6316646316646316, recall 0.4852292768959436, F1 0.4997594997594998, AUC 0.7226692631785224
  Second-Tier acc 0.5918367346938775, precision 0.34700854700854705, recall 0.4038800705467372, F1 0.3636363636363636, AUC 0.7105930335097002
 
 test auc: 0.7105930335097002, test F1: 0.3636363636363636  :  from epoch 2
 current learn rate 8.440652820074645e-05
epoch: 3 idx: 0 First Loss : 2.440844774246216, Second Loss : 2.299565553665161
epoch: 3 idx: 200 First Loss : 0.9381195711555765, Second Loss : 0.9560679430095711
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5972222222222222, precision 0.5476395730706075, recall 0.562996632996633, F1 0.5238979411393204, AUC 0.7567227833894501
  Second-Tier acc 0.6666666666666666, precision 0.7612942612942613, recall 0.6108080808080808, F1 0.5341251885369532, AUC 0.7615656565656566
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6122448979591837, precision 0.6083223912720498, recall 0.6044238683127571, F1 0.5981317951614982, AUC 0.7431780325298843
  Second-Tier acc 0.5510204081632653, precision 0.5374396135265701, recall 0.4772927689594357, F1 0.45543859649122803, AUC 0.7238205467372133
 
 test auc: 0.7238205467372133, test F1: 0.45543859649122803  :  from epoch 3
 current learn rate 8.440652820074645e-05
epoch: 4 idx: 0 First Loss : 2.6593024730682373, Second Loss : 2.492798089981079
epoch: 4 idx: 200 First Loss : 0.9092471813088032, Second Loss : 0.9316132200409227
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5763888888888888, precision 0.585929104878573, recall 0.5986531986531987, F1 0.5587356172626323, AUC 0.7608136924803591
  Second-Tier acc 0.5, precision 0.47321428571428575, recall 0.5041414141414141, F1 0.4239889514279758, AUC 0.770959595959596
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5918367346938775, precision 0.5855780871670703, recall 0.6273515579071135, F1 0.589844516255588, AUC 0.7521066039584557
  Second-Tier acc 0.5306122448979592, precision 0.5633986928104575, recall 0.47641093474426804, F1 0.4454545454545454, AUC 0.7360008818342152
 
 test auc: 0.7360008818342152, test F1: 0.4454545454545454  :  from epoch 4
 current learn rate 8.440652820074645e-05
epoch: 5 idx: 0 First Loss : 2.755159616470337, Second Loss : 2.7379660606384277
epoch: 5 idx: 200 First Loss : 0.8860094088838616, Second Loss : 0.9123331044999817
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5486111111111112, precision 0.5918845315904139, recall 0.600976430976431, F1 0.5436773407070437, AUC 0.7594949494949494
  Second-Tier acc 0.4583333333333333, precision 0.4801587301587302, recall 0.4919191919191919, F1 0.41778701778701777, AUC 0.7817171717171716
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.54421768707483, precision 0.5683442825140326, recall 0.6159611992945326, F1 0.5496338317068089, AUC 0.7532640113658632
  Second-Tier acc 0.4489795918367347, precision 0.45879120879120877, recall 0.44488536155202824, F1 0.4087301587301588, AUC 0.7505511463844797
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 6 idx: 0 First Loss : 2.8408443927764893, Second Loss : 2.8339595794677734
epoch: 6 idx: 200 First Loss : 0.8659649746612975, Second Loss : 0.8981486941544126
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4861111111111111, precision 0.5468018018018018, recall 0.5360606060606061, F1 0.4781077966969658, AUC 0.7585970819304153
  Second-Tier acc 0.5, precision 0.544949494949495, recall 0.5619191919191919, F1 0.49074074074074076, AUC 0.7762626262626263
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5238095238095238, precision 0.5789661319073084, recall 0.585758377425044, F1 0.5242150279476311, AUC 0.7583284342543601
  Second-Tier acc 0.5102040816326531, precision 0.5670995670995671, recall 0.5341710758377425, F1 0.47591952855110753, AUC 0.7582120811287477
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 7 idx: 0 First Loss : 3.0218324661254883, Second Loss : 2.9571380615234375
epoch: 7 idx: 200 First Loss : 0.8515009644408873, Second Loss : 0.8878232068405371
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4513888888888889, precision 0.5218790218790219, recall 0.5081818181818182, F1 0.4455387035007759, AUC 0.749371492704826
  Second-Tier acc 0.4583333333333333, precision 0.5025641025641027, recall 0.5208080808080807, F1 0.44423280423280426, AUC 0.7679797979797979
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4965986394557823, precision 0.5693516435550482, recall 0.5654761904761905, F1 0.4931654204381477, AUC 0.7561789633548893
  Second-Tier acc 0.5306122448979592, precision 0.6062271062271063, recall 0.6051587301587301, F1 0.5181818181818182, AUC 0.7778328924162258
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 8 idx: 0 First Loss : 3.0521318912506104, Second Loss : 3.0163817405700684
epoch: 8 idx: 200 First Loss : 0.8430251827120633, Second Loss : 0.8783276085579648
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4375, precision 0.5095948661840134, recall 0.49447811447811446, F1 0.4304640267716377, AUC 0.741026936026936
  Second-Tier acc 0.4375, precision 0.5208333333333334, recall 0.5049494949494949, F1 0.43189033189033194, AUC 0.7589393939393939
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46258503401360546, precision 0.5606091030789826, recall 0.5351263962375074, F1 0.4571984126984127, AUC 0.7604595336076817
  Second-Tier acc 0.5306122448979592, precision 0.6062271062271063, recall 0.6051587301587301, F1 0.5181818181818182, AUC 0.7869268077601411
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 9 idx: 0 First Loss : 3.1033947467803955, Second Loss : 3.050121307373047
epoch: 9 idx: 200 First Loss : 0.833041728413965, Second Loss : 0.8725467608449285
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4375, precision 0.5028047145524382, recall 0.49700336700336706, F1 0.4220449441037677, AUC 0.7302244668911335
  Second-Tier acc 0.4166666666666667, precision 0.5, recall 0.47717171717171714, F1 0.40808080808080804, AUC 0.7366666666666667
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.47619047619047616, precision 0.5824032176973354, recall 0.5509994121105232, F1 0.4688123920407385, AUC 0.7622538212815991
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7957451499118164
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 10 idx: 0 First Loss : 3.187830924987793, Second Loss : 3.0406150817871094
epoch: 10 idx: 200 First Loss : 0.828001114414699, Second Loss : 0.8665690665360336
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.49640329336992634, recall 0.48932659932659933, F1 0.4006053125475542, AUC 0.7250785634118967
  Second-Tier acc 0.4166666666666667, precision 0.5023809523809524, recall 0.49414141414141405, F1 0.40542328042328046, AUC 0.7083838383838383
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.5696826335501676, recall 0.5267489711934156, F1 0.43916250773070414, AUC 0.7603309327846365
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7924382716049383
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 11 idx: 0 First Loss : 3.195919990539551, Second Loss : 2.994908332824707
epoch: 11 idx: 200 First Loss : 0.8217066052619979, Second Loss : 0.8603231108710355
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4166666666666667, precision 0.49747027166382, recall 0.4958249158249159, F1 0.3952568385210628, AUC 0.7137710437710437
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.6927777777777777
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3945578231292517, precision 0.514214308028741, recall 0.43106995884773663, F1 0.3536874045339453, AUC 0.7601655888692926
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7858245149911817
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 12 idx: 0 First Loss : 3.204360008239746, Second Loss : 3.074216365814209
epoch: 12 idx: 200 First Loss : 0.81501953539888, Second Loss : 0.857537412219009
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3958333333333333, precision 0.4934832192896709, recall 0.4824915824915825, F1 0.37345740852052206, AUC 0.7009539842873176
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.6692424242424243
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.5056915807560137, recall 0.4212962962962963, F1 0.34860163816998346, AUC 0.7442129629629631
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.781360229276896
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 13 idx: 0 First Loss : 3.2358806133270264, Second Loss : 3.030972480773926
epoch: 13 idx: 200 First Loss : 0.8139399666309042, Second Loss : 0.8524863361004527
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.4793679549114332, recall 0.4736026936026936, F1 0.3584973544973545, AUC 0.6955611672278339
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.6566161616161615
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.4953917050691244, recall 0.40740740740740744, F1 0.33636363636363636, AUC 0.7262210954340583
  Second-Tier acc 0.42857142857142855, precision 0.5229716520039102, recall 0.45546737213403876, F1 0.3852081183350533, AUC 0.754243827160494
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 14 idx: 0 First Loss : 3.1923141479492188, Second Loss : 2.9724271297454834
epoch: 14 idx: 200 First Loss : 0.8097406983588687, Second Loss : 0.8479279907251157
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3680555555555556, precision 0.46585612968591694, recall 0.45989898989898986, F1 0.34137493376708195, AUC 0.6880078563411898
  Second-Tier acc 0.3333333333333333, precision 0.4217171717171717, recall 0.42888888888888893, F1 0.29360319840079957, AUC 0.6541414141414141
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3741496598639456, precision 0.501227295041728, recall 0.4089506172839506, F1 0.32852954924196237, AUC 0.710703262786596
  Second-Tier acc 0.40816326530612246, precision 0.49782135076252726, recall 0.42526455026455023, F1 0.34098336304218657, AUC 0.7469135802469135
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 15 idx: 0 First Loss : 3.136739730834961, Second Loss : 2.8958828449249268
epoch: 15 idx: 200 First Loss : 0.808554386260771, Second Loss : 0.8447855080516119
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3541666666666667, precision 0.4486721744786261, recall 0.4461952861952862, F1 0.32476853378808124, AUC 0.6794893378226711
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.44222222222222224, F1 0.31616161616161614, AUC 0.6556565656565657
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.38095238095238093, precision 0.5048019207683073, recall 0.4168871252204585, F1 0.3330665024630542, AUC 0.7018971683323535
  Second-Tier acc 0.40816326530612246, precision 0.497979797979798, recall 0.42526455026455023, F1 0.34264632136972567, AUC 0.7491181657848326
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 16 idx: 0 First Loss : 3.189702033996582, Second Loss : 2.9336979389190674
epoch: 16 idx: 200 First Loss : 0.8097058791506211, Second Loss : 0.8415545517812131
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.398886827458256, recall 0.4050841750841751, F1 0.27181373345701765, AUC 0.681442199775533
  Second-Tier acc 0.3333333333333333, precision 0.4217171717171717, recall 0.42888888888888893, F1 0.29360319840079957, AUC 0.6569191919191919
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3741496598639456, precision 0.5035650623885918, recall 0.41277189888300997, F1 0.3259296443603506, AUC 0.6943648344111307
  Second-Tier acc 0.40816326530612246, precision 0.49782135076252726, recall 0.42526455026455023, F1 0.34098336304218657, AUC 0.7453703703703706
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 17 idx: 0 First Loss : 3.041884660720825, Second Loss : 2.910069704055786
epoch: 17 idx: 200 First Loss : 0.8088885322004667, Second Loss : 0.8368003171430183
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3194444444444444, precision 0.4168006789958009, recall 0.40784511784511784, F1 0.2908619004280851, AUC 0.6758080808080807
  Second-Tier acc 0.3125, precision 0.38808760683760674, recall 0.4155555555555556, F1 0.27149501661129566, AUC 0.6641919191919192
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.5150117561946103, recall 0.4243827160493827, F1 0.3291560300146979, AUC 0.684199245541838
  Second-Tier acc 0.42857142857142855, precision 0.5105820105820106, recall 0.4490740740740741, F1 0.35232323232323237, AUC 0.7303240740740741
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 18 idx: 0 First Loss : 2.8409979343414307, Second Loss : 2.725552797317505
epoch: 18 idx: 200 First Loss : 0.8094768511523511, Second Loss : 0.8290562624724545
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.41702898550724643, recall 0.40784511784511784, F1 0.2903690260133091, AUC 0.6738776655443323
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.6641919191919191
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3741496598639456, precision 0.5215643274853802, recall 0.43445032333921224, F1 0.3424712946660964, AUC 0.6796798451891043
  Second-Tier acc 0.42857142857142855, precision 0.5105820105820106, recall 0.4490740740740741, F1 0.35232323232323237, AUC 0.714781746031746
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5
 current learn rate 8.440652820074645e-05
epoch: 19 idx: 0 First Loss : 2.609905242919922, Second Loss : 2.671104907989502
epoch: 19 idx: 200 First Loss : 0.8105627842938449, Second Loss : 0.8246641925693055
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3125, precision 0.40901455767077266, recall 0.3985858585858586, F1 0.2804998862560633, AUC 0.6735578002244669
  Second-Tier acc 0.2916666666666667, precision 0.362987987987988, recall 0.3877777777777778, F1 0.2337301587301587, AUC 0.6627272727272727
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.5171957671957672, recall 0.4284979423868313, F1 0.3366430260047282, AUC 0.6690549676660789
  Second-Tier acc 0.40816326530612246, precision 0.5046296296296297, recall 0.4367283950617284, F1 0.3325, AUC 0.6924603174603176
 
 test auc: 0.7505511463844797, test F1: 0.4087301587301588  :  from epoch 5{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.22112669117759925, "droprate_2": 0.0, "lr": 1.0349325130100501e-05, "weight_decay": 5.942561610378778e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.3521664111792717, "droprate_2": 0.0, "lr": 0.0002723945269005397, "weight_decay": 8.692086470980678e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0002723945269005397
epoch: 0 idx: 0 First Loss : 1.0229017734527588, Second Loss : 0.9949779510498047
epoch: 0 idx: 200 First Loss : 1.0771573973606474, Second Loss : 1.068944346548906
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7362008978675645
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7375757575757577
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7248860964138742
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7136794532627865
 
 test auc: 0.7136794532627865, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002723945269005397
epoch: 1 idx: 0 First Loss : 1.5514167547225952, Second Loss : 1.857097864151001
epoch: 1 idx: 200 First Loss : 0.9803195661721538, Second Loss : 0.9851526979783282
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5277777777777778, precision 0.5081585081585082, recall 0.3434343434343434, F1 0.24896564130239252, AUC 0.7314365881032548
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7308585858585858
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7338514109347444
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7393077601410933
 
 test auc: 0.7136794532627865, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002723945269005397
epoch: 2 idx: 0 First Loss : 2.05293869972229, Second Loss : 2.216874837875366
epoch: 2 idx: 200 First Loss : 0.9466316690714798, Second Loss : 0.9507877653585145
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6041666666666666, precision 0.38970514742628687, recall 0.4771717171717172, F1 0.42116581777023204, AUC 0.7105331088664423
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7322222222222221
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5850340136054422, precision 0.31672727272727275, recall 0.38065843621399176, F1 0.3285800970873786, AUC 0.6994966196355086
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7088293650793651
 
 test auc: 0.7136794532627865, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002723945269005397
epoch: 3 idx: 0 First Loss : 3.070219039916992, Second Loss : 3.0158889293670654
epoch: 3 idx: 200 First Loss : 0.9225623903712675, Second Loss : 0.9375826628665574
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3958333333333333, precision 0.3805418719211822, recall 0.44, F1 0.3029908125366521, AUC 0.7103535353535353
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7479797979797981
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.43537414965986393, precision 0.39715099715099716, recall 0.40858318636096413, F1 0.31548529661737207, AUC 0.7014011365863219
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.7299933862433862
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 4 idx: 0 First Loss : 3.171004295349121, Second Loss : 3.300370931625366
epoch: 4 idx: 200 First Loss : 0.9045786169491967, Second Loss : 0.9270421903469225
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3888888888888889, precision 0.48881456707543663, recall 0.44037037037037036, F1 0.31095718719481097, AUC 0.7379685746352412
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.745959595959596
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4421768707482993, precision 0.4924778761061947, recall 0.41865079365079366, F1 0.34511147091792255, AUC 0.712130119537527
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.7100418871252204
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 5 idx: 0 First Loss : 3.4185168743133545, Second Loss : 3.5397374629974365
epoch: 5 idx: 200 First Loss : 0.8956601995261229, Second Loss : 0.9235397036724831
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.7311111111111112
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7434343434343434
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46258503401360546, precision 0.45, recall 0.44032921810699593, F1 0.33483327564324444, AUC 0.6810515873015873
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6865079365079364
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 6 idx: 0 First Loss : 3.289658784866333, Second Loss : 3.5929317474365234
epoch: 6 idx: 200 First Loss : 0.8844204861323224, Second Loss : 0.9140906985165709
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.3636363636363636, recall 0.41333333333333333, F1 0.2665684830633284, AUC 0.6977721661054993
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7043939393939395
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6674627669998041
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6430224867724867
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 7 idx: 0 First Loss : 3.2320125102996826, Second Loss : 3.420743703842163
epoch: 7 idx: 200 First Loss : 0.8760337144465403, Second Loss : 0.9081772200378649
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3472222222222222, precision 0.375, recall 0.40888888888888886, F1 0.26308909528723773, AUC 0.6803030303030303
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6935858585858586
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4013605442176871, precision 0.44533333333333336, recall 0.40329218106995884, F1 0.28331092916208395, AUC 0.6880633940819126
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6477072310405644
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 8 idx: 0 First Loss : 3.3362061977386475, Second Loss : 3.5043604373931885
epoch: 8 idx: 200 First Loss : 0.8753989410200921, Second Loss : 0.908403511056607
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3125, precision 0.38156288156288154, recall 0.3914814814814815, F1 0.2426691125888558, AUC 0.6626936026936027
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6773737373737374
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.4775252525252525, recall 0.4051293356848913, F1 0.2977375346218416, AUC 0.6880511463844797
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6737213403880071
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 9 idx: 0 First Loss : 3.527857542037964, Second Loss : 3.4972145557403564
epoch: 9 idx: 200 First Loss : 0.8864857318283484, Second Loss : 0.9142222502740883
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.41379551820728294, recall 0.4048148148148148, F1 0.2607440010045137, AUC 0.6579180695847362
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6772727272727272
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.4897540983606557, recall 0.4171810699588478, F1 0.30721129915380785, AUC 0.6769363609641387
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6726190476190478
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 10 idx: 0 First Loss : 3.5337817668914795, Second Loss : 3.366029739379883
epoch: 10 idx: 200 First Loss : 0.8739514664059913, Second Loss : 0.9015888697479328
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2916666666666667, precision 0.35786680362951545, recall 0.3781481481481481, F1 0.2207827635392162, AUC 0.6512570145903479
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6714646464646464
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.35374149659863946, precision 0.46669640202200413, recall 0.3804379776601999, F1 0.25959728256239883, AUC 0.6630168528316677
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6729497354497355
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 11 idx: 0 First Loss : 3.358968734741211, Second Loss : 3.3281350135803223
epoch: 11 idx: 200 First Loss : 0.8753562432397284, Second Loss : 0.8978604632542719
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2986111111111111, precision 0.382480264833206, recall 0.3874074074074074, F1 0.2334190126478988, AUC 0.652648709315376
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6695454545454546
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.35374149659863946, precision 0.46680911680911685, recall 0.3804379776601999, F1 0.2603193452250056, AUC 0.6604142171271802
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6647927689594356
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 12 idx: 0 First Loss : 3.2850067615509033, Second Loss : 3.3166744709014893
epoch: 12 idx: 200 First Loss : 0.8680230701433156, Second Loss : 0.8907750910456438
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3055555555555556, precision 0.39363197189284144, recall 0.39666666666666667, F1 0.24770118956165468, AUC 0.6486195286195285
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6675757575757576
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3469387755102041, precision 0.4780701754385965, recall 0.38227513227513227, F1 0.2653846153846154, AUC 0.6617247207524986
  Second-Tier acc 0.3877551020408163, precision 0.44186046511627913, recall 0.3950617283950617, F1 0.2679093567251462, AUC 0.6689814814814815
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 13 idx: 0 First Loss : 3.3452746868133545, Second Loss : 3.4506094455718994
epoch: 13 idx: 200 First Loss : 0.867378262524264, Second Loss : 0.887651803767862
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2986111111111111, precision 0.37511345337432295, recall 0.3874074074074074, F1 0.235355510549309, AUC 0.6526374859708193
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6746464646464645
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.4883040935672514, recall 0.410787771898883, F1 0.3044670411867474, AUC 0.674468449931413
  Second-Tier acc 0.3673469387755102, precision 0.4444444444444444, recall 0.38271604938271603, F1 0.25268817204301075, AUC 0.6867283950617283
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 14 idx: 0 First Loss : 3.387930154800415, Second Loss : 3.4917895793914795
epoch: 14 idx: 200 First Loss : 0.8570021245755037, Second Loss : 0.8790885249371927
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.38590250329380765, recall 0.39666666666666667, F1 0.2497599628068686, AUC 0.6534736251402918
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6676767676767676
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3469387755102041, precision 0.4955182958979227, recall 0.3941798941798942, F1 0.28475155150152026, AUC 0.6935074955908288
  Second-Tier acc 0.32653061224489793, precision 0.4444444444444444, recall 0.35802469135802467, F1 0.21264367816091956, AUC 0.7020502645502645
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 15 idx: 0 First Loss : 3.471703290939331, Second Loss : 3.5682625770568848
epoch: 15 idx: 200 First Loss : 0.8605141186119759, Second Loss : 0.8805741138883659
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.3982142857142857, recall 0.40111111111111114, F1 0.2564039408866995, AUC 0.6551346801346801
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6678282828282828
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3469387755102041, precision 0.4974921630094044, recall 0.3980011757789536, F1 0.2812921906207112, AUC 0.6946893983931021
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.6983024691358025
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 16 idx: 0 First Loss : 3.577094078063965, Second Loss : 3.6779870986938477
epoch: 16 idx: 200 First Loss : 0.8573075017576678, Second Loss : 0.8736584125460526
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3194444444444444, precision 0.404029304029304, recall 0.4055555555555555, F1 0.2646914489019752, AUC 0.6533726150392817
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6683333333333333
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.5054768364988443, recall 0.408068783068783, F1 0.2972950986373806, AUC 0.6927052714089751
  Second-Tier acc 0.32653061224489793, precision 0.4837837837837838, recall 0.3758818342151676, F1 0.25294868905416573, AUC 0.7038690476190476
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 17 idx: 0 First Loss : 3.62939453125, Second Loss : 3.830672025680542
epoch: 17 idx: 200 First Loss : 0.8467425807466814, Second Loss : 0.8740815526570309
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.39439569206222574, recall 0.40111111111111114, F1 0.2577933997909138, AUC 0.6604882154882153
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6699999999999999
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.5111111111111112, recall 0.41372721928277484, F1 0.29316251410682403, AUC 0.6940586419753086
  Second-Tier acc 0.32653061224489793, precision 0.4837837837837838, recall 0.3758818342151676, F1 0.25294868905416573, AUC 0.7119708994708995
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 18 idx: 0 First Loss : 3.507678985595703, Second Loss : 3.9317708015441895
epoch: 18 idx: 200 First Loss : 0.8353463838879387, Second Loss : 0.863859109762927
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2986111111111111, precision 0.37243589743589745, recall 0.3922222222222222, F1 0.24578893269318347, AUC 0.6603423120089787
  Second-Tier acc 0.3333333333333333, precision 0.4245098039215686, recall 0.42888888888888893, F1 0.2925345408104029, AUC 0.6627777777777778
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.5029878618113912, recall 0.40395355673133443, F1 0.2897319589078044, AUC 0.6647131589261219
  Second-Tier acc 0.3469387755102041, precision 0.525974025974026, recall 0.43540564373897706, F1 0.30709886836079053, AUC 0.7053571428571429
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3
 current learn rate 0.0002723945269005397
epoch: 19 idx: 0 First Loss : 3.7723195552825928, Second Loss : 4.257818222045898
epoch: 19 idx: 200 First Loss : 0.8437648345612565, Second Loss : 0.8637500879540696
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3472222222222222, precision 0.3600052042674993, recall 0.40888888888888886, F1 0.2599910394265233, AUC 0.6618069584736251
  Second-Tier acc 0.3125, precision 0.4088089330024814, recall 0.3985858585858586, F1 0.28102900930487135, AUC 0.6601515151515152
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4013605442176871, precision 0.4005602240896358, recall 0.3994708994708995, F1 0.2874193155523079, AUC 0.6924052028218695
  Second-Tier acc 0.3469387755102041, precision 0.5185936443542934, recall 0.4239417989417989, F1 0.31720930232558137, AUC 0.7141754850088183
 
 test auc: 0.7299933862433862, test F1: 0.35796882855706386  :  from epoch 3{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.44726321325382395, "droprate_2": 0.0, "lr": 9.915147726775315e-05, "weight_decay": 9.843380394436153e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4837960115379712, "droprate_2": 0.0, "lr": 2.0353983447832596e-05, "weight_decay": 0.0008127500105874808, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 9.915147726775315e-05
epoch: 0 idx: 0 First Loss : 0.976300060749054, Second Loss : 1.0354409217834473
epoch: 0 idx: 200 First Loss : 1.113217185867663, Second Loss : 1.1084866495200651
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7508473625140292
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7575252525252525
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.706637027238879
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7065145502645502
 
 test auc: 0.7065145502645502, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.915147726775315e-05
epoch: 1 idx: 0 First Loss : 1.5160900354385376, Second Loss : 1.9123284816741943
epoch: 1 idx: 200 First Loss : 0.9964727848323424, Second Loss : 1.01678679275572
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7389674523007855
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7473232323232323
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134528708602783
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7127976190476191
 
 test auc: 0.7065145502645502, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.915147726775315e-05
epoch: 2 idx: 0 First Loss : 2.0606443881988525, Second Loss : 2.3551483154296875
epoch: 2 idx: 200 First Loss : 0.9445124251851394, Second Loss : 0.976280518320959
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5694444444444444, precision 0.5036575151948242, recall 0.5152525252525253, F1 0.5016828693474739, AUC 0.7226655443322111
  Second-Tier acc 0.6666666666666666, precision 0.6107744107744107, recall 0.6007070707070706, F1 0.6046344959388438, AUC 0.7275757575757575
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6054421768707483, precision 0.5769307723089235, recall 0.6083921222810112, F1 0.5875747419371581, AUC 0.7036608367626886
  Second-Tier acc 0.5714285714285714, precision 0.532027972027972, recall 0.5610670194003528, F1 0.5415354625880942, AUC 0.7099316578483245
 
 test auc: 0.7065145502645502, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.915147726775315e-05
epoch: 3 idx: 0 First Loss : 2.6920502185821533, Second Loss : 3.0879101753234863
epoch: 3 idx: 200 First Loss : 0.903289816569333, Second Loss : 0.9455737839290752
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4236111111111111, precision 0.4987584175084175, recall 0.4567003367003368, F1 0.40109973126801846, AUC 0.72496632996633
  Second-Tier acc 0.4791666666666667, precision 0.5441595441595443, recall 0.5146464646464647, F1 0.47831289936553095, AUC 0.7467171717171718
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5034013605442177, precision 0.5351290145234636, recall 0.5424015285126397, F1 0.5008503865511562, AUC 0.724341073878111
  Second-Tier acc 0.5714285714285714, precision 0.5901297717154494, recall 0.5954585537918872, F1 0.5703618056559233, AUC 0.7414572310405644
 
 test auc: 0.7065145502645502, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.915147726775315e-05
epoch: 4 idx: 0 First Loss : 3.3307294845581055, Second Loss : 3.752145290374756
epoch: 4 idx: 200 First Loss : 0.8895964518476703, Second Loss : 0.9412712353091706
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.5126024073392494, recall 0.4858249158249159, F1 0.39167916791679164, AUC 0.7392031425364758
  Second-Tier acc 0.4166666666666667, precision 0.4595088819226751, recall 0.44828282828282834, F1 0.3833333333333333, AUC 0.7745959595959597
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5034013605442177, precision 0.572720290462226, recall 0.5517342739564962, F1 0.4948717948717949, AUC 0.7387443660591808
  Second-Tier acc 0.5102040816326531, precision 0.5701243201243201, recall 0.5698853615520282, F1 0.5087719298245613, AUC 0.7646604938271606
 
 test auc: 0.7646604938271606, test F1: 0.5087719298245613  :  from epoch 4
 current learn rate 9.915147726775315e-05
epoch: 5 idx: 0 First Loss : 3.7339611053466797, Second Loss : 4.108798980712891
epoch: 5 idx: 200 First Loss : 0.8906494107500497, Second Loss : 0.9427092134656004
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3958333333333333, precision 0.479170765296085, recall 0.4640740740740741, F1 0.3527287240471178, AUC 0.7539842873176207
  Second-Tier acc 0.4166666666666667, precision 0.5132783882783883, recall 0.4746464646464647, F1 0.4137634137634138, AUC 0.7792929292929293
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.5210084033613446, recall 0.4559082892416226, F1 0.3875661375661376, AUC 0.7481689692337841
  Second-Tier acc 0.46938775510204084, precision 0.5529100529100529, recall 0.5222663139329806, F1 0.46076626076626076, AUC 0.7863205467372133
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 6 idx: 0 First Loss : 3.847994565963745, Second Loss : 4.079359531402588
epoch: 6 idx: 200 First Loss : 0.8875549934290127, Second Loss : 0.9395918498842036
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.44046345811051696, recall 0.4204377104377104, F1 0.3179001142703502, AUC 0.7384175084175083
  Second-Tier acc 0.375, precision 0.4599078341013825, recall 0.4385858585858586, F1 0.34433621933621933, AUC 0.7674747474747475
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.41496598639455784, precision 0.508187134502924, recall 0.4298206937095826, F1 0.3695733387227021, AUC 0.7339922594552224
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7704475308641975
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 7 idx: 0 First Loss : 3.792163133621216, Second Loss : 4.058267116546631
epoch: 7 idx: 200 First Loss : 0.8823777950341021, Second Loss : 0.9374236222142261
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3402777777777778, precision 0.40268388862063415, recall 0.4084175084175084, F1 0.2822587461484674, AUC 0.7186307519640852
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7292929292929293
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3877551020408163, precision 0.4829024186822352, recall 0.40314520870076426, F1 0.31113657344878454, AUC 0.6990557025279248
  Second-Tier acc 0.4489795918367347, precision 0.5481874447391689, recall 0.49713403880070545, F1 0.4185395088267865, AUC 0.7402998236331569
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 8 idx: 0 First Loss : 3.8042993545532227, Second Loss : 3.931548833847046
epoch: 8 idx: 200 First Loss : 0.8770005686338342, Second Loss : 0.9291636374679426
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3194444444444444, precision 0.3987240829346092, recall 0.3950841750841751, F1 0.2623154623154623, AUC 0.6953591470258136
  Second-Tier acc 0.375, precision 0.4384920634920635, recall 0.44111111111111106, F1 0.325, AUC 0.6927272727272727
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.38095238095238093, precision 0.4690476190476191, recall 0.39307760141093473, F1 0.29247835497835495, AUC 0.6804208308837939
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7260802469135802
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 9 idx: 0 First Loss : 3.7321414947509766, Second Loss : 4.035288333892822
epoch: 9 idx: 200 First Loss : 0.8765940289238968, Second Loss : 0.9300793622022689
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3402777777777778, precision 0.4152755696873344, recall 0.4140740740740741, F1 0.27986807878112224, AUC 0.6820707070707069
  Second-Tier acc 0.3541666666666667, precision 0.42728758169934644, recall 0.42777777777777776, F1 0.30382317801672637, AUC 0.6863636363636364
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.4873294346978558, recall 0.40696649029982357, F1 0.3068528693528693, AUC 0.6714616402116403
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6904761904761906
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 10 idx: 0 First Loss : 3.714977264404297, Second Loss : 3.811802625656128
epoch: 10 idx: 200 First Loss : 0.8767173877489794, Second Loss : 0.9229929131259956
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4309523809523809, recall 0.4274074074074074, F1 0.2998110661268556, AUC 0.6764646464646464
  Second-Tier acc 0.3333333333333333, precision 0.4213213213213214, recall 0.4144444444444444, F1 0.2787037037037037, AUC 0.6980808080808081
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.49559386973180075, recall 0.41901822457378013, F1 0.3171494505175831, AUC 0.6727721438369588
  Second-Tier acc 0.42857142857142855, precision 0.5150150150150151, recall 0.4490740740740741, F1 0.35183770477888127, AUC 0.691743827160494
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 11 idx: 0 First Loss : 3.786315679550171, Second Loss : 3.7856574058532715
epoch: 11 idx: 200 First Loss : 0.8689263252401261, Second Loss : 0.9164925929212789
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.44128452668275675, recall 0.4274074074074074, F1 0.29835197144712555, AUC 0.6721661054994389
  Second-Tier acc 0.3541666666666667, precision 0.44354354354354353, recall 0.42777777777777776, F1 0.2995203457727177, AUC 0.6986868686868686
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5107485107485108, recall 0.4313639035861258, F1 0.33666966157532197, AUC 0.6688161375661377
  Second-Tier acc 0.42857142857142855, precision 0.5150150150150151, recall 0.4490740740740741, F1 0.35183770477888127, AUC 0.6883267195767195
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 12 idx: 0 First Loss : 3.694446325302124, Second Loss : 3.636049270629883
epoch: 12 idx: 200 First Loss : 0.863455995164675, Second Loss : 0.9067485597216587
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.4464912280701754, recall 0.4274074074074074, F1 0.29794361680599013, AUC 0.6684455667789001
  Second-Tier acc 0.3333333333333333, precision 0.4298245614035088, recall 0.4144444444444444, F1 0.2777644391089769, AUC 0.6988888888888889
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.4997929606625258, recall 0.4272486772486772, F1 0.33039750505389126, AUC 0.6673402900254751
  Second-Tier acc 0.42857142857142855, precision 0.5150150150150151, recall 0.4490740740740741, F1 0.35183770477888127, AUC 0.689263668430335
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 13 idx: 0 First Loss : 3.7333571910858154, Second Loss : 3.6239571571350098
epoch: 13 idx: 200 First Loss : 0.859630653164083, Second Loss : 0.8993069300266152
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.41944444444444445, recall 0.4185185185185185, F1 0.2870140612076096, AUC 0.6672895622895623
  Second-Tier acc 0.3333333333333333, precision 0.4298245614035088, recall 0.4144444444444444, F1 0.2777644391089769, AUC 0.7033838383838384
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.531884826002473, recall 0.45120517342739563, F1 0.3659992560709921, AUC 0.6635741230648639
  Second-Tier acc 0.3877551020408163, precision 0.5011261261261262, recall 0.4243827160493827, F1 0.3106947079907232, AUC 0.6859567901234568
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 14 idx: 0 First Loss : 3.620570421218872, Second Loss : 3.5778238773345947
epoch: 14 idx: 200 First Loss : 0.8515017888506131, Second Loss : 0.8892525326427586
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.40683848382423954, recall 0.4096296296296296, F1 0.2744100969453082, AUC 0.6663299663299663
  Second-Tier acc 0.2916666666666667, precision 0.34401709401709396, recall 0.37333333333333335, F1 0.21563218390804598, AUC 0.6984343434343434
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.5180375180375181, recall 0.43885949441504996, F1 0.34466349148931896, AUC 0.6638803155006859
  Second-Tier acc 0.3877551020408163, precision 0.5037593984962406, recall 0.4243827160493827, F1 0.309953129307968, AUC 0.6882164902998236
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 15 idx: 0 First Loss : 3.5771329402923584, Second Loss : 3.5863001346588135
epoch: 15 idx: 200 First Loss : 0.8438611631613255, Second Loss : 0.8824163377712512
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3472222222222222, precision 0.4223529411764706, recall 0.42333333333333334, F1 0.29719912357118344, AUC 0.6670875420875421
  Second-Tier acc 0.2916666666666667, precision 0.34401709401709396, recall 0.37333333333333335, F1 0.21563218390804598, AUC 0.6972727272727273
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3945578231292517, precision 0.5105704028719585, recall 0.4268077601410935, F1 0.3330896857827251, AUC 0.666335978835979
  Second-Tier acc 0.3877551020408163, precision 0.5037593984962406, recall 0.4243827160493827, F1 0.309953129307968, AUC 0.6879409171075839
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 16 idx: 0 First Loss : 3.5164501667022705, Second Loss : 3.5476391315460205
epoch: 16 idx: 200 First Loss : 0.8360962190770861, Second Loss : 0.87476221813937
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.42188223347221604, recall 0.42333333333333334, F1 0.2978864443560598, AUC 0.6675364758698091
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6984343434343434
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.5214953271028037, recall 0.44069664902998235, F1 0.3466905218463225, AUC 0.6697592102684696
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6842482363315696
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 17 idx: 0 First Loss : 3.4549033641815186, Second Loss : 3.5345370769500732
epoch: 17 idx: 200 First Loss : 0.8298597630902569, Second Loss : 0.8707450094609058
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3402777777777778, precision 0.4255077030812324, recall 0.4285185185185185, F1 0.30055868702328065, AUC 0.6684960718294052
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6924242424242424
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.5130718954248367, recall 0.4222516166960611, F1 0.3199719584652118, AUC 0.6779467960023515
  Second-Tier acc 0.3469387755102041, precision 0.4471544715447155, recall 0.3703703703703704, F1 0.23636363636363633, AUC 0.6883818342151674
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 18 idx: 0 First Loss : 3.5264549255371094, Second Loss : 3.592952251434326
epoch: 18 idx: 200 First Loss : 0.8282148298744709, Second Loss : 0.8689014935639466
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3263888888888889, precision 0.41088092571855167, recall 0.41962962962962963, F1 0.28723890874311725, AUC 0.6728282828282829
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6782828282828283
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.38095238095238093, precision 0.5293591120658789, recall 0.4500293944738389, F1 0.34192212649435655, AUC 0.6806351655888694
  Second-Tier acc 0.3469387755102041, precision 0.4471544715447155, recall 0.3703703703703704, F1 0.23636363636363633, AUC 0.691523368606702
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
 current learn rate 9.915147726775315e-05
epoch: 19 idx: 0 First Loss : 3.460207939147949, Second Loss : 3.5584545135498047
epoch: 19 idx: 200 First Loss : 0.8171159010226481, Second Loss : 0.8702165434628095
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3194444444444444, precision 0.40389853592100783, recall 0.41518518518518516, F1 0.28401003939509467, AUC 0.6760830527497195
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6717676767676767
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.5423280423280423, recall 0.47354497354497355, F1 0.3491249491249491, AUC 0.6816272290809328
  Second-Tier acc 0.32653061224489793, precision 0.4471544715447155, recall 0.35802469135802467, F1 0.21567398119122258, AUC 0.7017746913580248
 
 test auc: 0.7863205467372133, test F1: 0.46076626076626076  :  from epoch 5
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.0353983447832596e-05
epoch: 0 idx: 0 First Loss : 1.022607445716858, Second Loss : 1.3142369985580444
epoch: 0 idx: 200 First Loss : 1.0937936220003004, Second Loss : 1.0802620063670239
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7185465768799103
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7156060606060605
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6176820007838527
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6173390652557319
 
 test auc: 0.6173390652557319, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 2.0353983447832596e-05
epoch: 1 idx: 0 First Loss : 2.1048171520233154, Second Loss : 2.1376514434814453
epoch: 1 idx: 200 First Loss : 1.101846369493067, Second Loss : 1.0947642722236577
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444837261503928
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.741111111111111
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6654663923182441
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6656194885361552
 
 test auc: 0.6656194885361552, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.0353983447832596e-05
epoch: 2 idx: 0 First Loss : 2.1535427570343018, Second Loss : 2.1919751167297363
epoch: 2 idx: 200 First Loss : 1.0762539352128162, Second Loss : 1.0736242429682272
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7514983164983166
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7607070707070708
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6935258671369783
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7004519400352734
 
 test auc: 0.7004519400352734, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 2.0353983447832596e-05
epoch: 3 idx: 0 First Loss : 2.2485365867614746, Second Loss : 2.286081075668335
epoch: 3 idx: 200 First Loss : 1.0557831341576813, Second Loss : 1.055854725007394
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.750628507295174
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7561111111111111
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.708480305702528
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7072861552028219
 
 test auc: 0.7004519400352734, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 2.0353983447832596e-05
epoch: 4 idx: 0 First Loss : 2.379871129989624, Second Loss : 2.4047892093658447
epoch: 4 idx: 200 First Loss : 1.0327147225761295, Second Loss : 1.0370251583074457
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5763888888888888, precision 0.5171568627450981, recall 0.41414141414141414, F1 0.3670481254575579, AUC 0.7456285072951738
  Second-Tier acc 0.6041666666666666, precision 0.5227272727272728, recall 0.4545454545454546, F1 0.41932367149758454, AUC 0.748080808080808
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5578231292517006, precision 0.5195402298850574, recall 0.34722222222222227, F1 0.2656047197640118, AUC 0.7164596805800509
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7193011463844797
 
 test auc: 0.7004519400352734, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 2.0353983447832596e-05
epoch: 5 idx: 0 First Loss : 2.5096733570098877, Second Loss : 2.532980442047119
epoch: 5 idx: 200 First Loss : 1.0076318753151159, Second Loss : 1.0146143526876743
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6111111111111112, precision 0.6217948717948718, recall 0.47993265993265993, F1 0.44793072424651376, AUC 0.7453423120089787
  Second-Tier acc 0.6666666666666666, precision 0.7828828828828828, recall 0.5598989898989898, F1 0.5315687896333058, AUC 0.7531818181818181
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6530612244897959, precision 0.6825136612021859, recall 0.5076425631981187, F1 0.5215676107103459, AUC 0.7129139721732315
  Second-Tier acc 0.673469387755102, precision 0.70840108401084, recall 0.5476190476190476, F1 0.5482654600301659, AUC 0.7175374779541445
 
 test auc: 0.7004519400352734, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 2.0353983447832596e-05
epoch: 6 idx: 0 First Loss : 2.6825292110443115, Second Loss : 2.6785597801208496
epoch: 6 idx: 200 First Loss : 0.9813811686538642, Second Loss : 0.9909206950545904
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6666666666666666, precision 0.6587999055043704, recall 0.6130976430976431, F1 0.5773383651754593, AUC 0.7463131313131314
  Second-Tier acc 0.6666666666666666, precision 0.6025641025641025, recall 0.6007070707070706, F1 0.599937998914981, AUC 0.7580808080808081
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6326530612244898, precision 0.601246763480806, recall 0.6248530276308054, F1 0.6105104290828018, AUC 0.7216098373505782
  Second-Tier acc 0.5918367346938775, precision 0.5542929292929294, recall 0.5848765432098766, F1 0.5643274853801169, AUC 0.7307098765432097
 
 test auc: 0.7004519400352734, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 2.0353983447832596e-05
epoch: 7 idx: 0 First Loss : 2.8660948276519775, Second Loss : 2.854569435119629
epoch: 7 idx: 200 First Loss : 0.9567480921671165, Second Loss : 0.9699946076085615
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.5667525694124865, recall 0.5839730639730639, F1 0.5605848719553539, AUC 0.7541470258136925
  Second-Tier acc 0.5416666666666666, precision 0.53125523713759, recall 0.547070707070707, F1 0.523015873015873, AUC 0.76489898989899
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5850340136054422, precision 0.573225516621743, recall 0.627498530276308, F1 0.5798165061818663, AUC 0.7323510679992161
  Second-Tier acc 0.5714285714285714, precision 0.5673202614379086, recall 0.6311728395061729, F1 0.565557397254452, AUC 0.742283950617284
 
 test auc: 0.742283950617284, test F1: 0.565557397254452  :  from epoch 7
 current learn rate 2.0353983447832596e-05
epoch: 8 idx: 0 First Loss : 3.049154281616211, Second Loss : 3.0256507396698
epoch: 8 idx: 200 First Loss : 0.9376530892387107, Second Loss : 0.954102951894278
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5208333333333334, precision 0.5483947965150971, recall 0.5546801346801348, F1 0.5133818709012097, AUC 0.7575533108866441
  Second-Tier acc 0.5208333333333334, precision 0.5765151515151515, recall 0.5795959595959596, F1 0.5156551509492685, AUC 0.7834848484848483
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5170068027210885, precision 0.5403508771929825, recall 0.5999412110523221, F1 0.5181048817412454, AUC 0.7368276014109347
  Second-Tier acc 0.5306122448979592, precision 0.5421296296296296, recall 0.6064814814814815, F1 0.5307539682539683, AUC 0.7565035273368607
 
 test auc: 0.7565035273368607, test F1: 0.5307539682539683  :  from epoch 8
 current learn rate 2.0353983447832596e-05
epoch: 9 idx: 0 First Loss : 3.210951089859009, Second Loss : 3.1648001670837402
epoch: 9 idx: 200 First Loss : 0.924284633026639, Second Loss : 0.9443334454383275
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5069444444444444, precision 0.5622324944358843, recall 0.5667340067340068, F1 0.5055099870889345, AUC 0.7627384960718295
  Second-Tier acc 0.5, precision 0.5662238325281803, recall 0.5662626262626262, F1 0.4954870837223779, AUC 0.793030303030303
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5102040816326531, precision 0.5435677613096969, recall 0.5996472663139331, F1 0.5149331208653243, AUC 0.7399752596511856
  Second-Tier acc 0.46938775510204084, precision 0.5024366471734892, recall 0.5694444444444444, F1 0.47474747474747475, AUC 0.7606371252204586
 
 test auc: 0.7606371252204586, test F1: 0.47474747474747475  :  from epoch 9
 current learn rate 2.0353983447832596e-05
epoch: 10 idx: 0 First Loss : 3.3562021255493164, Second Loss : 3.280733346939087
epoch: 10 idx: 200 First Loss : 0.913927850369086, Second Loss : 0.9382343180801961
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5, precision 0.5624513260552512, recall 0.567946127946128, F1 0.5009841879352629, AUC 0.7664478114478115
  Second-Tier acc 0.5, precision 0.5728114478114478, recall 0.5832323232323232, F1 0.4984121130165755, AUC 0.7952525252525252
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5102040816326531, precision 0.5573442430585288, recall 0.6072898295120518, F1 0.5146153909503841, AUC 0.7413653733098177
  Second-Tier acc 0.46938775510204084, precision 0.519023569023569, recall 0.5694444444444444, F1 0.47463681829006904, AUC 0.7603064373897707
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 11 idx: 0 First Loss : 3.4876792430877686, Second Loss : 3.3762967586517334
epoch: 11 idx: 200 First Loss : 0.9060184914127585, Second Loss : 0.9337957748142418
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4722222222222222, precision 0.5496031746031746, recall 0.5623232323232323, F1 0.47424566900138393, AUC 0.7659764309764309
  Second-Tier acc 0.5, precision 0.5775803144224197, recall 0.6002020202020203, F1 0.4988562091503268, AUC 0.7886868686868688
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5102040816326531, precision 0.5733093237294918, recall 0.6111111111111112, F1 0.5145075336856159, AUC 0.7422104644326866
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7658730158730158
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 12 idx: 0 First Loss : 3.5927581787109375, Second Loss : 3.4449892044067383
epoch: 12 idx: 200 First Loss : 0.8992256061567818, Second Loss : 0.9301605128326375
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4583333333333333, precision 0.5418960643618177, recall 0.551144781144781, F1 0.4598721417775827, AUC 0.7661560044893378
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7934848484848485
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5655411255411256, recall 0.574808935920047, F1 0.48103211752297304, AUC 0.7450641779345483
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7680224867724869
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 13 idx: 0 First Loss : 3.6818883419036865, Second Loss : 3.4875340461730957
epoch: 13 idx: 200 First Loss : 0.893167525416342, Second Loss : 0.9261813043287738
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4305555555555556, precision 0.5384822621664727, recall 0.5222895622895622, F1 0.42488315496449885, AUC 0.7637149270482603
  Second-Tier acc 0.4583333333333333, precision 0.5474747474747476, recall 0.5616161616161617, F1 0.4560117302052786, AUC 0.7916161616161617
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46938775510204084, precision 0.5689424364123159, recall 0.5490152851263962, F1 0.46761507936507934, AUC 0.7497305506564765
  Second-Tier acc 0.4897959183673469, precision 0.5933977455716586, recall 0.6047178130511464, F1 0.494030294030294, AUC 0.767416225749559
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 14 idx: 0 First Loss : 3.8322837352752686, Second Loss : 3.513291597366333
epoch: 14 idx: 200 First Loss : 0.8884696124969468, Second Loss : 0.9220249393690767
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.518954248366013, recall 0.5032996632996632, F1 0.40291126366641244, AUC 0.7612850729517396
  Second-Tier acc 0.4375, precision 0.5310195779303332, recall 0.5338383838383839, F1 0.4345351043643264, AUC 0.7876262626262626
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5637860082304527, recall 0.5249118165784833, F1 0.4393640100083865, AUC 0.7505817656280619
  Second-Tier acc 0.5102040816326531, precision 0.6076923076923078, recall 0.6106701940035273, F1 0.5096273291925466, AUC 0.7658730158730158
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 15 idx: 0 First Loss : 3.837709665298462, Second Loss : 3.547454595565796
epoch: 15 idx: 200 First Loss : 0.8807009269705793, Second Loss : 0.9195602083258998
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.5102272727272728, recall 0.4887542087542088, F1 0.3898589448828684, AUC 0.7559820426487093
  Second-Tier acc 0.4166666666666667, precision 0.513888888888889, recall 0.5060606060606061, F1 0.41228878648233486, AUC 0.7788383838383838
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5663956639566395, recall 0.5287330981775425, F1 0.4382310601326613, AUC 0.7529516950813248
  Second-Tier acc 0.5102040816326531, precision 0.6043956043956044, recall 0.5928130511463845, F1 0.5015873015873016, AUC 0.7688492063492062
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 16 idx: 0 First Loss : 3.876088857650757, Second Loss : 3.547515630722046
epoch: 16 idx: 200 First Loss : 0.8751748979638391, Second Loss : 0.9159771412650392
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3888888888888889, precision 0.5021857353231062, recall 0.47468013468013465, F1 0.38058086596931934, AUC 0.7507800224466891
  Second-Tier acc 0.375, precision 0.48148148148148157, recall 0.447979797979798, F1 0.3710189452124936, AUC 0.7703030303030302
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5645145863223339, recall 0.5209435626102293, F1 0.43856723791878954, AUC 0.7548868312757202
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7690145502645502
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 17 idx: 0 First Loss : 3.9004592895507812, Second Loss : 3.5422513484954834
epoch: 17 idx: 200 First Loss : 0.8699920772452056, Second Loss : 0.9132783364154751
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3958333333333333, precision 0.5080433374551022, recall 0.48478114478114476, F1 0.3864847284565758, AUC 0.7442199775533109
  Second-Tier acc 0.3541666666666667, precision 0.46367521367521364, recall 0.4202020202020202, F1 0.3469091211026695, AUC 0.763080808080808
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.43537414965986393, precision 0.562015503875969, recall 0.5165343915343915, F1 0.42244035504296695, AUC 0.7537600431118948
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7638888888888888
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 18 idx: 0 First Loss : 3.9176180362701416, Second Loss : 3.5251269340515137
epoch: 18 idx: 200 First Loss : 0.8658342285658608, Second Loss : 0.9109529931751539
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.4795378904249872, recall 0.4525589225589226, F1 0.35196363365377453, AUC 0.7358529741863076
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.7571212121212122
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4421768707482993, precision 0.5644194756554307, recall 0.5185185185185185, F1 0.4243291695581772, AUC 0.7527434842249656
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7711089065255732
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10
 current learn rate 2.0353983447832596e-05
epoch: 19 idx: 0 First Loss : 3.9268996715545654, Second Loss : 3.5045437812805176
epoch: 19 idx: 200 First Loss : 0.8629823306005504, Second Loss : 0.910678895391913
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4665934931892379, recall 0.44367003367003366, F1 0.33647982672577914, AUC 0.7269921436588103
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7463131313131313
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5555555555555555, recall 0.500514403292181, F1 0.4074869713967459, AUC 0.7507593572408388
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7678571428571429
 
 test auc: 0.7603064373897707, test F1: 0.47463681829006904  :  from epoch 10{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.3031375515078764, "droprate_2": 0.0, "lr": 1.0717607377251427e-05, "weight_decay": 0.0006291025359404478, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0717607377251427e-05
epoch: 0 idx: 0 First Loss : 1.2289782762527466, Second Loss : 1.022617220878601
epoch: 0 idx: 200 First Loss : 1.0512976007378516, Second Loss : 1.05113411498307
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6776038159371494
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7244444444444444
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.5953054575739761
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.624889770723104
Test AUC: 0.6249, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0717607377251427e-05
epoch: 1 idx: 0 First Loss : 1.9440628290176392, Second Loss : 1.8796436786651611
epoch: 1 idx: 200 First Loss : 1.0836081171955043, Second Loss : 1.0844628617389878
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7058866442199777
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7521212121212123
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.65108759553204
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6604938271604938
Test AUC: 0.6605, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0717607377251427e-05
epoch: 2 idx: 0 First Loss : 2.008366823196411, Second Loss : 1.9695353507995605
epoch: 2 idx: 200 First Loss : 1.075545726723932, Second Loss : 1.0781560485339283
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7275701459034792
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7582828282828281
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6767832647462276
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6839175485008818
Test AUC: 0.6839, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0717607377251427e-05
epoch: 3 idx: 0 First Loss : 2.038820505142212, Second Loss : 2.0093393325805664
epoch: 3 idx: 200 First Loss : 1.0667491480337448, Second Loss : 1.072361740158565
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.735331088664422
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7623737373737374
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6950568293160887
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6974206349206349
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 4 idx: 0 First Loss : 2.0809898376464844, Second Loss : 2.0687806606292725
epoch: 4 idx: 200 First Loss : 1.0565373248128749, Second Loss : 1.0649407385148812
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7413355780022446
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7584848484848484
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.713422251616696
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7151675485008818
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 5 idx: 0 First Loss : 2.1492927074432373, Second Loss : 2.1430673599243164
epoch: 5 idx: 200 First Loss : 1.0462867439682804, Second Loss : 1.0572067306409427
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445510662177327
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7600000000000001
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7249350872036057
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7217813051146384
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 6 idx: 0 First Loss : 2.216947317123413, Second Loss : 2.2208852767944336
epoch: 6 idx: 200 First Loss : 1.0356960216194242, Second Loss : 1.0479882462181855
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7471997755331089
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7575252525252525
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7302444640407604
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7213955026455027
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 7 idx: 0 First Loss : 2.290339231491089, Second Loss : 2.298779010772705
epoch: 7 idx: 200 First Loss : 1.0227482377444927, Second Loss : 1.0365487115819063
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.4281994047619048, recall 0.4254545454545455, F1 0.3815812458512385, AUC 0.7468237934904601
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7555555555555555
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5714285714285714, precision 0.6081560283687943, recall 0.369047619047619, F1 0.30901804814848294, AUC 0.7332818930041153
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7254188712522046
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 8 idx: 0 First Loss : 2.3660542964935303, Second Loss : 2.3830275535583496
epoch: 8 idx: 200 First Loss : 1.0079526678839725, Second Loss : 1.023464552242661
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6180555555555556, precision 0.6412983272405007, recall 0.48666666666666664, F1 0.48426021876799075, AUC 0.7454040404040404
  Second-Tier acc 0.6458333333333334, precision 0.4283374283374283, recall 0.5321212121212121, F1 0.4701857282502444, AUC 0.7552525252525252
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6394557823129252, precision 0.6907838070628768, recall 0.48412698412698413, F1 0.4841184958832018, AUC 0.7282052224181853
  Second-Tier acc 0.6326530612244898, precision 0.6957026713124274, recall 0.4464285714285714, F1 0.4340180516651104, AUC 0.7260251322751321
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 9 idx: 0 First Loss : 2.448176383972168, Second Loss : 2.4693901538848877
epoch: 9 idx: 200 First Loss : 0.9942031583345649, Second Loss : 1.010562203064635
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.7222222222222222, precision 0.7117916582440537, recall 0.6452861952861954, F1 0.6530688527178216, AUC 0.7491470258136924
  Second-Tier acc 0.6875, precision 0.4479166666666667, recall 0.6096969696969697, F1 0.5159194282001299, AUC 0.7522727272727273
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.6326530612244898, precision 0.6107711438214772, recall 0.5551881246325691, F1 0.5734185926128924, AUC 0.7262945816186557
  Second-Tier acc 0.5918367346938775, precision 0.5446998722860792, recall 0.4790564373897707, F1 0.4714285714285715, AUC 0.7210648148148148
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 10 idx: 0 First Loss : 2.537228584289551, Second Loss : 2.5712196826934814
epoch: 10 idx: 200 First Loss : 0.9819240010348126, Second Loss : 0.9979519065080295
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6666666666666666, precision 0.6208075046550546, recall 0.6233333333333333, F1 0.6191908536237669, AUC 0.7550897867564533
  Second-Tier acc 0.6666666666666666, precision 0.7592592592592592, recall 0.6108080808080808, F1 0.5355665839536807, AUC 0.7530808080808079
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.6054421768707483, precision 0.5657154114600923, recall 0.5850235155790711, F1 0.5730214682627108, AUC 0.7267906133646873
  Second-Tier acc 0.5714285714285714, precision 0.48517786561264825, recall 0.5011022927689593, F1 0.47144082858368574, AUC 0.7225529100529101
Test AUC: 0.6974, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0717607377251427e-05
epoch: 11 idx: 0 First Loss : 2.6228673458099365, Second Loss : 2.6673429012298584
epoch: 11 idx: 200 First Loss : 0.9697070129920001, Second Loss : 0.9868001033046946
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.6597222222222222, precision 0.6319171256228692, recall 0.6534343434343435, F1 0.6372005715071408, AUC 0.7645791245791246
  Second-Tier acc 0.5625, precision 0.4728715728715729, recall 0.5271717171717172, F1 0.4674106796868945, AUC 0.7654040404040403
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.6054421768707483, precision 0.5748484848484848, recall 0.6122134038800705, F1 0.5845340487650911, AUC 0.7253453850676074
  Second-Tier acc 0.6122448979591837, precision 0.6001461988304093, recall 0.5844356261022927, F1 0.5677236569685082, AUC 0.7324184303350969
Test AUC: 0.7324, Test F1: 0.5677 (Best Epoch: 11)
Current LR: 1.0717607377251427e-05
epoch: 12 idx: 0 First Loss : 2.7045891284942627, Second Loss : 2.7659740447998047
epoch: 12 idx: 200 First Loss : 0.9585149978004878, Second Loss : 0.9759008679816972
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.6111111111111112, precision 0.6083998816918071, recall 0.6384511784511785, F1 0.6025439286650931, AUC 0.773888888888889
  Second-Tier acc 0.5416666666666666, precision 0.6004273504273504, recall 0.5885858585858587, F1 0.5298935298935299, AUC 0.7737373737373737
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5782312925170068, precision 0.5690220632081097, recall 0.6250734861845973, F1 0.5690154251936606, AUC 0.7289033411718598
  Second-Tier acc 0.5918367346938775, precision 0.5939542483660131, recall 0.6014109347442681, F1 0.5717703349282296, AUC 0.7358355379188714
Test AUC: 0.7358, Test F1: 0.5718 (Best Epoch: 12)
Current LR: 1.0717607377251427e-05
epoch: 13 idx: 0 First Loss : 2.778404474258423, Second Loss : 2.8574721813201904
epoch: 13 idx: 200 First Loss : 0.9488759021372047, Second Loss : 0.9662794808101891
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.5763888888888888, precision 0.5974287828338882, recall 0.6258585858585858, F1 0.5748079448647769, AUC 0.777598204264871
  Second-Tier acc 0.5, precision 0.5670940170940172, recall 0.5619191919191919, F1 0.4904976404976405, AUC 0.7835353535353535
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5578231292517006, precision 0.5640343093759242, recall 0.622501469723692, F1 0.552138866640504, AUC 0.7312977660199883
  Second-Tier acc 0.5510204081632653, precision 0.5578703703703703, recall 0.5652557319223986, F1 0.5338517291861665, AUC 0.7395833333333334
Test AUC: 0.7396, Test F1: 0.5339 (Best Epoch: 13)
Current LR: 1.0717607377251427e-05
epoch: 14 idx: 0 First Loss : 2.8431923389434814, Second Loss : 2.937865734100342
epoch: 14 idx: 200 First Loss : 0.9405057268374744, Second Loss : 0.958207037763216
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.5347222222222222, precision 0.5696540880503145, recall 0.5943771043771043, F1 0.5353081375553286, AUC 0.7816835016835016
  Second-Tier acc 0.5416666666666666, precision 0.6004830917874396, recall 0.6174747474747475, F1 0.54034650897396, AUC 0.7946969696969696
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5170068027210885, precision 0.5457714799820063, recall 0.5978101116990006, F1 0.5154203095379567, AUC 0.7344944150499706
  Second-Tier acc 0.5102040816326531, precision 0.5341880341880342, recall 0.5698853615520282, F1 0.5087719298245613, AUC 0.7436618165784834
Test AUC: 0.7437, Test F1: 0.5088 (Best Epoch: 14){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 17, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.3581628635873527, "droprate_2": 0.0, "lr": 3.3487780564221935e-05, "weight_decay": 1.058846215764043e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.3487780564221935e-05
epoch: 0 idx: 0 First Loss : 1.2595332860946655, Second Loss : 1.1825001239776611
epoch: 0 idx: 200 First Loss : 1.1084934828886346, Second Loss : 1.087194462468968
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7122615039281706
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7343434343434344
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6503037428963355
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6590057319223985
Test AUC: 0.6590, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.3487780564221935e-05
epoch: 1 idx: 0 First Loss : 2.161428213119507, Second Loss : 2.1189162731170654
epoch: 1 idx: 200 First Loss : 1.0753526183503184, Second Loss : 1.0609831402254342
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7434848484848485
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7546464646464646
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6996619635508524
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7062940917107583
Test AUC: 0.7063, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.3487780564221935e-05
epoch: 2 idx: 0 First Loss : 2.2500836849212646, Second Loss : 2.2024712562561035
epoch: 2 idx: 200 First Loss : 1.0439752602755135, Second Loss : 1.0309331731416693
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7425757575757576
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.754090909090909
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7100970017636685
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7103174603174603
Test AUC: 0.7063, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.3487780564221935e-05
epoch: 3 idx: 0 First Loss : 2.40146803855896, Second Loss : 2.311145305633545
epoch: 3 idx: 200 First Loss : 1.0141532931903108, Second Loss : 1.0059967864286248
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5833333333333334, precision 0.5008148787268718, recall 0.4403703703703703, F1 0.4017744804546835, AUC 0.7462626262626263
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7588383838383838
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5850340136054422, precision 0.4968919968919969, recall 0.3827895355673134, F1 0.3366383225538155, AUC 0.6970348324514992
  Second-Tier acc 0.5918367346938775, precision 0.3378787878787879, recall 0.38095238095238093, F1 0.3236965653570546, AUC 0.7036485890652558
Test AUC: 0.7036, Test F1: 0.3237 (Best Epoch: 3)
Current LR: 3.3487780564221935e-05
epoch: 4 idx: 0 First Loss : 2.529865264892578, Second Loss : 2.4255874156951904
epoch: 4 idx: 200 First Loss : 0.9882582483525894, Second Loss : 0.9839443560337546
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6736111111111112, precision 0.6217372579859941, recall 0.5965993265993266, F1 0.5608373895483886, AUC 0.7460493827160494
  Second-Tier acc 0.6458333333333334, precision 0.41954022988505746, recall 0.566060606060606, F1 0.4785014899957429, AUC 0.7581818181818182
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.564625850340136, precision 0.5116312942155639, recall 0.48853615520282184, F1 0.496855002163467, AUC 0.7008867332941408
  Second-Tier acc 0.5306122448979592, precision 0.48046477850399416, recall 0.4598765432098766, F1 0.46297828018258125, AUC 0.7133487654320988
Test AUC: 0.7036, Test F1: 0.3237 (Best Epoch: 3)
Current LR: 3.3487780564221935e-05
epoch: 5 idx: 0 First Loss : 2.6417276859283447, Second Loss : 2.5411837100982666
epoch: 5 idx: 200 First Loss : 0.9647949691954537, Second Loss : 0.9653382684238514
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6180555555555556, precision 0.5648860398860399, recall 0.5803030303030302, F1 0.5526543950913699, AUC 0.748888888888889
  Second-Tier acc 0.625, precision 0.5277777777777778, recall 0.5671717171717171, F1 0.5046594982078854, AUC 0.7562626262626262
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5850340136054422, precision 0.5480235187697874, recall 0.5607730746619636, F1 0.5490747427419004, AUC 0.7098949147560258
  Second-Tier acc 0.6326530612244898, precision 0.6127946127946128, recall 0.6439594356261024, F1 0.6220988395358144, AUC 0.7255291005291005
Test AUC: 0.7036, Test F1: 0.3237 (Best Epoch: 3)
Current LR: 3.3487780564221935e-05
epoch: 6 idx: 0 First Loss : 2.747776985168457, Second Loss : 2.6305227279663086
epoch: 6 idx: 200 First Loss : 0.9444402481489513, Second Loss : 0.9472153031299659
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5833333333333334, precision 0.5635462746118484, recall 0.5838383838383838, F1 0.5474811222740409, AUC 0.7489955106621773
  Second-Tier acc 0.6041666666666666, precision 0.6058201058201058, recall 0.6116161616161616, F1 0.5787882982650424, AUC 0.763989898989899
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.54421768707483, precision 0.5180076628352491, recall 0.5360817166372722, F1 0.5145344323874973, AUC 0.7184683029590437
  Second-Tier acc 0.6326530612244898, precision 0.6301169590643275, recall 0.6911375661375662, F1 0.6373737373737373, AUC 0.7424492945326279
Test AUC: 0.7424, Test F1: 0.6374 (Best Epoch: 6)
Current LR: 3.3487780564221935e-05
epoch: 7 idx: 0 First Loss : 2.851365089416504, Second Loss : 2.696223735809326
epoch: 7 idx: 200 First Loss : 0.9254530376166253, Second Loss : 0.9317945516969434
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.591919191919192, recall 0.6043097643097644, F1 0.5598082271995316, AUC 0.7565656565656566
  Second-Tier acc 0.5625, precision 0.5980963480963482, recall 0.601919191919192, F1 0.5459300424975482, AUC 0.7709595959595958
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5306122448979592, precision 0.528278071135214, recall 0.5512198706643151, F1 0.5151428775629464, AUC 0.727923525377229
  Second-Tier acc 0.6122448979591837, precision 0.6189542483660131, recall 0.6787918871252204, F1 0.6219251336898396, AUC 0.7544091710758378
Test AUC: 0.7544, Test F1: 0.6219 (Best Epoch: 7)
Current LR: 3.3487780564221935e-05
epoch: 8 idx: 0 First Loss : 2.9328088760375977, Second Loss : 2.7534732818603516
epoch: 8 idx: 200 First Loss : 0.9087417701175854, Second Loss : 0.9189468341420836
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5277777777777778, precision 0.5668804812640429, recall 0.5796969696969697, F1 0.5157105018917402, AUC 0.7626767676767677
  Second-Tier acc 0.5416666666666666, precision 0.5957653457653458, recall 0.603030303030303, F1 0.5356613756613756, AUC 0.791111111111111
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.48299319727891155, precision 0.5076013967230728, recall 0.5126396237507348, F1 0.47076131355809697, AUC 0.7358110425240055
  Second-Tier acc 0.5306122448979592, precision 0.5590062111801243, recall 0.6000881834215167, F1 0.5410239507800484, AUC 0.7563932980599647
Test AUC: 0.7564, Test F1: 0.5410 (Best Epoch: 8)
Current LR: 3.3487780564221935e-05
epoch: 9 idx: 0 First Loss : 3.0052058696746826, Second Loss : 2.789090394973755
epoch: 9 idx: 200 First Loss : 0.89406376912152, Second Loss : 0.9077860221489152
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4861111111111111, precision 0.544885144885145, recall 0.5482154882154883, F1 0.4747514281760857, AUC 0.7675982042648709
  Second-Tier acc 0.5416666666666666, precision 0.5878787878787879, recall 0.603030303030303, F1 0.5353535353535354, AUC 0.8006060606060607
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4965986394557823, precision 0.546161115048429, recall 0.5399764844209288, F1 0.4869307568438003, AUC 0.7440169998040368
  Second-Tier acc 0.4897959183673469, precision 0.5232919254658385, recall 0.5753968253968255, F1 0.49782649782649785, AUC 0.7627314814814814
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 10 idx: 0 First Loss : 3.0840694904327393, Second Loss : 2.823883533477783
epoch: 10 idx: 200 First Loss : 0.8822669054182312, Second Loss : 0.8981567881816063
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4652777777777778, precision 0.5333399133088229, recall 0.5348821548821548, F1 0.45502435208317565, AUC 0.7712962962962963
  Second-Tier acc 0.5625, precision 0.615592903828198, recall 0.6452525252525252, F1 0.5636699507389162, AUC 0.8001515151515152
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.48299319727891155, precision 0.5371510673234812, recall 0.5160199882422105, F1 0.46393950427702224, AUC 0.7498162845385067
  Second-Tier acc 0.5306122448979592, precision 0.611111111111111, recall 0.623015873015873, F1 0.5263157894736842, AUC 0.7717151675485009
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 11 idx: 0 First Loss : 3.192214012145996, Second Loss : 2.8290932178497314
epoch: 11 idx: 200 First Loss : 0.8707288814087709, Second Loss : 0.8897683602475112
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4652777777777778, precision 0.5318138651471985, recall 0.5348821548821548, F1 0.4549514220102455, AUC 0.7720426487093154
  Second-Tier acc 0.5208333333333334, precision 0.5782608695652174, recall 0.5896969696969697, F1 0.5156551509492686, AUC 0.798030303030303
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.48299319727891155, precision 0.5461865466366592, recall 0.5257936507936508, F1 0.4673704954954954, AUC 0.7545010288065844
  Second-Tier acc 0.5102040816326531, precision 0.591111111111111, recall 0.5813492063492064, F1 0.49962839093273875, AUC 0.7696759259259259
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 12 idx: 0 First Loss : 3.210764169692993, Second Loss : 2.8525986671447754
epoch: 12 idx: 200 First Loss : 0.8602505941129294, Second Loss : 0.8819089882464995
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4375, precision 0.5111111111111112, recall 0.5122895622895624, F1 0.4257063728419108, AUC 0.7701066217732885
  Second-Tier acc 0.4791666666666667, precision 0.5486772486772487, recall 0.5485858585858586, F1 0.4702530584883526, AUC 0.7983838383838385
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46258503401360546, precision 0.5378086419753086, recall 0.5036743092298648, F1 0.4425993759327093, AUC 0.7562034587497551
  Second-Tier acc 0.5102040816326531, precision 0.591111111111111, recall 0.5813492063492064, F1 0.49962839093273875, AUC 0.7803681657848324
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 13 idx: 0 First Loss : 3.235031843185425, Second Loss : 2.864079475402832
epoch: 13 idx: 200 First Loss : 0.8507424314038374, Second Loss : 0.8742164434049631
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4166666666666667, precision 0.49467849223946786, recall 0.49414141414141405, F1 0.4028875415791833, AUC 0.7647699214365881
  Second-Tier acc 0.4791666666666667, precision 0.5486772486772487, recall 0.5485858585858586, F1 0.4702530584883526, AUC 0.7934848484848485
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.5535947712418301, recall 0.4954438565549677, F1 0.4290450928381963, AUC 0.7570240544777581
  Second-Tier acc 0.5102040816326531, precision 0.591111111111111, recall 0.5813492063492064, F1 0.49962839093273875, AUC 0.7890211640211641
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 14 idx: 0 First Loss : 3.257540702819824, Second Loss : 2.8660409450531006
epoch: 14 idx: 200 First Loss : 0.8421901116490512, Second Loss : 0.8674272946846574
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5035577449370553, recall 0.5098989898989899, F1 0.4069444444444444, AUC 0.7606172839506172
  Second-Tier acc 0.4791666666666667, precision 0.5527065527065527, recall 0.5485858585858586, F1 0.4703762586115527, AUC 0.789141414141414
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4557823129251701, precision 0.5588855588855589, recall 0.5033803644914756, F1 0.43482102692629004, AUC 0.759393983931021
  Second-Tier acc 0.5102040816326531, precision 0.591111111111111, recall 0.5813492063492064, F1 0.49962839093273875, AUC 0.7935956790123457
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 15 idx: 0 First Loss : 3.2728116512298584, Second Loss : 2.8865807056427
epoch: 15 idx: 200 First Loss : 0.8342758955350563, Second Loss : 0.8616274425282666
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.5028322440087146, recall 0.5054545454545455, F1 0.4000081504574444, AUC 0.7536868686868687
  Second-Tier acc 0.4375, precision 0.5218253968253969, recall 0.5074747474747474, F1 0.42346542346542343, AUC 0.7872222222222222
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5568205776934431, recall 0.49897119341563784, F1 0.4197952362286037, AUC 0.7564177934548305
  Second-Tier acc 0.5306122448979592, precision 0.6062271062271063, recall 0.6051587301587301, F1 0.5181818181818182, AUC 0.7966820987654323
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9)
Current LR: 3.3487780564221935e-05
epoch: 16 idx: 0 First Loss : 3.302377700805664, Second Loss : 2.86556077003479
epoch: 16 idx: 200 First Loss : 0.8265640258334985, Second Loss : 0.8563950201218475
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4097222222222222, precision 0.494993894993895, recall 0.49619528619528624, F1 0.39060390574378906, AUC 0.7483164983164983
  Second-Tier acc 0.4375, precision 0.5218253968253969, recall 0.5074747474747474, F1 0.42346542346542343, AUC 0.7784343434343434
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5568205776934431, recall 0.49897119341563784, F1 0.4197952362286037, AUC 0.7548133450911229
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7990520282186949
Test AUC: 0.7627, Test F1: 0.4978 (Best Epoch: 9){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 40, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.2456164671666679, "droprate_2": 0.0, "lr": 0.00010449833454672127, "weight_decay": 0.00025343620143642326, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00010449833454672127
epoch: 0 idx: 0 First Loss : 0.9775264859199524, Second Loss : 1.1562508344650269
epoch: 0 idx: 200 First Loss : 1.1022149983849099, Second Loss : 1.1104381007341604
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7553759820426486
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7740404040404041
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7059940231236528
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7009479717813051
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010449833454672127
epoch: 1 idx: 0 First Loss : 1.9619221687316895, Second Loss : 1.9486973285675049
epoch: 1 idx: 200 First Loss : 0.9943432348284555, Second Loss : 1.016551658140486
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7377777777777776
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7436868686868686
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18493150684931506, recall 0.3333333333333333, F1 0.23788546255506607, AUC 0.7217568097197727
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7143408289241623
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010449833454672127
epoch: 2 idx: 0 First Loss : 2.2840027809143066, Second Loss : 2.367830753326416
epoch: 2 idx: 200 First Loss : 0.9390193590551467, Second Loss : 0.9639044871081167
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5833333333333334, precision 0.49516129032258066, recall 0.5405050505050505, F1 0.47784990426376495, AUC 0.7305443322109989
  Second-Tier acc 0.6458333333333334, precision 0.5858974358974359, recall 0.5805050505050505, F1 0.5156772386373905, AUC 0.7356565656565657
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5714285714285714, precision 0.5353226900960749, recall 0.5232216343327455, F1 0.5189825631605784, AUC 0.7149042230060748
  Second-Tier acc 0.6530612244897959, precision 0.6405228758169935, recall 0.656305114638448, F1 0.6456093189964157, AUC 0.7246472663139331
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010449833454672127
epoch: 3 idx: 0 First Loss : 2.8553264141082764, Second Loss : 3.1242659091949463
epoch: 3 idx: 200 First Loss : 0.9085970335635379, Second Loss : 0.935869383000171
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4791666666666667, precision 0.539662962193602, recall 0.5341414141414141, F1 0.4637150152457919, AUC 0.7549719416386083
  Second-Tier acc 0.4583333333333333, precision 0.5327272727272727, recall 0.4987878787878788, F1 0.46296296296296297, AUC 0.747171717171717
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.46258503401360546, precision 0.4912947135169357, recall 0.4747942386831276, F1 0.4416307986609278, AUC 0.7288298549872625
  Second-Tier acc 0.5306122448979592, precision 0.5583333333333333, recall 0.5707671957671958, F1 0.5335561125034809, AUC 0.761739417989418
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010449833454672127
epoch: 4 idx: 0 First Loss : 3.2323696613311768, Second Loss : 3.6092166900634766
epoch: 4 idx: 200 First Loss : 0.8989585077075001, Second Loss : 0.9338188654377093
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4513888888888889, precision 0.5143037505764593, recall 0.5155218855218856, F1 0.4419152901936259, AUC 0.7538608305274973
  Second-Tier acc 0.4166666666666667, precision 0.46943164362519196, recall 0.46525252525252525, F1 0.38128654970760234, AUC 0.777979797979798
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46258503401360546, precision 0.5242809162776497, recall 0.4883891828336273, F1 0.4416882794304553, AUC 0.7240532529884381
  Second-Tier acc 0.5510204081632653, precision 0.6095238095238096, recall 0.5881834215167548, F1 0.5316067947646895, AUC 0.7630070546737214
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 5 idx: 0 First Loss : 3.366861581802368, Second Loss : 3.844337224960327
epoch: 5 idx: 200 First Loss : 0.8951455696059659, Second Loss : 0.9256070560951768
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.375, precision 0.4489467849223947, recall 0.4377441077441077, F1 0.35323079100710086, AUC 0.7232547699214367
  Second-Tier acc 0.4166666666666667, precision 0.4611111111111111, recall 0.46525252525252525, F1 0.38164924506387915, AUC 0.7755555555555556
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.40816326530612246, precision 0.49598930481283415, recall 0.41042034097589647, F1 0.3685501226164856, AUC 0.6799186752890457
  Second-Tier acc 0.5306122448979592, precision 0.5974025974025974, recall 0.5758377425044091, F1 0.5110072478493531, AUC 0.7580467372134038
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 6 idx: 0 First Loss : 3.3612194061279297, Second Loss : 3.899747133255005
epoch: 6 idx: 200 First Loss : 0.8918580863085015, Second Loss : 0.9238895987836987
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3472222222222222, precision 0.41138468013468016, recall 0.4007070707070706, F1 0.3103046767277861, AUC 0.7051851851851852
  Second-Tier acc 0.4166666666666667, precision 0.4814814814814814, recall 0.46525252525252525, F1 0.3829564346063628, AUC 0.7363636363636363
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.4849537037037037, recall 0.402336860670194, F1 0.3510169285105347, AUC 0.6556559866745052
  Second-Tier acc 0.46938775510204084, precision 0.5122655122655123, recall 0.46230158730158727, F1 0.3955082742316785, AUC 0.7234347442680776
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 7 idx: 0 First Loss : 3.4902267456054688, Second Loss : 3.9937596321105957
epoch: 7 idx: 200 First Loss : 0.8886400467840102, Second Loss : 0.9218584671541261
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.40969696969696967, recall 0.42175084175084177, F1 0.3071008484595777, AUC 0.6970089786756454
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.7064646464646464
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.41496598639455784, precision 0.4833774639599882, recall 0.4119635508524397, F1 0.3414952717815849, AUC 0.6266779345483049
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.6982473544973545
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 8 idx: 0 First Loss : 3.328153371810913, Second Loss : 3.8613836765289307
epoch: 8 idx: 200 First Loss : 0.8849550208212363, Second Loss : 0.914250656928223
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.418796992481203, recall 0.422962962962963, F1 0.29670499096956077, AUC 0.686705948372615
  Second-Tier acc 0.4166666666666667, precision 0.5092592592592592, recall 0.4677777777777778, F1 0.3573355583368099, AUC 0.6965656565656566
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.4854312354312354, recall 0.41578483245149905, F1 0.3397563909423209, AUC 0.6238609641387419
  Second-Tier acc 0.42857142857142855, precision 0.5092592592592593, recall 0.43761022927689597, F1 0.3582072829131653, AUC 0.6728395061728395
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 9 idx: 0 First Loss : 3.3081066608428955, Second Loss : 3.8647968769073486
epoch: 9 idx: 200 First Loss : 0.8903357423204854, Second Loss : 0.9155208836300924
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.4400782703534998, recall 0.43629629629629635, F1 0.31272465425839274, AUC 0.6766442199775532
  Second-Tier acc 0.4166666666666667, precision 0.4843915343915344, recall 0.4677777777777778, F1 0.35794970161977835, AUC 0.6954545454545454
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.47910521140609635, recall 0.4218841857730747, F1 0.3329563512776792, AUC 0.6281599059376838
  Second-Tier acc 0.42857142857142855, precision 0.5092592592592593, recall 0.43761022927689597, F1 0.3582072829131653, AUC 0.6792328042328043
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 10 idx: 0 First Loss : 3.360304117202759, Second Loss : 3.77659273147583
epoch: 10 idx: 200 First Loss : 0.8899077073781257, Second Loss : 0.908949130698077
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4309523809523809, recall 0.4274074074074074, F1 0.2998110661268556, AUC 0.6732659932659932
  Second-Tier acc 0.4166666666666667, precision 0.5092592592592592, recall 0.4677777777777778, F1 0.3573355583368099, AUC 0.6986868686868686
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.4741019214703425, recall 0.40953850676072895, F1 0.3151506972559604, AUC 0.6291642171271801
  Second-Tier acc 0.46938775510204084, precision 0.5427927927927928, recall 0.4737654320987654, F1 0.39094304388422035, AUC 0.675760582010582
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 11 idx: 0 First Loss : 3.4784209728240967, Second Loss : 3.7435598373413086
epoch: 11 idx: 200 First Loss : 0.8914553070018376, Second Loss : 0.9016184018741232
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.4530595813204508, recall 0.4274074074074074, F1 0.29757652389231337, AUC 0.6758080808080807
  Second-Tier acc 0.4375, precision 0.7324324324324324, recall 0.48111111111111104, F1 0.3754884004884005, AUC 0.700050505050505
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.4881864623243934, recall 0.4298206937095826, F1 0.3355926227992099, AUC 0.6300582990397805
  Second-Tier acc 0.46938775510204084, precision 0.5427927927927928, recall 0.4737654320987654, F1 0.39094304388422035, AUC 0.6706349206349206
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 12 idx: 0 First Loss : 3.4355030059814453, Second Loss : 3.61266827583313
epoch: 12 idx: 200 First Loss : 0.8861173561930428, Second Loss : 0.8948147983325875
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.4496034146669355, recall 0.422962962962963, F1 0.2907558136460036, AUC 0.6738327721661054
  Second-Tier acc 0.375, precision 0.4681467181467181, recall 0.44111111111111106, F1 0.3194444444444444, AUC 0.6962626262626262
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.49364406779661013, recall 0.433641975308642, F1 0.33308823529411763, AUC 0.6305971977268273
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.6713514109347444
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 13 idx: 0 First Loss : 3.4167544841766357, Second Loss : 3.481269121170044
epoch: 13 idx: 200 First Loss : 0.874725543552157, Second Loss : 0.8880957256720531
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.40567846607669616, recall 0.40518518518518515, F1 0.2652148460367638, AUC 0.6720594837261503
  Second-Tier acc 0.375, precision 0.4681467181467181, recall 0.44111111111111106, F1 0.3194444444444444, AUC 0.6832323232323233
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.4976608187134503, recall 0.4272486772486772, F1 0.3306138306138306, AUC 0.6442043895747599
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.671957671957672
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 14 idx: 0 First Loss : 3.3861896991729736, Second Loss : 3.5780739784240723
epoch: 14 idx: 200 First Loss : 0.8744279749688084, Second Loss : 0.880849457790207
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.39609158030210656, recall 0.4007407407407408, F1 0.25941720576552035, AUC 0.6707014590347923
  Second-Tier acc 0.3958333333333333, precision 0.5018768768768769, recall 0.45444444444444443, F1 0.3386363636363636, AUC 0.6844949494949494
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.4999347173260216, recall 0.4205614344503233, F1 0.31340101052241226, AUC 0.6554661473642955
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.6838624338624338
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 15 idx: 0 First Loss : 3.273897886276245, Second Loss : 3.8036751747131348
epoch: 15 idx: 200 First Loss : 0.8636588297399499, Second Loss : 0.8783363043580019
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.39079242619065635, recall 0.3962962962962963, F1 0.2511338652891164, AUC 0.670796857463524
  Second-Tier acc 0.3333333333333333, precision 0.4298245614035088, recall 0.4144444444444444, F1 0.2777644391089769, AUC 0.6811111111111111
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3877551020408163, precision 0.5018963337547407, recall 0.4205614344503233, F1 0.3129871120262335, AUC 0.6625330687830688
  Second-Tier acc 0.42857142857142855, precision 0.5228070175438596, recall 0.4490740740740741, F1 0.35198135198135194, AUC 0.6950507054673721
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 16 idx: 0 First Loss : 3.16496205329895, Second Loss : 3.5243446826934814
epoch: 16 idx: 200 First Loss : 0.8542947939064622, Second Loss : 0.8677368527151609
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.39079242619065635, recall 0.3962962962962963, F1 0.2511338652891164, AUC 0.6708698092031424
  Second-Tier acc 0.3333333333333333, precision 0.4298245614035088, recall 0.4144444444444444, F1 0.2777644391089769, AUC 0.6877777777777778
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3741496598639456, precision 0.48735632183908045, recall 0.4063786008230452, F1 0.28722836510398425, AUC 0.6708798745835782
  Second-Tier acc 0.4489795918367347, precision 0.5394736842105263, recall 0.46141975308641975, F1 0.37229763700351937, AUC 0.7020502645502645
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 17 idx: 0 First Loss : 3.1155223846435547, Second Loss : 3.5575180053710938
epoch: 17 idx: 200 First Loss : 0.8465322498219094, Second Loss : 0.8624486458038654
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.3897122614227877, recall 0.3962962962962963, F1 0.2517241379310345, AUC 0.667732884399551
  Second-Tier acc 0.3333333333333333, precision 0.44401709401709405, recall 0.4144444444444444, F1 0.2772222222222222, AUC 0.6833838383838383
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3741496598639456, precision 0.5098328416912488, recall 0.42210464432686656, F1 0.30515971483713417, AUC 0.6774201450127376
  Second-Tier acc 0.42857142857142855, precision 0.5228070175438596, recall 0.4490740740740741, F1 0.35198135198135194, AUC 0.7056878306878307
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 18 idx: 0 First Loss : 3.064865827560425, Second Loss : 3.493839979171753
epoch: 18 idx: 200 First Loss : 0.8376327696642689, Second Loss : 0.8526105856464746
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.3815476190476191, recall 0.3918518518518519, F1 0.2444991789819376, AUC 0.6656004489337822
  Second-Tier acc 0.3125, precision 0.4106837606837606, recall 0.40111111111111114, F1 0.2548478701825558, AUC 0.671060606060606
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.49488304093567254, recall 0.40410052910052907, F1 0.2835470085470086, AUC 0.6824784440525181
  Second-Tier acc 0.3673469387755102, precision 0.5006105006105006, recall 0.41203703703703703, F1 0.28721174004192873, AUC 0.7072861552028219
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 19 idx: 0 First Loss : 3.080662488937378, Second Loss : 3.5288808345794678
epoch: 19 idx: 200 First Loss : 0.832861117232127, Second Loss : 0.8518958233497286
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.39083938660209844, recall 0.3918518518518519, F1 0.24132754814645654, AUC 0.6677272727272728
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6700505050505051
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.4667623146819704, recall 0.37602880658436216, F1 0.23898743532889874, AUC 0.6804820693709582
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.703152557319224
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 20 idx: 0 First Loss : 3.021122694015503, Second Loss : 3.5062830448150635
epoch: 20 idx: 200 First Loss : 0.8269556549720805, Second Loss : 0.8481275142182507
>>>>>>>>>>> Validation Epoch: 20
  First-Tier acc 0.3055555555555556, precision 0.4220430107526882, recall 0.3918518518518519, F1 0.23939593607944146, AUC 0.6696801346801348
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6681313131313131
>>>>>>>>>>> Test Epoch: 20
  First-Tier acc 0.3197278911564626, precision 0.44020356234096686, recall 0.35390946502057613, F1 0.20060940090513957, AUC 0.6810760826964531
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.6984126984126985
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 21 idx: 0 First Loss : 2.9941141605377197, Second Loss : 3.525118589401245
epoch: 21 idx: 200 First Loss : 0.820571728221454, Second Loss : 0.8417800787627772
>>>>>>>>>>> Validation Epoch: 21
  First-Tier acc 0.2986111111111111, precision 0.4032808398950131, recall 0.3825925925925926, F1 0.22272567984300531, AUC 0.6728338945005611
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6589393939393939
>>>>>>>>>>> Test Epoch: 21
  First-Tier acc 0.3197278911564626, precision 0.4385964912280702, recall 0.35390946502057613, F1 0.1987596899224806, AUC 0.6829989711934156
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.6940586419753086
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 22 idx: 0 First Loss : 2.9789693355560303, Second Loss : 3.564640760421753
epoch: 22 idx: 200 First Loss : 0.8165266730434065, Second Loss : 0.8369303807516397
>>>>>>>>>>> Validation Epoch: 22
  First-Tier acc 0.2986111111111111, precision 0.4192708333333333, recall 0.3825925925925926, F1 0.22227814664096524, AUC 0.6763973063973063
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6639393939393939
>>>>>>>>>>> Test Epoch: 22
  First-Tier acc 0.3197278911564626, precision 0.4362745098039216, recall 0.35390946502057613, F1 0.19606306070899748, AUC 0.6869978444052518
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.6940035273368608
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 23 idx: 0 First Loss : 3.006859540939331, Second Loss : 3.6139400005340576
epoch: 23 idx: 200 First Loss : 0.8131622791208556, Second Loss : 0.8346541994095362
>>>>>>>>>>> Validation Epoch: 23
  First-Tier acc 0.3194444444444444, precision 0.39921652421652426, recall 0.4055555555555555, F1 0.26808754910944693, AUC 0.6795791245791246
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6633838383838384
>>>>>>>>>>> Test Epoch: 23
  First-Tier acc 0.3469387755102041, precision 0.5146750524109015, recall 0.4213697824808936, F1 0.28560653676932746, AUC 0.6949710954340583
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.6983575837742505
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 24 idx: 0 First Loss : 3.2057712078094482, Second Loss : 3.833733558654785
epoch: 24 idx: 200 First Loss : 0.8076215749966872, Second Loss : 0.830623920069075
>>>>>>>>>>> Validation Epoch: 24
  First-Tier acc 0.3125, precision 0.4188531210338064, recall 0.40592592592592597, F1 0.26221599751011515, AUC 0.6776823793490458
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6698989898989899
>>>>>>>>>>> Test Epoch: 24
  First-Tier acc 0.3469387755102041, precision 0.5170454545454546, recall 0.4213697824808936, F1 0.2856268578422801, AUC 0.6967408877131099
  Second-Tier acc 0.3469387755102041, precision 0.5111111111111111, recall 0.3996913580246913, F1 0.2639257294429708, AUC 0.6998456790123457
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 25 idx: 0 First Loss : 3.0840232372283936, Second Loss : 3.8367345333099365
epoch: 25 idx: 200 First Loss : 0.8064151536594609, Second Loss : 0.8276830825494512
>>>>>>>>>>> Validation Epoch: 25
  First-Tier acc 0.3125, precision 0.418560606060606, recall 0.40111111111111114, F1 0.25657929908974525, AUC 0.6797362514029182
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6655555555555556
>>>>>>>>>>> Test Epoch: 25
  First-Tier acc 0.3197278911564626, precision 0.47391688770999113, recall 0.365814226925338, F1 0.23420272789716415, AUC 0.698516803840878
  Second-Tier acc 0.30612244897959184, precision 0.44186046511627913, recall 0.345679012345679, F1 0.18755221386800333, AUC 0.7054122574955909
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 26 idx: 0 First Loss : 3.0978033542633057, Second Loss : 3.869083881378174
epoch: 26 idx: 200 First Loss : 0.8072044761341869, Second Loss : 0.8256575806111619
>>>>>>>>>>> Validation Epoch: 26
  First-Tier acc 0.3263888888888889, precision 0.46704210244033245, recall 0.4148148148148148, F1 0.27582335897085813, AUC 0.6840909090909091
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6707575757575758
>>>>>>>>>>> Test Epoch: 26
  First-Tier acc 0.3129251700680272, precision 0.4602165725047081, recall 0.35192533803644915, F1 0.21931524547803616, AUC 0.69710219478738
  Second-Tier acc 0.30612244897959184, precision 0.44186046511627913, recall 0.345679012345679, F1 0.18755221386800333, AUC 0.7054122574955909
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 27 idx: 0 First Loss : 3.0816450119018555, Second Loss : 3.993309736251831
epoch: 27 idx: 200 First Loss : 0.8041497497048858, Second Loss : 0.823301281147642
>>>>>>>>>>> Validation Epoch: 27
  First-Tier acc 0.3263888888888889, precision 0.46100131752305656, recall 0.4148148148148148, F1 0.27656327380410944, AUC 0.6855836139169472
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6722474747474747
>>>>>>>>>>> Test Epoch: 27
  First-Tier acc 0.32653061224489793, precision 0.4749163879598662, recall 0.3699294532627866, F1 0.24249505820338235, AUC 0.6993741426611798
  Second-Tier acc 0.32653061224489793, precision 0.5, recall 0.3873456790123457, F1 0.23809523809523805, AUC 0.7095458553791887
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 28 idx: 0 First Loss : 3.104329824447632, Second Loss : 4.065032005310059
epoch: 28 idx: 200 First Loss : 0.8038216483195438, Second Loss : 0.8194360956087725
>>>>>>>>>>> Validation Epoch: 28
  First-Tier acc 0.3263888888888889, precision 0.46100131752305656, recall 0.4148148148148148, F1 0.27656327380410944, AUC 0.6891919191919191
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6752777777777778
>>>>>>>>>>> Test Epoch: 28
  First-Tier acc 0.3197278911564626, precision 0.4616091954022989, recall 0.35604056437389775, F1 0.22835882497914053, AUC 0.696949098569469
  Second-Tier acc 0.32653061224489793, precision 0.5, recall 0.3873456790123457, F1 0.23809523809523805, AUC 0.7105379188712521
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 29 idx: 0 First Loss : 3.1175873279571533, Second Loss : 4.159573078155518
epoch: 29 idx: 200 First Loss : 0.7996099700094447, Second Loss : 0.8074619698803023
>>>>>>>>>>> Validation Epoch: 29
  First-Tier acc 0.3263888888888889, precision 0.4613247863247864, recall 0.41962962962962963, F1 0.28167722740500756, AUC 0.6935521885521885
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6799242424242425
>>>>>>>>>>> Test Epoch: 29
  First-Tier acc 0.3333333333333333, precision 0.504164541900391, recall 0.4033656672545561, F1 0.2661975379429574, AUC 0.7029810895551636
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.7195767195767196
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 30 idx: 0 First Loss : 3.130347967147827, Second Loss : 4.269012928009033
epoch: 30 idx: 200 First Loss : 0.799686825056254, Second Loss : 0.799160291153565
>>>>>>>>>>> Validation Epoch: 30
  First-Tier acc 0.3263888888888889, precision 0.46259524830953397, recall 0.42444444444444446, F1 0.2862255153377186, AUC 0.6946745230078563
  Second-Tier acc 0.2916666666666667, precision 0.35185185185185186, recall 0.37333333333333335, F1 0.22499388603570555, AUC 0.6826515151515151
>>>>>>>>>>> Test Epoch: 30
  First-Tier acc 0.3333333333333333, precision 0.5096652522395096, recall 0.4093180482069371, F1 0.2737967914438502, AUC 0.7039486576523614
  Second-Tier acc 0.30612244897959184, precision 0.4807017543859649, recall 0.36353615520282184, F1 0.22751322751322753, AUC 0.7169863315696648
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 31 idx: 0 First Loss : 3.150843620300293, Second Loss : 4.339600086212158
epoch: 31 idx: 200 First Loss : 0.8013173403263214, Second Loss : 0.7892212865965841
>>>>>>>>>>> Validation Epoch: 31
  First-Tier acc 0.3402777777777778, precision 0.4759868421052631, recall 0.4381481481481482, F1 0.30419393401609546, AUC 0.6971268237934906
  Second-Tier acc 0.3125, precision 0.3923611111111111, recall 0.40111111111111114, F1 0.2672859306780718, AUC 0.6806313131313132
>>>>>>>>>>> Test Epoch: 31
  First-Tier acc 0.32653061224489793, precision 0.502093023255814, recall 0.3954291593180482, F1 0.2642223843499982, AUC 0.7071269351361943
  Second-Tier acc 0.3469387755102041, precision 0.5340659340659341, recall 0.4468694885361552, F1 0.29591836734693877, AUC 0.7183641975308642
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 32 idx: 0 First Loss : 3.1130988597869873, Second Loss : 4.394641876220703
epoch: 32 idx: 200 First Loss : 0.7984211460807964, Second Loss : 0.7813465245174397
>>>>>>>>>>> Validation Epoch: 32
  First-Tier acc 0.3472222222222222, precision 0.4830572808833678, recall 0.4474074074074075, F1 0.3149643036701861, AUC 0.6991049382716049
  Second-Tier acc 0.3125, precision 0.425, recall 0.39606060606060606, F1 0.3028940886699507, AUC 0.6872474747474747
>>>>>>>>>>> Test Epoch: 32
  First-Tier acc 0.3333333333333333, precision 0.51010101010101, recall 0.4093180482069371, F1 0.2745932415519399, AUC 0.7096193415637861
  Second-Tier acc 0.3877551020408163, precision 0.5802898550724638, recall 0.5480599647266314, F1 0.357969987002245, AUC 0.7040895061728394
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 33 idx: 0 First Loss : 3.102524757385254, Second Loss : 4.423583507537842
epoch: 33 idx: 200 First Loss : 0.7956993926253134, Second Loss : 0.7712882219415518
>>>>>>>>>>> Validation Epoch: 33
  First-Tier acc 0.3611111111111111, precision 0.4973514211886305, recall 0.4659259259259259, F1 0.3348272642390289, AUC 0.6975028058361392
  Second-Tier acc 0.3125, precision 0.4437321937321937, recall 0.39101010101010103, F1 0.3176043557168784, AUC 0.6853282828282827
>>>>>>>>>>> Test Epoch: 33
  First-Tier acc 0.3673469387755102, precision 0.5464516129032259, recall 0.47876249265138154, F1 0.3230642407112995, AUC 0.7159636488340192
  Second-Tier acc 0.32653061224489793, precision 0.5499999999999999, recall 0.4944885361552028, F1 0.31030189853719264, AUC 0.7047508818342152
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 34 idx: 0 First Loss : 3.1260030269622803, Second Loss : 4.508962631225586
epoch: 34 idx: 200 First Loss : 0.7959826303501122, Second Loss : 0.7659338873539074
>>>>>>>>>>> Validation Epoch: 34
  First-Tier acc 0.3680555555555556, precision 0.5059143358729185, recall 0.48, F1 0.34468405176758865, AUC 0.6939337822671154
  Second-Tier acc 0.3541666666666667, precision 0.5596264367816092, recall 0.4465656565656566, F1 0.35808921581279307, AUC 0.6729040404040404
>>>>>>>>>>> Test Epoch: 34
  First-Tier acc 0.3673469387755102, precision 0.5513579742699612, recall 0.486845972957084, F1 0.3351773606052115, AUC 0.7237470605526162
  Second-Tier acc 0.2857142857142857, precision 0.53125, recall 0.4468694885361552, F1 0.2738095238095238, AUC 0.7015542328042329
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 35 idx: 0 First Loss : 3.1397581100463867, Second Loss : 4.5227370262146
epoch: 35 idx: 200 First Loss : 0.7933042413626193, Second Loss : 0.7550519828995391
>>>>>>>>>>> Validation Epoch: 35
  First-Tier acc 0.3611111111111111, precision 0.47598306110102845, recall 0.46989898989898987, F1 0.34357013545218984, AUC 0.6927272727272727
  Second-Tier acc 0.3541666666666667, precision 0.5596264367816092, recall 0.4465656565656566, F1 0.35808921581279307, AUC 0.674419191919192
>>>>>>>>>>> Test Epoch: 35
  First-Tier acc 0.3945578231292517, precision 0.5725108225108225, recall 0.5326278659611993, F1 0.36886980497528166, AUC 0.7210709386635313
  Second-Tier acc 0.2857142857142857, precision 0.5648148148148148, recall 0.4468694885361552, F1 0.2837162837162837, AUC 0.6971450617283951
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 36 idx: 0 First Loss : 3.1776840686798096, Second Loss : 4.5797271728515625
epoch: 36 idx: 200 First Loss : 0.7824799000536008, Second Loss : 0.7418100158389181
>>>>>>>>>>> Validation Epoch: 36
  First-Tier acc 0.3819444444444444, precision 0.49663456560008284, recall 0.48804713804713806, F1 0.3682038810912036, AUC 0.68918911335578
  Second-Tier acc 0.375, precision 0.5625, recall 0.45989898989899, F1 0.3814601958280119, AUC 0.6766161616161616
>>>>>>>>>>> Test Epoch: 36
  First-Tier acc 0.3945578231292517, precision 0.5718355718355719, recall 0.5326278659611993, F1 0.3685823754789272, AUC 0.7228652263374485
  Second-Tier acc 0.2857142857142857, precision 0.5648148148148148, recall 0.4468694885361552, F1 0.2837162837162837, AUC 0.6937279541446207
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 37 idx: 0 First Loss : 3.2730655670166016, Second Loss : 4.719534397125244
epoch: 37 idx: 200 First Loss : 0.7804874792951458, Second Loss : 0.7360045090756662
>>>>>>>>>>> Validation Epoch: 37
  First-Tier acc 0.3819444444444444, precision 0.5031399656636848, recall 0.47589225589225587, F1 0.37654487760172484, AUC 0.6834455667789001
  Second-Tier acc 0.3333333333333333, precision 0.4714285714285715, recall 0.40181818181818185, F1 0.3427350427350428, AUC 0.6741414141414142
>>>>>>>>>>> Test Epoch: 37
  First-Tier acc 0.3945578231292517, precision 0.5755681054188517, recall 0.5385802469135803, F1 0.37166856132373377, AUC 0.7215975896531454
  Second-Tier acc 0.2653061224489796, precision 0.547911547911548, recall 0.4230599647266314, F1 0.2608465608465608, AUC 0.6910824514991182
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 38 idx: 0 First Loss : 3.478175163269043, Second Loss : 5.055232048034668
epoch: 38 idx: 200 First Loss : 0.7976822009047768, Second Loss : 0.7506926416536563
>>>>>>>>>>> Validation Epoch: 38
  First-Tier acc 0.3819444444444444, precision 0.5040669667535339, recall 0.47589225589225587, F1 0.3774970680588658, AUC 0.6792760942760943
  Second-Tier acc 0.3541666666666667, precision 0.4899835796387521, recall 0.4295959595959596, F1 0.362710027100271, AUC 0.6642424242424242
>>>>>>>>>>> Test Epoch: 38
  First-Tier acc 0.36054421768707484, precision 0.5591636412531935, recall 0.4988977072310406, F1 0.34510950852976435, AUC 0.7217261904761904
  Second-Tier acc 0.22448979591836735, precision 0.5042735042735043, recall 0.3754409171075837, F1 0.21005682569049822, AUC 0.6823743386243386
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4)
Current LR: 0.00010449833454672127
epoch: 39 idx: 0 First Loss : 3.5278570652008057, Second Loss : 5.143507480621338
epoch: 39 idx: 200 First Loss : 0.785834829697704, Second Loss : 0.729530749203406
>>>>>>>>>>> Validation Epoch: 39
  First-Tier acc 0.3819444444444444, precision 0.5081734186211798, recall 0.47420875420875425, F1 0.38094751099960006, AUC 0.6845622895622895
  Second-Tier acc 0.3541666666666667, precision 0.4899835796387521, recall 0.4295959595959596, F1 0.362710027100271, AUC 0.6661111111111111
>>>>>>>>>>> Test Epoch: 39
  First-Tier acc 0.36054421768707484, precision 0.5581140350877193, recall 0.5010288065843621, F1 0.3491309319611206, AUC 0.7188296100333137
  Second-Tier acc 0.22448979591836735, precision 0.5042735042735043, recall 0.3754409171075837, F1 0.21005682569049822, AUC 0.6765873015873015
Test AUC: 0.7630, Test F1: 0.5316 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 2, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.2514597240875724, "droprate_2": 0.0, "lr": 1.3680442355708463e-05, "weight_decay": 4.4070390269251604e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 2, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.283147842529965, "droprate_2": 0.0, "lr": 0.0002935093504082349, "weight_decay": 0.0008561535754984321, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0002935093504082349
epoch: 0 idx: 0 First Loss : 0.9633608460426331, Second Loss : 1.172533392906189
epoch: 0 idx: 200 First Loss : 1.1007761400174443, Second Loss : 1.0806158727674342
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7338103254769921
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7306565656565657
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6740459043699785
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6770833333333334
Test AUC: 0.6771, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002935093504082349
epoch: 1 idx: 0 First Loss : 1.8758611679077148, Second Loss : 2.2345573902130127
epoch: 1 idx: 200 First Loss : 0.9726648871133576, Second Loss : 0.9874141830116955
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7287710437710437
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7270202020202019
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.748236331569665
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.759700176366843
Test AUC: 0.6771, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 12, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.3543567120579391, "droprate_2": 0.0, "lr": 0.00038062038971595235, "weight_decay": 3.657067676112088e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.24174280215137245, "droprate_2": 0.0, "lr": 2.855640953228816e-05, "weight_decay": 5.098168898983375e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_0", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.855640953228816e-05
epoch: 0 idx: 0 First Loss : 1.1955103874206543, Second Loss : 0.9838821291923523
epoch: 0 idx: 200 First Loss : 1.1035431308384558, Second Loss : 1.097574332460242
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.729915824915825
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7257575757575757
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.646243631197335
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6442350088183422
Test AUC: 0.6442, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.855640953228816e-05
epoch: 1 idx: 0 First Loss : 2.183187246322632, Second Loss : 2.139760732650757
epoch: 1 idx: 200 First Loss : 1.0726001385729111, Second Loss : 1.074672374411009
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7502525252525253
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7454545454545455
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.695479374877523
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6938932980599647
Test AUC: 0.6939, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.855640953228816e-05
epoch: 2 idx: 0 First Loss : 2.377445936203003, Second Loss : 2.2844104766845703
epoch: 2 idx: 200 First Loss : 1.042110637163938, Second Loss : 1.051410495790083
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7451122334455667
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7488383838383837
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7072922790515385
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7043099647266313
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.855640953228816e-05
epoch: 3 idx: 0 First Loss : 2.607131242752075, Second Loss : 2.4939794540405273
epoch: 3 idx: 200 First Loss : 1.0090762657386747, Second Loss : 1.0219667114280349
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6666666666666666, precision 0.6202729044834309, recall 0.5864983164983165, F1 0.5559972543050705, AUC 0.7440460157126824
  Second-Tier acc 0.6458333333333334, precision 0.42091503267973857, recall 0.566060606060606, F1 0.480952380952381, AUC 0.7393939393939394
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5782312925170068, precision 0.5478537408814131, recall 0.4793503821281599, F1 0.4951727007906783, AUC 0.6991414364099549
  Second-Tier acc 0.6326530612244898, precision 0.6424731182795699, recall 0.5509259259259259, F1 0.5747126436781609, AUC 0.703317901234568
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.855640953228816e-05
epoch: 4 idx: 0 First Loss : 2.902472734451294, Second Loss : 2.7758328914642334
epoch: 4 idx: 200 First Loss : 0.9742463674229472, Second Loss : 0.9920507157175102
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5625, precision 0.5422162688446106, recall 0.5532996632996633, F1 0.5386231209016019, AUC 0.7496576879910214
  Second-Tier acc 0.5208333333333334, precision 0.5047619047619049, recall 0.4784848484848485, F1 0.46730019493177394, AUC 0.7173737373737374
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5918367346938775, precision 0.5755204076727081, recall 0.6137566137566138, F1 0.5839011576487981, AUC 0.7137896825396824
  Second-Tier acc 0.5714285714285714, precision 0.5501949317738791, recall 0.583994708994709, F1 0.5507246376811594, AUC 0.7277336860670194
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.855640953228816e-05
epoch: 5 idx: 0 First Loss : 3.211920738220215, Second Loss : 3.0837972164154053
epoch: 5 idx: 200 First Loss : 0.9483268074135283, Second Loss : 0.9676100812778248
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5138888888888888, precision 0.5458277426362533, recall 0.551077441077441, F1 0.5081349206349207, AUC 0.7511952861952862
  Second-Tier acc 0.5208333333333334, precision 0.5555555555555556, recall 0.5651515151515151, F1 0.5181112146629387, AUC 0.7393434343434343
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5306122448979592, precision 0.5551120448179271, recall 0.6179453262786596, F1 0.5317501546072975, AUC 0.7360559964726631
  Second-Tier acc 0.5102040816326531, precision 0.512687969924812, recall 0.5354938271604938, F1 0.4944796805261922, AUC 0.7541887125220459
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.855640953228816e-05
epoch: 6 idx: 0 First Loss : 3.492274045944214, Second Loss : 3.322624683380127
epoch: 6 idx: 200 First Loss : 0.9306975704668766, Second Loss : 0.9548379115259914
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4930555555555556, precision 0.5509460654288241, recall 0.5521885521885522, F1 0.4896532053576072, AUC 0.7521043771043772
  Second-Tier acc 0.5208333333333334, precision 0.5763772175536882, recall 0.5795959595959596, F1 0.5163059163059164, AUC 0.7463131313131313
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5034013605442177, precision 0.549517487245682, recall 0.6014844209288653, F1 0.5053311319024032, AUC 0.7471095434058398
  Second-Tier acc 0.4489795918367347, precision 0.4793204731285227, recall 0.5163139329805996, F1 0.44787878787878793, AUC 0.7486772486772487
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.855640953228816e-05
epoch: 7 idx: 0 First Loss : 3.6653449535369873, Second Loss : 3.486243963241577
epoch: 7 idx: 200 First Loss : 0.9212601691373249, Second Loss : 0.9479982696464332
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4652777777777778, precision 0.5441776964235426, recall 0.5344107744107744, F1 0.4621787985978549, AUC 0.7531705948372615
  Second-Tier acc 0.4791666666666667, precision 0.5556599832915623, recall 0.5529292929292929, F1 0.47676767676767673, AUC 0.7585858585858586
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4965986394557823, precision 0.5642115578155623, recall 0.6109641387419166, F1 0.5011655011655012, AUC 0.7568158436213993
  Second-Tier acc 0.46938775510204084, precision 0.5655806182121972, recall 0.5515873015873015, F1 0.46719576719576716, AUC 0.7595348324514991
Test AUC: 0.7595, Test F1: 0.4672 (Best Epoch: 7)
Current LR: 2.855640953228816e-05
epoch: 8 idx: 0 First Loss : 3.799325704574585, Second Loss : 3.6065967082977295
epoch: 8 idx: 200 First Loss : 0.9154946883070046, Second Loss : 0.9447693949500423
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4652777777777778, precision 0.5491934430512017, recall 0.5465656565656566, F1 0.4644303462860164, AUC 0.7574747474747475
  Second-Tier acc 0.4583333333333333, precision 0.5499786871270248, recall 0.5276767676767676, F1 0.4625770893519372, AUC 0.765
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5102040816326531, precision 0.5979593318809006, recall 0.6344797178130511, F1 0.5147351600181789, AUC 0.7653708602782677
  Second-Tier acc 0.46938775510204084, precision 0.56692242114237, recall 0.5515873015873015, F1 0.47081081081081083, AUC 0.7805335097001763
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 9 idx: 0 First Loss : 3.8792946338653564, Second Loss : 3.672825813293457
epoch: 9 idx: 200 First Loss : 0.9104162429155902, Second Loss : 0.9422777353656195
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4583333333333333, precision 0.548935148817317, recall 0.5494612794612794, F1 0.45850971514808525, AUC 0.7560044893378226
  Second-Tier acc 0.4166666666666667, precision 0.5183333333333334, recall 0.47212121212121216, F1 0.41919191919191917, AUC 0.7616666666666667
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46938775510204084, precision 0.5811380400421496, recall 0.5706937095825985, F1 0.4684055008775632, AUC 0.7679918675289046
  Second-Tier acc 0.4897959183673469, precision 0.5833333333333334, recall 0.5753968253968255, F1 0.49122807017543857, AUC 0.7879739858906526
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 10 idx: 0 First Loss : 3.9308483600616455, Second Loss : 3.716273069381714
epoch: 10 idx: 200 First Loss : 0.9051439871105704, Second Loss : 0.9397235991600067
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.5176328502415459, recall 0.4955892255892255, F1 0.4136657838840124, AUC 0.7511728395061729
  Second-Tier acc 0.4166666666666667, precision 0.5186372269705603, recall 0.4746464646464647, F1 0.4150983519404572, AUC 0.7537373737373737
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.48299319727891155, precision 0.5936842105263157, recall 0.5903880070546738, F1 0.4802080245749239, AUC 0.7691125318440134
  Second-Tier acc 0.5510204081632653, precision 0.6353276353276353, recall 0.6468253968253969, F1 0.5522648083623694, AUC 0.7928240740740741
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 11 idx: 0 First Loss : 3.9507992267608643, Second Loss : 3.732113838195801
epoch: 11 idx: 200 First Loss : 0.8999047871633892, Second Loss : 0.9362212506259574
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3958333333333333, precision 0.5022700008273352, recall 0.4822558922558922, F1 0.39113181504485856, AUC 0.7451459034792368
  Second-Tier acc 0.3958333333333333, precision 0.4824434824434824, recall 0.43242424242424243, F1 0.3805714035893064, AUC 0.7488888888888888
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.48299319727891155, precision 0.5968079539508111, recall 0.5942092886537331, F1 0.47973009629730096, AUC 0.7644216637272194
  Second-Tier acc 0.5306122448979592, precision 0.6243386243386243, recall 0.6344797178130511, F1 0.5293210854186464, AUC 0.7965167548500882
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 12 idx: 0 First Loss : 3.937577962875366, Second Loss : 3.7537410259246826
epoch: 12 idx: 200 First Loss : 0.8957504954609548, Second Loss : 0.9339901868483302
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.4921516478931998, recall 0.46289562289562286, F1 0.3774559569559501, AUC 0.7345510662177329
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7425757575757576
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46938775510204084, precision 0.5882200981658486, recall 0.5762051734273957, F1 0.4637359900373599, AUC 0.7626763668430335
  Second-Tier acc 0.5306122448979592, precision 0.6243386243386243, recall 0.6344797178130511, F1 0.5293210854186464, AUC 0.8009810405643739
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 13 idx: 0 First Loss : 3.9311206340789795, Second Loss : 3.7521371841430664
epoch: 13 idx: 200 First Loss : 0.8927333575713364, Second Loss : 0.9325111248711152
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.47874070230064003, recall 0.45484848484848484, F1 0.3600954542808917, AUC 0.7237485970819305
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7276262626262625
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.58, recall 0.5600382128159906, F1 0.4436627996346966, AUC 0.7582059572800314
  Second-Tier acc 0.5102040816326531, precision 0.6148148148148148, recall 0.6221340388007054, F1 0.5062898966585574, AUC 0.8009810405643739
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 14 idx: 0 First Loss : 3.925377607345581, Second Loss : 3.736386299133301
epoch: 14 idx: 200 First Loss : 0.8900893128810645, Second Loss : 0.9319735748730414
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.4578735965931087, recall 0.43188552188552193, F1 0.33629624460108093, AUC 0.7136812570145903
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7182323232323232
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5815481986368062, recall 0.56385949441505, F1 0.44090662457455726, AUC 0.7550460513423477
  Second-Tier acc 0.5102040816326531, precision 0.6121794871794872, recall 0.6221340388007054, F1 0.503921568627451, AUC 0.7978395061728394
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 15 idx: 0 First Loss : 3.908708333969116, Second Loss : 3.726325035095215
epoch: 15 idx: 200 First Loss : 0.8881969114722665, Second Loss : 0.9316473423155252
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.45380855594270225, recall 0.4217845117845118, F1 0.33049914315180556, AUC 0.7023625140291806
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7042424242424242
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5799176954732511, recall 0.5579071134626691, F1 0.43839162270140397, AUC 0.7521678424456203
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7992173721340388
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 16 idx: 0 First Loss : 3.8868205547332764, Second Loss : 3.7095131874084473
epoch: 16 idx: 200 First Loss : 0.8867239893684268, Second Loss : 0.9318983102728733
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.4578735965931087, recall 0.43188552188552193, F1 0.33629624460108093, AUC 0.6912682379349047
  Second-Tier acc 0.3125, precision 0.41773399014778323, recall 0.3816161616161617, F1 0.2901709401709402, AUC 0.6969696969696969
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.5689833611973568, recall 0.5379188712522045, F1 0.4190033451397088, AUC 0.748848716441309
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7894620811287477
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 17 idx: 0 First Loss : 3.861414670944214, Second Loss : 3.704657554626465
epoch: 17 idx: 200 First Loss : 0.8854241142756322, Second Loss : 0.9324274632630323
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.46394032921810696, recall 0.4363299663299663, F1 0.3441102756892231, AUC 0.6838832772166105
  Second-Tier acc 0.3333333333333333, precision 0.44047619047619047, recall 0.4093939393939394, F1 0.31680911680911683, AUC 0.6912626262626264
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5730994152046783, recall 0.5476925338036449, F1 0.41895426996031615, AUC 0.746601263962375
  Second-Tier acc 0.4489795918367347, precision 0.5580246913580247, recall 0.5149911816578483, F1 0.4320587195641778, AUC 0.7854387125220459
Test AUC: 0.7805, Test F1: 0.4708 (Best Epoch: 8)
Current LR: 2.855640953228816e-05
epoch: 18 idx: 0 First Loss : 3.8734729290008545, Second Loss : 3.7176082134246826
epoch: 18 idx: 200 First Loss : 0.8857391192207104, Second Loss : 0.9314844194204264{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.2503235598644957, "droprate_2": 0.0, "lr": 2.210560918758515e-05, "weight_decay": 0.0006198618183632474, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.210560918758515e-05
epoch: 0 idx: 0 First Loss : 1.1359310150146484, Second Loss : 0.9452831149101257
epoch: 0 idx: 200 First Loss : 1.0886520280766843, Second Loss : 1.0901401742773862
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7331537598204264
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7281818181818182
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6623799725651578
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6478174603174603
Test AUC: 0.6478, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.210560918758515e-05
epoch: 1 idx: 0 First Loss : 2.0449135303497314, Second Loss : 1.9629579782485962
epoch: 1 idx: 200 First Loss : 1.0748892066935403, Second Loss : 1.0894530525996318
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748327721661055
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7455050505050504
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7040405153831081
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6843033509700177
Test AUC: 0.6843, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.210560918758515e-05
epoch: 2 idx: 0 First Loss : 2.1538889408111572, Second Loss : 2.0614941120147705
epoch: 2 idx: 200 First Loss : 1.0501256347518062, Second Loss : 1.0690885763708038
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.751111111111111
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7582323232323233
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7201401136586322
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7076719576719577
Test AUC: 0.7077, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.210560918758515e-05
epoch: 3 idx: 0 First Loss : 2.309633255004883, Second Loss : 2.1973493099212646
epoch: 3 idx: 200 First Loss : 1.0269875847062662, Second Loss : 1.0482065091604618
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.749685746352413
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7497474747474747
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7229448363707623
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.716986331569665
Test AUC: 0.7077, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.210560918758515e-05
epoch: 4 idx: 0 First Loss : 2.4988155364990234, Second Loss : 2.368457317352295
epoch: 4 idx: 200 First Loss : 0.9969173825498837, Second Loss : 1.01968503669275
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6388888888888888, precision 0.7241758241758242, recall 0.516969696969697, F1 0.5191238847447711, AUC 0.745016835016835
  Second-Tier acc 0.5625, precision 0.3162393162393162, recall 0.4033333333333333, F1 0.3452380952380952, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6598639455782312, precision 0.7633184523809523, recall 0.5317460317460317, F1 0.5256371101835827, AUC 0.7178497942386831
  Second-Tier acc 0.6530612244897959, precision 0.4278455284552846, recall 0.5416666666666666, F1 0.47303921568627444, AUC 0.7188051146384481
Test AUC: 0.7077, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.210560918758515e-05
epoch: 5 idx: 0 First Loss : 2.722231864929199, Second Loss : 2.5870323181152344
epoch: 5 idx: 200 First Loss : 0.9675368837715678, Second Loss : 0.9925177851274832
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6458333333333334, precision 0.6046332046332047, recall 0.6074747474747475, F1 0.6058478784272949, AUC 0.7471941638608305
  Second-Tier acc 0.6041666666666666, precision 0.5603174603174603, recall 0.5191919191919192, F1 0.47956487956487964, AUC 0.7574242424242424
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6122448979591837, precision 0.5719389507778377, recall 0.6069958847736626, F1 0.5819217995980352, AUC 0.7163616990005878
  Second-Tier acc 0.4897959183673469, precision 0.48188405797101447, recall 0.4772927689594357, F1 0.43238095238095237, AUC 0.7279541446208113
Test AUC: 0.7077, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.210560918758515e-05
epoch: 6 idx: 0 First Loss : 2.9738547801971436, Second Loss : 2.8186728954315186
epoch: 6 idx: 200 First Loss : 0.942041403275743, Second Loss : 0.968804401044377
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5694444444444444, precision 0.5765255583590319, recall 0.5857912457912459, F1 0.5542169829403872, AUC 0.7586531986531986
  Second-Tier acc 0.4791666666666667, precision 0.5324209840338873, recall 0.4994949494949495, F1 0.43415919339311954, AUC 0.7658080808080808
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5714285714285714, precision 0.5647863247863247, recall 0.6311728395061729, F1 0.5606350452085479, AUC 0.733110425240055
  Second-Tier acc 0.46938775510204084, precision 0.4630812324929972, recall 0.5121252204585538, F1 0.417027417027417, AUC 0.7538029100529101
Test AUC: 0.7538, Test F1: 0.4170 (Best Epoch: 6)
Current LR: 2.210560918758515e-05
epoch: 7 idx: 0 First Loss : 3.1970274448394775, Second Loss : 3.033046245574951
epoch: 7 idx: 200 First Loss : 0.9243755764999793, Second Loss : 0.9523163043537098
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4930555555555556, precision 0.5393514542539791, recall 0.54003367003367, F1 0.4840447924560074, AUC 0.7711503928170594
  Second-Tier acc 0.4583333333333333, precision 0.5135176651305683, recall 0.4861616161616162, F1 0.41604528116156025, AUC 0.7767171717171717
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4897959183673469, precision 0.526936936936937, recall 0.58179012345679, F1 0.48833210513387376, AUC 0.7418981481481483
  Second-Tier acc 0.40816326530612246, precision 0.4647435897435897, recall 0.48655202821869487, F1 0.38720538720538716, AUC 0.7523699294532628
Test AUC: 0.7524, Test F1: 0.3872 (Best Epoch: 7)
Current LR: 2.210560918758515e-05
epoch: 8 idx: 0 First Loss : 3.3908064365386963, Second Loss : 3.203169345855713
epoch: 8 idx: 200 First Loss : 0.9144364769306423, Second Loss : 0.9433817285859022
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4861111111111111, precision 0.5477904463819957, recall 0.5469023569023569, F1 0.48132430937983967, AUC 0.7771324354657688
  Second-Tier acc 0.3958333333333333, precision 0.4550653594771242, recall 0.4291919191919192, F1 0.34005011754372366, AUC 0.7854040404040403
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5034013605442177, precision 0.5578019602145801, recall 0.6074368018812463, F1 0.5035431716546267, AUC 0.7474096119929454
  Second-Tier acc 0.40816326530612246, precision 0.5137931034482759, recall 0.498015873015873, F1 0.39939939939939945, AUC 0.745756172839506
Test AUC: 0.7458, Test F1: 0.3994 (Best Epoch: 8)
Current LR: 2.210560918758515e-05
epoch: 9 idx: 0 First Loss : 3.528709650039673, Second Loss : 3.318704605102539
epoch: 9 idx: 200 First Loss : 0.9067562728128697, Second Loss : 0.9380442645002286
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4722222222222222, precision 0.541061061061061, recall 0.5428282828282828, F1 0.46711732711732706, AUC 0.7769360269360269
  Second-Tier acc 0.375, precision 0.446031746031746, recall 0.41585858585858587, F1 0.3202440550688361, AUC 0.784040404040404
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.5732021065354398, recall 0.5950911228689006, F1 0.4833634360257009, AUC 0.7477892906133646
  Second-Tier acc 0.40816326530612246, precision 0.5388007054673721, recall 0.5094797178130511, F1 0.4047619047619048, AUC 0.7536926807760141
Test AUC: 0.7458, Test F1: 0.3994 (Best Epoch: 8)
Current LR: 2.210560918758515e-05
epoch: 10 idx: 0 First Loss : 3.6272315979003906, Second Loss : 3.3980321884155273
epoch: 10 idx: 200 First Loss : 0.9013808350569907, Second Loss : 0.9339569452362348
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4722222222222222, precision 0.5552199600599929, recall 0.5558249158249158, F1 0.47115266789205884, AUC 0.7719640852974187
  Second-Tier acc 0.4166666666666667, precision 0.5114087301587301, recall 0.4764646464646464, F1 0.39166666666666666, AUC 0.7869191919191919
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.5597222222222222, recall 0.5470311581422692, F1 0.44274189862425156, AUC 0.7486772486772487
  Second-Tier acc 0.42857142857142855, precision 0.5564102564102563, recall 0.533289241622575, F1 0.4275668888244953, AUC 0.7589285714285715
Test AUC: 0.7589, Test F1: 0.4276 (Best Epoch: 10)
Current LR: 2.210560918758515e-05
epoch: 11 idx: 0 First Loss : 3.6966259479522705, Second Loss : 3.4559860229492188
epoch: 11 idx: 200 First Loss : 0.8968580631465091, Second Loss : 0.9298501837864259
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4375, precision 0.5315166454478967, recall 0.5248148148148148, F1 0.4364596362117535, AUC 0.7667901234567903
  Second-Tier acc 0.4166666666666667, precision 0.5039938556067588, recall 0.4764646464646464, F1 0.39078073089700993, AUC 0.7875252525252526
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.5565656565656566, recall 0.5388007054673721, F1 0.429193899782135, AUC 0.746656378600823
  Second-Tier acc 0.4489795918367347, precision 0.5692307692307692, recall 0.5749559082892416, F1 0.4471747319617502, AUC 0.7647156084656084
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 12 idx: 0 First Loss : 3.7481517791748047, Second Loss : 3.4858651161193848
epoch: 12 idx: 200 First Loss : 0.8917786350093819, Second Loss : 0.9251305731523096
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4236111111111111, precision 0.5218189610667913, recall 0.5176094276094276, F1 0.42198883870538656, AUC 0.7630303030303031
  Second-Tier acc 0.4583333333333333, precision 0.55103995621237, recall 0.5370707070707071, F1 0.44878932484977024, AUC 0.7785858585858586
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5565656565656566, recall 0.5388007054673721, F1 0.429193899782135, AUC 0.7426881246325691
  Second-Tier acc 0.46938775510204084, precision 0.5816993464052287, recall 0.5987654320987654, F1 0.4695852534562212, AUC 0.769455467372134
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 13 idx: 0 First Loss : 3.776273727416992, Second Loss : 3.501469850540161
epoch: 13 idx: 200 First Loss : 0.8869156678014931, Second Loss : 0.9203160193364196
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.4987537387836491, recall 0.48141414141414146, F1 0.3927815664861681, AUC 0.7584006734006734
  Second-Tier acc 0.4583333333333333, precision 0.54796918767507, recall 0.5421212121212121, F1 0.4583333333333333, AUC 0.7694444444444445
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.5501602564102565, recall 0.5145502645502645, F1 0.4071084678561314, AUC 0.7346475112678816
  Second-Tier acc 0.4897959183673469, precision 0.594896331738437, recall 0.6225749559082893, F1 0.4917748917748918, AUC 0.769510582010582
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 14 idx: 0 First Loss : 3.7952117919921875, Second Loss : 3.500471353530884
epoch: 14 idx: 200 First Loss : 0.8825082513144639, Second Loss : 0.9157950335311986
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3888888888888889, precision 0.49211836676625414, recall 0.46734006734006733, F1 0.3849994091929576, AUC 0.7496520763187431
  Second-Tier acc 0.3958333333333333, precision 0.5005050505050505, recall 0.4732323232323233, F1 0.3953194180898166, AUC 0.7675757575757576
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.41496598639455784, precision 0.5540844166265447, recall 0.5165343915343915, F1 0.41201647367638405, AUC 0.7309854497354498
  Second-Tier acc 0.4897959183673469, precision 0.5944444444444444, recall 0.6047178130511464, F1 0.4897710808461316, AUC 0.7639991181657848
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 15 idx: 0 First Loss : 3.805304765701294, Second Loss : 3.4830808639526367
epoch: 15 idx: 200 First Loss : 0.8788194125917838, Second Loss : 0.9109798059625023
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.4770766411333498, recall 0.44835016835016833, F1 0.36377958958604123, AUC 0.7371717171717171
  Second-Tier acc 0.3958333333333333, precision 0.5005050505050505, recall 0.4732323232323233, F1 0.3953194180898166, AUC 0.7544949494949496
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5699233716475096, recall 0.5441651969429747, F1 0.42929623710845055, AUC 0.7272499020184205
  Second-Tier acc 0.42857142857142855, precision 0.551487414187643, recall 0.5090388007054674, F1 0.4228738542464033, AUC 0.767636684303351
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 16 idx: 0 First Loss : 3.795886278152466, Second Loss : 3.4640073776245117
epoch: 16 idx: 200 First Loss : 0.8763708273031104, Second Loss : 0.9089317369687172
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4683694083694083, recall 0.4504040404040404, F1 0.3527809407959221, AUC 0.7260437710437712
  Second-Tier acc 0.375, precision 0.4823232323232323, recall 0.447979797979798, F1 0.37330971000325835, AUC 0.741111111111111
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.5663492063492064, recall 0.5340975896531451, F1 0.4199371457103416, AUC 0.7238940329218106
  Second-Tier acc 0.4489795918367347, precision 0.5648148148148149, recall 0.5328483245149912, F1 0.4408986266571406, AUC 0.7699514991181657
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 17 idx: 0 First Loss : 3.792527198791504, Second Loss : 3.43719220161438
epoch: 17 idx: 200 First Loss : 0.8742313881101207, Second Loss : 0.9062186439639763
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.46274509803921565, recall 0.4363299663299663, F1 0.344661903282593, AUC 0.714652076318743
  Second-Tier acc 0.375, precision 0.481439105008899, recall 0.447979797979798, F1 0.3719165085388994, AUC 0.7241919191919193
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.566951566951567, recall 0.5319664902998237, F1 0.4157051282051282, AUC 0.7196563296100335
  Second-Tier acc 0.42857142857142855, precision 0.5448717948717948, recall 0.4911816578483245, F1 0.4150326797385621, AUC 0.7670304232804233
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 18 idx: 0 First Loss : 3.787194013595581, Second Loss : 3.4079442024230957
epoch: 18 idx: 200 First Loss : 0.8732423606851087, Second Loss : 0.9045125707498617
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3472222222222222, precision 0.4562091503267974, recall 0.4270707070707071, F1 0.33699906803355084, AUC 0.7025757575757575
  Second-Tier acc 0.375, precision 0.481439105008899, recall 0.447979797979798, F1 0.3719165085388994, AUC 0.709040404040404
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4217687074829932, precision 0.5652680652680653, recall 0.527851263962375, F1 0.40816122584943376, AUC 0.7146837644522831
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7666446208112875
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11)
Current LR: 2.210560918758515e-05
epoch: 19 idx: 0 First Loss : 3.7844250202178955, Second Loss : 3.3836822509765625
epoch: 19 idx: 200 First Loss : 0.8731195774851414, Second Loss : 0.9040225992322116
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3402777777777778, precision 0.44982993197278914, recall 0.41781144781144786, F1 0.32855572907629127, AUC 0.6945510662177329
  Second-Tier acc 0.3541666666666667, precision 0.46296296296296297, recall 0.4202020202020202, F1 0.34879672299027137, AUC 0.6974242424242424
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.40816326530612246, precision 0.5525943396226415, recall 0.5000734861845973, F1 0.39112759544165926, AUC 0.7119464040760337
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.763833774250441
Test AUC: 0.7647, Test F1: 0.4472 (Best Epoch: 11){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.37803126112947427, "droprate_2": 0.0, "lr": 1.7061540649160747e-05, "weight_decay": 0.00012220848663498112, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.7061540649160747e-05
epoch: 0 idx: 0 First Loss : 0.9385576844215393, Second Loss : 0.9657062888145447
epoch: 0 idx: 200 First Loss : 1.079867655809839, Second Loss : 1.0675526854410693
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7168181818181818
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7276262626262627
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6118214775622183
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6313381834215167
Test AUC: 0.6313, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.7061540649160747e-05
epoch: 1 idx: 0 First Loss : 2.0311191082000732, Second Loss : 2.0415091514587402
epoch: 1 idx: 200 First Loss : 1.0807473223600814, Second Loss : 1.090525474417862
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7363355780022447
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7483838383838384
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6694285224377817
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6775242504409172
Test AUC: 0.6775, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.7061540649160747e-05
epoch: 2 idx: 0 First Loss : 2.184199571609497, Second Loss : 2.1050777435302734
epoch: 2 idx: 200 First Loss : 1.062961676968864, Second Loss : 1.078517180918461
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7441470258136924
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7602020202020201
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6981493729178915
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7028769841269842
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 3 idx: 0 First Loss : 2.295245885848999, Second Loss : 2.200202703475952
epoch: 3 idx: 200 First Loss : 1.0453975363009012, Second Loss : 1.0642536006756682
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7436195286195287
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482323232323232
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7125587889476779
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7148368606701939
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 4 idx: 0 First Loss : 2.4337332248687744, Second Loss : 2.3358113765716553
epoch: 4 idx: 200 First Loss : 1.0258715646851122, Second Loss : 1.0469409464603632
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5833333333333334, precision 0.40880796763149707, recall 0.43555555555555553, F1 0.3887893864013267, AUC 0.741290684624018
  Second-Tier acc 0.5208333333333334, precision 0.1851851851851852, recall 0.3333333333333333, F1 0.2380952380952381, AUC 0.7494444444444444
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6054421768707483, precision 0.6763071895424836, recall 0.42658730158730157, F1 0.4025122288677539, AUC 0.7092641583382324
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.7125771604938271
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 5 idx: 0 First Loss : 2.620863914489746, Second Loss : 2.497870683670044
epoch: 5 idx: 200 First Loss : 1.0031322924726045, Second Loss : 1.0261177661184648
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6736111111111112, precision 0.6055162164524871, recall 0.5909427609427609, F1 0.5585212541734281, AUC 0.7393097643097644
  Second-Tier acc 0.6458333333333334, precision 0.6130718954248365, recall 0.5245454545454545, F1 0.533091202582728, AUC 0.7503535353535353
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6394557823129252, precision 0.6519795657726691, recall 0.6039094650205762, F1 0.623015873015873, AUC 0.7054918675289046
  Second-Tier acc 0.6530612244897959, precision 0.6019607843137255, recall 0.576058201058201, F1 0.5527434250471351, AUC 0.7098214285714285
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 6 idx: 0 First Loss : 2.824458360671997, Second Loss : 2.676208019256592
epoch: 6 idx: 200 First Loss : 0.9792968455461127, Second Loss : 1.0042230467224003
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6041666666666666, precision 0.5728425696167632, recall 0.5898316498316498, F1 0.5680922579162168, AUC 0.734753086419753
  Second-Tier acc 0.6458333333333334, precision 0.6449494949494949, recall 0.6112121212121212, F1 0.5996818940342094, AUC 0.7450505050505051
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6258503401360545, precision 0.5996766130694703, recall 0.6402851263962375, F1 0.612288505145648, AUC 0.7190623162845385
  Second-Tier acc 0.5306122448979592, precision 0.4981060606060606, recall 0.5249118165784833, F1 0.4899092970521542, AUC 0.7270723104056437
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 7 idx: 0 First Loss : 3.0363998413085938, Second Loss : 2.858550548553467
epoch: 7 idx: 200 First Loss : 0.9579025960865601, Second Loss : 0.9839574099328388
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5486111111111112, precision 0.5578080120937264, recall 0.5645117845117845, F1 0.5362705724860225, AUC 0.7333277216610551
  Second-Tier acc 0.5416666666666666, precision 0.5434920634920635, recall 0.5564646464646464, F1 0.5033264033264033, AUC 0.7403535353535354
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4965986394557823, precision 0.5021419872483702, recall 0.5570252792475014, F1 0.48409006862602455, AUC 0.7302995786792085
  Second-Tier acc 0.5102040816326531, precision 0.5157051282051283, recall 0.5712081128747796, F1 0.4916738443870227, AUC 0.7344025573192239
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 8 idx: 0 First Loss : 3.2341833114624023, Second Loss : 3.033024787902832
epoch: 8 idx: 200 First Loss : 0.9404315078881249, Second Loss : 0.9678276530212134
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4722222222222222, precision 0.5225694444444444, recall 0.5130976430976432, F1 0.4665782085304411, AUC 0.7348035914702581
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7556060606060605
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46258503401360546, precision 0.49868719417591595, recall 0.540270429159318, F1 0.4569417510593981, AUC 0.7322775818146189
  Second-Tier acc 0.4489795918367347, precision 0.47446514837819187, recall 0.5227072310405644, F1 0.4319635255905909, AUC 0.7479607583774252
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7061540649160747e-05
epoch: 9 idx: 0 First Loss : 3.411388635635376, Second Loss : 3.1841115951538086
epoch: 9 idx: 200 First Loss : 0.9272454686333143, Second Loss : 0.9560277814610829
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4513888888888889, precision 0.5097208118092041, recall 0.4915824915824916, F1 0.4386073428129502, AUC 0.7408305274971941
  Second-Tier acc 0.4375, precision 0.5059523809523809, recall 0.48979797979797973, F1 0.4117039964866052, AUC 0.7819696969696969
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.49732392957182875, recall 0.524103468547913, F1 0.4368472107602543, AUC 0.7382177150695668
  Second-Tier acc 0.40816326530612246, precision 0.4497863247863248, recall 0.498015873015873, F1 0.39844491927825265, AUC 0.7517085537918872
Test AUC: 0.7517, Test F1: 0.3984 (Best Epoch: 9)
Current LR: 1.7061540649160747e-05
epoch: 10 idx: 0 First Loss : 3.56952166557312, Second Loss : 3.314603090286255
epoch: 10 idx: 200 First Loss : 0.9180072750710878, Second Loss : 0.9485704837580077
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4097222222222222, precision 0.4837037037037037, recall 0.45925925925925926, F1 0.39686539686539685, AUC 0.746290684624018
  Second-Tier acc 0.4583333333333333, precision 0.5337301587301587, recall 0.5201010101010101, F1 0.44068950373298205, AUC 0.7848989898989899
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5151257472686044, recall 0.5358612580834804, F1 0.4452080204292594, AUC 0.7426452576915539
  Second-Tier acc 0.42857142857142855, precision 0.5377777777777778, recall 0.5218253968253969, F1 0.4230233368164403, AUC 0.7572200176366843
Test AUC: 0.7572, Test F1: 0.4230 (Best Epoch: 10)
Current LR: 1.7061540649160747e-05
epoch: 11 idx: 0 First Loss : 3.702242612838745, Second Loss : 3.4236674308776855
epoch: 11 idx: 200 First Loss : 0.9110907493159175, Second Loss : 0.9430554092708808
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.4850877192982456, recall 0.44676767676767676, F1 0.37877796342708625, AUC 0.7501290684624018
  Second-Tier acc 0.4583333333333333, precision 0.5337301587301587, recall 0.5201010101010101, F1 0.44068950373298205, AUC 0.7877777777777778
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4421768707482993, precision 0.541789018344858, recall 0.5355673133450911, F1 0.4400637196336121, AUC 0.7428350970017638
  Second-Tier acc 0.42857142857142855, precision 0.548202614379085, recall 0.533289241622575, F1 0.42724654377880183, AUC 0.759920634920635
Test AUC: 0.7599, Test F1: 0.4272 (Best Epoch: 11)
Current LR: 1.7061540649160747e-05
epoch: 12 idx: 0 First Loss : 3.806607246398926, Second Loss : 3.5035293102264404
epoch: 12 idx: 200 First Loss : 0.9050363898323617, Second Loss : 0.9389054369765208
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.48729069626902444, recall 0.45242424242424245, F1 0.38028614411593137, AUC 0.7501851851851852
  Second-Tier acc 0.4375, precision 0.5192307692307692, recall 0.5067676767676768, F1 0.41944444444444445, AUC 0.7915151515151515
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5489220563847429, recall 0.5371105232216343, F1 0.4292281792281793, AUC 0.7487874779541447
  Second-Tier acc 0.4489795918367347, precision 0.562200956937799, recall 0.5570987654320988, F1 0.44935064935064933, AUC 0.7779431216931217
Test AUC: 0.7779, Test F1: 0.4494 (Best Epoch: 12)
Current LR: 1.7061540649160747e-05
epoch: 13 idx: 0 First Loss : 3.8842127323150635, Second Loss : 3.5482969284057617
epoch: 13 idx: 200 First Loss : 0.8995782387215848, Second Loss : 0.9349686193757167
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.49041889483065954, recall 0.4637373737373737, F1 0.3817523056653491, AUC 0.7473120089786756
  Second-Tier acc 0.4583333333333333, precision 0.5420915032679738, recall 0.554040404040404, F1 0.4485822227757712, AUC 0.7899494949494948
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.5539288668320926, recall 0.5406378600823045, F1 0.4239319567220335, AUC 0.7525658926121889
  Second-Tier acc 0.46938775510204084, precision 0.5773524720893143, recall 0.5809082892416225, F1 0.47336860670194003, AUC 0.7802028218694885
Test AUC: 0.7779, Test F1: 0.4494 (Best Epoch: 12)
Current LR: 1.7061540649160747e-05
epoch: 14 idx: 0 First Loss : 3.9412460327148438, Second Loss : 3.5753705501556396
epoch: 14 idx: 200 First Loss : 0.8939883420081689, Second Loss : 0.9311930948789625
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.5087418300653594, recall 0.4996969696969697, F1 0.4045157351608964, AUC 0.7444500561167228
  Second-Tier acc 0.4375, precision 0.5317460317460317, recall 0.5287878787878788, F1 0.4351783968719452, AUC 0.7927777777777777
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.548611111111111, recall 0.522339800117578, F1 0.40296387915435533, AUC 0.7528782088967274
  Second-Tier acc 0.46938775510204084, precision 0.5773524720893143, recall 0.5809082892416225, F1 0.47336860670194003, AUC 0.7782738095238096
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14)
Current LR: 1.7061540649160747e-05
epoch: 15 idx: 0 First Loss : 3.9845244884490967, Second Loss : 3.583451271057129
epoch: 15 idx: 200 First Loss : 0.8890039938112805, Second Loss : 0.9272827298649174
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.515625, recall 0.5106397306397307, F1 0.4129013254786451, AUC 0.74165544332211
  Second-Tier acc 0.4375, precision 0.5340706839562674, recall 0.5313131313131313, F1 0.4364326375711575, AUC 0.789141414141414
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5580488581204742, recall 0.5322604350382129, F1 0.41574932563920114, AUC 0.7540723593964335
  Second-Tier acc 0.46938775510204084, precision 0.5773524720893143, recall 0.5809082892416225, F1 0.47336860670194003, AUC 0.7849426807760141
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14)
Current LR: 1.7061540649160747e-05
epoch: 16 idx: 0 First Loss : 4.015004634857178, Second Loss : 3.5823726654052734
epoch: 16 idx: 200 First Loss : 0.8840517426009258, Second Loss : 0.9237439685503475
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3888888888888889, precision 0.4972701149425287, recall 0.4736026936026936, F1 0.38718879412950885, AUC 0.7370426487093154
  Second-Tier acc 0.4375, precision 0.5340706839562674, recall 0.5313131313131313, F1 0.4364326375711575, AUC 0.7851010101010102
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5628991060025542, recall 0.5401969429747208, F1 0.4221645868445795, AUC 0.7528353419557123
  Second-Tier acc 0.46938775510204084, precision 0.5865751334858886, recall 0.5923721340388007, F1 0.47225657029578594, AUC 0.7835648148148149
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14)
Current LR: 1.7061540649160747e-05
epoch: 17 idx: 0 First Loss : 4.040901184082031, Second Loss : 3.570392608642578
epoch: 17 idx: 200 First Loss : 0.8797183468780336, Second Loss : 0.920479828261293
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3819444444444444, precision 0.49339743589743595, recall 0.4668686868686869, F1 0.3789171231031696, AUC 0.7321773288439956
  Second-Tier acc 0.3958333333333333, precision 0.5053418803418803, recall 0.47575757575757577, F1 0.3945281687217171, AUC 0.7791414141414141
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.43537414965986393, precision 0.5753174603174603, recall 0.5598912404467961, F1 0.4335411343143301, AUC 0.7503429355281207
  Second-Tier acc 0.46938775510204084, precision 0.5802469135802469, recall 0.5566578483245149, F1 0.46104422681055457, AUC 0.7868165784832452
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14)
Current LR: 1.7061540649160747e-05
epoch: 18 idx: 0 First Loss : 4.055813789367676, Second Loss : 3.5451455116271973
epoch: 18 idx: 200 First Loss : 0.8759528615729726, Second Loss : 0.917635444925857
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4760683760683761, recall 0.4430639730639731, F1 0.35729522626074345, AUC 0.7296408529741862
  Second-Tier acc 0.4166666666666667, precision 0.5181623931623932, recall 0.5060606060606061, F1 0.41254618673973514, AUC 0.7699999999999999
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5783549783549783, recall 0.5637125220458553, F1 0.43257144630003896, AUC 0.7483894277875759
  Second-Tier acc 0.46938775510204084, precision 0.5802469135802469, recall 0.5566578483245149, F1 0.46104422681055457, AUC 0.7830687830687831
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14)
Current LR: 1.7061540649160747e-05
epoch: 19 idx: 0 First Loss : 4.065207004547119, Second Loss : 3.510964870452881
epoch: 19 idx: 200 First Loss : 0.8724852888225184, Second Loss : 0.9152046366732577
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4691697191697191, recall 0.4386195286195287, F1 0.3493230206713352, AUC 0.7221885521885523
  Second-Tier acc 0.3958333333333333, precision 0.5020915032679739, recall 0.47575757575757577, F1 0.3936060643513368, AUC 0.7728282828282828
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5726495726495726, recall 0.5498236331569665, F1 0.4246794871794872, AUC 0.7453887419165198
  Second-Tier acc 0.4489795918367347, precision 0.5692307692307692, recall 0.5264550264550264, F1 0.43001443001443, AUC 0.7810846560846562
Test AUC: 0.7783, Test F1: 0.4734 (Best Epoch: 14){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.4856374339183946, "droprate_2": 0.0, "lr": 0.000447753645031289, "weight_decay": 7.368479812716598e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.35717698637435746, "droprate_2": 0.0, "lr": 0.00017394414190276763, "weight_decay": 0.0005839131447178848, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00017394414190276763
epoch: 0 idx: 0 First Loss : 1.089806318283081, Second Loss : 1.074526309967041
epoch: 0 idx: 200 First Loss : 1.096637488264053, Second Loss : 1.0925069349025613
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7480976430976432
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7704545454545455
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7174272486772487
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7123567019400353
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017394414190276763
epoch: 1 idx: 0 First Loss : 1.8343148231506348, Second Loss : 1.8663883209228516
epoch: 1 idx: 200 First Loss : 0.9871873605755431, Second Loss : 0.9931701975527094
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7335409652076318
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7492424242424242
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.744519155398785
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7333002645502645
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017394414190276763
epoch: 2 idx: 0 First Loss : 2.1806957721710205, Second Loss : 2.303886890411377
epoch: 2 idx: 200 First Loss : 0.9374145288113042, Second Loss : 0.9451464326375753
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.3883081687959737, recall 0.44565656565656564, F1 0.39393939393939387, AUC 0.7297811447811448
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7506060606060606
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5918367346938775, precision 0.3125984251968504, recall 0.38095238095238093, F1 0.32413151364764264, AUC 0.7285297864001569
  Second-Tier acc 0.5918367346938775, precision 0.6212121212121212, recall 0.3988095238095238, F1 0.3646322378716745, AUC 0.7283950617283951
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017394414190276763
epoch: 3 idx: 0 First Loss : 3.2126076221466064, Second Loss : 3.365321636199951
epoch: 3 idx: 200 First Loss : 0.9136653778639006, Second Loss : 0.9315707365986868
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.5717183688570335, recall 0.577878787878788, F1 0.5360032766500744, AUC 0.7369135802469137
  Second-Tier acc 0.4791666666666667, precision 0.5264957264957265, recall 0.5052525252525253, F1 0.4340154547056307, AUC 0.7664646464646466
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5170068027210885, precision 0.5291867954911433, recall 0.594429747207525, F1 0.5117003367003368, AUC 0.7326633842837547
  Second-Tier acc 0.5918367346938775, precision 0.6116526610644257, recall 0.6014109347442681, F1 0.5779331779331779, AUC 0.7536926807760141
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017394414190276763
epoch: 4 idx: 0 First Loss : 3.6944711208343506, Second Loss : 3.8101272583007812
epoch: 4 idx: 200 First Loss : 0.9085986169740854, Second Loss : 0.9252874256570393
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4097222222222222, precision 0.4361964100281857, recall 0.448047138047138, F1 0.33296419342930966, AUC 0.7684848484848485
  Second-Tier acc 0.4166666666666667, precision 0.726120857699805, recall 0.4677777777777778, F1 0.35780466032566877, AUC 0.7912121212121211
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4421768707482993, precision 0.44859813084112155, recall 0.41865079365079366, F1 0.3473181037334216, AUC 0.7230673133450911
  Second-Tier acc 0.46938775510204084, precision 0.5040106951871658, recall 0.45083774250440917, F1 0.39766081871345027, AUC 0.7504960317460317
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 5 idx: 0 First Loss : 3.861640214920044, Second Loss : 3.9438886642456055
epoch: 5 idx: 200 First Loss : 0.9047183263514061, Second Loss : 0.9254579570871866
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.36837944664031624, recall 0.41333333333333333, F1 0.2723599888548342, AUC 0.732598204264871
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7624747474747475
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4968944099378882, recall 0.43422986478542036, F1 0.34858946078906455, AUC 0.6758953066823438
  Second-Tier acc 0.4489795918367347, precision 0.45045045045045046, recall 0.42063492063492064, F1 0.33660130718954245, AUC 0.7119157848324514
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 6 idx: 0 First Loss : 3.8271636962890625, Second Loss : 4.006241798400879
epoch: 6 idx: 200 First Loss : 0.8956933136101561, Second Loss : 0.921132851598219
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.375, precision 0.37565217391304345, recall 0.4266666666666667, F1 0.28864864864864864, AUC 0.6958305274971942
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7296464646464647
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.42857142857142855, precision 0.4491525423728813, recall 0.4159318048206937, F1 0.3132281553398058, AUC 0.64564961787184
  Second-Tier acc 0.4489795918367347, precision 0.45045045045045046, recall 0.42063492063492064, F1 0.33660130718954245, AUC 0.6800595238095237
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 7 idx: 0 First Loss : 3.79264235496521, Second Loss : 4.03391170501709
epoch: 7 idx: 200 First Loss : 0.8894689776714595, Second Loss : 0.914785699924658
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3680555555555556, precision 0.38387216648086214, recall 0.4222222222222222, F1 0.28272108843537413, AUC 0.6764421997755331
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7033333333333333
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.504708097928437, recall 0.4339359200470312, F1 0.34049145299145295, AUC 0.6493974132863021
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.670083774250441
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 8 idx: 0 First Loss : 4.136738300323486, Second Loss : 4.254434585571289
epoch: 8 idx: 200 First Loss : 0.8985202511655519, Second Loss : 0.9125355900009279
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.375, precision 0.3841036414565826, recall 0.4266666666666667, F1 0.28615098351940454, AUC 0.6713636363636363
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6945959595959597
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.6157024793388429, recall 0.4459876543209877, F1 0.3498011191262725, AUC 0.6485400744660005
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6603835978835978
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 9 idx: 0 First Loss : 4.150357723236084, Second Loss : 4.0828328132629395
epoch: 9 idx: 200 First Loss : 0.896035666336072, Second Loss : 0.9111918221941375
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4027777777777778, precision 0.38300849575212387, recall 0.4444444444444444, F1 0.30890505890505887, AUC 0.6764590347923681
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6867676767676768
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.4376543209876543, recall 0.44032921810699593, F1 0.3333333333333333, AUC 0.665754213207917
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6511794532627866
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 10 idx: 0 First Loss : 4.456131458282471, Second Loss : 3.867109537124634
epoch: 10 idx: 200 First Loss : 0.896257879124246, Second Loss : 0.9030675436911608
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.42816091954022983, recall 0.4225925925925926, F1 0.2881548826804016, AUC 0.6692985409652077
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.686969696969697
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.5452380952380952, recall 0.44341563786008226, F1 0.3478634601811435, AUC 0.6647254066235547
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6579034391534392
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 11 idx: 0 First Loss : 3.8500216007232666, Second Loss : 3.6827545166015625
epoch: 11 idx: 200 First Loss : 0.8794195745688002, Second Loss : 0.8909733929248256
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.375, precision 0.4333190394511149, recall 0.43629629629629635, F1 0.31449859937585223, AUC 0.6716217732884399
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6904545454545454
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5048286604361371, recall 0.43349500293944737, F1 0.3519643910699795, AUC 0.6726496668626298
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6625881834215167
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 12 idx: 0 First Loss : 3.8053226470947266, Second Loss : 3.943051815032959
epoch: 12 idx: 200 First Loss : 0.8725185400540814, Second Loss : 0.887288121560146
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3680555555555556, precision 0.5448179271708683, recall 0.4318518518518519, F1 0.3030701754385965, AUC 0.6692424242424243
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6793434343434344
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.5601469237832873, recall 0.44341563786008226, F1 0.34823678686887094, AUC 0.6720005388986872
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6749889770723104
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 13 idx: 0 First Loss : 3.9148571491241455, Second Loss : 3.713560104370117
epoch: 13 idx: 200 First Loss : 0.8594008650566568, Second Loss : 0.884764508313102
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3611111111111111, precision 0.4725885225885225, recall 0.4274074074074074, F1 0.29697266421868623, AUC 0.6661279461279461
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6807070707070707
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5601469237832873, recall 0.44341563786008226, F1 0.34823678686887094, AUC 0.67681388398981
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6881613756613757
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 14 idx: 0 First Loss : 4.082172393798828, Second Loss : 3.766199827194214
epoch: 14 idx: 200 First Loss : 0.8571281369319573, Second Loss : 0.8778203733553036
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.4171685340802988, recall 0.4140740740740741, F1 0.2793172041430265, AUC 0.6654320987654322
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6773737373737374
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5085470085470086, recall 0.4351851851851852, F1 0.3343497871799759, AUC 0.6816823437193807
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6889880952380952
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 15 idx: 0 First Loss : 4.053349494934082, Second Loss : 3.7707715034484863
epoch: 15 idx: 200 First Loss : 0.8496838094470964, Second Loss : 0.8684068415273778
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.4351935646053293, recall 0.4140740740740741, F1 0.2771014492753623, AUC 0.6649102132435466
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6797474747474747
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5166666666666667, recall 0.43106995884773663, F1 0.3277014509507507, AUC 0.6910028414658044
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7052469135802469
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 16 idx: 0 First Loss : 4.07449197769165, Second Loss : 3.7481772899627686
epoch: 16 idx: 200 First Loss : 0.8404179408018844, Second Loss : 0.8630293656017997
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3402777777777778, precision 0.4765300059417706, recall 0.4140740740740741, F1 0.27605244996549344, AUC 0.6669865319865319
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6753535353535353
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.5295698924731183, recall 0.42283950617283944, F1 0.314508032128514, AUC 0.6965632961003331
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.7010030864197531
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 17 idx: 0 First Loss : 4.087192535400391, Second Loss : 3.7576208114624023
epoch: 17 idx: 200 First Loss : 0.8334475344039882, Second Loss : 0.8567273173004959
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3263888888888889, precision 0.4162393162393163, recall 0.40518518518518515, F1 0.26333333333333336, AUC 0.667732884399551
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6765151515151514
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3877551020408163, precision 0.5077605321507761, recall 0.41460905349794236, F1 0.2999907893524915, AUC 0.6986331569664902
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6998456790123457
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 18 idx: 0 First Loss : 4.087740421295166, Second Loss : 3.7732510566711426
epoch: 18 idx: 200 First Loss : 0.8254155396301831, Second Loss : 0.8497849046134117
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.40720390720390726, recall 0.4007407407407408, F1 0.2562745547657265, AUC 0.6666778900112234
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6717171717171717
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3877551020408163, precision 0.4954248366013072, recall 0.41460905349794236, F1 0.3002996592265787, AUC 0.7021237507348618
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.7024911816578484
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4)
Current LR: 0.00017394414190276763
epoch: 19 idx: 0 First Loss : 4.101670742034912, Second Loss : 3.870793104171753
epoch: 19 idx: 200 First Loss : 0.8274889003274004, Second Loss : 0.8541318884688202
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3194444444444444, precision 0.40720390720390726, recall 0.4007407407407408, F1 0.2562745547657265, AUC 0.6562626262626263
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6606060606060606
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.38095238095238093, precision 0.5068426197458455, recall 0.4104938271604938, F1 0.2927914422667629, AUC 0.7039547815010777
  Second-Tier acc 0.3469387755102041, precision 0.43478260869565216, recall 0.3703703703703704, F1 0.22222222222222224, AUC 0.7148368606701939
Test AUC: 0.7505, Test F1: 0.3977 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.28230784362557354, "droprate_2": 0.0, "lr": 0.00014757179389641084, "weight_decay": 0.0004715104414790224, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00014757179389641084
epoch: 0 idx: 0 First Loss : 1.0160983800888062, Second Loss : 1.0222434997558594
epoch: 0 idx: 200 First Loss : 1.10491105958597, Second Loss : 1.0893338943521182
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7517452300785634
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7416666666666666
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7181682343719381
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7274029982363315
Test AUC: 0.7274, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00014757179389641084
epoch: 1 idx: 0 First Loss : 1.5754953622817993, Second Loss : 1.8435249328613281
epoch: 1 idx: 200 First Loss : 0.9906769897881432, Second Loss : 0.9858255917160073
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7385016835016834
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7364646464646464
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7329083382324123
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7351190476190476
Test AUC: 0.7274, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00014757179389641084
epoch: 2 idx: 0 First Loss : 2.132075071334839, Second Loss : 2.464021921157837
epoch: 2 idx: 200 First Loss : 0.9442342672107825, Second Loss : 0.9585952402199086
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6736111111111112, precision 0.765993265993266, recall 0.582996632996633, F1 0.5113254768427181, AUC 0.7332323232323232
  Second-Tier acc 0.6666666666666666, precision 0.6212121212121212, recall 0.5718181818181818, F1 0.5754789272030651, AUC 0.7413636363636363
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6394557823129252, precision 0.6438941430230628, recall 0.5218988830099941, F1 0.5389014157187408, AUC 0.7256699490495787
  Second-Tier acc 0.6938775510204082, precision 0.6590909090909091, recall 0.6236772486772487, F1 0.6265151515151516, AUC 0.7338514109347442
Test AUC: 0.7274, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00014757179389641084
epoch: 3 idx: 0 First Loss : 2.7462007999420166, Second Loss : 3.025576591491699
epoch: 3 idx: 200 First Loss : 0.9182008678158421, Second Loss : 0.9304352135800603
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4444444444444444, precision 0.5742669412572324, recall 0.49434343434343436, F1 0.40704849315612773, AUC 0.7334736251402919
  Second-Tier acc 0.4375, precision 0.5677248677248677, recall 0.4955555555555556, F1 0.39961636828644503, AUC 0.764040404040404
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.48299319727891155, precision 0.5195652173913045, recall 0.4769253380364491, F1 0.44305174698661803, AUC 0.7368643445032333
  Second-Tier acc 0.5102040816326531, precision 0.5357142857142857, recall 0.5227072310405644, F1 0.48679829655439405, AUC 0.7429453262786595
Test AUC: 0.7429, Test F1: 0.4868 (Best Epoch: 3)
Current LR: 0.00014757179389641084
epoch: 4 idx: 0 First Loss : 3.3233120441436768, Second Loss : 3.6796658039093018
epoch: 4 idx: 200 First Loss : 0.9120405312090074, Second Loss : 0.927440823213341
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4027777777777778, precision 0.48405682895352947, recall 0.4716498316498317, F1 0.3766374441290077, AUC 0.7491638608305276
  Second-Tier acc 0.3958333333333333, precision 0.4764038231780167, recall 0.434949494949495, F1 0.3663865546218487, AUC 0.7785858585858586
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4897959183673469, precision 0.5764596848934198, recall 0.5473251028806584, F1 0.4708834980533094, AUC 0.7367296198314718
  Second-Tier acc 0.5306122448979592, precision 0.6025641025641025, recall 0.593694885361552, F1 0.5222436722436723, AUC 0.7538029100529101
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 5 idx: 0 First Loss : 3.4318811893463135, Second Loss : 4.056376934051514
epoch: 5 idx: 200 First Loss : 0.9078913866773952, Second Loss : 0.9276459142785816
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3472222222222222, precision 0.36075036075036077, recall 0.40888888888888886, F1 0.26091269841269843, AUC 0.7462401795735129
  Second-Tier acc 0.3958333333333333, precision 0.45286195286195285, recall 0.4374747474747474, F1 0.34541493365022774, AUC 0.7763131313131314
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4987684729064039, recall 0.4380511463844798, F1 0.3468821093157557, AUC 0.7233490103860474
  Second-Tier acc 0.46938775510204084, precision 0.5370370370370371, recall 0.46230158730158727, F1 0.3955555555555556, AUC 0.7460868606701941
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 6 idx: 0 First Loss : 3.47898268699646, Second Loss : 4.101847171783447
epoch: 6 idx: 200 First Loss : 0.8980171530170422, Second Loss : 0.920595473283786
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.42496947496947496, recall 0.4181481481481481, F1 0.28146878824969396, AUC 0.7216947250280583
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.7339898989898991
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.47957839262187085, recall 0.41776895943562614, F1 0.3261539010508662, AUC 0.693495247893396
  Second-Tier acc 0.42857142857142855, precision 0.45045045045045046, recall 0.40828924162257496, F1 0.32231559290382816, AUC 0.6966490299823634
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 7 idx: 0 First Loss : 3.392040967941284, Second Loss : 3.925438404083252
epoch: 7 idx: 200 First Loss : 0.8901643872762618, Second Loss : 0.9163273674174124
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3402777777777778, precision 0.40883190883190884, recall 0.4092592592592592, F1 0.26900836320191157, AUC 0.6982659932659931
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.7094444444444443
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.47104332449160036, recall 0.3974867724867725, F1 0.3037871012554557, AUC 0.6768383793846757
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6748787477954145
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 8 idx: 0 First Loss : 3.30502986907959, Second Loss : 3.8880107402801514
epoch: 8 idx: 200 First Loss : 0.8878110348066287, Second Loss : 0.9112967018409289
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3263888888888889, precision 0.3951534576534576, recall 0.4003703703703703, F1 0.2560891590678825, AUC 0.6830695847362515
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6914646464646464
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.38095238095238093, precision 0.4713747645951036, recall 0.39689888300999415, F1 0.2861729644624382, AUC 0.6817252106603959
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6671075837742505
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 9 idx: 0 First Loss : 3.229656219482422, Second Loss : 3.8758530616760254
epoch: 9 idx: 200 First Loss : 0.8835649873490274, Second Loss : 0.905727271445991
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3263888888888889, precision 0.36541889483065954, recall 0.3955555555555556, F1 0.24430641821946172, AUC 0.6792648709315375
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6885353535353534
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.44186046511627913, recall 0.38271604938271603, F1 0.24976419543482362, AUC 0.6711615716245346
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.66820987654321
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 10 idx: 0 First Loss : 3.079901933670044, Second Loss : 3.751260995864868
epoch: 10 idx: 200 First Loss : 0.8748979648089833, Second Loss : 0.8991143651269272
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3402777777777778, precision 0.4353535353535353, recall 0.4092592592592592, F1 0.26664418717919897, AUC 0.6779012345679013
  Second-Tier acc 0.2708333333333333, precision 0.30952380952380953, recall 0.36000000000000004, F1 0.18598382749326148, AUC 0.6964141414141415
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.44186046511627913, recall 0.38271604938271603, F1 0.24976419543482362, AUC 0.668393592004703
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6656746031746031
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 11 idx: 0 First Loss : 2.9449942111968994, Second Loss : 3.6773297786712646
epoch: 11 idx: 200 First Loss : 0.8671580255347239, Second Loss : 0.8920792405950676
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3125, precision 0.35537634408602153, recall 0.38666666666666666, F1 0.22901627742392075, AUC 0.6765039281705948
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6983333333333333
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3741496598639456, precision 0.4427083333333333, recall 0.3868312757201646, F1 0.2569044639132249, AUC 0.6672300607485792
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6750992063492064
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 12 idx: 0 First Loss : 2.9087564945220947, Second Loss : 3.6344034671783447
epoch: 12 idx: 200 First Loss : 0.8613483608811537, Second Loss : 0.8838781484044204
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3125, precision 0.35537634408602153, recall 0.38666666666666666, F1 0.22901627742392075, AUC 0.6758529741863075
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.7007575757575758
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.4427083333333333, recall 0.38271604938271603, F1 0.25072738772928527, AUC 0.6696183617479914
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6797839506172839
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 13 idx: 0 First Loss : 2.8170225620269775, Second Loss : 3.559368848800659
epoch: 13 idx: 200 First Loss : 0.8530950106814184, Second Loss : 0.8757665999623874
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3402777777777778, precision 0.3694114318053197, recall 0.40444444444444444, F1 0.25360256583999635, AUC 0.6744837261503928
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6889898989898992
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.4435695538057743, recall 0.40740740740740744, F1 0.2868925945849023, AUC 0.6736294826572604
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6891534391534391
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 14 idx: 0 First Loss : 2.9330132007598877, Second Loss : 3.521878242492676
epoch: 14 idx: 200 First Loss : 0.849504151598383, Second Loss : 0.8714258582111514
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.4116531165311654, recall 0.39592592592592585, F1 0.2457875457875458, AUC 0.6705443322109989
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6730808080808082
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3741496598639456, precision 0.47866666666666674, recall 0.396604938271605, F1 0.27329401917228163, AUC 0.6780264060356652
  Second-Tier acc 0.40816326530612246, precision 0.45, recall 0.40740740740740744, F1 0.2940516273849607, AUC 0.6974757495590828
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 15 idx: 0 First Loss : 2.7627267837524414, Second Loss : 3.6347596645355225
epoch: 15 idx: 200 First Loss : 0.8407523625282558, Second Loss : 0.8621035501188876
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.3989547038327526, recall 0.3914814814814815, F1 0.2389265207399516, AUC 0.6665937149270482
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6724242424242424
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.47222222222222215, recall 0.3842592592592593, F1 0.2518518518518518, AUC 0.6795696159122085
  Second-Tier acc 0.3673469387755102, precision 0.45, recall 0.38271604938271603, F1 0.25886101154918356, AUC 0.6984126984126983
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 16 idx: 0 First Loss : 2.7971792221069336, Second Loss : 3.7953693866729736
epoch: 16 idx: 200 First Loss : 0.8438591392603222, Second Loss : 0.86670968610455
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.40616999487967226, recall 0.3914814814814815, F1 0.2383974081533661, AUC 0.6671268237934904
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6692424242424243
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.492952380952381, recall 0.39403292181069954, F1 0.262677483589887, AUC 0.6841135116598079
  Second-Tier acc 0.3469387755102041, precision 0.4471544715447155, recall 0.3703703703703704, F1 0.23636363636363633, AUC 0.6988536155202821
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 17 idx: 0 First Loss : 2.816760301589966, Second Loss : 3.771559953689575
epoch: 17 idx: 200 First Loss : 0.835063261107877, Second Loss : 0.8599916277076881
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2986111111111111, precision 0.3803763440860215, recall 0.3825925925925926, F1 0.2242444209279263, AUC 0.6668630751964084
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.667020202020202
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.49206349206349204, recall 0.389917695473251, F1 0.2547846889952153, AUC 0.6916519694297473
  Second-Tier acc 0.32653061224489793, precision 0.4444444444444444, recall 0.35802469135802467, F1 0.21264367816091956, AUC 0.7027116402116403
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 18 idx: 0 First Loss : 2.8369600772857666, Second Loss : 3.7561304569244385
epoch: 18 idx: 200 First Loss : 0.8291175710308117, Second Loss : 0.8552784140228327
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.42882483370288244, recall 0.3918518518518519, F1 0.23977859013248293, AUC 0.6666722783389449
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6676767676767676
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.49206349206349204, recall 0.389917695473251, F1 0.2547846889952153, AUC 0.691272290809328
  Second-Tier acc 0.32653061224489793, precision 0.44186046511627913, recall 0.35802469135802467, F1 0.20971970155273242, AUC 0.6977513227513228
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4)
Current LR: 0.00014757179389641084
epoch: 19 idx: 0 First Loss : 2.845226287841797, Second Loss : 3.794243335723877
epoch: 19 idx: 200 First Loss : 0.8248755416768394, Second Loss : 0.8553169777136129
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.41567599067599065, recall 0.3918518518518519, F1 0.24076917588740923, AUC 0.667598204264871
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.663989898989899
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.4888888888888889, recall 0.3858024691358024, F1 0.24683171234895374, AUC 0.6894718792866942
  Second-Tier acc 0.32653061224489793, precision 0.44186046511627913, recall 0.35802469135802467, F1 0.20971970155273242, AUC 0.704916225749559
Test AUC: 0.7538, Test F1: 0.5222 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.28358159480031386, "droprate_2": 0.0, "lr": 0.00012555493768208757, "weight_decay": 0.0002917576694448442, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.2727627566016323, "droprate_2": 0.0, "lr": 2.870063069942745e-05, "weight_decay": 6.160442492816861e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.22728024846555173, "droprate_2": 0.0, "lr": 9.796701458912908e-05, "weight_decay": 0.0005900567110446261, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 9.796701458912908e-05
epoch: 0 idx: 0 First Loss : 1.1623605489730835, Second Loss : 1.1589702367782593
epoch: 0 idx: 200 First Loss : 1.0981140381735355, Second Loss : 1.1025370687839404
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7429012345679012
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7485353535353535
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.706747256515775
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6930665784832452
Test AUC: 0.6931, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.796701458912908e-05
epoch: 1 idx: 0 First Loss : 1.9518427848815918, Second Loss : 2.126322031021118
epoch: 1 idx: 200 First Loss : 1.0034937658416692, Second Loss : 1.0146290726626097
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7343490460157126
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7475757575757576
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7280276308054087
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7165454144620812
Test AUC: 0.6931, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.796701458912908e-05
epoch: 2 idx: 0 First Loss : 2.2783424854278564, Second Loss : 2.540945291519165
epoch: 2 idx: 200 First Loss : 0.9466421403250291, Second Loss : 0.963697594048372
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5833333333333334, precision 0.4195842192298606, recall 0.49693602693602684, F1 0.44276279581728123, AUC 0.7184904601571268
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7407575757575757
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6326530612244898, precision 0.618421052631579, recall 0.5993533215755438, F1 0.6039893223068608, AUC 0.7214628649813836
  Second-Tier acc 0.5714285714285714, precision 0.5370370370370371, recall 0.49603174603174605, F1 0.49999999999999994, AUC 0.7173721340388006
Test AUC: 0.6931, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.796701458912908e-05
epoch: 3 idx: 0 First Loss : 2.8447659015655518, Second Loss : 3.312117099761963
epoch: 3 idx: 200 First Loss : 0.915421061634795, Second Loss : 0.942584577438176
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4513888888888889, precision 0.5194449107492586, recall 0.47279461279461277, F1 0.4342702965584322, AUC 0.7135578002244669
  Second-Tier acc 0.4583333333333333, precision 0.5454921422663358, recall 0.474949494949495, F1 0.4191729323308271, AUC 0.756919191919192
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5374149659863946, precision 0.5770822404849333, recall 0.5825249853027631, F1 0.5443215432280495, AUC 0.7308017342739564
  Second-Tier acc 0.5510204081632653, precision 0.589514652014652, recall 0.5652557319223986, F1 0.5459948320413437, AUC 0.7497244268077602
Test AUC: 0.7497, Test F1: 0.5460 (Best Epoch: 3)
Current LR: 9.796701458912908e-05
epoch: 4 idx: 0 First Loss : 3.291496515274048, Second Loss : 3.822718381881714
epoch: 4 idx: 200 First Loss : 0.9060055955095374, Second Loss : 0.9389079286165498
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4166666666666667, precision 0.5142857142857142, recall 0.46188552188552184, F1 0.40441436954814064, AUC 0.7172166105499439
  Second-Tier acc 0.4375, precision 0.5152777777777777, recall 0.4785858585858586, F1 0.400541405192568, AUC 0.7823232323232322
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5034013605442177, precision 0.5660140562248995, recall 0.5636390358612581, F1 0.5025250737463126, AUC 0.7346046443268666
  Second-Tier acc 0.5102040816326531, precision 0.5382580382580383, recall 0.5405643738977072, F1 0.5023912003825921, AUC 0.7570546737213405
Test AUC: 0.7571, Test F1: 0.5024 (Best Epoch: 4)
Current LR: 9.796701458912908e-05
epoch: 5 idx: 0 First Loss : 3.4689178466796875, Second Loss : 4.016367435455322
epoch: 5 idx: 200 First Loss : 0.9001260557193401, Second Loss : 0.9365725008149942
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4097222222222222, precision 0.5058684006052427, recall 0.4656228956228956, F1 0.3815781578157815, AUC 0.7319753086419754
  Second-Tier acc 0.4583333333333333, precision 0.5260536398467434, recall 0.5063636363636363, F1 0.4333333333333333, AUC 0.7975757575757575
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4965986394557823, precision 0.5726342451874368, recall 0.5297619047619048, F1 0.46895914329034366, AUC 0.7438883989809916
  Second-Tier acc 0.5306122448979592, precision 0.5974025974025974, recall 0.5758377425044091, F1 0.5110072478493531, AUC 0.7622354497354497
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 6 idx: 0 First Loss : 3.588604211807251, Second Loss : 4.1758856773376465
epoch: 6 idx: 200 First Loss : 0.8925853824203566, Second Loss : 0.9339274603987011
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4027777777777778, precision 0.4867724867724868, recall 0.46346801346801353, F1 0.3903781403781404, AUC 0.7342929292929293
  Second-Tier acc 0.4166666666666667, precision 0.4871565113500597, recall 0.46525252525252525, F1 0.3822595704948646, AUC 0.7772222222222221
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.5735171261487051, recall 0.5393885949441505, F1 0.46615914236121175, AUC 0.7377216833235352
  Second-Tier acc 0.46938775510204084, precision 0.5416666666666666, recall 0.4801587301587302, F1 0.4239130434782609, AUC 0.7535824514991182
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 7 idx: 0 First Loss : 3.6444551944732666, Second Loss : 4.2668681144714355
epoch: 7 idx: 200 First Loss : 0.8880606071440855, Second Loss : 0.9286558888980017
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3680555555555556, precision 0.4567977915804003, recall 0.43414141414141416, F1 0.33622810557467114, AUC 0.723030303030303
  Second-Tier acc 0.4166666666666667, precision 0.47594997594997596, recall 0.46525252525252525, F1 0.38577393053096376, AUC 0.7511616161616161
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3877551020408163, precision 0.4722112211221123, recall 0.38403880070546736, F1 0.3229739448226843, AUC 0.7280276308054084
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7364417989417991
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 8 idx: 0 First Loss : 3.7791945934295654, Second Loss : 4.219961643218994
epoch: 8 idx: 200 First Loss : 0.8816580932247985, Second Loss : 0.9275920616413017
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.375, precision 0.4576023391812865, recall 0.4538720538720538, F1 0.34883551529358786, AUC 0.7102356902356902
  Second-Tier acc 0.4166666666666667, precision 0.46296296296296297, recall 0.4677777777777778, F1 0.3605664488017429, AUC 0.7225252525252525
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3877551020408163, precision 0.4907894736842105, recall 0.3997648442092887, F1 0.340216190545019, AUC 0.7075433568489125
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.711033950617284
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 9 idx: 0 First Loss : 3.7167396545410156, Second Loss : 4.100698947906494
epoch: 9 idx: 200 First Loss : 0.8832149472405013, Second Loss : 0.924402937432056
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3472222222222222, precision 0.42297258709308966, recall 0.42333333333333334, F1 0.29654731457800515, AUC 0.6992199775533109
  Second-Tier acc 0.3958333333333333, precision 0.46309523809523806, recall 0.45444444444444443, F1 0.34005011754372366, AUC 0.7084343434343433
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.47867104183757175, recall 0.3955026455026455, F1 0.316247582205029, AUC 0.6896004801097394
  Second-Tier acc 0.42857142857142855, precision 0.5047619047619047, recall 0.43761022927689597, F1 0.3585700947045485, AUC 0.6901455026455027
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 10 idx: 0 First Loss : 3.7696964740753174, Second Loss : 4.0662994384765625
epoch: 10 idx: 200 First Loss : 0.8943182324625167, Second Loss : 0.9225350977671657
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.42054252974075895, recall 0.422962962962963, F1 0.29530939247251303, AUC 0.6907856341189674
  Second-Tier acc 0.375, precision 0.45423280423280415, recall 0.44111111111111106, F1 0.3202440550688361, AUC 0.6960606060606059
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.49318181818181817, recall 0.4237213403880071, F1 0.34164086687306505, AUC 0.6722148736037624
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.6617614638447972
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 11 idx: 0 First Loss : 3.628117561340332, Second Loss : 3.825171947479248
epoch: 11 idx: 200 First Loss : 0.8918699983432681, Second Loss : 0.9161430459729609
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.42869520897043834, recall 0.4274074074074074, F1 0.30037161392849704, AUC 0.6841806958473624
  Second-Tier acc 0.375, precision 0.4681467181467181, recall 0.44111111111111106, F1 0.3194444444444444, AUC 0.6924747474747474
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.4921171171171171, recall 0.4196061140505585, F1 0.33528117517634115, AUC 0.662967862041936
  Second-Tier acc 0.42857142857142855, precision 0.456140350877193, recall 0.4197530864197531, F1 0.3167420814479638, AUC 0.6458884479717814
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 12 idx: 0 First Loss : 3.5404789447784424, Second Loss : 3.7359766960144043
epoch: 12 idx: 200 First Loss : 0.8872997539050748, Second Loss : 0.9072375087046055
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.375, precision 0.44343434343434346, recall 0.43629629629629635, F1 0.3122081240637942, AUC 0.6827833894500562
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.6962626262626262
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.512987012987013, recall 0.4440035273368606, F1 0.3636363636363636, AUC 0.66068979031942
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.6399360670194003
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 13 idx: 0 First Loss : 3.5208723545074463, Second Loss : 3.6710410118103027
epoch: 13 idx: 200 First Loss : 0.882752158569603, Second Loss : 0.899534936826931
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.4908424908424908, recall 0.4318518518518519, F1 0.3034126984126984, AUC 0.6812514029180695
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.7013636363636363
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.532608695652174, recall 0.4440035273368606, F1 0.3638989990900819, AUC 0.6536718596903782
  Second-Tier acc 0.42857142857142855, precision 0.456140350877193, recall 0.4197530864197531, F1 0.3167420814479638, AUC 0.6375661375661376
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5)
Current LR: 9.796701458912908e-05
epoch: 14 idx: 0 First Loss : 3.402691602706909, Second Loss : 3.5485239028930664
epoch: 14 idx: 200 First Loss : 0.8796693070961651, Second Loss : 0.8928886425494047
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.4762753586282998, recall 0.4225925925925926, F1 0.2855421994054658, AUC 0.681060606060606
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6990909090909091
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.5196581196581197, recall 0.45010288065843623, F1 0.3563218390804597, AUC 0.6587852733686067
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6491953262786595
Test AUC: 0.7622, Test F1: 0.5110 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.17103789815033751, "droprate_2": 0.0, "lr": 4.010445988420642e-05, "weight_decay": 0.0005953487423968146, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0901947021484375, Second Loss : 0.9743509888648987
epoch: 0 idx: 200 First Loss : 1.1201428287657933, Second Loss : 1.1151354716933188
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7378731762065095
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7256060606060606{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.169840580039787, "droprate_2": 0.0, "lr": 0.00022452358804817528, "weight_decay": 4.143929693857454e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1845496892929077, Second Loss : 1.1266682147979736
epoch: 0 idx: 200 First Loss : 1.071394795209021, Second Loss : 1.0733561081746918
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408193041526374
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7551010101010102{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.11458626586398446, "droprate_2": 0.0, "lr": 2.8996446931519213e-05, "weight_decay": 1.0325162162919923e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1387981176376343, Second Loss : 1.1935627460479736
epoch: 0 idx: 200 First Loss : 1.1065682254323912, Second Loss : 1.1077091759117088
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7295735129068461
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7424747474747475{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.19141376320574738, "droprate_2": 0.0, "lr": 1.655358083457053e-05, "weight_decay": 0.00016644467329349346, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1635793447494507, Second Loss : 1.1346156597137451
epoch: 0 idx: 200 First Loss : 1.0557963926697251, Second Loss : 1.0702851147794012
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7245510662177329
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7126262626262626{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.02842153093952362, "droprate_2": 0.0, "lr": 0.00035323460420827273, "weight_decay": 0.00025293653827682176, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.23448853930253685, "droprate_2": 0.0, "lr": 0.0008448417299556986, "weight_decay": 3.303934911468378e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.04146053392447413, "droprate_2": 0.0, "lr": 0.00029960857928008357, "weight_decay": 0.00010701285866694154, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.1837272807322885, "droprate_2": 0.0, "lr": 0.00016178764936998247, "weight_decay": 4.205539025178459e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00016178764936998247
epoch: 0 idx: 0 First Loss : 0.9044454097747803, Second Loss : 1.204193115234375
epoch: 0 idx: 200 First Loss : 1.101301311779378, Second Loss : 1.0873071124675262
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.762581369248036
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7682828282828282
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7176109641387419
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7264109347442681
Test AUC: 0.7264, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00016178764936998247
epoch: 1 idx: 0 First Loss : 1.651544213294983, Second Loss : 1.7704108953475952{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.287074793278547, "droprate_2": 0.0, "lr": 2.228448889252779e-05, "weight_decay": 3.545612087822756e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.032791354232338456, "droprate_2": 0.0, "lr": 0.0005065173032266758, "weight_decay": 3.444514423117707e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.120925784111023, Second Loss : 1.1315075159072876
epoch: 0 idx: 200 First Loss : 1.0813816119708233, Second Loss : 1.0840406728843552{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.07584756940560684, "droprate_2": 0.0, "lr": 2.0346489453107684e-05, "weight_decay": 0.0003712662536322407, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0921036005020142, Second Loss : 0.9769181609153748
epoch: 0 idx: 200 First Loss : 1.081800908146806, Second Loss : 1.087378651496783
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7253591470258137
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7423737373737374
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.634853272584754
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6358575837742504
epoch: 1 idx: 0 First Loss : 1.8817715644836426, Second Loss : 1.9217411279678345
epoch: 1 idx: 200 First Loss : 1.0916911684606798, Second Loss : 1.0890185224327875
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444612794612794
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7641919191919192
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.674413335292965
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6675485008818342
epoch: 2 idx: 0 First Loss : 1.964769721031189, Second Loss : 2.005798578262329
epoch: 2 idx: 200 First Loss : 1.0751839842072768, Second Loss : 1.0708070838481039
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7515656565656564
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7725252525252526
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6976472173231433
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6945546737213403
epoch: 3 idx: 0 First Loss : 2.0655357837677, Second Loss : 2.122278928756714
epoch: 3 idx: 200 First Loss : 1.0596656722215871, Second Loss : 1.0528962170677398
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7454489337822672
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7585353535353535
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7103052126200274
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7093253968253969
epoch: 4 idx: 0 First Loss : 2.1767635345458984, Second Loss : 2.2711474895477295
epoch: 4 idx: 200 First Loss : 1.0399297586276164, Second Loss : 1.031844970747013
  First-Tier acc 0.5555555555555556, precision 0.5512152777777778, recall 0.3917845117845118, F1 0.34934688382964246, AUC 0.7408754208754208
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7548484848484849
  First-Tier acc 0.5986394557823129, precision 0.5261904761904762, recall 0.4305555555555556, F1 0.394881525811317, AUC 0.7167168822261415
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7180335097001764
epoch: 5 idx: 0 First Loss : 2.31792950630188, Second Loss : 2.423741102218628
epoch: 5 idx: 200 First Loss : 1.014098554997895, Second Loss : 1.0078900632499463
  First-Tier acc 0.6388888888888888, precision 0.593830232649998, recall 0.5345454545454545, F1 0.5435055596478305, AUC 0.7350729517396184
  Second-Tier acc 0.6666666666666666, precision 0.43263757115749524, recall 0.5963636363636363, F1 0.5, AUC 0.7581313131313131
  First-Tier acc 0.5986394557823129, precision 0.5416666666666666, recall 0.5507789535567313, F1 0.5338441890166028, AUC 0.7121362433862434
  Second-Tier acc 0.6122448979591837, precision 0.5632183908045977, recall 0.5207231040564374, F1 0.526984126984127, AUC 0.7142305996472663
epoch: 6 idx: 0 First Loss : 2.503471851348877, Second Loss : 2.608604907989502
epoch: 6 idx: 200 First Loss : 0.9913722469253623, Second Loss : 0.9857275192787991
  First-Tier acc 0.6111111111111112, precision 0.583118594223154, recall 0.581043771043771, F1 0.5724445162970747, AUC 0.7341638608305275
  Second-Tier acc 0.625, precision 0.5734791524265209, recall 0.5960606060606061, F1 0.560582306830907, AUC 0.7599999999999999
  First-Tier acc 0.564625850340136, precision 0.5324561403508773, recall 0.5824514991181657, F1 0.5362693653173413, AUC 0.717280276308054
  Second-Tier acc 0.5918367346938775, precision 0.5555555555555556, recall 0.560626102292769, F1 0.546031746031746, AUC 0.7244268077601411
epoch: 7 idx: 0 First Loss : 2.678415298461914, Second Loss : 2.7943174839019775
epoch: 7 idx: 200 First Loss : 0.9728743768487107, Second Loss : 0.9671996408211652
  First-Tier acc 0.5277777777777778, precision 0.5479348892481587, recall 0.5421548821548822, F1 0.5114706385892827, AUC 0.7407070707070705
  Second-Tier acc 0.5625, precision 0.61010101010101, recall 0.6308080808080808, F1 0.5600448933782268, AUC 0.7835858585858585
  First-Tier acc 0.5034013605442177, precision 0.5133421661262392, recall 0.5747354497354498, F1 0.4930414186031624, AUC 0.7262945816186557
  Second-Tier acc 0.5510204081632653, precision 0.5525793650793651, recall 0.5831128747795414, F1 0.5396456256921373, AUC 0.7390321869488536
epoch: 8 idx: 0 First Loss : 2.8299968242645264, Second Loss : 2.95711350440979
epoch: 8 idx: 200 First Loss : 0.9596437168636577, Second Loss : 0.9531110402344916
  First-Tier acc 0.4583333333333333, precision 0.5118931247963506, recall 0.49602693602693604, F1 0.4446557819771029, AUC 0.7469696969696971
  Second-Tier acc 0.5208333333333334, precision 0.589522677757972, recall 0.5990909090909091, F1 0.5238095238095237, AUC 0.8034848484848484
  First-Tier acc 0.46938775510204084, precision 0.5066261421128143, recall 0.5660640799529689, F1 0.4608180621646249, AUC 0.7310773074661965
  Second-Tier acc 0.5306122448979592, precision 0.5480889724310777, recall 0.6179453262786596, F1 0.5349223946784923, AUC 0.7573853615520282
epoch: 9 idx: 0 First Loss : 2.9513041973114014, Second Loss : 3.0969367027282715
epoch: 9 idx: 200 First Loss : 0.9511977877393736, Second Loss : 0.9438476435172913
  First-Tier acc 0.4444444444444444, precision 0.5202597402597403, recall 0.5041077441077442, F1 0.4385250737463127, AUC 0.7533164983164983
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5554545454545455, F1 0.48092031425364756, AUC 0.8117676767676768
  First-Tier acc 0.46258503401360546, precision 0.5178235194113251, recall 0.569591416813639, F1 0.45958168252668546, AUC 0.7370909269057417
  Second-Tier acc 0.4897959183673469, precision 0.5356902356902357, recall 0.5932539682539683, F1 0.494244661427324, AUC 0.7719356261022927{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 200, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.14927710677051165, "droprate_2": 0.0, "lr": 0.00020367615128911003, "weight_decay": 1.3377462555660235e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0275697708129883, Second Loss : 1.1892204284667969
epoch: 0 idx: 200 First Loss : 1.075260927390993, Second Loss : 1.0710793306578452
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7499526515151516
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7497474747474747
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7255669918430335
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7272376543209876
epoch: 1 idx: 0 First Loss : 1.6732800006866455, Second Loss : 1.8079057931900024
epoch: 1 idx: 200 First Loss : 0.980271086319169, Second Loss : 0.9812482464965896
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7321401515151514
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7383333333333333
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7145509534832453
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.714726631393298
epoch: 2 idx: 0 First Loss : 2.2664103507995605, Second Loss : 2.2613937854766846
epoch: 2 idx: 200 First Loss : 0.9467234736428926, Second Loss : 0.9441063011167061
  First-Tier acc 0.5885416666666666, precision 0.378640059127864, recall 0.5251515151515151, F1 0.4328042328042328, AUC 0.7118781565656565
  Second-Tier acc 0.6666666666666666, precision 0.6311327561327561, recall 0.5692929292929293, F1 0.5801572897761645, AUC 0.728030303030303
  First-Tier acc 0.5459183673469388, precision 0.3596857182589348, recall 0.4334215167548501, F1 0.3853968253968254, AUC 0.6819850914902998
  Second-Tier acc 0.5918367346938775, precision 0.5443722943722944, recall 0.5619488536155203, F1 0.5488215488215488, AUC 0.6892085537918872
epoch: 3 idx: 0 First Loss : 3.063491106033325, Second Loss : 3.011937379837036
epoch: 3 idx: 200 First Loss : 0.9266992394640967, Second Loss : 0.9207652177272448
  First-Tier acc 0.484375, precision 0.5357247970083621, recall 0.5354040404040403, F1 0.4840489073150165, AUC 0.7196180555555555
  Second-Tier acc 0.4791666666666667, precision 0.5487654320987655, recall 0.4857575757575758, F1 0.4531198872360241, AUC 0.7355050505050506
  First-Tier acc 0.4897959183673469, precision 0.511264500047934, recall 0.54673721340388, F1 0.4872548304421198, AUC 0.7093805114638446
  Second-Tier acc 0.5510204081632653, precision 0.5364498202026806, recall 0.5244708994708995, F1 0.5128867998433216, AUC 0.7125771604938271
epoch: 4 idx: 0 First Loss : 3.68595290184021, Second Loss : 3.7629542350769043
epoch: 4 idx: 200 First Loss : 0.9271652222105965, Second Loss : 0.9150862086758907
  First-Tier acc 0.484375, precision 0.5513701334596858, recall 0.560050505050505, F1 0.48764126445285866, AUC 0.7358901515151515
  Second-Tier acc 0.4375, precision 0.3796296296296296, recall 0.4666666666666666, F1 0.3362085489745064, AUC 0.7418181818181818
  First-Tier acc 0.42346938775510207, precision 0.4972354703920989, recall 0.49674823633156967, F1 0.4159630795540589, AUC 0.7055844907407408
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.7072861552028219
epoch: 5 idx: 0 First Loss : 3.735203742980957, Second Loss : 4.09174108505249
epoch: 5 idx: 200 First Loss : 0.9241741422322852, Second Loss : 0.9097235525694134
  First-Tier acc 0.3645833333333333, precision 0.44204348406029076, recall 0.4265909090909091, F1 0.30585649080413474, AUC 0.743459595959596
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7694444444444444
  First-Tier acc 0.4336734693877551, precision 0.45282848707506235, recall 0.410108024691358, F1 0.33745052666186165, AUC 0.6653818066578483
  Second-Tier acc 0.4897959183673469, precision 0.4069264069264069, recall 0.4338624338624338, F1 0.365334717176959, AUC 0.6970899470899471
epoch: 6 idx: 0 First Loss : 3.5192770957946777, Second Loss : 3.5646634101867676
epoch: 6 idx: 200 First Loss : 0.9189714076569703, Second Loss : 0.899020566270265
  First-Tier acc 0.3645833333333333, precision 0.43084739291954827, recall 0.4265909090909091, F1 0.308123969039462, AUC 0.7139993686868685
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7415656565656565
  First-Tier acc 0.413265306122449, precision 0.44316271963330783, recall 0.3948963844797178, F1 0.3258457269188322, AUC 0.6591331845238095
  Second-Tier acc 0.4897959183673469, precision 0.42936507936507934, recall 0.445326278659612, F1 0.36490493633350773, AUC 0.6975859788359787
epoch: 7 idx: 0 First Loss : 3.5497994422912598, Second Loss : 3.5634899139404297
epoch: 7 idx: 200 First Loss : 0.9137031654618791, Second Loss : 0.8948715107981116
  First-Tier acc 0.359375, precision 0.4246039066182951, recall 0.4275, F1 0.30336022204874663, AUC 0.6895896464646465
  Second-Tier acc 0.3958333333333333, precision 0.39814814814814814, recall 0.44, F1 0.31289111389236546, AUC 0.7090909090909091
  First-Tier acc 0.41836734693877553, precision 0.47058080808080804, recall 0.41391093474426804, F1 0.3347879763821793, AUC 0.6756572420634921
  Second-Tier acc 0.46938775510204084, precision 0.4304812834224599, recall 0.4329805996472664, F1 0.3559941520467836, AUC 0.6999007936507938
epoch: 8 idx: 0 First Loss : 3.422313928604126, Second Loss : 3.476243495941162
epoch: 8 idx: 200 First Loss : 0.9101755303517216, Second Loss : 0.8951008737472984
  First-Tier acc 0.3541666666666667, precision 0.4268237934904602, recall 0.42777777777777776, F1 0.30432206299729975, AUC 0.6813762626262626
  Second-Tier acc 0.4166666666666667, precision 0.4843915343915344, recall 0.4677777777777778, F1 0.35794970161977835, AUC 0.6969191919191919
  First-Tier acc 0.413265306122449, precision 0.4785714285714286, recall 0.41815476190476186, F1 0.33915566226490595, AUC 0.6818369708994708
  Second-Tier acc 0.4897959183673469, precision 0.501010101010101, recall 0.474647266313933, F1 0.4111178108938467, AUC 0.7096009700176366
epoch: 9 idx: 0 First Loss : 3.342972755432129, Second Loss : 3.46543288230896
epoch: 9 idx: 200 First Loss : 0.9113539952303478, Second Loss : 0.8936347925522369
  First-Tier acc 0.375, precision 0.44033327251718063, recall 0.44111111111111106, F1 0.3235054052093158, AUC 0.6770170454545456
  Second-Tier acc 0.3958333333333333, precision 0.46309523809523806, recall 0.45444444444444443, F1 0.34005011754372366, AUC 0.6875757575757575
  First-Tier acc 0.44387755102040816, precision 0.49161831076724694, recall 0.43953924162257496, F1 0.3643102006856192, AUC 0.6826051311728394
  Second-Tier acc 0.46938775510204084, precision 0.5238095238095238, recall 0.46230158730158727, F1 0.3948194662480377, AUC 0.7158840388007054
epoch: 10 idx: 0 First Loss : 3.309645175933838, Second Loss : 3.5431442260742188
epoch: 10 idx: 200 First Loss : 0.9069970886713005, Second Loss : 0.8872615092249231
  First-Tier acc 0.3697916666666667, precision 0.4517667092379736, recall 0.43777777777777777, F1 0.31515341628048127, AUC 0.6752840909090909
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.6667171717171717
  First-Tier acc 0.42857142857142855, precision 0.4786286286286286, recall 0.42581569664903, F1 0.33996589940323957, AUC 0.6767354221781305
  Second-Tier acc 0.46938775510204084, precision 0.5427927927927928, recall 0.4737654320987654, F1 0.39094304388422035, AUC 0.6830908289241622
epoch: 11 idx: 0 First Loss : 3.1931915283203125, Second Loss : 3.5923519134521484
epoch: 11 idx: 200 First Loss : 0.900129187830425, Second Loss : 0.880727584045195
  First-Tier acc 0.375, precision 0.4501351946173678, recall 0.43388888888888894, F1 0.30536719843957405, AUC 0.6721022727272729
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6654545454545454
  First-Tier acc 0.45918367346938777, precision 0.48168756992286405, recall 0.4427358906525573, F1 0.3493042952208106, AUC 0.6790640156525574
  Second-Tier acc 0.4489795918367347, precision 0.5641025641025641, recall 0.46141975308641975, F1 0.37396159149766256, AUC 0.6852402998236332
epoch: 12 idx: 0 First Loss : 3.1379141807556152, Second Loss : 3.60715651512146
epoch: 12 idx: 200 First Loss : 0.8904578389560246, Second Loss : 0.8743553663736015
  First-Tier acc 0.3645833333333333, precision 0.43838930208098564, recall 0.4272222222222222, F1 0.29591968270380214, AUC 0.6734343434343435
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6635353535353535
  First-Tier acc 0.4489795918367347, precision 0.49782135076252726, recall 0.44389329805996475, F1 0.3534988277977665, AUC 0.6820918761022928
  Second-Tier acc 0.42857142857142855, precision 0.5611111111111111, recall 0.4490740740740741, F1 0.3546576879910213, AUC 0.6789021164021164
epoch: 13 idx: 0 First Loss : 3.1931657791137695, Second Loss : 3.7417774200439453
epoch: 13 idx: 200 First Loss : 0.8895566015317804, Second Loss : 0.8708125371601785
  First-Tier acc 0.3645833333333333, precision 0.4451742382776865, recall 0.4272222222222222, F1 0.2955709687655832, AUC 0.6765246212121211
  Second-Tier acc 0.3125, precision 0.36068376068376073, recall 0.38666666666666666, F1 0.23555555555555555, AUC 0.6572727272727272
  First-Tier acc 0.4489795918367347, precision 0.5048680618744313, recall 0.4365630511463845, F1 0.3398466426635441, AUC 0.683852099867725
  Second-Tier acc 0.42857142857142855, precision 0.5611111111111111, recall 0.4490740740740741, F1 0.3546576879910213, AUC 0.6785163139329805
epoch: 14 idx: 0 First Loss : 3.2668726444244385, Second Loss : 3.8214213848114014
epoch: 14 idx: 200 First Loss : 0.8847412627460539, Second Loss : 0.8719762121507492
  First-Tier acc 0.359375, precision 0.4357142857142857, recall 0.4238888888888889, F1 0.29092832056194123, AUC 0.6754734848484848
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6567676767676768
  First-Tier acc 0.4336734693877551, precision 0.46127136752136755, recall 0.4273037918871252, F1 0.3277178796046721, AUC 0.6860739087301587
  Second-Tier acc 0.40816326530612246, precision 0.5333333333333333, recall 0.4367283950617284, F1 0.3325617283950617, AUC 0.681878306878307
epoch: 15 idx: 0 First Loss : 3.3727917671203613, Second Loss : 3.9520726203918457
epoch: 15 idx: 200 First Loss : 0.8801977364523759, Second Loss : 0.8643238072926673
  First-Tier acc 0.3541666666666667, precision 0.706714844926227, recall 0.4169444444444444, F1 0.27536599133899475, AUC 0.6787689393939393
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6560606060606061
  First-Tier acc 0.41836734693877553, precision 0.5046457607433218, recall 0.41804453262786595, F1 0.31263616557734203, AUC 0.6862461419753085
  Second-Tier acc 0.3673469387755102, precision 0.5055555555555556, recall 0.41203703703703703, F1 0.28712522045855376, AUC 0.6770282186948853
epoch: 16 idx: 0 First Loss : 3.471550464630127, Second Loss : 4.015469074249268
epoch: 16 idx: 200 First Loss : 0.8756948925266211, Second Loss : 0.860152257139296
  First-Tier acc 0.3333333333333333, precision 0.4009388387567223, recall 0.4036111111111111, F1 0.2589744616657989, AUC 0.679040404040404
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6503030303030304
  First-Tier acc 0.4030612244897959, precision 0.5117886178861789, recall 0.4161155202821869, F1 0.31123321123321124, AUC 0.6871038635361552
  Second-Tier acc 0.3673469387755102, precision 0.5055555555555556, recall 0.41203703703703703, F1 0.28712522045855376, AUC 0.6870039682539683
epoch: 17 idx: 0 First Loss : 3.5490570068359375, Second Loss : 4.11124324798584
epoch: 17 idx: 200 First Loss : 0.8826905243978982, Second Loss : 0.8609687417566912
  First-Tier acc 0.3333333333333333, precision 0.5298533368046515, recall 0.4036111111111111, F1 0.255334900268434, AUC 0.6796685606060606
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6517676767676768
  First-Tier acc 0.4030612244897959, precision 0.5535714285714285, recall 0.4161155202821869, F1 0.3115987083092346, AUC 0.6906966490299823
  Second-Tier acc 0.3673469387755102, precision 0.5055555555555556, recall 0.41203703703703703, F1 0.28712522045855376, AUC 0.6856812169312169
epoch: 18 idx: 0 First Loss : 3.6069746017456055, Second Loss : 4.090417385101318
epoch: 18 idx: 200 First Loss : 0.8797512858864817, Second Loss : 0.8582956385503189
  First-Tier acc 0.3177083333333333, precision 0.3561157796451914, recall 0.38999999999999996, F1 0.2307355629360727, AUC 0.6821717171717173
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6554545454545454
  First-Tier acc 0.37755102040816324, precision 0.4382022471910112, recall 0.3888888888888889, F1 0.25478225478225475, AUC 0.6882268242945327
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6942239858906526
epoch: 19 idx: 0 First Loss : 3.6977224349975586, Second Loss : 4.129023551940918
epoch: 19 idx: 200 First Loss : 0.8746658348984635, Second Loss : 0.8514266814287175
  First-Tier acc 0.3072916666666667, precision 0.3484292125662995, recall 0.3833333333333333, F1 0.21983608258118062, AUC 0.6814046717171717
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6589393939393938
  First-Tier acc 0.3622448979591837, precision 0.43703703703703706, recall 0.3796296296296296, F1 0.23949290340361032, AUC 0.6918781690917107
  Second-Tier acc 0.3469387755102041, precision 0.49317738791423005, recall 0.3996913580246913, F1 0.26467987725594216, AUC 0.7151675485008818
epoch: 20 idx: 0 First Loss : 3.7153923511505127, Second Loss : 4.185091972351074
epoch: 20 idx: 200 First Loss : 0.8691021348684815, Second Loss : 0.8409332001735925
  First-Tier acc 0.3072916666666667, precision 0.34793631477537773, recall 0.3833333333333333, F1 0.21921026475106173, AUC 0.6861111111111112
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6576262626262626
  First-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6872278714726631
  Second-Tier acc 0.3469387755102041, precision 0.49317738791423005, recall 0.3996913580246913, F1 0.26467987725594216, AUC 0.7134589947089948
epoch: 21 idx: 0 First Loss : 3.7253754138946533, Second Loss : 4.2372026443481445
epoch: 21 idx: 200 First Loss : 0.8627564208397385, Second Loss : 0.829289734274445
  First-Tier acc 0.3177083333333333, precision 0.35561125034809243, recall 0.38999999999999996, F1 0.23009802037286184, AUC 0.6920012626262627
  Second-Tier acc 0.2916666666666667, precision 0.35185185185185186, recall 0.37333333333333335, F1 0.22499388603570555, AUC 0.6577777777777778
  First-Tier acc 0.3622448979591837, precision 0.4161463468068792, recall 0.37676366843033504, F1 0.2413617021276596, AUC 0.6900111607142856
  Second-Tier acc 0.3673469387755102, precision 0.5377073906485671, recall 0.45921516754850095, F1 0.32177066228790363, AUC 0.7207892416225748
epoch: 22 idx: 0 First Loss : 3.7301201820373535, Second Loss : 4.2945170402526855
epoch: 22 idx: 200 First Loss : 0.8550993283823758, Second Loss : 0.8142599093223668
  First-Tier acc 0.3177083333333333, precision 0.35561125034809243, recall 0.38999999999999996, F1 0.23009802037286184, AUC 0.6926420454545453
  Second-Tier acc 0.2916666666666667, precision 0.3849206349206349, recall 0.37080808080808075, F1 0.2572081688986651, AUC 0.6585858585858586
  First-Tier acc 0.3622448979591837, precision 0.4364640883977901, recall 0.3796296296296296, F1 0.23882542622894584, AUC 0.6866353891093473
  Second-Tier acc 0.3673469387755102, precision 0.5456989247311829, recall 0.47707231040564374, F1 0.33486590038314173, AUC 0.7109788359788359
epoch: 23 idx: 0 First Loss : 3.8303918838500977, Second Loss : 4.396092891693115{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.21173335861675038, "droprate_2": 0.0, "lr": 1.403759951975539e-05, "weight_decay": 2.665439439183812e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.272942066192627, Second Loss : 1.1984707117080688
epoch: 0 idx: 200 First Loss : 1.0580590359903688, Second Loss : 1.060917413353327
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7149305555555555
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7149999999999999
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6421750992063492
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6084656084656085
epoch: 1 idx: 0 First Loss : 1.913255214691162, Second Loss : 1.9972031116485596
epoch: 1 idx: 200 First Loss : 1.0915917715623011, Second Loss : 1.093472737355612
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.731606691919192
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.720909090909091
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6821125440917107
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6569664902998236
epoch: 2 idx: 0 First Loss : 1.979714035987854, Second Loss : 2.0883631706237793
epoch: 2 idx: 200 First Loss : 1.0760047182959704, Second Loss : 1.0766266130689364
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7407765151515152
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.744040404040404
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7007206238977073
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6885471781305116
epoch: 3 idx: 0 First Loss : 2.032855987548828, Second Loss : 2.157071113586426
epoch: 3 idx: 200 First Loss : 1.0647952736758475, Second Loss : 1.064679116752017
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408080808080809
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7490404040404041
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7105964781746031
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7061838624338623
epoch: 4 idx: 0 First Loss : 2.0905821323394775, Second Loss : 2.209782600402832
epoch: 4 idx: 200 First Loss : 1.0535585460304029, Second Loss : 1.052187437478879
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7398674242424242
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.751010101010101
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113370811287477
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7119157848324514
epoch: 5 idx: 0 First Loss : 2.1696887016296387, Second Loss : 2.276609420776367
epoch: 5 idx: 200 First Loss : 1.0405375998263335, Second Loss : 1.0374096666847294
  First-Tier acc 0.5677083333333334, precision 0.4023529411764706, recall 0.41, F1 0.3577943368107303, AUC 0.7400915404040403
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7516666666666666
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.7045579805996472
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7116402116402116
epoch: 6 idx: 0 First Loss : 2.262270927429199, Second Loss : 2.3855671882629395
epoch: 6 idx: 200 First Loss : 1.0260872731532031, Second Loss : 1.0204356699366475
  First-Tier acc 0.65625, precision 0.5878978617026025, recall 0.562979797979798, F1 0.5023744132655024, AUC 0.738102904040404
  Second-Tier acc 0.6666666666666666, precision 0.4336996336996337, recall 0.5624242424242424, F1 0.48888888888888893, AUC 0.750050505050505
  First-Tier acc 0.576530612244898, precision 0.6161218092252575, recall 0.4386022927689594, F1 0.44901996554170465, AUC 0.6958670910493826
  Second-Tier acc 0.6122448979591837, precision 0.6277777777777778, recall 0.5385802469135802, F1 0.5615043355515225, AUC 0.6989087301587301
epoch: 7 idx: 0 First Loss : 2.3693292140960693, Second Loss : 2.5134170055389404
epoch: 7 idx: 200 First Loss : 1.0100445718092113, Second Loss : 1.002669165976605
  First-Tier acc 0.6145833333333334, precision 0.4923009002024379, recall 0.5526515151515151, F1 0.491415297136121, AUC 0.7364709595959597
  Second-Tier acc 0.7083333333333334, precision 0.7803768680961664, recall 0.6519191919191919, F1 0.5995115995115995, AUC 0.7529292929292929
  First-Tier acc 0.5714285714285714, precision 0.5247619160662639, recall 0.5106922398589065, F1 0.5107575194531716, AUC 0.6988639495149912
  Second-Tier acc 0.5510204081632653, precision 0.5132275132275133, recall 0.5130070546737213, F1 0.5091503267973856, AUC 0.7097111992945327
epoch: 8 idx: 0 First Loss : 2.4908742904663086, Second Loss : 2.649144411087036
epoch: 8 idx: 200 First Loss : 0.994795938203139, Second Loss : 0.9860441403936094
  First-Tier acc 0.578125, precision 0.5297313797313797, recall 0.5582070707070707, F1 0.5207811709949985, AUC 0.7421496212121212
  Second-Tier acc 0.6041666666666666, precision 0.6075415812257917, recall 0.5971717171717171, F1 0.5645933014354066, AUC 0.7561616161616161
  First-Tier acc 0.5561224489795918, precision 0.5380658199057958, recall 0.5791997354497355, F1 0.5442459239348858, AUC 0.7105172508818342
  Second-Tier acc 0.6122448979591837, precision 0.607073238652186, recall 0.6316137566137566, F1 0.6039459261965656, AUC 0.7256393298059964
epoch: 9 idx: 0 First Loss : 2.6101179122924805, Second Loss : 2.7926442623138428
epoch: 9 idx: 200 First Loss : 0.9805782704025655, Second Loss : 0.9709425235343216
  First-Tier acc 0.5989583333333334, precision 0.5990027007511224, recall 0.6220959595959595, F1 0.5850801303827772, AUC 0.7514109848484848
  Second-Tier acc 0.5416666666666666, precision 0.5904040404040404, recall 0.5885858585858587, F1 0.5283109196152674, AUC 0.7664141414141414
  First-Tier acc 0.5561224489795918, precision 0.5511341556441515, recall 0.6129850088183422, F1 0.5497391300892481, AUC 0.7209270282186949
  Second-Tier acc 0.6122448979591837, precision 0.617989417989418, recall 0.6609347442680776, F1 0.6201058201058202, AUC 0.7348985890652558{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.10403377440084034, "droprate_2": 0.0, "lr": 0.00012135754683502794, "weight_decay": 1.2653883810346594e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 19, "gamma": 0.20630938684663802, "T_max": 6, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1321649551391602, Second Loss : 1.1633864641189575
epoch: 0 idx: 200 First Loss : 1.1034970937009474, Second Loss : 1.1097237683499037
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7500063131313132
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7656060606060606
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7038414902998236
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7112544091710759
epoch: 1 idx: 0 First Loss : 1.811454176902771, Second Loss : 1.8031915426254272
epoch: 1 idx: 200 First Loss : 1.000416470330153, Second Loss : 1.0076320174321607
  First-Tier acc 0.546875, precision 0.44116161616161614, recall 0.3790656565656565, F1 0.32313472893183043, AUC 0.7341477272727271
  Second-Tier acc 0.5416666666666666, precision 0.34848484848484845, recall 0.3806060606060606, F1 0.3207729468599034, AUC 0.7566666666666665
  First-Tier acc 0.576530612244898, precision 0.5398326898326898, recall 0.3764880952380953, F1 0.3224533651154811, AUC 0.6940310846560847
  Second-Tier acc 0.5714285714285714, precision 0.35815602836879434, recall 0.35714285714285715, F1 0.2849099099099099, AUC 0.7098214285714285
epoch: 2 idx: 0 First Loss : 2.334634304046631, Second Loss : 2.2255771160125732
epoch: 2 idx: 200 First Loss : 0.9557538089245113, Second Loss : 0.9594936420149471{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.1492900043075593, "droprate_2": 0.0, "lr": 0.0009878986983059476, "weight_decay": 4.0464074688056955e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 15, "gamma": 0.19462503036772427, "T_max": 18, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0436702966690063, Second Loss : 1.0519022941589355
epoch: 0 idx: 200 First Loss : 1.1054157031635148, Second Loss : 1.0893317284572184
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.727376893939394
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7361616161616161
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7180025077160495
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7188051146384481
epoch: 1 idx: 0 First Loss : 1.8247523307800293, Second Loss : 1.8162704706192017
epoch: 1 idx: 200 First Loss : 0.9826314642061642, Second Loss : 0.9674742476115772
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6960037878787878
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6938888888888889
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.712938850308642
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7174823633156967
epoch: 2 idx: 0 First Loss : 2.303813934326172, Second Loss : 2.2838337421417236
epoch: 2 idx: 200 First Loss : 0.9546328441272327, Second Loss : 0.9386454697568618
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6552114898989899
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6659090909090909
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6773761298500882
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6915233686067018
epoch: 3 idx: 0 First Loss : 2.4657368659973145, Second Loss : 2.449686288833618
epoch: 3 idx: 200 First Loss : 0.9482223684922676, Second Loss : 0.9291697491090096
  First-Tier acc 0.53125, precision 0.33160805131608045, recall 0.43757575757575756, F1 0.3771043771043771, AUC 0.6977272727272728
  Second-Tier acc 0.4791666666666667, precision 0.3357142857142857, recall 0.4763636363636364, F1 0.3635327635327635, AUC 0.6937878787878787
  First-Tier acc 0.5051020408163265, precision 0.2662337662337662, recall 0.33134920634920634, F1 0.29023212338370463, AUC 0.662171378968254
  Second-Tier acc 0.5306122448979592, precision 0.373015873015873, recall 0.435626102292769, F1 0.38095238095238093, AUC 0.6767526455026456
epoch: 4 idx: 0 First Loss : 2.3714869022369385, Second Loss : 2.3692095279693604
epoch: 4 idx: 200 First Loss : 0.9272838289946762, Second Loss : 0.9109161310268575
  First-Tier acc 0.3802083333333333, precision 0.3627433885498402, recall 0.4257575757575758, F1 0.29003900279988754, AUC 0.5724337121212121
  Second-Tier acc 0.4375, precision 0.3611721611721612, recall 0.4666666666666666, F1 0.3348588863463005, AUC 0.5762121212121212
  First-Tier acc 0.4387755102040816, precision 0.40100168762589145, recall 0.41446208112874783, F1 0.3169493149372425, AUC 0.697482638888889
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.7379298941798943
epoch: 5 idx: 0 First Loss : 2.5159196853637695, Second Loss : 2.674654006958008
epoch: 5 idx: 200 First Loss : 0.936580502891459, Second Loss : 0.9130388033571676
  First-Tier acc 0.4427083333333333, precision 0.3419191919191919, recall 0.46575757575757576, F1 0.3378787878787879, AUC 0.5857228535353536
  Second-Tier acc 0.5625, precision 0.3976190476190476, recall 0.5466666666666667, F1 0.425071225071225, AUC 0.6980303030303029
  First-Tier acc 0.4744897959183674, precision 0.38171568008750895, recall 0.4217372134038801, F1 0.34654234654234656, AUC 0.6570767195767195
  Second-Tier acc 0.5918367346938775, precision 0.43608124253285546, recall 0.5070546737213404, F1 0.4296296296296296, AUC 0.6931768077601411
epoch: 6 idx: 0 First Loss : 3.472080945968628, Second Loss : 3.71917462348938
epoch: 6 idx: 200 First Loss : 0.9197248154996306, Second Loss : 0.8947470010123888
  First-Tier acc 0.3541666666666667, precision 0.3176983435047951, recall 0.4090909090909091, F1 0.2657081025565785, AUC 0.5270012626262627
  Second-Tier acc 0.4375, precision 0.3611721611721612, recall 0.4666666666666666, F1 0.3348588863463005, AUC 0.5726262626262627
  First-Tier acc 0.413265306122449, precision 0.39130961026385863, recall 0.3990299823633157, F1 0.2951716414696128, AUC 0.5818624614197531
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.6369598765432098
epoch: 7 idx: 0 First Loss : 3.3538904190063477, Second Loss : 3.6699507236480713
epoch: 7 idx: 200 First Loss : 0.9241098833481193, Second Loss : 0.9025636479103317
  First-Tier acc 0.3333333333333333, precision 0.3544910179640719, recall 0.39999999999999997, F1 0.24568720379146916, AUC 0.48686868686868684
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.5392929292929293
  First-Tier acc 0.3877551020408163, precision 0.37965448413517794, recall 0.38359788359788355, F1 0.2722442255027113, AUC 0.5563168264991182
  Second-Tier acc 0.42857142857142855, precision 0.3581081081081081, recall 0.3968253968253968, F1 0.31070889894419307, AUC 0.5854276895943563
epoch: 8 idx: 0 First Loss : 3.0661189556121826, Second Loss : 3.3195228576660156
epoch: 8 idx: 200 First Loss : 0.9121281968189904, Second Loss : 0.8897546107188071
  First-Tier acc 0.3020833333333333, precision 0.3435504469987229, recall 0.38000000000000006, F1 0.21365262012128752, AUC 0.4747537878787879
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.4556565656565656
  First-Tier acc 0.37244897959183676, precision 0.41968372867249276, recall 0.38580246913580246, F1 0.24949124949124948, AUC 0.5279569003527337
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.5734126984126985
epoch: 9 idx: 0 First Loss : 2.8355789184570312, Second Loss : 3.0693211555480957
epoch: 9 idx: 200 First Loss : 0.8990855372611628, Second Loss : 0.8792730664958325
  First-Tier acc 0.2864583333333333, precision 0.3273069679849341, recall 0.37000000000000005, F1 0.19649813102498523, AUC 0.475501893939394
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.4458585858585858
  First-Tier acc 0.3622448979591837, precision 0.4364640883977901, recall 0.3796296296296296, F1 0.23882542622894584, AUC 0.5546496086860669
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.5668540564373897{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.26622359772887005, "droprate_2": 0.0, "lr": 0.0002509925841736384, "weight_decay": 1.0257179392102223e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 15, "gamma": 0.43893732383792194, "T_max": 17, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1256494522094727, Second Loss : 1.1050398349761963
epoch: 0 idx: 200 First Loss : 1.0781339307626088, Second Loss : 1.0794508041656432
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7356376262626263
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7614646464646465
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7205033344356261
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7156084656084656
epoch: 1 idx: 0 First Loss : 1.670715570449829, Second Loss : 1.7463072538375854
epoch: 1 idx: 200 First Loss : 0.9844605729206285, Second Loss : 0.9807103706236503
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7206912878787879
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7312121212121211
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.720747905643739
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7194113756613757
epoch: 2 idx: 0 First Loss : 2.0696661472320557, Second Loss : 2.1323840618133545
epoch: 2 idx: 200 First Loss : 0.9540181898359043, Second Loss : 0.9488198465264556
  First-Tier acc 0.5833333333333334, precision 0.5588235294117646, recall 0.5495454545454546, F1 0.5407903410470805, AUC 0.7042960858585858
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.716060606060606
  First-Tier acc 0.47959183673469385, precision 0.42948016415868673, recall 0.4873787477954144, F1 0.4313815181172694, AUC 0.6814477237654321
  Second-Tier acc 0.4897959183673469, precision 0.3383838383838384, recall 0.39947089947089953, F1 0.35042309606769534, AUC 0.6969797178130511
epoch: 3 idx: 0 First Loss : 3.066483974456787, Second Loss : 3.390249013900757
epoch: 3 idx: 200 First Loss : 0.9405713406071734, Second Loss : 0.9329952806632836
  First-Tier acc 0.375, precision 0.36039886039886043, recall 0.4224242424242424, F1 0.28549019607843135, AUC 0.7001262626262627
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.6952525252525253
  First-Tier acc 0.45408163265306123, precision 0.40694055399937756, recall 0.4237213403880071, F1 0.3303136629452419, AUC 0.6768008708112875
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6996803350970019
epoch: 4 idx: 0 First Loss : 3.581129789352417, Second Loss : 3.794358730316162
epoch: 4 idx: 200 First Loss : 0.9333147206251041, Second Loss : 0.9294331327534804
  First-Tier acc 0.34375, precision 0.36049382716049383, recall 0.4066666666666667, F1 0.2558364414974444, AUC 0.7242897727272727
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7227777777777776
  First-Tier acc 0.4387755102040816, precision 0.4165631469979296, recall 0.4201940035273369, F1 0.3150827666956699, AUC 0.6657469411375662
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.6734457671957671
epoch: 5 idx: 0 First Loss : 3.702864646911621, Second Loss : 3.7391843795776367
epoch: 5 idx: 200 First Loss : 0.9246080815734166, Second Loss : 0.9231885851694466
  First-Tier acc 0.3489583333333333, precision 0.3728395061728395, recall 0.41, F1 0.2610857853294654, AUC 0.6961837121212122
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7094949494949495
  First-Tier acc 0.44387755102040816, precision 0.4268942144759138, recall 0.4261463844797178, F1 0.3184304604384718, AUC 0.6105599647266314
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.6227954144620812
epoch: 6 idx: 0 First Loss : 3.834451198577881, Second Loss : 3.7997257709503174
epoch: 6 idx: 200 First Loss : 0.9196316782125638, Second Loss : 0.913858774748274
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.683699494949495
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7095959595959597
  First-Tier acc 0.4387755102040816, precision 0.42560575075912505, recall 0.4230599647266314, F1 0.3139998056931896, AUC 0.6122202932098766
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6375661375661377
epoch: 7 idx: 0 First Loss : 3.9674301147460938, Second Loss : 3.910447597503662
epoch: 7 idx: 200 First Loss : 0.9156615033413316, Second Loss : 0.912539467016879
  First-Tier acc 0.359375, precision 0.37733587194132995, recall 0.4166666666666667, F1 0.2709058907238887, AUC 0.6699905303030302
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6975757575757576
  First-Tier acc 0.4336734693877551, precision 0.43674164962508516, recall 0.42283950617283955, F1 0.31056846006220634, AUC 0.6209249614197531
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6558090828924162
epoch: 8 idx: 0 First Loss : 4.109650135040283, Second Loss : 3.9782447814941406
epoch: 8 idx: 200 First Loss : 0.9193611605352356, Second Loss : 0.9140261263699231
  First-Tier acc 0.359375, precision 0.3784536303276933, recall 0.4166666666666667, F1 0.27228839730257764, AUC 0.6618939393939395
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6836868686868686
  First-Tier acc 0.44387755102040816, precision 0.49835280023959266, recall 0.43634259259259256, F1 0.3356649641786143, AUC 0.626870453042328
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6566909171075838
epoch: 9 idx: 0 First Loss : 4.025600910186768, Second Loss : 3.9037926197052
epoch: 9 idx: 200 First Loss : 0.9190994073905859, Second Loss : 0.9137644286980431
  First-Tier acc 0.3541666666666667, precision 0.4317493594223154, recall 0.4169444444444444, F1 0.27757976613076624, AUC 0.6606218434343435
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6787373737373738
  First-Tier acc 0.44387755102040816, precision 0.5055555555555556, recall 0.43634259259259256, F1 0.33531090205384634, AUC 0.6378727127425045
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6665564373897707{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.15379958467246987, "droprate_2": 0.0, "lr": 1.500781456674889e-05, "weight_decay": 4.9902881662903916e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.2468218803405762, Second Loss : 1.1825370788574219
epoch: 0 idx: 200 First Loss : 1.0596759322270826, Second Loss : 1.0596222527584627
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6922348484848485
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7354040404040404
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6245487488977072
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6258267195767196
epoch: 1 idx: 0 First Loss : 1.9908804893493652, Second Loss : 1.9948627948760986
epoch: 1 idx: 200 First Loss : 1.0835328005736147, Second Loss : 1.0880389916363047
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7170202020202021
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7534343434343435
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6645171957671957
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6539351851851852
epoch: 2 idx: 0 First Loss : 2.049950122833252, Second Loss : 2.0574772357940674
epoch: 2 idx: 200 First Loss : 1.0684132156383932, Second Loss : 1.076745698256279
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7311237373737374
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7536868686868686
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6918471671075839
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6903659611992946
epoch: 3 idx: 0 First Loss : 2.115255117416382, Second Loss : 2.124723196029663
epoch: 3 idx: 200 First Loss : 1.0577783241349072, Second Loss : 1.0680824647940212
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7343592171717171
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.755
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7065868882275131
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118055555555555
epoch: 4 idx: 0 First Loss : 2.2059178352355957, Second Loss : 2.2394700050354004
epoch: 4 idx: 200 First Loss : 1.0445711577116554, Second Loss : 1.0535417648764391
  First-Tier acc 0.5729166666666666, precision 0.4664088239507234, recall 0.41333333333333333, F1 0.3652141105451802, AUC 0.7355650252525253
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7532828282828282
  First-Tier acc 0.5510204081632653, precision 0.19047619047619047, recall 0.3333333333333333, F1 0.24242424242424243, AUC 0.705336474867725
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7057429453262786
epoch: 5 idx: 0 First Loss : 2.306774377822876, Second Loss : 2.360551118850708
epoch: 5 idx: 200 First Loss : 1.0294615288649624, Second Loss : 1.0357810328181702
  First-Tier acc 0.6302083333333334, precision 0.6492063492063492, recall 0.510479797979798, F1 0.4911545838128117, AUC 0.7387720959595959
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7578787878787878
  First-Tier acc 0.6224489795918368, precision 0.5916655361099806, recall 0.46671075837742504, F1 0.46807760141093474, AUC 0.6944582231040565
  Second-Tier acc 0.6326530612244898, precision 0.7093023255813954, recall 0.46428571428571425, F1 0.46455026455026455, AUC 0.7001212522045854
epoch: 6 idx: 0 First Loss : 2.4260706901550293, Second Loss : 2.5102951526641846
epoch: 6 idx: 200 First Loss : 1.0113289749518555, Second Loss : 1.0168123631853963
  First-Tier acc 0.6666666666666666, precision 0.6213768115942029, recall 0.6015151515151516, F1 0.5861745871250421, AUC 0.7393118686868686
  Second-Tier acc 0.6875, precision 0.6097222222222222, recall 0.6071717171717171, F1 0.5486291486291486, AUC 0.7527777777777778
  First-Tier acc 0.5969387755102041, precision 0.5496071829405164, recall 0.5513117283950617, F1 0.5504093837427172, AUC 0.6937003968253969
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5670194003527337, F1 0.5623931623931624, AUC 0.705081569664903
epoch: 7 idx: 0 First Loss : 2.5488150119781494, Second Loss : 2.659158229827881
epoch: 7 idx: 200 First Loss : 0.995004549177725, Second Loss : 0.998641203607048
  First-Tier acc 0.6354166666666666, precision 0.5995115995115995, recall 0.6146464646464647, F1 0.5982476871090606, AUC 0.74228851010101
  Second-Tier acc 0.6666666666666666, precision 0.6331639375117636, recall 0.649090909090909, F1 0.6372463768115942, AUC 0.7586363636363637
  First-Tier acc 0.5714285714285714, precision 0.5393473612849395, recall 0.5737985008818343, F1 0.546722123842213, AUC 0.6945994543650794
  Second-Tier acc 0.6122448979591837, precision 0.5942760942760943, recall 0.6201499118165784, F1 0.601265506202481, AUC 0.7132385361552028
epoch: 8 idx: 0 First Loss : 2.6772143840789795, Second Loss : 2.802593231201172
epoch: 8 idx: 200 First Loss : 0.9801973310201916, Second Loss : 0.9825253382658781
  First-Tier acc 0.5989583333333334, precision 0.5806820806820808, recall 0.6015151515151516, F1 0.5777638453500522, AUC 0.7490246212121212
  Second-Tier acc 0.6666666666666666, precision 0.6568627450980392, recall 0.6898989898989899, F1 0.6546469622331692, AUC 0.7725757575757575
  First-Tier acc 0.5612244897959183, precision 0.551781417297092, recall 0.6087411816578484, F1 0.5497718351365584, AUC 0.7016093474426808
  Second-Tier acc 0.6326530612244898, precision 0.6298245614035087, recall 0.6732804232804233, F1 0.6356919579425973, AUC 0.7172619047619048
epoch: 9 idx: 0 First Loss : 2.797699213027954, Second Loss : 2.9420969486236572
epoch: 9 idx: 200 First Loss : 0.96822050374131, Second Loss : 0.9689515834739107
  First-Tier acc 0.5520833333333334, precision 0.5737691303524112, recall 0.589570707070707, F1 0.5469602860907209, AUC 0.7548863636363636
  Second-Tier acc 0.5625, precision 0.606951871657754, recall 0.6232323232323232, F1 0.5601851851851852, AUC 0.7926262626262627
  First-Tier acc 0.5357142857142857, precision 0.5436405770344889, recall 0.6051036155202821, F1 0.5293791302928939, AUC 0.7112854111552028
  Second-Tier acc 0.5918367346938775, precision 0.5943478606017306, recall 0.6549823633156966, F1 0.5959595959595959, AUC 0.7274581128747796{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_0", "train_show_freq": 200, "droprate": 0.0737912902592551, "droprate_2": 0.0, "lr": 3.623225169773667e-05, "weight_decay": 7.272602744870009e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 11, "gamma": 0.30554423278660525, "T_max": 16, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_0", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1097497940063477, Second Loss : 1.0849411487579346
epoch: 0 idx: 200 First Loss : 1.1122660789620225, Second Loss : 1.1136733633813574
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7299905303030303
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7273232323232323
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6727086089065256
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6646274250440917
epoch: 1 idx: 0 First Loss : 2.076071262359619, Second Loss : 2.1104979515075684
epoch: 1 idx: 200 First Loss : 1.0598100503137455, Second Loss : 1.0677751978090153
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7333175505050505
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482828282828283
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705136684303351
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7038690476190476
epoch: 2 idx: 0 First Loss : 2.233929395675659, Second Loss : 2.3067691326141357
epoch: 2 idx: 200 First Loss : 1.0164327362728356, Second Loss : 1.0179577793796264
  First-Tier acc 0.6145833333333334, precision 0.39365079365079364, recall 0.4909090909090909, F1 0.43162790697674414, AUC 0.7326704545454544
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7528787878787879
  First-Tier acc 0.6020408163265306, precision 0.579235679779158, recall 0.41898148148148145, F1 0.39694394824506346, AUC 0.6929770171957671
  Second-Tier acc 0.6326530612244898, precision 0.7142857142857143, recall 0.4464285714285714, F1 0.43494363929146534, AUC 0.6985229276895945
epoch: 3 idx: 0 First Loss : 2.520328998565674, Second Loss : 2.6197080612182617
epoch: 3 idx: 200 First Loss : 0.9765093547861967, Second Loss : 0.9776802625303245
  First-Tier acc 0.6041666666666666, precision 0.5599290372075182, recall 0.5791161616161616, F1 0.5402594232879081, AUC 0.7351231060606062
  Second-Tier acc 0.625, precision 0.5675925925925925, recall 0.5765656565656566, F1 0.5649747078318507, AUC 0.764040404040404
  First-Tier acc 0.576530612244898, precision 0.5519938056523422, recall 0.5574294532627866, F1 0.5445593735390369, AUC 0.7012579916225748
  Second-Tier acc 0.6326530612244898, precision 0.6058201058201058, recall 0.6439594356261024, F1 0.6157407407407407, AUC 0.7066798941798943
epoch: 4 idx: 0 First Loss : 2.8913655281066895, Second Loss : 3.00563383102417
epoch: 4 idx: 200 First Loss : 0.9507066466989209, Second Loss : 0.9522345057730355
  First-Tier acc 0.5625, precision 0.5747216879407822, recall 0.6012878787878787, F1 0.5481515529581719, AUC 0.7529261363636364
  Second-Tier acc 0.5625, precision 0.6048331613347093, recall 0.6087878787878788, F1 0.5606503054778917, AUC 0.7787373737373736
  First-Tier acc 0.5612244897959183, precision 0.5629951071761417, recall 0.6275352733686067, F1 0.56075001656397, AUC 0.722577022707231
  Second-Tier acc 0.5714285714285714, precision 0.5612535612535613, recall 0.61331569664903, F1 0.5645502645502646, AUC 0.7320877425044091
epoch: 5 idx: 0 First Loss : 3.2104785442352295, Second Loss : 3.320147752761841
epoch: 5 idx: 200 First Loss : 0.9397124055754486, Second Loss : 0.9387614701536313
  First-Tier acc 0.5104166666666666, precision 0.5620848207580956, recall 0.566060606060606, F1 0.505763349800047, AUC 0.7625599747474747
  Second-Tier acc 0.5208333333333334, precision 0.5875816993464053, recall 0.5821212121212122, F1 0.5241584564860426, AUC 0.8031818181818182
  First-Tier acc 0.5459183673469388, precision 0.5739159051598782, recall 0.6297398589065256, F1 0.5476258103160111, AUC 0.7380676807760141
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7388668430335096
epoch: 6 idx: 0 First Loss : 3.432507038116455, Second Loss : 3.55287766456604
epoch: 6 idx: 200 First Loss : 0.9354723034825047, Second Loss : 0.9322726062976232
  First-Tier acc 0.4635416666666667, precision 0.5328282828282829, recall 0.5282070707070707, F1 0.46059306152416446, AUC 0.7684627525252526
  Second-Tier acc 0.5416666666666666, precision 0.6154761904761904, recall 0.6149494949494949, F1 0.5479853479853479, AUC 0.8262626262626261
  First-Tier acc 0.5051020408163265, precision 0.5435762845427469, recall 0.580191798941799, F1 0.5051898756715372, AUC 0.7450534611992946
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7418981481481483
epoch: 7 idx: 0 First Loss : 3.5688834190368652, Second Loss : 3.7229092121124268
epoch: 7 idx: 200 First Loss : 0.9345800989210161, Second Loss : 0.9282176473840552
  First-Tier acc 0.453125, precision 0.535, recall 0.5270454545454545, F1 0.44696969696969696, AUC 0.7659059343434343
  Second-Tier acc 0.5208333333333334, precision 0.5948717948717949, recall 0.5896969696969697, F1 0.5182754182754182, AUC 0.8359595959595959
  First-Tier acc 0.47959183673469385, precision 0.5402777777777777, recall 0.5529651675485009, F1 0.4764982373678026, AUC 0.7499621086860669
  Second-Tier acc 0.5306122448979592, precision 0.5551839464882944, recall 0.6115520282186949, F1 0.5373230373230373, AUC 0.7459215167548501
epoch: 8 idx: 0 First Loss : 3.6242125034332275, Second Loss : 3.8126728534698486
epoch: 8 idx: 200 First Loss : 0.9316423261857856, Second Loss : 0.9241760371934011
  First-Tier acc 0.4375, precision 0.5185064935064935, recall 0.5068434343434344, F1 0.42594314816899037, AUC 0.7595770202020201
  Second-Tier acc 0.5, precision 0.5670940170940172, recall 0.5619191919191919, F1 0.4904976404976405, AUC 0.8296969696969696
  First-Tier acc 0.5, precision 0.5608802961744138, recall 0.572310405643739, F1 0.4934214628671197, AUC 0.7503065751763668
  Second-Tier acc 0.5306122448979592, precision 0.5723905723905723, recall 0.5758377425044091, F1 0.5109114249037227, AUC 0.7549603174603176
epoch: 9 idx: 0 First Loss : 3.6505613327026367, Second Loss : 3.8630270957946777
epoch: 9 idx: 200 First Loss : 0.928619289330545, Second Loss : 0.9198323416949913
  First-Tier acc 0.4375, precision 0.5184971838197645, recall 0.5110858585858586, F1 0.42534985635298156, AUC 0.7523421717171717
  Second-Tier acc 0.5, precision 0.5570145903479237, recall 0.5644444444444444, F1 0.48035305655442956, AUC 0.8161616161616161
  First-Tier acc 0.5153061224489796, precision 0.5928203871600098, recall 0.5930335097001763, F1 0.5051805013490838, AUC 0.7504581404320988
  Second-Tier acc 0.5306122448979592, precision 0.5723905723905723, recall 0.5758377425044091, F1 0.5109114249037227, AUC 0.7703924162257495