{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_22", "train_show_freq": 200, "droprate": 0.3104470086721035, "droprate_2": 0.0, "lr": 2.011263005343364e-05, "weight_decay": 3.674168612644236e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_22", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.011263005343364e-05
epoch: 0 idx: 0 First Loss : 1.2318145036697388, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0979512072914275, Second Loss : 1.0813042992976174
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6972390572390572
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7474747474747475
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6392991867528904
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6432980599647266
Test AUC: 0.6433, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.011263005343364e-05
epoch: 1 idx: 0 First Loss : 2.1060009002685547, Second Loss : 2.0616648197174072
epoch: 1 idx: 200 First Loss : 1.1001880925834475, Second Loss : 1.0883422660738675
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7280415263748597
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7646464646464647
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6881797472075251
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7017195767195767
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 2 idx: 0 First Loss : 2.2078113555908203, Second Loss : 2.1644132137298584
epoch: 2 idx: 200 First Loss : 1.074928780100239, Second Loss : 1.0630801478725167
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7400280583613915
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.757929292929293
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7057551930237116
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7093253968253969
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 3 idx: 0 First Loss : 2.3570635318756104, Second Loss : 2.285600185394287
epoch: 3 idx: 200 First Loss : 1.049032949244798, Second Loss : 1.0403218015064648
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5347222222222222, precision 0.513189448441247, recall 0.35353535353535354, F1 0.2717400979083222, AUC 0.7364478114478114
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.749141414141414
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113217715069567
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7126873897707231
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 4 idx: 0 First Loss : 2.5544655323028564, Second Loss : 2.4379019737243652
epoch: 4 idx: 200 First Loss : 1.022303948540296, Second Loss : 1.015484997363233
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.625, precision 0.6345959595959596, recall 0.49821548821548817, F1 0.502109085830016, AUC 0.7351515151515152
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7505555555555555
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6190476190476191, precision 0.5499452654625069, recall 0.5227807172251616, F1 0.48568378281938834, AUC 0.6955344895159709
  Second-Tier acc 0.5918367346938775, precision 0.5246031746031746, recall 0.44466490299823636, F1 0.4421836228287841, AUC 0.7006172839506174
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 5 idx: 0 First Loss : 2.7697551250457764, Second Loss : 2.6303465366363525
epoch: 5 idx: 200 First Loss : 0.994544415887612, Second Loss : 0.9902856807358822
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.5174603174603175, recall 0.49986531986531985, F1 0.4815623216760414, AUC 0.7293883277216611
  Second-Tier acc 0.625, precision 0.5805555555555556, recall 0.5816161616161616, F1 0.5353851217906517, AUC 0.746969696969697
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4897959183673469, precision 0.42921884969464946, recall 0.46965020576131683, F1 0.4217440933858844, AUC 0.6997905643738976
  Second-Tier acc 0.6530612244897959, precision 0.6437400318979266, recall 0.6677689594356261, F1 0.6482426303854875, AUC 0.7140652557319225
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 6 idx: 0 First Loss : 3.016535520553589, Second Loss : 2.8614516258239746
epoch: 6 idx: 200 First Loss : 0.9712834305764727, Second Loss : 0.9697445877711868
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5138888888888888, precision 0.5315766550522648, recall 0.5024579124579125, F1 0.4603303047094662, AUC 0.732581369248036
  Second-Tier acc 0.5833333333333334, precision 0.5982905982905983, recall 0.6296969696969698, F1 0.5734615384615385, AUC 0.7566161616161615
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.4643075178789464, recall 0.5153586125808348, F1 0.42381221719457013, AUC 0.7073535175387026
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7375440917107584
Test AUC: 0.7017, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.011263005343364e-05
epoch: 7 idx: 0 First Loss : 3.2378695011138916, Second Loss : 3.0722618103027344
epoch: 7 idx: 200 First Loss : 0.9534414639205333, Second Loss : 0.9543216511310629
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.4579124579124579, recall 0.4474410774410775, F1 0.37916096671226635, AUC 0.7374971941638608
  Second-Tier acc 0.5416666666666666, precision 0.5981481481481482, recall 0.6124242424242424, F1 0.5428366174055829, AUC 0.7768181818181819
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.47566785360063735, recall 0.5045561434450323, F1 0.3989764129951046, AUC 0.7161106212032138
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7568893298059963
Test AUC: 0.7569, Test F1: 0.4984 (Best Epoch: 7)
Current LR: 2.011263005343364e-05
epoch: 8 idx: 0 First Loss : 3.4214890003204346, Second Loss : 3.2387983798980713
epoch: 8 idx: 200 First Loss : 0.9421010153154977, Second Loss : 0.9447820221643839
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4305555555555556, precision 0.48991455017050467, recall 0.4579124579124579, F1 0.38601688988685895, AUC 0.7460381593714928
  Second-Tier acc 0.5208333333333334, precision 0.5913299663299664, recall 0.6135353535353536, F1 0.5214006187637019, AUC 0.7935353535353534
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.4794864185807268, recall 0.5042621987066431, F1 0.3976350313720329, AUC 0.7266926317852244
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.765707671957672
Test AUC: 0.7657, Test F1: 0.5178 (Best Epoch: 8)
Current LR: 2.011263005343364e-05
epoch: 9 idx: 0 First Loss : 3.5562832355499268, Second Loss : 3.3660051822662354
epoch: 9 idx: 200 First Loss : 0.9343876895999804, Second Loss : 0.9387768637805954
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.4583333333333333, recall 0.4356902356902357, F1 0.354775828460039, AUC 0.7504433221099888
  Second-Tier acc 0.5, precision 0.574874686716792, recall 0.5857575757575758, F1 0.501010101010101, AUC 0.8045454545454546
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5134453781512606, recall 0.5077895355673133, F1 0.39884113954611305, AUC 0.7337901724475798
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.7761243386243386
Test AUC: 0.7761, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.011263005343364e-05
epoch: 10 idx: 0 First Loss : 3.665290594100952, Second Loss : 3.4674370288848877
epoch: 10 idx: 200 First Loss : 0.9285038771033658, Second Loss : 0.9345463254901382
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.375, precision 0.46288231891947057, recall 0.4288552188552189, F1 0.3458565773911478, AUC 0.7534904601571268
  Second-Tier acc 0.5, precision 0.5785714285714286, recall 0.6027272727272727, F1 0.500366568914956, AUC 0.8015656565656566
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3945578231292517, precision 0.5178571428571429, recall 0.5033803644914756, F1 0.38883009994121104, AUC 0.7398344111307075
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7809744268077602
Test AUC: 0.7761, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.011263005343364e-05
epoch: 11 idx: 0 First Loss : 3.750497817993164, Second Loss : 3.545938491821289
epoch: 11 idx: 200 First Loss : 0.9234243022713495, Second Loss : 0.9311358564792767
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.4830623306233062, recall 0.45555555555555555, F1 0.37225650238225416, AUC 0.7590852974186307
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8052525252525252
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5332343987823439, recall 0.5351263962375074, F1 0.42042290096974094, AUC 0.7455418381344309
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7907848324514991
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 12 idx: 0 First Loss : 3.80728816986084, Second Loss : 3.5996344089508057
epoch: 12 idx: 200 First Loss : 0.9185510589277825, Second Loss : 0.9275957226072118
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.5104072398190045, recall 0.5016161616161616, F1 0.4071196516209304, AUC 0.7608810325476992
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.8005555555555556
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.5467896174863388, recall 0.5270429159318049, F1 0.42335981170932624, AUC 0.7481383499902018
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.7900683421516755
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 13 idx: 0 First Loss : 3.8460559844970703, Second Loss : 3.6365373134613037
epoch: 13 idx: 200 First Loss : 0.9137253390164092, Second Loss : 0.9243787273820212
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4166666666666667, precision 0.5142073778664008, recall 0.5041414141414141, F1 0.4122073578595318, AUC 0.7602188552188552
  Second-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.7954040404040404
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.56057166876839, recall 0.5467372134038802, F1 0.4374198277441817, AUC 0.7559095140113659
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7912257495590828
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 14 idx: 0 First Loss : 3.852959632873535, Second Loss : 3.647897481918335
epoch: 14 idx: 200 First Loss : 0.9090006985708571, Second Loss : 0.921109410112872
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5221003655699569, recall 0.5176094276094276, F1 0.42126862571840706, AUC 0.7589955106621774
  Second-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.7925757575757576
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4557823129251701, precision 0.5793532338308457, recall 0.5803203997648442, F1 0.45770127471462746, AUC 0.7595838232412307
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.798831569664903
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 15 idx: 0 First Loss : 3.8536341190338135, Second Loss : 3.6412487030029297
epoch: 15 idx: 200 First Loss : 0.9050607730933368, Second Loss : 0.918881835703233
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.4881951381951382, recall 0.4733670033670034, F1 0.3752525252525252, AUC 0.7528282828282827
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7832828282828284
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46258503401360546, precision 0.584644004735329, recall 0.5823045267489712, F1 0.4652722128400131, AUC 0.7636929257299627
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7971781305114639
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 16 idx: 0 First Loss : 3.845097780227661, Second Loss : 3.6226165294647217
epoch: 16 idx: 200 First Loss : 0.9011955650127146, Second Loss : 0.9167747325084371
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.4980280228334199, recall 0.4944107744107744, F1 0.385518887142774, AUC 0.74658810325477
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7671717171717171
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5827003185493751, recall 0.5719429747207525, F1 0.4482156498963221, AUC 0.7642991867528904
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7994929453262788
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 17 idx: 0 First Loss : 3.831866502761841, Second Loss : 3.6000571250915527
epoch: 17 idx: 200 First Loss : 0.8974120837551731, Second Loss : 0.9150594811456797
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3958333333333333, precision 0.49907455910598925, recall 0.4944107744107744, F1 0.38563685636856365, AUC 0.7394556677890011
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7542424242424243
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5806668346350886, recall 0.5600382128159906, F1 0.44433913447325696, AUC 0.7646176268861454
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8019179894179894
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 18 idx: 0 First Loss : 3.8042166233062744, Second Loss : 3.564950704574585
epoch: 18 idx: 200 First Loss : 0.8938649500585834, Second Loss : 0.9139183331454701
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.4749278499278499, recall 0.4621885521885522, F1 0.35328772918149837, AUC 0.729270482603816
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7323232323232323
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5738119312436805, recall 0.5399029982363316, F1 0.42410714285714285, AUC 0.7619292572996278
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8027447089947092
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)
Current LR: 2.011263005343364e-05
epoch: 19 idx: 0 First Loss : 3.776143789291382, Second Loss : 3.524134635925293
epoch: 19 idx: 200 First Loss : 0.8912721864681631, Second Loss : 0.9133549697479391
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.46137863942741997, recall 0.4484848484848485, F1 0.3368352514693978, AUC 0.7208754208754208
  Second-Tier acc 0.375, precision 0.4590277777777778, recall 0.45555555555555555, F1 0.33867557798540543, AUC 0.7114646464646465
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5606060606060606, recall 0.5121252204585538, F1 0.40597662141779783, AUC 0.7575874485596708
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7971230158730158
Test AUC: 0.7908, Test F1: 0.4905 (Best Epoch: 11)