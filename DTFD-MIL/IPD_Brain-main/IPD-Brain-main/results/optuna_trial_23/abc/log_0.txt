{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_23", "train_show_freq": 200, "droprate": 0.38619679354820147, "droprate_2": 0.0, "lr": 1.4581099300887566e-05, "weight_decay": 1.6693005432129008e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_23", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.4581099300887566e-05
epoch: 0 idx: 0 First Loss : 1.248856544494629, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0705415797767355, Second Loss : 1.053221781307192
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6817340067340067
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7478282828282827
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6204438565549677
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6183311287477954
Test AUC: 0.6183, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.4581099300887566e-05
epoch: 1 idx: 0 First Loss : 2.1060667037963867, Second Loss : 2.027081251144409
epoch: 1 idx: 200 First Loss : 1.10800628275124, Second Loss : 1.0967875584144497
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.720016835016835
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.752979797979798
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.672484322947286
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6749889770723105
Test AUC: 0.6750, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.4581099300887566e-05
epoch: 2 idx: 0 First Loss : 2.1772220134735107, Second Loss : 2.1173877716064453
epoch: 2 idx: 200 First Loss : 1.0923080813528887, Second Loss : 1.0826432492899065
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7340347923681257
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.763888888888889
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6972307956104252
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7060185185185185
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 3 idx: 0 First Loss : 2.2675657272338867, Second Loss : 2.2055845260620117
epoch: 3 idx: 200 First Loss : 1.0762604654799053, Second Loss : 1.0665947906116942
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410325476992144
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7555555555555555
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.708664021164021
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099316578483247
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 4 idx: 0 First Loss : 2.3632049560546875, Second Loss : 2.307874917984009
epoch: 4 idx: 200 First Loss : 1.0590691582406337, Second Loss : 1.0499702081158386
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7391133557800225
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7535353535353536
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7129323437193807
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7100970017636685
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 5 idx: 0 First Loss : 2.470193862915039, Second Loss : 2.4205732345581055
epoch: 5 idx: 200 First Loss : 1.0393482144569877, Second Loss : 1.0313514331680032
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5902777777777778, precision 0.4067628749292586, recall 0.44565656565656564, F1 0.3984022677490014, AUC 0.7370033670033669
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7534343434343435
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6190476190476191, precision 0.7094290452499408, recall 0.44841269841269843, F1 0.4357506043177461, AUC 0.7034587497550461
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7108134920634921
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 6 idx: 0 First Loss : 2.600606679916382, Second Loss : 2.546370029449463
epoch: 6 idx: 200 First Loss : 1.0178577263668105, Second Loss : 1.0123439609114804
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6944444444444444, precision 0.6615036231884058, recall 0.621010101010101, F1 0.6257068281020377, AUC 0.7338496071829406
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6190476190476191, precision 0.5829559967491001, recall 0.5860523221634333, F1 0.5813165266106443, AUC 0.6993496472663138
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7019951499118166
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 7 idx: 0 First Loss : 2.7518470287323, Second Loss : 2.6986169815063477
epoch: 7 idx: 200 First Loss : 0.9956819195652482, Second Loss : 0.9923582668068693
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5833333333333334, precision 0.5409090909090909, recall 0.5431649831649832, F1 0.5374310480693459, AUC 0.7272446689113355
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7486868686868687
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5306122448979592, precision 0.4882255389718076, recall 0.5210905349794238, F1 0.486860378164726, AUC 0.7028586125808349
  Second-Tier acc 0.6326530612244898, precision 0.6238095238095238, recall 0.6261022927689593, F1 0.6084318360914106, AUC 0.7270723104056437
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4581099300887566e-05
epoch: 8 idx: 0 First Loss : 2.907694101333618, Second Loss : 2.8640334606170654
epoch: 8 idx: 200 First Loss : 0.9771310389041901, Second Loss : 0.9751172260154243
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5, precision 0.48244897959183675, recall 0.48478114478114476, F1 0.4536592020483976, AUC 0.7292536475869809
  Second-Tier acc 0.5625, precision 0.5912698412698413, recall 0.601919191919192, F1 0.5471195471195471, AUC 0.7685353535353535
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.44225169466548775, recall 0.4857436801881246, F1 0.4220302140821804, AUC 0.7108931020968058
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7408509700176366
Test AUC: 0.7409, Test F1: 0.6002 (Best Epoch: 8)
Current LR: 1.4581099300887566e-05
epoch: 9 idx: 0 First Loss : 3.048454999923706, Second Loss : 3.018319845199585
epoch: 9 idx: 200 First Loss : 0.9623369508010534, Second Loss : 0.9619714943182409
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4652777777777778, precision 0.49404761904761907, recall 0.48181818181818187, F1 0.4287181918760867, AUC 0.7302076318742984
  Second-Tier acc 0.5416666666666666, precision 0.6055555555555555, recall 0.6174747474747475, F1 0.5413919413919414, AUC 0.7862626262626261
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.4652335968125441, recall 0.49676660787771904, F1 0.4112884160756501, AUC 0.7176966980207721
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7637235449735448
Test AUC: 0.7637, Test F1: 0.5624 (Best Epoch: 9)
Current LR: 1.4581099300887566e-05
epoch: 10 idx: 0 First Loss : 3.168736696243286, Second Loss : 3.1553499698638916
epoch: 10 idx: 200 First Loss : 0.9506274564794047, Second Loss : 0.9519825310386087
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4375, precision 0.49320478049652783, recall 0.46885521885521886, F1 0.4046857887874837, AUC 0.734949494949495
  Second-Tier acc 0.5416666666666666, precision 0.6046741929094871, recall 0.6319191919191919, F1 0.5427909930952527, AUC 0.8036363636363637
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.47464498971348285, recall 0.5062463256907701, F1 0.4097619956726486, AUC 0.7220140113658632
  Second-Tier acc 0.5102040816326531, precision 0.5389499389499389, recall 0.605599647266314, F1 0.5219461697722567, AUC 0.7665343915343916
Test AUC: 0.7665, Test F1: 0.5219 (Best Epoch: 10)
Current LR: 1.4581099300887566e-05
epoch: 11 idx: 0 First Loss : 3.2663443088531494, Second Loss : 3.2672462463378906
epoch: 11 idx: 200 First Loss : 0.9421897366207408, Second Loss : 0.9447864817724151
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.4678591954022988, recall 0.4418181818181819, F1 0.374396497811132, AUC 0.7373176206509541
  Second-Tier acc 0.5, precision 0.5761784511784512, recall 0.5882828282828282, F1 0.501010101010101, AUC 0.8083333333333332
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.49429371231696817, recall 0.5239564961787183, F1 0.41993030250448266, AUC 0.7240532529884383
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7743606701940036
Test AUC: 0.7744, Test F1: 0.5128 (Best Epoch: 11)
Current LR: 1.4581099300887566e-05
epoch: 12 idx: 0 First Loss : 3.347538709640503, Second Loss : 3.3622922897338867
epoch: 12 idx: 200 First Loss : 0.9355706465268387, Second Loss : 0.9398054483888755
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.4956159367924074, recall 0.4632323232323232, F1 0.39111154387630487, AUC 0.7382940516273849
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8161111111111111
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4013605442176871, precision 0.493007293007293, recall 0.4939006466784244, F1 0.3938325725734773, AUC 0.730391436409955
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7771715167548501
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 13 idx: 0 First Loss : 3.409123659133911, Second Loss : 3.4383654594421387
epoch: 13 idx: 200 First Loss : 0.9300794837213311, Second Loss : 0.9357171184360166
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.4884852693983956, recall 0.45999999999999996, F1 0.3793201819734986, AUC 0.7423400673400673
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8156060606060606
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.526574569221628, recall 0.5152851263962375, F1 0.4146706224698156, AUC 0.733655447775818
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7854387125220458
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 14 idx: 0 First Loss : 3.4447715282440186, Second Loss : 3.5038256645202637
epoch: 14 idx: 200 First Loss : 0.9255904888673987, Second Loss : 0.9323607996866032
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.5046296296296297, recall 0.4867003367003367, F1 0.4014817561350747, AUC 0.7478170594837262
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.816060606060606
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5416666666666666, recall 0.5390946502057613, F1 0.4380952380952381, AUC 0.736582647462277
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.79320987654321
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 15 idx: 0 First Loss : 3.473006010055542, Second Loss : 3.550025701522827
epoch: 15 idx: 200 First Loss : 0.9209239599827806, Second Loss : 0.928861895763774
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.5109516028633675, recall 0.49572390572390573, F1 0.40725648838602674, AUC 0.749371492704826
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8114646464646466
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5654761904761906, recall 0.548721340388007, F1 0.4443977591036415, AUC 0.7419838820301784
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7940917107583774
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 16 idx: 0 First Loss : 3.4848060607910156, Second Loss : 3.5763657093048096
epoch: 16 idx: 200 First Loss : 0.9164054472583221, Second Loss : 0.9251983887817136
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4166666666666667, precision 0.5179461615154536, recall 0.5066666666666667, F1 0.415084849446043, AUC 0.7492760942760942
  Second-Tier acc 0.4166666666666667, precision 0.5181623931623932, recall 0.5060606060606061, F1 0.41254618673973514, AUC 0.8073232323232323
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4557823129251701, precision 0.5789563148053715, recall 0.5684156378600823, F1 0.45743490605218157, AUC 0.7463256907701353
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7895723104056437
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 17 idx: 0 First Loss : 3.48105525970459, Second Loss : 3.5865418910980225
epoch: 17 idx: 200 First Loss : 0.9118811828223293, Second Loss : 0.9217413843120564
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4166666666666667, precision 0.5202362996480643, recall 0.5091919191919192, F1 0.41486117210754897, AUC 0.7504433221099888
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.8014646464646464
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4557823129251701, precision 0.5815384615384614, recall 0.5662845385067607, F1 0.4554954954954955, AUC 0.7533191260043113
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7959656084656084
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 18 idx: 0 First Loss : 3.4719908237457275, Second Loss : 3.588426113128662
epoch: 18 idx: 200 First Loss : 0.907611929980658, Second Loss : 0.9184384996184978
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4097222222222222, precision 0.5132251227130745, recall 0.5081144781144782, F1 0.4018224573780129, AUC 0.748989898989899
  Second-Tier acc 0.3958333333333333, precision 0.4869664385793418, recall 0.48333333333333334, F1 0.3690865780627352, AUC 0.7964141414141414
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4557823129251701, precision 0.5882661079099004, recall 0.5701058201058201, F1 0.457974025974026, AUC 0.7595470801489319
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.796792328042328
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4581099300887566e-05
epoch: 19 idx: 0 First Loss : 3.45761775970459, Second Loss : 3.582751750946045
epoch: 19 idx: 200 First Loss : 0.9037977688799876, Second Loss : 0.9156527125093604
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3888888888888889, precision 0.4918307690300017, recall 0.49164983164983167, F1 0.37300803206126476, AUC 0.7467957351290684
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.794949494949495
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4489795918367347, precision 0.5813953488372093, recall 0.5502645502645502, F1 0.44708276797829033, AUC 0.7652912502449539
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.798666225749559
Test AUC: 0.7772, Test F1: 0.5120 (Best Epoch: 12)