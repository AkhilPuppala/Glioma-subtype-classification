{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_46", "train_show_freq": 200, "droprate": 0.4065092094295395, "droprate_2": 0.0, "lr": 1.728051155212175e-05, "weight_decay": 1.975453851212204e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_46", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.728051155212175e-05
epoch: 0 idx: 0 First Loss : 1.2625489234924316, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0820633749760205, Second Loss : 1.0664883442779085
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6895061728395061
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7507575757575756
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6297643543013914
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6283619929453262
Test AUC: 0.6284, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.728051155212175e-05
epoch: 1 idx: 0 First Loss : 2.1368682384490967, Second Loss : 2.043487310409546
epoch: 1 idx: 200 First Loss : 1.1018943143128164, Second Loss : 1.0954651813305432
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7227272727272727
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7562626262626263
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6799860376249266
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932319223985891
Test AUC: 0.6932, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.728051155212175e-05
epoch: 2 idx: 0 First Loss : 2.20306134223938, Second Loss : 2.137552261352539
epoch: 2 idx: 200 First Loss : 1.080514594393583, Second Loss : 1.0753464778116093
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7377104377104376
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7652525252525253
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7035138643934941
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7060185185185185
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.728051155212175e-05
epoch: 3 idx: 0 First Loss : 2.301002264022827, Second Loss : 2.2425801753997803
epoch: 3 idx: 200 First Loss : 1.0632574926709655, Second Loss : 1.0592287372223181
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7388720538720538
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7117381932196748
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.708664021164021
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.728051155212175e-05
epoch: 4 idx: 0 First Loss : 2.405074119567871, Second Loss : 2.352491855621338
epoch: 4 idx: 200 First Loss : 1.040417707715165, Second Loss : 1.0389023364628132
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5625, precision 0.4447229184071289, recall 0.39959595959595956, F1 0.34829059829059833, AUC 0.7347923681257015
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7514141414141413
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7068819811875368
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7113646384479718
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.728051155212175e-05
epoch: 5 idx: 0 First Loss : 2.565199851989746, Second Loss : 2.5015478134155273
epoch: 5 idx: 200 First Loss : 1.0171004499294864, Second Loss : 1.0172146866422387
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6597222222222222, precision 0.6252249212775528, recall 0.5495622895622896, F1 0.558483657180119, AUC 0.7332659932659933
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7533838383838383
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6258503401360545, precision 0.5946608946608946, recall 0.5536449147560258, F1 0.554153031011376, AUC 0.7000538898687046
  Second-Tier acc 0.5918367346938775, precision 0.5383064516129031, recall 0.46759259259259256, F1 0.4636015325670498, AUC 0.7023258377425045
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.728051155212175e-05
epoch: 6 idx: 0 First Loss : 2.73645281791687, Second Loss : 2.678398847579956
epoch: 6 idx: 200 First Loss : 0.9923259814209606, Second Loss : 0.9957316343241663
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5763888888888888, precision 0.5310924369747899, recall 0.5257239057239057, F1 0.5147075147075147, AUC 0.7284343434343433
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5306122448979592, precision 0.48040503557744935, recall 0.519400352733686, F1 0.4766000960385812, AUC 0.7040160199882423
  Second-Tier acc 0.6530612244897959, precision 0.6456349206349207, recall 0.6677689594356261, F1 0.6462418300653595, AUC 0.7168209876543209
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.728051155212175e-05
epoch: 7 idx: 0 First Loss : 2.927438974380493, Second Loss : 2.8764901161193848
epoch: 7 idx: 200 First Loss : 0.9680601644297293, Second Loss : 0.9759038069948035
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5069444444444444, precision 0.4961988304093567, recall 0.48838383838383836, F1 0.4524789915966387, AUC 0.7311672278338945
  Second-Tier acc 0.6041666666666666, precision 0.6239316239316239, recall 0.6574747474747475, F1 0.6001282051282052, AUC 0.7672222222222222
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.45066413662239085, recall 0.5097001763668431, F1 0.43095582508067204, AUC 0.7116830785812267
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7403549382716049
Test AUC: 0.7404, Test F1: 0.6002 (Best Epoch: 7)
Current LR: 1.728051155212175e-05
epoch: 8 idx: 0 First Loss : 3.0947320461273193, Second Loss : 3.0590109825134277
epoch: 8 idx: 200 First Loss : 0.9495641043993519, Second Loss : 0.9610805991962923
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4583333333333333, precision 0.4893701070171659, recall 0.4708754208754209, F1 0.40957650563949777, AUC 0.7317957351290684
  Second-Tier acc 0.5208333333333334, precision 0.5796296296296296, recall 0.5821212121212122, F1 0.5198481116584565, AUC 0.785050505050505
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4421768707482993, precision 0.4823931623931624, recall 0.5245443856554967, F1 0.4237037037037037, AUC 0.7187561238487165
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7631172839506174
Test AUC: 0.7631, Test F1: 0.5455 (Best Epoch: 8)
Current LR: 1.728051155212175e-05
epoch: 9 idx: 0 First Loss : 3.235386610031128, Second Loss : 3.2108006477355957
epoch: 9 idx: 200 First Loss : 0.9364578385804943, Second Loss : 0.9504932154488949
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4375, precision 0.4929607532499635, recall 0.468013468013468, F1 0.398358359986267, AUC 0.7350056116722783
  Second-Tier acc 0.5, precision 0.5687830687830687, recall 0.5687878787878787, F1 0.49960046714610606, AUC 0.7993434343434344
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.4761904761904761, recall 0.5121987066431511, F1 0.4071192833569071, AUC 0.7258291691162061
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7679122574955909
Test AUC: 0.7679, Test F1: 0.5178 (Best Epoch: 9)
Current LR: 1.728051155212175e-05
epoch: 10 idx: 0 First Loss : 3.3429911136627197, Second Loss : 3.3351056575775146
epoch: 10 idx: 200 First Loss : 0.9270393555307418, Second Loss : 0.9431070130809549
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4027777777777778, precision 0.468034188034188, recall 0.440976430976431, F1 0.36800332851574474, AUC 0.741010101010101
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.8079292929292928
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.41496598639455784, precision 0.49523809523809526, recall 0.5119047619047619, F1 0.40493765922406344, AUC 0.7302015970997453
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7752976190476191
Test AUC: 0.7753, Test F1: 0.5128 (Best Epoch: 10)
Current LR: 1.728051155212175e-05
epoch: 11 idx: 0 First Loss : 3.429415702819824, Second Loss : 3.4415156841278076
epoch: 11 idx: 200 First Loss : 0.9205840436060593, Second Loss : 0.9381216622342295
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.4874911909795631, recall 0.4531313131313131, F1 0.3814751404085011, AUC 0.7453535353535353
  Second-Tier acc 0.4583333333333333, precision 0.546031746031746, recall 0.5446464646464646, F1 0.4583333333333333, AUC 0.8112121212121212
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.5214903938308194, recall 0.5135949441504998, F1 0.41097993329433, AUC 0.7354742308446012
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7851631393298059
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 12 idx: 0 First Loss : 3.496680498123169, Second Loss : 3.529097318649292
epoch: 12 idx: 200 First Loss : 0.9149911624764032, Second Loss : 0.9343118122917836
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4027777777777778, precision 0.4956762297121135, recall 0.47010101010101013, F1 0.3882298606234302, AUC 0.7491414141414142
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.807878787878788
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.5314765300059417, recall 0.5291740152851264, F1 0.42191699928140985, AUC 0.7404284244562023
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.790950176366843
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 13 idx: 0 First Loss : 3.5316531658172607, Second Loss : 3.5869081020355225
epoch: 13 idx: 200 First Loss : 0.9093085370879083, Second Loss : 0.9301569870839924
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4027777777777778, precision 0.4981519981519982, recall 0.47659932659932663, F1 0.3930883790466333, AUC 0.7486644219977553
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8051010101010102
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.557347670250896, recall 0.5488683127572016, F1 0.4379297468517422, AUC 0.7460378698804625
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.796957671957672
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 14 idx: 0 First Loss : 3.54986572265625, Second Loss : 3.622676134109497
epoch: 14 idx: 200 First Loss : 0.9038467999531503, Second Loss : 0.9263505791823625
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4166666666666667, precision 0.515370018975332, recall 0.504983164983165, F1 0.41341731427147294, AUC 0.7486812570145904
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8040909090909091
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5533167495854062, recall 0.5287330981775425, F1 0.4234796349884005, AUC 0.751512590632961
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7977843915343915
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 15 idx: 0 First Loss : 3.5453758239746094, Second Loss : 3.635593891143799
epoch: 15 idx: 200 First Loss : 0.8984437295645753, Second Loss : 0.9226602818341972
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4027777777777778, precision 0.506454248366013, recall 0.4929629629629629, F1 0.4001748389124627, AUC 0.7499102132435466
  Second-Tier acc 0.4166666666666667, precision 0.5181623931623932, recall 0.5060606060606061, F1 0.41254618673973514, AUC 0.7977272727272728
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46258503401360546, precision 0.584017094017094, recall 0.5763521457965902, F1 0.4639220332289639, AUC 0.7573118753674309
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7993827160493826
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 16 idx: 0 First Loss : 3.518961191177368, Second Loss : 3.637460470199585
epoch: 16 idx: 200 First Loss : 0.8935901545178127, Second Loss : 0.9194248746790974
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4027777777777778, precision 0.5086875843454791, recall 0.4954882154882155, F1 0.3996584455300052, AUC 0.7496015712682379
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.7956565656565657
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5885649242623238, recall 0.5742210464432687, F1 0.4637024313905111, AUC 0.7616781795022535
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.8024691358024691
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 17 idx: 0 First Loss : 3.491748571395874, Second Loss : 3.6289281845092773
epoch: 17 idx: 200 First Loss : 0.8892725601066043, Second Loss : 0.9169306743841396
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.5047909407665505, recall 0.5084848484848484, F1 0.3933700886314467, AUC 0.7446240179573512
  Second-Tier acc 0.375, precision 0.47222222222222227, recall 0.45303030303030306, F1 0.3534618410700236, AUC 0.7941919191919192
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46258503401360546, precision 0.5928497942386831, recall 0.583994708994709, F1 0.4651597273548493, AUC 0.7640542328042329
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.8056106701940036
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 18 idx: 0 First Loss : 3.454383134841919, Second Loss : 3.603355884552002
epoch: 18 idx: 200 First Loss : 0.8850612793417777, Second Loss : 0.9145273268651403
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3958333333333333, precision 0.5001725327812284, recall 0.49922558922558924, F1 0.3858505511013047, AUC 0.7388664421997756
  Second-Tier acc 0.3958333333333333, precision 0.4869664385793418, recall 0.48333333333333334, F1 0.3690865780627352, AUC 0.7825252525252525
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46258503401360546, precision 0.5925925925925926, recall 0.5759112286890065, F1 0.4583751565215839, AUC 0.7658730158730158
  Second-Tier acc 0.4897959183673469, precision 0.5952380952380952, recall 0.5804673721340388, F1 0.4792462439521263, AUC 0.8086419753086419
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.728051155212175e-05
epoch: 19 idx: 0 First Loss : 3.4184768199920654, Second Loss : 3.578274726867676
epoch: 19 idx: 200 First Loss : 0.881219393508254, Second Loss : 0.9130082127860567
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3958333333333333, precision 0.5025252525252525, recall 0.50006734006734, F1 0.38443839669580226, AUC 0.7323400673400674
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7654040404040404
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4557823129251701, precision 0.5863284002818886, recall 0.5620223398001176, F1 0.44959233693477385, AUC 0.7665037722908092
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.8093584656084656
Test AUC: 0.7852, Test F1: 0.4919 (Best Epoch: 11)