{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.42126664564118277, "droprate_2": 0.0, "lr": 1.660873327053423e-05, "weight_decay": 1.7272454448731074e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.660873327053423e-05
epoch: 0 idx: 0 First Loss : 0.9812026023864746, Second Loss : 1.0700716972351074
epoch: 0 idx: 200 First Loss : 1.06906040598504, Second Loss : 1.066370906076621
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5305176767676768
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47611111111111115
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43226410934744264
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4300595238095239
 
 test auc: 0.4300595238095239, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.2594489148179329, "droprate_2": 0.0, "lr": 0.00016437972288535485, "weight_decay": 0.00012618485025467024, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00016437972288535485
epoch: 0 idx: 0 First Loss : 1.1579384803771973, Second Loss : 1.1625289916992188
epoch: 0 idx: 200 First Loss : 1.079889567337226, Second Loss : 1.083725894379675
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49056677890011224
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.46919191919191916
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4416825886733293
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4547508818342152
 
 test auc: 0.4547508818342152, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00016437972288535485
epoch: 1 idx: 0 First Loss : 1.761733889579773, Second Loss : 2.0042202472686768
epoch: 1 idx: 200 First Loss : 0.9724853962882242, Second Loss : 0.9897443732960307
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.3125, precision 0.4222222222222222, recall 0.42424242424242425, F1 0.2832080200501253, AUC 0.49293490460157124
  Second-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.4852020202020202
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09655172413793105, recall 0.3333333333333333, F1 0.14973262032085563, AUC 0.4596070938663532
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4624669312169312
 
 test auc: 0.4624669312169312, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00016437972288535485
epoch: 2 idx: 0 First Loss : 2.3904545307159424, Second Loss : 2.622051954269409
epoch: 2 idx: 200 First Loss : 0.9317729689032581, Second Loss : 0.9511880664646033
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.3194444444444444, precision 0.3408129491720822, recall 0.407003367003367, F1 0.30581782748183145, AUC 0.48953984287317626
  Second-Tier acc 0.22916666666666666, precision 0.23959494611668528, recall 0.30626262626262624, F1 0.2608751608751609, AUC 0.473989898989899
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3673469387755102, precision 0.3941400304414003, recall 0.3641240446796002, F1 0.37635281385281383, AUC 0.5066260043111895
  Second-Tier acc 0.3673469387755102, precision 0.3994708994708995, recall 0.40321869488536155, F1 0.3904761904761905, AUC 0.4963073192239859
 
 test auc: 0.4624669312169312, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00016437972288535485
epoch: 3 idx: 0 First Loss : 3.035668134689331, Second Loss : 3.253636598587036
epoch: 3 idx: 200 First Loss : 0.9167381981897413, Second Loss : 0.9282169155220488
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2638888888888889, precision 0.26918393929097295, recall 0.36350168350168355, F1 0.21196433397349737, AUC 0.4961223344556678
  Second-Tier acc 0.2916666666666667, precision 0.2714285714285714, recall 0.3513131313131313, F1 0.28888888888888886, AUC 0.48939393939393944
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3673469387755102, precision 0.25864197530864197, recall 0.253233392122281, F1 0.2410213243546577, AUC 0.5133806094454242
  Second-Tier acc 0.40816326530612246, precision 0.3951159951159951, recall 0.45723104056437386, F1 0.41221948549534754, AUC 0.5164792768959435
 
 test auc: 0.5164792768959435, test F1: 0.41221948549534754  :  from epoch 3
 current learn rate 0.00016437972288535485
epoch: 4 idx: 0 First Loss : 3.5189921855926514, Second Loss : 3.666288137435913
epoch: 4 idx: 200 First Loss : 0.9093031838341658, Second Loss : 0.9240434036233384
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2708333333333333, precision 0.48773448773448774, recall 0.37925925925925924, F1 0.20695678590415434, AUC 0.5243883277216611
  Second-Tier acc 0.2916666666666667, precision 0.5038986354775828, recall 0.40222222222222226, F1 0.23879295307866735, AUC 0.505909090909091
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3673469387755102, precision 0.15126050420168066, recall 0.2222222222222222, F1 0.18000000000000002, AUC 0.5153157456398197
  Second-Tier acc 0.2857142857142857, precision 0.13333333333333333, recall 0.1728395061728395, F1 0.15053763440860216, AUC 0.5216049382716049
 
 test auc: 0.5216049382716049, test F1: 0.15053763440860216  :  from epoch 4
 current learn rate 0.00016437972288535485
epoch: 5 idx: 0 First Loss : 3.7105071544647217, Second Loss : 3.7325029373168945
epoch: 5 idx: 200 First Loss : 0.9080935372972156, Second Loss : 0.91825084529692
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2569444444444444, precision 0.4768888888888889, recall 0.3655555555555556, F1 0.18504947319071233, AUC 0.5717283950617283
  Second-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.607929292929293
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3877551020408163, precision 0.1557377049180328, recall 0.23456790123456792, F1 0.18719211822660098, AUC 0.4946722516166961
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.4598765432098766
 
 test auc: 0.4598765432098766, test F1: 0.1791044776119403  :  from epoch 5
 current learn rate 0.00016437972288535485
epoch: 6 idx: 0 First Loss : 3.7161245346069336, Second Loss : 3.7457947731018066
epoch: 6 idx: 200 First Loss : 0.9029111102193279, Second Loss : 0.9139176447144872
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2777777777777778, precision 0.4845430107526882, recall 0.37888888888888883, F1 0.2123442012581737, AUC 0.6542255892255893
  Second-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.6487373737373737
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.461615716245346
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4347993827160494
 
 test auc: 0.4347993827160494, test F1: 0.18627450980392157  :  from epoch 6
 current learn rate 0.00016437972288535485
epoch: 7 idx: 0 First Loss : 3.696333885192871, Second Loss : 3.809403896331787
epoch: 7 idx: 200 First Loss : 0.8983459661958568, Second Loss : 0.9081943423014635
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3263888888888889, precision 0.4749156072685485, recall 0.41, F1 0.26984435637533905, AUC 0.645117845117845
  Second-Tier acc 0.3125, precision 0.4829059829059829, recall 0.40111111111111114, F1 0.2551322751322751, AUC 0.6414646464646465
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.18266581902945536, recall 0.24845679012345678, F1 0.20613682989920612, AUC 0.45053767391730354
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4305555555555555
 
 test auc: 0.4347993827160494, test F1: 0.18627450980392157  :  from epoch 6
 current learn rate 0.00016437972288535485
epoch: 8 idx: 0 First Loss : 3.7292697429656982, Second Loss : 3.68415904045105
epoch: 8 idx: 200 First Loss : 0.8998986672731962, Second Loss : 0.9016928861247241
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3125, precision 0.45572033898305087, recall 0.40111111111111114, F1 0.25474513799406673, AUC 0.6569977553310887
  Second-Tier acc 0.3125, precision 0.4829059829059829, recall 0.40111111111111114, F1 0.2551322751322751, AUC 0.6625252525252525
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.18748460211874848, recall 0.2525720164609053, F1 0.20859010270774977, AUC 0.43077601410934746
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.42757936507936506
 
 test auc: 0.42757936507936506, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00016437972288535485
epoch: 9 idx: 0 First Loss : 3.676851987838745, Second Loss : 3.5141761302948
epoch: 9 idx: 200 First Loss : 0.8935611342047793, Second Loss : 0.8951043458380366
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3194444444444444, precision 0.4668958492487904, recall 0.4055555555555555, F1 0.2622562219502244, AUC 0.6536700336700337
  Second-Tier acc 0.3541666666666667, precision 0.5106837606837606, recall 0.42777777777777776, F1 0.29944444444444446, AUC 0.6601515151515152
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3945578231292517, precision 0.18266581902945536, recall 0.24845679012345678, F1 0.20613682989920612, AUC 0.4295512443660592
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.41903659611992944
 
 test auc: 0.42757936507936506, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00016437972288535485
epoch: 10 idx: 0 First Loss : 3.6486666202545166, Second Loss : 3.5201423168182373
epoch: 10 idx: 200 First Loss : 0.8908673428146421, Second Loss : 0.8931578225272289
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2986111111111111, precision 0.41130312765407484, recall 0.3922222222222222, F1 0.2389867688505699, AUC 0.6529854096520763
  Second-Tier acc 0.375, precision 0.5131578947368421, recall 0.44111111111111106, F1 0.320358788676761, AUC 0.6633333333333334
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.1718304843304843, recall 0.23199588477366254, F1 0.19511784511784513, AUC 0.42227611209092686
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.4048721340388007
 
 test auc: 0.4048721340388007, test F1: 0.1791044776119403  :  from epoch 10
 current learn rate 0.00016437972288535485
epoch: 11 idx: 0 First Loss : 3.4668471813201904, Second Loss : 3.413022756576538
epoch: 11 idx: 200 First Loss : 0.8786728752483626, Second Loss : 0.8842882788011779
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.375, precision 0.4681467181467181, recall 0.44111111111111106, F1 0.3194444444444444, AUC 0.6478395061728395
  Second-Tier acc 0.3958333333333333, precision 0.5409356725146198, recall 0.45444444444444443, F1 0.339937641723356, AUC 0.6594949494949495
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.36054421768707484, precision 0.18997668997668996, recall 0.24742798353909465, F1 0.21452006980802793, AUC 0.4258218204977464
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.40084876543209874
 
 test auc: 0.4048721340388007, test F1: 0.1791044776119403  :  from epoch 10
 current learn rate 0.00016437972288535485
epoch: 12 idx: 0 First Loss : 3.489680051803589, Second Loss : 3.4747769832611084
epoch: 12 idx: 200 First Loss : 0.8752222710356535, Second Loss : 0.8841770139910322
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4375, precision 0.4911764705882353, recall 0.48111111111111104, F1 0.37605820105820104, AUC 0.6470314253647588
  Second-Tier acc 0.3333333333333333, precision 0.494017094017094, recall 0.4144444444444444, F1 0.27783637592968224, AUC 0.661969696969697
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.1866100895803866, recall 0.24074074074074073, F1 0.21003290494815918, AUC 0.4273037918871252
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.40663580246913583
 
 test auc: 0.4048721340388007, test F1: 0.1791044776119403  :  from epoch 10
 current learn rate 0.00016437972288535485
epoch: 13 idx: 0 First Loss : 3.585023880004883, Second Loss : 3.4916317462921143
epoch: 13 idx: 200 First Loss : 0.8703019250955983, Second Loss : 0.8708195621266122
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4027777777777778, precision 0.49074074074074076, recall 0.4588888888888889, F1 0.34584318360914107, AUC 0.6469977553310887
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6608080808080808
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.20052424639580604, recall 0.2613168724279835, F1 0.22672064777327935, AUC 0.4212962962962963
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4115961199294533
 
 test auc: 0.4048721340388007, test F1: 0.1791044776119403  :  from epoch 10
 current learn rate 0.00016437972288535485
epoch: 14 idx: 0 First Loss : 3.5136187076568604, Second Loss : 3.5177040100097656
epoch: 14 idx: 200 First Loss : 0.862914087147445, Second Loss : 0.8686043530507045
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.46162726772952173, recall 0.44111111111111106, F1 0.3211944956731451, AUC 0.6465937149270483
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6636868686868687
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3673469387755102, precision 0.2019400352733686, recall 0.2613168724279835, F1 0.22764889431556098, AUC 0.4224598275524201
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.40365961199294537
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14
 current learn rate 0.00016437972288535485
epoch: 15 idx: 0 First Loss : 3.5161256790161133, Second Loss : 3.423917531967163
epoch: 15 idx: 200 First Loss : 0.8612983135088379, Second Loss : 0.8639359052524639
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3541666666666667, precision 0.4507918552036199, recall 0.43259259259259264, F1 0.30853781821523757, AUC 0.6432659932659933
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6553030303030303
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.23899814676513706, recall 0.2569077013521458, F1 0.24358584013315474, AUC 0.4280692729766804
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.40514770723104054
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14
 current learn rate 0.00016437972288535485
epoch: 16 idx: 0 First Loss : 3.6380326747894287, Second Loss : 3.447021007537842
epoch: 16 idx: 200 First Loss : 0.8626139429909551, Second Loss : 0.8618798036476352
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.44722222222222224, recall 0.42333333333333334, F1 0.2934472934472934, AUC 0.6537261503928171
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6512626262626262
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3673469387755102, precision 0.1853801169590643, recall 0.2417695473251029, F1 0.2080808080808081, AUC 0.4169422398589065
  Second-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.42124118165784835
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14
 current learn rate 0.00016437972288535485
epoch: 17 idx: 0 First Loss : 3.727862596511841, Second Loss : 3.547722101211548
epoch: 17 idx: 200 First Loss : 0.8643168754635681, Second Loss : 0.862006845938174
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2569444444444444, precision 0.14577030812324931, recall 0.3703703703703704, F1 0.1884526890997987, AUC 0.6529236812570146
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6457575757575758
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.1793963254593176, recall 0.2630805408583186, F1 0.2094706368899917, AUC 0.4159930433078581
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42515432098765427
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14
 current learn rate 0.00016437972288535485
epoch: 18 idx: 0 First Loss : 3.9667251110076904, Second Loss : 3.6960525512695312
epoch: 18 idx: 200 First Loss : 0.8655125906416922, Second Loss : 0.8609654036439027
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.25, precision 0.1484375, recall 0.3611111111111111, F1 0.17510750119445773, AUC 0.6536307519640853
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6365656565656567
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4421768707482993, precision 0.16539440203562342, recall 0.2674897119341564, F1 0.20440251572327042, AUC 0.41745664315108755
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.42344576719576715
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14
 current learn rate 0.00016437972288535485
epoch: 19 idx: 0 First Loss : 3.8067665100097656, Second Loss : 3.768571138381958
epoch: 19 idx: 200 First Loss : 0.861933543878121, Second Loss : 0.8539584338086389
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3680555555555556, precision 0.4585405207187385, recall 0.44148148148148153, F1 0.32259029197393957, AUC 0.6524915824915825
  Second-Tier acc 0.4791666666666667, precision 0.4905017921146953, recall 0.5077777777777778, F1 0.41201705907588265, AUC 0.6328787878787878
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.21904275251234884, recall 0.24485596707818927, F1 0.22868217054263565, AUC 0.42907358416617675
  Second-Tier acc 0.3469387755102041, precision 0.21303763440860216, recall 0.2978395061728395, F1 0.24425287356321843, AUC 0.4443342151675485
 
 test auc: 0.40365961199294537, test F1: 0.21296296296296294  :  from epoch 14{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.3549533838787273, "droprate_2": 0.0, "lr": 9.92981885530929e-05, "weight_decay": 0.0001975643264416021, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 9.92981885530929e-05
epoch: 0 idx: 0 First Loss : 1.2279378175735474, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1143819606719325, Second Loss : 1.1073405336014075
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7398484848484849
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.757020202020202
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7066615226337448
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7046406525573191
Test AUC: 0.7046, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.92981885530929e-05
epoch: 1 idx: 0 First Loss : 2.0228512287139893, Second Loss : 2.0031487941741943
epoch: 1 idx: 200 First Loss : 1.004452277178788, Second Loss : 1.0134883983366525
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7362065095398428
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7511111111111112
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7187989907897316
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7157186948853616
Test AUC: 0.7046, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.92981885530929e-05
epoch: 2 idx: 0 First Loss : 2.4728498458862305, Second Loss : 2.240346908569336
epoch: 2 idx: 200 First Loss : 0.9543352669744349, Second Loss : 0.9676265881874075
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5763888888888888, precision 0.5182539682539682, recall 0.5186195286195286, F1 0.5171812314669457, AUC 0.7261560044893378
  Second-Tier acc 0.6458333333333334, precision 0.41798941798941797, recall 0.583030303030303, F1 0.4775641025641026, AUC 0.7334848484848484
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.502992277992278, recall 0.5372574955908289, F1 0.50799784139492, AUC 0.7085660395845581
  Second-Tier acc 0.5918367346938775, precision 0.5615079365079365, recall 0.531305114638448, F1 0.5238095238095238, AUC 0.7162147266313933
Test AUC: 0.7046, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.92981885530929e-05
epoch: 3 idx: 0 First Loss : 3.0996487140655518, Second Loss : 3.054654359817505
epoch: 3 idx: 200 First Loss : 0.9247943561394416, Second Loss : 0.9411962195230064
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4652777777777778, precision 0.5449974861739567, recall 0.49925925925925924, F1 0.4663649078112111, AUC 0.7068855218855218
  Second-Tier acc 0.4375, precision 0.3796296296296296, recall 0.4666666666666666, F1 0.3362085489745064, AUC 0.7405050505050506
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.48299319727891155, precision 0.5423009216112665, recall 0.5321869488536155, F1 0.4919336177691805, AUC 0.7093070252792475
  Second-Tier acc 0.4897959183673469, precision 0.3854166666666667, recall 0.42239858906525574, F1 0.3609706774519717, AUC 0.7524801587301587
Test AUC: 0.7046, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.92981885530929e-05
epoch: 4 idx: 0 First Loss : 3.7681667804718018, Second Loss : 3.7898950576782227
epoch: 4 idx: 200 First Loss : 0.9168617438608363, Second Loss : 0.9403838637558308
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4166666666666667, precision 0.5025252525252525, recall 0.46393939393939393, F1 0.41878354502116877, AUC 0.7020987654320988
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7419696969696971
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.5126923076923077, recall 0.5180041152263374, F1 0.44918601506145955, AUC 0.7185601606897905
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.7590939153439153
Test AUC: 0.7046, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.92981885530929e-05
epoch: 5 idx: 0 First Loss : 3.925387144088745, Second Loss : 4.083657741546631
epoch: 5 idx: 200 First Loss : 0.9062770895361066, Second Loss : 0.939267895353578
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.4782766439909298, recall 0.42151515151515145, F1 0.3487317329217592, AUC 0.719652076318743
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7758585858585859
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.47619047619047616, precision 0.5821428571428572, recall 0.5412257495590828, F1 0.4685043769789532, AUC 0.7325960219478738
  Second-Tier acc 0.4897959183673469, precision 0.4594594594594595, recall 0.4567901234567901, F1 0.3631867161278926, AUC 0.7781635802469137
Test AUC: 0.7782, Test F1: 0.3632 (Best Epoch: 5)
Current LR: 9.92981885530929e-05
epoch: 6 idx: 0 First Loss : 3.949266195297241, Second Loss : 4.141149520874023
epoch: 6 idx: 200 First Loss : 0.8988985929189861, Second Loss : 0.9364959298313331
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3611111111111111, precision 0.4612790910756826, recall 0.43053872053872055, F1 0.32279283113443985, AUC 0.7353759820426488
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7841414141414141
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.5758657150409728, recall 0.517416225749559, F1 0.44983898595409383, AUC 0.7296320791691162
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.784997795414462
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 7 idx: 0 First Loss : 4.018805027008057, Second Loss : 4.15520715713501
epoch: 7 idx: 200 First Loss : 0.8969889045872527, Second Loss : 0.9308229635692021
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3402777777777778, precision 0.4264912280701754, recall 0.4058922558922559, F1 0.3063911959878769, AUC 0.728591470258137
  Second-Tier acc 0.3541666666666667, precision 0.48454469507101083, recall 0.41080808080808073, F1 0.3054988662131519, AUC 0.7707070707070708
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.553236348302762, recall 0.49103468547912993, F1 0.41485696462366545, AUC 0.7141938565549676
  Second-Tier acc 0.42857142857142855, precision 0.5307017543859649, recall 0.43761022927689597, F1 0.35947712418300654, AUC 0.7709986772486772
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 8 idx: 0 First Loss : 3.8395211696624756, Second Loss : 4.046562194824219
epoch: 8 idx: 200 First Loss : 0.8936244126635752, Second Loss : 0.9288926383176939
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3125, precision 0.4087542087542088, recall 0.3832996632996633, F1 0.27575757575757576, AUC 0.7060830527497194
  Second-Tier acc 0.3541666666666667, precision 0.44497354497354497, recall 0.41080808080808073, F1 0.3060596579057155, AUC 0.7392424242424243
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.519298245614035, recall 0.4370223398001176, F1 0.3601924253556427, AUC 0.6876408485204782
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7484567901234568
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 9 idx: 0 First Loss : 3.813394546508789, Second Loss : 4.001551151275635
epoch: 9 idx: 200 First Loss : 0.8970228526555929, Second Loss : 0.929855347043413
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3194444444444444, precision 0.40349206349206357, recall 0.3998989898989899, F1 0.2697732609718963, AUC 0.6860942760942761
  Second-Tier acc 0.3541666666666667, precision 0.4351851851851852, recall 0.42777777777777776, F1 0.3005922875517934, AUC 0.7106565656565657
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3401360544217687, precision 0.47584758475847583, recall 0.3650058788947678, F1 0.2857944593666878, AUC 0.6661032725847541
  Second-Tier acc 0.3877551020408163, precision 0.4941798941798942, recall 0.41291887125220456, F1 0.3202531012404962, AUC 0.7132385361552028
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 10 idx: 0 First Loss : 3.9166154861450195, Second Loss : 3.932925224304199
epoch: 10 idx: 200 First Loss : 0.9025248589911568, Second Loss : 0.92950358551774
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.38724761550848513, recall 0.3962962962962963, F1 0.2543848146083992, AUC 0.6767732884399552
  Second-Tier acc 0.3541666666666667, precision 0.4351851851851852, recall 0.42777777777777776, F1 0.3005922875517934, AUC 0.7013636363636363
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.4890788224121558, recall 0.3967519106407995, F1 0.30108747044917256, AUC 0.6593547912992358
  Second-Tier acc 0.3877551020408163, precision 0.4941798941798942, recall 0.41291887125220456, F1 0.3202531012404962, AUC 0.6826499118165786
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 11 idx: 0 First Loss : 3.9331283569335938, Second Loss : 3.829176902770996
epoch: 11 idx: 200 First Loss : 0.9039324774041677, Second Loss : 0.9252763578330285
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3125, precision 0.3869917725057912, recall 0.3962962962962963, F1 0.25512265512265514, AUC 0.6784567901234567
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.7057070707070707
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.38095238095238093, precision 0.49370370370370376, recall 0.40880364491475607, F1 0.3123952738990333, AUC 0.6632985498726239
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6729497354497355
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 12 idx: 0 First Loss : 3.938368558883667, Second Loss : 3.8151965141296387
epoch: 12 idx: 200 First Loss : 0.8969081506254418, Second Loss : 0.9199491455208102
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2916666666666667, precision 0.3608262108262108, recall 0.38296296296296295, F1 0.232435705922726, AUC 0.6805387205387206
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.7044444444444444
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.35374149659863946, precision 0.49615784008307373, recall 0.3982951205173428, F1 0.29266516067410925, AUC 0.6638986870468352
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6720679012345677
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 13 idx: 0 First Loss : 3.9548652172088623, Second Loss : 3.944669246673584
epoch: 13 idx: 200 First Loss : 0.8967186134025936, Second Loss : 0.9193738302711061
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2847222222222222, precision 0.3487654320987654, recall 0.37851851851851853, F1 0.224811437577395, AUC 0.6769977553310887
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.6991414141414142
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.49563492063492065, recall 0.3982951205173428, F1 0.2932147217861503, AUC 0.6583749755046051
  Second-Tier acc 0.3673469387755102, precision 0.49074074074074076, recall 0.40057319223985893, F1 0.29857052498418724, AUC 0.6748236331569665
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 14 idx: 0 First Loss : 3.7996227741241455, Second Loss : 3.815478801727295
epoch: 14 idx: 200 First Loss : 0.88817927597974, Second Loss : 0.9105905414997966
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.3825536922624302, recall 0.39666666666666667, F1 0.25408324006135224, AUC 0.6732042648709315
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6987373737373738
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.5020940415000952, recall 0.4042475014697237, F1 0.300846280156625, AUC 0.6582096315892613
  Second-Tier acc 0.3469387755102041, precision 0.4870370370370371, recall 0.38822751322751325, F1 0.277037037037037, AUC 0.6694223985890652
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 15 idx: 0 First Loss : 3.7891266345977783, Second Loss : 3.784959316253662
epoch: 15 idx: 200 First Loss : 0.8834660728260413, Second Loss : 0.9031727865372317
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.3825254441952734, recall 0.39666666666666667, F1 0.25482921310758866, AUC 0.6717171717171717
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.70010101010101
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.5018674136321195, recall 0.4042475014697237, F1 0.3010535446976125, AUC 0.6597467176170879
  Second-Tier acc 0.3469387755102041, precision 0.4870370370370371, recall 0.38822751322751325, F1 0.277037037037037, AUC 0.6739969135802468
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 16 idx: 0 First Loss : 3.8103675842285156, Second Loss : 3.8214664459228516
epoch: 16 idx: 200 First Loss : 0.8794854066645938, Second Loss : 0.8988817359330556
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3055555555555556, precision 0.3808451308451309, recall 0.3918518518518519, F1 0.24513510788465417, AUC 0.671806958473625
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6983838383838384
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.4985763998734578, recall 0.40211640211640215, F1 0.2891665625390478, AUC 0.6629556143445033
  Second-Tier acc 0.3469387755102041, precision 0.4874874874874875, recall 0.38822751322751325, F1 0.27581699346405225, AUC 0.6722332451499118
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 17 idx: 0 First Loss : 3.826629638671875, Second Loss : 3.852118968963623
epoch: 17 idx: 200 First Loss : 0.8759690825707964, Second Loss : 0.897124330540428
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.3897122614227877, recall 0.3962962962962963, F1 0.2517241379310345, AUC 0.6726262626262626
  Second-Tier acc 0.3333333333333333, precision 0.44401709401709405, recall 0.4144444444444444, F1 0.2772222222222222, AUC 0.6989393939393939
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3741496598639456, precision 0.5089836417270045, recall 0.41446208112874783, F1 0.3117344553529687, AUC 0.6703777189888301
  Second-Tier acc 0.3673469387755102, precision 0.49780701754385964, recall 0.41203703703703703, F1 0.28782051282051285, AUC 0.6823743386243386
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 18 idx: 0 First Loss : 3.8781278133392334, Second Loss : 4.088412761688232
epoch: 18 idx: 200 First Loss : 0.8690400265698268, Second Loss : 0.8928877070439418
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3125, precision 0.39211717075494174, recall 0.3962962962962963, F1 0.2505746724075565, AUC 0.6728058361391694
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6935858585858585
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.49589490968801314, recall 0.40027924750146965, F1 0.2864808890125346, AUC 0.6683935920047032
  Second-Tier acc 0.32653061224489793, precision 0.4471544715447155, recall 0.35802469135802467, F1 0.21567398119122258, AUC 0.6799492945326279
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6)
Current LR: 9.92981885530929e-05
epoch: 19 idx: 0 First Loss : 3.675023317337036, Second Loss : 3.74625301361084
epoch: 19 idx: 200 First Loss : 0.8568455085184103, Second Loss : 0.882604388989267
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3125, precision 0.404402786755728, recall 0.3962962962962963, F1 0.24827219564061673, AUC 0.6733108866442198
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6909090909090909
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.36054421768707484, precision 0.4982222222222223, recall 0.3943268665490887, F1 0.27396976498772907, AUC 0.6687304036841075
  Second-Tier acc 0.32653061224489793, precision 0.4444444444444444, recall 0.35802469135802467, F1 0.21264367816091956, AUC 0.6866732804232804
Test AUC: 0.7850, Test F1: 0.3101 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.4303187359932702, "droprate_2": 0.0, "lr": 8.165315923148196e-05, "weight_decay": 4.246014496669813e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 8.165315923148196e-05
epoch: 0 idx: 0 First Loss : 1.2744299173355103, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1206556621623869, Second Loss : 1.112965610452849
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7369921436588104
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7562121212121212
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7042732216343327
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7034832451499118
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.165315923148196e-05
epoch: 1 idx: 0 First Loss : 2.0975167751312256, Second Loss : 2.0408267974853516
epoch: 1 idx: 200 First Loss : 1.0092553830710216, Second Loss : 1.0265269525608613
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5277777777777778, precision 0.5106382978723404, recall 0.3434343434343434, F1 0.2510893246187364, AUC 0.7385914702581369
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7502525252525252
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.713740691749951
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7115299823633157
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.165315923148196e-05
epoch: 2 idx: 0 First Loss : 2.4037435054779053, Second Loss : 2.3675520420074463
epoch: 2 idx: 200 First Loss : 0.9600454910255191, Second Loss : 0.9780137157113991
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.5382672882672882, recall 0.5405050505050505, F1 0.5379736435637057, AUC 0.7314029180695848
  Second-Tier acc 0.6458333333333334, precision 0.4166666666666667, recall 0.583030303030303, F1 0.47920470683708666, AUC 0.7365151515151515
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5986394557823129, precision 0.5629660314830157, recall 0.5987654320987654, F1 0.5742589231699939, AUC 0.7050080834803056
  Second-Tier acc 0.5306122448979592, precision 0.36303030303030304, recall 0.42416225749559083, F1 0.3846153846153846, AUC 0.6981922398589065
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.165315923148196e-05
epoch: 3 idx: 0 First Loss : 3.0901315212249756, Second Loss : 3.113022804260254
epoch: 3 idx: 200 First Loss : 0.9208833554120206, Second Loss : 0.9508763183075101
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5, precision 0.5402291105121294, recall 0.543030303030303, F1 0.4978549540347293, AUC 0.7264590347923682
  Second-Tier acc 0.4375, precision 0.5240870240870241, recall 0.46414141414141413, F1 0.37457279562542717, AUC 0.728989898989899
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5034013605442177, precision 0.5323597643506889, recall 0.5645208700764256, F1 0.5045793670212559, AUC 0.7226876347246719
  Second-Tier acc 0.5306122448979592, precision 0.5639367816091955, recall 0.5057319223985891, F1 0.48320413436692505, AUC 0.7223324514991182
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.165315923148196e-05
epoch: 4 idx: 0 First Loss : 3.588409662246704, Second Loss : 3.787405252456665
epoch: 4 idx: 200 First Loss : 0.907652303312363, Second Loss : 0.9460650725957396
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4305555555555556, precision 0.5403490994347252, recall 0.49003367003367, F1 0.43088076777412926, AUC 0.7155218855218854
  Second-Tier acc 0.4166666666666667, precision 0.5841269841269842, recall 0.46525252525252525, F1 0.38619737750172534, AUC 0.7503535353535353
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4965986394557823, precision 0.5711690071446168, recall 0.567607289829512, F1 0.5082402218315796, AUC 0.7262517146776406
  Second-Tier acc 0.5102040816326531, precision 0.5737179487179488, recall 0.5048500881834215, F1 0.46835748792270526, AUC 0.75
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.165315923148196e-05
epoch: 5 idx: 0 First Loss : 3.9221670627593994, Second Loss : 4.148562431335449
epoch: 5 idx: 200 First Loss : 0.9047463267198323, Second Loss : 0.9464055991509178
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.5395381058031661, recall 0.5185521885521885, F1 0.44202551645139626, AUC 0.7154208754208754
  Second-Tier acc 0.4166666666666667, precision 0.5582010582010581, recall 0.46525252525252525, F1 0.3851236146632566, AUC 0.7730808080808081
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.5833333333333334, recall 0.5653292181069959, F1 0.48552318123511085, AUC 0.7379972565157752
  Second-Tier acc 0.5510204081632653, precision 0.6414141414141414, recall 0.58179012345679, F1 0.521618883321011, AUC 0.7748567019400352
Test AUC: 0.7749, Test F1: 0.5216 (Best Epoch: 5)
Current LR: 8.165315923148196e-05
epoch: 6 idx: 0 First Loss : 3.812389373779297, Second Loss : 4.282291412353516
epoch: 6 idx: 200 First Loss : 0.898643551326, Second Loss : 0.9469927900264605
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4027777777777778, precision 0.5181194857061352, recall 0.481043771043771, F1 0.40311146694125416, AUC 0.7313916947250281
  Second-Tier acc 0.4166666666666667, precision 0.6129879879879879, recall 0.4822222222222223, F1 0.3830808080808081, AUC 0.7845959595959595
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46938775510204084, precision 0.5758333333333333, recall 0.5570987654320988, F1 0.4693325193325193, AUC 0.7486772486772487
  Second-Tier acc 0.5102040816326531, precision 0.6075036075036075, recall 0.5456349206349206, F1 0.4843971631205674, AUC 0.798666225749559
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 7 idx: 0 First Loss : 3.7352828979492188, Second Loss : 4.305427074432373
epoch: 7 idx: 200 First Loss : 0.8917379966833912, Second Loss : 0.942106222031309
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3541666666666667, precision 0.4717708761826409, recall 0.4258585858585859, F1 0.34585698886094146, AUC 0.737946127946128
  Second-Tier acc 0.3958333333333333, precision 0.5202380952380952, recall 0.4519191919191919, F1 0.3647730501950451, AUC 0.7608585858585858
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.5663780663780663, recall 0.526601998824221, F1 0.4332337379396203, AUC 0.7436618165784833
  Second-Tier acc 0.46938775510204084, precision 0.547979797979798, recall 0.4916225749559083, F1 0.42011144883485313, AUC 0.779376102292769
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 8 idx: 0 First Loss : 3.6059179306030273, Second Loss : 4.225174427032471
epoch: 8 idx: 200 First Loss : 0.8824779261511737, Second Loss : 0.9367129819763625
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.4658173734610123, recall 0.43151515151515146, F1 0.343396573390137, AUC 0.7273400673400673
  Second-Tier acc 0.375, precision 0.49206349206349204, recall 0.4385858585858586, F1 0.34400161030595805, AUC 0.7447979797979798
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4217687074829932, precision 0.5535714285714285, recall 0.5066137566137566, F1 0.41300042872016823, AUC 0.7292768959435626
  Second-Tier acc 0.42857142857142855, precision 0.5047619047619047, recall 0.43761022927689597, F1 0.3585700947045485, AUC 0.757991622574956
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 9 idx: 0 First Loss : 3.504542112350464, Second Loss : 4.131011486053467
epoch: 9 idx: 200 First Loss : 0.881775616588817, Second Loss : 0.9323871376543695
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.4399444074697569, recall 0.41505050505050506, F1 0.3133245461482706, AUC 0.7111223344556677
  Second-Tier acc 0.3541666666666667, precision 0.4365079365079365, recall 0.41080808080808073, F1 0.30696457326892107, AUC 0.7221717171717174
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5527210884353742, recall 0.5000734861845973, F1 0.39157024982547695, AUC 0.714101998824221
  Second-Tier acc 0.42857142857142855, precision 0.5092592592592593, recall 0.43761022927689597, F1 0.3582072829131653, AUC 0.7496141975308642
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 10 idx: 0 First Loss : 3.459157943725586, Second Loss : 4.146358013153076
epoch: 10 idx: 200 First Loss : 0.8837159430719356, Second Loss : 0.9297669600440243
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.41235748378605525, recall 0.4038720538720539, F1 0.281827568750901, AUC 0.6931762065095398
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6924242424242424
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3469387755102041, precision 0.49185784975258656, recall 0.3848471487360376, F1 0.305692576076176, AUC 0.6928461199294533
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7121362433862434
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 11 idx: 0 First Loss : 3.4570600986480713, Second Loss : 3.9191460609436035
epoch: 11 idx: 200 First Loss : 0.8877726104318985, Second Loss : 0.9290554358594094
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2916666666666667, precision 0.36775374158551727, recall 0.3773063973063973, F1 0.2359018326010074, AUC 0.6853647586980921
  Second-Tier acc 0.3541666666666667, precision 0.42728758169934644, recall 0.42777777777777776, F1 0.30382317801672637, AUC 0.6864141414141414
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3673469387755102, precision 0.48650793650793656, recall 0.3929306290417401, F1 0.3045076060113654, AUC 0.6793185381148344
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6948853615520282
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 12 idx: 0 First Loss : 3.521846055984497, Second Loss : 3.8924365043640137
epoch: 12 idx: 200 First Loss : 0.8881892607410077, Second Loss : 0.9247444989747572
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2986111111111111, precision 0.37140974967061924, recall 0.3874074074074074, F1 0.23846052777862004, AUC 0.6831088664421999
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.6890404040404041
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.36054421768707484, precision 0.4781818181818182, recall 0.38668430335097, F1 0.28428502130903294, AUC 0.6602427493631197
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6784060846560847
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 13 idx: 0 First Loss : 3.4808003902435303, Second Loss : 3.719574213027954
epoch: 13 idx: 200 First Loss : 0.886252639530544, Second Loss : 0.9180031010546734
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3125, precision 0.39211717075494174, recall 0.3962962962962963, F1 0.2505746724075565, AUC 0.682996632996633
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.6909595959595961
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.36054421768707484, precision 0.47839026915113864, recall 0.38668430335097, F1 0.283221468533754, AUC 0.6603835978835979
  Second-Tier acc 0.3877551020408163, precision 0.5011261261261262, recall 0.4243827160493827, F1 0.3106947079907232, AUC 0.6642416225749558
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 14 idx: 0 First Loss : 3.469898223876953, Second Loss : 3.6403427124023438
epoch: 14 idx: 200 First Loss : 0.883479768573654, Second Loss : 0.9109145250745246
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3125, precision 0.38884268884268886, recall 0.3962962962962963, F1 0.2523448773448773, AUC 0.6808417508417507
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.691060606060606
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3673469387755102, precision 0.4793447293447293, recall 0.3907995296884186, F1 0.2921985815602837, AUC 0.6623432294728591
  Second-Tier acc 0.3877551020408163, precision 0.5011261261261262, recall 0.4243827160493827, F1 0.3106947079907232, AUC 0.6704695767195767
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 15 idx: 0 First Loss : 3.5174827575683594, Second Loss : 3.6383228302001953
epoch: 15 idx: 200 First Loss : 0.8821806191049449, Second Loss : 0.9060070768662364
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2986111111111111, precision 0.37140974967061924, recall 0.3874074074074074, F1 0.23846052777862004, AUC 0.6786475869809202
  Second-Tier acc 0.3125, precision 0.3923611111111111, recall 0.40111111111111114, F1 0.2672859306780718, AUC 0.6858080808080809
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3741496598639456, precision 0.5019518542615485, recall 0.41446208112874783, F1 0.31201164646082474, AUC 0.6610204781501078
  Second-Tier acc 0.3673469387755102, precision 0.4962962962962963, recall 0.41203703703703703, F1 0.2903703703703704, AUC 0.658344356261023
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 16 idx: 0 First Loss : 3.4820783138275146, Second Loss : 3.6027092933654785
epoch: 16 idx: 200 First Loss : 0.8803578485217914, Second Loss : 0.9028867124421296
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2986111111111111, precision 0.37144258115131906, recall 0.3874074074074074, F1 0.2439822299603421, AUC 0.6737934904601571
  Second-Tier acc 0.3333333333333333, precision 0.41111111111111115, recall 0.4144444444444444, F1 0.28585858585858587, AUC 0.6814646464646464
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.5018674136321195, recall 0.4042475014697237, F1 0.3010535446976125, AUC 0.6609898589065256
  Second-Tier acc 0.3673469387755102, precision 0.4962962962962963, recall 0.41203703703703703, F1 0.2903703703703704, AUC 0.6579585537918872
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 17 idx: 0 First Loss : 3.452277421951294, Second Loss : 3.5750956535339355
epoch: 17 idx: 200 First Loss : 0.8751129140792949, Second Loss : 0.8950509502470206
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3055555555555556, precision 0.3815476190476191, recall 0.3918518518518519, F1 0.2444991789819376, AUC 0.6735016835016835
  Second-Tier acc 0.3333333333333333, precision 0.4127240143369175, recall 0.4144444444444444, F1 0.2912698412698413, AUC 0.6827272727272727
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.4915151515151515, recall 0.40057319223985893, F1 0.2978904634859037, AUC 0.6627902704291594
  Second-Tier acc 0.3673469387755102, precision 0.4983660130718954, recall 0.41203703703703703, F1 0.29444444444444445, AUC 0.6658399470899471
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 18 idx: 0 First Loss : 3.731030225753784, Second Loss : 3.668184995651245
epoch: 18 idx: 200 First Loss : 0.8690941485094019, Second Loss : 0.8927639477353558
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.38413322842905845, recall 0.4014814814814815, F1 0.26413717001952297, AUC 0.674304152637486
  Second-Tier acc 0.3125, precision 0.3923611111111111, recall 0.40111111111111114, F1 0.2672859306780718, AUC 0.6825252525252524
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.35374149659863946, precision 0.5092982456140351, recall 0.414021164021164, F1 0.30489171588671815, AUC 0.6665258181461886
  Second-Tier acc 0.3673469387755102, precision 0.4969696969696969, recall 0.41203703703703703, F1 0.29223057644110273, AUC 0.6708002645502645
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6)
Current LR: 8.165315923148196e-05
epoch: 19 idx: 0 First Loss : 3.4879539012908936, Second Loss : 3.6423165798187256
epoch: 19 idx: 200 First Loss : 0.8629446665939968, Second Loss : 0.8875635643880968
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3125, precision 0.3929721441349348, recall 0.4107407407407407, F1 0.2745154084500276, AUC 0.6756172839506173
  Second-Tier acc 0.3125, precision 0.3914141414141414, recall 0.40111111111111114, F1 0.26461769115442274, AUC 0.687979797979798
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.507948717948718, recall 0.40990593768371547, F1 0.2971260773128157, AUC 0.6695326278659612
  Second-Tier acc 0.3469387755102041, precision 0.4985569985569986, recall 0.3996913580246913, F1 0.27486160208097116, AUC 0.6761463844797179
Test AUC: 0.7987, Test F1: 0.4844 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.18290780322610525, "droprate_2": 0.0, "lr": 0.00015966185151459399, "weight_decay": 0.00017758601064452834, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00015966185151459399
epoch: 0 idx: 0 First Loss : 1.153096079826355, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0880728538579016, Second Loss : 1.0849967346855658
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7508641975308642
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7668686868686869
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7171761708798745
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7166005291005292
Test AUC: 0.7166, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00015966185151459399
epoch: 1 idx: 0 First Loss : 1.724657416343689, Second Loss : 1.842724084854126
epoch: 1 idx: 200 First Loss : 0.9938432530532428, Second Loss : 0.9901905626206848
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7418911335578002
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7472727272727272
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7336064569860866
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7312610229276896
Test AUC: 0.7166, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00015966185151459399
epoch: 2 idx: 0 First Loss : 2.039426565170288, Second Loss : 2.0834288597106934
epoch: 2 idx: 200 First Loss : 0.9451062340863902, Second Loss : 0.9483022518196509
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6388888888888888, precision 0.7413116970926302, recall 0.5720875420875421, F1 0.48564622314622313, AUC 0.7294949494949495
  Second-Tier acc 0.6458333333333334, precision 0.4130297280202404, recall 0.566060606060606, F1 0.4761904761904762, AUC 0.7373232323232323
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6054421768707483, precision 0.6393762183235867, recall 0.5318930041152263, F1 0.5363234253361642, AUC 0.7335574661963551
  Second-Tier acc 0.6122448979591837, precision 0.6146848602988954, recall 0.5321869488536155, F1 0.5375982042648709, AUC 0.7277336860670194
Test AUC: 0.7166, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00015966185151459399
epoch: 3 idx: 0 First Loss : 2.9981296062469482, Second Loss : 3.1527349948883057
epoch: 3 idx: 200 First Loss : 0.9222442689282235, Second Loss : 0.930266451025706
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4375, precision 0.5262829443863927, recall 0.4905050505050505, F1 0.42959061140879323, AUC 0.7445061728395062
  Second-Tier acc 0.4583333333333333, precision 0.5206439393939394, recall 0.5088888888888888, F1 0.41564067487460105, AUC 0.7532828282828282
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5102040816326531, precision 0.5474445245533927, recall 0.5622427983539094, F1 0.5082572159298502, AUC 0.7499326376641191
  Second-Tier acc 0.4897959183673469, precision 0.5468509984639017, recall 0.4810405643738977, F1 0.45293586269196023, AUC 0.7444885361552028
Test AUC: 0.7166, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00015966185151459399
epoch: 4 idx: 0 First Loss : 3.392225503921509, Second Loss : 3.622751235961914
epoch: 4 idx: 200 First Loss : 0.9107551051174008, Second Loss : 0.9233273512160229
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4166666666666667, precision 0.4940096618357488, recall 0.48764309764309766, F1 0.4077822637636807, AUC 0.7624971941638607
  Second-Tier acc 0.4166666666666667, precision 0.48253968253968255, recall 0.4677777777777778, F1 0.3562456866804693, AUC 0.7789393939393939
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.47619047619047616, precision 0.5668295487208969, recall 0.5416666666666666, F1 0.46884470844950904, AUC 0.7374277385851459
  Second-Tier acc 0.4897959183673469, precision 0.5274509803921569, recall 0.474647266313933, F1 0.412017787017787, AUC 0.7443783068783069
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 5 idx: 0 First Loss : 3.5066795349121094, Second Loss : 3.7467944622039795
epoch: 5 idx: 200 First Loss : 0.9098499996508865, Second Loss : 0.9202881098935723
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4027777777777778, precision 0.46986559630237784, recall 0.44841750841750844, F1 0.33615414219075773, AUC 0.7458754208754209
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7453030303030302
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46258503401360546, precision 0.4800968399592253, recall 0.4348177542621987, F1 0.36277792693355604, AUC 0.7110094552224182
  Second-Tier acc 0.4489795918367347, precision 0.45045045045045046, recall 0.42063492063492064, F1 0.33660130718954245, AUC 0.7063492063492064
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 6 idx: 0 First Loss : 3.865457534790039, Second Loss : 3.9134562015533447
epoch: 6 idx: 200 First Loss : 0.9233496482750466, Second Loss : 0.9208868697542808
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.375, precision 0.4400966183574879, recall 0.4314814814814814, F1 0.29958894593040936, AUC 0.6949607182940517
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6904545454545454
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.49404761904761907, recall 0.4307025279247502, F1 0.3572613634762199, AUC 0.6738009504213208
  Second-Tier acc 0.4489795918367347, precision 0.4537037037037037, recall 0.42063492063492064, F1 0.34, AUC 0.6528880070546736
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 7 idx: 0 First Loss : 3.5166568756103516, Second Loss : 3.7488114833831787
epoch: 7 idx: 200 First Loss : 0.9142864554928181, Second Loss : 0.9174788968367688
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3958333333333333, precision 0.47469635627530365, recall 0.4448148148148148, F1 0.3181417121303967, AUC 0.6784904601571268
  Second-Tier acc 0.375, precision 0.3881578947368421, recall 0.4266666666666667, F1 0.29107400535971967, AUC 0.685050505050505
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.5316091954022989, recall 0.44246031746031744, F1 0.35925256178420734, AUC 0.6709472369194591
  Second-Tier acc 0.42857142857142855, precision 0.456140350877193, recall 0.4197530864197531, F1 0.3167420814479638, AUC 0.6551477072310407
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 8 idx: 0 First Loss : 3.3642406463623047, Second Loss : 3.5550127029418945
epoch: 8 idx: 200 First Loss : 0.904964325248741, Second Loss : 0.9135232598976052
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.4698275862068966, recall 0.4359259259259259, F1 0.3057318147922175, AUC 0.6720594837261503
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.6890909090909091
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46258503401360546, precision 0.5334757834757835, recall 0.44628159905937687, F1 0.357711050093346, AUC 0.6711493239271017
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6773589065255732
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 9 idx: 0 First Loss : 3.304001569747925, Second Loss : 3.4783413410186768
epoch: 9 idx: 200 First Loss : 0.899564888941087, Second Loss : 0.9075024578342705
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.4698275862068966, recall 0.4359259259259259, F1 0.3057318147922175, AUC 0.6688608305274973
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6901515151515151
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.5602636534839924, recall 0.44628159905937687, F1 0.3575184608284297, AUC 0.6744317068391142
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6819885361552028
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 10 idx: 0 First Loss : 3.2956268787384033, Second Loss : 3.632337808609009
epoch: 10 idx: 200 First Loss : 0.8966604101034901, Second Loss : 0.8984257641346286
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4884920634920635, recall 0.4225925925925926, F1 0.28588486676721975, AUC 0.6626823793490461
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.6785353535353534
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5601469237832873, recall 0.4418724279835391, F1 0.34390639656488325, AUC 0.6693060454634528
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6787367724867724
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 11 idx: 0 First Loss : 3.355015516281128, Second Loss : 3.441505193710327
epoch: 11 idx: 200 First Loss : 0.8935075936959455, Second Loss : 0.8881049620390716
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.4530595813204508, recall 0.4274074074074074, F1 0.29757652389231337, AUC 0.6560718294051627
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6692424242424243
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.490819209039548, recall 0.42570546737213405, F1 0.328921568627451, AUC 0.6777202135998431
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6904761904761904
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 12 idx: 0 First Loss : 3.465740919113159, Second Loss : 3.7237067222595215
epoch: 12 idx: 200 First Loss : 0.8868158120723947, Second Loss : 0.8805791103732552
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3402777777777778, precision 0.45127504553734066, recall 0.4092592592592592, F1 0.2661290322580645, AUC 0.6575420875420875
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6673737373737373
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5147540983606557, recall 0.4295267489711934, F1 0.3257334143843316, AUC 0.6843033509700177
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6930114638447972
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 13 idx: 0 First Loss : 3.337696075439453, Second Loss : 3.412215232849121
epoch: 13 idx: 200 First Loss : 0.881327064423208, Second Loss : 0.8751823577424048
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3611111111111111, precision 0.7092115534738485, recall 0.4225925925925926, F1 0.28495350188898577, AUC 0.661307519640853
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6592929292929293
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.44623655913978494, recall 0.4238683127572016, F1 0.3110695208016532, AUC 0.6923807074270037
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7008928571428571
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.00015966185151459399
epoch: 14 idx: 0 First Loss : 3.7467174530029297, Second Loss : 3.53995418548584
epoch: 14 idx: 200 First Loss : 0.882731220244189, Second Loss : 0.8672368725635365
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.4116531165311654, recall 0.39592592592592585, F1 0.2457875457875458, AUC 0.6607912457912458
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6659090909090909
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3945578231292517, precision 0.44533333333333336, recall 0.3991769547325103, F1 0.27763030639751424, AUC 0.6881981187536743
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7022707231040565
Test AUC: 0.7444, Test F1: 0.4120 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.23249611483728072, "droprate_2": 0.0, "lr": 3.845071351656994e-05, "weight_decay": 0.00089495517548194, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.14102714199340993, "droprate_2": 0.0, "lr": 0.0004683978007080952, "weight_decay": 2.2190065899686742e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.204822367773772, "droprate_2": 0.0, "lr": 0.0001755623174644558, "weight_decay": 4.0485408031376213e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.283130927360442, "droprate_2": 0.0, "lr": 6.028126819553763e-05, "weight_decay": 0.00046767675770493594, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.1108552975687019, "droprate_2": 0.0, "lr": 3.610352712066241e-05, "weight_decay": 1.030625058321993e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0858514308929443, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1217698335499313, Second Loss : 1.1135446576040182
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7346433080808081
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7264141414141414
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6645895337301587
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.660163139329806
epoch: 1 idx: 0 First Loss : 1.992611050605774, Second Loss : 2.0696606636047363
epoch: 1 idx: 200 First Loss : 1.066724536208371, Second Loss : 1.067258724451658
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7430050505050504
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7477272727272727
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.701071979717813
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6987985008818342
epoch: 2 idx: 0 First Loss : 2.1764326095581055, Second Loss : 2.2111501693725586
epoch: 2 idx: 200 First Loss : 1.022787174923503, Second Loss : 1.028582119415352
  First-Tier acc 0.6458333333333334, precision 0.6393196175804872, recall 0.5351010101010101, F1 0.48677479222141523, AUC 0.741278409090909
  Second-Tier acc 0.6041666666666666, precision 0.5717948717948719, recall 0.46646464646464647, F1 0.4583333333333333, AUC 0.7487373737373737
  First-Tier acc 0.5867346938775511, precision 0.6072649572649572, recall 0.4243827160493827, F1 0.4195856695856696, AUC 0.6846030368165784
  Second-Tier acc 0.6530612244897959, precision 0.8093023255813954, recall 0.5238095238095238, F1 0.5067155067155067, AUC 0.6832010582010581
epoch: 3 idx: 0 First Loss : 2.445319175720215, Second Loss : 2.477280855178833
epoch: 3 idx: 200 First Loss : 0.9856392908748702, Second Loss : 0.9903844872962183
  First-Tier acc 0.6197916666666666, precision 0.6019988242210464, recall 0.596969696969697, F1 0.5588893974065599, AUC 0.7468939393939394
  Second-Tier acc 0.7083333333333334, precision 0.6594254510921177, recall 0.6392929292929294, F1 0.6441565452091768, AUC 0.7462626262626263
  First-Tier acc 0.576530612244898, precision 0.5541646984726815, recall 0.5724206349206349, F1 0.5572298806224935, AUC 0.6939380787037036
  Second-Tier acc 0.5306122448979592, precision 0.48829431438127086, recall 0.5249118165784833, F1 0.4955202821869489, AUC 0.6929563492063492
epoch: 4 idx: 0 First Loss : 2.7736992835998535, Second Loss : 2.8315091133117676
epoch: 4 idx: 200 First Loss : 0.9595553501143088, Second Loss : 0.9603296370982234
  First-Tier acc 0.578125, precision 0.5846690512635456, recall 0.6051515151515151, F1 0.5649935831583361, AUC 0.7583207070707069
  Second-Tier acc 0.5625, precision 0.5634920634920635, recall 0.5867676767676767, F1 0.5367565086235163, AUC 0.7603030303030304
  First-Tier acc 0.5510204081632653, precision 0.5529866593142946, recall 0.6083002645502645, F1 0.5461992787574184, AUC 0.711195849867725
  Second-Tier acc 0.5102040816326531, precision 0.49595393713040775, recall 0.5240299823633157, F1 0.4879548169870751, AUC 0.7222773368606701
epoch: 5 idx: 0 First Loss : 3.059576988220215, Second Loss : 3.161119222640991
epoch: 5 idx: 200 First Loss : 0.945366056367236, Second Loss : 0.9422296722748534
  First-Tier acc 0.53125, precision 0.5780749032614704, recall 0.5847222222222221, F1 0.5294433428447066, AUC 0.7661174242424242
  Second-Tier acc 0.5208333333333334, precision 0.5659271284271284, recall 0.5626262626262627, F1 0.510662177328844, AUC 0.7797979797979798
  First-Tier acc 0.49489795918367346, precision 0.5204908126772722, recall 0.5730820105820106, F1 0.494829074012612, AUC 0.7233486276455027
  Second-Tier acc 0.46938775510204084, precision 0.48055555555555557, recall 0.5286596119929453, F1 0.4662698412698412, AUC 0.7296626984126983
epoch: 6 idx: 0 First Loss : 3.283804178237915, Second Loss : 3.402161121368408
epoch: 6 idx: 200 First Loss : 0.9386331600169489, Second Loss : 0.9316916837639625
  First-Tier acc 0.4791666666666667, precision 0.5477207977207977, recall 0.5465151515151515, F1 0.4800898501477094, AUC 0.7710353535353535
  Second-Tier acc 0.5208333333333334, precision 0.5875816993464053, recall 0.5821212121212122, F1 0.5241584564860426, AUC 0.8031818181818181
  First-Tier acc 0.49489795918367346, precision 0.5401952295544973, recall 0.5861441798941799, F1 0.49520814615154235, AUC 0.7311886849647267
  Second-Tier acc 0.4897959183673469, precision 0.503968253968254, recall 0.5524691358024691, F1 0.49367625838214074, AUC 0.734402557319224
epoch: 7 idx: 0 First Loss : 3.4149208068847656, Second Loss : 3.568744421005249
epoch: 7 idx: 200 First Loss : 0.9356544245154926, Second Loss : 0.9255403276088078
  First-Tier acc 0.4583333333333333, precision 0.5343580734885083, recall 0.5314646464646464, F1 0.45765325419685193, AUC 0.7693339646464646
  Second-Tier acc 0.5416666666666666, precision 0.6154761904761904, recall 0.6149494949494949, F1 0.5479853479853479, AUC 0.8042424242424242
  First-Tier acc 0.46938775510204084, precision 0.5276270845891099, recall 0.5560515873015873, F1 0.46884965962847586, AUC 0.7355220734126985
  Second-Tier acc 0.5102040816326531, precision 0.5317460317460317, recall 0.576278659611993, F1 0.5130609228170203, AUC 0.7308752204585538
epoch: 8 idx: 0 First Loss : 3.5106163024902344, Second Loss : 3.6514689922332764
epoch: 8 idx: 200 First Loss : 0.9332442972600571, Second Loss : 0.9197122270185778
  First-Tier acc 0.4479166666666667, precision 0.5336193985898666, recall 0.5211868686868687, F1 0.44661483141735675, AUC 0.7628535353535354
  Second-Tier acc 0.5416666666666666, precision 0.6154761904761904, recall 0.6149494949494949, F1 0.5479853479853479, AUC 0.8090404040404041
  First-Tier acc 0.45408163265306123, precision 0.5323747276688453, recall 0.5451940035273369, F1 0.45370922722284823, AUC 0.736390128968254
  Second-Tier acc 0.46938775510204084, precision 0.501984126984127, recall 0.5515873015873015, F1 0.47289377289377293, AUC 0.7379850088183423
epoch: 9 idx: 0 First Loss : 3.540288209915161, Second Loss : 3.713289737701416
epoch: 9 idx: 200 First Loss : 0.9299797159550127, Second Loss : 0.9149455768056214
  First-Tier acc 0.4427083333333333, precision 0.5277777777777778, recall 0.5112626262626262, F1 0.43903318903318905, AUC 0.7549273989898989
  Second-Tier acc 0.5, precision 0.5783475783475783, recall 0.5763636363636363, F1 0.49704292527821936, AUC 0.8018686868686867
  First-Tier acc 0.4642857142857143, precision 0.5451000690131126, recall 0.5481701940035273, F1 0.461065337302961, AUC 0.7352740575396824
  Second-Tier acc 0.5102040816326531, precision 0.5722222222222223, recall 0.5992063492063492, F1 0.5115138021316511, AUC 0.7573853615520282{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.14944296009097102, "droprate_2": 0.0, "lr": 2.8749402934292277e-05, "weight_decay": 4.189306330391947e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 3, "gamma": 0.7564319163353026, "T_max": 14, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0816774368286133, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1160752877074094, Second Loss : 1.1074061645797235
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7296906565656566
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7195454545454546
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6559675374779541
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6468805114638448
epoch: 1 idx: 0 First Loss : 1.9950289726257324, Second Loss : 2.041490316390991
epoch: 1 idx: 200 First Loss : 1.083209043044356, Second Loss : 1.0813458063709203
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445738636363636
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7451515151515151
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6957637511022927
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6900352733686068
epoch: 2 idx: 0 First Loss : 2.1420233249664307, Second Loss : 2.154364585876465
epoch: 2 idx: 200 First Loss : 1.0437649862831504, Second Loss : 1.0486654510619628
  First-Tier acc 0.5677083333333334, precision 0.44542536115569825, recall 0.41, F1 0.36144877201686926, AUC 0.7399905303030302
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7454545454545455
  First-Tier acc 0.5714285714285714, precision 0.3158067158067158, recall 0.35714285714285715, F1 0.28553478342078004, AUC 0.695102375440917
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.697255291005291
epoch: 3 idx: 0 First Loss : 2.329630136489868, Second Loss : 2.3477182388305664
epoch: 3 idx: 200 First Loss : 1.0091149431481883, Second Loss : 1.0157725876984904
  First-Tier acc 0.671875, precision 0.6510124883286648, recall 0.6001515151515151, F1 0.5541091439913838, AUC 0.739564393939394
  Second-Tier acc 0.7083333333333334, precision 0.6732804232804233, recall 0.6104040404040404, F1 0.6246170983013087, AUC 0.7468181818181817
  First-Tier acc 0.5561224489795918, precision 0.539203400658509, recall 0.4724426807760141, F1 0.4833255415303101, AUC 0.6854814263668431
  Second-Tier acc 0.5306122448979592, precision 0.4820987654320988, recall 0.5134479717813051, F1 0.4876543209876543, AUC 0.6841931216931215
epoch: 4 idx: 0 First Loss : 2.577143907546997, Second Loss : 2.6294939517974854
epoch: 4 idx: 200 First Loss : 0.9799904265807042, Second Loss : 0.9830962575935013
  First-Tier acc 0.5885416666666666, precision 0.5640873015873016, recall 0.580580808080808, F1 0.5400767543859649, AUC 0.7491256313131313
  Second-Tier acc 0.5416666666666666, precision 0.49898989898989904, recall 0.4961616161616161, F1 0.4723311546840958, AUC 0.7506060606060606
  First-Tier acc 0.576530612244898, precision 0.5606695807131289, recall 0.5928130511463845, F1 0.5647042544705719, AUC 0.6988570601851851
  Second-Tier acc 0.5102040816326531, precision 0.4692460317460317, recall 0.5011022927689593, F1 0.46367521367521364, AUC 0.7035383597883599
epoch: 5 idx: 0 First Loss : 2.843168258666992, Second Loss : 2.923354387283325
epoch: 5 idx: 200 First Loss : 0.9590037606322943, Second Loss : 0.9585513965741023
  First-Tier acc 0.5677083333333334, precision 0.600116944052254, recall 0.6148232323232324, F1 0.5613117620575782, AUC 0.7593939393939394
  Second-Tier acc 0.5208333333333334, precision 0.5524691358024691, recall 0.5431313131313131, F1 0.48623238623238624, AUC 0.7578282828282829
  First-Tier acc 0.5459183673469388, precision 0.5539245794397079, recall 0.6154100529100529, F1 0.5464919695688927, AUC 0.7144303902116401
  Second-Tier acc 0.5102040816326531, precision 0.4914529914529915, recall 0.5597442680776014, F1 0.48566001899335226, AUC 0.7252535273368607
epoch: 6 idx: 0 First Loss : 3.0573360919952393, Second Loss : 3.1733148097991943
epoch: 6 idx: 200 First Loss : 0.94722047973591, Second Loss : 0.9435498953718154
  First-Tier acc 0.5104166666666666, precision 0.5635157881699909, recall 0.5635353535353537, F1 0.5087423840527289, AUC 0.7670580808080808
  Second-Tier acc 0.4791666666666667, precision 0.5243589743589744, recall 0.5164646464646464, F1 0.45136754930805273, AUC 0.779949494949495
  First-Tier acc 0.5, precision 0.5313063063063063, recall 0.5892305996472663, F1 0.5008276533592989, AUC 0.7275476741622575
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7321979717813051
epoch: 7 idx: 0 First Loss : 3.2184512615203857, Second Loss : 3.360940456390381
epoch: 7 idx: 200 First Loss : 0.9418368492025271, Second Loss : 0.9345025502849574
  First-Tier acc 0.4583333333333333, precision 0.5335254191463342, recall 0.5253282828282827, F1 0.45943866419711304, AUC 0.7690309343434342
  Second-Tier acc 0.5, precision 0.5483091787439615, recall 0.5467676767676767, F1 0.4835164835164835, AUC 0.8070707070707072
  First-Tier acc 0.5051020408163265, precision 0.5492753623188406, recall 0.6025132275132276, F1 0.5061358702651418, AUC 0.734157986111111
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7366071428571428
epoch: 8 idx: 0 First Loss : 3.334757089614868, Second Loss : 3.490351438522339
epoch: 8 idx: 200 First Loss : 0.9386587478452135, Second Loss : 0.9279093583999434
  First-Tier acc 0.4479166666666667, precision 0.5275859933239451, recall 0.5186616161616161, F1 0.4492355897630013, AUC 0.766003787878788
  Second-Tier acc 0.5, precision 0.5605042016806723, recall 0.5518181818181818, F1 0.4961038961038961, AUC 0.806060606060606
  First-Tier acc 0.47959183673469385, precision 0.5362909383162547, recall 0.5724206349206349, F1 0.4800184608284297, AUC 0.7357597552910052
  Second-Tier acc 0.4897959183673469, precision 0.5227920227920227, recall 0.5703262786596119, F1 0.48782051282051286, AUC 0.736166225749559
epoch: 9 idx: 0 First Loss : 3.4317078590393066, Second Loss : 3.5749258995056152
epoch: 9 idx: 200 First Loss : 0.9364121179930421, Second Loss : 0.9220634106389103
  First-Tier acc 0.4427083333333333, precision 0.5303849640004789, recall 0.5178535353535354, F1 0.44150044532819654, AUC 0.7588636363636363
  Second-Tier acc 0.5, precision 0.562962962962963, recall 0.5543434343434344, F1 0.49901477832512314, AUC 0.8084848484848485
  First-Tier acc 0.45918367346938777, precision 0.5370515250033322, recall 0.5556106701940036, F1 0.45932672821987053, AUC 0.7383673666225748
  Second-Tier acc 0.46938775510204084, precision 0.501984126984127, recall 0.5515873015873015, F1 0.47289377289377293, AUC 0.7370480599647267{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.24575641014552563, "droprate_2": 0.0, "lr": 2.368235585674855e-05, "weight_decay": 0.00023846979180935064, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1139793395996094, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1040419162209354, Second Loss : 1.0983592399317235
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7197190656565656
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7170707070707071
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6436425264550264
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6382826278659611
epoch: 1 idx: 0 First Loss : 2.0132482051849365, Second Loss : 2.01552677154541
epoch: 1 idx: 200 First Loss : 1.0892524014213192, Second Loss : 1.0876114341750074
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7396685606060606
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.743939393939394
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6885299548059965
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6882164902998236
epoch: 2 idx: 0 First Loss : 2.106192111968994, Second Loss : 2.1057093143463135
epoch: 2 idx: 200 First Loss : 1.0575788234596821, Second Loss : 1.0615931306757145
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7408522727272727
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7447979797979798
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703035438712522
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7045304232804233
epoch: 3 idx: 0 First Loss : 2.244540214538574, Second Loss : 2.2591726779937744
epoch: 3 idx: 200 First Loss : 1.0284906192427843, Second Loss : 1.036871371429358
  First-Tier acc 0.5989583333333334, precision 0.39917452830188677, recall 0.46393939393939393, F1 0.41377091377091374, AUC 0.7378882575757576
  Second-Tier acc 0.6041666666666666, precision 0.6222222222222222, recall 0.46393939393939393, F1 0.4590390002154708, AUC 0.7440909090909091
  First-Tier acc 0.6122448979591837, precision 0.6561904761904761, recall 0.43441358024691357, F1 0.4212920177584489, AUC 0.6930011298500882
  Second-Tier acc 0.6122448979591837, precision 0.40454545454545454, recall 0.4583333333333333, F1 0.40736728060671723, AUC 0.7021604938271605
epoch: 4 idx: 0 First Loss : 2.4483323097229004, Second Loss : 2.4513378143310547
epoch: 4 idx: 200 First Loss : 0.9987163625249815, Second Loss : 1.0087571111855222
  First-Tier acc 0.6510416666666666, precision 0.6229430788254318, recall 0.594040404040404, F1 0.5548487556004454, AUC 0.736852904040404
  Second-Tier acc 0.6666666666666666, precision 0.6289419392867669, recall 0.5812121212121212, F1 0.5884676833696442, AUC 0.7440909090909091
  First-Tier acc 0.6020408163265306, precision 0.5710755690953712, recall 0.570326278659612, F1 0.5693171879311715, AUC 0.6875413359788359
  Second-Tier acc 0.4897959183673469, precision 0.4123931623931624, recall 0.4658289241622575, F1 0.419370074825366, AUC 0.6916335978835978
epoch: 5 idx: 0 First Loss : 2.6810126304626465, Second Loss : 2.698268413543701
epoch: 5 idx: 200 First Loss : 0.9725347304373831, Second Loss : 0.9813818588148598
  First-Tier acc 0.59375, precision 0.577922077922078, recall 0.5970959595959596, F1 0.5661129878351363, AUC 0.7457291666666667
  Second-Tier acc 0.6041666666666666, precision 0.5902255639097744, recall 0.5845454545454546, F1 0.5645933014354066, AUC 0.7581818181818182
  First-Tier acc 0.5612244897959183, precision 0.5457902973395931, recall 0.5924823633156966, F1 0.5508480772170572, AUC 0.6996355544532628
  Second-Tier acc 0.5306122448979592, precision 0.4954248366013072, recall 0.5427689594356261, F1 0.4895144571740316, AUC 0.7086089065255732
epoch: 6 idx: 0 First Loss : 2.9076242446899414, Second Loss : 2.9315803050994873
epoch: 6 idx: 200 First Loss : 0.9531883794202733, Second Loss : 0.961135626209909
  First-Tier acc 0.5572916666666666, precision 0.5851574569221628, recall 0.6056313131313131, F1 0.5543273194022584, AUC 0.7576199494949495
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7696464646464646
  First-Tier acc 0.5153061224489796, precision 0.5263347763347763, recall 0.5825617283950617, F1 0.5094480415116867, AUC 0.7123773699294532
  Second-Tier acc 0.46938775510204084, precision 0.46125116713352, recall 0.5057319223985891, F1 0.44605394605394605, AUC 0.7252535273368608
epoch: 7 idx: 0 First Loss : 3.075294256210327, Second Loss : 3.1310536861419678
epoch: 7 idx: 200 First Loss : 0.9425875290635213, Second Loss : 0.9468763058458395
  First-Tier acc 0.4947916666666667, precision 0.5572301261956435, recall 0.553989898989899, F1 0.49460714256877325, AUC 0.7631281565656566
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.7851515151515152
  First-Tier acc 0.4744897959183674, precision 0.5145330859616574, recall 0.5594686948853616, F1 0.47121991817293335, AUC 0.7234726355820106
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7352843915343916
epoch: 8 idx: 0 First Loss : 3.196390151977539, Second Loss : 3.291236639022827
epoch: 8 idx: 200 First Loss : 0.9363429592968664, Second Loss : 0.9374308080333679
  First-Tier acc 0.46875, precision 0.5429947516641066, recall 0.533080808080808, F1 0.46939847649067507, AUC 0.767885101010101
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.8154040404040405
  First-Tier acc 0.4744897959183674, precision 0.5203586751907695, recall 0.5667989417989417, F1 0.47213727879582157, AUC 0.7285018463403881
  Second-Tier acc 0.46938775510204084, precision 0.489573607220666, recall 0.5465167548500882, F1 0.4658758498254958, AUC 0.7345127865961198
epoch: 9 idx: 0 First Loss : 3.2835793495178223, Second Loss : 3.398074150085449
epoch: 9 idx: 200 First Loss : 0.9311978665287074, Second Loss : 0.9300480394563939
  First-Tier acc 0.4375, precision 0.5209156362765721, recall 0.51010101010101, F1 0.43776904360845964, AUC 0.7671654040404041
  Second-Tier acc 0.4791666666666667, precision 0.5415458937198068, recall 0.5215151515151515, F1 0.471062271062271, AUC 0.8129292929292928
  First-Tier acc 0.47959183673469385, precision 0.5327227354783902, recall 0.5813492063492064, F1 0.4806458237075825, AUC 0.7294422398589065
  Second-Tier acc 0.4489795918367347, precision 0.5007974481658692, recall 0.5456349206349206, F1 0.45194636422706597, AUC 0.7359457671957671{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_18", "train_show_freq": 200, "droprate": 0.262012711622587, "droprate_2": 0.0, "lr": 1.8843675264692824e-05, "weight_decay": 1.9495085233831285e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 10, "gamma": 0.7236249066187124, "T_max": 20, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_18", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0995337963104248, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.087190299929671, Second Loss : 1.0815199159864168
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7168213383838383
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7064141414141414
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6343143738977072
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.634645061728395
epoch: 1 idx: 0 First Loss : 1.9737951755523682, Second Loss : 1.9854822158813477
epoch: 1 idx: 200 First Loss : 1.0963788408396848, Second Loss : 1.0944660402352537
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7384406565656566
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7321717171717171
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6771108906525573
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6769179894179894
epoch: 2 idx: 0 First Loss : 2.05267596244812, Second Loss : 2.0588040351867676
epoch: 2 idx: 200 First Loss : 1.0695562179557128, Second Loss : 1.0737311778525216
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7431470959595959
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7455050505050504
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6986538249559082
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6963734567901234
epoch: 3 idx: 0 First Loss : 2.153188705444336, Second Loss : 2.169609785079956
epoch: 3 idx: 200 First Loss : 1.0473385266403654, Second Loss : 1.056384571971585
  First-Tier acc 0.5625, precision 0.43890560091677405, recall 0.4024242424242424, F1 0.3511287178519776, AUC 0.7395296717171718
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7467171717171718
  First-Tier acc 0.5561224489795918, precision 0.23315602836879434, recall 0.33928571428571425, F1 0.2536599099099099, AUC 0.6958360890652558
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6929563492063492
epoch: 4 idx: 0 First Loss : 2.2904856204986572, Second Loss : 2.3171274662017822
epoch: 4 idx: 200 First Loss : 1.0234476489140027, Second Loss : 1.0345993274776497
  First-Tier acc 0.6614583333333334, precision 0.5975541579315164, recall 0.5663131313131313, F1 0.5094020843527314, AUC 0.7403156565656565
  Second-Tier acc 0.6041666666666666, precision 0.5222222222222221, recall 0.46141414141414133, F1 0.4347892544613856, AUC 0.7511616161616163
  First-Tier acc 0.5918367346938775, precision 0.6187363834422658, recall 0.47685185185185186, F1 0.4965083760514705, AUC 0.6831838348765432
  Second-Tier acc 0.6122448979591837, precision 0.6951566951566951, recall 0.4991181657848324, F1 0.45383244206773615, AUC 0.6834215167548501
epoch: 5 idx: 0 First Loss : 2.454808473587036, Second Loss : 2.5050132274627686
epoch: 5 idx: 200 First Loss : 0.9990278744134143, Second Loss : 1.0103344925452227
  First-Tier acc 0.6302083333333334, precision 0.6011229053024719, recall 0.5891919191919193, F1 0.5424021434401505, AUC 0.7417234848484848
  Second-Tier acc 0.6458333333333334, precision 0.6213818860877685, recall 0.5483838383838383, F1 0.532887195216408, AUC 0.7513131313131313
  First-Tier acc 0.6020408163265306, precision 0.5862026862026862, recall 0.5891203703703703, F1 0.5820182749089781, AUC 0.6886711860670194
  Second-Tier acc 0.4897959183673469, precision 0.4333333333333333, recall 0.4772927689594357, F1 0.437411196362603, AUC 0.695216049382716
epoch: 6 idx: 0 First Loss : 2.631495475769043, Second Loss : 2.705070734024048
epoch: 6 idx: 200 First Loss : 0.9775325788083065, Second Loss : 0.9868496033126739
  First-Tier acc 0.5885416666666666, precision 0.5722222222222223, recall 0.5907828282828284, F1 0.5554920634920634, AUC 0.7510700757575757
  Second-Tier acc 0.5833333333333334, precision 0.5807017543859648, recall 0.5517171717171717, F1 0.5114933114933115, AUC 0.7607575757575757
  First-Tier acc 0.5663265306122449, precision 0.553954569610147, recall 0.6013007054673721, F1 0.5580072020833223, AUC 0.699332423941799
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.7141754850088183
epoch: 7 idx: 0 First Loss : 2.801523447036743, Second Loss : 2.882500410079956
epoch: 7 idx: 200 First Loss : 0.9598197799861727, Second Loss : 0.9677649998472104
  First-Tier acc 0.5572916666666666, precision 0.5851226829529627, recall 0.6068939393939394, F1 0.5529464874268873, AUC 0.7606123737373737
  Second-Tier acc 0.5208333333333334, precision 0.5524691358024691, recall 0.5431313131313131, F1 0.48623238623238624, AUC 0.7684343434343434
  First-Tier acc 0.5255102040816326, precision 0.5359687071886943, recall 0.5944664902998237, F1 0.5207267242403683, AUC 0.7096870866402116
  Second-Tier acc 0.5102040816326531, precision 0.5089285714285714, recall 0.5890652557319224, F1 0.4880225361380133, AUC 0.726741622574956
epoch: 8 idx: 0 First Loss : 2.9397268295288086, Second Loss : 3.0440375804901123
epoch: 8 idx: 200 First Loss : 0.948478358070278, Second Loss : 0.9538656711318896
  First-Tier acc 0.5208333333333334, precision 0.5781196581196582, recall 0.5931313131313131, F1 0.5223036285086285, AUC 0.7656313131313132
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7850505050505051
  First-Tier acc 0.4846938775510204, precision 0.5135945066285624, recall 0.5685074955908289, F1 0.48266129032258065, AUC 0.7193218143738976
  Second-Tier acc 0.46938775510204084, precision 0.48412698412698413, recall 0.564373897707231, F1 0.45800792983299293, AUC 0.7331900352733686
epoch: 9 idx: 0 First Loss : 3.048166275024414, Second Loss : 3.1763241291046143
epoch: 9 idx: 200 First Loss : 0.9406676874287537, Second Loss : 0.9441997342979285
  First-Tier acc 0.5052083333333334, precision 0.5692738791423002, recall 0.5825, F1 0.5071691176470589, AUC 0.7704419191919191
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.7973232323232323
  First-Tier acc 0.4846938775510204, precision 0.523698817349611, recall 0.5758377425044091, F1 0.4825841040619996, AUC 0.7270034171075839
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.738150352733686