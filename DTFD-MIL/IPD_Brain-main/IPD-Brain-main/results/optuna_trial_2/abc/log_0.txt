{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.33097058176471983, "droprate_2": 0.0, "lr": 0.0001546635978766065, "weight_decay": 1.874096274580286e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0001546635978766065
epoch: 0 idx: 0 First Loss : 1.147644281387329, Second Loss : 1.1999109983444214
epoch: 0 idx: 200 First Loss : 1.0785591199771682, Second Loss : 1.0621348133875956
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4932659932659933
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49000000000000005
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4505315500685871
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45706569664903
 
 test auc: 0.45706569664903, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.4798126011101696, "droprate_2": 0.0, "lr": 2.6585539647029385e-05, "weight_decay": 0.000356702726915722, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.6585539647029385e-05
epoch: 0 idx: 0 First Loss : 0.8979063034057617, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.0883454569240114, Second Loss : 1.0842076130767366
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49713804713804716
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48762626262626263
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4460795120517343
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.455191798941799
 
 test auc: 0.455191798941799, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.6585539647029385e-05
epoch: 1 idx: 0 First Loss : 1.942423939704895, Second Loss : 2.034435510635376
epoch: 1 idx: 200 First Loss : 1.060601658711386, Second Loss : 1.0650706128101444
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4976038159371492
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5006060606060606
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4499865275328238
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45403439153439157
 
 test auc: 0.45403439153439157, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.6585539647029385e-05
epoch: 2 idx: 0 First Loss : 2.0256474018096924, Second Loss : 2.1069822311401367
epoch: 2 idx: 200 First Loss : 1.035768849191381, Second Loss : 1.0407958467356602
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5020594837261504
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5048989898989898
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4571085635900451
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4593253968253968
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 3 idx: 0 First Loss : 2.0970351696014404, Second Loss : 2.192568302154541
epoch: 3 idx: 200 First Loss : 1.0150061541825384, Second Loss : 1.0208596902255396
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5028338945005612
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5005555555555555
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4660126396237507
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4679232804232804
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 4 idx: 0 First Loss : 2.194753408432007, Second Loss : 2.297344923019409
epoch: 4 idx: 200 First Loss : 0.9957192133537572, Second Loss : 1.003007843386178
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3055555555555556, precision 0.3252747252747253, recall 0.4158249158249158, F1 0.27839015637016146, AUC 0.4968237934904602
  Second-Tier acc 0.3125, precision 0.30952380952380953, recall 0.42676767676767674, F1 0.2926652142338417, AUC 0.49444444444444446
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09859154929577464, recall 0.3333333333333333, F1 0.15217391304347824, AUC 0.47664364099549283
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.47580467372134044
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 5 idx: 0 First Loss : 2.2900679111480713, Second Loss : 2.3824851512908936
epoch: 5 idx: 200 First Loss : 0.9748227668564711, Second Loss : 0.9861089624279175
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2916666666666667, precision 0.25148809523809523, recall 0.40319865319865317, F1 0.286971586971587, AUC 0.48365319865319867
  Second-Tier acc 0.2916666666666667, precision 0.2538902538902539, recall 0.404040404040404, F1 0.29066171923314776, AUC 0.4782323232323232
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2585034013605442, precision 0.35894170911148837, recall 0.3156231628453851, F1 0.21464142283419388, AUC 0.4944334215167549
  Second-Tier acc 0.2857142857142857, precision 0.3853383458646616, recall 0.3754409171075838, F1 0.31447963800904977, AUC 0.4858906525573192
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 6 idx: 0 First Loss : 2.399451971054077, Second Loss : 2.4778144359588623
epoch: 6 idx: 200 First Loss : 0.9556913250936797, Second Loss : 0.9701254663256863
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3055555555555556, precision 0.2318007662835249, recall 0.43013468013468015, F1 0.29903747313335205, AUC 0.482300785634119
  Second-Tier acc 0.2916666666666667, precision 0.23599439775910366, recall 0.4116161616161616, F1 0.2976190476190476, AUC 0.4633838383838384
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2857142857142857, precision 0.34058479532163743, recall 0.2947530864197531, F1 0.3008794747925183, AUC 0.5089040760337057
  Second-Tier acc 0.3469387755102041, precision 0.4074074074074074, recall 0.4138007054673722, F1 0.3926596279537456, AUC 0.5073302469135802
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 7 idx: 0 First Loss : 2.4927852153778076, Second Loss : 2.561854124069214
epoch: 7 idx: 200 First Loss : 0.9385286770316202, Second Loss : 0.9561989873054608
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2916666666666667, precision 0.3094969061070756, recall 0.38585858585858585, F1 0.29366815544009967, AUC 0.48954545454545456
  Second-Tier acc 0.2916666666666667, precision 0.32866256550467077, recall 0.3657575757575757, F1 0.2991013071895425, AUC 0.45575757575757575
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.2857142857142857, precision 0.32205022359821117, recall 0.2930629041740153, F1 0.2994447193358623, AUC 0.5240850970017638
  Second-Tier acc 0.32653061224489793, precision 0.3689839572192513, recall 0.37852733686067014, F1 0.36195286195286197, AUC 0.5257936507936508
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 8 idx: 0 First Loss : 2.5784645080566406, Second Loss : 2.6404290199279785
epoch: 8 idx: 200 First Loss : 0.9218404221149227, Second Loss : 0.9433631173228446
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2847222222222222, precision 0.2770750287890867, recall 0.37346801346801345, F1 0.27510727986777667, AUC 0.4950953984287318
  Second-Tier acc 0.2916666666666667, precision 0.31216931216931215, recall 0.3513131313131313, F1 0.28954248366013075, AUC 0.456969696969697
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3197278911564626, precision 0.3366023755039773, recall 0.31959141681363906, F1 0.32511784511784514, AUC 0.5326462375073486
  Second-Tier acc 0.3877551020408163, precision 0.4078947368421053, recall 0.47420634920634913, F1 0.42626811594202896, AUC 0.5383046737213405
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 9 idx: 0 First Loss : 2.674057722091675, Second Loss : 2.6986286640167236
epoch: 9 idx: 200 First Loss : 0.9069430814379483, Second Loss : 0.9321560542937831
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2916666666666667, precision 0.27858874975154047, recall 0.36912457912457913, F1 0.27443953959390316, AUC 0.49840628507295176
  Second-Tier acc 0.3125, precision 0.30215617715617715, recall 0.3671717171717172, F1 0.29068783068783066, AUC 0.46772727272727277
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.35374149659863946, precision 0.3517006802721088, recall 0.3656672545561434, F1 0.35664556194357516, AUC 0.5379004997060552
  Second-Tier acc 0.3877551020408163, precision 0.3962054457410495, recall 0.47420634920634913, F1 0.41717313386317595, AUC 0.5474537037037037
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 10 idx: 0 First Loss : 2.7221157550811768, Second Loss : 2.7448883056640625
epoch: 10 idx: 200 First Loss : 0.8936856051360197, Second Loss : 0.922592041318986
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.3027286047126078, recall 0.37680134680134686, F1 0.2900943396226415, AUC 0.5009034792368126
  Second-Tier acc 0.3333333333333333, precision 0.30252525252525253, recall 0.3974747474747475, F1 0.3042607825216521, AUC 0.4720707070707071
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.34202775077459685, recall 0.3621399176954732, F1 0.350628211436623, AUC 0.5427199686458946
  Second-Tier acc 0.4489795918367347, precision 0.42540792540792544, recall 0.5112433862433862, F1 0.4494605923177352, AUC 0.5528549382716049
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 11 idx: 0 First Loss : 2.7856760025024414, Second Loss : 2.7726001739501953
epoch: 11 idx: 200 First Loss : 0.8818981248366448, Second Loss : 0.913604232969124
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3194444444444444, precision 0.3014069264069264, recall 0.3764309764309765, F1 0.29376114081996435, AUC 0.5026767676767676
  Second-Tier acc 0.3333333333333333, precision 0.3004273504273504, recall 0.3974747474747475, F1 0.3005733005733006, AUC 0.4753535353535354
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.38095238095238093, precision 0.34997409997409995, recall 0.38425925925925924, F1 0.36281923968120594, AUC 0.5448878110915149
  Second-Tier acc 0.4489795918367347, precision 0.42070707070707075, recall 0.5112433862433862, F1 0.44308693377016367, AUC 0.5638778659611994
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 12 idx: 0 First Loss : 2.846637725830078, Second Loss : 2.793431520462036
epoch: 12 idx: 200 First Loss : 0.8713677095814576, Second Loss : 0.905216245657176
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.3030093602987536, recall 0.38653198653198656, F1 0.2977823977823978, AUC 0.5028956228956228
  Second-Tier acc 0.3541666666666667, precision 0.32051282051282054, recall 0.41080808080808073, F1 0.32075137338295234, AUC 0.47914141414141415
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.36054421768707484, precision 0.3173654423654424, recall 0.37022339800117576, F1 0.335792024625925, AUC 0.5480477170291985
  Second-Tier acc 0.42857142857142855, precision 0.38825757575757575, recall 0.4874338624338624, F1 0.41104308390022676, AUC 0.5717592592592592
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 13 idx: 0 First Loss : 2.8972299098968506, Second Loss : 2.81056547164917
epoch: 13 idx: 200 First Loss : 0.8617679992625814, Second Loss : 0.8979425447626939
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3402777777777778, precision 0.3162658329324996, recall 0.38976430976430976, F1 0.3103122320513625, AUC 0.5020145903479236
  Second-Tier acc 0.3541666666666667, precision 0.31908831908831914, recall 0.41080808080808073, F1 0.31718936982094875, AUC 0.4825252525252526
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3401360544217687, precision 0.2849543177129384, recall 0.35023515579071135, F1 0.3071703280479523, AUC 0.5518261316872429
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5749007936507936
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 14 idx: 0 First Loss : 2.9413681030273438, Second Loss : 2.817209005355835
epoch: 14 idx: 200 First Loss : 0.8529358866499431, Second Loss : 0.8909665000397916
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.3334134134134134, recall 0.39744107744107743, F1 0.32793183868716275, AUC 0.5034399551066218
  Second-Tier acc 0.375, precision 0.337037037037037, recall 0.4241414141414141, F1 0.3365893365893366, AUC 0.48277777777777775
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.2953333928943685, recall 0.3682392710170488, F1 0.31964429700278757, AUC 0.5526650989613953
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5699955908289241
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 15 idx: 0 First Loss : 2.9749433994293213, Second Loss : 2.827463150024414
epoch: 15 idx: 200 First Loss : 0.8448505124067934, Second Loss : 0.8845164001506952
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.375, precision 0.3465857161509336, recall 0.4063299663299664, F1 0.33866961887352715, AUC 0.5045903479236813
  Second-Tier acc 0.3958333333333333, precision 0.3608465608465608, recall 0.4374747474747474, F1 0.3536833536833537, AUC 0.48489898989898994
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3401360544217687, precision 0.26585171934009144, recall 0.3523662551440329, F1 0.2960042554522983, AUC 0.5526222320203802
  Second-Tier acc 0.3877551020408163, precision 0.30392156862745096, recall 0.4398148148148148, F1 0.3435294117647059, AUC 0.5659722222222222
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 16 idx: 0 First Loss : 3.0091638565063477, Second Loss : 2.834186553955078
epoch: 16 idx: 200 First Loss : 0.8368161005380365, Second Loss : 0.878731581127614
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3680555555555556, precision 0.3420812116464291, recall 0.39622895622895626, F1 0.33243908927851157, AUC 0.5051627384960719
  Second-Tier acc 0.4166666666666667, precision 0.36321548821548827, recall 0.43383838383838386, F1 0.3701902748414376, AUC 0.48843434343434344
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.26698394923478913, recall 0.3662551440329218, F1 0.2988546993211925, AUC 0.5532897315304722
  Second-Tier acc 0.3877551020408163, precision 0.30392156862745096, recall 0.4398148148148148, F1 0.3435294117647059, AUC 0.5648148148148148
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 17 idx: 0 First Loss : 3.0379550457000732, Second Loss : 2.8409202098846436
epoch: 17 idx: 200 First Loss : 0.8294541044716737, Second Loss : 0.8731640059111724
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.375, precision 0.34490740740740744, recall 0.4006734006734007, F1 0.3386759581881533, AUC 0.5057182940516274
  Second-Tier acc 0.4166666666666667, precision 0.36321548821548827, recall 0.43383838383838386, F1 0.3701902748414376, AUC 0.4912121212121212
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.36054421768707484, precision 0.26901669758812613, recall 0.3744855967078189, F1 0.30223686492110285, AUC 0.5541838134430727
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5669642857142857
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 18 idx: 0 First Loss : 3.0678341388702393, Second Loss : 2.842214345932007
epoch: 18 idx: 200 First Loss : 0.8224065157478276, Second Loss : 0.8678218741803917
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.34505050505050505, recall 0.39501683501683504, F1 0.3370246305418719, AUC 0.5078226711560044
  Second-Tier acc 0.3958333333333333, precision 0.34408939014202167, recall 0.4035353535353536, F1 0.35151515151515156, AUC 0.4952525252525253
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.26897435897435895, recall 0.38425925925925924, F1 0.3029689608636977, AUC 0.5557208994708994
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5677358906525574
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6585539647029385e-05
epoch: 19 idx: 0 First Loss : 3.0882136821746826, Second Loss : 2.837074041366577
epoch: 19 idx: 200 First Loss : 0.8156552669958244, Second Loss : 0.8623200503469848
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.35107376283846875, recall 0.3994612794612795, F1 0.3420217209690894, AUC 0.5060437710437711
  Second-Tier acc 0.4166666666666667, precision 0.35793650793650794, recall 0.41686868686868683, F1 0.3647173489278752, AUC 0.4955050505050506
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3673469387755102, precision 0.2753697093319735, recall 0.39814814814814814, F1 0.3106828655215752, AUC 0.5555861747991377
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5674052028218695
 
 test auc: 0.4593253968253968, test F1: 0.14814814814814814  :  from epoch 2{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.2463036775597213, "droprate_2": 0.0, "lr": 7.297771386937582e-05, "weight_decay": 0.0005345359559457924, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 7.297771386937582e-05
epoch: 0 idx: 0 First Loss : 0.9102988243103027, Second Loss : 1.0359355211257935
epoch: 0 idx: 200 First Loss : 1.1289218673806878, Second Loss : 1.1099756996874786
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5001346801346801
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4976767676767677
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45172570056829314
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.453317901234568
 
 test auc: 0.453317901234568, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 7.297771386937582e-05
epoch: 1 idx: 0 First Loss : 1.634341835975647, Second Loss : 2.0702157020568848
epoch: 1 idx: 200 First Loss : 1.0389649953266875, Second Loss : 1.0230412884286386
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5010774410774411
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.499040404040404
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4634406231628454
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4638447971781305
 
 test auc: 0.4638447971781305, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 7.297771386937582e-05
epoch: 2 idx: 0 First Loss : 1.9552656412124634, Second Loss : 2.397552013397217
epoch: 2 idx: 200 First Loss : 0.981192394053165, Second Loss : 0.9742835205956478
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.3541666666666667, precision 0.27844267139479906, recall 0.49579124579124584, F1 0.34949494949494947, AUC 0.4847250280583613
  Second-Tier acc 0.2916666666666667, precision 0.2626262626262626, recall 0.404040404040404, F1 0.30033670033670035, AUC 0.4776767676767677
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.272108843537415, precision 0.37685881370091895, recall 0.3034979423868313, F1 0.2902975444524733, AUC 0.48899544385655497
  Second-Tier acc 0.32653061224489793, precision 0.405665853941716, recall 0.41291887125220456, F1 0.37682098543211656, AUC 0.4831900352733685
 
 test auc: 0.4638447971781305, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 7.297771386937582e-05
epoch: 3 idx: 0 First Loss : 2.4653561115264893, Second Loss : 2.916362762451172
epoch: 3 idx: 200 First Loss : 0.9453601792491787, Second Loss : 0.9429040980057337
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2847222222222222, precision 0.2817874396135266, recall 0.31942760942760945, F1 0.29059279333534077, AUC 0.4955218855218855
  Second-Tier acc 0.2916666666666667, precision 0.2846153846153846, recall 0.31737373737373736, F1 0.2960683760683761, AUC 0.4917676767676768
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3469387755102041, precision 0.3509186891539833, recall 0.4201940035273368, F1 0.36151249668145785, AUC 0.5222234469919655
  Second-Tier acc 0.40816326530612246, precision 0.41374930539017224, recall 0.4865520282186948, F1 0.43166588748636436, AUC 0.5260692239858907
 
 test auc: 0.4638447971781305, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 7.297771386937582e-05
epoch: 4 idx: 0 First Loss : 2.968153238296509, Second Loss : 3.3980040550231934
epoch: 4 idx: 200 First Loss : 0.9301535590408156, Second Loss : 0.9343277822475676
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3194444444444444, precision 0.2935982821996579, recall 0.3651178451178451, F1 0.2967056484005636, AUC 0.5022671156004489
  Second-Tier acc 0.3125, precision 0.2773809523809524, recall 0.3671717171717172, F1 0.2872016872016872, AUC 0.5026767676767676
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.38095238095238093, precision 0.34724788754639496, recall 0.4195326278659612, F1 0.36484790832616926, AUC 0.5381393298059965
  Second-Tier acc 0.42857142857142855, precision 0.4114285714285714, recall 0.44025573192239853, F1 0.42328042328042326, AUC 0.5449735449735449
 
 test auc: 0.5449735449735449, test F1: 0.42328042328042326  :  from epoch 4
 current learn rate 7.297771386937582e-05
epoch: 5 idx: 0 First Loss : 3.272012948989868, Second Loss : 3.7955868244171143
epoch: 5 idx: 200 First Loss : 0.9248331081844977, Second Loss : 0.9334490363722416
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.3322344322344322, recall 0.38612794612794615, F1 0.3284318593264229, AUC 0.5038608305274973
  Second-Tier acc 0.3125, precision 0.28703703703703703, recall 0.3671717171717172, F1 0.2797308586782271, AUC 0.5133838383838384
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.35374149659863946, precision 0.2980550541056003, recall 0.38778659611992944, F1 0.3206971509421828, AUC 0.5456104252400549
  Second-Tier acc 0.32653061224489793, precision 0.26406926406926406, recall 0.3148148148148148, F1 0.2858054226475279, AUC 0.5642085537918872
 
 test auc: 0.5642085537918872, test F1: 0.2858054226475279  :  from epoch 5
 current learn rate 7.297771386937582e-05
epoch: 6 idx: 0 First Loss : 3.42880916595459, Second Loss : 3.986187696456909
epoch: 6 idx: 200 First Loss : 0.9226100994969038, Second Loss : 0.9335647195633223
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.375, precision 0.34313725490196084, recall 0.3893602693602694, F1 0.3376283846872082, AUC 0.5258698092031425
  Second-Tier acc 0.3541666666666667, precision 0.3319088319088319, recall 0.3938383838383838, F1 0.31671521145205356, AUC 0.5356565656565656
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.32653061224489793, precision 0.24872414719312383, recall 0.34413580246913583, F1 0.27619047619047615, AUC 0.5388803155006859
  Second-Tier acc 0.32653061224489793, precision 0.25396825396825395, recall 0.3148148148148148, F1 0.2787878787878788, AUC 0.5610670194003528
 
 test auc: 0.5610670194003528, test F1: 0.2787878787878788  :  from epoch 6
 current learn rate 7.297771386937582e-05
epoch: 7 idx: 0 First Loss : 3.5333144664764404, Second Loss : 4.074583530426025
epoch: 7 idx: 200 First Loss : 0.9198111830179612, Second Loss : 0.9310038546806859
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4166666666666667, precision 0.37319624819624825, recall 0.416026936026936, F1 0.36879809767411764, AUC 0.5435970819304153
  Second-Tier acc 0.3333333333333333, precision 0.3190883190883191, recall 0.36353535353535354, F1 0.29869719343403556, AUC 0.543989898989899
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3129251700680272, precision 0.2374777523518942, recall 0.33590534979423864, F1 0.26123456790123456, AUC 0.5279859886341368
  Second-Tier acc 0.32653061224489793, precision 0.25396825396825395, recall 0.3148148148148148, F1 0.2787878787878788, AUC 0.5402888007054674
 
 test auc: 0.5402888007054674, test F1: 0.2787878787878788  :  from epoch 7
 current learn rate 7.297771386937582e-05
epoch: 8 idx: 0 First Loss : 3.5691945552825928, Second Loss : 4.127921104431152
epoch: 8 idx: 200 First Loss : 0.915937912992123, Second Loss : 0.9276523765336389
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4305555555555556, precision 0.38289150167304453, recall 0.437070707070707, F1 0.3731139953989456, AUC 0.5715656565656566
  Second-Tier acc 0.3958333333333333, precision 0.4185185185185185, recall 0.45444444444444443, F1 0.3478627223247022, AUC 0.5584848484848485
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.32653061224489793, precision 0.2381818181818182, recall 0.3245884773662551, F1 0.2647964420116319, AUC 0.5157382912012541
  Second-Tier acc 0.32653061224489793, precision 0.24444444444444446, recall 0.2854938271604938, F1 0.2631578947368421, AUC 0.5271715167548501
 
 test auc: 0.5271715167548501, test F1: 0.2631578947368421  :  from epoch 8
 current learn rate 7.297771386937582e-05
epoch: 9 idx: 0 First Loss : 3.599980115890503, Second Loss : 4.17813777923584
epoch: 9 idx: 200 First Loss : 0.9117833172667318, Second Loss : 0.9251136331632501
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4722222222222222, precision 0.416090701535907, recall 0.4693939393939394, F1 0.40314465408805034, AUC 0.5881200897867566
  Second-Tier acc 0.4166666666666667, precision 0.4305555555555556, recall 0.4677777777777778, F1 0.36457607433217193, AUC 0.5740909090909091
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3129251700680272, precision 0.22290598290598293, recall 0.29681069958847733, F1 0.24584962320811377, AUC 0.5052481383499902
  Second-Tier acc 0.2857142857142857, precision 0.20000000000000004, recall 0.23148148148148148, F1 0.21442495126705652, AUC 0.5220458553791887
 
 test auc: 0.5220458553791887, test F1: 0.21442495126705652  :  from epoch 9
 current learn rate 7.297771386937582e-05
epoch: 10 idx: 0 First Loss : 3.581664800643921, Second Loss : 4.18772554397583
epoch: 10 idx: 200 First Loss : 0.9083880985225783, Second Loss : 0.9215512860781254
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4583333333333333, precision 0.4165768871651225, recall 0.46616161616161617, F1 0.39407606023552466, AUC 0.5980415263748596
  Second-Tier acc 0.4375, precision 0.4408307210031348, recall 0.48111111111111104, F1 0.38333333333333336, AUC 0.5828787878787879
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3197278911564626, precision 0.21985094850948508, recall 0.2911522633744856, F1 0.24392183594637581, AUC 0.49665637860082307
  Second-Tier acc 0.2857142857142857, precision 0.18888888888888888, recall 0.23148148148148148, F1 0.2070175438596491, AUC 0.5172508818342151
 
 test auc: 0.5172508818342151, test F1: 0.2070175438596491  :  from epoch 10
 current learn rate 7.297771386937582e-05
epoch: 11 idx: 0 First Loss : 3.6105613708496094, Second Loss : 4.123286724090576
epoch: 11 idx: 200 First Loss : 0.9083275102575272, Second Loss : 0.9214847560066137
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4791666666666667, precision 0.4632183908045977, recall 0.4964646464646465, F1 0.41086810792693146, AUC 0.6077721661054994
  Second-Tier acc 0.4166666666666667, precision 0.4305555555555556, recall 0.4677777777777778, F1 0.36457607433217193, AUC 0.5920707070707071
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.2857142857142857, precision 0.17939078465394254, recall 0.22170781893004113, F1 0.19717429357339333, AUC 0.48384528708602775
  Second-Tier acc 0.2653061224489796, precision 0.16236559139784945, recall 0.1898148148148148, F1 0.17496807151979565, AUC 0.5183531746031745
 
 test auc: 0.5183531746031745, test F1: 0.17496807151979565  :  from epoch 11
 current learn rate 7.297771386937582e-05
epoch: 12 idx: 0 First Loss : 3.5726823806762695, Second Loss : 4.2465739250183105
epoch: 12 idx: 200 First Loss : 0.9073954326089353, Second Loss : 0.9200303098408387
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4722222222222222, precision 0.46610486891385766, recall 0.492020202020202, F1 0.40571604265369726, AUC 0.6190740740740741
  Second-Tier acc 0.4166666666666667, precision 0.4305555555555556, recall 0.4677777777777778, F1 0.36457607433217193, AUC 0.6056565656565657
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.29931972789115646, precision 0.1891941391941392, recall 0.2397119341563786, F1 0.20978682170542637, AUC 0.4729632079169117
  Second-Tier acc 0.32653061224489793, precision 0.18872549019607843, recall 0.22685185185185186, F1 0.20560109289617487, AUC 0.5062830687830687
 
 test auc: 0.5062830687830687, test F1: 0.20560109289617487  :  from epoch 12
 current learn rate 7.297771386937582e-05
epoch: 13 idx: 0 First Loss : 3.423149824142456, Second Loss : 4.090915679931641
epoch: 13 idx: 200 First Loss : 0.9029137488677276, Second Loss : 0.9159635070357205
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4652777777777778, precision 0.47322109621880787, recall 0.48757575757575755, F1 0.40002359882005906, AUC 0.6311335578002244
  Second-Tier acc 0.4166666666666667, precision 0.43256528417818735, recall 0.4677777777777778, F1 0.3620718462823726, AUC 0.6216161616161617
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3197278911564626, precision 0.19514170040485831, recall 0.25205761316872427, F1 0.21879509379509376, AUC 0.4594417499510091
  Second-Tier acc 0.32653061224489793, precision 0.18872549019607843, recall 0.22685185185185186, F1 0.20560109289617487, AUC 0.49514991181657847
 
 test auc: 0.49514991181657847, test F1: 0.20560109289617487  :  from epoch 13
 current learn rate 7.297771386937582e-05
epoch: 14 idx: 0 First Loss : 3.271773099899292, Second Loss : 3.9903907775878906
epoch: 14 idx: 200 First Loss : 0.8969021111400103, Second Loss : 0.9122126139586024
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4652777777777778, precision 0.48273609555804403, recall 0.48757575757575755, F1 0.39908659094604326, AUC 0.6357182940516274
  Second-Tier acc 0.375, precision 0.446031746031746, recall 0.44111111111111106, F1 0.3214573268921095, AUC 0.6307070707070707
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3197278911564626, precision 0.19499269005847952, recall 0.25205761316872427, F1 0.21894174108498876, AUC 0.4435381148344111
  Second-Tier acc 0.32653061224489793, precision 0.19047619047619047, recall 0.22685185185185186, F1 0.2057347670250896, AUC 0.46208112874779544
 
 test auc: 0.46208112874779544, test F1: 0.2057347670250896  :  from epoch 14
 current learn rate 7.297771386937582e-05
epoch: 15 idx: 0 First Loss : 3.1684458255767822, Second Loss : 3.919571876525879
epoch: 15 idx: 200 First Loss : 0.8954475656961466, Second Loss : 0.9067338708662475
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4652777777777778, precision 0.4907407407407407, recall 0.49323232323232324, F1 0.3992335358614428, AUC 0.6346913580246913
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6392424242424243
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3197278911564626, precision 0.1876190476190476, recall 0.24228395061728394, F1 0.211193307737928, AUC 0.4324661963550853
  Second-Tier acc 0.32653061224489793, precision 0.1865079365079365, recall 0.22685185185185186, F1 0.20317460317460315, AUC 0.4533179012345679
 
 test auc: 0.4533179012345679, test F1: 0.20317460317460315  :  from epoch 15
 current learn rate 7.297771386937582e-05
epoch: 16 idx: 0 First Loss : 3.104820966720581, Second Loss : 3.869974374771118
epoch: 16 idx: 200 First Loss : 0.8887561993712972, Second Loss : 0.9021780227129382
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4444444444444444, precision 0.5022875816993464, recall 0.4855555555555555, F1 0.38240740740740736, AUC 0.6358473625140292
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6375757575757576
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3197278911564626, precision 0.17328370554177006, recall 0.2227366255144033, F1 0.19492219492219495, AUC 0.42348863413678234
  Second-Tier acc 0.32653061224489793, precision 0.1865079365079365, recall 0.22685185185185186, F1 0.20317460317460315, AUC 0.4443893298059965
 
 test auc: 0.4533179012345679, test F1: 0.20317460317460315  :  from epoch 15
 current learn rate 7.297771386937582e-05
epoch: 17 idx: 0 First Loss : 3.112281560897827, Second Loss : 3.821305513381958
epoch: 17 idx: 200 First Loss : 0.8865500592364697, Second Loss : 0.8964013796413288
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4305555555555556, precision 0.4932430029517409, recall 0.4766666666666666, F1 0.3708658220569781, AUC 0.6377833894500561
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6393939393939394
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.32653061224489793, precision 0.18279886241051288, recall 0.23662551440329216, F1 0.20620391558606663, AUC 0.418252743484225
  Second-Tier acc 0.3469387755102041, precision 0.19176319176319176, recall 0.2391975308641975, F1 0.2111111111111111, AUC 0.43871252204585537
 
 test auc: 0.43871252204585537, test F1: 0.2111111111111111  :  from epoch 17
 current learn rate 7.297771386937582e-05
epoch: 18 idx: 0 First Loss : 3.0539910793304443, Second Loss : 3.757744312286377
epoch: 18 idx: 200 First Loss : 0.8830859851293293, Second Loss : 0.8908084443336977
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4236111111111111, precision 0.49673721340388005, recall 0.47222222222222215, F1 0.3644856493321966, AUC 0.641358024691358
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6449494949494949
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.1858974358974359, recall 0.24074074074074073, F1 0.20978120978120982, AUC 0.4133720360572213
  Second-Tier acc 0.3469387755102041, precision 0.19176319176319176, recall 0.2391975308641975, F1 0.2111111111111111, AUC 0.43584656084656087
 
 test auc: 0.43584656084656087, test F1: 0.2111111111111111  :  from epoch 18
 current learn rate 7.297771386937582e-05
epoch: 19 idx: 0 First Loss : 3.115785837173462, Second Loss : 3.7047040462493896
epoch: 19 idx: 200 First Loss : 0.881394019243804, Second Loss : 0.8838298120105869
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4236111111111111, precision 0.49673721340388005, recall 0.47222222222222215, F1 0.3644856493321966, AUC 0.6448989898989899
  Second-Tier acc 0.375, precision 0.446031746031746, recall 0.44111111111111106, F1 0.3214573268921095, AUC 0.6496464646464646
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.18946540880503146, recall 0.24897119341563786, F1 0.21517697988286222, AUC 0.4078850676072898
  Second-Tier acc 0.3469387755102041, precision 0.19176319176319176, recall 0.2391975308641975, F1 0.2111111111111111, AUC 0.42697310405643735
 
 test auc: 0.42697310405643735, test F1: 0.2111111111111111  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.338125097749074, "droprate_2": 0.0, "lr": 1.0044738103256931e-05, "weight_decay": 2.9990294515577e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.0044738103256931e-05
epoch: 0 idx: 0 First Loss : 1.224414348602295, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0541171536813327, Second Loss : 1.0358293265549106
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.66337822671156
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7496464646464647
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.601839604154419
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6063712522045855
 
 test auc: 0.6063712522045855, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.0044738103256931e-05
epoch: 1 idx: 0 First Loss : 1.948378562927246, Second Loss : 1.9021470546722412
epoch: 1 idx: 200 First Loss : 1.101312701233584, Second Loss : 1.0878725301715273
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7037429854096521
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.76010101010101
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.644039045659416
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6510692239858907
 
 test auc: 0.6510692239858907, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.0044738103256931e-05
epoch: 2 idx: 0 First Loss : 2.1056277751922607, Second Loss : 2.0782036781311035
epoch: 2 idx: 200 First Loss : 1.1019957474066844, Second Loss : 1.0870831011243127
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.719702581369248
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7616666666666667
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6746460415441898
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6871693121693122
 
 test auc: 0.6871693121693122, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.0044738103256931e-05
epoch: 3 idx: 0 First Loss : 2.1650078296661377, Second Loss : 2.135589599609375
epoch: 3 idx: 200 First Loss : 1.0915946682442481, Second Loss : 1.0766048544823235
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.731408529741863
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7658080808080808
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6926930237115423
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7046406525573191
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 4 idx: 0 First Loss : 2.2304575443267822, Second Loss : 2.193162441253662
epoch: 4 idx: 200 First Loss : 1.0814464641595953, Second Loss : 1.066358391325272
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399887766554434
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7615656565656566
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7031770527140897
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7090498236331569
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 5 idx: 0 First Loss : 2.3003578186035156, Second Loss : 2.2594733238220215
epoch: 5 idx: 200 First Loss : 1.0712279975043602, Second Loss : 1.056416388063585
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7406060606060606
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7526767676767676
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7107155104840291
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7149470899470899
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 6 idx: 0 First Loss : 2.3790876865386963, Second Loss : 2.327861785888672
epoch: 6 idx: 200 First Loss : 1.0595009588261148, Second Loss : 1.0450572891170113
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7385970819304152
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7494444444444444
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7131099353321576
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7097111992945327
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 7 idx: 0 First Loss : 2.46761155128479, Second Loss : 2.4058656692504883
epoch: 7 idx: 200 First Loss : 1.045783924411482, Second Loss : 1.0317565901436616
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5902777777777778, precision 0.41534391534391535, recall 0.44565656565656564, F1 0.3989854648326993, AUC 0.7364702581369248
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7514646464646465
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5850340136054422, precision 0.6109112709832134, recall 0.3968253968253968, F1 0.35518539431582913, AUC 0.7089150989613953
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7122464726631392
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 8 idx: 0 First Loss : 2.5644733905792236, Second Loss : 2.491927146911621
epoch: 8 idx: 200 First Loss : 1.0304752971921394, Second Loss : 1.0174076024869187
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.625, precision 0.5707070707070707, recall 0.5057912457912458, F1 0.4690833690833691, AUC 0.7363355780022447
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.754040404040404
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6598639455782312, precision 0.6867623117623117, recall 0.5449000587889476, F1 0.5638172407682389, AUC 0.7011561826376641
  Second-Tier acc 0.6122448979591837, precision 0.5404040404040403, recall 0.45701058201058203, F1 0.4539682539682539, AUC 0.7108686067019399
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 9 idx: 0 First Loss : 2.672640562057495, Second Loss : 2.589301586151123
epoch: 9 idx: 200 First Loss : 1.0145750685562542, Second Loss : 1.0025429889114934
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6597222222222222, precision 0.6128533971728226, recall 0.5956565656565657, F1 0.5796390013495277, AUC 0.7321324354657688
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7548484848484849
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5986394557823129, precision 0.5598290598290598, recall 0.5813492063492064, F1 0.567978880347853, AUC 0.7019706545169507
  Second-Tier acc 0.5918367346938775, precision 0.5615079365079365, recall 0.531305114638448, F1 0.5238095238095238, AUC 0.7102072310405644
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 10 idx: 0 First Loss : 2.7883174419403076, Second Loss : 2.6989898681640625
epoch: 10 idx: 200 First Loss : 1.0003344371951932, Second Loss : 0.9892447638089088
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5972222222222222, precision 0.5590154032014497, recall 0.565892255892256, F1 0.5586539017606948, AUC 0.7277890011223344
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7518181818181818
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5714285714285714, precision 0.5311288170675446, recall 0.5648883009994121, F1 0.5373091985995212, AUC 0.7057306976288458
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.7263007054673721
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 11 idx: 0 First Loss : 2.9040515422821045, Second Loss : 2.8152077198028564
epoch: 11 idx: 200 First Loss : 0.9876917761319609, Second Loss : 0.9776317158630535
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5555555555555556, precision 0.5420899854862119, recall 0.5511447811447812, F1 0.5316459740285273, AUC 0.7273681257014589
  Second-Tier acc 0.5208333333333334, precision 0.5528846153846154, recall 0.5293939393939394, F1 0.48465538709441147, AUC 0.7652525252525253
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4965986394557823, precision 0.4803349315544437, recall 0.5260141093474426, F1 0.46971981493224363, AUC 0.707592347638644
  Second-Tier acc 0.6530612244897959, precision 0.6565656565656566, recall 0.7149470899470899, F1 0.6639146886824906, AUC 0.7412918871252204
 
 test auc: 0.7046406525573191, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0044738103256931e-05
epoch: 12 idx: 0 First Loss : 3.0133650302886963, Second Loss : 2.9287467002868652
epoch: 12 idx: 200 First Loss : 0.9773390185347393, Second Loss : 0.9684725343643581
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5069444444444444, precision 0.5278910916253653, recall 0.5296632996632996, F1 0.4947046010364324, AUC 0.7277328843995511
  Second-Tier acc 0.5, precision 0.5598204264870931, recall 0.5474747474747474, F1 0.48183590288853456, AUC 0.7791919191919191
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46258503401360546, precision 0.47753753338859717, recall 0.5190329218106996, F1 0.4498689138576779, AUC 0.7135875955320401
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7572751322751322
 
 test auc: 0.7572751322751322, test F1: 0.5841269841269842  :  from epoch 12
 current learn rate 1.0044738103256931e-05
epoch: 13 idx: 0 First Loss : 3.1148831844329834, Second Loss : 3.0340895652770996
epoch: 13 idx: 200 First Loss : 0.9689242276386242, Second Loss : 0.9609669226022503
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4722222222222222, precision 0.5123901695353601, recall 0.5065993265993266, F1 0.46234562981784205, AUC 0.7304826038159371
  Second-Tier acc 0.5208333333333334, precision 0.5871794871794872, recall 0.5896969696969697, F1 0.5166137566137566, AUC 0.792121212121212
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.48269967580312406, recall 0.5146237507348618, F1 0.44094497466713795, AUC 0.7165209190672153
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7620149911816579
 
 test auc: 0.7620149911816579, test F1: 0.5454545454545454  :  from epoch 13
 current learn rate 1.0044738103256931e-05
epoch: 14 idx: 0 First Loss : 3.2020275592803955, Second Loss : 3.125988245010376
epoch: 14 idx: 200 First Loss : 0.961903072597079, Second Loss : 0.9546029183698531
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4583333333333333, precision 0.5201774912799682, recall 0.5025252525252525, F1 0.44969283053395204, AUC 0.7375701459034794
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.7992424242424242
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.42857142857142855, precision 0.4720169974407263, recall 0.5022780717225162, F1 0.4242355857326378, AUC 0.7218609151479521
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7682980599647267
 
 test auc: 0.7682980599647267, test F1: 0.5454545454545454  :  from epoch 14
 current learn rate 1.0044738103256931e-05
epoch: 15 idx: 0 First Loss : 3.2813236713409424, Second Loss : 3.2073264122009277
epoch: 15 idx: 200 First Loss : 0.9561552466611513, Second Loss : 0.9494524127178228
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.5018282111899133, recall 0.4839057239057239, F1 0.42117283950617285, AUC 0.742020202020202
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8113636363636362
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.4966051492367282, recall 0.52608759553204, F1 0.4482163406214039, AUC 0.725522976680384
  Second-Tier acc 0.5306122448979592, precision 0.5907608695652175, recall 0.6408730158730159, F1 0.5367867867867869, AUC 0.7746362433862434
 
 test auc: 0.7746362433862434, test F1: 0.5367867867867869  :  from epoch 15
 current learn rate 1.0044738103256931e-05
epoch: 16 idx: 0 First Loss : 3.3523619174957275, Second Loss : 3.2796130180358887
epoch: 16 idx: 200 First Loss : 0.9512261524611149, Second Loss : 0.945201087057294
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5136047172492185, recall 0.48474747474747476, F1 0.4239538239538239, AUC 0.7452188552188552
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8146969696969698
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5221897525813364, recall 0.5337301587301587, F1 0.44864690819774133, AUC 0.7295096021947874
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7750771604938271
 
 test auc: 0.7750771604938271, test F1: 0.53203007518797  :  from epoch 16
 current learn rate 1.0044738103256931e-05
epoch: 17 idx: 0 First Loss : 3.4134628772735596, Second Loss : 3.340711832046509
epoch: 17 idx: 200 First Loss : 0.9470656891237592, Second Loss : 0.9416834969462743
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5140842277274061, recall 0.48198653198653196, F1 0.42162070733499313, AUC 0.747020202020202
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8162626262626262
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4557823129251701, precision 0.5390211640211641, recall 0.545487948265726, F1 0.45703727974370184, AUC 0.7341576033705662
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7767305996472663
 
 test auc: 0.7767305996472663, test F1: 0.53203007518797  :  from epoch 17
 current learn rate 1.0044738103256931e-05
epoch: 18 idx: 0 First Loss : 3.465235710144043, Second Loss : 3.3905794620513916
epoch: 18 idx: 200 First Loss : 0.9436795233484747, Second Loss : 0.9380258552669849
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.532375478927203, recall 0.52, F1 0.43765915971963, AUC 0.7518462401795736
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.814040404040404
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.5519426676143094, recall 0.5490152851263962, F1 0.4511540701907674, AUC 0.7375379678620421
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7771164021164022
 
 test auc: 0.7767305996472663, test F1: 0.53203007518797  :  from epoch 17
 current learn rate 1.0044738103256931e-05
epoch: 19 idx: 0 First Loss : 3.5018575191497803, Second Loss : 3.4316041469573975
epoch: 19 idx: 200 First Loss : 0.9397549112744407, Second Loss : 0.9348628230448535
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4375, precision 0.5359083795703514, recall 0.5313131313131313, F1 0.43719721139075984, AUC 0.7545622895622895
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8143434343434345
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46258503401360546, precision 0.5633050439388468, recall 0.564888300999412, F1 0.4660907430818935, AUC 0.7412551440329218
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7823522927689593
 
 test auc: 0.7767305996472663, test F1: 0.53203007518797  :  from epoch 17{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.27720550605242245, "droprate_2": 0.0, "lr": 0.00014895938362058787, "weight_decay": 1.736528588392039e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.4296935672550469, "droprate_2": 0.0, "lr": 3.583971498476597e-05, "weight_decay": 1.7020280867423428e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00014895938362058787
epoch: 0 idx: 0 First Loss : 1.2297786474227905, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.095247564364725, Second Loss : 1.0800038240293959
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7588776655443321
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7714646464646465
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7249779541446207
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138447971781305
 
 test auc: 0.7138447971781305, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014895938362058787
epoch: 1 idx: 0 First Loss : 1.7614728212356567, Second Loss : 1.7075852155685425
epoch: 1 idx: 200 First Loss : 0.9969503311672021, Second Loss : 0.9894497313754476
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7410606060606061
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7581313131313131
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7188969723691946
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7199074074074074
 
 test auc: 0.7138447971781305, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014895938362058787
epoch: 2 idx: 0 First Loss : 2.1568567752838135, Second Loss : 2.2413229942321777
epoch: 2 idx: 200 First Loss : 0.9538492817264884, Second Loss : 0.9445197232327058
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6111111111111112, precision 0.5420602789023842, recall 0.5088215488215488, F1 0.508035350583568, AUC 0.7371380471380471
  Second-Tier acc 0.6458333333333334, precision 0.6004901960784313, recall 0.5415151515151515, F1 0.5464367132520567, AUC 0.7490404040404041
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6054421768707483, precision 0.5511551155115512, recall 0.5434303350970017, F1 0.5188974499319327, AUC 0.7088171173819321
  Second-Tier acc 0.6122448979591837, precision 0.5668767507002801, recall 0.5513668430335097, F1 0.5440085870413739, AUC 0.7330246913580248
 
 test auc: 0.7138447971781305, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014895938362058787
epoch: 3 idx: 0 First Loss : 2.4116547107696533, Second Loss : 2.599839448928833
epoch: 3 idx: 200 First Loss : 0.9229529596568636, Second Loss : 0.9184583893314523
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5902777777777778, precision 0.5843833943833944, recall 0.6106734006734006, F1 0.5771382604323781, AUC 0.7443322109988776
  Second-Tier acc 0.625, precision 0.6174906964380649, recall 0.6318181818181818, F1 0.6079247084498397, AUC 0.7634343434343434
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.5354575163398693, recall 0.5835537918871253, F1 0.5391689885670932, AUC 0.706900352733686
  Second-Tier acc 0.5714285714285714, precision 0.5520467836257311, recall 0.6197089947089948, F1 0.5582208895552224, AUC 0.7470789241622575
 
 test auc: 0.7138447971781305, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014895938362058787
epoch: 4 idx: 0 First Loss : 2.5660741329193115, Second Loss : 2.7556660175323486
epoch: 4 idx: 200 First Loss : 0.9021361095191383, Second Loss : 0.8978653519196593
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5069444444444444, precision 0.5504180651239475, recall 0.5502356902356902, F1 0.49397434817995567, AUC 0.7463355780022448
  Second-Tier acc 0.5416666666666666, precision 0.5663650075414781, recall 0.5784848484848485, F1 0.5358395989974937, AUC 0.7722222222222221
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46258503401360546, precision 0.48095238095238096, recall 0.4790564373897707, F1 0.44601271678576354, AUC 0.7128282382912013
  Second-Tier acc 0.5102040816326531, precision 0.5340160355640232, recall 0.6234567901234568, F1 0.5147351652727997, AUC 0.7623456790123457
 
 test auc: 0.7623456790123457, test F1: 0.5147351652727997  :  from epoch 4
 current learn rate 0.00014895938362058787
epoch: 5 idx: 0 First Loss : 2.889540672302246, Second Loss : 3.1115498542785645
epoch: 5 idx: 200 First Loss : 0.8977556526614585, Second Loss : 0.8863594389719823
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4583333333333333, precision 0.530982905982906, recall 0.5295959595959596, F1 0.45096764299474046, AUC 0.7482210998877665
  Second-Tier acc 0.4791666666666667, precision 0.5282051282051282, recall 0.535959595959596, F1 0.47145002145002146, AUC 0.7814646464646465
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.5062758522322065, recall 0.5056584362139916, F1 0.4416755738789637, AUC 0.7132385361552028
  Second-Tier acc 0.5102040816326531, precision 0.595108695652174, recall 0.6234567901234568, F1 0.5077787464884239, AUC 0.7757385361552028
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 6 idx: 0 First Loss : 2.8270657062530518, Second Loss : 3.084017038345337
epoch: 6 idx: 200 First Loss : 0.8882387796583683, Second Loss : 0.877128146148625
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4305555555555556, precision 0.5059942869698967, recall 0.4973737373737373, F1 0.41770498312487586, AUC 0.7281930415263749
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5421212121212121, F1 0.4573481116584565, AUC 0.7728787878787878
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.516155522037875, recall 0.4600235155790711, F1 0.4073817875569292, AUC 0.6974451303155007
  Second-Tier acc 0.4897959183673469, precision 0.5806159420289855, recall 0.58179012345679, F1 0.48627337014433786, AUC 0.7768959435626103
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 7 idx: 0 First Loss : 2.838146924972534, Second Loss : 3.0729150772094727
epoch: 7 idx: 200 First Loss : 0.8841794803495339, Second Loss : 0.8705635028937599
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3402777777777778, precision 0.41656184486373166, recall 0.40191919191919184, F1 0.29320263087775394, AUC 0.7104152637485971
  Second-Tier acc 0.3958333333333333, precision 0.47326762246117077, recall 0.4519191919191919, F1 0.3636363636363636, AUC 0.7440909090909091
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.5068158989812024, recall 0.42798353909465026, F1 0.3673436492585429, AUC 0.675705467372134
  Second-Tier acc 0.42857142857142855, precision 0.5426929392446633, recall 0.48478835978835977, F1 0.3981677237491191, AUC 0.7751873897707231
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 8 idx: 0 First Loss : 2.8218517303466797, Second Loss : 3.0649924278259277
epoch: 8 idx: 200 First Loss : 0.884152145833889, Second Loss : 0.8659683606490048
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.4504316346421609, recall 0.41164983164983165, F1 0.29521919879062736, AUC 0.7000056116722785
  Second-Tier acc 0.3125, precision 0.40357142857142864, recall 0.3841414141414141, F1 0.26714975845410627, AUC 0.7242424242424242
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4421768707482993, precision 0.5229437229437229, recall 0.44584068195179305, F1 0.37112010796221323, AUC 0.6569542426023908
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7671957671957671
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 9 idx: 0 First Loss : 2.799222946166992, Second Loss : 2.978032112121582
epoch: 9 idx: 200 First Loss : 0.881396180606651, Second Loss : 0.8621703780439233
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3541666666666667, precision 0.4201345755693582, recall 0.41249158249158246, F1 0.2842956592956593, AUC 0.670763187429854
  Second-Tier acc 0.3333333333333333, precision 0.4213213213213214, recall 0.4144444444444444, F1 0.2787037037037037, AUC 0.6885353535353534
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5069337442218799, recall 0.41931216931216925, F1 0.32597402597402597, AUC 0.646813149127964
  Second-Tier acc 0.3673469387755102, precision 0.5, recall 0.40057319223985893, F1 0.29716256557400805, AUC 0.7358906525573192
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 10 idx: 0 First Loss : 2.7972867488861084, Second Loss : 2.8866705894470215
epoch: 10 idx: 200 First Loss : 0.8789066372425365, Second Loss : 0.8585531498434078
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3402777777777778, precision 0.4351935646053293, recall 0.4140740740740741, F1 0.2771014492753623, AUC 0.6606734006734006
  Second-Tier acc 0.3125, precision 0.4106837606837606, recall 0.40111111111111114, F1 0.2548478701825558, AUC 0.6757070707070706
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.38095238095238093, precision 0.5050287356321839, recall 0.40498236331569665, F1 0.3145042194092827, AUC 0.6477378502841465
  Second-Tier acc 0.3673469387755102, precision 0.5, recall 0.40057319223985893, F1 0.29716256557400805, AUC 0.7215057319223986
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 11 idx: 0 First Loss : 2.7371513843536377, Second Loss : 2.9223921298980713
epoch: 11 idx: 200 First Loss : 0.8839481804874351, Second Loss : 0.8558568300042807
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.4614942528735632, recall 0.4274074074074074, F1 0.2972522826284748, AUC 0.6524971941638608
  Second-Tier acc 0.2916666666666667, precision 0.42063492063492064, recall 0.3877777777777778, F1 0.2304282719377059, AUC 0.6728787878787879
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.5303418803418803, recall 0.4353321575543798, F1 0.35987777571935986, AUC 0.6390052420145013
  Second-Tier acc 0.3469387755102041, precision 0.4365079365079365, recall 0.35890652557319225, F1 0.24078341013824886, AUC 0.6935626102292769
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 12 idx: 0 First Loss : 2.6494338512420654, Second Loss : 2.863572835922241
epoch: 12 idx: 200 First Loss : 0.8868150054526386, Second Loss : 0.851327664566641
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3472222222222222, precision 0.35927216415021296, recall 0.40888888888888886, F1 0.2590811965811966, AUC 0.6530415263748597
  Second-Tier acc 0.2708333333333333, precision 0.3055555555555555, recall 0.36000000000000004, F1 0.18095238095238098, AUC 0.6907575757575758
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4013605442176871, precision 0.373224043715847, recall 0.39182833627278074, F1 0.28432274888786624, AUC 0.641956937095826
  Second-Tier acc 0.3673469387755102, precision 0.44186046511627913, recall 0.38271604938271603, F1 0.24976419543482362, AUC 0.6882164902998236
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 13 idx: 0 First Loss : 2.5932066440582275, Second Loss : 2.807382583618164
epoch: 13 idx: 200 First Loss : 0.8821503971769956, Second Loss : 0.8508703740428327
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.6579741863075197
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6869191919191918
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.3830532212885154, recall 0.40417401528512636, F1 0.3021634661044314, AUC 0.6402667548500881
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6636904761904762
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 14 idx: 0 First Loss : 2.569016218185425, Second Loss : 2.698810577392578
epoch: 14 idx: 200 First Loss : 0.8788933852031267, Second Loss : 0.84144917769017
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.3511578947368421, recall 0.39999999999999997, F1 0.2456234850525182, AUC 0.6558641975308642
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6797474747474747
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3945578231292517, precision 0.4214177978883861, recall 0.3991769547325103, F1 0.27163423508938456, AUC 0.655153831079757
  Second-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6726190476190476
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 15 idx: 0 First Loss : 2.708664655685425, Second Loss : 2.7793688774108887
epoch: 15 idx: 200 First Loss : 0.8703359086201868, Second Loss : 0.8422938261730759
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3263888888888889, precision 0.34656084656084657, recall 0.3955555555555556, F1 0.23872320281328197, AUC 0.6571324354657687
  Second-Tier acc 0.2916666666666667, precision 0.39498644986449866, recall 0.3877777777777778, F1 0.2303113553113553, AUC 0.6892424242424241
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.38095238095238093, precision 0.41717171717171714, recall 0.3909465020576131, F1 0.2581417624521073, AUC 0.6488646384479718
  Second-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6792879188712521
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 16 idx: 0 First Loss : 2.6336705684661865, Second Loss : 2.7338809967041016
epoch: 16 idx: 200 First Loss : 0.862255300588275, Second Loss : 0.82723443838384
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.35186757215619696, recall 0.39999999999999997, F1 0.2465103672584361, AUC 0.6729292929292928
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6833333333333332
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3877551020408163, precision 0.4018099547511312, recall 0.3950617283950617, F1 0.26483151400094923, AUC 0.6573829120125417
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.681657848324515
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 17 idx: 0 First Loss : 2.6108932495117188, Second Loss : 2.777411460876465
epoch: 17 idx: 200 First Loss : 0.8521573474557302, Second Loss : 0.8244290997507919
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3263888888888889, precision 0.3486901535682024, recall 0.3955555555555556, F1 0.24138406396470913, AUC 0.6732379349046016
  Second-Tier acc 0.3125, precision 0.503968253968254, recall 0.40111111111111114, F1 0.25494934473464076, AUC 0.6831313131313131
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.38095238095238093, precision 0.4000607995136039, recall 0.3871252204585538, F1 0.2618848709074273, AUC 0.6581606407995297
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.68777557319224
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 18 idx: 0 First Loss : 2.592071771621704, Second Loss : 2.8324742317199707
epoch: 18 idx: 200 First Loss : 0.8393479508044246, Second Loss : 0.8255387488128174
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3263888888888889, precision 0.3486901535682024, recall 0.3955555555555556, F1 0.24138406396470913, AUC 0.6713411896745232
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6722222222222222
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.39565972222222223, recall 0.37889476778365666, F1 0.25106209150326797, AUC 0.6627780227317264
  Second-Tier acc 0.30612244897959184, precision 0.43703703703703706, recall 0.345679012345679, F1 0.18200161420500405, AUC 0.6822089947089948
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
 current learn rate 0.00014895938362058787
epoch: 19 idx: 0 First Loss : 2.6517088413238525, Second Loss : 2.9321112632751465
epoch: 19 idx: 200 First Loss : 0.8300197197218696, Second Loss : 0.8267084714143629
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3263888888888889, precision 0.3472592592592593, recall 0.3955555555555556, F1 0.23959892926818202, AUC 0.674354657687991
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6760606060606061
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.38045295637634896, recall 0.3830099941211052, F1 0.2550821498189919, AUC 0.6585893102096806
  Second-Tier acc 0.32653061224489793, precision 0.5085271317829457, recall 0.3873456790123457, F1 0.2388342651500546, AUC 0.6888227513227513
 
 test auc: 0.7757385361552028, test F1: 0.5077787464884239  :  from epoch 5
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 3.583971498476597e-05
epoch: 0 idx: 0 First Loss : 1.2739439010620117, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1299129900202822, Second Loss : 1.1118665034349877
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7234567901234567
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7524747474747474
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6776222320203802
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6586750440917107
 
 test auc: 0.6586750440917107, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 3.583971498476597e-05
epoch: 1 idx: 0 First Loss : 2.248725414276123, Second Loss : 2.156256914138794
epoch: 1 idx: 200 First Loss : 1.0738182575696738, Second Loss : 1.0744188205519718
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7400561167227834
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7591414141414141
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7090865667254557
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033730158730158
 
 test auc: 0.7033730158730158, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.583971498476597e-05
epoch: 2 idx: 0 First Loss : 2.4011175632476807, Second Loss : 2.3149213790893555
epoch: 2 idx: 200 First Loss : 1.0318103525694924, Second Loss : 1.0314030556091622
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5486111111111112, precision 0.3857506361323155, recall 0.3850505050505051, F1 0.3292692105065101, AUC 0.7358249158249158
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7520202020202019
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6054421768707483, precision 0.8609112709832134, recall 0.4384920634920635, F1 0.41149605583213983, AUC 0.6997966882226141
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7024360670194003
 
 test auc: 0.7033730158730158, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.583971498476597e-05
epoch: 3 idx: 0 First Loss : 2.6594502925872803, Second Loss : 2.585455894470215
epoch: 3 idx: 200 First Loss : 0.9883891534968395, Second Loss : 0.9944787876893632
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5833333333333334, precision 0.5243177960569265, recall 0.5213804713804714, F1 0.5175156202286149, AUC 0.7284231200897867
  Second-Tier acc 0.6666666666666666, precision 0.648148148148148, recall 0.6082828282828283, F1 0.5650162098437961, AUC 0.7482828282828282
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5374149659863946, precision 0.4884896500213401, recall 0.521384479717813, F1 0.48786015117284465, AUC 0.6973287771898883
  Second-Tier acc 0.6122448979591837, precision 0.5782163742690059, recall 0.5729717813051146, F1 0.5670995670995671, AUC 0.7066247795414462
 
 test auc: 0.7033730158730158, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.583971498476597e-05
epoch: 4 idx: 0 First Loss : 3.0245330333709717, Second Loss : 2.931871175765991
epoch: 4 idx: 200 First Loss : 0.9527300441480098, Second Loss : 0.9649974948620025
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4861111111111111, precision 0.4934640522875817, recall 0.4838383838383839, F1 0.43138612229521317, AUC 0.729668911335578
  Second-Tier acc 0.5416666666666666, precision 0.5602240896358542, recall 0.5665656565656566, F1 0.5327144120247569, AUC 0.7604040404040404
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46258503401360546, precision 0.4879012345679013, recall 0.5330687830687831, F1 0.4352426961122613, AUC 0.714365324319028
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7324735449735451
 
 test auc: 0.7324735449735451, test F1: 0.5954897815362932  :  from epoch 4
 current learn rate 3.583971498476597e-05
epoch: 5 idx: 0 First Loss : 3.371607542037964, Second Loss : 3.2681772708892822
epoch: 5 idx: 200 First Loss : 0.9312758880356947, Second Loss : 0.9485999786976114
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.48403209693532273, recall 0.4631986531986532, F1 0.39897894409854, AUC 0.7333333333333334
  Second-Tier acc 0.5208333333333334, precision 0.5807017543859648, recall 0.5821212121212122, F1 0.5205325140809012, AUC 0.7822727272727272
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4217687074829932, precision 0.4681481481481482, recall 0.5121987066431511, F1 0.40740740740740744, AUC 0.7305629041740153
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7585978835978837
 
 test auc: 0.7585978835978837, test F1: 0.4711538461538461  :  from epoch 5
 current learn rate 3.583971498476597e-05
epoch: 6 idx: 0 First Loss : 3.654573440551758, Second Loss : 3.5442001819610596
epoch: 6 idx: 200 First Loss : 0.9219741641048027, Second Loss : 0.9428990318750342
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4166666666666667, precision 0.48096311956777077, recall 0.4611784511784512, F1 0.39020698791190594, AUC 0.7363075196408531
  Second-Tier acc 0.5, precision 0.5765455304928989, recall 0.5857575757575758, F1 0.5016291951775823, AUC 0.7840909090909091
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.5086950586950587, recall 0.5360082304526749, F1 0.4330716454318142, AUC 0.738995443856555
  Second-Tier acc 0.5306122448979592, precision 0.5852272727272727, recall 0.6294091710758377, F1 0.5365497076023392, AUC 0.7689043209876543
 
 test auc: 0.7689043209876543, test F1: 0.5365497076023392  :  from epoch 6
 current learn rate 3.583971498476597e-05
epoch: 7 idx: 0 First Loss : 3.8219106197357178, Second Loss : 3.734769582748413
epoch: 7 idx: 200 First Loss : 0.9158213075843469, Second Loss : 0.941339314521397
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.4845063097095618, recall 0.4531313131313131, F1 0.3826054444611146, AUC 0.7426430976430977
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5605050505050505, F1 0.4795093795093795, AUC 0.7897474747474748
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.5472354388843313, recall 0.5491622574955909, F1 0.4418319078279997, AUC 0.7522107093866354
  Second-Tier acc 0.5510204081632653, precision 0.6319444444444444, recall 0.6646825396825397, F1 0.5540935672514621, AUC 0.7782186948853616
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 8 idx: 0 First Loss : 3.870790481567383, Second Loss : 3.82380747795105
epoch: 8 idx: 200 First Loss : 0.9097286969451095, Second Loss : 0.9378594247536243
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4236111111111111, precision 0.5119047619047619, recall 0.49474747474747477, F1 0.4132995640055974, AUC 0.7465263748597081
  Second-Tier acc 0.4166666666666667, precision 0.5099206349206349, recall 0.47717171717171714, F1 0.40637140637140634, AUC 0.7869696969696971
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.5645161290322581, recall 0.5549676660787771, F1 0.4499105545617173, AUC 0.7616659318048207
  Second-Tier acc 0.5306122448979592, precision 0.6133333333333333, recall 0.623015873015873, F1 0.5286138981791155, AUC 0.7943121693121693
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 9 idx: 0 First Loss : 3.912748336791992, Second Loss : 3.878396987915039
epoch: 9 idx: 200 First Loss : 0.9042476965960078, Second Loss : 0.9350640003520773
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.5063492063492063, recall 0.48754208754208755, F1 0.4034776979171653, AUC 0.7457070707070708
  Second-Tier acc 0.375, precision 0.472495894909688, recall 0.43606060606060604, F1 0.35833333333333334, AUC 0.7780808080808082
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.47619047619047616, precision 0.5883513467147024, recall 0.5964873603762493, F1 0.4782641440024447, AUC 0.7693513619439546
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.8009810405643739
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 10 idx: 0 First Loss : 3.8558900356292725, Second Loss : 3.875485420227051
epoch: 10 idx: 200 First Loss : 0.8984740885386976, Second Loss : 0.9318244686380344
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4027777777777778, precision 0.5015873015873016, recall 0.47828282828282825, F1 0.39718838974106463, AUC 0.7428226711560045
  Second-Tier acc 0.375, precision 0.472495894909688, recall 0.43606060606060604, F1 0.35833333333333334, AUC 0.7765151515151515
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.5756809174466649, recall 0.5705467372134039, F1 0.45691887896973754, AUC 0.7713783558690966
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8013117283950617
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 11 idx: 0 First Loss : 3.821397066116333, Second Loss : 3.870635986328125
epoch: 11 idx: 200 First Loss : 0.8946940734396359, Second Loss : 0.9300108421651823
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5093054170820871, recall 0.49488215488215487, F1 0.4057971014492754, AUC 0.7350224466891134
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7595959595959596
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.5756809174466649, recall 0.5705467372134039, F1 0.45691887896973754, AUC 0.770606750930825
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8040123456790124
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 12 idx: 0 First Loss : 3.760051965713501, Second Loss : 3.8410961627960205
epoch: 12 idx: 200 First Loss : 0.8901142434110466, Second Loss : 0.927617612587339
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3958333333333333, precision 0.4989509129615983, recall 0.4811784511784512, F1 0.3916494133885438, AUC 0.7261335578002245
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7386363636363636
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.5737976782752902, recall 0.5679747207524986, F1 0.4355872054611152, AUC 0.7674101019008427
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7958002645502645
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 13 idx: 0 First Loss : 3.6756575107574463, Second Loss : 3.794928550720215
epoch: 13 idx: 200 First Loss : 0.885869318758953, Second Loss : 0.9262484857220022
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.48913398692810456, recall 0.4626599326599326, F1 0.3788747095198708, AUC 0.7176150392817059
  Second-Tier acc 0.375, precision 0.4567901234567901, recall 0.4385858585858586, F1 0.3517206477732793, AUC 0.7175757575757576
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5652506697282816, recall 0.5458553791887125, F1 0.41300080747689244, AUC 0.7607902214383696
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7892967372134039
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 14 idx: 0 First Loss : 3.6159603595733643, Second Loss : 3.761503219604492
epoch: 14 idx: 200 First Loss : 0.8825368159077019, Second Loss : 0.9261441863612828
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.47220247966516626, recall 0.44535353535353533, F1 0.35720822273129466, AUC 0.7064478114478114
  Second-Tier acc 0.375, precision 0.45604395604395603, recall 0.4385858585858586, F1 0.34927350427350423, AUC 0.7015151515151515
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.5610409491006506, recall 0.5379188712522046, F1 0.4064500530622026, AUC 0.7552297668038409
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7819664902998236
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 15 idx: 0 First Loss : 3.5781500339508057, Second Loss : 3.7656543254852295
epoch: 15 idx: 200 First Loss : 0.8802853362236301, Second Loss : 0.9266147529978573
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.4566648629148629, recall 0.41757575757575754, F1 0.337077138425453, AUC 0.6935914702581369
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6876262626262627
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5656565656565656, recall 0.5458553791887125, F1 0.4128086419753086, AUC 0.7500428669410151
  Second-Tier acc 0.46938775510204084, precision 0.5780392156862745, recall 0.5566578483245149, F1 0.45862242332830566, AUC 0.7801477072310407
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 16 idx: 0 First Loss : 3.526961088180542, Second Loss : 3.7076950073242188
epoch: 16 idx: 200 First Loss : 0.876972740921493, Second Loss : 0.9263073034739163
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3541666666666667, precision 0.4666019103124494, recall 0.43380471380471386, F1 0.34979996362975085, AUC 0.6858361391694725
  Second-Tier acc 0.3541666666666667, precision 0.4523809523809524, recall 0.4396969696969697, F1 0.3339031339031339, AUC 0.6834343434343434
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.5656249999999999, recall 0.5396090534979424, F1 0.4028046421663443, AUC 0.744672251616696
  Second-Tier acc 0.46938775510204084, precision 0.5785256410256411, recall 0.5566578483245149, F1 0.4594771241830065, AUC 0.7792107583774252
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 17 idx: 0 First Loss : 3.4829490184783936, Second Loss : 3.672293186187744
epoch: 17 idx: 200 First Loss : 0.8751125553352365, Second Loss : 0.9258472054867498
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.45932658095465445, recall 0.43020202020202025, F1 0.341506315486209, AUC 0.6804152637485972
  Second-Tier acc 0.3541666666666667, precision 0.4523809523809524, recall 0.4396969696969697, F1 0.3339031339031339, AUC 0.6814141414141415
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3945578231292517, precision 0.559727711901625, recall 0.5275573192239859, F1 0.38892440827924696, AUC 0.740661130707427
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7786044973544973
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 18 idx: 0 First Loss : 3.4518816471099854, Second Loss : 3.642338275909424
epoch: 18 idx: 200 First Loss : 0.8714587858576033, Second Loss : 0.9254131181963687
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3472222222222222, precision 0.45932658095465445, recall 0.43020202020202025, F1 0.341506315486209, AUC 0.6762794612794613
  Second-Tier acc 0.3541666666666667, precision 0.4526234567901235, recall 0.4396969696969697, F1 0.33575605680868836, AUC 0.6775252525252524
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4013605442176871, precision 0.5641025641025641, recall 0.5354938271604938, F1 0.39501026942128786, AUC 0.7370970507544582
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7779431216931217
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7
 current learn rate 3.583971498476597e-05
epoch: 19 idx: 0 First Loss : 3.496075391769409, Second Loss : 3.6141040325164795
epoch: 19 idx: 200 First Loss : 0.870063707708417, Second Loss : 0.925708112691324
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3402777777777778, precision 0.453365148029892, recall 0.42094276094276095, F1 0.33369882291080155, AUC 0.6766610549943883
  Second-Tier acc 0.375, precision 0.46848290598290604, recall 0.45303030303030306, F1 0.3591356333291817, AUC 0.6787373737373738
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4013605442176871, precision 0.5637470657276995, recall 0.5354938271604938, F1 0.39515263972871734, AUC 0.7373603762492652
  Second-Tier acc 0.42857142857142855, precision 0.566951566951567, recall 0.5319664902998237, F1 0.4157051282051282, AUC 0.7743606701940036
 
 test auc: 0.7782186948853616, test F1: 0.5540935672514621  :  from epoch 7{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.42296937031049125, "droprate_2": 0.0, "lr": 6.612684942965531e-05, "weight_decay": 0.0005405264466386195, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 6.612684942965531e-05
epoch: 0 idx: 0 First Loss : 1.2705258131027222, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1273537118043473, Second Loss : 1.119191471542885
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7329741863075195
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7548989898989898
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6963612090926906
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6913029100529101
Test AUC: 0.6913, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 6.612684942965531e-05
epoch: 1 idx: 0 First Loss : 2.1828300952911377, Second Loss : 2.159863233566284
epoch: 1 idx: 200 First Loss : 1.0306794367619414, Second Loss : 1.0377642810344696
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7391526374859708
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7563131313131312
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7202993337252597
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7140652557319225
Test AUC: 0.7141, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.612684942965531e-05
epoch: 2 idx: 0 First Loss : 2.4335639476776123, Second Loss : 2.3858959674835205
epoch: 2 idx: 200 First Loss : 0.9767864652311624, Second Loss : 0.9885099063910062
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6180555555555556, precision 0.5504587155963302, recall 0.49232323232323233, F1 0.4866211455870289, AUC 0.7338664421997757
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7436363636363635
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.673469387755102, precision 0.689124772716104, recall 0.5671663727219283, F1 0.5588189694482445, AUC 0.7125710366451109
  Second-Tier acc 0.6122448979591837, precision 0.35714285714285715, recall 0.4047619047619047, F1 0.35610766045548653, AUC 0.7096009700176366
Test AUC: 0.7141, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.612684942965531e-05
epoch: 3 idx: 0 First Loss : 2.9802353382110596, Second Loss : 2.9492812156677246
epoch: 3 idx: 200 First Loss : 0.9305306342777921, Second Loss : 0.9537719370269063
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5277777777777778, precision 0.53177304964539, recall 0.5350505050505051, F1 0.5128711567581803, AUC 0.7188496071829406
  Second-Tier acc 0.5, precision 0.4671717171717171, recall 0.4676767676767677, F1 0.4377104377104377, AUC 0.7390909090909091
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5374149659863946, precision 0.5305250305250305, recall 0.5655496766607877, F1 0.5244858177189003, AUC 0.7151001861650009
  Second-Tier acc 0.6530612244897959, precision 0.6745098039215686, recall 0.7264109347442681, F1 0.6750841750841751, AUC 0.7358906525573192
Test AUC: 0.7141, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.612684942965531e-05
epoch: 4 idx: 0 First Loss : 3.6309707164764404, Second Loss : 3.540112257003784
epoch: 4 idx: 200 First Loss : 0.9146564624582728, Second Loss : 0.9438273717663181
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4375, precision 0.5160653971581645, recall 0.48774410774410776, F1 0.4388321450824432, AUC 0.7123905723905724
  Second-Tier acc 0.4583333333333333, precision 0.5872503840245776, recall 0.5038383838383839, F1 0.4546365914786967, AUC 0.7580808080808081
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.47619047619047616, precision 0.528968253968254, recall 0.5459288653733099, F1 0.48410087719298245, AUC 0.7170353223593965
  Second-Tier acc 0.5510204081632653, precision 0.5777555777555777, recall 0.6417548500881834, F1 0.567750677506775, AUC 0.7609126984126983
Test AUC: 0.7609, Test F1: 0.5678 (Best Epoch: 4)
Current LR: 6.612684942965531e-05
epoch: 5 idx: 0 First Loss : 3.855961561203003, Second Loss : 3.93367862701416
epoch: 5 idx: 200 First Loss : 0.9087941166110781, Second Loss : 0.9433157391827646
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4236111111111111, precision 0.5031015639721123, recall 0.4771717171717172, F1 0.42216457082436465, AUC 0.7095398428731762
  Second-Tier acc 0.3958333333333333, precision 0.5073178016726404, recall 0.43242424242424243, F1 0.38384687208216617, AUC 0.7767676767676769
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46258503401360546, precision 0.5449502570981445, recall 0.541519694297472, F1 0.46392143950396775, AUC 0.7172006662747403
  Second-Tier acc 0.5510204081632653, precision 0.6353276353276353, recall 0.6468253968253969, F1 0.5522648083623694, AUC 0.7663139329805997
Test AUC: 0.7663, Test F1: 0.5523 (Best Epoch: 5)
Current LR: 6.612684942965531e-05
epoch: 6 idx: 0 First Loss : 3.93143630027771, Second Loss : 4.08675479888916
epoch: 6 idx: 200 First Loss : 0.9028047107980212, Second Loss : 0.9430160636536369
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4236111111111111, precision 0.5154839713663243, recall 0.5014814814814815, F1 0.42632047071702245, AUC 0.719023569023569
  Second-Tier acc 0.375, precision 0.4910130718954248, recall 0.4216161616161616, F1 0.34882154882154887, AUC 0.7808585858585859
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46938775510204084, precision 0.577733860342556, recall 0.5570987654320988, F1 0.47114845938375355, AUC 0.7307588673329413
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7873126102292769
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 7 idx: 0 First Loss : 3.9879817962646484, Second Loss : 4.228204727172852
epoch: 7 idx: 200 First Loss : 0.8983418128606099, Second Loss : 0.9400336470545283
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3541666666666667, precision 0.47620062517760725, recall 0.42104377104377105, F1 0.3456221198156682, AUC 0.7269416386083053
  Second-Tier acc 0.375, precision 0.48055555555555557, recall 0.4190909090909091, F1 0.36240453313624044, AUC 0.7764141414141413
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4897959183673469, precision 0.603914259086673, recall 0.5787771898883011, F1 0.4928419210729542, AUC 0.7430800509504213
  Second-Tier acc 0.4897959183673469, precision 0.5805860805860806, recall 0.5575396825396826, F1 0.48484848484848486, AUC 0.7906194885361552
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 8 idx: 0 First Loss : 3.954846143722534, Second Loss : 4.152461051940918
epoch: 8 idx: 200 First Loss : 0.8911980687871122, Second Loss : 0.9364357538178415
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.5081429873298645, recall 0.4873063973063973, F1 0.4018247446989897, AUC 0.7326262626262626
  Second-Tier acc 0.3541666666666667, precision 0.4599567099567099, recall 0.4082828282828283, F1 0.32803030303030306, AUC 0.7667676767676768
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.5805946791862284, recall 0.5722369194591416, F1 0.45413671291744057, AUC 0.7446844993141291
  Second-Tier acc 0.5102040816326531, precision 0.6043956043956044, recall 0.5928130511463845, F1 0.5015873015873016, AUC 0.7836199294532628
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 9 idx: 0 First Loss : 3.782496452331543, Second Loss : 4.173372745513916
epoch: 9 idx: 200 First Loss : 0.8846606819083062, Second Loss : 0.9320218050669976
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3888888888888889, precision 0.4955738895807389, recall 0.4761279461279462, F1 0.38537563065864955, AUC 0.7297194163860832
  Second-Tier acc 0.375, precision 0.47005772005772006, recall 0.4385858585858586, F1 0.3431818181818182, AUC 0.748989898989899
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.5751885732627187, recall 0.5661375661375662, F1 0.4413884955809428, AUC 0.7395772094846169
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7743606701940035
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 10 idx: 0 First Loss : 3.6944472789764404, Second Loss : 4.077120780944824
epoch: 10 idx: 200 First Loss : 0.8817210997303077, Second Loss : 0.9292306835324138
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.4634353741496599, recall 0.4363299663299663, F1 0.3442420035860952, AUC 0.7237261503928171
  Second-Tier acc 0.375, precision 0.4599078341013825, recall 0.4385858585858586, F1 0.34433621933621933, AUC 0.7281313131313132
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.5471787577050735, recall 0.49639917695473246, F1 0.3943419660921735, AUC 0.7249779541446207
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7663690476190476
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 11 idx: 0 First Loss : 3.6194636821746826, Second Loss : 3.970027446746826
epoch: 11 idx: 200 First Loss : 0.8786640103329529, Second Loss : 0.9264485110458975
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3263888888888889, precision 0.43759904398202276, recall 0.4089225589225589, F1 0.31225913756034235, AUC 0.7047586980920314
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7049494949494949
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.40816326530612246, precision 0.5499878963931252, recall 0.4962522045855378, F1 0.39316395663956644, AUC 0.7169618361747991
  Second-Tier acc 0.42857142857142855, precision 0.5222222222222223, recall 0.45546737213403876, F1 0.3857397504456328, AUC 0.7443231922398589
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 12 idx: 0 First Loss : 3.575934648513794, Second Loss : 3.909803628921509
epoch: 12 idx: 200 First Loss : 0.877999699167474, Second Loss : 0.9261262127259382
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.4318717680786646, recall 0.41060606060606064, F1 0.3063131313131313, AUC 0.6885802469135802
  Second-Tier acc 0.3333333333333333, precision 0.41527777777777786, recall 0.3974747474747475, F1 0.2928686717133829, AUC 0.6817676767676768
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.5392544944746825, recall 0.4722957084068195, F1 0.37340699901161356, AUC 0.703611845972957
  Second-Tier acc 0.40816326530612246, precision 0.49782135076252726, recall 0.42526455026455023, F1 0.34098336304218657, AUC 0.7229387125220459
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 13 idx: 0 First Loss : 3.5270049571990967, Second Loss : 3.7997419834136963
epoch: 13 idx: 200 First Loss : 0.8773302334040491, Second Loss : 0.9233807175104861
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.42119200244200244, recall 0.4131313131313132, F1 0.2923023222728431, AUC 0.6873120089786756
  Second-Tier acc 0.3333333333333333, precision 0.41154684095860566, recall 0.4144444444444444, F1 0.28359788359788357, AUC 0.6771212121212121
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.502089718584564, recall 0.4086566725455614, F1 0.31950526080705016, AUC 0.6921296296296297
  Second-Tier acc 0.40816326530612246, precision 0.5013227513227513, recall 0.42526455026455023, F1 0.338989898989899, AUC 0.7100418871252204
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 14 idx: 0 First Loss : 3.5719549655914307, Second Loss : 3.7537739276885986
epoch: 14 idx: 200 First Loss : 0.8770479036990868, Second Loss : 0.9209220813688954
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.3894949494949495, recall 0.39582491582491586, F1 0.26106384937740373, AUC 0.6862121212121212
  Second-Tier acc 0.3125, precision 0.3917989417989418, recall 0.40111111111111114, F1 0.26013183884248353, AUC 0.682878787878788
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.494949494949495, recall 0.39858906525573196, F1 0.30540684816594216, AUC 0.6820926415833823
  Second-Tier acc 0.40816326530612246, precision 0.5013227513227513, recall 0.42526455026455023, F1 0.338989898989899, AUC 0.6976962081128747
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 15 idx: 0 First Loss : 3.5408668518066406, Second Loss : 3.6885499954223633
epoch: 15 idx: 200 First Loss : 0.8765926074573425, Second Loss : 0.9151050828919116
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.3794704049844237, recall 0.3918518518518519, F1 0.24796629788150418, AUC 0.6868799102132436
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6842929292929293
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.4841269841269842, recall 0.384700176366843, F1 0.2908589959281203, AUC 0.6773160395845581
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6775793650793651
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 16 idx: 0 First Loss : 3.5458898544311523, Second Loss : 3.586998701095581
epoch: 16 idx: 200 First Loss : 0.8777743074879345, Second Loss : 0.9118887466646816
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.38685050798258347, recall 0.3962962962962963, F1 0.2558888805498075, AUC 0.6833221099887767
  Second-Tier acc 0.3125, precision 0.3917989417989418, recall 0.40111111111111114, F1 0.26013183884248353, AUC 0.6841919191919192
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.4831730769230769, recall 0.38058495002939446, F1 0.28437420233131966, AUC 0.6726496668626298
  Second-Tier acc 0.3673469387755102, precision 0.49074074074074076, recall 0.40057319223985893, F1 0.29857052498418724, AUC 0.6650132275132274
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 17 idx: 0 First Loss : 3.5500271320343018, Second Loss : 3.5646371841430664
epoch: 17 idx: 200 First Loss : 0.8772033481717206, Second Loss : 0.9096104106797046
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.3868708452041785, recall 0.3962962962962963, F1 0.25750553852743635, AUC 0.6853367003367002
  Second-Tier acc 0.3125, precision 0.3917989417989418, recall 0.40111111111111114, F1 0.26013183884248353, AUC 0.6860101010101011
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.35374149659863946, precision 0.4934784740609984, recall 0.39447383891828336, F1 0.29660871318726606, AUC 0.6699000587889478
  Second-Tier acc 0.40816326530612246, precision 0.5046296296296297, recall 0.4367283950617284, F1 0.3325, AUC 0.6638558201058201
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 18 idx: 0 First Loss : 3.5966665744781494, Second Loss : 3.561821937561035
epoch: 18 idx: 200 First Loss : 0.8791724194165705, Second Loss : 0.904964011361468
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3125, precision 0.3868708452041785, recall 0.3962962962962963, F1 0.25750553852743635, AUC 0.6845230078563412
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6872727272727274
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.4816458622283865, recall 0.3723544973544974, F1 0.2706799142801481, AUC 0.6648846266901822
  Second-Tier acc 0.40816326530612246, precision 0.5046296296296297, recall 0.4367283950617284, F1 0.3325, AUC 0.6642416225749559
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 6.612684942965531e-05
epoch: 19 idx: 0 First Loss : 3.5746688842773438, Second Loss : 3.5283026695251465
epoch: 19 idx: 200 First Loss : 0.8785187974626479, Second Loss : 0.9005885479528114
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3125, precision 0.3868708452041785, recall 0.3962962962962963, F1 0.25750553852743635, AUC 0.6810942760942762
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6877777777777778
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.5004905895995004, recall 0.4001322751322751, F1 0.29380564790400854, AUC 0.6650071036645112
  Second-Tier acc 0.3877551020408163, precision 0.5, recall 0.4243827160493827, F1 0.3119038583175206, AUC 0.6683201058201059
Test AUC: 0.7873, Test F1: 0.4931 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.2598261565476463, "droprate_2": 0.0, "lr": 2.4896000636493374e-05, "weight_decay": 0.0008782624901822932, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_2", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.4896000636493374e-05
epoch: 0 idx: 0 First Loss : 1.2298887968063354, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.0928895940531547, Second Loss : 1.0816015157830063
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7116778900112233
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7243434343434343
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6254960317460317
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6281415343915343
Test AUC: 0.6281, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.4896000636493374e-05
epoch: 1 idx: 0 First Loss : 1.981357216835022, Second Loss : 1.9798272848129272
epoch: 1 idx: 200 First Loss : 1.0746070683299012, Second Loss : 1.0662527735998382
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7385521885521884
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495454545454545
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6739969135802468
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6727292768959435
Test AUC: 0.6727, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4896000636493374e-05
epoch: 2 idx: 0 First Loss : 2.0071308612823486, Second Loss : 2.0023884773254395
epoch: 2 idx: 200 First Loss : 1.045973166230306, Second Loss : 1.0389755480176774
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7512121212121213
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7587373737373736
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6943342151675486
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7012786596119929
Test AUC: 0.7013, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.4896000636493374e-05
epoch: 3 idx: 0 First Loss : 2.1035244464874268, Second Loss : 2.0555200576782227
epoch: 3 idx: 200 First Loss : 1.0246325660849092, Second Loss : 1.0219203218891846
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7528226711560043
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7595959595959597
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7062083578287282
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7082782186948853
Test AUC: 0.7083, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 2.4896000636493374e-05
epoch: 4 idx: 0 First Loss : 2.180243968963623, Second Loss : 2.1184680461883545
epoch: 4 idx: 200 First Loss : 1.0045418081740243, Second Loss : 1.0054524412647408
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7511111111111112
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7604545454545454
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7145490397805213
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7102623456790124
Test AUC: 0.7103, Test F1: 0.2400 (Best Epoch: 4)
Current LR: 2.4896000636493374e-05
epoch: 5 idx: 0 First Loss : 2.2509942054748535, Second Loss : 2.1848597526550293
epoch: 5 idx: 200 First Loss : 0.986173529789519, Second Loss : 0.9895942009132893
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5833333333333334, precision 0.4646464646464647, recall 0.42989898989898995, F1 0.38647342995169076, AUC 0.7467901234567901
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7542424242424243
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5578231292517006, precision 0.5195402298850574, recall 0.34722222222222227, F1 0.2656047197640118, AUC 0.7190623162845385
  Second-Tier acc 0.5510204081632653, precision 0.1956521739130435, recall 0.3333333333333333, F1 0.2465753424657534, AUC 0.7221119929453262
Test AUC: 0.7103, Test F1: 0.2400 (Best Epoch: 4)
Current LR: 2.4896000636493374e-05
epoch: 6 idx: 0 First Loss : 2.3175437450408936, Second Loss : 2.242615222930908
epoch: 6 idx: 200 First Loss : 0.968755184788609, Second Loss : 0.9749550917996695
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5902777777777778, precision 0.3867529045394658, recall 0.45131313131313133, F1 0.39965986394557823, AUC 0.7461503928170595
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7556565656565656
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6326530612244898, precision 0.6845441595441596, recall 0.4702380952380953, F1 0.46711698107363003, AUC 0.7176966980207721
  Second-Tier acc 0.6326530612244898, precision 0.6957026713124274, recall 0.4464285714285714, F1 0.4340180516651104, AUC 0.7254739858906524
Test AUC: 0.7103, Test F1: 0.2400 (Best Epoch: 4)
Current LR: 2.4896000636493374e-05
epoch: 7 idx: 0 First Loss : 2.3772308826446533, Second Loss : 2.298013925552368
epoch: 7 idx: 200 First Loss : 0.9519096177386407, Second Loss : 0.9606289358355513
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6666666666666666, precision 0.7617460317460317, recall 0.5777104377104377, F1 0.5201670843776106, AUC 0.7459820426487092
  Second-Tier acc 0.6875, precision 0.4479166666666667, recall 0.6096969696969697, F1 0.5159194282001299, AUC 0.7610606060606061
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6326530612244898, precision 0.6377653039099954, recall 0.53777189888301, F1 0.5635432931442461, AUC 0.7153206447187929
  Second-Tier acc 0.5714285714285714, precision 0.4791666666666666, recall 0.4552469135802469, F1 0.45007974481658697, AUC 0.7314814814814814
Test AUC: 0.7315, Test F1: 0.4501 (Best Epoch: 7)
Current LR: 2.4896000636493374e-05
epoch: 8 idx: 0 First Loss : 2.438537359237671, Second Loss : 2.3595612049102783
epoch: 8 idx: 200 First Loss : 0.9366933331264192, Second Loss : 0.9478507103833986
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6597222222222222, precision 0.6334299461998939, recall 0.6046801346801347, F1 0.5544152148508934, AUC 0.7516105499438833
  Second-Tier acc 0.6666666666666666, precision 0.7592592592592592, recall 0.6108080808080808, F1 0.5355665839536807, AUC 0.7728787878787878
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5918367346938775, precision 0.5463301200744123, recall 0.541519694297472, F1 0.539411976911977, AUC 0.7195950911228689
  Second-Tier acc 0.5714285714285714, precision 0.48517786561264825, recall 0.5011022927689593, F1 0.47144082858368574, AUC 0.7396384479717814
Test AUC: 0.7396, Test F1: 0.4714 (Best Epoch: 8)
Current LR: 2.4896000636493374e-05
epoch: 9 idx: 0 First Loss : 2.4965922832489014, Second Loss : 2.416748523712158
epoch: 9 idx: 200 First Loss : 0.9226966133128055, Second Loss : 0.9357476813987416
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6041666666666666, precision 0.5388243335611757, recall 0.5730976430976431, F1 0.5330721003134796, AUC 0.7577384960718293
  Second-Tier acc 0.625, precision 0.5869565217391305, recall 0.5841414141414141, F1 0.5075863678804855, AUC 0.7835353535353535
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5918367346938775, precision 0.5488747223027143, recall 0.5529835390946501, F1 0.5437136465324385, AUC 0.7224488046247305
  Second-Tier acc 0.5918367346938775, precision 0.5527777777777777, recall 0.5427689594356261, F1 0.5224969133143825, AUC 0.7524801587301587
Test AUC: 0.7525, Test F1: 0.5225 (Best Epoch: 9)
Current LR: 2.4896000636493374e-05
epoch: 10 idx: 0 First Loss : 2.5335681438446045, Second Loss : 2.472132921218872
epoch: 10 idx: 200 First Loss : 0.9102427181208608, Second Loss : 0.9251036669187878
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5833333333333334, precision 0.5725516029863856, recall 0.5903367003367003, F1 0.5452210062379553, AUC 0.7609315375982043
  Second-Tier acc 0.4583333333333333, precision 0.453448275862069, recall 0.46050505050505053, F1 0.39166666666666666, AUC 0.7911616161616162
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5782312925170068, precision 0.5648148148148148, recall 0.5740740740740741, F1 0.557210401891253, AUC 0.7298341661767588
  Second-Tier acc 0.5918367346938775, precision 0.5911111111111111, recall 0.5720899470899471, F1 0.5531135531135531, AUC 0.7566137566137566
Test AUC: 0.7566, Test F1: 0.5531 (Best Epoch: 10)
Current LR: 2.4896000636493374e-05
epoch: 11 idx: 0 First Loss : 2.5762035846710205, Second Loss : 2.522164821624756
epoch: 11 idx: 200 First Loss : 0.8991656959687003, Second Loss : 0.9155339248737886
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5694444444444444, precision 0.5833590297050056, recall 0.5958922558922559, F1 0.5484905710918248, AUC 0.7662401795735129
  Second-Tier acc 0.4791666666666667, precision 0.5277777777777778, recall 0.5052525252525253, F1 0.4348738982885325, AUC 0.7978282828282829
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.564625850340136, precision 0.5654712027261046, recall 0.5794385655496767, F1 0.5512060007416044, AUC 0.7343841857730746
  Second-Tier acc 0.5306122448979592, precision 0.5177469135802469, recall 0.5057319223985891, F1 0.4756502714528807, AUC 0.7662588183421516
Test AUC: 0.7663, Test F1: 0.4757 (Best Epoch: 11)
Current LR: 2.4896000636493374e-05
epoch: 12 idx: 0 First Loss : 2.602022886276245, Second Loss : 2.560281276702881
epoch: 12 idx: 200 First Loss : 0.8886683569729921, Second Loss : 0.90684103734087
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5486111111111112, precision 0.5724021548646719, recall 0.5825589225589226, F1 0.5303291236127058, AUC 0.769685746352413
  Second-Tier acc 0.4583333333333333, precision 0.5361111111111111, recall 0.5063636363636363, F1 0.43403019744483157, AUC 0.8008585858585858
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5510204081632653, precision 0.5669870056059314, recall 0.5967078189300411, F1 0.5510571944057232, AUC 0.7360988634136781
  Second-Tier acc 0.46938775510204084, precision 0.48461538461538467, recall 0.48655202821869487, F1 0.4444444444444444, AUC 0.7766754850088183
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 13 idx: 0 First Loss : 2.6208856105804443, Second Loss : 2.582357883453369
epoch: 13 idx: 200 First Loss : 0.8790388413292555, Second Loss : 0.8991000360869501
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.5208333333333334, precision 0.5674410774410775, recall 0.5695959595959595, F1 0.5101260680970826, AUC 0.7730976430976431
  Second-Tier acc 0.4583333333333333, precision 0.5260536398467434, recall 0.5063636363636363, F1 0.4333333333333333, AUC 0.8006565656565656
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5170068027210885, precision 0.5430730269439947, recall 0.560405643738977, F1 0.5152254249815226, AUC 0.7377400548696844
  Second-Tier acc 0.4489795918367347, precision 0.47345679012345676, recall 0.47420634920634924, F1 0.4275588909735251, AUC 0.7729276895943563
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 14 idx: 0 First Loss : 2.6305410861968994, Second Loss : 2.605797290802002
epoch: 14 idx: 200 First Loss : 0.8696933216253175, Second Loss : 0.891537824691973
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.5069444444444444, precision 0.5560597572362278, recall 0.5607070707070707, F1 0.4972274466825873, AUC 0.7755274971941638
  Second-Tier acc 0.4583333333333333, precision 0.5260536398467434, recall 0.5063636363636363, F1 0.4333333333333333, AUC 0.7983333333333333
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5102040816326531, precision 0.5441934032765952, recall 0.5541593180482068, F1 0.5034674475850947, AUC 0.7414878502841464
  Second-Tier acc 0.46938775510204084, precision 0.5218614718614719, recall 0.498015873015873, F1 0.4420284946600736, AUC 0.7731481481481483
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 15 idx: 0 First Loss : 2.6356046199798584, Second Loss : 2.624448299407959
epoch: 15 idx: 200 First Loss : 0.8610354768974122, Second Loss : 0.8848954797513894
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.5, precision 0.55651395173454, recall 0.5619191919191919, F1 0.49126162210274366, AUC 0.7752693602693602
  Second-Tier acc 0.4166666666666667, precision 0.4814814814814814, recall 0.46525252525252525, F1 0.3829564346063628, AUC 0.7951010101010101
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.5034013605442177, precision 0.5474923250181268, recall 0.5479129923574367, F1 0.4909898423222406, AUC 0.7458541544189693
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7671406525573192
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 16 idx: 0 First Loss : 2.6401214599609375, Second Loss : 2.641339063644409
epoch: 16 idx: 200 First Loss : 0.8530197731075595, Second Loss : 0.8786712556762334
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4861111111111111, precision 0.5511437908496731, recall 0.5482154882154883, F1 0.4754038488551762, AUC 0.773625140291807
  Second-Tier acc 0.4166666666666667, precision 0.4814814814814814, recall 0.46525252525252525, F1 0.3829564346063628, AUC 0.7905050505050504
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4897959183673469, precision 0.546031746031746, recall 0.5337301587301587, F1 0.470711312816576, AUC 0.7489956888105036
  Second-Tier acc 0.46938775510204084, precision 0.5632478632478632, recall 0.5273368606701939, F1 0.45165631469979295, AUC 0.76576278659612
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 17 idx: 0 First Loss : 2.638964891433716, Second Loss : 2.6530003547668457
epoch: 17 idx: 200 First Loss : 0.8456677426607232, Second Loss : 0.8729130845535454
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4791666666666667, precision 0.5456896551724139, recall 0.5437710437710438, F1 0.468702959759921, AUC 0.7707800224466892
  Second-Tier acc 0.3958333333333333, precision 0.4672152560083595, recall 0.4519191919191919, F1 0.36605182257356167, AUC 0.7871212121212121
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46938775510204084, precision 0.5258929674947472, recall 0.5018371546149324, F1 0.4423772609819121, AUC 0.7508022241818537
  Second-Tier acc 0.46938775510204084, precision 0.5632478632478632, recall 0.5273368606701939, F1 0.45165631469979295, AUC 0.7706128747795415
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 18 idx: 0 First Loss : 2.6412696838378906, Second Loss : 2.669621229171753
epoch: 18 idx: 200 First Loss : 0.839096426722867, Second Loss : 0.8673107395532416
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4722222222222222, precision 0.5440857524190857, recall 0.5441414141414141, F1 0.4643042491979618, AUC 0.7684792368125702
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7836868686868687
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.47619047619047616, precision 0.5473134118967452, recall 0.5097736625514403, F1 0.44712386379053043, AUC 0.7527802273172642
  Second-Tier acc 0.46938775510204084, precision 0.5632478632478632, recall 0.5273368606701939, F1 0.45165631469979295, AUC 0.7701719576719577
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12)
Current LR: 2.4896000636493374e-05
epoch: 19 idx: 0 First Loss : 2.6327731609344482, Second Loss : 2.6722326278686523
epoch: 19 idx: 200 First Loss : 0.8327744107980707, Second Loss : 0.8622509844795759
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4652777777777778, precision 0.5370370370370371, recall 0.5348821548821548, F1 0.4553950235064786, AUC 0.7657519640852973
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7761111111111111
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4557823129251701, precision 0.5501337613697165, recall 0.4974279835390947, F1 0.4272478610361907, AUC 0.7561360964138742
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7732583774250442
Test AUC: 0.7767, Test F1: 0.4444 (Best Epoch: 12){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.3515074219025166, "droprate_2": 0.0, "lr": 0.00022959478806043276, "weight_decay": 0.00046784740841608537, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00022959478806043276
epoch: 0 idx: 0 First Loss : 1.2303338050842285, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0867605695306366, Second Loss : 1.0808539787557587
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7356846240179573
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7533838383838384
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7281011169900058
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7121913580246914
Test AUC: 0.7122, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022959478806043276
epoch: 1 idx: 0 First Loss : 1.794998049736023, Second Loss : 2.0168840885162354
epoch: 1 idx: 200 First Loss : 0.977075306263136, Second Loss : 0.9869052047901485
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7319023569023569
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7357575757575757
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7385667744464041
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7434964726631392
Test AUC: 0.7122, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022959478806043276
epoch: 2 idx: 0 First Loss : 2.5775043964385986, Second Loss : 2.445275068283081
epoch: 2 idx: 200 First Loss : 0.952154377132506, Second Loss : 0.9563773319273445
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5486111111111112, precision 0.2875457875457875, recall 0.3703703703703704, F1 0.2972357723577236, AUC 0.7316161616161616
  Second-Tier acc 0.5833333333333334, precision 0.43939393939393945, recall 0.42424242424242425, F1 0.3748792270531401, AUC 0.735
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5850340136054422, precision 0.5234741784037559, recall 0.40277777777777773, F1 0.35709499510334525, AUC 0.7442864491475603
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7470238095238096
Test AUC: 0.7122, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022959478806043276
epoch: 3 idx: 0 First Loss : 3.227116823196411, Second Loss : 3.293567180633545
epoch: 3 idx: 200 First Loss : 0.9338419850804468, Second Loss : 0.938248272382872
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5277777777777778, precision 0.5090628507295174, recall 0.5219191919191919, F1 0.44140596245859404, AUC 0.732351290684624
  Second-Tier acc 0.5625, precision 0.38578088578088576, recall 0.5296969696969697, F1 0.4213149319532299, AUC 0.7378282828282828
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5850340136054422, precision 0.5456225456225456, recall 0.5212375073486185, F1 0.5046576290156627, AUC 0.7211260533019792
  Second-Tier acc 0.5714285714285714, precision 0.3986013986013986, recall 0.47178130511463845, F1 0.4146258503401361, AUC 0.7274029982363315
Test AUC: 0.7122, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022959478806043276
epoch: 4 idx: 0 First Loss : 3.501507043838501, Second Loss : 3.7313625812530518
epoch: 4 idx: 200 First Loss : 0.9217920172565723, Second Loss : 0.9310099689697671
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.375, precision 0.374017094017094, recall 0.4266666666666667, F1 0.2866666666666667, AUC 0.759635241301908
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7666666666666666
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.43537414965986393, precision 0.4306823120382443, recall 0.41240446796002356, F1 0.3182632398753894, AUC 0.6941321281599059
  Second-Tier acc 0.4897959183673469, precision 0.4594594594594595, recall 0.4567901234567901, F1 0.3631867161278926, AUC 0.7333553791887125
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 5 idx: 0 First Loss : 3.7395057678222656, Second Loss : 4.039150714874268
epoch: 5 idx: 200 First Loss : 0.9169318980481753, Second Loss : 0.9325115608412828
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.3670289855072464, recall 0.4177777777777778, F1 0.27304255035347474, AUC 0.7112962962962962
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7358585858585859
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6464640897511269
  Second-Tier acc 0.4489795918367347, precision 0.45045045045045046, recall 0.42063492063492064, F1 0.33660130718954245, AUC 0.7042548500881832
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 6 idx: 0 First Loss : 3.8072283267974854, Second Loss : 3.8637309074401855
epoch: 6 idx: 200 First Loss : 0.9120008559661237, Second Loss : 0.9203750846261131
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.6995230078563411
  Second-Tier acc 0.4166666666666667, precision 0.4562425328554361, recall 0.4677777777777778, F1 0.3647992530345472, AUC 0.7363636363636363
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.6371007250636881
  Second-Tier acc 0.46938775510204084, precision 0.5122655122655123, recall 0.46230158730158727, F1 0.3955082742316785, AUC 0.6937279541446207
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 7 idx: 0 First Loss : 4.282212734222412, Second Loss : 4.215808391571045
epoch: 7 idx: 200 First Loss : 0.8960256851518605, Second Loss : 0.9158620873100671
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3402777777777778, precision 0.3694114318053197, recall 0.40444444444444444, F1 0.25360256583999635, AUC 0.6745230078563411
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6909090909090909
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.4435695538057743, recall 0.4156378600823045, F1 0.2976936746929131, AUC 0.6355697628845777
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6533840388007055
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 8 idx: 0 First Loss : 3.967880964279175, Second Loss : 4.277568817138672
epoch: 8 idx: 200 First Loss : 0.8902544292580192, Second Loss : 0.9127479647302164
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3263888888888889, precision 0.3639406982305117, recall 0.3955555555555556, F1 0.2424749163879599, AUC 0.6688159371492706
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6856060606060607
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.4444444444444444, recall 0.40329218106995884, F1 0.282312925170068, AUC 0.6523246129727611
  Second-Tier acc 0.40816326530612246, precision 0.5333333333333333, recall 0.4367283950617284, F1 0.3325617283950617, AUC 0.6589506172839505
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 9 idx: 0 First Loss : 3.7961692810058594, Second Loss : 4.237645149230957
epoch: 9 idx: 200 First Loss : 0.8920289984196471, Second Loss : 0.9188773152164319
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.3686868686868687, recall 0.39999999999999997, F1 0.250384024577573, AUC 0.6690516273849608
  Second-Tier acc 0.3333333333333333, precision 0.3742690058479532, recall 0.39999999999999997, F1 0.25718674566600835, AUC 0.6862121212121212
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3945578231292517, precision 0.44623655913978494, recall 0.3991769547325103, F1 0.2786403345340123, AUC 0.6604325886733294
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6577932098765432
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 10 idx: 0 First Loss : 3.9959404468536377, Second Loss : 4.455939292907715
epoch: 10 idx: 200 First Loss : 0.8957626889878971, Second Loss : 0.9278291134158742
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6725589225589225
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6812626262626263
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.6743031060160689
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6597222222222222
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 11 idx: 0 First Loss : 3.697237014770508, Second Loss : 4.155413627624512
epoch: 11 idx: 200 First Loss : 0.8823808933752595, Second Loss : 0.9137474603672102
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.6705780022446689
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6843939393939394
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.68125367430923
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6643518518518519
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 12 idx: 0 First Loss : 3.609598159790039, Second Loss : 4.001280784606934
epoch: 12 idx: 200 First Loss : 0.885712966026648, Second Loss : 0.9082266436643254
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6720202020202019
  Second-Tier acc 0.3333333333333333, precision 0.36944444444444446, recall 0.39999999999999997, F1 0.2513177313936327, AUC 0.6844444444444444
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.4347540983606557, recall 0.43209876543209874, F1 0.32167510354348827, AUC 0.6914988732118362
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6752645502645502
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 13 idx: 0 First Loss : 3.621737241744995, Second Loss : 3.9132847785949707
epoch: 13 idx: 200 First Loss : 0.8686187674573204, Second Loss : 0.899447993460419
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.35927216415021296, recall 0.40888888888888886, F1 0.2590811965811966, AUC 0.6721380471380471
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6802020202020201
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.4317438055165965, recall 0.4238683127572016, F1 0.30970033982082174, AUC 0.694756760728983
  Second-Tier acc 0.3877551020408163, precision 0.452991452991453, recall 0.3950617283950617, F1 0.28026729559748426, AUC 0.6840828924162258
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 14 idx: 0 First Loss : 3.6622960567474365, Second Loss : 3.8809094429016113
epoch: 14 idx: 200 First Loss : 0.8659174270083099, Second Loss : 0.902107075184226
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.35537634408602153, recall 0.40444444444444444, F1 0.25240809028941785, AUC 0.6752581369248035
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.677979797979798
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.4317438055165965, recall 0.4238683127572016, F1 0.30970033982082174, AUC 0.6937646972369195
  Second-Tier acc 0.3877551020408163, precision 0.452991452991453, recall 0.3950617283950617, F1 0.28026729559748426, AUC 0.7022156084656084
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 15 idx: 0 First Loss : 3.8152236938476562, Second Loss : 3.879314422607422
epoch: 15 idx: 200 First Loss : 0.8623372663917946, Second Loss : 0.8920096765018141
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3472222222222222, precision 0.35927216415021296, recall 0.40888888888888886, F1 0.2590811965811966, AUC 0.6767003367003367
  Second-Tier acc 0.3125, precision 0.3583333333333334, recall 0.38666666666666666, F1 0.23267973856209148, AUC 0.6778787878787879
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.4301818181818182, recall 0.4197530864197531, F1 0.30358700075577, AUC 0.6946832745443857
  Second-Tier acc 0.40816326530612246, precision 0.4118404118404118, recall 0.40740740740740744, F1 0.30065359477124187, AUC 0.6980820105820106
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 16 idx: 0 First Loss : 4.073122024536133, Second Loss : 3.9080047607421875
epoch: 16 idx: 200 First Loss : 0.8561073848569544, Second Loss : 0.8846768607346616
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3819444444444444, precision 0.3752716210343329, recall 0.43111111111111117, F1 0.2909098856905558, AUC 0.674668911335578
  Second-Tier acc 0.375, precision 0.3964285714285714, recall 0.4266666666666667, F1 0.3008344312692139, AUC 0.6846969696969696
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.4168091168091168, recall 0.4365079365079365, F1 0.33406991897557936, AUC 0.6930849500293944
  Second-Tier acc 0.4897959183673469, precision 0.5927927927927928, recall 0.4861111111111111, F1 0.4118353647765413, AUC 0.7016644620811286
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 17 idx: 0 First Loss : 3.79638671875, Second Loss : 4.093587875366211
epoch: 17 idx: 200 First Loss : 0.8585041287570038, Second Loss : 0.8937345601219245
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3055555555555556, precision 0.34652014652014645, recall 0.38222222222222224, F1 0.2173663288986926, AUC 0.6743265993265993
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6720202020202021
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.41216991963260624, recall 0.38271604938271603, F1 0.24419729206963248, AUC 0.6824723202038016
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6772486772486772
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 18 idx: 0 First Loss : 3.8148090839385986, Second Loss : 4.045909881591797
epoch: 18 idx: 200 First Loss : 0.8468370676398909, Second Loss : 0.8854411463612467
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.34652014652014645, recall 0.38222222222222224, F1 0.2173663288986926, AUC 0.6790460157126823
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6718181818181819
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.40925925925925927, recall 0.3786008230452675, F1 0.23704513699046234, AUC 0.676287233000196
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6761463844797179
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00022959478806043276
epoch: 19 idx: 0 First Loss : 3.8013153076171875, Second Loss : 3.948563814163208
epoch: 19 idx: 200 First Loss : 0.8442206434322258, Second Loss : 0.8804602092066962
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2986111111111111, precision 0.3403797220591114, recall 0.37777777777777777, F1 0.20990391722099042, AUC 0.6792424242424243
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6664646464646465
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.40597147950089124, recall 0.37448559670781895, F1 0.2297671389024589, AUC 0.6680139133842838
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6735559964726633
Test AUC: 0.7334, Test F1: 0.3632 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.35869677246732234, "droprate_2": 0.0, "lr": 4.334666307609752e-05, "weight_decay": 0.00027383425538417136, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 4.334666307609752e-05
epoch: 0 idx: 0 First Loss : 1.231124758720398, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1294949503235556, Second Loss : 1.1163081425932508
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.726026936026936
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.756010101010101
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6833357828728199
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6747134038800705
Test AUC: 0.6747, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.334666307609752e-05
epoch: 1 idx: 0 First Loss : 2.151822328567505, Second Loss : 2.1517934799194336
epoch: 1 idx: 200 First Loss : 1.0601834331578877, Second Loss : 1.0569692310409167
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7406228956228956
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7597474747474747
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7133365177346659
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7053571428571429
Test AUC: 0.7054, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.334666307609752e-05
epoch: 2 idx: 0 First Loss : 2.316309690475464, Second Loss : 2.3249659538269043
epoch: 2 idx: 200 First Loss : 1.0109753118299727, Second Loss : 1.0104355736084245
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5833333333333334, precision 0.6561653116531165, recall 0.43050505050505056, F1 0.4104336209599368, AUC 0.7330808080808081
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7526262626262626
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6190476190476191, precision 0.42676767676767674, recall 0.47222222222222227, F1 0.42446129770073426, AUC 0.7018053106016069
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7109788359788359
Test AUC: 0.7054, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.334666307609752e-05
epoch: 3 idx: 0 First Loss : 2.642303705215454, Second Loss : 2.6780898571014404
epoch: 3 idx: 200 First Loss : 0.9665237693347741, Second Loss : 0.9722872912438948
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5486111111111112, precision 0.4835810700595384, recall 0.49013468013468015, F1 0.4655394319772341, AUC 0.7205218855218855
  Second-Tier acc 0.6041666666666666, precision 0.5231481481481481, recall 0.5513131313131313, F1 0.5164855214116297, AUC 0.7396969696969697
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4897959183673469, precision 0.4322948438634713, recall 0.4794238683127572, F1 0.42564325164745886, AUC 0.697212424064276
  Second-Tier acc 0.6530612244897959, precision 0.6437400318979266, recall 0.6677689594356261, F1 0.6482426303854875, AUC 0.7196869488536155
Test AUC: 0.7054, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.334666307609752e-05
epoch: 4 idx: 0 First Loss : 3.081930160522461, Second Loss : 3.1102302074432373
epoch: 4 idx: 200 First Loss : 0.9376986673963603, Second Loss : 0.9492680907101181
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4583333333333333, precision 0.4638542204820042, recall 0.4612457912457913, F1 0.41050012035739064, AUC 0.7269528619528619
  Second-Tier acc 0.5208333333333334, precision 0.5706773618538324, recall 0.5651515151515151, F1 0.515542328042328, AUC 0.7615151515151514
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4557823129251701, precision 0.4844710539660729, recall 0.5327748383303939, F1 0.43541640987715186, AUC 0.7114871154223006
  Second-Tier acc 0.5306122448979592, precision 0.5330882352941176, recall 0.5950176366843033, F1 0.5215503875968993, AUC 0.748126102292769
Test AUC: 0.7481, Test F1: 0.5216 (Best Epoch: 4)
Current LR: 4.334666307609752e-05
epoch: 5 idx: 0 First Loss : 3.435338258743286, Second Loss : 3.4561960697174072
epoch: 5 idx: 200 First Loss : 0.9242589802142993, Second Loss : 0.9408202360370266
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4236111111111111, precision 0.47167004732927653, recall 0.44949494949494956, F1 0.38903772994682084, AUC 0.7320089786756453
  Second-Tier acc 0.5416666666666666, precision 0.6, recall 0.6124242424242424, F1 0.5434715821812596, AUC 0.7791414141414142
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.4872270046229874, recall 0.5141828336272781, F1 0.4183669460450498, AUC 0.7215975896531451
  Second-Tier acc 0.46938775510204084, precision 0.49892831626577755, recall 0.5579805996472663, F1 0.4745454545454546, AUC 0.7620149911816578
Test AUC: 0.7620, Test F1: 0.4745 (Best Epoch: 5)
Current LR: 4.334666307609752e-05
epoch: 6 idx: 0 First Loss : 3.6719322204589844, Second Loss : 3.696798086166382
epoch: 6 idx: 200 First Loss : 0.9187598149825017, Second Loss : 0.937938616907604
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4166666666666667, precision 0.4780883322346736, recall 0.4611784511784512, F1 0.39133171912832926, AUC 0.733327721661055
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5605050505050505, F1 0.4795093795093795, AUC 0.782070707070707
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.5428778467908902, recall 0.5456349206349206, F1 0.44611003169619695, AUC 0.7257924260239075
  Second-Tier acc 0.5306122448979592, precision 0.6155157715260017, recall 0.6408730158730159, F1 0.5335135135135135, AUC 0.7658179012345679
Test AUC: 0.7658, Test F1: 0.5335 (Best Epoch: 6)
Current LR: 4.334666307609752e-05
epoch: 7 idx: 0 First Loss : 3.8019936084747314, Second Loss : 3.819525957107544
epoch: 7 idx: 200 First Loss : 0.9140448066178913, Second Loss : 0.9369167763049441
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4375, precision 0.5173913043478261, recall 0.497979797979798, F1 0.42593924329909866, AUC 0.7400953984287318
  Second-Tier acc 0.4583333333333333, precision 0.5449999999999999, recall 0.5327272727272727, F1 0.45622895622895626, AUC 0.7797474747474746
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.5391091954022988, recall 0.5352733686067019, F1 0.43579188107489997, AUC 0.736692876739173
  Second-Tier acc 0.5102040816326531, precision 0.6, recall 0.5992063492063492, F1 0.5115198810850985, AUC 0.7885802469135802
Test AUC: 0.7658, Test F1: 0.5335 (Best Epoch: 6)
Current LR: 4.334666307609752e-05
epoch: 8 idx: 0 First Loss : 3.8593199253082275, Second Loss : 3.8830084800720215
epoch: 8 idx: 200 First Loss : 0.9092271884495569, Second Loss : 0.9344178225024978
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4236111111111111, precision 0.5193121693121693, recall 0.494983164983165, F1 0.42361111111111116, AUC 0.7401290684624019
  Second-Tier acc 0.4375, precision 0.5185185185185185, recall 0.487979797979798, F1 0.43270048760244845, AUC 0.7667171717171716
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.5811380400421496, recall 0.5706937095825985, F1 0.4684055008775632, AUC 0.7402753282382912
  Second-Tier acc 0.5102040816326531, precision 0.597340930674264, recall 0.5813492063492064, F1 0.5042586140147116, AUC 0.7901234567901234
Test AUC: 0.7658, Test F1: 0.5335 (Best Epoch: 6)
Current LR: 4.334666307609752e-05
epoch: 9 idx: 0 First Loss : 3.879822015762329, Second Loss : 3.9285426139831543
epoch: 9 idx: 200 First Loss : 0.9030783155478945, Second Loss : 0.933898277346749
>>>>>>>>>>> Validation Epoch: 9
{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.21746011488623757, "droprate_2": 0.0, "lr": 0.00034763629690654505, "weight_decay": 0.00042186538128324716, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00034763629690654505
epoch: 0 idx: 0 First Loss : 1.2488787174224854, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0860121721281342, Second Loss : 1.0696565989608788
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7409483726150393
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7308080808080808
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033117773858515
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6710758377425043
Test AUC: 0.6711, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00034763629690654505
epoch: 1 idx: 0 First Loss : 1.844879150390625, Second Loss : 1.9771602153778076
epoch: 1 idx: 200 First Loss : 0.979625116607443, Second Loss : 0.9832886796240783
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7291975308641975
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7270707070707071
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7442129629629629
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7433862433862434
Test AUC: 0.6711, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00034763629690654505
epoch: 2 idx: 0 First Loss : 1.8845767974853516, Second Loss : 2.0877299308776855
epoch: 2 idx: 200 First Loss : 0.9461861346565669, Second Loss : 0.9500736901119574
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7252525252525253
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7273232323232323
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7498101606897903
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7566137566137566
Test AUC: 0.6711, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00034763629690654505
epoch: 3 idx: 0 First Loss : 2.456211805343628, Second Loss : 2.606790065765381
epoch: 3 idx: 200 First Loss : 0.9353791233800833, Second Loss : 0.9349618738526432
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7258080808080808
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7273737373737373
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.19999999999999998, recall 0.3333333333333333, F1 0.25, AUC 0.7449968155986674
  Second-Tier acc 0.5510204081632653, precision 0.19999999999999998, recall 0.3333333333333333, F1 0.25, AUC 0.748126102292769
Test AUC: 0.6711, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00034763629690654505
epoch: 4 idx: 0 First Loss : 3.312882661819458, Second Loss : 3.4561665058135986
epoch: 4 idx: 200 First Loss : 0.9233084584132245, Second Loss : 0.9321054153570637
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7191077441077441
  Second-Tier acc 0.5833333333333334, precision 0.3937984496124031, recall 0.42424242424242425, F1 0.3700980392156863, AUC 0.7232323232323233
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7059144130903391
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.6943342151675486
Test AUC: 0.6711, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00034763629690654505
epoch: 5 idx: 0 First Loss : 3.9497642517089844, Second Loss : 4.581136703491211
epoch: 5 idx: 200 First Loss : 0.9210735872302167, Second Loss : 0.9311876825835389
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3472222222222222, precision 0.35927216415021296, recall 0.40888888888888886, F1 0.2590811965811966, AUC 0.71506734006734
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7518181818181818
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7062267293748775
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7338514109347444
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 6 idx: 0 First Loss : 3.5945043563842773, Second Loss : 3.683810234069824
epoch: 6 idx: 200 First Loss : 0.9053609726501082, Second Loss : 0.9102821077141373
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.6836531986531987
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7082828282828283
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4013605442176871, precision 0.441025641025641, recall 0.40329218106995884, F1 0.27843695617781994, AUC 0.6690365961199293
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6835868606701939
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 7 idx: 0 First Loss : 3.6619186401367188, Second Loss : 3.8185501098632812
epoch: 7 idx: 200 First Loss : 0.9106702204997563, Second Loss : 0.9182383690848345
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6729012345679012
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6791414141414142
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.441025641025641, recall 0.3991769547325103, F1 0.2727563334132502, AUC 0.6735682441700961
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6579034391534392
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 8 idx: 0 First Loss : 3.670759439468384, Second Loss : 3.981550931930542
epoch: 8 idx: 200 First Loss : 0.9098328029822595, Second Loss : 0.9242146194191992
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3333333333333333, precision 0.36794171220400734, recall 0.39999999999999997, F1 0.2494623655913978, AUC 0.6681930415263748
  Second-Tier acc 0.3541666666666667, precision 0.3822055137844611, recall 0.41333333333333333, F1 0.27465986394557823, AUC 0.6815151515151515
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.44533333333333336, recall 0.4115226337448559, F1 0.2943313373253493, AUC 0.6479705565353714
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.644455467372134
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 9 idx: 0 First Loss : 3.6963605880737305, Second Loss : 3.904818534851074
epoch: 9 idx: 200 First Loss : 0.9055563212179495, Second Loss : 0.922929604370981
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.5152292152292152, recall 0.43629629629629635, F1 0.30977118430978123, AUC 0.6692255892255892
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.678989898989899
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.49264705882352944, recall 0.4295267489711934, F1 0.32675957813172624, AUC 0.6567399078973154
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6477623456790123
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 10 idx: 0 First Loss : 3.7287790775299072, Second Loss : 3.798799753189087
epoch: 10 idx: 200 First Loss : 0.8969020560830924, Second Loss : 0.9134312207038533
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3680555555555556, precision 0.45271274619100704, recall 0.42703703703703705, F1 0.2925850340136054, AUC 0.6613860830527497
  Second-Tier acc 0.3958333333333333, precision 0.5548245614035088, recall 0.45444444444444443, F1 0.3386930529787673, AUC 0.675050505050505
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5651340996168582, recall 0.4639917695473251, F1 0.3788923387203778, AUC 0.6553314226925339
  Second-Tier acc 0.42857142857142855, precision 0.5228070175438596, recall 0.4490740740740741, F1 0.35198135198135194, AUC 0.6505731922398589
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 11 idx: 0 First Loss : 3.8378114700317383, Second Loss : 3.7906785011291504
epoch: 11 idx: 200 First Loss : 0.8907841191208917, Second Loss : 0.9115741334311706
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.469160188607111, recall 0.422962962962963, F1 0.29017829348135965, AUC 0.6575476992143658
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6747979797979798
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.5127826941986234, recall 0.44084362139917693, F1 0.33822984464820177, AUC 0.6511672055653537
  Second-Tier acc 0.46938775510204084, precision 0.5672514619883041, recall 0.4737654320987654, F1 0.3924741924741925, AUC 0.6539902998236332
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 12 idx: 0 First Loss : 3.786109209060669, Second Loss : 3.7107622623443604
epoch: 12 idx: 200 First Loss : 0.8855156964780699, Second Loss : 0.9078456629037253
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3402777777777778, precision 0.45028011204481794, recall 0.4140740740740741, F1 0.27648914777061234, AUC 0.6552356902356902
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6646464646464646
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5178571428571429, recall 0.4452527924750147, F1 0.3541558441558441, AUC 0.6532493141289438
  Second-Tier acc 0.4489795918367347, precision 0.5394736842105263, recall 0.46141975308641975, F1 0.37229763700351937, AUC 0.6585648148148149
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 13 idx: 0 First Loss : 3.8641433715820312, Second Loss : 3.649298667907715
epoch: 13 idx: 200 First Loss : 0.8883389162088065, Second Loss : 0.9133802879787345
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3402777777777778, precision 0.44180421697869354, recall 0.4140740740740741, F1 0.2767742692303591, AUC 0.6588608305274971
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6673232323232323
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.5098328416912488, recall 0.432907113462669, F1 0.3339287693793846, AUC 0.6597712130119537
  Second-Tier acc 0.3877551020408163, precision 0.5011261261261262, recall 0.4243827160493827, F1 0.3106947079907232, AUC 0.6696979717813051
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 14 idx: 0 First Loss : 3.8905770778656006, Second Loss : 3.691642999649048
epoch: 14 idx: 200 First Loss : 0.8712467289182522, Second Loss : 0.8974688562097008
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.4488267770876466, recall 0.4274074074074074, F1 0.2970072345072345, AUC 0.6587598204264871
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6648484848484848
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5250040990326282, recall 0.45149911816578486, F1 0.37376705013205536, AUC 0.6686324221046444
  Second-Tier acc 0.40816326530612246, precision 0.5116959064327485, recall 0.4367283950617284, F1 0.33127289377289376, AUC 0.6758156966490301
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 15 idx: 0 First Loss : 3.8628623485565186, Second Loss : 3.4548726081848145
epoch: 15 idx: 200 First Loss : 0.8669967882981552, Second Loss : 0.8863715766529274
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.42370448179271714, recall 0.4144444444444444, F1 0.2783488758765271, AUC 0.6609539842873177
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6602020202020201
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.5103842159916926, recall 0.43092298647854205, F1 0.34001783558968923, AUC 0.6756870958259847
  Second-Tier acc 0.40816326530612246, precision 0.5116959064327485, recall 0.4367283950617284, F1 0.33127289377289376, AUC 0.6919642857142857
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 16 idx: 0 First Loss : 4.079641819000244, Second Loss : 3.925386428833008
epoch: 16 idx: 200 First Loss : 0.8649313419092545, Second Loss : 0.8951589550788729
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4384173297966402, recall 0.4144444444444444, F1 0.27735622213091055, AUC 0.6642648709315376
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6644444444444445
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.4752751977984176, recall 0.41901822457378013, F1 0.3173905459619745, AUC 0.6849463550852439
  Second-Tier acc 0.40816326530612246, precision 0.5116959064327485, recall 0.4367283950617284, F1 0.33127289377289376, AUC 0.7062940917107584
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 17 idx: 0 First Loss : 4.030551433563232, Second Loss : 3.906522035598755
epoch: 17 idx: 200 First Loss : 0.8638947273626418, Second Loss : 0.89352093732075
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2986111111111111, precision 0.3856190476190476, recall 0.3825925925925926, F1 0.22370989953948547, AUC 0.6629236812570146
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6677777777777777
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.5059431524547804, recall 0.38609641387419164, F1 0.2589848344883653, AUC 0.6835133744855968
  Second-Tier acc 0.3469387755102041, precision 0.4946581196581197, recall 0.3996913580246913, F1 0.26374430709173713, AUC 0.699239417989418
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 18 idx: 0 First Loss : 4.038541793823242, Second Loss : 3.904306411743164
epoch: 18 idx: 200 First Loss : 0.8581133091082445, Second Loss : 0.8812587326365597
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.5208333333333334, precision 0.38277153558052435, recall 0.5086868686868687, F1 0.39503993274485083, AUC 0.6794837261503929
  Second-Tier acc 0.5416666666666666, precision 0.41239721695129666, recall 0.5333333333333333, F1 0.41269841269841273, AUC 0.6984343434343434
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.5238095238095238, precision 0.37362637362637363, recall 0.458259847148736, F1 0.3801108610943416, AUC 0.6841318832059572
  Second-Tier acc 0.5102040816326531, precision 0.3697729988052569, recall 0.4462081128747795, F1 0.3703703703703704, AUC 0.7083333333333334
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00034763629690654505
epoch: 19 idx: 0 First Loss : 4.700093746185303, Second Loss : 4.551546573638916
epoch: 19 idx: 200 First Loss : 0.8520711499195567, Second Loss : 0.8826848312029161
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2986111111111111, precision 0.3423477564102564, recall 0.37777777777777777, F1 0.212403538490495, AUC 0.6661672278338945
  Second-Tier acc 0.2916666666666667, precision 0.34649122807017546, recall 0.37333333333333335, F1 0.21862538118695754, AUC 0.6674242424242425
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.5209923664122137, recall 0.38609641387419164, F1 0.25958790673507826, AUC 0.6786939055457575
  Second-Tier acc 0.3469387755102041, precision 0.5200655200655201, recall 0.4290123456790123, F1 0.27699149835372744, AUC 0.6983575837742505
Test AUC: 0.7339, Test F1: 0.3221 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.4370823722155295, "droprate_2": 0.0, "lr": 0.00020270750827946772, "weight_decay": 9.827961092579907e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00020270750827946772
epoch: 0 idx: 0 First Loss : 1.270978331565857, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.094297870845344, Second Loss : 1.0869104435936134
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7487654320987653
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7547474747474747
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.713697824808936
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7178130511463845
Test AUC: 0.7178, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00020270750827946772
epoch: 1 idx: 0 First Loss : 1.6817326545715332, Second Loss : 1.748329520225525
epoch: 1 idx: 200 First Loss : 0.9833986108650022, Second Loss : 0.9906943017125722
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7372334455667788
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7328787878787879
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7287808641975309
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7309303350970019
Test AUC: 0.7178, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00020270750827946772
epoch: 2 idx: 0 First Loss : 2.141786813735962, Second Loss : 2.1712486743927
epoch: 2 idx: 200 First Loss : 0.9384906262307617, Second Loss : 0.9586595633433233
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6041666666666666, precision 0.589719195064291, recall 0.5298989898989899, F1 0.5339979877045337, AUC 0.7252244668911336
  Second-Tier acc 0.625, precision 0.40322580645161293, recall 0.5357575757575758, F1 0.4594356261022927, AUC 0.7255555555555556
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.4788208168642951, recall 0.5243974132863022, F1 0.47907965861930063, AUC 0.7149225945522243
  Second-Tier acc 0.5714285714285714, precision 0.36321839080459767, recall 0.43738977072310403, F1 0.3949579831932773, AUC 0.7105930335097002
Test AUC: 0.7178, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00020270750827946772
epoch: 3 idx: 0 First Loss : 2.904160737991333, Second Loss : 3.096252679824829
epoch: 3 idx: 200 First Loss : 0.9113340546140698, Second Loss : 0.9421654842071124
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4166666666666667, precision 0.4881046193102931, recall 0.4549158249158249, F1 0.40755950178813666, AUC 0.7341245791245791
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.748989898989899
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4217687074829932, precision 0.4672321778300039, recall 0.4807466196355085, F1 0.409989727786338, AUC 0.7044140701548111
  Second-Tier acc 0.46938775510204084, precision 0.39316239316239315, recall 0.42151675485008816, F1 0.3433333333333333, AUC 0.7168209876543209
Test AUC: 0.7178, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00020270750827946772
epoch: 4 idx: 0 First Loss : 3.54071044921875, Second Loss : 3.8691818714141846
epoch: 4 idx: 200 First Loss : 0.9092659341039331, Second Loss : 0.9410286805712947
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3611111111111111, precision 0.43341103341103343, recall 0.4225925925925926, F1 0.28663816947447823, AUC 0.759421997755331
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7718686868686868
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.42857142857142855, precision 0.48858331211272393, recall 0.42570546737213405, F1 0.327916809048088, AUC 0.7009847148736036
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7314263668430335
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 5 idx: 0 First Loss : 3.536722183227539, Second Loss : 3.94850492477417
epoch: 5 idx: 200 First Loss : 0.9046834397201533, Second Loss : 0.9336259447082191
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7435521885521886
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7473232323232323
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4217687074829932, precision 0.4435695538057743, recall 0.4156378600823045, F1 0.2976936746929131, AUC 0.6849402312365275
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7103174603174605
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 6 idx: 0 First Loss : 3.4562456607818604, Second Loss : 3.8870794773101807
epoch: 6 idx: 200 First Loss : 0.8971570220851774, Second Loss : 0.9306618684598138
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3472222222222222, precision 0.35927216415021296, recall 0.40888888888888886, F1 0.2590811965811966, AUC 0.7024971941638608
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6991414141414142
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.41496598639455784, precision 0.44623655913978494, recall 0.4115226337448559, F1 0.29534136546184736, AUC 0.6742173721340388
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6704144620811286
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 7 idx: 0 First Loss : 3.648282766342163, Second Loss : 3.9753732681274414
epoch: 7 idx: 200 First Loss : 0.8971765160147073, Second Loss : 0.9256906214596435
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3194444444444444, precision 0.3595430107526882, recall 0.39111111111111113, F1 0.23536548377312708, AUC 0.6648316498316498
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6727777777777778
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.4435695538057743, recall 0.3991769547325103, F1 0.2756461091116127, AUC 0.6720066627474034
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6696979717813051
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 8 idx: 0 First Loss : 3.5583279132843018, Second Loss : 3.9969394207000732
epoch: 8 idx: 200 First Loss : 0.8885938164633838, Second Loss : 0.92062315993406
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3055555555555556, precision 0.3506144393241167, recall 0.38222222222222224, F1 0.22252439228035023, AUC 0.6492536475869809
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.6681313131313131
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.4435695538057743, recall 0.38271604938271603, F1 0.25170197874912514, AUC 0.6644069664902997
  Second-Tier acc 0.3877551020408163, precision 0.4444444444444444, recall 0.3950617283950617, F1 0.2708333333333333, AUC 0.6766975308641975
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 9 idx: 0 First Loss : 3.6355934143066406, Second Loss : 3.901237726211548
epoch: 9 idx: 200 First Loss : 0.8740717273475417, Second Loss : 0.9147843250030923
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3263888888888889, precision 0.3639406982305117, recall 0.3955555555555556, F1 0.2424749163879599, AUC 0.6480190796857465
  Second-Tier acc 0.2708333333333333, precision 0.3055555555555555, recall 0.36000000000000004, F1 0.18095238095238098, AUC 0.6613636363636364
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3741496598639456, precision 0.4427083333333333, recall 0.3868312757201646, F1 0.2569044639132249, AUC 0.6628821281599059
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6704695767195767
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 10 idx: 0 First Loss : 3.866288900375366, Second Loss : 3.7216358184814453
epoch: 10 idx: 200 First Loss : 0.8684327693598748, Second Loss : 0.9090305943289929
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2847222222222222, precision 0.3318551367331855, recall 0.3688888888888889, F1 0.20304114490161, AUC 0.6451178451178451
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6613131313131314
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.44186046511627913, recall 0.3786008230452675, F1 0.24345283498601575, AUC 0.6564092200666275
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6557539682539683
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 11 idx: 0 First Loss : 3.5062503814697266, Second Loss : 3.56660795211792
epoch: 11 idx: 200 First Loss : 0.854621046183724, Second Loss : 0.9044512192461239
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2847222222222222, precision 0.33113391984359725, recall 0.3688888888888889, F1 0.20214289241100084, AUC 0.6460493827160493
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6662626262626262
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.36054421768707484, precision 0.44186046511627913, recall 0.3786008230452675, F1 0.24345283498601575, AUC 0.6598875661375662
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6579034391534392
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 12 idx: 0 First Loss : 3.453599214553833, Second Loss : 3.5082929134368896
epoch: 12 idx: 200 First Loss : 0.8384102844722645, Second Loss : 0.8960188424004188
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2986111111111111, precision 0.3451199338296112, recall 0.37777777777777777, F1 0.21588496429260762, AUC 0.6521661054994389
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.672070707070707
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3741496598639456, precision 0.4435695538057743, recall 0.3868312757201646, F1 0.25787905493306473, AUC 0.6612899274936311
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6473214285714285
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 13 idx: 0 First Loss : 3.4517757892608643, Second Loss : 3.547344207763672
epoch: 13 idx: 200 First Loss : 0.8322562899053417, Second Loss : 0.8915759378340687
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2916666666666667, precision 0.3628912071535022, recall 0.3781481481481481, F1 0.21813538491005727, AUC 0.6537542087542086
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6758080808080807
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.4806065908428114, recall 0.3924897119341564, F1 0.2655926385023375, AUC 0.6605611894963747
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6463293650793651
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 14 idx: 0 First Loss : 3.407827138900757, Second Loss : 3.5217745304107666
epoch: 14 idx: 200 First Loss : 0.8187917332647364, Second Loss : 0.8810144849754326
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2916666666666667, precision 0.3651884700665189, recall 0.3781481481481481, F1 0.2175338985247984, AUC 0.6547025813692481
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6796464646464647
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.47222222222222215, recall 0.3842592592592593, F1 0.2518518518518518, AUC 0.6564459631589261
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.650407848324515
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 15 idx: 0 First Loss : 3.3860244750976562, Second Loss : 3.545154571533203
epoch: 15 idx: 200 First Loss : 0.8115630994885324, Second Loss : 0.8755616698849306
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2777777777777778, precision 0.335050404342528, recall 0.36925925925925923, F1 0.20589302820965946, AUC 0.654006734006734
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6766666666666667
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.32653061224489793, precision 0.4777106701179177, recall 0.3699294532627866, F1 0.23958638944849753, AUC 0.6552028218694885
  Second-Tier acc 0.3469387755102041, precision 0.43703703703703706, recall 0.3703703703703704, F1 0.2248587570621469, AUC 0.6556988536155203
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 16 idx: 0 First Loss : 3.3898868560791016, Second Loss : 3.5546391010284424
epoch: 16 idx: 200 First Loss : 0.8106995119453213, Second Loss : 0.8804585734882069
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2777777777777778, precision 0.3352102102102102, recall 0.36925925925925923, F1 0.2115079365079365, AUC 0.6447138047138047
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6595959595959595
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.32653061224489793, precision 0.48739495798319327, recall 0.3720605526161082, F1 0.2548246439550787, AUC 0.6585709386635313
  Second-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6605489417989419
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 17 idx: 0 First Loss : 3.7334671020507812, Second Loss : 3.857191801071167
epoch: 17 idx: 200 First Loss : 0.7991638464288475, Second Loss : 0.8665114493166236
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.38917456476440143, recall 0.38296296296296295, F1 0.2274489865093892, AUC 0.6570763187429854
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6691919191919192
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.32653061224489793, precision 0.48928571428571427, recall 0.3758818342151676, F1 0.25091528309919114, AUC 0.6629617381932197
  Second-Tier acc 0.3469387755102041, precision 0.43478260869565216, recall 0.3703703703703704, F1 0.22222222222222224, AUC 0.6823743386243386
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 18 idx: 0 First Loss : 3.846789598464966, Second Loss : 4.2661285400390625
epoch: 18 idx: 200 First Loss : 0.8001122043118839, Second Loss : 0.8606732697227284
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.4562366281557552, recall 0.42, F1 0.2800479515464455, AUC 0.6585465768799103
  Second-Tier acc 0.2916666666666667, precision 0.35185185185185186, recall 0.37333333333333335, F1 0.22499388603570555, AUC 0.6655050505050505
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.32653061224489793, precision 0.5080054505195026, recall 0.3996913580246914, F1 0.282165368928439, AUC 0.6582524985302763
  Second-Tier acc 0.32653061224489793, precision 0.4837837837837838, recall 0.3758818342151676, F1 0.25294868905416573, AUC 0.6754298941798943
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.00020270750827946772
epoch: 19 idx: 0 First Loss : 3.7503554821014404, Second Loss : 4.167819023132324
epoch: 19 idx: 200 First Loss : 0.7948443439810777, Second Loss : 0.8647743201693378
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3402777777777778, precision 0.42905715477680434, recall 0.4381481481481482, F1 0.31163109480587453, AUC 0.674388327721661
  Second-Tier acc 0.2916666666666667, precision 0.35784313725490197, recall 0.37333333333333335, F1 0.23192848020434229, AUC 0.6604040404040404
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.54026284348865, recall 0.46759259259259256, F1 0.3457863660762211, AUC 0.6738254458161865
  Second-Tier acc 0.3469387755102041, precision 0.517117117117117, recall 0.41754850088183426, F1 0.28998572609120277, AUC 0.6911926807760141
Test AUC: 0.7314, Test F1: 0.3395 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.23496930138496575, "droprate_2": 0.0, "lr": 7.586623897667299e-05, "weight_decay": 4.919172361968822e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.05347129657120651, "droprate_2": 0.0, "lr": 0.0002012125253861091, "weight_decay": 9.724932255421515e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0002012125253861091
epoch: 0 idx: 0 First Loss : 1.1369590759277344, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0763366448493739, Second Loss : 1.0783380752994647
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7435690235690235
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7676262626262625
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7291666666666666
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113646384479718
Test AUC: 0.7114, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002012125253861091
epoch: 1 idx: 0 First Loss : 1.7659317255020142, Second Loss : 1.8281099796295166
epoch: 1 idx: 200 First Loss : 0.9917235805917142, Second Loss : 0.9719127845853123
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7358698092031425
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7443434343434344
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7280092592592592
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7273478835978837
Test AUC: 0.7114, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002012125253861091
epoch: 2 idx: 0 First Loss : 2.349687099456787, Second Loss : 2.391606569290161
epoch: 2 idx: 200 First Loss : 0.9427330300434312, Second Loss : 0.9445275016759166
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.3736449204803635, recall 0.5107070707070708, F1 0.405952380952381, AUC 0.723709315375982
  Second-Tier acc 0.6458333333333334, precision 0.6112278244631186, recall 0.5967676767676767, F1 0.5905595954857038, AUC 0.7437878787878788
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5374149659863946, precision 0.3667783569123852, recall 0.4397413286302176, F1 0.38452862980013686, AUC 0.7298586615716246
  Second-Tier acc 0.5306122448979592, precision 0.4763708513708514, recall 0.5134479717813051, F1 0.4804040404040404, AUC 0.7291115520282188
Test AUC: 0.7114, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002012125253861091
epoch: 3 idx: 0 First Loss : 3.172337293624878, Second Loss : 3.224107265472412
epoch: 3 idx: 200 First Loss : 0.9222740808789113, Second Loss : 0.9259905949494436
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4722222222222222, precision 0.5452633993424574, recall 0.5384848484848485, F1 0.46688963210702344, AUC 0.742962962962963
  Second-Tier acc 0.4166666666666667, precision 0.45784313725490194, recall 0.4677777777777778, F1 0.357010582010582, AUC 0.7616161616161617
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5102040816326531, precision 0.5414562977492038, recall 0.5741475602586714, F1 0.5062558356676004, AUC 0.7523086909660984
  Second-Tier acc 0.5102040816326531, precision 0.5735930735930735, recall 0.47552910052910047, F1 0.43200138384362563, AUC 0.7425595238095238
Test AUC: 0.7114, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002012125253861091
epoch: 4 idx: 0 First Loss : 3.445805549621582, Second Loss : 3.6260874271392822
epoch: 4 idx: 200 First Loss : 0.9164208410659906, Second Loss : 0.9197455040359898
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3958333333333333, precision 0.7121115368241805, recall 0.4448148148148148, F1 0.31599582211504834, AUC 0.7667508417508418
  Second-Tier acc 0.3958333333333333, precision 0.3657657657657658, recall 0.44, F1 0.30515873015873013, AUC 0.7857070707070708
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.47619047619047616, precision 0.5355072463768116, recall 0.45451205173427395, F1 0.3691610109830176, AUC 0.7449049578679209
  Second-Tier acc 0.4897959183673469, precision 0.5274509803921569, recall 0.474647266313933, F1 0.412017787017787, AUC 0.732583774250441
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 5 idx: 0 First Loss : 3.5173447132110596, Second Loss : 3.7235610485076904
epoch: 5 idx: 200 First Loss : 0.912434632032739, Second Loss : 0.914840831310113
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.375, precision 0.4298245614035088, recall 0.4314814814814814, F1 0.3002130144987288, AUC 0.7213187429854097
  Second-Tier acc 0.3958333333333333, precision 0.3657657657657658, recall 0.44, F1 0.30515873015873013, AUC 0.707929292929293
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4557823129251701, precision 0.49107142857142855, recall 0.43452380952380953, F1 0.35633116883116883, AUC 0.7058837938467568
  Second-Tier acc 0.4489795918367347, precision 0.45045045045045046, recall 0.42063492063492064, F1 0.33660130718954245, AUC 0.673886684303351
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 6 idx: 0 First Loss : 3.6016547679901123, Second Loss : 3.7171170711517334
epoch: 6 idx: 200 First Loss : 0.9100850267331139, Second Loss : 0.9142982859352131
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.43115000941087894, recall 0.42703703703703705, F1 0.29473671705750343, AUC 0.6841975308641975
  Second-Tier acc 0.375, precision 0.3881578947368421, recall 0.4266666666666667, F1 0.29107400535971967, AUC 0.69
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.4899425287356322, recall 0.4259994121105232, F1 0.33704560207724765, AUC 0.6777508328434254
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6469907407407408
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 7 idx: 0 First Loss : 3.6181726455688477, Second Loss : 3.760929822921753
epoch: 7 idx: 200 First Loss : 0.9096344869673039, Second Loss : 0.9084462873557749
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3680555555555556, precision 0.38307541144681895, recall 0.4222222222222222, F1 0.2817497860071181, AUC 0.668557800224467
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.682020202020202
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.4462809917355372, recall 0.42416225749559083, F1 0.32007011393514456, AUC 0.667836321771507
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6481481481481483
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 8 idx: 0 First Loss : 3.5069377422332764, Second Loss : 3.67301869392395
epoch: 8 idx: 200 First Loss : 0.9014229907344943, Second Loss : 0.903613952757091
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3680555555555556, precision 0.4644324601951721, recall 0.42703703703703705, F1 0.2929462233449398, AUC 0.6653591470258137
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6739393939393938
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4421768707482993, precision 0.5148459383753502, recall 0.4339359200470312, F1 0.3401966599118023, AUC 0.6738131981187537
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6440145502645502
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 9 idx: 0 First Loss : 3.505032777786255, Second Loss : 3.5723485946655273
epoch: 9 idx: 200 First Loss : 0.8970873343760601, Second Loss : 0.8978275693996476
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3472222222222222, precision 0.3742424242424242, recall 0.40888888888888886, F1 0.262155388471178, AUC 0.6594276094276094
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.666919191919192
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.5304878048780488, recall 0.4295267489711934, F1 0.3255196948266255, AUC 0.6700409073094259
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6452821869488535
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 10 idx: 0 First Loss : 3.469167947769165, Second Loss : 3.452627182006836
epoch: 10 idx: 200 First Loss : 0.8917844071862663, Second Loss : 0.8928421111652901
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4371031746031746, recall 0.4274074074074074, F1 0.29880016132284737, AUC 0.6531649831649832
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6656060606060605
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.42857142857142855, precision 0.5117554858934169, recall 0.4354791299235743, F1 0.3431042200060874, AUC 0.6800840192043895
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6781856261022928
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 11 idx: 0 First Loss : 3.610872507095337, Second Loss : 3.6345059871673584
epoch: 11 idx: 200 First Loss : 0.8912267218591803, Second Loss : 0.8828859741532241
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.4321092278719398, recall 0.4181481481481481, F1 0.28086662572546156, AUC 0.6580864197530865
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6634848484848485
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.4852163087457206, recall 0.41747501469723697, F1 0.3166409435974653, AUC 0.6775609935332157
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6676036155202821
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 12 idx: 0 First Loss : 3.4540042877197266, Second Loss : 3.373400926589966
epoch: 12 idx: 200 First Loss : 0.8888016901551213, Second Loss : 0.877546756977183
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3125, precision 0.38464476699770817, recall 0.3914814814814815, F1 0.24131824301370208, AUC 0.6572558922558922
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6623737373737373
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.4814207650273224, recall 0.4089506172839506, F1 0.29450621712099473, AUC 0.680451450127376
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6884369488536155
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 13 idx: 0 First Loss : 3.5220985412597656, Second Loss : 3.4282500743865967
epoch: 13 idx: 200 First Loss : 0.8726189544635671, Second Loss : 0.8692603319751149
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3194444444444444, precision 0.4149477973007385, recall 0.4007407407407408, F1 0.25550264017682267, AUC 0.6578338945005612
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.666010101010101
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.47839046199701935, recall 0.40483539094650206, F1 0.28802494039977994, AUC 0.6832439251420733
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6943893298059965
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4)
Current LR: 0.0002012125253861091
epoch: 14 idx: 0 First Loss : 3.615950584411621, Second Loss : 3.5176010131835938
epoch: 14 idx: 200 First Loss : 0.8765561003711081, Second Loss : 0.8683908200797141
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2986111111111111, precision 0.37646751490564884, recall 0.3874074074074074, F1 0.2348237432917809, AUC 0.6567845117845118
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6683333333333333
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3673469387755102, precision 0.4844827586206897, recall 0.3984420928865373, F1 0.2830089558212839, AUC 0.6869243582206545
  Second-Tier acc 0.3673469387755102, precision 0.44186046511627913, recall 0.38271604938271603, F1 0.24976419543482362, AUC 0.7047508818342152
Test AUC: 0.7326, Test F1: 0.4120 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.2352203097561919, "droprate_2": 0.0, "lr": 0.0006252586492165463, "weight_decay": 0.0005343534074022217, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1589206457138062, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0905283615919785, Second Loss : 1.091611424136666
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7263243546576881
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7378787878787878{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.2751475758789336, "droprate_2": 0.0, "lr": 0.0002453761536245104, "weight_decay": 0.00013475575903040842, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1629456281661987, Second Loss : 1.03431236743927{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.23622173008980593, "droprate_2": 0.0, "lr": 0.00038865359654571987, "weight_decay": 0.0004814564539874111, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.158687710762024, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.098444800990731, Second Loss : 1.0870811505919664
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7355555555555555
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7478282828282828{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.27408161879906523, "droprate_2": 0.0, "lr": 6.189586680777743e-05, "weight_decay": 3.0467579500979177e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.15483829074439212, "droprate_2": 0.0, "lr": 3.451538441895153e-05, "weight_decay": 6.016214475625784e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.05966181778697607, "droprate_2": 0.0, "lr": 0.0004806646592273779, "weight_decay": 3.0101979206282958e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.0351027418886384, "droprate_2": 0.0, "lr": 3.3676199702408155e-05, "weight_decay": 0.00011275938116241672, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.22690603250144412, "droprate_2": 0.0, "lr": 0.00011750201501209415, "weight_decay": 0.0002490678114193075, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1636759042739868, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1061700184398622, Second Loss : 1.101567261995961{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.17590119968234463, "droprate_2": 0.0, "lr": 1.9942908591595166e-05, "weight_decay": 2.1136928952143094e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0794718265533447, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0931645962432843, Second Loss : 1.0871426356372549
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7217424242424242
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7077272727272726
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6399257330246914
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6358575837742504
epoch: 1 idx: 0 First Loss : 1.9677785634994507, Second Loss : 2.0018086433410645
epoch: 1 idx: 200 First Loss : 1.0978311538992829, Second Loss : 1.0944812177722134
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7435069444444444
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7387373737373738
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.68181285824515
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6769179894179894
epoch: 2 idx: 0 First Loss : 2.05625057220459, Second Loss : 2.089993476867676
epoch: 2 idx: 200 First Loss : 1.0706265356706743, Second Loss : 1.0724077573166557
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7428945707070707
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495959595959597
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7010582010582009
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.697365520282187
epoch: 3 idx: 0 First Loss : 2.1663599014282227, Second Loss : 2.212141275405884
epoch: 3 idx: 200 First Loss : 1.0454526677801834, Second Loss : 1.050989998106043
  First-Tier acc 0.578125, precision 0.4065891472868217, recall 0.4251515151515151, F1 0.37561274509803927, AUC 0.7395170454545456
  Second-Tier acc 0.5416666666666666, precision 0.404040404040404, recall 0.3806060606060606, F1 0.3271221532091097, AUC 0.7454040404040404
  First-Tier acc 0.5867346938775511, precision 0.3458333333333334, recall 0.375, F1 0.3148148148148148, AUC 0.6930183531746031
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.6948853615520282
epoch: 4 idx: 0 First Loss : 2.318190097808838, Second Loss : 2.378509044647217
epoch: 4 idx: 200 First Loss : 1.020496148819947, Second Loss : 1.027126412375353
  First-Tier acc 0.671875, precision 0.6319975713418337, recall 0.5893181818181819, F1 0.5283946494499174, AUC 0.738866792929293
  Second-Tier acc 0.6458333333333334, precision 0.6267195767195767, recall 0.5220202020202019, F1 0.526984126984127, AUC 0.7544949494949496
  First-Tier acc 0.5612244897959183, precision 0.5299403086288332, recall 0.455136684303351, F1 0.4620647854692939, AUC 0.6820953207671957
  Second-Tier acc 0.5510204081632653, precision 0.48227969348659006, recall 0.5143298059964727, F1 0.4837662337662338, AUC 0.683476631393298
epoch: 5 idx: 0 First Loss : 2.5046355724334717, Second Loss : 2.573580503463745
epoch: 5 idx: 200 First Loss : 0.9954644898091679, Second Loss : 1.002403998070985
  First-Tier acc 0.609375, precision 0.5837521755396152, recall 0.5903030303030303, F1 0.5511441414444112, AUC 0.7436363636363637
  Second-Tier acc 0.6458333333333334, precision 0.5870175438596491, recall 0.5628282828282828, F1 0.5409318996415771, AUC 0.756010101010101
  First-Tier acc 0.5969387755102041, precision 0.5896331677856174, recall 0.5962301587301587, F1 0.584748813614793, AUC 0.691426917989418
  Second-Tier acc 0.5102040816326531, precision 0.4568840579710145, recall 0.5189594356261024, F1 0.4633333333333334, AUC 0.6979166666666666
epoch: 6 idx: 0 First Loss : 2.6974520683288574, Second Loss : 2.7853844165802
epoch: 6 idx: 200 First Loss : 0.9734717975393753, Second Loss : 0.9790257443465403
  First-Tier acc 0.5625, precision 0.5591935142496941, recall 0.578989898989899, F1 0.5328338564341398, AUC 0.755965909090909
  Second-Tier acc 0.5625, precision 0.5438034188034188, recall 0.5528282828282829, F1 0.4990561051121347, AUC 0.7693434343434343
  First-Tier acc 0.5714285714285714, precision 0.573052459222873, recall 0.6292438271604938, F1 0.5741867767884029, AUC 0.7039000496031745
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.7202380952380952
epoch: 7 idx: 0 First Loss : 2.8694114685058594, Second Loss : 2.976353645324707
epoch: 7 idx: 200 First Loss : 0.9591943174044588, Second Loss : 0.9622634053415623
  First-Tier acc 0.5416666666666666, precision 0.5803617661261701, recall 0.5994191919191919, F1 0.533834655974601, AUC 0.7638226010101009
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7756060606060605
  First-Tier acc 0.5255102040816326, precision 0.5377661339109733, recall 0.595734126984127, F1 0.5246945227719388, AUC 0.7156876929012346
  Second-Tier acc 0.4897959183673469, precision 0.49523809523809526, recall 0.5767195767195767, F1 0.4761904761904761, AUC 0.7283950617283951
epoch: 8 idx: 0 First Loss : 3.0010576248168945, Second Loss : 3.1301259994506836
epoch: 8 idx: 200 First Loss : 0.9497152969092872, Second Loss : 0.9502246917702666
  First-Tier acc 0.4947916666666667, precision 0.5586586586586586, recall 0.5675252525252525, F1 0.49318969393070816, AUC 0.77208648989899
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7923737373737373
  First-Tier acc 0.5102040816326531, precision 0.5430118535708598, recall 0.5966710758377425, F1 0.5106227706143559, AUC 0.7246024856701939
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.7404651675485009
epoch: 9 idx: 0 First Loss : 3.107029676437378, Second Loss : 3.255855083465576
epoch: 9 idx: 200 First Loss : 0.9438055764040469, Second Loss : 0.9413028514633576
  First-Tier acc 0.484375, precision 0.5533440773569701, recall 0.5638383838383838, F1 0.48459509104487175, AUC 0.7759406565656565
  Second-Tier acc 0.5, precision 0.5521367521367522, recall 0.5467676767676767, F1 0.48035305655442956, AUC 0.8079797979797979
  First-Tier acc 0.5, precision 0.5462183235867446, recall 0.5949625220458553, F1 0.5004683077800175, AUC 0.7300553902116401
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.75027557319224{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.14128522220602077, "droprate_2": 0.0, "lr": 2.0696009376463994e-05, "weight_decay": 3.7757675997058014e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 16, "gamma": 0.291009025686279, "T_max": 34, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0832257270812988, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0971986759657884, Second Loss : 1.0898302531064445
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7216382575757576
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7078787878787879
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.640742118606702
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6370701058201057
epoch: 1 idx: 0 First Loss : 1.9860256910324097, Second Loss : 2.004343032836914
epoch: 1 idx: 200 First Loss : 1.0966180859513543, Second Loss : 1.0931476585159254
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7436868686868686
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7412121212121212
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.683821097883598
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6773589065255732
epoch: 2 idx: 0 First Loss : 2.089442253112793, Second Loss : 2.0934946537017822
epoch: 2 idx: 200 First Loss : 1.0687108839774013, Second Loss : 1.0707275478994076
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7425883838383838
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482828282828282
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.701123649691358
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6984126984126985
epoch: 3 idx: 0 First Loss : 2.2190537452697754, Second Loss : 2.2278666496276855
epoch: 3 idx: 200 First Loss : 1.0436804757930747, Second Loss : 1.048800540911914
  First-Tier acc 0.578125, precision 0.37912457912457914, recall 0.4336363636363636, F1 0.38235450438479934, AUC 0.7409217171717172
  Second-Tier acc 0.5833333333333334, precision 0.5840108401084011, recall 0.4361616161616162, F1 0.42099567099567103, AUC 0.7476262626262624
  First-Tier acc 0.5867346938775511, precision 0.3418574685300822, recall 0.3778659611992945, F1 0.32140350877192986, AUC 0.6890742118606702
  Second-Tier acc 0.6122448979591837, precision 0.45, recall 0.4583333333333333, F1 0.4166666666666667, AUC 0.693617724867725
epoch: 4 idx: 0 First Loss : 2.384157419204712, Second Loss : 2.395357131958008
epoch: 4 idx: 200 First Loss : 1.017614072272137, Second Loss : 1.023654139160517
  First-Tier acc 0.6666666666666666, precision 0.6462121212121211, recall 0.5895959595959596, F1 0.5312008978675645, AUC 0.7416887626262626
  Second-Tier acc 0.7083333333333334, precision 0.75, recall 0.6078787878787879, F1 0.6251461988304093, AUC 0.7515656565656564
  First-Tier acc 0.5561224489795918, precision 0.5422705314009661, recall 0.4651124338624339, F1 0.4742758526973774, AUC 0.683517967372134
  Second-Tier acc 0.5102040816326531, precision 0.4285714285714286, recall 0.4781746031746032, F1 0.4331890331890332, AUC 0.6835868606701941
epoch: 5 idx: 0 First Loss : 2.5792734622955322, Second Loss : 2.602114677429199
epoch: 5 idx: 200 First Loss : 0.9926444456277795, Second Loss : 0.9979620509183229
  First-Tier acc 0.609375, precision 0.5862134077259493, recall 0.5945454545454546, F1 0.5522944911304534, AUC 0.747354797979798
  Second-Tier acc 0.5833333333333334, precision 0.6170634920634921, recall 0.5372727272727272, F1 0.5082815734989649, AUC 0.7592424242424243
  First-Tier acc 0.5867346938775511, precision 0.5767981014968967, recall 0.5900573192239859, F1 0.5740004580164728, AUC 0.6940345293209876
  Second-Tier acc 0.5102040816326531, precision 0.4600713012477719, recall 0.5189594356261024, F1 0.4610204081632652, AUC 0.7008928571428571
epoch: 6 idx: 0 First Loss : 2.7758307456970215, Second Loss : 2.8071725368499756
epoch: 6 idx: 200 First Loss : 0.9726413954512694, Second Loss : 0.9758202946601222
  First-Tier acc 0.578125, precision 0.5891807957025348, recall 0.6004545454545455, F1 0.553211836881992, AUC 0.759447601010101
  Second-Tier acc 0.5416666666666666, precision 0.5358024691358024, recall 0.5394949494949496, F1 0.4831322272498743, AUC 0.7669191919191919
  First-Tier acc 0.5714285714285714, precision 0.5763532763532764, recall 0.6321097883597884, F1 0.5749663061796645, AUC 0.7061459711199295
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.7232142857142857
epoch: 7 idx: 0 First Loss : 2.9388115406036377, Second Loss : 2.9831058979034424
epoch: 7 idx: 200 First Loss : 0.959322365853398, Second Loss : 0.9597532719243966
  First-Tier acc 0.5364583333333334, precision 0.581857219538379, recall 0.5948232323232324, F1 0.5323216044408631, AUC 0.7659343434343434
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7748989898989899
  First-Tier acc 0.5255102040816326, precision 0.5380898543702387, recall 0.595734126984127, F1 0.5253478949349016, AUC 0.7182057429453262
  Second-Tier acc 0.4897959183673469, precision 0.49621489621489623, recall 0.5767195767195767, F1 0.4731496685519674, AUC 0.7272927689594356
epoch: 8 idx: 0 First Loss : 3.0641298294067383, Second Loss : 3.123124361038208
epoch: 8 idx: 200 First Loss : 0.9508698898928231, Second Loss : 0.9486277040687219
  First-Tier acc 0.5052083333333334, precision 0.5673056423563523, recall 0.5814141414141414, F1 0.5049324671814648, AUC 0.7756755050505051
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7875757575757576
  First-Tier acc 0.5, precision 0.5344465058750774, recall 0.5847663139329806, F1 0.5001870230716042, AUC 0.7270688657407408
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.738260582010582
epoch: 9 idx: 0 First Loss : 3.163482666015625, Second Loss : 3.2339677810668945
epoch: 9 idx: 200 First Loss : 0.9457973518237397, Second Loss : 0.9403938259651412
  First-Tier acc 0.4791666666666667, precision 0.5503001024740155, recall 0.5611363636363637, F1 0.4782766330291861, AUC 0.7785321969696969
  Second-Tier acc 0.5, precision 0.5521367521367522, recall 0.5467676767676767, F1 0.48035305655442956, AUC 0.8016666666666667
  First-Tier acc 0.5051020408163265, precision 0.5500682980135034, recall 0.6009149029982362, F1 0.5061601423322232, AUC 0.7316778273809522
  Second-Tier acc 0.4489795918367347, precision 0.4722832722832723, recall 0.5520282186948854, F1 0.44252873563218387, AUC 0.744378306878307{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.17895943581817997, "droprate_2": 0.0, "lr": 1.7374194230215506e-05, "weight_decay": 1.6911721505176423e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 10, "gamma": 0.674525944186916, "T_max": 9, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0798289775848389, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0828477746218592, Second Loss : 1.076576431888846
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7199905303030304
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7067171717171717
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6326471560846562
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6321097883597884
epoch: 1 idx: 0 First Loss : 1.9485443830490112, Second Loss : 1.9768863916397095
epoch: 1 idx: 200 First Loss : 1.1011647153553086, Second Loss : 1.097430080768481
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7391224747474747
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7307575757575758
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6754126708553793
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6740520282186949
epoch: 2 idx: 0 First Loss : 2.0334386825561523, Second Loss : 2.051804542541504
epoch: 2 idx: 200 First Loss : 1.0769786532986816, Second Loss : 1.078031259908605
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7434627525252525
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7458080808080808
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.697038277116402
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6927910052910052
epoch: 3 idx: 0 First Loss : 2.132038116455078, Second Loss : 2.1625075340270996
epoch: 3 idx: 200 First Loss : 1.055495904823441, Second Loss : 1.0605991149867946
  First-Tier acc 0.5625, precision 0.48131868131868133, recall 0.3981818181818182, F1 0.34515366430260047, AUC 0.7414141414141415
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7475757575757576
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.6989466214726631
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6930665784832449
epoch: 4 idx: 0 First Loss : 2.2577381134033203, Second Loss : 2.2951912879943848
epoch: 4 idx: 200 First Loss : 1.0334425007007015, Second Loss : 1.0407702114006774
  First-Tier acc 0.6458333333333334, precision 0.5894726247987118, recall 0.5357323232323232, F1 0.48030358227079545, AUC 0.7408901515151515
  Second-Tier acc 0.5833333333333334, precision 0.5146520146520147, recall 0.4336363636363636, F1 0.4065452091767881, AUC 0.7492929292929292
  First-Tier acc 0.5918367346938775, precision 0.5788100788100788, recall 0.4319334215167549, F1 0.430323110098391, AUC 0.6863081459435628
  Second-Tier acc 0.6326530612244898, precision 0.4315245478036176, recall 0.5, F1 0.44761904761904764, AUC 0.6879960317460316
epoch: 5 idx: 0 First Loss : 2.4141416549682617, Second Loss : 2.4592816829681396
epoch: 5 idx: 200 First Loss : 1.0113797768283246, Second Loss : 1.0177842232570127
  First-Tier acc 0.640625, precision 0.5947310947310948, recall 0.5801515151515151, F1 0.5315587010206321, AUC 0.7407228535353535
  Second-Tier acc 0.6458333333333334, precision 0.5957307060755336, recall 0.5509090909090909, F1 0.5504510921177589, AUC 0.7459595959595959
  First-Tier acc 0.5816326530612245, precision 0.5461049284578697, recall 0.5168650793650794, F1 0.5208791208791209, AUC 0.6879822530864197
  Second-Tier acc 0.4897959183673469, precision 0.4123931623931624, recall 0.4658289241622575, F1 0.419370074825366, AUC 0.6905864197530865
epoch: 6 idx: 0 First Loss : 2.5929415225982666, Second Loss : 2.651326894760132
epoch: 6 idx: 200 First Loss : 0.9885913991179336, Second Loss : 0.9947021494790986
  First-Tier acc 0.5989583333333334, precision 0.5790607601065118, recall 0.591489898989899, F1 0.5492269862050153, AUC 0.7485069444444444
  Second-Tier acc 0.5833333333333334, precision 0.6170634920634921, recall 0.5372727272727272, F1 0.5082815734989649, AUC 0.7623232323232324
  First-Tier acc 0.5714285714285714, precision 0.5595405532114394, recall 0.5807980599647267, F1 0.5584266885254433, AUC 0.6956294091710759
  Second-Tier acc 0.5306122448979592, precision 0.49282743400390466, recall 0.5427689594356261, F1 0.4888888888888889, AUC 0.7045304232804233
epoch: 7 idx: 0 First Loss : 2.7646403312683105, Second Loss : 2.8318283557891846
epoch: 7 idx: 200 First Loss : 0.9713018605142684, Second Loss : 0.9753762203551347
  First-Tier acc 0.5729166666666666, precision 0.59236395674052, recall 0.6085858585858587, F1 0.554912802945774, AUC 0.7585321969696969
  Second-Tier acc 0.5, precision 0.5082417582417582, recall 0.5128282828282829, F1 0.4503898635477583, AUC 0.7700505050505052
  First-Tier acc 0.5510204081632653, precision 0.5554859370648845, recall 0.611166225749559, F1 0.5488643581488052, AUC 0.7060391865079364
  Second-Tier acc 0.5102040816326531, precision 0.49317738791423005, recall 0.5597442680776014, F1 0.48281101614434946, AUC 0.7226080246913581
epoch: 8 idx: 0 First Loss : 2.913081645965576, Second Loss : 2.9982879161834717
epoch: 8 idx: 200 First Loss : 0.9587851442415175, Second Loss : 0.9604962586207473
  First-Tier acc 0.5260416666666666, precision 0.569749252357948, recall 0.5803030303030303, F1 0.5205741576626877, AUC 0.765501893939394
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.773888888888889
  First-Tier acc 0.5255102040816326, precision 0.541904761904762, recall 0.6030643738977072, F1 0.5254948779911975, AUC 0.7175202546296294
  Second-Tier acc 0.4897959183673469, precision 0.49621489621489623, recall 0.5767195767195767, F1 0.4731496685519674, AUC 0.7277888007054675
epoch: 9 idx: 0 First Loss : 3.033829927444458, Second Loss : 3.135633707046509
epoch: 9 idx: 200 First Loss : 0.9504779480323566, Second Loss : 0.9500207183650922
  First-Tier acc 0.5, precision 0.5627681616487586, recall 0.574469696969697, F1 0.4991081875562992, AUC 0.7728472222222221
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.7896969696969697
  First-Tier acc 0.5102040816326531, precision 0.5437755102040817, recall 0.6011353615520282, F1 0.5108672344170958, AUC 0.7249641754850088
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.7376543209876543{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.17663195643106308, "droprate_2": 0.0, "lr": 1.7414964415236327e-05, "weight_decay": 0.00010783639078517538, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0794235467910767, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.082745164484527, Second Loss : 1.0767867612601512
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7194539141414142
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7048989898989899
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6325197034832452
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6318342151675485
epoch: 1 idx: 0 First Loss : 1.948406457901001, Second Loss : 1.9762561321258545
epoch: 1 idx: 200 First Loss : 1.0993481672818388, Second Loss : 1.0954877329406454
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7394823232323232
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7307070707070707
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6747719631834216
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6723985890652558
epoch: 2 idx: 0 First Loss : 2.03562068939209, Second Loss : 2.0550098419189453
epoch: 2 idx: 200 First Loss : 1.0757074632603139, Second Loss : 1.076545980884068
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7432196969696969
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7434343434343434
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6978477733686065
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6940035273368608
epoch: 3 idx: 0 First Loss : 2.1300854682922363, Second Loss : 2.16072940826416
epoch: 3 idx: 200 First Loss : 1.0549239162262993, Second Loss : 1.0595882337039977
  First-Tier acc 0.5520833333333334, precision 0.5125448028673835, recall 0.37878787878787873, F1 0.3131002331002331, AUC 0.74125
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.747171717171717
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.7021501598324514
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6976962081128747
epoch: 4 idx: 0 First Loss : 2.256970167160034, Second Loss : 2.2945892810821533
epoch: 4 idx: 200 First Loss : 1.0330430326696058, Second Loss : 1.0400483710552328
  First-Tier acc 0.609375, precision 0.5596440596440596, recall 0.4784595959595959, F1 0.43196850393700786, AUC 0.7392739898989898
  Second-Tier acc 0.5833333333333334, precision 0.5333333333333333, recall 0.4336363636363636, F1 0.4085470085470086, AUC 0.7459090909090907
  First-Tier acc 0.6071428571428571, precision 0.5704607046070461, recall 0.43546075837742504, F1 0.42745098039215684, AUC 0.6902075066137566
  Second-Tier acc 0.6326530612244898, precision 0.4315245478036176, recall 0.5, F1 0.44761904761904764, AUC 0.6966490299823632
epoch: 5 idx: 0 First Loss : 2.4183104038238525, Second Loss : 2.4603092670440674
epoch: 5 idx: 200 First Loss : 1.0102043643742058, Second Loss : 1.0179080826726126
  First-Tier acc 0.6510416666666666, precision 0.6130368814192343, recall 0.5904292929292929, F1 0.5471174004192872, AUC 0.7394286616161616
  Second-Tier acc 0.6666666666666666, precision 0.6289419392867669, recall 0.5812121212121212, F1 0.5884676833696442, AUC 0.7474747474747474
  First-Tier acc 0.6071428571428571, precision 0.591462281679673, recall 0.5616181657848324, F1 0.5699233847913093, AUC 0.6891362158289241
  Second-Tier acc 0.4897959183673469, precision 0.4123931623931624, recall 0.4658289241622575, F1 0.419370074825366, AUC 0.6916335978835978
epoch: 6 idx: 0 First Loss : 2.592066764831543, Second Loss : 2.6507606506347656
epoch: 6 idx: 200 First Loss : 0.9871472345655831, Second Loss : 0.9938900801561662
  First-Tier acc 0.609375, precision 0.5843373493975904, recall 0.5981565656565656, F1 0.5570293412038604, AUC 0.7462752525252525
  Second-Tier acc 0.6041666666666666, precision 0.6062049062049062, recall 0.5675757575757575, F1 0.547847399829497, AUC 0.7622727272727273
  First-Tier acc 0.5867346938775511, precision 0.5751180836707152, recall 0.6047178130511464, F1 0.5788005262441591, AUC 0.6955846285273367
  Second-Tier acc 0.5102040816326531, precision 0.4600713012477719, recall 0.5189594356261024, F1 0.4610204081632652, AUC 0.7035383597883597
epoch: 7 idx: 0 First Loss : 2.7625372409820557, Second Loss : 2.832256555557251
epoch: 7 idx: 200 First Loss : 0.9692475469551276, Second Loss : 0.9740552451109412
  First-Tier acc 0.59375, precision 0.6056861665325256, recall 0.628510101010101, F1 0.580195462944411, AUC 0.7565909090909092
  Second-Tier acc 0.5, precision 0.5011870845204179, recall 0.5128282828282829, F1 0.4511920827710301, AUC 0.764040404040404
  First-Tier acc 0.5561224489795918, precision 0.5605459355459356, recall 0.61711860670194, F1 0.554751778435989, AUC 0.7070243606701939
  Second-Tier acc 0.5306122448979592, precision 0.507177033492823, recall 0.5720899470899471, F1 0.4968974771873323, AUC 0.7220017636684304
epoch: 8 idx: 0 First Loss : 2.903127670288086, Second Loss : 2.993023633956909
epoch: 8 idx: 200 First Loss : 0.9569565918741386, Second Loss : 0.9595341810409851
  First-Tier acc 0.53125, precision 0.5710442651014919, recall 0.5866161616161616, F1 0.5281340151404553, AUC 0.7631502525252524
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7726262626262628
  First-Tier acc 0.5255102040816326, precision 0.5377661339109733, recall 0.595734126984127, F1 0.5246945227719388, AUC 0.7178647211199295
  Second-Tier acc 0.4897959183673469, precision 0.49621489621489623, recall 0.5767195767195767, F1 0.4731496685519674, AUC 0.7260251322751322
epoch: 9 idx: 0 First Loss : 3.0189385414123535, Second Loss : 3.1293559074401855
epoch: 9 idx: 200 First Loss : 0.9488512438847058, Second Loss : 0.9493772388338598
  First-Tier acc 0.5, precision 0.5633166014615782, recall 0.5708585858585858, F1 0.49836859645043785, AUC 0.7706060606060606
  Second-Tier acc 0.4791666666666667, precision 0.5243589743589744, recall 0.5164646464646464, F1 0.45136754930805273, AUC 0.7857575757575758
  First-Tier acc 0.5051020408163265, precision 0.5389114133422086, recall 0.5907186948853616, F1 0.5048028363531424, AUC 0.7238481040564374
  Second-Tier acc 0.46938775510204084, precision 0.48412698412698413, recall 0.564373897707231, F1 0.45800792983299293, AUC 0.734402557319224{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_2", "train_show_freq": 200, "droprate": 0.08996099273870097, "droprate_2": 0.0, "lr": 0.00044204113786378414, "weight_decay": 0.0001307576510408511, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 5, "gamma": 0.6345460333110752, "T_max": 14, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_2", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0872077941894531, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0802882351907925, Second Loss : 1.0782750306734399
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7299021464646464
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7396464646464646
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7169794422398589
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7189153439153438
epoch: 1 idx: 0 First Loss : 1.777502417564392, Second Loss : 1.7850247621536255
epoch: 1 idx: 200 First Loss : 0.9755435207145131, Second Loss : 0.9758655734323151
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7217234848484848
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7341919191919192
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7347573578042329
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7339616402116401
epoch: 2 idx: 0 First Loss : 2.296996831893921, Second Loss : 2.4513750076293945
epoch: 2 idx: 200 First Loss : 0.939088876122859, Second Loss : 0.939948513381072
  First-Tier acc 0.546875, precision 0.3784554629223344, recall 0.5154545454545455, F1 0.4098924731182796, AUC 0.6780808080808081
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.7264646464646464
  First-Tier acc 0.5051020408163265, precision 0.35874038289497223, recall 0.4201940035273369, F1 0.3640582938828552, AUC 0.6788470017636684
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6870039682539683
epoch: 3 idx: 0 First Loss : 3.7796595096588135, Second Loss : 4.1705169677734375
epoch: 3 idx: 200 First Loss : 0.9325596164142833, Second Loss : 0.9333031358132463
  First-Tier acc 0.4270833333333333, precision 0.3754463193934947, recall 0.45575757575757575, F1 0.3285462333081381, AUC 0.7055871212121212
  Second-Tier acc 0.5, precision 0.3703703703703704, recall 0.48969696969696974, F1 0.37965588958215163, AUC 0.724090909090909
  First-Tier acc 0.4744897959183674, precision 0.3812260536398467, recall 0.4188712522045855, F1 0.34683062145489174, AUC 0.6781890707671957
  Second-Tier acc 0.5306122448979592, precision 0.3853801169590643, recall 0.44708994708994715, F1 0.38405797101449274, AUC 0.7027667548500881
epoch: 4 idx: 0 First Loss : 3.6520578861236572, Second Loss : 3.859889030456543
epoch: 4 idx: 200 First Loss : 0.9206337805197977, Second Loss : 0.9103713504997875
  First-Tier acc 0.6197916666666666, precision 0.5234197012138188, recall 0.5267424242424242, F1 0.5136986301369864, AUC 0.7210700757575758
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7309595959595959
  First-Tier acc 0.5510204081632653, precision 0.4703389830508475, recall 0.46395502645502645, F1 0.4658205055007795, AUC 0.6565186838624338
  Second-Tier acc 0.5306122448979592, precision 0.346711259754738, recall 0.41269841269841273, F1 0.37055923848376676, AUC 0.6617063492063492
epoch: 5 idx: 0 First Loss : 4.158993721008301, Second Loss : 4.622849464416504
epoch: 5 idx: 200 First Loss : 0.9189986505230602, Second Loss : 0.9036720173586327
  First-Tier acc 0.3854166666666667, precision 0.3789173789173789, recall 0.42909090909090913, F1 0.2952941176470588, AUC 0.7139709595959595
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7385353535353535
  First-Tier acc 0.4744897959183674, precision 0.4192583732057416, recall 0.4389329805996473, F1 0.3453103913630229, AUC 0.6390232308201057
  Second-Tier acc 0.4897959183673469, precision 0.3843137254901961, recall 0.4338624338624338, F1 0.35714285714285715, AUC 0.6771935626102293
epoch: 6 idx: 0 First Loss : 3.7352471351623535, Second Loss : 3.4803478717803955
epoch: 6 idx: 200 First Loss : 0.8969683849451998, Second Loss : 0.8793488572726944
  First-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6732512626262626
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6897979797979797
  First-Tier acc 0.4030612244897959, precision 0.44186046511627913, recall 0.404320987654321, F1 0.28079103611445916, AUC 0.6027577987213404
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6573522927689593
epoch: 7 idx: 0 First Loss : 3.0689620971679688, Second Loss : 3.2598674297332764
epoch: 7 idx: 200 First Loss : 0.8894320270162428, Second Loss : 0.8742222231511602
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6606502525252526
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6938383838383838
  First-Tier acc 0.4030612244897959, precision 0.44186046511627913, recall 0.404320987654321, F1 0.28079103611445916, AUC 0.6055341986331569
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6675485008818342
epoch: 8 idx: 0 First Loss : 3.221395492553711, Second Loss : 3.5297367572784424
epoch: 8 idx: 200 First Loss : 0.8970403218507508, Second Loss : 0.8806549419350088
  First-Tier acc 0.3854166666666667, precision 0.3869446512782328, recall 0.43333333333333335, F1 0.2944682527954288, AUC 0.6642455808080808
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6956565656565656
  First-Tier acc 0.46938775510204084, precision 0.4417247436115361, recall 0.4444444444444444, F1 0.33916065223202346, AUC 0.6193094135802469
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6880511463844797
epoch: 9 idx: 0 First Loss : 3.65525484085083, Second Loss : 3.9282093048095703
epoch: 9 idx: 200 First Loss : 0.8977353692284105, Second Loss : 0.8845148136157575
  First-Tier acc 0.3333333333333333, precision 0.3666666666666667, recall 0.39999999999999997, F1 0.24787775891341254, AUC 0.6488131313131312
  Second-Tier acc 0.3333333333333333, precision 0.3742690058479532, recall 0.39999999999999997, F1 0.25718674566600835, AUC 0.6697979797979797
  First-Tier acc 0.3979591836734694, precision 0.44186046511627913, recall 0.4012345679012346, F1 0.27656320287899233, AUC 0.6194334215167548
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6687059082892416