{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_28", "train_show_freq": 200, "droprate": 0.4507605226593545, "droprate_2": 0.0, "lr": 6.232834561856197e-05, "weight_decay": 2.2331027840053735e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_28", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 6.232834561856197e-05
epoch: 0 idx: 0 First Loss : 1.2509236335754395, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1296683885342447, Second Loss : 1.1203654142309778
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7325196408529742
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7544444444444446
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7007887517146777
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6855158730158731
Test AUC: 0.6855, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 6.232834561856197e-05
epoch: 1 idx: 0 First Loss : 2.1174566745758057, Second Loss : 2.185169219970703
epoch: 1 idx: 200 First Loss : 1.0349758324857374, Second Loss : 1.043137715971885
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.737334455667789
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7559090909090909
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.713422251616696
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.706955467372134
Test AUC: 0.7070, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.232834561856197e-05
epoch: 2 idx: 0 First Loss : 2.341022491455078, Second Loss : 2.4477834701538086
epoch: 2 idx: 200 First Loss : 0.9747058324033941, Second Loss : 0.9940979139351133
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6527777777777778, precision 0.603921568627451, recall 0.5796632996632997, F1 0.5872947454844006, AUC 0.7275982042648709
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7508080808080807
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5918367346938775, precision 0.5390361272714214, recall 0.5657701352145796, F1 0.5446432411911347, AUC 0.6908681167940428
  Second-Tier acc 0.5510204081632653, precision 0.4736842105263157, recall 0.45436507936507936, F1 0.4444444444444444, AUC 0.6959876543209876
Test AUC: 0.7070, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.232834561856197e-05
epoch: 3 idx: 0 First Loss : 2.863673210144043, Second Loss : 2.9861748218536377
epoch: 3 idx: 200 First Loss : 0.9264224174603894, Second Loss : 0.9597536173477694
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5069444444444444, precision 0.5075817753237107, recall 0.5070370370370371, F1 0.4803854875283447, AUC 0.7315881032547699
  Second-Tier acc 0.5416666666666666, precision 0.5335814283182704, recall 0.5376767676767676, F1 0.517537355353331, AUC 0.7451010101010102
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.46258503401360546, precision 0.47211139528275087, recall 0.4973544973544974, F1 0.44781586259869216, AUC 0.7048549872623946
  Second-Tier acc 0.5918367346938775, precision 0.6157608695652174, recall 0.6485890652557319, F1 0.6039527899993016, AUC 0.7280092592592592
Test AUC: 0.7070, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 6.232834561856197e-05
epoch: 4 idx: 0 First Loss : 3.3828799724578857, Second Loss : 3.5285685062408447
epoch: 4 idx: 200 First Loss : 0.9062907958764639, Second Loss : 0.9487351865799569
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4583333333333333, precision 0.5131003125888037, recall 0.49602693602693604, F1 0.44583236735135473, AUC 0.7301066217732884
  Second-Tier acc 0.4583333333333333, precision 0.528018278018278, recall 0.5038383838383839, F1 0.4474969474969475, AUC 0.7665151515151516
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.40816326530612246, precision 0.461092124250019, recall 0.4665637860082305, F1 0.40440267655457535, AUC 0.7220691260043113
  Second-Tier acc 0.5714285714285714, precision 0.6251526251526252, recall 0.6477072310405644, F1 0.5974892395982784, AUC 0.7651014109347442
Test AUC: 0.7651, Test F1: 0.5975 (Best Epoch: 4)
Current LR: 6.232834561856197e-05
epoch: 5 idx: 0 First Loss : 3.701702117919922, Second Loss : 3.9123167991638184
epoch: 5 idx: 200 First Loss : 0.9014496955677719, Second Loss : 0.9456402017081629
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4583333333333333, precision 0.5267632850241545, recall 0.5234680134680135, F1 0.45264104035188374, AUC 0.7352076318742986
  Second-Tier acc 0.4166666666666667, precision 0.5180704898446834, recall 0.4627272727272727, F1 0.39971988795518204, AUC 0.7732323232323233
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.5194660734149054, recall 0.5239564961787183, F1 0.44634146341463415, AUC 0.730017881638252
  Second-Tier acc 0.5918367346938775, precision 0.6412198912198912, recall 0.6715167548500881, F1 0.5985605038236617, AUC 0.775242504409171
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 6 idx: 0 First Loss : 3.7920961380004883, Second Loss : 4.10306453704834
epoch: 6 idx: 200 First Loss : 0.8964835317847111, Second Loss : 0.9462604658465036
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.519988618580168, recall 0.5202356902356903, F1 0.4393173333822722, AUC 0.7414141414141414
  Second-Tier acc 0.4166666666666667, precision 0.5180704898446834, recall 0.4627272727272727, F1 0.39971988795518204, AUC 0.7729292929292929
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.5598585322723254, recall 0.5392416225749559, F1 0.44825512607596035, AUC 0.7389219576719577
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7999338624338623
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 7 idx: 0 First Loss : 3.7931969165802, Second Loss : 4.192229747772217
epoch: 7 idx: 200 First Loss : 0.8946413350921699, Second Loss : 0.9463515398915004
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4236111111111111, precision 0.5182793941375177, recall 0.5029292929292929, F1 0.4197352094076932, AUC 0.7490516273849607
  Second-Tier acc 0.375, precision 0.4910130718954248, recall 0.4216161616161616, F1 0.34882154882154887, AUC 0.7568181818181818
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.5591397849462366, recall 0.5410787771898883, F1 0.44215861657722116, AUC 0.7409611992945327
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7929343033509699
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 8 idx: 0 First Loss : 3.803983449935913, Second Loss : 4.199398517608643
epoch: 8 idx: 200 First Loss : 0.8893513874468204, Second Loss : 0.9419780449214303
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.5048309178743962, recall 0.4808080808080808, F1 0.4006485748421232, AUC 0.7371492704826039
  Second-Tier acc 0.375, precision 0.4905753968253968, recall 0.43606060606060604, F1 0.35977297895902555, AUC 0.7427272727272727
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.5686475409836066, recall 0.5587889476778366, F1 0.4492497793468668, AUC 0.7412367724867724
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7813051146384481
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 9 idx: 0 First Loss : 3.7712795734405518, Second Loss : 4.194406986236572
epoch: 9 idx: 200 First Loss : 0.8826437378076336, Second Loss : 0.938157257608043
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.4834488181237407, recall 0.45195286195286194, F1 0.37218038856133057, AUC 0.7268574635241302
  Second-Tier acc 0.3541666666666667, precision 0.4463203463203463, recall 0.4082828282828283, F1 0.32931247790738777, AUC 0.7366161616161616
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.5613275613275613, recall 0.5423280423280423, F1 0.42174122174122175, AUC 0.7374522339800117
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7810295414462081
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 10 idx: 0 First Loss : 3.6808316707611084, Second Loss : 4.070125102996826
epoch: 10 idx: 200 First Loss : 0.8763584694466021, Second Loss : 0.9326305938731133
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.47155666063893903, recall 0.4399326599326599, F1 0.3538515406162465, AUC 0.7144107744107743
  Second-Tier acc 0.3541666666666667, precision 0.44413919413919417, recall 0.4082828282828283, F1 0.3321794871794872, AUC 0.7156060606060605
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.5654381654381654, recall 0.5343915343915344, F1 0.42864701136198297, AUC 0.7318856554967667
  Second-Tier acc 0.46938775510204084, precision 0.5633333333333334, recall 0.5273368606701939, F1 0.4515262515262515, AUC 0.7702821869488536
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 11 idx: 0 First Loss : 3.6475107669830322, Second Loss : 4.026575565338135
epoch: 11 idx: 200 First Loss : 0.8714716573383668, Second Loss : 0.9301728029745232
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3472222222222222, precision 0.4578643578643578, recall 0.43104377104377106, F1 0.3392820939637419, AUC 0.6986588103254769
  Second-Tier acc 0.3333333333333333, precision 0.43253968253968256, recall 0.394949494949495, F1 0.31265508684863524, AUC 0.6905050505050504
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5678442238128222, recall 0.5418871252204586, F1 0.41643458268263056, AUC 0.7263803155006858
  Second-Tier acc 0.4489795918367347, precision 0.5584313725490196, recall 0.5149911816578483, F1 0.431955756661639, AUC 0.7616843033509699
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 12 idx: 0 First Loss : 3.4771792888641357, Second Loss : 3.920974016189575
epoch: 12 idx: 200 First Loss : 0.8668263709231683, Second Loss : 0.9258382254769847
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.44303844303844303, recall 0.41818181818181815, F1 0.3222222222222222, AUC 0.6809147025813692
  Second-Tier acc 0.3125, precision 0.41825396825396827, recall 0.3816161616161617, F1 0.2921177587844255, AUC 0.668939393939394
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.5481601731601732, recall 0.49610523221634334, F1 0.3857106000294855, AUC 0.718235596707819
  Second-Tier acc 0.4489795918367347, precision 0.5656108597285069, recall 0.5264550264550264, F1 0.4278787878787879, AUC 0.7540784832451499
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 13 idx: 0 First Loss : 3.430760145187378, Second Loss : 3.8598251342773438
epoch: 13 idx: 200 First Loss : 0.8639697530529861, Second Loss : 0.9232115800197372
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.4341880341880342, recall 0.4097643097643098, F1 0.3111716924446422, AUC 0.6746969696969698
  Second-Tier acc 0.3541666666666667, precision 0.44050179211469537, recall 0.44222222222222224, F1 0.3190476190476191, AUC 0.6624242424242425
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.5567210567210567, recall 0.5119782480893592, F1 0.3970501147383226, AUC 0.710617528904566
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7528108465608465
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 14 idx: 0 First Loss : 3.3577005863189697, Second Loss : 3.8121235370635986
epoch: 14 idx: 200 First Loss : 0.8615143884695019, Second Loss : 0.92079803411978
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3125, precision 0.4128777981012108, recall 0.39774410774410773, F1 0.28650719255437646, AUC 0.6778282828282829
  Second-Tier acc 0.3541666666666667, precision 0.44050179211469537, recall 0.44222222222222224, F1 0.3190476190476191, AUC 0.6737373737373736
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.5401353965183752, recall 0.47200176366843033, F1 0.36366686471184423, AUC 0.7032811581422692
  Second-Tier acc 0.3877551020408163, precision 0.4886363636363636, recall 0.40145502645502645, F1 0.3302128839886277, AUC 0.7416776895943563
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 15 idx: 0 First Loss : 3.3177242279052734, Second Loss : 3.7257680892944336
epoch: 15 idx: 200 First Loss : 0.8603638802091499, Second Loss : 0.9164157038324614
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.4280706808796697, recall 0.42239057239057237, F1 0.30498554269046074, AUC 0.6879517396184064
  Second-Tier acc 0.3333333333333333, precision 0.42088122605363987, recall 0.42888888888888893, F1 0.30168156662409534, AUC 0.6859090909090909
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3877551020408163, precision 0.5392755392755393, recall 0.46987066431510877, F1 0.35677963023500775, AUC 0.6979105428179503
  Second-Tier acc 0.3673469387755102, precision 0.4861111111111111, recall 0.3891093474426808, F1 0.3114130434782609, AUC 0.7318672839506174
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 16 idx: 0 First Loss : 3.309525728225708, Second Loss : 3.626235246658325
epoch: 16 idx: 200 First Loss : 0.8585548734171339, Second Loss : 0.9113475251600432
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4280706808796697, recall 0.42239057239057237, F1 0.30498554269046074, AUC 0.6879012345679012
  Second-Tier acc 0.3541666666666667, precision 0.4401709401709402, recall 0.44222222222222224, F1 0.3210840108401084, AUC 0.6942424242424243
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.36054421768707484, precision 0.5152564736928913, recall 0.42408877131099354, F1 0.3193824027888997, AUC 0.6893310307662159
  Second-Tier acc 0.3673469387755102, precision 0.4861111111111111, recall 0.3891093474426808, F1 0.3114130434782609, AUC 0.7204585537918872
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 17 idx: 0 First Loss : 3.2683498859405518, Second Loss : 3.533073663711548
epoch: 17 idx: 200 First Loss : 0.8556829698433618, Second Loss : 0.9066988154877639
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3333333333333333, precision 0.42387949129522157, recall 0.42323232323232324, F1 0.3019030150177691, AUC 0.6823456790123457
  Second-Tier acc 0.375, precision 0.4554966106690245, recall 0.45555555555555555, F1 0.34419354838709676, AUC 0.6933838383838383
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.36054421768707484, precision 0.508611955420466, recall 0.4143151087595532, F1 0.316786793768891, AUC 0.6838011953752695
  Second-Tier acc 0.3469387755102041, precision 0.483974358974359, recall 0.37676366843033504, F1 0.2916805806006367, AUC 0.7167107583774252
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 18 idx: 0 First Loss : 3.2790157794952393, Second Loss : 3.510603189468384
epoch: 18 idx: 200 First Loss : 0.8512525322699522, Second Loss : 0.9018253580861756
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.4128787878787879, recall 0.40868686868686877, F1 0.2897644153130046, AUC 0.6811896745230079
  Second-Tier acc 0.375, precision 0.4554966106690245, recall 0.45555555555555555, F1 0.34419354838709676, AUC 0.6903535353535354
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.5082274356467905, recall 0.40821575543797767, F1 0.3097887588083666, AUC 0.6839910346854792
  Second-Tier acc 0.3877551020408163, precision 0.5333333333333333, recall 0.46009700176366836, F1 0.3547962089336563, AUC 0.7159391534391535
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)
Current LR: 6.232834561856197e-05
epoch: 19 idx: 0 First Loss : 3.321068525314331, Second Loss : 3.5335376262664795
epoch: 19 idx: 200 First Loss : 0.8496077088007109, Second Loss : 0.8983571592981383
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3194444444444444, precision 0.4128787878787879, recall 0.40868686868686877, F1 0.2897644153130046, AUC 0.6757575757575758
  Second-Tier acc 0.375, precision 0.4554966106690245, recall 0.45555555555555555, F1 0.34419354838709676, AUC 0.6879292929292928
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.5111111111111112, recall 0.41005291005291, F1 0.3074074074074074, AUC 0.6852770429159318
  Second-Tier acc 0.3877551020408163, precision 0.5337643678160919, recall 0.46009700176366836, F1 0.35540135033758435, AUC 0.7161044973544973
Test AUC: 0.7752, Test F1: 0.5986 (Best Epoch: 5)