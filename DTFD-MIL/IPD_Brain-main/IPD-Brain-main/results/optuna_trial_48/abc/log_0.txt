{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_48", "train_show_freq": 200, "droprate": 0.3019367555800993, "droprate_2": 0.0, "lr": 3.235889235851427e-05, "weight_decay": 2.3855088120830424e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_48", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.235889235851427e-05
epoch: 0 idx: 0 First Loss : 1.242843747138977, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1226108497499827, Second Loss : 1.108352055003987
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7209259259259259
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7561111111111112
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6681180188124634
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6605489417989417
Test AUC: 0.6605, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.235889235851427e-05
epoch: 1 idx: 0 First Loss : 2.1819427013397217, Second Loss : 2.1407744884490967
epoch: 1 idx: 200 First Loss : 1.0773082440765342, Second Loss : 1.0722404273588266
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7397530864197531
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7590404040404041
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7053510190084266
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7072861552028219
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.235889235851427e-05
epoch: 2 idx: 0 First Loss : 2.3349854946136475, Second Loss : 2.2740578651428223
epoch: 2 idx: 200 First Loss : 1.0372354492767533, Second Loss : 1.0319836039596528
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.40359477124183, recall 0.3490909090909091, F1 0.2708443040196595, AUC 0.7364421997755332
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7531818181818181
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7047141387419166
  Second-Tier acc 0.5714285714285714, precision 0.35815602836879434, recall 0.35714285714285715, F1 0.2849099099099099, AUC 0.708664021164021
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.235889235851427e-05
epoch: 3 idx: 0 First Loss : 2.582878351211548, Second Loss : 2.5443532466888428
epoch: 3 idx: 200 First Loss : 0.9978343105657184, Second Loss : 0.9971506114474576
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6111111111111112, precision 0.5654512605732118, recall 0.5343434343434343, F1 0.5354960243120602, AUC 0.7309595959595959
  Second-Tier acc 0.6666666666666666, precision 0.5960108181203516, recall 0.5938383838383838, F1 0.5335097001763668, AUC 0.7442929292929293
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.4840735559829807, recall 0.5178571428571429, F1 0.4833149991625132, AUC 0.6968082500489908
  Second-Tier acc 0.6122448979591837, precision 0.5936134453781513, recall 0.5908289241622575, F1 0.58927488282327, AUC 0.7044753086419752
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.235889235851427e-05
epoch: 4 idx: 0 First Loss : 2.894674301147461, Second Loss : 2.8840725421905518
epoch: 4 idx: 200 First Loss : 0.9628873331407409, Second Loss : 0.9680320719692541
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.5136875262925683, recall 0.5069023569023569, F1 0.464644406715714, AUC 0.7334175084175084
  Second-Tier acc 0.5416666666666666, precision 0.5518518518518518, recall 0.5521212121212121, F1 0.5257343550446999, AUC 0.7502525252525253
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.44052419354838707, recall 0.48192239858906527, F1 0.4140441389900655, AUC 0.7058103076621595
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7308752204585538
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.235889235851427e-05
epoch: 5 idx: 0 First Loss : 3.2385804653167725, Second Loss : 3.2141101360321045
epoch: 5 idx: 200 First Loss : 0.9417336089026869, Second Loss : 0.9512223620523712
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4444444444444444, precision 0.4843113906529881, recall 0.46764309764309764, F1 0.4049862038273253, AUC 0.7418237934904601
  Second-Tier acc 0.5208333333333334, precision 0.5807017543859648, recall 0.5821212121212122, F1 0.5205325140809012, AUC 0.7673232323232323
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.4712863239179028, recall 0.5065402704291593, F1 0.411764705882353, AUC 0.723771555947482
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.759975749559083
Test AUC: 0.7600, Test F1: 0.4712 (Best Epoch: 5)
Current LR: 3.235889235851427e-05
epoch: 6 idx: 0 First Loss : 3.5234451293945312, Second Loss : 3.4838056564331055
epoch: 6 idx: 200 First Loss : 0.9336654975806451, Second Loss : 0.944564214569345
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4305555555555556, precision 0.4796385470542774, recall 0.4635690235690236, F1 0.39267313915857605, AUC 0.7501571268237934
  Second-Tier acc 0.4791666666666667, precision 0.5573308270676692, recall 0.5554545454545455, F1 0.47878787878787876, AUC 0.7797979797979799
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.4790969233221744, recall 0.5062463256907701, F1 0.41033481753099355, AUC 0.7350026944934352
  Second-Tier acc 0.5102040816326531, precision 0.5672693319752143, recall 0.605599647266314, F1 0.5144862155388471, AUC 0.7644400352733687
Test AUC: 0.7644, Test F1: 0.5145 (Best Epoch: 6)
Current LR: 3.235889235851427e-05
epoch: 7 idx: 0 First Loss : 3.7214457988739014, Second Loss : 3.665513753890991
epoch: 7 idx: 200 First Loss : 0.928014430333281, Second Loss : 0.9415302319192693
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4166666666666667, precision 0.4927944095494466, recall 0.4668350168350168, F1 0.3945289980398939, AUC 0.7550953984287316
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.793888888888889
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.42857142857142855, precision 0.5344587870272802, recall 0.5294679600235156, F1 0.42601906270853185, AUC 0.7385055359592396
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.7750771604938271
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 8 idx: 0 First Loss : 3.8325164318084717, Second Loss : 3.775216579437256
epoch: 8 idx: 200 First Loss : 0.9226096158578473, Second Loss : 0.940020557513822
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4305555555555556, precision 0.5170336909467345, recall 0.4991919191919192, F1 0.4201346103580897, AUC 0.7592817059483726
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.7937878787878788
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.5374136097820308, recall 0.5311581422692534, F1 0.42886002886002883, AUC 0.7531109151479521
  Second-Tier acc 0.5306122448979592, precision 0.6155157715260017, recall 0.6408730158730159, F1 0.5335135135135135, AUC 0.7926587301587302
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 9 idx: 0 First Loss : 3.892421007156372, Second Loss : 3.813107490539551
epoch: 9 idx: 200 First Loss : 0.9171893107206723, Second Loss : 0.9364247912731003
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4305555555555556, precision 0.5203996486605181, recall 0.5056902356902357, F1 0.4246373509531405, AUC 0.7576823793490459
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7841414141414141
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4557823129251701, precision 0.5698924731182796, recall 0.5688565549676661, F1 0.45766249254621344, AUC 0.760379923574368
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7990520282186949
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 10 idx: 0 First Loss : 3.9246675968170166, Second Loss : 3.830510377883911
epoch: 10 idx: 200 First Loss : 0.9108407080291645, Second Loss : 0.9324378226107607
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4375, precision 0.5298611111111111, recall 0.5183164983164983, F1 0.4360007545746086, AUC 0.7540404040404041
  Second-Tier acc 0.375, precision 0.46978021978021983, recall 0.43606060606060604, F1 0.3588461538461538, AUC 0.786060606060606
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5857142857142857, recall 0.5864197530864197, F1 0.4705882352941176, AUC 0.7664180384087791
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.8010361552028219
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 11 idx: 0 First Loss : 3.931889533996582, Second Loss : 3.82090163230896
epoch: 11 idx: 200 First Loss : 0.9052020263034545, Second Loss : 0.9296063802063707
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.5058580255923709, recall 0.4873063973063973, F1 0.40076900325347536, AUC 0.7475533108866442
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7679797979797981
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.5906956892872386, recall 0.5943562610229277, F1 0.47712271869652984, AUC 0.7672815010777972
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8009259259259259
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 12 idx: 0 First Loss : 3.910510301589966, Second Loss : 3.7895896434783936
epoch: 12 idx: 200 First Loss : 0.8999135088973647, Second Loss : 0.9272023705106497
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.490643746082908, recall 0.46121212121212124, F1 0.37943669674596664, AUC 0.7383670033670033
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.7436868686868686
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5809049398090494, recall 0.5722369194591416, F1 0.4551201614382682, AUC 0.7658423966294338
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8016975308641975
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 13 idx: 0 First Loss : 3.902494430541992, Second Loss : 3.742461919784546
epoch: 13 idx: 200 First Loss : 0.8955909941045438, Second Loss : 0.9254293289772276
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.478505291005291, recall 0.44750841750841747, F1 0.3644582470669427, AUC 0.7245117845117846
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7205050505050505
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5749372253609542, recall 0.5598912404467961, F1 0.43216672078075363, AUC 0.7631356554967667
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7919422398589065
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 14 idx: 0 First Loss : 3.8719282150268555, Second Loss : 3.7025883197784424
epoch: 14 idx: 200 First Loss : 0.8933274105462866, Second Loss : 0.9240953584745485
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3541666666666667, precision 0.4659259259259259, recall 0.43464646464646467, F1 0.3481481481481481, AUC 0.7123512906846239
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6961616161616163
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5795795795795796, recall 0.567827748383304, F1 0.4387580296653251, AUC 0.7618986380560454
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7904541446208113
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 15 idx: 0 First Loss : 3.852487325668335, Second Loss : 3.6749353408813477
epoch: 15 idx: 200 First Loss : 0.8897409992719959, Second Loss : 0.9237555782545233
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.469704641350211, recall 0.4455892255892256, F1 0.35217792543373944, AUC 0.7020089786756453
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6869696969696969
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5795795795795796, recall 0.567827748383304, F1 0.4387580296653251, AUC 0.7579548794826575
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7896274250440918
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 16 idx: 0 First Loss : 3.8362700939178467, Second Loss : 3.645124912261963
epoch: 16 idx: 200 First Loss : 0.8886726126981209, Second Loss : 0.923168160240525
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6914365881032548
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6851010101010101
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.43537414965986393, precision 0.5776638707673191, recall 0.5637125220458553, F1 0.43105200448556213, AUC 0.7534844699196551
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7884149029982362
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 17 idx: 0 First Loss : 3.8334789276123047, Second Loss : 3.6307764053344727
epoch: 17 idx: 200 First Loss : 0.8864015474245392, Second Loss : 0.9235711035283053
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6849102132435466
  Second-Tier acc 0.3541666666666667, precision 0.45303776683087027, recall 0.4396969696969697, F1 0.33247863247863246, AUC 0.6803535353535354
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5745614035087719, recall 0.5536449147560258, F1 0.42153500512108893, AUC 0.7529823143249068
  Second-Tier acc 0.46938775510204084, precision 0.5785256410256411, recall 0.5566578483245149, F1 0.4594771241830065, AUC 0.7875881834215169
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 18 idx: 0 First Loss : 3.8332455158233643, Second Loss : 3.6062512397766113
epoch: 18 idx: 200 First Loss : 0.8845221534184879, Second Loss : 0.9237680324234256
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.4757760699216395, recall 0.45003367003367, F1 0.35980392156862745, AUC 0.6826767676767678
  Second-Tier acc 0.3541666666666667, precision 0.4523809523809524, recall 0.4396969696969697, F1 0.3339031339031339, AUC 0.6756060606060607
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4217687074829932, precision 0.5701149425287356, recall 0.5457084068195179, F1 0.4155272483898928, AUC 0.7483833039388594
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7830687830687831
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.235889235851427e-05
epoch: 19 idx: 0 First Loss : 3.8257558345794678, Second Loss : 3.5717825889587402
epoch: 19 idx: 200 First Loss : 0.882644208047272, Second Loss : 0.9231468265381264
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.375, precision 0.4795512820512821, recall 0.4601346801346802, F1 0.3659273891832031, AUC 0.6836531986531987
  Second-Tier acc 0.375, precision 0.4679012345679012, recall 0.45303030303030306, F1 0.3570395522857323, AUC 0.6780303030303031
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5771246297562088, recall 0.5574661963550852, F1 0.4196184383919052, AUC 0.7468952087007642
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7794312169312169
Test AUC: 0.7751, Test F1: 0.5109 (Best Epoch: 7)