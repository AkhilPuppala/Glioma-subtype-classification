{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.32256466066044515, "droprate_2": 0.0, "lr": 3.697462550675812e-05, "weight_decay": 1.020760144977253e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 3.697462550675812e-05
epoch: 0 idx: 0 First Loss : 0.9067515730857849, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.0954725677101174, Second Loss : 1.093693407169029
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4965544332210999
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48661616161616167
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45241769547325106
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4505070546737213
 
 test auc: 0.4505070546737213, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.315009714265081, "droprate_2": 0.0, "lr": 9.978471145137136e-05, "weight_decay": 1.7771360005170816e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 9.978471145137136e-05
epoch: 0 idx: 0 First Loss : 1.117460012435913, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.1004640156430985, Second Loss : 1.103315669283345
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48627525252525255
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4857070707070707
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4416473765432099
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.439484126984127
 
 test auc: 0.439484126984127, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 9.978471145137136e-05
epoch: 1 idx: 0 First Loss : 1.7612383365631104, Second Loss : 2.060105323791504
epoch: 1 idx: 200 First Loss : 0.9993452224417112, Second Loss : 1.016237158309761
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.3020833333333333, precision 0.3666666666666667, recall 0.4090909090909091, F1 0.2593984962406015, AUC 0.4823737373737374
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.4898989898989899
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.4776785714285714
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46814373897707223
 
 test auc: 0.46814373897707223, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 9.978471145137136e-05
epoch: 2 idx: 0 First Loss : 2.0525524616241455, Second Loss : 2.4162087440490723
epoch: 2 idx: 200 First Loss : 0.9428413625602698, Second Loss : 0.9694566583974444
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.3020833333333333, precision 0.3264685329058248, recall 0.3978787878787879, F1 0.2830521462432625, AUC 0.49047979797979796
  Second-Tier acc 0.20833333333333334, precision 0.13580246913580246, recall 0.29797979797979796, F1 0.18479532163742687, AUC 0.4566666666666667
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3469387755102041, precision 0.360120816003169, recall 0.32330246913580246, F1 0.3360559964726631, AUC 0.5204337522045855
  Second-Tier acc 0.3673469387755102, precision 0.41487240829346095, recall 0.4146825396825397, F1 0.41159039373325085, AUC 0.5211089065255732
 
 test auc: 0.46814373897707223, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 9.978471145137136e-05
epoch: 3 idx: 0 First Loss : 2.6254091262817383, Second Loss : 3.2575910091400146
epoch: 3 idx: 200 First Loss : 0.904841395419332, Second Loss : 0.9429647305526248
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2916666666666667, precision 0.30833333333333335, recall 0.3792929292929293, F1 0.24106280193236715, AUC 0.49428030303030296
  Second-Tier acc 0.20833333333333334, precision 0.18611111111111112, recall 0.26656565656565656, F1 0.18524970963995355, AUC 0.4476262626262626
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3877551020408163, precision 0.35029905682079593, recall 0.33079805996472667, F1 0.3365773659891307, AUC 0.5217151675485009
  Second-Tier acc 0.40816326530612246, precision 0.392094861660079, recall 0.42791005291005285, F1 0.4044041137326073, AUC 0.5381393298059964
 
 test auc: 0.46814373897707223, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 9.978471145137136e-05
epoch: 4 idx: 0 First Loss : 3.0796685218811035, Second Loss : 3.902858257293701
epoch: 4 idx: 200 First Loss : 0.895893715169114, Second Loss : 0.9478132790927567
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3229166666666667, precision 0.3189964157706093, recall 0.37383838383838386, F1 0.2817460317460318, AUC 0.5120833333333333
  Second-Tier acc 0.22916666666666666, precision 0.2178362573099415, recall 0.31383838383838386, F1 0.18247452237600018, AUC 0.45999999999999996
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.35714285714285715, precision 0.273227969348659, recall 0.3244047619047619, F1 0.2925324675324675, AUC 0.5387455908289241
  Second-Tier acc 0.42857142857142855, precision 0.44523809523809527, recall 0.35868606701940037, F1 0.3772401433691756, AUC 0.5784281305114639
 
 test auc: 0.46814373897707223, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 9.978471145137136e-05
epoch: 5 idx: 0 First Loss : 3.125091552734375, Second Loss : 4.1740336418151855
epoch: 5 idx: 200 First Loss : 0.8904100691179156, Second Loss : 0.9478766340438035
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3958333333333333, precision 0.38950617283950617, recall 0.428989898989899, F1 0.34206173230563475, AUC 0.5510858585858586
  Second-Tier acc 0.2708333333333333, precision 0.278978978978979, recall 0.35747474747474745, F1 0.2203703703703704, AUC 0.47853535353535354
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.32653061224489793, precision 0.23986765922249795, recall 0.3148148148148148, F1 0.2644185735313796, AUC 0.5350391313932981
  Second-Tier acc 0.40816326530612246, precision 0.30952380952380953, recall 0.3348765432098766, F1 0.3191256830601093, AUC 0.5641534391534391
 
 test auc: 0.46814373897707223, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 9.978471145137136e-05
epoch: 6 idx: 0 First Loss : 3.1350960731506348, Second Loss : 4.20806360244751
epoch: 6 idx: 200 First Loss : 0.8833515215566641, Second Loss : 0.9409522768364876
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4270833333333333, precision 0.42719085205424, recall 0.4574747474747474, F1 0.36681140144995567, AUC 0.6070833333333333
  Second-Tier acc 0.3125, precision 0.3631578947368421, recall 0.40111111111111114, F1 0.2555422168867547, AUC 0.5268181818181819
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.336734693877551, precision 0.2147338595426027, recall 0.2770061728395062, F1 0.2398382204246714, AUC 0.5043127204585538
  Second-Tier acc 0.42857142857142855, precision 0.31986531986531985, recall 0.37654320987654327, F1 0.34575163398692804, AUC 0.5354387125220458
 
 test auc: 0.5354387125220458, test F1: 0.34575163398692804  :  from epoch 6
 current learn rate 9.978471145137136e-05
epoch: 7 idx: 0 First Loss : 3.021790027618408, Second Loss : 3.9799835681915283
epoch: 7 idx: 200 First Loss : 0.8772550723834001, Second Loss : 0.9342372922982038
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.375, precision 0.4619618395303327, recall 0.43262626262626264, F1 0.3216923050539349, AUC 0.6416666666666666
  Second-Tier acc 0.2916666666666667, precision 0.4894308943089431, recall 0.3877777777777778, F1 0.22962404334953357, AUC 0.58
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3469387755102041, precision 0.18860877684407096, recall 0.2391975308641975, F1 0.21089942401417813, AUC 0.48305224867724866
  Second-Tier acc 0.3469387755102041, precision 0.14912280701754385, recall 0.20987654320987656, F1 0.17435897435897438, AUC 0.5182429453262786
 
 test auc: 0.5182429453262786, test F1: 0.17435897435897438  :  from epoch 7
 current learn rate 9.978471145137136e-05
epoch: 8 idx: 0 First Loss : 3.1731510162353516, Second Loss : 3.928609848022461
epoch: 8 idx: 200 First Loss : 0.8786783250030222, Second Loss : 0.9328274057340572
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3854166666666667, precision 0.5025396825396825, recall 0.4477777777777778, F1 0.3296301684957322, AUC 0.6757828282828283
  Second-Tier acc 0.3125, precision 0.4106837606837606, recall 0.40111111111111114, F1 0.2548478701825558, AUC 0.6238888888888888
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.19295774647887323, recall 0.2515432098765432, F1 0.2183703703703704, AUC 0.4581128747795415
  Second-Tier acc 0.3877551020408163, precision 0.20551378446115287, recall 0.2638888888888889, F1 0.22905982905982905, AUC 0.5018187830687831
 
 test auc: 0.5018187830687831, test F1: 0.22905982905982905  :  from epoch 8
 current learn rate 9.978471145137136e-05
epoch: 9 idx: 0 First Loss : 3.2715277671813965, Second Loss : 3.74678897857666
epoch: 9 idx: 200 First Loss : 0.8889683526318024, Second Loss : 0.9296559764258217
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.49942163100057835, recall 0.44111111111111106, F1 0.31965474361787727, AUC 0.674861111111111
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6429797979797979
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.37755102040816324, precision 0.19315068493150686, recall 0.25771604938271603, F1 0.22076407115777194, AUC 0.4530423280423281
  Second-Tier acc 0.3877551020408163, precision 0.20551378446115287, recall 0.2638888888888889, F1 0.22905982905982905, AUC 0.48726851851851855
 
 test auc: 0.48726851851851855, test F1: 0.22905982905982905  :  from epoch 9
 current learn rate 9.978471145137136e-05
epoch: 10 idx: 0 First Loss : 3.2367684841156006, Second Loss : 3.711200714111328
epoch: 10 idx: 200 First Loss : 0.8839733320765026, Second Loss : 0.9250703052166138
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.375, precision 0.5140415140415141, recall 0.44111111111111106, F1 0.31957671957671957, AUC 0.6720202020202021
  Second-Tier acc 0.3333333333333333, precision 0.44401709401709405, recall 0.4144444444444444, F1 0.2772222222222222, AUC 0.6444444444444444
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.35714285714285715, precision 0.18452380952380953, recall 0.24537037037037038, F1 0.21063921063921065, AUC 0.4487709435626103
  Second-Tier acc 0.3877551020408163, precision 0.1995614035087719, recall 0.2638888888888889, F1 0.22628205128205128, AUC 0.4619708994708995
 
 test auc: 0.4619708994708995, test F1: 0.22628205128205128  :  from epoch 10
 current learn rate 9.978471145137136e-05
epoch: 11 idx: 0 First Loss : 3.186605453491211, Second Loss : 3.7350194454193115
epoch: 11 idx: 200 First Loss : 0.8794047989913949, Second Loss : 0.9201983632285273
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3645833333333333, precision 0.5106837606837606, recall 0.4344444444444444, F1 0.30939068100358424, AUC 0.6742297979797979
  Second-Tier acc 0.3333333333333333, precision 0.4694444444444445, recall 0.4144444444444444, F1 0.2771241830065359, AUC 0.6468686868686869
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.37755102040816324, precision 0.20525114155251142, recall 0.27237654320987653, F1 0.23403324584426946, AUC 0.44217096560846564
  Second-Tier acc 0.3877551020408163, precision 0.2014652014652015, recall 0.2638888888888889, F1 0.22626262626262625, AUC 0.45723104056437386
 
 test auc: 0.45723104056437386, test F1: 0.22626262626262625  :  from epoch 11
 current learn rate 9.978471145137136e-05
epoch: 12 idx: 0 First Loss : 3.324126720428467, Second Loss : 3.784241199493408
epoch: 12 idx: 200 First Loss : 0.8783080213102604, Second Loss : 0.9144271902186667
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3645833333333333, precision 0.5106837606837606, recall 0.4344444444444444, F1 0.30939068100358424, AUC 0.6703535353535354
  Second-Tier acc 0.3333333333333333, precision 0.4694444444444445, recall 0.4144444444444444, F1 0.2771241830065359, AUC 0.6472727272727273
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.37755102040816324, precision 0.20287018917155905, recall 0.27237654320987653, F1 0.232531744342768, AUC 0.437555114638448
  Second-Tier acc 0.3673469387755102, precision 0.19078947368421054, recall 0.2515432098765432, F1 0.21602564102564104, AUC 0.46340388007054667
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 13 idx: 0 First Loss : 3.345667839050293, Second Loss : 3.873514175415039
epoch: 13 idx: 200 First Loss : 0.8738045458494661, Second Loss : 0.9085330738339168
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.34375, precision 0.4880650994575045, recall 0.42111111111111105, F1 0.28822527414031723, AUC 0.6660606060606061
  Second-Tier acc 0.3333333333333333, precision 0.4694444444444445, recall 0.4144444444444444, F1 0.2771241830065359, AUC 0.6427272727272727
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.1901901901901902, recall 0.2515432098765432, F1 0.21629901960784315, AUC 0.4403108465608465
  Second-Tier acc 0.3877551020408163, precision 0.2014652014652015, recall 0.2638888888888889, F1 0.22626262626262625, AUC 0.46064814814814814
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 14 idx: 0 First Loss : 3.366917610168457, Second Loss : 3.9236693382263184
epoch: 14 idx: 200 First Loss : 0.8714783719307291, Second Loss : 0.9010996362432607
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3020833333333333, precision 0.4361111111111111, recall 0.39444444444444443, F1 0.24253034547152197, AUC 0.6649747474747475
  Second-Tier acc 0.3125, precision 0.5317460317460317, recall 0.40111111111111114, F1 0.2542377957472297, AUC 0.6426767676767677
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.1864211737629459, recall 0.24922839506172842, F1 0.21015501717256102, AUC 0.431602733686067
  Second-Tier acc 0.3877551020408163, precision 0.2014652014652015, recall 0.2638888888888889, F1 0.22626262626262625, AUC 0.4598214285714286
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 15 idx: 0 First Loss : 3.3862576484680176, Second Loss : 3.926532506942749
epoch: 15 idx: 200 First Loss : 0.8669930578938359, Second Loss : 0.8948718178926265
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.28125, precision 0.40609756097560973, recall 0.3811111111111111, F1 0.21727836433718786, AUC 0.6624116161616161
  Second-Tier acc 0.2916666666666667, precision 0.5297157622739018, recall 0.3877777777777778, F1 0.22962962962962963, AUC 0.6430303030303031
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41836734693877553, precision 0.22730923694779115, recall 0.2677469135802469, F1 0.22639323369250375, AUC 0.43280147707231037
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.44979056437389775
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 16 idx: 0 First Loss : 3.3894107341766357, Second Loss : 3.90763258934021
epoch: 16 idx: 200 First Loss : 0.8565794123034485, Second Loss : 0.8873588804837338
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3020833333333333, precision 0.4423868312757202, recall 0.39444444444444443, F1 0.24232267193432241, AUC 0.6597979797979797
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.638888888888889
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41836734693877553, precision 0.20230923694779115, recall 0.2677469135802469, F1 0.2224249797242498, AUC 0.4361772486772486
  Second-Tier acc 0.40816326530612246, precision 0.20595238095238097, recall 0.2762345679012346, F1 0.23349917081260363, AUC 0.45469576719576715
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 17 idx: 0 First Loss : 3.7247748374938965, Second Loss : 4.029326438903809
epoch: 17 idx: 200 First Loss : 0.8535196098881948, Second Loss : 0.880856404956111
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.43017163504968386, recall 0.3877777777777778, F1 0.2299145299145299, AUC 0.6607070707070707
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6405050505050505
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41836734693877553, precision 0.20230923694779115, recall 0.2677469135802469, F1 0.2224249797242498, AUC 0.4385058421516755
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4533730158730158
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 18 idx: 0 First Loss : 3.811211585998535, Second Loss : 4.0324530601501465
epoch: 18 idx: 200 First Loss : 0.8483553696397615, Second Loss : 0.8741240044318559
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.47245663384903885, recall 0.4144444444444444, F1 0.2772766683448006, AUC 0.6613510101010102
  Second-Tier acc 0.3125, precision 0.5060975609756098, recall 0.40111111111111114, F1 0.2541208791208791, AUC 0.6394444444444445
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3877551020408163, precision 0.1929824561403509, recall 0.2638888888888889, F1 0.22271062271062272, AUC 0.4410686728395061
  Second-Tier acc 0.40816326530612246, precision 0.19999999999999998, recall 0.2762345679012346, F1 0.23072139303482586, AUC 0.45414462081128754
 
 test auc: 0.46340388007054667, test F1: 0.21602564102564104  :  from epoch 12
 current learn rate 9.978471145137136e-05
epoch: 19 idx: 0 First Loss : 4.075213432312012, Second Loss : 4.08889102935791
epoch: 19 idx: 200 First Loss : 0.8474088015128152, Second Loss : 0.8740071112086691
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3645833333333333, precision 0.47378060535955263, recall 0.4344444444444444, F1 0.30907273303586663, AUC 0.663800505050505
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6491414141414141
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.37755102040816324, precision 0.20070568700705685, recall 0.27237654320987653, F1 0.23110926923608233, AUC 0.4438657407407407
  Second-Tier acc 0.40816326530612246, precision 0.19999999999999998, recall 0.2762345679012346, F1 0.23072139303482586, AUC 0.4570656966490299
 
 test auc: 0.4570656966490299, test F1: 0.23072139303482586  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.32671656249262887, "droprate_2": 0.0, "lr": 2.5522005570442467e-05, "weight_decay": 0.0009410974149262725, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.5522005570442467e-05
epoch: 0 idx: 0 First Loss : 1.2338839769363403, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1150741774347883, Second Loss : 1.0972472202422014
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.707732884399551
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7573232323232323
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6519020674113267
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6520612874779541
Test AUC: 0.6521, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.5522005570442467e-05
epoch: 1 idx: 0 First Loss : 2.108121633529663, Second Loss : 2.0986437797546387
epoch: 1 idx: 200 First Loss : 1.093693427778595, Second Loss : 1.08270514270856
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7335578002244668
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7609090909090909
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6993680188124634
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7028769841269842
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5522005570442467e-05
epoch: 2 idx: 0 First Loss : 2.227520227432251, Second Loss : 2.227055311203003
epoch: 2 idx: 200 First Loss : 1.060941275672533, Second Loss : 1.0500428848598726
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399438832772166
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7607575757575757
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7171761708798746
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.714781746031746
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5522005570442467e-05
epoch: 3 idx: 0 First Loss : 2.3973937034606934, Second Loss : 2.379894733428955
epoch: 3 idx: 200 First Loss : 1.0287052451526348, Second Loss : 1.021824992303528
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.6310116086235489, recall 0.39225589225589225, F1 0.3430525535788694, AUC 0.7379854096520763
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7495454545454545
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7188541054281794
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7177028218694885
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5522005570442467e-05
epoch: 4 idx: 0 First Loss : 2.6048648357391357, Second Loss : 2.5934059619903564
epoch: 4 idx: 200 First Loss : 0.9934750440627781, Second Loss : 0.990339219051214
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6041666666666666, precision 0.6191358024691359, recall 0.4679124579124579, F1 0.45523329129886503, AUC 0.7328114478114478
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7418686868686869
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6462585034013606, precision 0.40456012913640027, recall 0.5375514403292181, F1 0.4603143924751965, AUC 0.7164841759749168
  Second-Tier acc 0.673469387755102, precision 0.746588693957115, recall 0.52336860670194, F1 0.5449275362318841, AUC 0.7196869488536155
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5522005570442467e-05
epoch: 5 idx: 0 First Loss : 2.864368200302124, Second Loss : 2.8516504764556885
epoch: 5 idx: 200 First Loss : 0.9650386706995431, Second Loss : 0.9660509146231028
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.4952931421324749, recall 0.49734006734006736, F1 0.4565175924399225, AUC 0.7289225589225589
  Second-Tier acc 0.6875, precision 0.6601662404092071, recall 0.664949494949495, F1 0.6448412698412699, AUC 0.7432828282828282
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5102040816326531, precision 0.4628270280444193, recall 0.49559082892416223, F1 0.44333333333333336, AUC 0.720593278463649
  Second-Tier acc 0.6326530612244898, precision 0.6151515151515151, recall 0.6618165784832452, F1 0.6249766703994027, AUC 0.7353946208112875
Test AUC: 0.7029, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5522005570442467e-05
epoch: 6 idx: 0 First Loss : 3.1333160400390625, Second Loss : 3.1124560832977295
epoch: 6 idx: 200 First Loss : 0.9466884966420742, Second Loss : 0.9507925916203663
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4930555555555556, precision 0.5064599483204134, recall 0.48828282828282826, F1 0.4367687011824272, AUC 0.7387934904601571
  Second-Tier acc 0.5416666666666666, precision 0.5932263814616756, recall 0.597979797979798, F1 0.5411362419148849, AUC 0.7637878787878788
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.4811437577395024, recall 0.5135214579659024, F1 0.43204365079365076, AUC 0.7265824025083285
  Second-Tier acc 0.5510204081632653, precision 0.5560185185185186, recall 0.6188271604938271, F1 0.5502822716548702, AUC 0.7605820105820106
Test AUC: 0.7606, Test F1: 0.5503 (Best Epoch: 6)
Current LR: 2.5522005570442467e-05
epoch: 7 idx: 0 First Loss : 3.349910020828247, Second Loss : 3.3221418857574463
epoch: 7 idx: 200 First Loss : 0.934960037159423, Second Loss : 0.9424206155597867
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.463220508374574, recall 0.4522558922558922, F1 0.37890662796323177, AUC 0.7449663299663299
  Second-Tier acc 0.5833333333333334, precision 0.6314659197012138, recall 0.667979797979798, F1 0.5841269841269842, AUC 0.791111111111111
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.40816326530612246, precision 0.4527592726826444, recall 0.4925044091710758, F1 0.38429143599828725, AUC 0.7292034097589654
  Second-Tier acc 0.4897959183673469, precision 0.5164721759149004, recall 0.58179012345679, F1 0.49474747474747477, AUC 0.76929012345679
Test AUC: 0.7693, Test F1: 0.4947 (Best Epoch: 7)
Current LR: 2.5522005570442467e-05
epoch: 8 idx: 0 First Loss : 3.48490309715271, Second Loss : 3.45511531829834
epoch: 8 idx: 200 First Loss : 0.9280159420505241, Second Loss : 0.9377234283167479
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.4575614861329147, recall 0.43447811447811446, F1 0.3547329669604527, AUC 0.7455667789001122
  Second-Tier acc 0.5208333333333334, precision 0.5907477025898079, recall 0.6135353535353536, F1 0.5212121212121211, AUC 0.7932828282828283
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.4927981995498875, recall 0.49603174603174605, F1 0.38681969640873753, AUC 0.7319958847736626
  Second-Tier acc 0.5102040816326531, precision 0.6, recall 0.6170634920634921, F1 0.5098039215686274, AUC 0.7702821869488536
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 9 idx: 0 First Loss : 3.5834057331085205, Second Loss : 3.554568290710449
epoch: 9 idx: 200 First Loss : 0.9225661035891233, Second Loss : 0.9341876406676659
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3680555555555556, precision 0.44162037522272296, recall 0.4074410774410775, F1 0.326985111662531, AUC 0.7495117845117845
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7881313131313131
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.5010222335803731, recall 0.4878012933568489, F1 0.37567665978880926, AUC 0.7371950323339211
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7739748677248678
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 10 idx: 0 First Loss : 3.647575616836548, Second Loss : 3.6263749599456787
epoch: 10 idx: 200 First Loss : 0.9176604245251869, Second Loss : 0.9311511241274872
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.4693564605329312, recall 0.43414141414141416, F1 0.35866157588645625, AUC 0.758013468013468
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7879797979797981
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.5287997027127461, recall 0.5113168724279835, F1 0.3972873531697061, AUC 0.743380119537527
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7795965608465609
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 11 idx: 0 First Loss : 3.6848983764648438, Second Loss : 3.664292097091675
epoch: 11 idx: 200 First Loss : 0.9121218778526605, Second Loss : 0.9270836196455233
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5031328320802004, recall 0.481043771043771, F1 0.3999153631353943, AUC 0.7577328843995511
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7843939393939395
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5511904761904762, recall 0.5427689594356261, F1 0.4225349714353827, AUC 0.7483955516362925
  Second-Tier acc 0.4897959183673469, precision 0.5893719806763285, recall 0.5868606701940036, F1 0.4864072864072864, AUC 0.777281746031746
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 12 idx: 0 First Loss : 3.7016117572784424, Second Loss : 3.693755626678467
epoch: 12 idx: 200 First Loss : 0.9073461511088953, Second Loss : 0.9239761453626946
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.5144756443769851, recall 0.4993265993265994, F1 0.4134928307847329, AUC 0.7527441077441077
  Second-Tier acc 0.3958333333333333, precision 0.49732905982905984, recall 0.47828282828282837, F1 0.38873666293021136, AUC 0.7754040404040404
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5718369062631358, recall 0.5745149911816578, F1 0.4509162233672786, AUC 0.755842151675485
  Second-Tier acc 0.46938775510204084, precision 0.5702614379084968, recall 0.5451940035273369, F1 0.46115288220551376, AUC 0.7830687830687831
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 13 idx: 0 First Loss : 3.718458890914917, Second Loss : 3.6847729682922363
epoch: 13 idx: 200 First Loss : 0.9035837807685637, Second Loss : 0.9207101400573251
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.500369592281357, recall 0.4772053872053872, F1 0.3937884749180132, AUC 0.7488327721661054
  Second-Tier acc 0.3333333333333333, precision 0.4432098765432099, recall 0.3924242424242424, F1 0.3219518329874866, AUC 0.7566161616161615
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5813131313131313, recall 0.5844356261022928, F1 0.46441539578794483, AUC 0.756993435234176
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7819113756613757
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 14 idx: 0 First Loss : 3.7066898345947266, Second Loss : 3.6670970916748047
epoch: 14 idx: 200 First Loss : 0.8989883328965211, Second Loss : 0.9183403514788964
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.5003299637039925, recall 0.48141414141414146, F1 0.3920439759118655, AUC 0.741257014590348
  Second-Tier acc 0.3333333333333333, precision 0.432508104921898, recall 0.394949494949495, F1 0.31086021505376343, AUC 0.7495959595959597
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5774509803921569, recall 0.5762051734273956, F1 0.4509090909090909, AUC 0.7605391436409956
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.779376102292769
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 15 idx: 0 First Loss : 3.7011489868164062, Second Loss : 3.651433229446411
epoch: 15 idx: 200 First Loss : 0.8960913353789579, Second Loss : 0.9153158150257691
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.5004036424696461, recall 0.4879124579124579, F1 0.38928571428571423, AUC 0.7311784511784513
  Second-Tier acc 0.3333333333333333, precision 0.43253968253968256, recall 0.394949494949495, F1 0.31265508684863524, AUC 0.7380303030303029
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.5682268155539716, recall 0.5540858318636097, F1 0.4286651597575967, AUC 0.759712424064276
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7713293650793651
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 16 idx: 0 First Loss : 3.6886825561523438, Second Loss : 3.642780303955078
epoch: 16 idx: 200 First Loss : 0.8927274283524996, Second Loss : 0.9143950986352736
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.5013888888888889, recall 0.4879124579124579, F1 0.3894507655569603, AUC 0.7195117845117845
  Second-Tier acc 0.3333333333333333, precision 0.43253968253968256, recall 0.394949494949495, F1 0.31265508684863524, AUC 0.7161111111111111
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.5543785310734464, recall 0.5162404467960023, F1 0.4044065573198927, AUC 0.7553951107191846
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7642746913580246
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 17 idx: 0 First Loss : 3.6651909351348877, Second Loss : 3.610410451889038
epoch: 17 idx: 200 First Loss : 0.8907478336807785, Second Loss : 0.9133641285119829
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.47440476190476194, recall 0.46050505050505053, F1 0.3579681089109903, AUC 0.7103984287317621
  Second-Tier acc 0.3333333333333333, precision 0.43253968253968256, recall 0.394949494949495, F1 0.31265508684863524, AUC 0.7003535353535354
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.40816326530612246, precision 0.5571606088847468, recall 0.5200617283950617, F1 0.4032975890103729, AUC 0.7527496080736822
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7702821869488536
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 18 idx: 0 First Loss : 3.632655382156372, Second Loss : 3.572291374206543
epoch: 18 idx: 200 First Loss : 0.8892998470075136, Second Loss : 0.913188543740894
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.463112671228829, recall 0.4411447811447811, F1 0.3444386019938132, AUC 0.701257014590348
  Second-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.394949494949495, F1 0.3094239006906198, AUC 0.6862121212121212
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.5616374269005848, recall 0.5279982363315696, F1 0.40932652738208297, AUC 0.7486160101900842
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7724867724867724
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8)
Current LR: 2.5522005570442467e-05
epoch: 19 idx: 0 First Loss : 3.5953409671783447, Second Loss : 3.580225944519043
epoch: 19 idx: 200 First Loss : 0.8880775985113966, Second Loss : 0.9140274935912813
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.4682539682539682, recall 0.45124579124579123, F1 0.3500956621560511, AUC 0.6954096520763188
  Second-Tier acc 0.3333333333333333, precision 0.42974910394265237, recall 0.41191919191919196, F1 0.30317460317460315, AUC 0.6835353535353536
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5614538498326159, recall 0.5199147560258671, F1 0.4036219581211092, AUC 0.7442803252988438
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7740850970017638
Test AUC: 0.7703, Test F1: 0.5098 (Best Epoch: 8){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.41119390076738394, "droprate_2": 0.0, "lr": 4.602258057370907e-05, "weight_decay": 0.00017243244149201984, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 4.602258057370907e-05
epoch: 0 idx: 0 First Loss : 1.2645443677902222, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1266648624815159, Second Loss : 1.117322121019387
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7279068462401795
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7552020202020202
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6873040368410739
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6747685185185185
Test AUC: 0.6748, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.602258057370907e-05
epoch: 1 idx: 0 First Loss : 2.1837284564971924, Second Loss : 2.159506320953369
epoch: 1 idx: 200 First Loss : 1.0539126428798657, Second Loss : 1.056403408225496
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7405555555555555
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7536363636363635
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7142305996472663
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7088293650793651
Test AUC: 0.6748, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.602258057370907e-05
epoch: 2 idx: 0 First Loss : 2.3718793392181396, Second Loss : 2.352980852127075
epoch: 2 idx: 200 First Loss : 1.0057187541874486, Second Loss : 1.0134130741159122
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.5889355742296919, recall 0.44542087542087544, F1 0.43303397048753606, AUC 0.733956228956229
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7502020202020202
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6326530612244898, precision 0.7638888888888888, recall 0.5038212815990594, F1 0.4611634795233326, AUC 0.7001518714481678
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7023809523809524
Test AUC: 0.6748, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.602258057370907e-05
epoch: 3 idx: 0 First Loss : 2.7670748233795166, Second Loss : 2.718254804611206
epoch: 3 idx: 200 First Loss : 0.9600825045832354, Second Loss : 0.9752043263606764
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.490311801007896, recall 0.4961616161616161, F1 0.472115880875005, AUC 0.7239674523007856
  Second-Tier acc 0.6458333333333334, precision 0.6180124223602484, recall 0.6238383838383837, F1 0.5972474289171203, AUC 0.7415656565656565
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4897959183673469, precision 0.4454205974842767, recall 0.4870664315108759, F1 0.4379534258844604, AUC 0.7015236135606505
  Second-Tier acc 0.6326530612244898, precision 0.6081349206349206, recall 0.6618165784832452, F1 0.6222222222222222, AUC 0.7098214285714285
Test AUC: 0.6748, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.602258057370907e-05
epoch: 4 idx: 0 First Loss : 3.1746342182159424, Second Loss : 3.156094551086426
epoch: 4 idx: 200 First Loss : 0.9289802203316297, Second Loss : 0.9511828678127249
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4791666666666667, precision 0.49428349428349433, recall 0.49154882154882157, F1 0.4456576423407763, AUC 0.7286700336700337
  Second-Tier acc 0.5416666666666666, precision 0.5905546695020379, recall 0.5954545454545455, F1 0.5396531125118446, AUC 0.7643939393939393
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.47156891211769264, recall 0.5129335684891241, F1 0.4321825365022544, AUC 0.7191174309229864
  Second-Tier acc 0.5306122448979592, precision 0.5330882352941176, recall 0.5950176366843033, F1 0.5215503875968993, AUC 0.7477954144620812
Test AUC: 0.7478, Test F1: 0.5216 (Best Epoch: 4)
Current LR: 4.602258057370907e-05
epoch: 5 idx: 0 First Loss : 3.5472729206085205, Second Loss : 3.5378546714782715
epoch: 5 idx: 200 First Loss : 0.9167764955455094, Second Loss : 0.9416487120944469
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.49011562215935633, recall 0.4696969696969697, F1 0.4105560164882199, AUC 0.7261335578002245
  Second-Tier acc 0.5416666666666666, precision 0.6, recall 0.6124242424242424, F1 0.5434715821812596, AUC 0.7797474747474747
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.48807895251123706, recall 0.5082304526748972, F1 0.4197638352288186, AUC 0.7263558201058201
  Second-Tier acc 0.4897959183673469, precision 0.5102707749766573, recall 0.5703262786596119, F1 0.49052845528455286, AUC 0.7672508818342152
Test AUC: 0.7673, Test F1: 0.4905 (Best Epoch: 5)
Current LR: 4.602258057370907e-05
epoch: 6 idx: 0 First Loss : 3.723888397216797, Second Loss : 3.799992799758911
epoch: 6 idx: 200 First Loss : 0.913113356544752, Second Loss : 0.9397222154370662
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4027777777777778, precision 0.46015873015873016, recall 0.440976430976431, F1 0.37104575163398695, AUC 0.7224635241301908
  Second-Tier acc 0.5, precision 0.5795454545454546, recall 0.5857575757575758, F1 0.503030303030303, AUC 0.7854040404040404
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.5352530706324398, recall 0.5276308054085832, F1 0.4328952608522501, AUC 0.7347332451499119
  Second-Tier acc 0.4897959183673469, precision 0.5584670231729055, recall 0.5932539682539683, F1 0.496976976976977, AUC 0.7759038800705467
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 7 idx: 0 First Loss : 3.812143325805664, Second Loss : 3.9100680351257324
epoch: 7 idx: 200 First Loss : 0.909317951820865, Second Loss : 0.9382858654410018
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4166666666666667, precision 0.4858297985153764, recall 0.4724915824915825, F1 0.3975027103105921, AUC 0.7253703703703703
  Second-Tier acc 0.4375, precision 0.5316666666666667, recall 0.5024242424242424, F1 0.4377104377104377, AUC 0.778131313131313
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.42857142857142855, precision 0.5341053391053391, recall 0.5273368606701939, F1 0.4283432450548353, AUC 0.7444701646090534
  Second-Tier acc 0.5306122448979592, precision 0.6172161172161172, recall 0.623015873015873, F1 0.5318181818181819, AUC 0.7900132275132276
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 8 idx: 0 First Loss : 3.8393852710723877, Second Loss : 4.00167179107666
epoch: 8 idx: 200 First Loss : 0.9040563483328665, Second Loss : 0.9371885525824882
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.505402044763747, recall 0.4846464646464647, F1 0.4046227293898463, AUC 0.7291582491582492
  Second-Tier acc 0.4166666666666667, precision 0.5094444444444445, recall 0.4746464646464647, F1 0.4130190796857464, AUC 0.7655050505050506
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.5681856972179553, recall 0.5587889476778366, F1 0.4494976808334692, AUC 0.7523699294532628
  Second-Tier acc 0.5102040816326531, precision 0.597340930674264, recall 0.5813492063492064, F1 0.5042586140147116, AUC 0.7905092592592592
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 9 idx: 0 First Loss : 3.837277412414551, Second Loss : 3.9859015941619873
epoch: 9 idx: 200 First Loss : 0.8994204959674594, Second Loss : 0.9329582420907525
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.5088259268628609, recall 0.4892255892255892, F1 0.4062464539731387, AUC 0.7283894500561168
  Second-Tier acc 0.3958333333333333, precision 0.496547619047619, recall 0.46131313131313134, F1 0.3921957671957672, AUC 0.7503030303030304
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.47619047619047616, precision 0.5865251897860594, recall 0.5845825984714873, F1 0.47490232951398, AUC 0.7520514893200078
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.779376102292769
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 10 idx: 0 First Loss : 3.8067405223846436, Second Loss : 3.9816224575042725
epoch: 10 idx: 200 First Loss : 0.8945198403642425, Second Loss : 0.9305514265089273
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3888888888888889, precision 0.4932808476926123, recall 0.46542087542087546, F1 0.3845581418045186, AUC 0.7235353535353536
  Second-Tier acc 0.3958333333333333, precision 0.49486461251167135, recall 0.46131313131313134, F1 0.39232348111658455, AUC 0.7448484848484848
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.5693617724867724, recall 0.5584950029394474, F1 0.4425026107034906, AUC 0.753343621399177
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7801477072310407
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 11 idx: 0 First Loss : 3.732058525085449, Second Loss : 3.946223735809326
epoch: 11 idx: 200 First Loss : 0.8876857153905685, Second Loss : 0.9287118063084155
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.47897630516226336, recall 0.4384848484848485, F1 0.3663789262221417, AUC 0.7174803591470257
  Second-Tier acc 0.3541666666666667, precision 0.4447181171319103, recall 0.4082828282828283, F1 0.33055555555555555, AUC 0.7381818181818183
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.5661057692307693, recall 0.5502645502645502, F1 0.42825755969703394, AUC 0.7512676366843034
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7730379188712523
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 12 idx: 0 First Loss : 3.6942050457000732, Second Loss : 3.91363525390625
epoch: 12 idx: 200 First Loss : 0.8832208213080138, Second Loss : 0.9260522390076362
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.49459953472914586, recall 0.4704713804713805, F1 0.38659779021380397, AUC 0.7112962962962963
  Second-Tier acc 0.3541666666666667, precision 0.4447181171319103, recall 0.4082828282828283, F1 0.33055555555555555, AUC 0.7046464646464647
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.5625485625485626, recall 0.5420340975896532, F1 0.4138770237623692, AUC 0.7483465608465609
  Second-Tier acc 0.4489795918367347, precision 0.5580246913580247, recall 0.5149911816578483, F1 0.4320587195641778, AUC 0.7703373015873017
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 13 idx: 0 First Loss : 3.6160621643066406, Second Loss : 3.857062816619873
epoch: 13 idx: 200 First Loss : 0.8771608631860405, Second Loss : 0.9243730767737189
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3611111111111111, precision 0.47149380300065236, recall 0.44390572390572397, F1 0.35577431410081123, AUC 0.7030920314253648
  Second-Tier acc 0.3333333333333333, precision 0.432508104921898, recall 0.394949494949495, F1 0.31086021505376343, AUC 0.6872222222222222
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5646446078431372, recall 0.5399029982363316, F1 0.4117424242424243, AUC 0.7414878502841465
  Second-Tier acc 0.4489795918367347, precision 0.5576923076923077, recall 0.5149911816578483, F1 0.4316993464052288, AUC 0.7661485890652556
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 14 idx: 0 First Loss : 3.5699570178985596, Second Loss : 3.817183017730713
epoch: 14 idx: 200 First Loss : 0.8746231630709791, Second Loss : 0.9236790792088705
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.4699947589098532, recall 0.4399326599326599, F1 0.3544279967500941, AUC 0.6949943883277218
  Second-Tier acc 0.3125, precision 0.41773399014778323, recall 0.3816161616161617, F1 0.2901709401709402, AUC 0.6765656565656566
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5691281343455257, recall 0.5478395061728395, F1 0.41792870456663556, AUC 0.7374154908877131
  Second-Tier acc 0.4489795918367347, precision 0.5584313725490196, recall 0.5149911816578483, F1 0.431955756661639, AUC 0.7642195767195767
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 15 idx: 0 First Loss : 3.497509717941284, Second Loss : 3.7527518272399902
epoch: 15 idx: 200 First Loss : 0.8714023242670977, Second Loss : 0.9221278782748613
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3541666666666667, precision 0.46412776412776413, recall 0.43548821548821554, F1 0.34721623132838086, AUC 0.684786756453423
  Second-Tier acc 0.3125, precision 0.41773399014778323, recall 0.3816161616161617, F1 0.2901709401709402, AUC 0.6720707070707072
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.5561865818567318, recall 0.5159465020576132, F1 0.39522030018450116, AUC 0.7342433372525964
  Second-Tier acc 0.4489795918367347, precision 0.5738304093567251, recall 0.5443121693121693, F1 0.43765136747592887, AUC 0.7610780423280423
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 16 idx: 0 First Loss : 3.453014373779297, Second Loss : 3.7039794921875
epoch: 16 idx: 200 First Loss : 0.8674814840736718, Second Loss : 0.9209397762263222
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.45529382897803955, recall 0.43670033670033664, F1 0.3373430850495071, AUC 0.6779517396184062
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6632323232323233
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.5601978691019788, recall 0.5238830099941211, F1 0.4012821909847082, AUC 0.7300607485792671
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7604717813051146
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 17 idx: 0 First Loss : 3.4238016605377197, Second Loss : 3.6783008575439453
epoch: 17 idx: 200 First Loss : 0.8641780033775383, Second Loss : 0.9199144816300768
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3402777777777778, precision 0.44923322291743345, recall 0.42744107744107745, F1 0.33001707772349975, AUC 0.6782940516273851
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6705050505050506
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3877551020408163, precision 0.5511111111111111, recall 0.501763668430335, F1 0.3782477976026363, AUC 0.7277030668234371
  Second-Tier acc 0.46938775510204084, precision 0.5856481481481481, recall 0.5681216931216931, F1 0.4552229613205223, AUC 0.7498346560846562
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 18 idx: 0 First Loss : 3.451859712600708, Second Loss : 3.645240068435669
epoch: 18 idx: 200 First Loss : 0.8604671372113308, Second Loss : 0.9176078021860958
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.4605727281165877, recall 0.441986531986532, F1 0.3438309147205138, AUC 0.6813973063973063
  Second-Tier acc 0.3958333333333333, precision 0.46854256854256854, recall 0.4688888888888889, F1 0.36183280311063976, AUC 0.676010101010101
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3877551020408163, precision 0.5518543193426604, recall 0.49963256907701353, F1 0.3739658331226184, AUC 0.7233245149911817
  Second-Tier acc 0.4489795918367347, precision 0.582375478927203, recall 0.5557760141093474, F1 0.4351407145264577, AUC 0.7475198412698413
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6)
Current LR: 4.602258057370907e-05
epoch: 19 idx: 0 First Loss : 3.425879716873169, Second Loss : 3.668405055999756
epoch: 19 idx: 200 First Loss : 0.8568924987510272, Second Loss : 0.9164702526776007
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.4640657588026009, recall 0.4569023569023569, F1 0.34957550095164774, AUC 0.6837037037037037
  Second-Tier acc 0.3958333333333333, precision 0.4706605222734255, recall 0.4688888888888889, F1 0.3602092352092352, AUC 0.6856060606060606
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3945578231292517, precision 0.551440329218107, recall 0.4977954144620811, F1 0.3791213594518079, AUC 0.7223263276504017
  Second-Tier acc 0.40816326530612246, precision 0.5392886683209265, recall 0.4724426807760141, F1 0.3771825396825397, AUC 0.7409060846560847
Test AUC: 0.7759, Test F1: 0.4970 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.21727004676866218, "droprate_2": 0.0, "lr": 0.0009224791401597781, "weight_decay": 0.00039911319529282107, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0009224791401597781
epoch: 0 idx: 0 First Loss : 1.160643219947815, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0926073535869074, Second Loss : 1.089910469133759
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.717979797979798
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7154545454545455
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7312242798353908
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7243165784832452
Test AUC: 0.7243, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0009224791401597781
epoch: 1 idx: 0 First Loss : 2.109886407852173, Second Loss : 2.254070281982422
epoch: 1 idx: 200 First Loss : 0.977433967056559, Second Loss : 0.9675923321229308
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7147418630751963
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7051515151515152
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7568770821085636
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.761629188712522
Test AUC: 0.7243, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0009224791401597781
epoch: 2 idx: 0 First Loss : 2.115243673324585, Second Loss : 2.520847797393799
epoch: 2 idx: 200 First Loss : 0.9554942801631802, Second Loss : 0.9380563225096731
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7118686868686869
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.708989898989899
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7666997354497355
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7691798941798941
Test AUC: 0.7243, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0009224791401597781
epoch: 3 idx: 0 First Loss : 2.3874289989471436, Second Loss : 2.9365203380584717
epoch: 3 idx: 200 First Loss : 0.9254628442301975, Second Loss : 0.9195350448957723
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7171885521885523
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7128282828282827
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7622905643738976
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7678571428571428
Test AUC: 0.7243, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0009224791401597781
epoch: 4 idx: 0 First Loss : 3.373669385910034, Second Loss : 3.1140928268432617
epoch: 4 idx: 200 First Loss : 0.9303728426106979, Second Loss : 0.909155565429831
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7147979797979799
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7116161616161616
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7748628257887518
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7639440035273369
Test AUC: 0.7243, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0009224791401597781
epoch: 5 idx: 0 First Loss : 2.465521812438965, Second Loss : 3.2132534980773926
epoch: 5 idx: 200 First Loss : 0.9054126209713778, Second Loss : 0.8991908222270101
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7172166105499439
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7199494949494949
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18620689655172415, recall 0.3333333333333333, F1 0.23893805309734514, AUC 0.7746239956888106
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7665343915343916
Test AUC: 0.7665, Test F1: 0.2432 (Best Epoch: 5)
Current LR: 0.0009224791401597781
epoch: 6 idx: 0 First Loss : 2.6480352878570557, Second Loss : 2.8604116439819336
epoch: 6 idx: 200 First Loss : 0.8861569047822103, Second Loss : 0.87869610869562
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7368686868686868
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.750050505050505
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7528292181069959
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7479607583774252
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 7 idx: 0 First Loss : 3.4708635807037354, Second Loss : 3.6028976440429688
epoch: 7 idx: 200 First Loss : 0.8767816538954922, Second Loss : 0.8723072745091286
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7386419753086421
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7468686868686869
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7064961787184009
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7038690476190476
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 8 idx: 0 First Loss : 3.7006847858428955, Second Loss : 4.074779987335205
epoch: 8 idx: 200 First Loss : 0.8646197563004843, Second Loss : 0.8693834028127997
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5347222222222222, precision 0.3581580809055245, recall 0.4892929292929293, F1 0.3963987249073835, AUC 0.6910381593714927
  Second-Tier acc 0.5416666666666666, precision 0.3774250440917107, recall 0.5163636363636364, F1 0.40732265446224253, AUC 0.7298484848484849
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5510204081632653, precision 0.3810325476992144, recall 0.44797178130511467, F1 0.39389414302306286, AUC 0.7144510582010581
  Second-Tier acc 0.5510204081632653, precision 0.4068100358422939, recall 0.4708994708994709, F1 0.39999999999999997, AUC 0.7274029982363315
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 9 idx: 0 First Loss : 2.5228052139282227, Second Loss : 2.7728943824768066
epoch: 9 idx: 200 First Loss : 0.8556401810779083, Second Loss : 0.8594306087427175
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5972222222222222, precision 0.38080916577157176, recall 0.517979797979798, F1 0.43825920612147296, AUC 0.6761672278338944
  Second-Tier acc 0.6041666666666666, precision 0.40277777777777773, recall 0.5563636363636363, F1 0.4489795918367347, AUC 0.7222222222222223
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5578231292517006, precision 0.345679012345679, recall 0.4138741916519694, F1 0.3764367816091954, AUC 0.6705246913580246
  Second-Tier acc 0.6326530612244898, precision 0.436026936026936, recall 0.5202821869488536, F1 0.45362535258005643, AUC 0.6954365079365079
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 10 idx: 0 First Loss : 3.063786745071411, Second Loss : 3.0261032581329346
epoch: 10 idx: 200 First Loss : 0.8468289928602296, Second Loss : 0.846882157577943
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3333333333333333, precision 0.3511578947368421, recall 0.39999999999999997, F1 0.2456234850525182, AUC 0.6637149270482604
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7353535353535353
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6581545169508133
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.675650352733686
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 11 idx: 0 First Loss : 2.500037431716919, Second Loss : 2.795825719833374
epoch: 11 idx: 200 First Loss : 0.8328006176650987, Second Loss : 0.8429213631550656
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.718063973063973
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.7436868686868686
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6528267685675092
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6526124338624338
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 12 idx: 0 First Loss : 2.654829740524292, Second Loss : 2.8841400146484375
epoch: 12 idx: 200 First Loss : 0.8205762082474557, Second Loss : 0.8285149833192095
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6931762065095398
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.73489898989899
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6470948461689202
  Second-Tier acc 0.3469387755102041, precision 0.43478260869565216, recall 0.3703703703703704, F1 0.22222222222222224, AUC 0.6726190476190476
Test AUC: 0.7480, Test F1: 0.2368 (Best Epoch: 6)
Current LR: 0.0009224791401597781
epoch: 13 idx: 0 First Loss : 2.5492782592773438, Second Loss : 2.83168888092041
epoch: 13 idx: 200 First Loss : 0.8161430310111015, Second Loss : 0.8214290346985044
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2986111111111111, precision 0.3403797220591114, recall 0.37777777777777777, F1 0.20990391722099042, AUC 0.7020931537598204
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.7623232323232324
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3741496598639456, precision 0.43781094527363185, recall 0.3868312757201646, F1 0.2512894906511928, AUC 0.6285763276504017
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6609898589065256
Test AUC: 0.6610, Test F1: 0.2442 (Best Epoch: 13)
Current LR: 0.0009224791401597781
epoch: 14 idx: 0 First Loss : 2.7127978801727295, Second Loss : 3.130995988845825
epoch: 14 idx: 200 First Loss : 0.8252900588537991, Second Loss : 0.8367586180212124
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2847222222222222, precision 0.32513100934153566, recall 0.3688888888888889, F1 0.19454562435789668, AUC 0.7052581369248037
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.7213131313131314
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.4362745098039216, recall 0.3786008230452675, F1 0.23701351571405307, AUC 0.6532003233392122
  Second-Tier acc 0.32653061224489793, precision 0.4326241134751773, recall 0.35802469135802467, F1 0.1989824759751272, AUC 0.6869488536155203
Test AUC: 0.6610, Test F1: 0.2442 (Best Epoch: 13){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.12597066093226136, "droprate_2": 0.0, "lr": 1.1389596083092054e-05, "weight_decay": 0.00013602774462605094, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.1227131875406614, "droprate_2": 0.0, "lr": 6.600235199986606e-05, "weight_decay": 3.5063509269120045e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.0024925601992834973, "droprate_2": 0.0, "lr": 0.00028709070165672376, "weight_decay": 0.0003627318775764178, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.07774171002038005, "droprate_2": 0.0, "lr": 0.00015411233016833753, "weight_decay": 0.0002107720293818288, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.17353688252005925, "droprate_2": 0.0, "lr": 0.0006762450817699731, "weight_decay": 6.235011459463169e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0797069072723389, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1023375509278988, Second Loss : 1.0920895182374697
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.718800505050505
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.733030303030303
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7141961529982362
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7334656084656085
epoch: 1 idx: 0 First Loss : 1.6674716472625732, Second Loss : 1.9237415790557861
epoch: 1 idx: 200 First Loss : 0.9821440037061919, Second Loss : 0.9748359415958177
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6955334595959597
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7110606060606061
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6830047123015873
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6952711640211641
epoch: 2 idx: 0 First Loss : 2.1191999912261963, Second Loss : 2.2832865715026855
epoch: 2 idx: 200 First Loss : 0.956306527688432, Second Loss : 0.9487229985977287
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.678989898989899
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6945454545454545
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6773485725308642
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6818231922398589
epoch: 3 idx: 0 First Loss : 2.4388222694396973, Second Loss : 2.5590953826904297
epoch: 3 idx: 200 First Loss : 0.9409831894923057, Second Loss : 0.9342370083861387
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6734974747474748
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.672929292929293
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6466290509259259
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6612654320987654
epoch: 4 idx: 0 First Loss : 2.663055181503296, Second Loss : 2.936288356781006
epoch: 4 idx: 200 First Loss : 0.9322261658140379, Second Loss : 0.9239162981639899
  First-Tier acc 0.4010416666666667, precision 0.3653968253968254, recall 0.43909090909090914, F1 0.3073907361695949, AUC 0.6975631313131313
  Second-Tier acc 0.4583333333333333, precision 0.34282099936748894, recall 0.46303030303030307, F1 0.34920634920634913, AUC 0.651060606060606
  First-Tier acc 0.4846938775510204, precision 0.3946271222866968, recall 0.433641975308642, F1 0.35395970228270685, AUC 0.6687127976190476
  Second-Tier acc 0.5510204081632653, precision 0.393103448275862, recall 0.4594356261022927, F1 0.3974929902688438, AUC 0.6802799823633157
epoch: 5 idx: 0 First Loss : 3.0839478969573975, Second Loss : 3.2732458114624023
epoch: 5 idx: 200 First Loss : 0.9268953529283849, Second Loss : 0.910942658601301
  First-Tier acc 0.3645833333333333, precision 0.3625, recall 0.42, F1 0.27510398098633393, AUC 0.6518781565656565
  Second-Tier acc 0.4375, precision 0.3611721611721612, recall 0.4666666666666666, F1 0.3348588863463005, AUC 0.6713636363636364
  First-Tier acc 0.4744897959183674, precision 0.4264069264069264, recall 0.4417989417989418, F1 0.34476190476190477, AUC 0.6525142609126985
  Second-Tier acc 0.5306122448979592, precision 0.41633986928104577, recall 0.47001763668430335, F1 0.38690476190476186, AUC 0.7179232804232804
epoch: 6 idx: 0 First Loss : 3.3590962886810303, Second Loss : 3.635258197784424
epoch: 6 idx: 200 First Loss : 0.9215658998408758, Second Loss : 0.9175205533589649
  First-Tier acc 0.3489583333333333, precision 0.3632404181184669, recall 0.41, F1 0.2608173076923077, AUC 0.6180650252525252
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.6957070707070706
  First-Tier acc 0.42346938775510207, precision 0.41183943089430897, recall 0.4109347442680776, F1 0.30173160173160174, AUC 0.6416205081569665
  Second-Tier acc 0.4897959183673469, precision 0.4024216524216524, recall 0.445326278659612, F1 0.3566666666666667, AUC 0.6877755731922398
epoch: 7 idx: 0 First Loss : 3.4169533252716064, Second Loss : 3.7275075912475586
epoch: 7 idx: 200 First Loss : 0.9187828100874872, Second Loss : 0.9093456143867781
  First-Tier acc 0.328125, precision 0.3511904761904762, recall 0.39666666666666667, F1 0.24051531750862246, AUC 0.5521243686868686
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6253030303030302
  First-Tier acc 0.40816326530612246, precision 0.41712323763605813, recall 0.4045414462081129, F1 0.2864197530864197, AUC 0.6213452105379189
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.6468253968253969
epoch: 8 idx: 0 First Loss : 3.6665849685668945, Second Loss : 4.065136432647705
epoch: 8 idx: 200 First Loss : 0.9233747012044456, Second Loss : 0.9000110343838255
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6911931818181817
  Second-Tier acc 0.5833333333333334, precision 0.4142857142857143, recall 0.56, F1 0.43988603988603986, AUC 0.5466161616161617
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6362399415784833
  Second-Tier acc 0.5102040816326531, precision 0.36783625730994146, recall 0.4347442680776014, F1 0.3695652173913044, AUC 0.622905643738977
epoch: 9 idx: 0 First Loss : 3.9601378440856934, Second Loss : 4.65846586227417
epoch: 9 idx: 200 First Loss : 0.9217007355851385, Second Loss : 0.8956018313751046
  First-Tier acc 0.296875, precision 0.3387114845938375, recall 0.37666666666666665, F1 0.20801623541349568, AUC 0.5722411616161617
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.5307070707070706
  First-Tier acc 0.37244897959183676, precision 0.43761638733705777, recall 0.38580246913580246, F1 0.24953191489361704, AUC 0.5909219301146384
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6599426807760141{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.0998025614258144, "droprate_2": 0.0, "lr": 1.023894666614482e-05, "weight_decay": 3.774217108566028e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "ReduceLROnPlateau", "step_size": 19, "gamma": 0.12559238305346876, "T_max": 16, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0832579135894775, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.061969016321856, Second Loss : 1.0553929396529695
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7090277777777777
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6853030303030302
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6077353395061728
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6116622574955908
epoch: 1 idx: 0 First Loss : 1.804763913154602, Second Loss : 1.8453978300094604
epoch: 1 idx: 200 First Loss : 1.1006617090891844, Second Loss : 1.0961385039399512
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7221654040404041
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7128787878787879
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6453924162257495
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6377314814814815
epoch: 2 idx: 0 First Loss : 1.984529972076416, Second Loss : 2.012927532196045
epoch: 2 idx: 200 First Loss : 1.093992907906053, Second Loss : 1.0916911841031924
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7386616161616161
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7295959595959595
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6714306382275131
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6705246913580248
epoch: 3 idx: 0 First Loss : 2.0352673530578613, Second Loss : 2.0669002532958984
epoch: 3 idx: 200 First Loss : 1.0807707797532058, Second Loss : 1.0819072868693527
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7448737373737374
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445959595959596
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6906828703703703
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6848544973544973
epoch: 4 idx: 0 First Loss : 2.094144582748413, Second Loss : 2.1249592304229736
epoch: 4 idx: 200 First Loss : 1.0684244420694475, Second Loss : 1.0726184436486135
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7438352272727272
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.750050505050505
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6997630070546738
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7014991181657848
epoch: 5 idx: 0 First Loss : 2.17353892326355, Second Loss : 2.1970250606536865
epoch: 5 idx: 200 First Loss : 1.0587545455762404, Second Loss : 1.0648850306720283
  First-Tier acc 0.5572916666666666, precision 0.5135135135135135, recall 0.3863636363636364, F1 0.32542139662882696, AUC 0.7416445707070706
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7462121212121211
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.7025600749559082
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7034832451499118
epoch: 6 idx: 0 First Loss : 2.263479709625244, Second Loss : 2.2827470302581787
epoch: 6 idx: 200 First Loss : 1.0286625210770326, Second Loss : 1.0324090977954627
  First-Tier acc 0.5677083333333334, precision 0.4611111111111111, recall 0.40575757575757576, F1 0.3547619047619048, AUC 0.7412342171717171
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7467676767676767
  First-Tier acc 0.5510204081632653, precision 0.18848167539267016, recall 0.3333333333333333, F1 0.24080267558528426, AUC 0.7022156084656085
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7021604938271605
epoch: 7 idx: 0 First Loss : 2.283884048461914, Second Loss : 2.3096160888671875
epoch: 7 idx: 200 First Loss : 1.0182918410247832, Second Loss : 1.0245177164970345
  First-Tier acc 0.5677083333333334, precision 0.44542536115569825, recall 0.41, F1 0.36144877201686926, AUC 0.7411237373737375
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7460101010101011
  First-Tier acc 0.5510204081632653, precision 0.19047619047619047, recall 0.3333333333333333, F1 0.24242424242424243, AUC 0.7018608079805996
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7017195767195767
epoch: 8 idx: 0 First Loss : 2.3070147037506104, Second Loss : 2.3316190242767334
epoch: 8 idx: 200 First Loss : 1.0130344356099765, Second Loss : 1.019898718639986
  First-Tier acc 0.578125, precision 0.45643939393939387, recall 0.4251515151515151, F1 0.3811594202898551, AUC 0.7410858585858585
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7465151515151515
  First-Tier acc 0.5663265306122449, precision 0.29354838709677417, recall 0.3511904761904762, F1 0.2752009894867038, AUC 0.701009975749559
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.6991843033509699
epoch: 9 idx: 0 First Loss : 2.329559803009033, Second Loss : 2.3515865802764893
epoch: 9 idx: 200 First Loss : 1.0099092589978556, Second Loss : 1.0169697976230982
  First-Tier acc 0.578125, precision 0.4415686274509804, recall 0.4251515151515151, F1 0.379652260307998, AUC 0.7402967171717171
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7457575757575757
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.701113315696649
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.6984126984126983{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.29809363422509844, "droprate_2": 0.0, "lr": 7.430217796588155e-05, "weight_decay": 0.0008310404374721564, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1162647008895874, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1152194687234822, Second Loss : 1.1110942394134418
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399936868686868
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445959595959596
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6922226355820106
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6939484126984127
epoch: 1 idx: 0 First Loss : 1.901105284690857, Second Loss : 2.0270628929138184
epoch: 1 idx: 200 First Loss : 1.00913142883659, Second Loss : 1.0220114195079946
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7366319444444445
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.745050505050505
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7117332175925926
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134589947089948
epoch: 2 idx: 0 First Loss : 2.3214664459228516, Second Loss : 2.4109299182891846
epoch: 2 idx: 200 First Loss : 0.9614291909470487, Second Loss : 0.9783452700693809
  First-Tier acc 0.6770833333333334, precision 0.6468013468013467, recall 0.5943686868686868, F1 0.5630208388570471, AUC 0.731467803030303
  Second-Tier acc 0.6458333333333334, precision 0.5702380952380953, recall 0.5270707070707071, F1 0.5205366357069144, AUC 0.7442929292929293
  First-Tier acc 0.6275510204081632, precision 0.6294655213552851, recall 0.5774911816578484, F1 0.5964837625979843, AUC 0.7024877369929454
  Second-Tier acc 0.5918367346938775, precision 0.529548357134564, recall 0.5504850088183422, F1 0.5294758635719733, AUC 0.70706569664903
epoch: 3 idx: 0 First Loss : 2.8134653568267822, Second Loss : 2.9334774017333984
epoch: 3 idx: 200 First Loss : 0.9309837322923081, Second Loss : 0.9457608216363399
  First-Tier acc 0.5677083333333334, precision 0.55627052545156, recall 0.5675252525252525, F1 0.5482259570494864, AUC 0.7420044191919192
  Second-Tier acc 0.4791666666666667, precision 0.45594662985967327, recall 0.4543434343434343, F1 0.4244846041231671, AUC 0.7514646464646465
  First-Tier acc 0.5, precision 0.4885638618032984, recall 0.5267857142857143, F1 0.4787568491858431, AUC 0.7115472056878307
  Second-Tier acc 0.5918367346938775, precision 0.5798245614035088, recall 0.6078042328042329, F1 0.5790470777683054, AUC 0.7379298941798943
epoch: 4 idx: 0 First Loss : 3.1263270378112793, Second Loss : 3.4278745651245117
epoch: 4 idx: 200 First Loss : 0.9193993965580837, Second Loss : 0.9320923641824456
  First-Tier acc 0.53125, precision 0.5679734219269102, recall 0.5709090909090909, F1 0.5237606837606839, AUC 0.758292297979798
  Second-Tier acc 0.4375, precision 0.4982683982683982, recall 0.46161616161616165, F1 0.40170208719631056, AUC 0.7768686868686868
  First-Tier acc 0.5, precision 0.5235107603049315, recall 0.5554453262786596, F1 0.49449381359487843, AUC 0.7195353835978836
  Second-Tier acc 0.5510204081632653, precision 0.5615942028985507, recall 0.5945767195767195, F1 0.5514118769932723, AUC 0.738205467372134
epoch: 5 idx: 0 First Loss : 3.368342399597168, Second Loss : 3.7674312591552734
epoch: 5 idx: 200 First Loss : 0.9162099170197376, Second Loss : 0.9262766881025771
  First-Tier acc 0.4635416666666667, precision 0.5236169746148364, recall 0.5209848484848485, F1 0.4582823757184215, AUC 0.764927398989899
  Second-Tier acc 0.4166666666666667, precision 0.4676767676767677, recall 0.45080808080808077, F1 0.36215940921823275, AUC 0.7977272727272727
  First-Tier acc 0.4846938775510204, precision 0.525314441841079, recall 0.5401234567901234, F1 0.47705714555405704, AUC 0.7216021825396824
  Second-Tier acc 0.5306122448979592, precision 0.5370370370370371, recall 0.5529100529100529, F1 0.5183478532171742, AUC 0.7397486772486772
epoch: 6 idx: 0 First Loss : 3.4563522338867188, Second Loss : 3.9355034828186035
epoch: 6 idx: 200 First Loss : 0.9143858806818576, Second Loss : 0.9208317209586538
  First-Tier acc 0.4427083333333333, precision 0.5091659316081758, recall 0.49808080808080807, F1 0.4304078674846061, AUC 0.7568939393939393
  Second-Tier acc 0.4375, precision 0.4777777777777778, recall 0.48111111111111104, F1 0.3773109243697479, AUC 0.7945959595959596
  First-Tier acc 0.4642857142857143, precision 0.520797419634629, recall 0.517581569664903, F1 0.4557620192733185, AUC 0.7194664902998236
  Second-Tier acc 0.5102040816326531, precision 0.5382580382580383, recall 0.5405643738977072, F1 0.5023912003825921, AUC 0.749889770723104
epoch: 7 idx: 0 First Loss : 3.4679760932922363, Second Loss : 4.081212043762207
epoch: 7 idx: 200 First Loss : 0.9110228579018765, Second Loss : 0.9171896844764069
  First-Tier acc 0.453125, precision 0.5231388193469161, recall 0.5132323232323232, F1 0.4393440544534646, AUC 0.7406186868686869
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.7862626262626263
  First-Tier acc 0.46938775510204084, precision 0.5360051492223623, recall 0.5203373015873015, F1 0.4561817369845505, AUC 0.7067281194885361
  Second-Tier acc 0.5306122448979592, precision 0.5792207792207792, recall 0.5758377425044091, F1 0.5140629351155667, AUC 0.7436618165784834
epoch: 8 idx: 0 First Loss : 3.3950867652893066, Second Loss : 4.111263751983643
epoch: 8 idx: 200 First Loss : 0.9047470753062609, Second Loss : 0.9134604992502513
  First-Tier acc 0.421875, precision 0.496523837543255, recall 0.4823989898989898, F1 0.4055674901539563, AUC 0.7219160353535353
  Second-Tier acc 0.4166666666666667, precision 0.4584986772486772, recall 0.4677777777777778, F1 0.3624931000551996, AUC 0.7615656565656566
  First-Tier acc 0.45408163265306123, precision 0.5277732277732278, recall 0.4919532627865961, F1 0.4344118263448921, AUC 0.6963355654761904
  Second-Tier acc 0.5102040816326531, precision 0.5458874458874459, recall 0.5341710758377425, F1 0.47702589807852963, AUC 0.7593143738977073
epoch: 9 idx: 0 First Loss : 3.330540895462036, Second Loss : 4.117417812347412
epoch: 9 idx: 200 First Loss : 0.9011579090428182, Second Loss : 0.9087267671329483
  First-Tier acc 0.4114583333333333, precision 0.48817614812328686, recall 0.47212121212121216, F1 0.39549084138191454, AUC 0.697673611111111
  Second-Tier acc 0.4375, precision 0.4878547378547378, recall 0.4955555555555556, F1 0.4028679476249808, AUC 0.7337878787878788
  First-Tier acc 0.42346938775510207, precision 0.5021801173299508, recall 0.4469797178130512, F1 0.3947165973770043, AUC 0.689680472883598
  Second-Tier acc 0.4897959183673469, precision 0.5125541125541125, recall 0.4925044091710758, F1 0.43998886104149265, AUC 0.7603615520282188{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_16", "train_show_freq": 200, "droprate": 0.21115670060632746, "droprate_2": 0.0, "lr": 5.7179125503670725e-05, "weight_decay": 2.6901388319102526e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 4, "gamma": 0.41453106808057616, "T_max": 10, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_16", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0914398431777954, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1177708316056882, Second Loss : 1.1115710164480541
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.745909090909091
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7341919191919192
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6854917603615519
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6840828924162258
epoch: 1 idx: 0 First Loss : 1.9233121871948242, Second Loss : 2.037217855453491
epoch: 1 idx: 200 First Loss : 1.0284730089244558, Second Loss : 1.0336028732618883
  First-Tier acc 0.5677083333333334, precision 0.48535074501925335, recall 0.40575757575757576, F1 0.35608756605197883, AUC 0.7404703282828283
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7437373737373738
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.6956535218253969
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6943342151675486
epoch: 2 idx: 0 First Loss : 2.2371201515197754, Second Loss : 2.347125768661499
epoch: 2 idx: 200 First Loss : 0.9780091732295592, Second Loss : 0.986354617448292
  First-Tier acc 0.625, precision 0.5697272615080834, recall 0.562929292929293, F1 0.5029734176653607, AUC 0.738655303030303
  Second-Tier acc 0.625, precision 0.5111111111111111, recall 0.5332323232323232, F1 0.49059829059829063, AUC 0.7463636363636365
  First-Tier acc 0.5663265306122449, precision 0.5356806357789522, recall 0.48848104056437397, F1 0.48874083232212223, AUC 0.6830942735890652
  Second-Tier acc 0.6122448979591837, precision 0.5896296296296296, recall 0.6086860670194003, F1 0.5979351952982785, AUC 0.6888778659611993
epoch: 3 idx: 0 First Loss : 2.6592845916748047, Second Loss : 2.796907901763916
epoch: 3 idx: 200 First Loss : 0.9440900924527527, Second Loss : 0.9498900574126944
  First-Tier acc 0.5885416666666666, precision 0.5862679955703212, recall 0.5986363636363636, F1 0.5600517129928895, AUC 0.7504419191919193
  Second-Tier acc 0.5208333333333334, precision 0.49021103483346046, recall 0.49797979797979797, F1 0.4582095464448406, AUC 0.7548484848484849
  First-Tier acc 0.5663265306122449, precision 0.5607601839996207, recall 0.5997023809523809, F1 0.5605103265033685, AUC 0.7035039131393299
  Second-Tier acc 0.6122448979591837, precision 0.607073238652186, recall 0.6316137566137566, F1 0.6039459261965656, AUC 0.7148368606701941
epoch: 4 idx: 0 First Loss : 3.091327667236328, Second Loss : 3.2369298934936523
epoch: 4 idx: 200 First Loss : 0.9151358239593642, Second Loss : 0.9194736934790564
  First-Tier acc 0.46875, precision 0.5452546469950821, recall 0.5506818181818182, F1 0.4701640938932255, AUC 0.767544191919192
  Second-Tier acc 0.4791666666666667, precision 0.5235897435897435, recall 0.5164646464646464, F1 0.452960102960103, AUC 0.7897474747474748
  First-Tier acc 0.45408163265306123, precision 0.5046031184949531, recall 0.5442570546737214, F1 0.4524481137484233, AUC 0.7251984126984127
  Second-Tier acc 0.42857142857142855, precision 0.4577089577089577, recall 0.5103615520282186, F1 0.4174603174603175, AUC 0.7349537037037036
epoch: 5 idx: 0 First Loss : 2.84013032913208, Second Loss : 3.0169553756713867
epoch: 5 idx: 200 First Loss : 0.9008986141477058, Second Loss : 0.9046261831006007
  First-Tier acc 0.453125, precision 0.5344323452308933, recall 0.5370707070707071, F1 0.45427792133218486, AUC 0.7681407828282829
  Second-Tier acc 0.4375, precision 0.5172558922558923, recall 0.49232323232323233, F1 0.4294465957751961, AUC 0.8021717171717172
  First-Tier acc 0.44387755102040816, precision 0.508965363626239, recall 0.5336199294532628, F1 0.44301326126303736, AUC 0.7244371417548501
  Second-Tier acc 0.42857142857142855, precision 0.4818775995246583, recall 0.5218253968253969, F1 0.4263411587924204, AUC 0.7300485008818342
epoch: 6 idx: 0 First Loss : 2.9991402626037598, Second Loss : 3.2071330547332764
epoch: 6 idx: 200 First Loss : 0.901325688419391, Second Loss : 0.9037537728135118
  First-Tier acc 0.4635416666666667, precision 0.5498324869141468, recall 0.5528535353535354, F1 0.4636844086349672, AUC 0.7677746212121211
  Second-Tier acc 0.4791666666666667, precision 0.5643939393939393, recall 0.5554545454545455, F1 0.48282828282828283, AUC 0.8047979797979798
  First-Tier acc 0.42857142857142855, precision 0.5152978213219177, recall 0.5227623456790124, F1 0.42875316334109326, AUC 0.7243613591269842
  Second-Tier acc 0.46938775510204084, precision 0.5394736842105263, recall 0.5694444444444444, F1 0.47225657029578594, AUC 0.7295524691358025
epoch: 7 idx: 0 First Loss : 3.0919418334960938, Second Loss : 3.3342370986938477
epoch: 7 idx: 200 First Loss : 0.9009585066591922, Second Loss : 0.902912582145698
  First-Tier acc 0.4270833333333333, precision 0.5228349363645196, recall 0.5157070707070707, F1 0.42433281430909897, AUC 0.7651136363636363
  Second-Tier acc 0.4583333333333333, precision 0.553688141923436, recall 0.5446464646464646, F1 0.46128899835796383, AUC 0.806868686868687
  First-Tier acc 0.42346938775510207, precision 0.5231342363948318, recall 0.5209435626102293, F1 0.42332449829609997, AUC 0.7251708553791887
  Second-Tier acc 0.4897959183673469, precision 0.5566137566137566, recall 0.5932539682539683, F1 0.494030294030294, AUC 0.7373236331569665
epoch: 8 idx: 0 First Loss : 3.145329475402832, Second Loss : 3.4298417568206787
epoch: 8 idx: 200 First Loss : 0.8944921842915242, Second Loss : 0.8980762998930257
  First-Tier acc 0.3697916666666667, precision 0.48768283960871167, recall 0.4562878787878788, F1 0.35471681243351433, AUC 0.756875
  Second-Tier acc 0.4375, precision 0.5599078341013825, recall 0.5219191919191919, F1 0.4352453102453102, AUC 0.8003030303030303
  First-Tier acc 0.42346938775510207, precision 0.5231105489726179, recall 0.49988977072310403, F1 0.4185729403833342, AUC 0.7197661761463845
  Second-Tier acc 0.5102040816326531, precision 0.5939153439153438, recall 0.6106701940035273, F1 0.5227513227513227, AUC 0.753858024691358
epoch: 9 idx: 0 First Loss : 3.010087490081787, Second Loss : 3.2809371948242188
epoch: 9 idx: 200 First Loss : 0.8814554231204278, Second Loss : 0.8825387850714227
  First-Tier acc 0.3645833333333333, precision 0.4822689753615094, recall 0.4535858585858586, F1 0.3461387551275192, AUC 0.7552904040404039
  Second-Tier acc 0.4166666666666667, precision 0.557142857142857, recall 0.49666666666666665, F1 0.3955314009661836, AUC 0.7998989898989898
  First-Tier acc 0.42857142857142855, precision 0.5281746031746032, recall 0.4997795414462081, F1 0.41876114081996435, AUC 0.7206652336860669
  Second-Tier acc 0.5306122448979592, precision 0.6379310344827586, recall 0.6344797178130511, F1 0.5384274640088593, AUC 0.7531415343915343