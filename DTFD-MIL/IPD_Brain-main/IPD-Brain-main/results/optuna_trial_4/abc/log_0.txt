{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.39466931726033955, "droprate_2": 0.0, "lr": 0.0003707127617980232, "weight_decay": 0.000570380753966613, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0003707127617980232
epoch: 0 idx: 0 First Loss : 1.1631784439086914, Second Loss : 1.1625289916992188
epoch: 0 idx: 200 First Loss : 1.0767126125631048, Second Loss : 1.0707564498877051
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4956060606060606
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48767676767676765
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4286939055457574
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4654982363315696
 
 test auc: 0.4654982363315696, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.3533162623478651, "droprate_2": 0.0, "lr": 1.736041170471181e-05, "weight_decay": 0.0005791666238229862, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.736041170471181e-05
epoch: 0 idx: 0 First Loss : 1.007082223892212, Second Loss : 1.1648786067962646
epoch: 0 idx: 200 First Loss : 1.063481948120677, Second Loss : 1.0622868938232535
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5219640852974187
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5034848484848485
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4289511071918479
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46059303350970016
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 1 idx: 0 First Loss : 1.617762565612793, Second Loss : 1.8099223375320435
epoch: 1 idx: 200 First Loss : 1.0705060285715322, Second Loss : 1.0750025512270667
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.513658810325477
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5022727272727273
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4392514207329023
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4530423280423281
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 2 idx: 0 First Loss : 1.6697015762329102, Second Loss : 1.8604885339736938
epoch: 2 idx: 200 First Loss : 1.0497677644983452, Second Loss : 1.0564239267537843
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.507996632996633
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5029292929292929
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44488536155202824
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44565696649029984
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 3 idx: 0 First Loss : 1.7008460760116577, Second Loss : 1.8976893424987793
epoch: 3 idx: 200 First Loss : 1.0340539003486064, Second Loss : 1.0433244743009111
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5071773288439956
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49843434343434345
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44962522045855385
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4508377425044092
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 4 idx: 0 First Loss : 1.740338683128357, Second Loss : 1.9512240886688232
epoch: 4 idx: 200 First Loss : 1.0214596212058518, Second Loss : 1.0312648922649783
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5029068462401796
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5025252525252525
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45221560846560843
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4544753086419753
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 5 idx: 0 First Loss : 1.774123191833496, Second Loss : 2.013742685317993
epoch: 5 idx: 200 First Loss : 1.007989457776001, Second Loss : 1.0196878536423641
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5010157126823794
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.49833333333333335
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45846805800509505
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4544201940035273
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 6 idx: 0 First Loss : 1.820839524269104, Second Loss : 2.0744478702545166
epoch: 6 idx: 200 First Loss : 0.9963906882191772, Second Loss : 1.0087340106418476
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3055555555555556, precision 0.3636363636363636, recall 0.4158249158249158, F1 0.2830687830687831, AUC 0.49807519640852976
  Second-Tier acc 0.3125, precision 0.4222222222222222, recall 0.42424242424242425, F1 0.2832080200501253, AUC 0.4994444444444444
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2925170068027211, precision 0.4305555555555556, recall 0.34722222222222227, F1 0.17720430107526883, AUC 0.46326915539878505
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.4631834215167548
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 7 idx: 0 First Loss : 1.8688493967056274, Second Loss : 2.1260972023010254
epoch: 7 idx: 200 First Loss : 0.9841442374670091, Second Loss : 0.9974395364374664
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2847222222222222, precision 0.2690669763840496, recall 0.3897306397306397, F1 0.26974143955276025, AUC 0.4946240179573513
  Second-Tier acc 0.2916666666666667, precision 0.27177700348432055, recall 0.398989898989899, F1 0.27393431167016075, AUC 0.4927272727272727
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.2857142857142857, precision 0.42786069651741293, recall 0.35714285714285715, F1 0.23917748917748916, AUC 0.47013398980991566
  Second-Tier acc 0.2653061224489796, precision 0.09629629629629628, recall 0.30952380952380953, F1 0.14689265536723164, AUC 0.46996252204585537
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 8 idx: 0 First Loss : 1.9123668670654297, Second Loss : 2.1846120357513428
epoch: 8 idx: 200 First Loss : 0.9708205215744118, Second Loss : 0.9847545802815637
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2916666666666667, precision 0.2521584084084084, recall 0.40319865319865317, F1 0.2877376591662306, AUC 0.4866329966329966
  Second-Tier acc 0.2916666666666667, precision 0.26210826210826216, recall 0.40151515151515155, F1 0.2843137254901961, AUC 0.4807575757575758
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.29931972789115646, precision 0.4159504452187379, recall 0.3989564961787184, F1 0.3208618694686806, AUC 0.48353909465020584
  Second-Tier acc 0.24489795918367346, precision 0.42276422764227645, recall 0.30357142857142855, F1 0.2074074074074074, AUC 0.47255291005291
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 9 idx: 0 First Loss : 1.95282781124115, Second Loss : 2.238961935043335
epoch: 9 idx: 200 First Loss : 0.9599841481343431, Second Loss : 0.9733645145721104
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.2693363844393593, recall 0.4671717171717172, F1 0.3347183302734564, AUC 0.48162177328843997
  Second-Tier acc 0.3541666666666667, precision 0.2808080808080808, recall 0.494949494949495, F1 0.3492877492877493, AUC 0.47565656565656567
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3129251700680272, precision 0.42556359629530355, recall 0.36346266901822455, F1 0.358622491495658, AUC 0.4938149127963943
  Second-Tier acc 0.24489795918367346, precision 0.33137254901960783, recall 0.2462522045855379, F1 0.2333333333333333, AUC 0.4833002645502645
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 10 idx: 0 First Loss : 1.9937548637390137, Second Loss : 2.290736436843872
epoch: 10 idx: 200 First Loss : 0.947496735152617, Second Loss : 0.9621759682374807
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.3590683488671668, recall 0.4342087542087542, F1 0.3230345654653007, AUC 0.4804264870931538
  Second-Tier acc 0.3125, precision 0.2349624060150376, recall 0.4419191919191919, F1 0.3055555555555555, AUC 0.4765151515151515
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.29931972789115646, precision 0.3556570268899036, recall 0.32848324514991184, F1 0.33058117405943493, AUC 0.5073118753674309
  Second-Tier acc 0.2653061224489796, precision 0.26666666666666666, recall 0.24713403880070547, F1 0.24031642116748497, AUC 0.49327601410934746
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 11 idx: 0 First Loss : 2.040950059890747, Second Loss : 2.3371901512145996
epoch: 11 idx: 200 First Loss : 0.9361557036230517, Second Loss : 0.9516214743923785
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3263888888888889, precision 0.3771800540407762, recall 0.41939393939393943, F1 0.3304507087115783, AUC 0.4834511784511785
  Second-Tier acc 0.2708333333333333, precision 0.1915151515151515, recall 0.3863636363636364, F1 0.2560742560742561, AUC 0.46661616161616165
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.29931972789115646, precision 0.33805970149253733, recall 0.3110670194003527, F1 0.3171171011303746, AUC 0.5192472565157751
  Second-Tier acc 0.24489795918367346, precision 0.24472990777338602, recall 0.21186067019400354, F1 0.21777777777777776, AUC 0.503913139329806
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 12 idx: 0 First Loss : 2.081295967102051, Second Loss : 2.3859615325927734
epoch: 12 idx: 200 First Loss : 0.9258618789043889, Second Loss : 0.942098886145288
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3194444444444444, precision 0.34892235736020444, recall 0.40616161616161617, F1 0.31432624113475177, AUC 0.490016835016835
  Second-Tier acc 0.2916666666666667, precision 0.35101010101010105, recall 0.3996969696969697, F1 0.27399107791264654, AUC 0.4663131313131313
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3129251700680272, precision 0.3331613347093223, recall 0.3057025279247501, F1 0.31467012693428653, AUC 0.5280900940623162
  Second-Tier acc 0.2857142857142857, precision 0.3304093567251462, recall 0.2951940035273369, F1 0.3080383668618963, AUC 0.5144951499118166
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 13 idx: 0 First Loss : 2.119187593460083, Second Loss : 2.43306827545166
epoch: 13 idx: 200 First Loss : 0.9163013353239541, Second Loss : 0.9329293708859095
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.33564814814814814, recall 0.4066329966329966, F1 0.31375661375661373, AUC 0.4958361391694725
  Second-Tier acc 0.2708333333333333, precision 0.27777777777777773, recall 0.3405050505050505, F1 0.24603576248313086, AUC 0.47050505050505054
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.34430827388573865, recall 0.32782186948853614, F1 0.3336408030385241, AUC 0.5364797668038409
  Second-Tier acc 0.30612244897959184, precision 0.3422222222222222, recall 0.3075396825396825, F1 0.3207417582417582, AUC 0.5263999118165784
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 14 idx: 0 First Loss : 2.147991895675659, Second Loss : 2.472470998764038
epoch: 14 idx: 200 First Loss : 0.9065061685124144, Second Loss : 0.924790511435982
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.3178787878787879, recall 0.3982154882154882, F1 0.30018518518518517, AUC 0.5019921436588103
  Second-Tier acc 0.2916666666666667, precision 0.28557744937055285, recall 0.37080808080808075, F1 0.2569444444444445, AUC 0.4751515151515151
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3673469387755102, precision 0.36266286688904, recall 0.37389770723104054, F1 0.3671356182922607, AUC 0.538549627669998
  Second-Tier acc 0.2857142857142857, precision 0.30427350427350425, recall 0.26587301587301587, F1 0.2782716497339139, AUC 0.533013668430335
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 15 idx: 0 First Loss : 2.172717809677124, Second Loss : 2.503601312637329
epoch: 15 idx: 200 First Loss : 0.8974533127111137, Second Loss : 0.9171345582352349
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3194444444444444, precision 0.3105413105413105, recall 0.3934006734006734, F1 0.2941671082847554, AUC 0.5059034792368126
  Second-Tier acc 0.2916666666666667, precision 0.2837173579109063, recall 0.37080808080808075, F1 0.25153318903318905, AUC 0.48292929292929293
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.38095238095238093, precision 0.3702861805676983, recall 0.3880805408583186, F1 0.3780317222430374, AUC 0.5438283852635705
  Second-Tier acc 0.3469387755102041, precision 0.3204707170224412, recall 0.3029100529100529, F1 0.3095238095238095, AUC 0.5442570546737213
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 16 idx: 0 First Loss : 2.1950085163116455, Second Loss : 2.5314066410064697
epoch: 16 idx: 200 First Loss : 0.8891649590851507, Second Loss : 0.9102291581939109
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.31939731020613377, recall 0.39663299663299667, F1 0.3057273561946459, AUC 0.5112514029180696
  Second-Tier acc 0.2916666666666667, precision 0.2837173579109063, recall 0.37080808080808075, F1 0.25153318903318905, AUC 0.4913636363636364
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3877551020408163, precision 0.3692133815551537, recall 0.3883744855967078, F1 0.3777439024390244, AUC 0.5481640701548108
  Second-Tier acc 0.3469387755102041, precision 0.31009220664393083, recall 0.3029100529100529, F1 0.3058201058201058, AUC 0.5461860670194003
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 17 idx: 0 First Loss : 2.216799020767212, Second Loss : 2.5597362518310547
epoch: 17 idx: 200 First Loss : 0.8814061338925243, Second Loss : 0.903468765892941
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3402777777777778, precision 0.32916666666666666, recall 0.4010774410774411, F1 0.30999560522248765, AUC 0.5127048260381594
  Second-Tier acc 0.2916666666666667, precision 0.2837173579109063, recall 0.37080808080808075, F1 0.25153318903318905, AUC 0.49540404040404046
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3945578231292517, precision 0.3635174282777311, recall 0.38866843033509696, F1 0.3743132663146554, AUC 0.5533387223202039
  Second-Tier acc 0.32653061224489793, precision 0.27012987012987016, recall 0.27910052910052907, F1 0.27286195286195286, AUC 0.5520282186948854
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 18 idx: 0 First Loss : 2.233535051345825, Second Loss : 2.581853151321411
epoch: 18 idx: 200 First Loss : 0.8737334282466428, Second Loss : 0.8973300108102276
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3402777777777778, precision 0.32899728997289973, recall 0.4010774410774411, F1 0.3082084559532751, AUC 0.5167845117845118
  Second-Tier acc 0.2916666666666667, precision 0.26944444444444443, recall 0.37080808080808075, F1 0.2535107169253511, AUC 0.49843434343434345
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3945578231292517, precision 0.3553467683369644, recall 0.394620811287478, F1 0.3710201429499675, AUC 0.5564067705271408
  Second-Tier acc 0.30612244897959184, precision 0.2570145903479237, recall 0.2667548500881834, F1 0.25931124106562703, AUC 0.556602733686067
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.736041170471181e-05
epoch: 19 idx: 0 First Loss : 2.2518961429595947, Second Loss : 2.5991389751434326
epoch: 19 idx: 200 First Loss : 0.8661632674528443, Second Loss : 0.8915927352022324
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.3398181470470627, recall 0.4156228956228956, F1 0.3190187313750532, AUC 0.5209147025813693
  Second-Tier acc 0.2916666666666667, precision 0.26956391875746716, recall 0.37080808080808075, F1 0.2510822510822511, AUC 0.498939393939394
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3877551020408163, precision 0.3368215565796211, recall 0.38286302175191067, F1 0.35568008855680083, AUC 0.5601851851851852
  Second-Tier acc 0.2857142857142857, precision 0.19348659003831417, recall 0.23148148148148148, F1 0.20952380952380953, AUC 0.5577601410934744
 
 test auc: 0.46059303350970016, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.39482226455595604, "droprate_2": 0.0, "lr": 2.659780926689525e-05, "weight_decay": 0.00011139604192605952, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.659780926689525e-05
epoch: 0 idx: 0 First Loss : 0.8982724547386169, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.088197583138053, Second Loss : 1.083880307514276
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5019135802469136
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47994949494949496
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44299309229864786
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4586640211640212
 
 test auc: 0.4586640211640212, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.659780926689525e-05
epoch: 1 idx: 0 First Loss : 1.865593433380127, Second Loss : 2.044055938720703
epoch: 1 idx: 200 First Loss : 1.0614135971858134, Second Loss : 1.063135920991352
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5019809203142537
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5025757575757576
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44800240054869683
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4575617283950617
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 2 idx: 0 First Loss : 1.9126349687576294, Second Loss : 2.1045291423797607
epoch: 2 idx: 200 First Loss : 1.0329847770247294, Second Loss : 1.0370205248618007
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5046127946127946
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5022727272727273
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4547018910444836
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45916005291005296
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 3 idx: 0 First Loss : 1.9765583276748657, Second Loss : 2.181584119796753
epoch: 3 idx: 200 First Loss : 1.0122954348723094, Second Loss : 1.019439180173091
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2777777777777778, precision 0.41904761904761906, recall 0.3737373737373737, F1 0.20843570843570847, AUC 0.49992143658810323
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4976767676767677
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46813761512835583
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4735449735449735
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 4 idx: 0 First Loss : 2.0455586910247803, Second Loss : 2.2626585960388184
epoch: 4 idx: 200 First Loss : 0.9911971839135559, Second Loss : 1.0004930813143502
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2847222222222222, precision 0.25575836592785745, recall 0.39141414141414144, F1 0.27507520727859713, AUC 0.4878900112233446
  Second-Tier acc 0.2708333333333333, precision 0.24166666666666667, recall 0.37121212121212127, F1 0.2557354925775978, AUC 0.48540404040404045
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.25170068027210885, precision 0.11154177433247199, recall 0.28982951205173424, F1 0.14708488392698918, AUC 0.4905631491279639
  Second-Tier acc 0.2653061224489796, precision 0.42635658914728686, recall 0.3273809523809524, F1 0.21442495126705652, AUC 0.4837962962962963
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 5 idx: 0 First Loss : 2.125032663345337, Second Loss : 2.339170217514038
epoch: 5 idx: 200 First Loss : 0.9716989163364937, Second Loss : 0.9838224206471917
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3402777777777778, precision 0.2582753531520135, recall 0.4772727272727273, F1 0.330749354005168, AUC 0.4807014590347924
  Second-Tier acc 0.3333333333333333, precision 0.2541507024265645, recall 0.4696969696969697, F1 0.3274460330810205, AUC 0.46343434343434337
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2925170068027211, precision 0.4487573099415205, recall 0.29416519694297477, F1 0.2712060097054156, AUC 0.5073976092494611
  Second-Tier acc 0.2857142857142857, precision 0.3840277777777778, recall 0.3410493827160494, F1 0.3236714975845411, AUC 0.5058972663139331
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 6 idx: 0 First Loss : 2.195390462875366, Second Loss : 2.428720474243164
epoch: 6 idx: 200 First Loss : 0.953117307257, Second Loss : 0.9686282204454811
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3125, precision 0.3971828971828972, recall 0.420976430976431, F1 0.30575264843557526, AUC 0.4874186307519641
  Second-Tier acc 0.3125, precision 0.33783175888439043, recall 0.4274747474747475, F1 0.3162071846282372, AUC 0.4615151515151515
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.272108843537415, precision 0.3249158249158249, recall 0.2495590828924162, F1 0.259827056819538, AUC 0.5187083578287282
  Second-Tier acc 0.3469387755102041, precision 0.4144524959742351, recall 0.402336860670194, F1 0.39892392392392395, AUC 0.5163690476190476
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 7 idx: 0 First Loss : 2.279658079147339, Second Loss : 2.499748706817627
epoch: 7 idx: 200 First Loss : 0.9363170638680458, Second Loss : 0.9545465552095157
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3125, precision 0.3697938286979383, recall 0.4121885521885522, F1 0.29834600945833945, AUC 0.4965488215488216
  Second-Tier acc 0.2916666666666667, precision 0.3216450216450216, recall 0.38272727272727275, F1 0.29076797385620917, AUC 0.4655050505050505
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.29931972789115646, precision 0.3091902632886239, recall 0.2583774250440917, F1 0.26912052348945553, AUC 0.5270919067215364
  Second-Tier acc 0.3673469387755102, precision 0.40510366826156297, recall 0.4618606701940035, F1 0.4221621246792871, AUC 0.533344356261023
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 8 idx: 0 First Loss : 2.3494231700897217, Second Loss : 2.5758137702941895
epoch: 8 idx: 200 First Loss : 0.9212636149011144, Second Loss : 0.9416945735687641
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2986111111111111, precision 0.3213718820861678, recall 0.3896969696969697, F1 0.2759018258237415, AUC 0.5023737373737374
  Second-Tier acc 0.3125, precision 0.3311111111111111, recall 0.3816161616161617, F1 0.29685746352413017, AUC 0.4667676767676768
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3197278911564626, precision 0.301792497625831, recall 0.27072310405643735, F1 0.27816247924943577, AUC 0.5321502057613169
  Second-Tier acc 0.3877551020408163, precision 0.3962054457410495, recall 0.47420634920634913, F1 0.41717313386317595, AUC 0.5442019400352733
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 9 idx: 0 First Loss : 2.4170315265655518, Second Loss : 2.6334152221679688
epoch: 9 idx: 200 First Loss : 0.9075152218638368, Second Loss : 0.93014308986305
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3055555555555556, precision 0.31113233421490843, recall 0.3893265993265993, F1 0.2788617311303337, AUC 0.5106790123456789
  Second-Tier acc 0.3333333333333333, precision 0.31604506604506605, recall 0.3974747474747475, F1 0.3097354497354497, AUC 0.47393939393939394
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.35374149659863946, precision 0.3258671047827674, recall 0.31297766019988243, F1 0.3184826140016157, AUC 0.5376861650009798
  Second-Tier acc 0.40816326530612246, precision 0.4086538461538461, recall 0.4865520282186948, F1 0.4307328605200946, AUC 0.5512566137566137
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 10 idx: 0 First Loss : 2.4726333618164062, Second Loss : 2.694607973098755
epoch: 10 idx: 200 First Loss : 0.8954112190586417, Second Loss : 0.9205302667632624
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3263888888888889, precision 0.3308972073677956, recall 0.397003367003367, F1 0.2979595675116517, AUC 0.5161167227833895
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.4787878787878788
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.32533696487184854, recall 0.32716049382716045, F1 0.3258714638234081, AUC 0.5410175387027238
  Second-Tier acc 0.4489795918367347, precision 0.42540792540792544, recall 0.5112433862433862, F1 0.4494605923177352, AUC 0.560515873015873
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 11 idx: 0 First Loss : 2.5139424800872803, Second Loss : 2.7314255237579346
epoch: 11 idx: 200 First Loss : 0.8838835305798409, Second Loss : 0.9112635122343379
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3333333333333333, precision 0.3230110434978589, recall 0.4022895622895623, F1 0.29963915557135895, AUC 0.5180415263748598
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.486969696969697
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3741496598639456, precision 0.3272185456093502, recall 0.34318048206937096, F1 0.33389355742296917, AUC 0.5441223300019596
  Second-Tier acc 0.42857142857142855, precision 0.38825757575757575, recall 0.4874338624338624, F1 0.41104308390022676, AUC 0.5675705467372133
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 12 idx: 0 First Loss : 2.5503346920013428, Second Loss : 2.757373094558716
epoch: 12 idx: 200 First Loss : 0.8738026685864475, Second Loss : 0.9027357077439181
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.3115940109822201, recall 0.3921885521885522, F1 0.29431812073321506, AUC 0.5216778900112233
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.4901010101010101
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.36054421768707484, precision 0.30277569392348086, recall 0.33708112874779544, F1 0.3167997338656022, AUC 0.5493337252596512
  Second-Tier acc 0.40816326530612246, precision 0.3530797101449275, recall 0.4636243386243386, F1 0.38222222222222224, AUC 0.5676256613756613
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 13 idx: 0 First Loss : 2.5815815925598145, Second Loss : 2.7825253009796143
epoch: 13 idx: 200 First Loss : 0.8646426096150828, Second Loss : 0.895412368041959
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.33127572016460904, recall 0.39986531986531987, F1 0.31417884049462996, AUC 0.5245679012345679
  Second-Tier acc 0.3333333333333333, precision 0.3075998075998076, recall 0.3974747474747475, F1 0.29527879527879525, AUC 0.496010101010101
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.2887346297781342, recall 0.3291446208112874, F1 0.3054203464298767, AUC 0.5517403978052126
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5765542328042328
 
 test auc: 0.4575617283950617, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.659780926689525e-05
epoch: 14 idx: 0 First Loss : 2.604961633682251, Second Loss : 2.8017044067382812
epoch: 14 idx: 200 First Loss : 0.8559598913277263, Second Loss : 0.8888143262089189
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.34481529025816576, recall 0.4087542087542088, F1 0.32475738531913984, AUC 0.5277048260381593
  Second-Tier acc 0.4166666666666667, precision 0.37592592592592594, recall 0.45080808080808077, F1 0.37222222222222223, AUC 0.5036868686868686
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.28503149752579754, recall 0.33921222810111695, F1 0.30727350895410577, AUC 0.5535530570252792
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5720348324514991
 
 test auc: 0.5720348324514991, test F1: 0.3513071895424837  :  from epoch 14
 current learn rate 2.659780926689525e-05
epoch: 15 idx: 0 First Loss : 2.624572992324829, Second Loss : 2.8088064193725586
epoch: 15 idx: 200 First Loss : 0.8476969941950111, Second Loss : 0.8825964025912149
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.34172206394428617, recall 0.4087542087542088, F1 0.32514619883040935, AUC 0.5298597081930415
  Second-Tier acc 0.4166666666666667, precision 0.36946457326892107, recall 0.45080808080808077, F1 0.37416592653321495, AUC 0.5023232323232323
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3673469387755102, precision 0.27020202020202017, recall 0.3395061728395062, F1 0.2990138067061144, AUC 0.5552126200274349
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5738536155202821
 
 test auc: 0.5720348324514991, test F1: 0.3513071895424837  :  from epoch 14
 current learn rate 2.659780926689525e-05
epoch: 16 idx: 0 First Loss : 2.6382510662078857, Second Loss : 2.8091440200805664
epoch: 16 idx: 200 First Loss : 0.8395530360273609, Second Loss : 0.8766605611890554
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.3412027218098268, recall 0.4030976430976431, F1 0.32517943068363825, AUC 0.5306790123456789
  Second-Tier acc 0.4166666666666667, precision 0.36946457326892107, recall 0.45080808080808077, F1 0.37416592653321495, AUC 0.5045454545454545
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3673469387755102, precision 0.26165501165501165, recall 0.3395061728395062, F1 0.29266460035690806, AUC 0.5589175485008818
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.57038139329806
 
 test auc: 0.57038139329806, test F1: 0.3513071895424837  :  from epoch 16
 current learn rate 2.659780926689525e-05
epoch: 17 idx: 0 First Loss : 2.6461939811706543, Second Loss : 2.8060169219970703
epoch: 17 idx: 200 First Loss : 0.8320772361510725, Second Loss : 0.8711610680900106
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.34595959595959597, recall 0.4018855218855219, F1 0.33098470826665555, AUC 0.5307351290684624
  Second-Tier acc 0.3958333333333333, precision 0.34987126163596755, recall 0.4205050505050505, F1 0.35642135642135636, AUC 0.5056565656565656
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.36054421768707484, precision 0.2564757042919266, recall 0.33539094650205764, F1 0.28674957776754184, AUC 0.558225553595924
  Second-Tier acc 0.40816326530612246, precision 0.3307757885763001, recall 0.48148148148148145, F1 0.37333333333333335, AUC 0.5737985008818343
 
 test auc: 0.5737985008818343, test F1: 0.37333333333333335  :  from epoch 17
 current learn rate 2.659780926689525e-05
epoch: 18 idx: 0 First Loss : 2.6561813354492188, Second Loss : 2.79995059967041
epoch: 18 idx: 200 First Loss : 0.8250676916902931, Second Loss : 0.8655549225985856
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.34595959595959597, recall 0.4018855218855219, F1 0.33098470826665555, AUC 0.5306004489337823
  Second-Tier acc 0.3958333333333333, precision 0.34987126163596755, recall 0.4205050505050505, F1 0.35642135642135636, AUC 0.5095454545454545
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.2564757042919266, recall 0.33539094650205764, F1 0.28674957776754184, AUC 0.5566456006270821
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5744047619047619
 
 test auc: 0.5744047619047619, test F1: 0.36512820512820515  :  from epoch 18
 current learn rate 2.659780926689525e-05
epoch: 19 idx: 0 First Loss : 2.6615712642669678, Second Loss : 2.7954649925231934
epoch: 19 idx: 200 First Loss : 0.8183434550784787, Second Loss : 0.8606405788615569
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3680555555555556, precision 0.34741731698253436, recall 0.39622895622895626, F1 0.33000060272787546, AUC 0.5292031425364758
  Second-Tier acc 0.3958333333333333, precision 0.34408939014202167, recall 0.4035353535353536, F1 0.35151515151515156, AUC 0.5103030303030303
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.2635658914728682, recall 0.353395061728395, F1 0.2970179044895284, AUC 0.5577907603370567
  Second-Tier acc 0.3877551020408163, precision 0.30392156862745096, recall 0.4398148148148148, F1 0.3435294117647059, AUC 0.5748456790123456
 
 test auc: 0.5748456790123456, test F1: 0.3435294117647059  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.3350770697355986, "droprate_2": 0.0, "lr": 5.769482147782159e-05, "weight_decay": 0.0003648755311386681, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 5.769482147782159e-05
epoch: 0 idx: 0 First Loss : 1.2175697088241577, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.1226318631302659, Second Loss : 1.1060330993055705
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7329797979797981
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7468686868686868
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.675705467372134
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6626984126984127
 
 test auc: 0.6626984126984127, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 5.769482147782159e-05
epoch: 1 idx: 0 First Loss : 2.0559065341949463, Second Loss : 2.0120859146118164
epoch: 1 idx: 200 First Loss : 1.0515203524139982, Second Loss : 1.037092845608939
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486475869809203
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7628787878787878
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7069370958259847
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7051917989417991
 
 test auc: 0.7051917989417991, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 5.769482147782159e-05
epoch: 2 idx: 0 First Loss : 2.230963706970215, Second Loss : 2.1241543292999268
epoch: 2 idx: 200 First Loss : 1.0123305664726752, Second Loss : 0.9997473293869057
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5625, precision 0.47303921568627444, recall 0.39959595959595956, F1 0.34762840519400456, AUC 0.7445117845117846
  Second-Tier acc 0.5625, precision 0.4318181818181818, recall 0.4109090909090909, F1 0.36521739130434777, AUC 0.7578282828282829
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7085782872819909
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7082231040564374
 
 test auc: 0.7051917989417991, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 5.769482147782159e-05
epoch: 3 idx: 0 First Loss : 2.4089038372039795, Second Loss : 2.2735238075256348
epoch: 3 idx: 200 First Loss : 0.9779713686500022, Second Loss : 0.9719759092031427
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6597222222222222, precision 0.647313188841428, recall 0.5732659932659933, F1 0.5155286690120886, AUC 0.7425308641975308
  Second-Tier acc 0.7083333333333334, precision 0.4583333333333333, recall 0.623030303030303, F1 0.5276153346328785, AUC 0.7706565656565655
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5986394557823129, precision 0.609045519936609, recall 0.5133744855967078, F1 0.5390568590568591, AUC 0.6999681559866745
  Second-Tier acc 0.5918367346938775, precision 0.5383064516129031, recall 0.46759259259259256, F1 0.4636015325670498, AUC 0.7182539682539683
 
 test auc: 0.7182539682539683, test F1: 0.4636015325670498  :  from epoch 3
 current learn rate 5.769482147782159e-05
epoch: 4 idx: 0 First Loss : 2.575974702835083, Second Loss : 2.4396514892578125
epoch: 4 idx: 200 First Loss : 0.9511581827418425, Second Loss : 0.9449598735096443
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6111111111111112, precision 0.5689274616950605, recall 0.5888552188552189, F1 0.5396012692633468, AUC 0.7484960718294053
  Second-Tier acc 0.6458333333333334, precision 0.5382366171839855, recall 0.5805050505050505, F1 0.518954248366013, AUC 0.7678282828282829
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5714285714285714, precision 0.5258323765786453, recall 0.5151381540270429, F1 0.503970181540275, AUC 0.7045855379188714
  Second-Tier acc 0.5714285714285714, precision 0.48517786561264825, recall 0.5011022927689593, F1 0.47144082858368574, AUC 0.7300485008818343
 
 test auc: 0.7182539682539683, test F1: 0.4636015325670498  :  from epoch 3
 current learn rate 5.769482147782159e-05
epoch: 5 idx: 0 First Loss : 2.7509958744049072, Second Loss : 2.591500997543335
epoch: 5 idx: 200 First Loss : 0.9254234266184752, Second Loss : 0.9261015823009002
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5694444444444444, precision 0.571764705882353, recall 0.5806060606060607, F1 0.5381882450540135, AUC 0.7582323232323233
  Second-Tier acc 0.5, precision 0.49725274725274726, recall 0.5185858585858586, F1 0.451975051975052, AUC 0.7855555555555555
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5578231292517006, precision 0.5552920509442248, recall 0.551954732510288, F1 0.5349808506879846, AUC 0.7173415147952186
  Second-Tier acc 0.5510204081632653, precision 0.5383986928104575, recall 0.5359347442680776, F1 0.5125598086124402, AUC 0.7509920634920636
 
 test auc: 0.7509920634920636, test F1: 0.5125598086124402  :  from epoch 5
 current learn rate 5.769482147782159e-05
epoch: 6 idx: 0 First Loss : 2.8593547344207764, Second Loss : 2.7093911170959473
epoch: 6 idx: 200 First Loss : 0.9067029736528349, Second Loss : 0.9098279580696306
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5208333333333334, precision 0.5611831991142336, recall 0.5712794612794613, F1 0.5040433290433289, AUC 0.7676094276094276
  Second-Tier acc 0.5, precision 0.5337606837606838, recall 0.5330303030303031, F1 0.4692874692874693, AUC 0.793939393939394
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5034013605442177, precision 0.5215031881698549, recall 0.516901822457378, F1 0.4816674637334608, AUC 0.7217445620223398
  Second-Tier acc 0.4897959183673469, precision 0.5152380952380953, recall 0.5167548500881834, F1 0.48085609061218815, AUC 0.7553461199294533
 
 test auc: 0.7553461199294533, test F1: 0.48085609061218815  :  from epoch 6
 current learn rate 5.769482147782159e-05
epoch: 7 idx: 0 First Loss : 2.9209210872650146, Second Loss : 2.80029034614563
epoch: 7 idx: 200 First Loss : 0.8888282978082475, Second Loss : 0.8989472813274136
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5138888888888888, precision 0.5724358810986229, recall 0.5724915824915825, F1 0.49785292538915726, AUC 0.7728843995510662
  Second-Tier acc 0.5416666666666666, precision 0.5908149821193299, recall 0.603030303030303, F1 0.5351097704038881, AUC 0.8037373737373738
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46938775510204084, precision 0.5026455026455027, recall 0.4903733098177543, F1 0.44691038808685873, AUC 0.7312487752302568
  Second-Tier acc 0.4489795918367347, precision 0.48111111111111104, recall 0.4920634920634921, F1 0.44102564102564107, AUC 0.7648809523809524
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 8 idx: 0 First Loss : 2.991905927658081, Second Loss : 2.859506130218506
epoch: 8 idx: 200 First Loss : 0.8748101547443822, Second Loss : 0.8873140543365656
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5, precision 0.5619902731013843, recall 0.5684175084175084, F1 0.4874795684864335, AUC 0.7720931537598203
  Second-Tier acc 0.5208333333333334, precision 0.5817460317460318, recall 0.5896969696969697, F1 0.5157509157509157, AUC 0.7962121212121213
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4897959183673469, precision 0.5439693256647494, recall 0.5239564961787184, F1 0.46720679012345673, AUC 0.7385973936899863
  Second-Tier acc 0.4897959183673469, precision 0.5695970695970697, recall 0.5396825396825397, F1 0.4712121212121212, AUC 0.7683531746031745
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 9 idx: 0 First Loss : 3.0274884700775146, Second Loss : 2.9235336780548096
epoch: 9 idx: 200 First Loss : 0.862892583086716, Second Loss : 0.8788954335501167
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4861111111111111, precision 0.5530504884880781, recall 0.5595286195286195, F1 0.47418038553538766, AUC 0.7677553310886646
  Second-Tier acc 0.4791666666666667, precision 0.5486772486772487, recall 0.5485858585858586, F1 0.4702530584883526, AUC 0.7924242424242424
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.5609336400034074, recall 0.5334362139917695, F1 0.4623486918527906, AUC 0.744825347834607
  Second-Tier acc 0.4897959183673469, precision 0.5695970695970697, recall 0.5396825396825397, F1 0.4712121212121212, AUC 0.7712742504409172
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 10 idx: 0 First Loss : 3.036067247390747, Second Loss : 2.9647936820983887
epoch: 10 idx: 200 First Loss : 0.8533389742268407, Second Loss : 0.872491984150896
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4791666666666667, precision 0.5452674897119342, recall 0.5550841750841751, F1 0.46709092993922713, AUC 0.7617396184062851
  Second-Tier acc 0.4375, precision 0.517687559354226, recall 0.5074747474747474, F1 0.42351940457203613, AUC 0.7879797979797979
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.48299319727891155, precision 0.5667700258397933, recall 0.54320987654321, F1 0.4665683962264151, AUC 0.7496080736821478
  Second-Tier acc 0.5102040816326531, precision 0.584045584045584, recall 0.5634920634920635, F1 0.48877274487030586, AUC 0.7865410052910052
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 11 idx: 0 First Loss : 3.0332701206207275, Second Loss : 2.961671829223633
epoch: 11 idx: 200 First Loss : 0.8440785434546496, Second Loss : 0.8647834844794587
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4513888888888889, precision 0.5252431289640592, recall 0.5276767676767676, F1 0.43521373766898064, AUC 0.752267115600449
  Second-Tier acc 0.4166666666666667, precision 0.49404761904761907, recall 0.4796969696969697, F1 0.3956876456876457, AUC 0.7829797979797979
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.5765275257108288, recall 0.5429159318048207, F1 0.4574735916988956, AUC 0.7516779345483049
  Second-Tier acc 0.46938775510204084, precision 0.5318704284221526, recall 0.4801587301587302, F1 0.4228886168910649, AUC 0.7874228395061729
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 12 idx: 0 First Loss : 3.036020278930664, Second Loss : 2.9595186710357666
epoch: 12 idx: 200 First Loss : 0.8356480846454886, Second Loss : 0.8586439166764789
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4305555555555556, precision 0.5074074074074074, recall 0.5047138047138047, F1 0.4091319701075799, AUC 0.7364478114478114
  Second-Tier acc 0.4375, precision 0.513888888888889, recall 0.51, F1 0.41118502094111853, AUC 0.7715656565656567
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5492831541218638, recall 0.495296884185773, F1 0.4203489666272837, AUC 0.7548378404859887
  Second-Tier acc 0.4489795918367347, precision 0.5272727272727272, recall 0.4678130511463845, F1 0.4043745727956254, AUC 0.7982804232804233
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 13 idx: 0 First Loss : 3.039761781692505, Second Loss : 2.966261863708496
epoch: 13 idx: 200 First Loss : 0.8279159541035637, Second Loss : 0.8535901433348063
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4305555555555556, precision 0.5211008865068932, recall 0.5103703703703704, F1 0.40775146960713976, AUC 0.7267003367003366
  Second-Tier acc 0.4166666666666667, precision 0.4895833333333333, recall 0.4822222222222223, F1 0.37862344373972284, AUC 0.742929292929293
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.551822573561704, recall 0.503233392122281, F1 0.42501679983661994, AUC 0.7555665784832453
  Second-Tier acc 0.42857142857142855, precision 0.5229716520039102, recall 0.45546737213403876, F1 0.3852081183350533, AUC 0.7977843915343915
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 14 idx: 0 First Loss : 3.019308090209961, Second Loss : 2.940638542175293
epoch: 14 idx: 200 First Loss : 0.8216430502538268, Second Loss : 0.8489484506953433
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.4989249217319393, recall 0.4817508417508418, F1 0.38190694376261386, AUC 0.7169696969696969
  Second-Tier acc 0.4166666666666667, precision 0.498015873015873, recall 0.4822222222222223, F1 0.37825624667729935, AUC 0.7269696969696969
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4557823129251701, precision 0.5514184397163121, recall 0.4991181657848324, F1 0.41876750700280113, AUC 0.7533558690966098
  Second-Tier acc 0.42857142857142855, precision 0.5229716520039102, recall 0.45546737213403876, F1 0.3852081183350533, AUC 0.7994378306878307
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 15 idx: 0 First Loss : 3.003586530685425, Second Loss : 2.9113900661468506
epoch: 15 idx: 200 First Loss : 0.816517421636332, Second Loss : 0.8446039971559591
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.4896825396825397, recall 0.47286195286195287, F1 0.3680062559499524, AUC 0.7187934904601572
  Second-Tier acc 0.4166666666666667, precision 0.5106209150326797, recall 0.4822222222222223, F1 0.3784511784511784, AUC 0.7137373737373739
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5499999999999999, recall 0.4950029394473839, F1 0.41216613840737565, AUC 0.7518065353713501
  Second-Tier acc 0.4489795918367347, precision 0.5387205387205388, recall 0.47927689594356265, F1 0.4000834376303713, AUC 0.7960758377425045
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 16 idx: 0 First Loss : 2.9832675457000732, Second Loss : 2.885946750640869
epoch: 16 idx: 200 First Loss : 0.8126466947396874, Second Loss : 0.8409958484904627
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.487568058076225, recall 0.47286195286195287, F1 0.3680161943319838, AUC 0.7162289562289562
  Second-Tier acc 0.3958333333333333, precision 0.48879551820728295, recall 0.4688888888888889, F1 0.3581384015594542, AUC 0.7064141414141414
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.43537414965986393, precision 0.5460858585858586, recall 0.48677248677248675, F1 0.39835425190116264, AUC 0.7438210366451109
  Second-Tier acc 0.46938775510204084, precision 0.56875, recall 0.5209435626102293, F1 0.43677181017334465, AUC 0.786981922398589
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 17 idx: 0 First Loss : 2.962285041809082, Second Loss : 2.8590190410614014
epoch: 17 idx: 200 First Loss : 0.8092091580203026, Second Loss : 0.8387526300995245
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3958333333333333, precision 0.487568058076225, recall 0.47286195286195287, F1 0.3680161943319838, AUC 0.7159820426487092
  Second-Tier acc 0.375, precision 0.4777777777777777, recall 0.45555555555555555, F1 0.3371226101719938, AUC 0.6997979797979799
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.5346245964802666, recall 0.4687683715461493, F1 0.379771800175327, AUC 0.7359457671957671
  Second-Tier acc 0.46938775510204084, precision 0.56875, recall 0.5209435626102293, F1 0.43677181017334465, AUC 0.7799272486772487
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 18 idx: 0 First Loss : 2.942673444747925, Second Loss : 2.8513095378875732
epoch: 18 idx: 200 First Loss : 0.8072897647345318, Second Loss : 0.83555223227511
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3819444444444444, precision 0.47607998490850784, recall 0.4639730639730639, F1 0.353795538436848, AUC 0.7091806958473624
  Second-Tier acc 0.3541666666666667, precision 0.45476190476190476, recall 0.44222222222222224, F1 0.314975845410628, AUC 0.6891919191919191
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4217687074829932, precision 0.5346245964802666, recall 0.4687683715461493, F1 0.379771800175327, AUC 0.72563320595728
  Second-Tier acc 0.46938775510204084, precision 0.56875, recall 0.5209435626102293, F1 0.43677181017334465, AUC 0.775242504409171
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7
 current learn rate 5.769482147782159e-05
epoch: 19 idx: 0 First Loss : 2.924767255783081, Second Loss : 2.822542667388916
epoch: 19 idx: 200 First Loss : 0.8042308153666843, Second Loss : 0.8330460020314336
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.45633232016210745, recall 0.45063973063973056, F1 0.3319852624055796, AUC 0.7070426487093154
  Second-Tier acc 0.375, precision 0.4777777777777777, recall 0.45555555555555555, F1 0.3371226101719938, AUC 0.6834848484848486
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5346245964802666, recall 0.4687683715461493, F1 0.379771800175327, AUC 0.7180396335488929
  Second-Tier acc 0.4489795918367347, precision 0.5646464646464647, recall 0.5085978835978836, F1 0.4167203954437997, AUC 0.7558972663139331
 
 test auc: 0.7648809523809524, test F1: 0.44102564102564107  :  from epoch 7{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.26917608934383147, "droprate_2": 0.0, "lr": 5.860934861447162e-05, "weight_decay": 0.0004199144723954781, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.3718442533434795, "droprate_2": 0.0, "lr": 1.1173927821789858e-05, "weight_decay": 1.5610708037846206e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.1173927821789858e-05
epoch: 0 idx: 0 First Loss : 1.2367039918899536, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0573769348177744, Second Loss : 1.0387761113952048
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.669882154882155
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7464141414141414
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6095923966294338
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6080246913580246
 
 test auc: 0.6080246913580246, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.1173927821789858e-05
epoch: 1 idx: 0 First Loss : 2.0002949237823486, Second Loss : 1.9447509050369263
epoch: 1 idx: 200 First Loss : 1.1061428860941929, Second Loss : 1.0929111493612402
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7103086419753087
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7551515151515152
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6533534195571232
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6596671075837742
 
 test auc: 0.6596671075837742, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.1173927821789858e-05
epoch: 2 idx: 0 First Loss : 2.1227753162384033, Second Loss : 2.0883429050445557
epoch: 2 idx: 200 First Loss : 1.1010613468897283, Second Loss : 1.087488244051364
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7274859708193042
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7637878787878788
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6849953458749755
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6931768077601411
 
 test auc: 0.6931768077601411, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.1173927821789858e-05
epoch: 3 idx: 0 First Loss : 2.179090738296509, Second Loss : 2.152520179748535
epoch: 3 idx: 200 First Loss : 1.0893021144380617, Second Loss : 1.0762076520208101
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7370987654320987
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.766969696969697
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002559768763472
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7040343915343915
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 4 idx: 0 First Loss : 2.258396863937378, Second Loss : 2.220595598220825
epoch: 4 idx: 200 First Loss : 1.0783785531176857, Second Loss : 1.0646883765263344
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7411840628507296
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7581313131313131
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7088048696844993
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7111441798941799
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 5 idx: 0 First Loss : 2.3397083282470703, Second Loss : 2.295503616333008
epoch: 5 idx: 200 First Loss : 1.0667118899042334, Second Loss : 1.0530923399610899
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7408922558922558
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7494444444444444
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7126445228297079
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.712907848324515
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 6 idx: 0 First Loss : 2.4299323558807373, Second Loss : 2.3771791458129883
epoch: 6 idx: 200 First Loss : 1.0520045429987102, Second Loss : 1.0400436140263258
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5694444444444444, precision 0.4357506361323155, recall 0.41535353535353536, F1 0.36957928802588996, AUC 0.7366666666666667
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7497979797979797
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7098336762688615
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.714891975308642
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 7 idx: 0 First Loss : 2.52828049659729, Second Loss : 2.46687650680542
epoch: 7 idx: 200 First Loss : 1.0354302430627358, Second Loss : 1.0250297257704521
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6180555555555556, precision 0.5716374269005847, recall 0.4891919191919192, F1 0.4653299916457811, AUC 0.7378956228956229
  Second-Tier acc 0.6875, precision 0.4593406593406593, recall 0.5927272727272728, F1 0.5166666666666667, AUC 0.7552525252525252
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.673469387755102, precision 0.7642086910379593, recall 0.5552616108171664, F1 0.5750150816743492, AUC 0.7020625122476974
  Second-Tier acc 0.6122448979591837, precision 0.6859649122807018, recall 0.4455467372134039, F1 0.4415954415954417, AUC 0.7080577601410933
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 8 idx: 0 First Loss : 2.6305177211761475, Second Loss : 2.563674211502075
epoch: 8 idx: 200 First Loss : 1.0169311770752294, Second Loss : 1.008255103630806
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6875, precision 0.6472403437920679, recall 0.6222222222222221, F1 0.6198706643151087, AUC 0.7346408529741862
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7574242424242424
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5986394557823129, precision 0.5598290598290598, recall 0.5813492063492064, F1 0.567978880347853, AUC 0.7032015481089555
  Second-Tier acc 0.5918367346938775, precision 0.5361111111111111, recall 0.531305114638448, F1 0.5208647561588738, AUC 0.7115299823633157
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 9 idx: 0 First Loss : 2.7592756748199463, Second Loss : 2.685549259185791
epoch: 9 idx: 200 First Loss : 1.0004310528585567, Second Loss : 0.9931139059513066
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6111111111111112, precision 0.5738038277511962, recall 0.5844107744107744, F1 0.5768155029467587, AUC 0.7293265993265994
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7554545454545454
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5578231292517006, precision 0.5194259669869425, recall 0.5528365667254557, F1 0.5224098394830102, AUC 0.7067288849696257
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.7286706349206349
 
 test auc: 0.7040343915343915, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.1173927821789858e-05
epoch: 10 idx: 0 First Loss : 2.888714075088501, Second Loss : 2.813058376312256
epoch: 10 idx: 200 First Loss : 0.9853450113638716, Second Loss : 0.9795998358607885
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5347222222222222, precision 0.5219957352310294, recall 0.5264983164983165, F1 0.5074074074074074, AUC 0.7289618406285072
  Second-Tier acc 0.5416666666666666, precision 0.5790123456790123, recall 0.5596969696969697, F1 0.5032163742690058, AUC 0.7714646464646465
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5034013605442177, precision 0.48846501285525673, recall 0.5339506172839507, F1 0.4777519434462998, AUC 0.7095519792279052
  Second-Tier acc 0.6530612244897959, precision 0.6565656565656566, recall 0.7149470899470899, F1 0.6639146886824906, AUC 0.7397486772486772
 
 test auc: 0.7397486772486772, test F1: 0.6639146886824906  :  from epoch 10
 current learn rate 1.1173927821789858e-05
epoch: 11 idx: 0 First Loss : 3.009526014328003, Second Loss : 2.934654474258423
epoch: 11 idx: 200 First Loss : 0.9730107931892819, Second Loss : 0.9686377660199925
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4791666666666667, precision 0.5002477393781741, recall 0.4884175084175084, F1 0.45468017870763866, AUC 0.7299382716049383
  Second-Tier acc 0.5416666666666666, precision 0.603030303030303, recall 0.603030303030303, F1 0.5370370370370371, AUC 0.7863131313131313
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.4783274522819643, recall 0.5149176954732511, F1 0.44362230139155323, AUC 0.7172986478542033
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7598104056437389
 
 test auc: 0.7598104056437389, test F1: 0.5841269841269842  :  from epoch 11
 current learn rate 1.1173927821789858e-05
epoch: 12 idx: 0 First Loss : 3.1171696186065674, Second Loss : 3.0474963188171387
epoch: 12 idx: 200 First Loss : 0.962713763052922, Second Loss : 0.95962139206072
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4375, precision 0.4760606060606061, recall 0.46090909090909093, F1 0.41578535056795934, AUC 0.7331818181818183
  Second-Tier acc 0.5208333333333334, precision 0.5871794871794872, recall 0.5896969696969697, F1 0.5166137566137566, AUC 0.7905555555555556
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.4594154468296345, recall 0.4866990005878895, F1 0.41017242842800655, AUC 0.7244451793062904
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7615189594356262
 
 test auc: 0.7615189594356262, test F1: 0.5454545454545454  :  from epoch 12
 current learn rate 1.1173927821789858e-05
epoch: 13 idx: 0 First Loss : 3.21246337890625, Second Loss : 3.148989200592041
epoch: 13 idx: 200 First Loss : 0.9544273973048771, Second Loss : 0.9528515751645044
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4583333333333333, precision 0.5171134068593234, recall 0.5008417508417509, F1 0.443986568986569, AUC 0.7415488215488216
  Second-Tier acc 0.5208333333333334, precision 0.5870571658615137, recall 0.6041414141414142, F1 0.5196078431372549, AUC 0.8005555555555556
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.4843101343101343, recall 0.5102145796590242, F1 0.430935494765282, AUC 0.7275989613952577
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.771274250440917
 
 test auc: 0.771274250440917, test F1: 0.5454545454545454  :  from epoch 13
 current learn rate 1.1173927821789858e-05
epoch: 14 idx: 0 First Loss : 3.2934608459472656, Second Loss : 3.240037679672241
epoch: 14 idx: 200 First Loss : 0.9477619094987265, Second Loss : 0.9476460408169165
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.49703834115805945, recall 0.4746464646464646, F1 0.41522018383908305, AUC 0.7452581369248036
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8138383838383838
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5032386263480922, recall 0.5178571428571428, F1 0.43344523376360855, AUC 0.7315059768763472
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7756283068783069
 
 test auc: 0.7756283068783069, test F1: 0.53203007518797  :  from epoch 14
 current learn rate 1.1173927821789858e-05
epoch: 15 idx: 0 First Loss : 3.3626086711883545, Second Loss : 3.3193564414978027
epoch: 15 idx: 200 First Loss : 0.9427272859654987, Second Loss : 0.9432012842532562
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.5136047172492185, recall 0.48474747474747476, F1 0.4239538239538239, AUC 0.7468069584736251
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8160101010101011
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5335351089588377, recall 0.5375514403292181, F1 0.4488867504556813, AUC 0.733765677052714
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7781084656084657
 
 test auc: 0.7781084656084657, test F1: 0.512048312048312  :  from epoch 15
 current learn rate 1.1173927821789858e-05
epoch: 16 idx: 0 First Loss : 3.4207489490509033, Second Loss : 3.3841867446899414
epoch: 16 idx: 200 First Loss : 0.9383104223322438, Second Loss : 0.9393318670787918
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4236111111111111, precision 0.5187499999999999, recall 0.4981144781144781, F1 0.42166383701188453, AUC 0.7512008978675645
  Second-Tier acc 0.4791666666666667, precision 0.5618580765639588, recall 0.5774747474747475, F1 0.47639573070607555, AUC 0.8205050505050505
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5517167698202181, recall 0.5490152851263962, F1 0.450036001027567, AUC 0.7380768665490888
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7747464726631392
 
 test auc: 0.7747464726631392, test F1: 0.512048312048312  :  from epoch 16
 current learn rate 1.1173927821789858e-05
epoch: 17 idx: 0 First Loss : 3.4689905643463135, Second Loss : 3.437191963195801
epoch: 17 idx: 200 First Loss : 0.9342355681421115, Second Loss : 0.9359947351196697
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4166666666666667, precision 0.5176767676767677, recall 0.5001683501683502, F1 0.4158181275116759, AUC 0.7538103254769922
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.818939393939394
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5544848374132262, recall 0.5528365667254556, F1 0.45087412587412584, AUC 0.7424860376249266
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7813051146384479
 
 test auc: 0.7747464726631392, test F1: 0.512048312048312  :  from epoch 16
 current learn rate 1.1173927821789858e-05
epoch: 18 idx: 0 First Loss : 3.5020601749420166, Second Loss : 3.478100299835205
epoch: 18 idx: 200 First Loss : 0.9301882926050332, Second Loss : 0.932681745003946
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.5365871169696447, recall 0.5321548821548822, F1 0.43704423031770245, AUC 0.7558810325476992
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.815
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4557823129251701, precision 0.5761403508771931, recall 0.5586419753086419, F1 0.45760915451842665, AUC 0.7451621595140114
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7856040564373897
 
 test auc: 0.7747464726631392, test F1: 0.512048312048312  :  from epoch 16
 current learn rate 1.1173927821789858e-05
epoch: 19 idx: 0 First Loss : 3.5249264240264893, Second Loss : 3.5084028244018555
epoch: 19 idx: 200 First Loss : 0.926151008275685, Second Loss : 0.9293866713892724
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5427060064532142, recall 0.5495959595959596, F1 0.4407349896480331, AUC 0.759023569023569
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8139393939393939
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4557823129251701, precision 0.5779711673699016, recall 0.5565108759553204, F1 0.45470986492588655, AUC 0.7462093376445228
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7890211640211641
 
 test auc: 0.7747464726631392, test F1: 0.512048312048312  :  from epoch 16{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 30, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.2530367798048426, "droprate_2": 0.0, "lr": 0.00021375943754717433, "weight_decay": 5.7633463672476094e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00021375943754717433
epoch: 0 idx: 0 First Loss : 1.2447155714035034, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0844606939351085, Second Loss : 1.0785282468840258
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7387317620650954
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7593939393939394
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7182417205565353
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7226631393298061
Test AUC: 0.7227, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021375943754717433
epoch: 1 idx: 0 First Loss : 1.5550541877746582, Second Loss : 1.6296013593673706
epoch: 1 idx: 200 First Loss : 0.9841899716142398, Second Loss : 0.9836875910486155
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7356341189674523
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7427272727272727
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.739914021164021
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7406305114638448
Test AUC: 0.7227, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021375943754717433
epoch: 2 idx: 0 First Loss : 1.9102001190185547, Second Loss : 1.96437668800354
epoch: 2 idx: 200 First Loss : 0.9517629563956711, Second Loss : 0.9537859097938632
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7294781144781144
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.737929292929293
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.70914780521262
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7077270723104055
Test AUC: 0.7227, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021375943754717433
epoch: 3 idx: 0 First Loss : 2.9666616916656494, Second Loss : 3.4112610816955566
epoch: 3 idx: 200 First Loss : 0.933930147050032, Second Loss : 0.9454530575289507
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5, precision 0.5464646464646464, recall 0.5024579124579125, F1 0.4418586249340602, AUC 0.7284006734006733
  Second-Tier acc 0.4583333333333333, precision 0.5745519713261649, recall 0.48939393939393944, F1 0.4406843818608525, AUC 0.7575252525252526
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5578231292517006, precision 0.5793609219486643, recall 0.5629776601998824, F1 0.5290828646419198, AUC 0.6806841563786009
  Second-Tier acc 0.4897959183673469, precision 0.5404761904761904, recall 0.4874338624338625, F1 0.4761904761904762, AUC 0.6865630511463845
Test AUC: 0.7227, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021375943754717433
epoch: 4 idx: 0 First Loss : 3.529919385910034, Second Loss : 3.701974391937256
epoch: 4 idx: 200 First Loss : 0.920975280253782, Second Loss : 0.9379515939818427
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3888888888888889, precision 0.4356673094990852, recall 0.4395286195286196, F1 0.3244054040170545, AUC 0.720050505050505
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7371212121212122
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.42857142857142855, precision 0.4813868413868414, recall 0.42401528512639625, F1 0.34832666819348285, AUC 0.6936728395061729
  Second-Tier acc 0.46938775510204084, precision 0.4170653907496013, recall 0.4329805996472664, F1 0.3421052631578947, AUC 0.7261904761904763
Test AUC: 0.7227, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021375943754717433
epoch: 5 idx: 0 First Loss : 3.3844826221466064, Second Loss : 3.9462227821350098
epoch: 5 idx: 200 First Loss : 0.9207660351921596, Second Loss : 0.9309177021160073
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7117732884399551
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7745959595959594
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.41496598639455784, precision 0.4435695538057743, recall 0.4115226337448559, F1 0.29234714003944773, AUC 0.6442350088183422
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6998456790123457
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 6 idx: 0 First Loss : 3.4402172565460205, Second Loss : 3.78764271736145
epoch: 6 idx: 200 First Loss : 0.9144530744495714, Second Loss : 0.9223543159143573
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3333333333333333, precision 0.36577777777777776, recall 0.39999999999999997, F1 0.246767388049544, AUC 0.6748933782267116
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7245454545454546
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.4427083333333333, recall 0.40740740740740744, F1 0.2859180035650624, AUC 0.6243141289437586
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6538249559082893
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 7 idx: 0 First Loss : 3.375575065612793, Second Loss : 3.7668237686157227
epoch: 7 idx: 200 First Loss : 0.9041069725468125, Second Loss : 0.9131033302525716
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3055555555555556, precision 0.34920634920634924, recall 0.38222222222222224, F1 0.22076178361953222, AUC 0.651010101010101
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6797979797979798
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3877551020408163, precision 0.44186046511627913, recall 0.3950617283950617, F1 0.2679093567251462, AUC 0.6386194395453655
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6448412698412699
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 8 idx: 0 First Loss : 3.482154607772827, Second Loss : 3.8717856407165527
epoch: 8 idx: 200 First Loss : 0.8994315986701668, Second Loss : 0.910476065888614
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2986111111111111, precision 0.34657419083648594, recall 0.37777777777777777, F1 0.2176930596285435, AUC 0.6438832772166106
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6727272727272727
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.441025641025641, recall 0.38271604938271603, F1 0.24881220305076268, AUC 0.6597344699196551
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6665013227513228
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 9 idx: 0 First Loss : 3.4697256088256836, Second Loss : 3.79081654548645
epoch: 9 idx: 200 First Loss : 0.8936907579751386, Second Loss : 0.9083618833343162
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2847222222222222, precision 0.3318551367331855, recall 0.3688888888888889, F1 0.20304114490161, AUC 0.643956228956229
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6760606060606061
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6585831863609641
  Second-Tier acc 0.3877551020408163, precision 0.44186046511627913, recall 0.3950617283950617, F1 0.2679093567251462, AUC 0.6742724867724869
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 10 idx: 0 First Loss : 3.4311561584472656, Second Loss : 3.7414870262145996
epoch: 10 idx: 200 First Loss : 0.8909509873798983, Second Loss : 0.9018781538516982
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6515039281705949
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.6833838383838384
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.441025641025641, recall 0.40329218106995884, F1 0.27843695617781994, AUC 0.6695265040172448
  Second-Tier acc 0.46938775510204084, precision 0.5296296296296296, recall 0.4737654320987654, F1 0.39032967032967036, AUC 0.6855709876543209
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 11 idx: 0 First Loss : 4.003270626068115, Second Loss : 4.016242027282715
epoch: 11 idx: 200 First Loss : 0.8847822333240157, Second Loss : 0.8987612530394499
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2916666666666667, precision 0.3346153846153846, recall 0.37333333333333335, F1 0.20393484239475354, AUC 0.6505050505050506
  Second-Tier acc 0.2708333333333333, precision 0.30952380952380953, recall 0.36000000000000004, F1 0.18598382749326148, AUC 0.6696969696969696
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3673469387755102, precision 0.4385964912280702, recall 0.38271604938271603, F1 0.24602150537634407, AUC 0.6686630413482266
  Second-Tier acc 0.3673469387755102, precision 0.4444444444444444, recall 0.38271604938271603, F1 0.25268817204301075, AUC 0.6853505291005292
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 12 idx: 0 First Loss : 3.3737704753875732, Second Loss : 3.6502792835235596
epoch: 12 idx: 200 First Loss : 0.8740311925764186, Second Loss : 0.8891394859861406
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3125, precision 0.35260416666666666, recall 0.38666666666666666, F1 0.22553485162180817, AUC 0.6515039281705948
  Second-Tier acc 0.2708333333333333, precision 0.30952380952380953, recall 0.36000000000000004, F1 0.18598382749326148, AUC 0.667878787878788
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3877551020408163, precision 0.44020356234096686, recall 0.3950617283950617, F1 0.2660163776493256, AUC 0.6679587987458357
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6900903880070547
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 13 idx: 0 First Loss : 3.4028937816619873, Second Loss : 3.669243812561035
epoch: 13 idx: 200 First Loss : 0.8661729535306584, Second Loss : 0.8829595213891349
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2986111111111111, precision 0.34657419083648594, recall 0.37777777777777777, F1 0.2176930596285435, AUC 0.6438327721661055
  Second-Tier acc 0.2708333333333333, precision 0.3116531165311653, recall 0.36000000000000004, F1 0.18864468864468864, AUC 0.6633838383838384
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.49477351916376305, recall 0.40226337448559674, F1 0.27804476225528857, AUC 0.6633842837546542
  Second-Tier acc 0.3673469387755102, precision 0.49780701754385964, recall 0.41203703703703703, F1 0.28782051282051285, AUC 0.6825396825396824
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 14 idx: 0 First Loss : 3.5359859466552734, Second Loss : 3.9698569774627686
epoch: 14 idx: 200 First Loss : 0.8625942780409104, Second Loss : 0.8966934226165262
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2916666666666667, precision 0.33661417322834647, recall 0.37333333333333335, F1 0.2064655172413793, AUC 0.6395622895622896
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6713636363636364
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3401360544217687, precision 0.4721634954193094, recall 0.37602880658436216, F1 0.2358206121364016, AUC 0.6669116206153243
  Second-Tier acc 0.3673469387755102, precision 0.5006105006105006, recall 0.41203703703703703, F1 0.28721174004192873, AUC 0.6906966490299823
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 15 idx: 0 First Loss : 3.5813887119293213, Second Loss : 3.9773683547973633
epoch: 15 idx: 200 First Loss : 0.8722718245997167, Second Loss : 0.8962144359934314
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.34990476190476194, recall 0.38222222222222224, F1 0.22163751007443225, AUC 0.6455892255892256
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.667979797979798
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3401360544217687, precision 0.46921057944679995, recall 0.37602880658436216, F1 0.2367287944211021, AUC 0.6657235939643348
  Second-Tier acc 0.32653061224489793, precision 0.44186046511627913, recall 0.35802469135802467, F1 0.20971970155273242, AUC 0.7029320987654321
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 16 idx: 0 First Loss : 3.5719945430755615, Second Loss : 4.085433483123779
epoch: 16 idx: 200 First Loss : 0.847813924885332, Second Loss : 0.8888969689507839
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2916666666666667, precision 0.35645933014354064, recall 0.3781481481481481, F1 0.22379657994275934, AUC 0.6539001122334457
  Second-Tier acc 0.2916666666666667, precision 0.34909909909909914, recall 0.37333333333333335, F1 0.2217432950191571, AUC 0.6640909090909092
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.5044827586206896, recall 0.40564373897707234, F1 0.2733945607924531, AUC 0.6744317068391142
  Second-Tier acc 0.30612244897959184, precision 0.48075348075348073, recall 0.36353615520282184, F1 0.22883188363064522, AUC 0.7107032627865961
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 17 idx: 0 First Loss : 3.568782091140747, Second Loss : 4.1059370040893555
epoch: 17 idx: 200 First Loss : 0.8560088321991863, Second Loss : 0.8829969082361508
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2847222222222222, precision 0.32639370807309737, recall 0.3688888888888889, F1 0.19616184533938363, AUC 0.6598428731762065
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6629797979797979
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.32653061224489793, precision 0.43781094527363185, recall 0.35802469135802467, F1 0.205067920585162, AUC 0.6606652949245542
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.7006723985890652
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 18 idx: 0 First Loss : 3.6040194034576416, Second Loss : 4.063719749450684
epoch: 18 idx: 200 First Loss : 0.849656245635256, Second Loss : 0.8818303623151884
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2847222222222222, precision 0.32575757575757575, recall 0.3688888888888889, F1 0.19534883720930232, AUC 0.6658417508417509
  Second-Tier acc 0.2916666666666667, precision 0.34649122807017546, recall 0.37333333333333335, F1 0.21862538118695754, AUC 0.6636868686868688
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.32653061224489793, precision 0.43478260869565216, recall 0.35802469135802467, F1 0.2015325670498084, AUC 0.6545965608465608
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.7056327160493826
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 19 idx: 0 First Loss : 3.612713575363159, Second Loss : 4.150413513183594
epoch: 19 idx: 200 First Loss : 0.8465453133981292, Second Loss : 0.8768560618011568
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2847222222222222, precision 0.32575757575757575, recall 0.3688888888888889, F1 0.19534883720930232, AUC 0.6814927048260383
  Second-Tier acc 0.2708333333333333, precision 0.30952380952380953, recall 0.36000000000000004, F1 0.18598382749326148, AUC 0.6695454545454546
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3197278911564626, precision 0.43552311435523117, recall 0.35390946502057613, F1 0.19518427092806723, AUC 0.6516203703703703
  Second-Tier acc 0.32653061224489793, precision 0.49477351916376305, recall 0.3873456790123457, F1 0.2379509379509379, AUC 0.7046406525573192
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 20 idx: 0 First Loss : 3.6512463092803955, Second Loss : 4.2598652839660645
epoch: 20 idx: 200 First Loss : 0.8425390506442971, Second Loss : 0.8711001749932805
>>>>>>>>>>> Validation Epoch: 20
  First-Tier acc 0.2777777777777778, precision 0.31666666666666665, recall 0.3644444444444444, F1 0.18823529411764706, AUC 0.6789337822671156
  Second-Tier acc 0.2708333333333333, precision 0.3055555555555555, recall 0.36000000000000004, F1 0.18095238095238098, AUC 0.6918181818181818
>>>>>>>>>>> Test Epoch: 20
  First-Tier acc 0.30612244897959184, precision 0.43333333333333335, recall 0.345679012345679, F1 0.17765567765567766, AUC 0.6464885851459926
  Second-Tier acc 0.30612244897959184, precision 0.43703703703703706, recall 0.345679012345679, F1 0.18200161420500405, AUC 0.6899801587301587
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 21 idx: 0 First Loss : 3.68381667137146, Second Loss : 4.425695896148682
epoch: 21 idx: 200 First Loss : 0.8430948501774547, Second Loss : 0.8697706247161886
>>>>>>>>>>> Validation Epoch: 21
  First-Tier acc 0.2847222222222222, precision 0.32575757575757575, recall 0.3688888888888889, F1 0.19534883720930232, AUC 0.6807856341189674
  Second-Tier acc 0.2916666666666667, precision 0.3717948717948718, recall 0.3877777777777778, F1 0.2313227513227513, AUC 0.6876767676767677
>>>>>>>>>>> Test Epoch: 21
  First-Tier acc 0.3129251700680272, precision 0.43333333333333335, recall 0.3497942386831276, F1 0.1852187028657617, AUC 0.6806229178914364
  Second-Tier acc 0.32653061224489793, precision 0.5084249084249084, recall 0.4052028218694885, F1 0.264172335600907, AUC 0.7136243386243386
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 22 idx: 0 First Loss : 3.8873651027679443, Second Loss : 4.613615036010742
epoch: 22 idx: 200 First Loss : 0.8491121173369918, Second Loss : 0.875839985799901
>>>>>>>>>>> Validation Epoch: 22
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6792985409652076
  Second-Tier acc 0.3333333333333333, precision 0.4222222222222222, recall 0.44080808080808076, F1 0.3161375661375661, AUC 0.6793434343434344
>>>>>>>>>>> Test Epoch: 22
  First-Tier acc 0.3197278911564626, precision 0.431924882629108, recall 0.35390946502057613, F1 0.19093360296595888, AUC 0.6929930922986479
  Second-Tier acc 0.3469387755102041, precision 0.552463768115942, recall 0.4825837742504409, F1 0.31937059356414194, AUC 0.6982473544973544
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 23 idx: 0 First Loss : 4.09600830078125, Second Loss : 4.8327131271362305
epoch: 23 idx: 200 First Loss : 0.8678834826592745, Second Loss : 0.8940428357147931
>>>>>>>>>>> Validation Epoch: 23
  First-Tier acc 0.2777777777777778, precision 0.4789149490642028, recall 0.36925925925925923, F1 0.19761103184500295, AUC 0.6774130190796858
  Second-Tier acc 0.3541666666666667, precision 0.45704003598740445, recall 0.46606060606060606, F1 0.3528822055137845, AUC 0.6857575757575757
>>>>>>>>>>> Test Epoch: 23
  First-Tier acc 0.32653061224489793, precision 0.49183006535947715, recall 0.3677983539094651, F1 0.2182852829312197, AUC 0.6951119439545366
  Second-Tier acc 0.30612244897959184, precision 0.5407407407407407, recall 0.470679012345679, F1 0.2924498746867168, AUC 0.7101521164021164
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 24 idx: 0 First Loss : 4.07650899887085, Second Loss : 4.964141845703125
epoch: 24 idx: 200 First Loss : 0.8514885190734724, Second Loss : 0.8769304075907173
>>>>>>>>>>> Validation Epoch: 24
  First-Tier acc 0.2708333333333333, precision 0.36719576719576713, recall 0.36000000000000004, F1 0.179732868757259, AUC 0.6796464646464647
  Second-Tier acc 0.3125, precision 0.43090569561157793, recall 0.40545454545454546, F1 0.3142857142857143, AUC 0.6965656565656566
>>>>>>>>>>> Test Epoch: 24
  First-Tier acc 0.3129251700680272, precision 0.43333333333333335, recall 0.3497942386831276, F1 0.1852187028657617, AUC 0.7119708994708995
  Second-Tier acc 0.32653061224489793, precision 0.5547619047619047, recall 0.47663139329806, F1 0.31139122315592904, AUC 0.7124118165784833
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 25 idx: 0 First Loss : 4.051999092102051, Second Loss : 5.004281997680664
epoch: 25 idx: 200 First Loss : 0.8640218358215487, Second Loss : 0.9079258765418753
>>>>>>>>>>> Validation Epoch: 25
  First-Tier acc 0.2777777777777778, precision 0.4200542005420054, recall 0.3684175084175085, F1 0.21219929122368145, AUC 0.6767087542087542
  Second-Tier acc 0.3125, precision 0.4219523166891588, recall 0.40545454545454546, F1 0.30843776106934, AUC 0.686919191919192
>>>>>>>>>>> Test Epoch: 25
  First-Tier acc 0.3333333333333333, precision 0.5369981325863679, recall 0.41527042915931806, F1 0.2859446677221613, AUC 0.7103848226533412
  Second-Tier acc 0.3469387755102041, precision 0.5661375661375662, recall 0.5004409171075838, F1 0.32857142857142857, AUC 0.7198522927689593
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 26 idx: 0 First Loss : 4.291092395782471, Second Loss : 5.3351149559021
epoch: 26 idx: 200 First Loss : 0.8532547480448861, Second Loss : 0.8682379217436795
>>>>>>>>>>> Validation Epoch: 26
  First-Tier acc 0.2847222222222222, precision 0.485484544695071, recall 0.37370370370370365, F1 0.20584903717433836, AUC 0.6864253647586981
  Second-Tier acc 0.3333333333333333, precision 0.44851532567049807, recall 0.43323232323232325, F1 0.3342796920032693, AUC 0.6853535353535354
>>>>>>>>>>> Test Epoch: 26
  First-Tier acc 0.3197278911564626, precision 0.4787037037037037, recall 0.3636831275720165, F1 0.2103979727484214, AUC 0.6835746129727611
  Second-Tier acc 0.2653061224489796, precision 0.5282051282051282, recall 0.4230599647266314, F1 0.2557934457159263, AUC 0.6970899470899471
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 27 idx: 0 First Loss : 4.368938446044922, Second Loss : 5.337441921234131
epoch: 27 idx: 200 First Loss : 0.8485927367699668, Second Loss : 0.8704505718500896
>>>>>>>>>>> Validation Epoch: 27
  First-Tier acc 0.3402777777777778, precision 0.5005522213886805, recall 0.44356902356902356, F1 0.3225165076621535, AUC 0.6894107744107744
  Second-Tier acc 0.3333333333333333, precision 0.5510480054090602, recall 0.43323232323232325, F1 0.3298705209274315, AUC 0.6813636363636363
>>>>>>>>>>> Test Epoch: 27
  First-Tier acc 0.3333333333333333, precision 0.5338827838827839, recall 0.45098471487360375, F1 0.30580863924517176, AUC 0.6933360278267685
  Second-Tier acc 0.32653061224489793, precision 0.5729166666666666, recall 0.4944885361552028, F1 0.31825396825396823, AUC 0.7114748677248678
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 28 idx: 0 First Loss : 4.462827205657959, Second Loss : 5.47745943069458
epoch: 28 idx: 200 First Loss : 0.8667971856807739, Second Loss : 0.857739298126877
>>>>>>>>>>> Validation Epoch: 28
  First-Tier acc 0.3333333333333333, precision 0.4811366678836558, recall 0.4439393939393939, F1 0.3119619134944805, AUC 0.6758361391694724
  Second-Tier acc 0.3333333333333333, precision 0.5462962962962963, recall 0.43323232323232325, F1 0.32696892294593444, AUC 0.6753535353535355
>>>>>>>>>>> Test Epoch: 28
  First-Tier acc 0.3197278911564626, precision 0.5335397316821465, recall 0.44488536155202824, F1 0.29475032459557143, AUC 0.6982902214383696
  Second-Tier acc 0.3469387755102041, precision 0.5666666666666667, recall 0.5182980599647267, F1 0.3299097416744476, AUC 0.7018849206349206
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.00021375943754717433
epoch: 29 idx: 0 First Loss : 4.684741497039795, Second Loss : 5.739108562469482
epoch: 29 idx: 200 First Loss : 0.8377022030823901, Second Loss : 0.8330933760769931
>>>>>>>>>>> Validation Epoch: 29
  First-Tier acc 0.2916666666666667, precision 0.46391875746714456, recall 0.3765993265993266, F1 0.2796734321282125, AUC 0.6606004489337822
  Second-Tier acc 0.3333333333333333, precision 0.5429344151453686, recall 0.43070707070707065, F1 0.32232115971953373, AUC 0.6640151515151514
>>>>>>>>>>> Test Epoch: 29
  First-Tier acc 0.2789115646258503, precision 0.5407407407407407, recall 0.4368018812463257, F1 0.2691850084803433, AUC 0.7078373015873017
  Second-Tier acc 0.30612244897959184, precision 0.5520833333333334, recall 0.470679012345679, F1 0.29603174603174603, AUC 0.7194113756613755
Test AUC: 0.6998, Test F1: 0.3039 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.29109909117159183, "droprate_2": 0.0, "lr": 2.271067313505049e-05, "weight_decay": 0.00013228328998006987, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.271067313505049e-05
epoch: 0 idx: 0 First Loss : 1.2460275888442993, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1054343698333151, Second Loss : 1.0897941940014635
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7038215488215487
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7483838383838384
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6454720262590633
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6489748677248678
Test AUC: 0.6490, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.271067313505049e-05
epoch: 1 idx: 0 First Loss : 2.1607463359832764, Second Loss : 2.0838277339935303
epoch: 1 idx: 200 First Loss : 1.094413213024092, Second Loss : 1.085453775984731
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7321604938271605
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7619696969696971
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6931461885165588
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7040343915343915
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 2 idx: 0 First Loss : 2.284949541091919, Second Loss : 2.2005507946014404
epoch: 2 idx: 200 First Loss : 1.0642510811191292, Second Loss : 1.057287796219783
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7402132435465768
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7554545454545455
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7119280325298845
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7119157848324514
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 3 idx: 0 First Loss : 2.4699058532714844, Second Loss : 2.3319523334503174
epoch: 3 idx: 200 First Loss : 1.0384212845371137, Second Loss : 1.031982714597562
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.5283432287249081, recall 0.4044107744107744, F1 0.3640237324703344, AUC 0.736060606060606
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7504040404040403
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5850340136054422, precision 0.5234741784037559, recall 0.40277777777777773, F1 0.35709499510334525, AUC 0.709466245345875
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.711033950617284
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 4 idx: 0 First Loss : 2.662731409072876, Second Loss : 2.5250754356384277
epoch: 4 idx: 200 First Loss : 1.0071390442438979, Second Loss : 1.0028330176994575
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6736111111111112, precision 0.6545020093407191, recall 0.5825252525252526, F1 0.5977753420208664, AUC 0.7341638608305275
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7467676767676767
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5714285714285714, precision 0.5014430014430015, recall 0.5266754850088183, F1 0.49715965407869955, AUC 0.7019829022143836
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7033179012345679
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 5 idx: 0 First Loss : 2.9057140350341797, Second Loss : 2.7698311805725098
epoch: 5 idx: 200 First Loss : 0.9795927343639865, Second Loss : 0.9784879127693413
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5347222222222222, precision 0.5060224089635854, recall 0.507003367003367, F1 0.4786355561956887, AUC 0.7304601571268238
  Second-Tier acc 0.5833333333333334, precision 0.5395382395382397, recall 0.554949494949495, F1 0.5066263659614043, AUC 0.7439393939393938
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.44912280701754387, recall 0.4829512051734273, F1 0.43251466596620264, AUC 0.7025585439937291
  Second-Tier acc 0.6530612244897959, precision 0.6418128654970761, recall 0.7034832451499118, F1 0.6527173913043478, AUC 0.7180335097001764
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 6 idx: 0 First Loss : 3.165811538696289, Second Loss : 3.0228323936462402
epoch: 6 idx: 200 First Loss : 0.9583009975077352, Second Loss : 0.9599810448007204
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4722222222222222, precision 0.4879817444219067, recall 0.47494949494949495, F1 0.4205726405090138, AUC 0.736919191919192
  Second-Tier acc 0.5, precision 0.5569518716577541, recall 0.5398989898989899, F1 0.49664235982367244, AUC 0.7596969696969698
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.48799049634331954, recall 0.5327748383303939, F1 0.4347728766454472, AUC 0.7132630315500684
  Second-Tier acc 0.5510204081632653, precision 0.5625730994152046, recall 0.6302910052910052, F1 0.5549909028169898, AUC 0.7428902116402116
Test AUC: 0.7040, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.271067313505049e-05
epoch: 7 idx: 0 First Loss : 3.3756415843963623, Second Loss : 3.230729579925537
epoch: 7 idx: 200 First Loss : 0.9445490633596235, Second Loss : 0.9483674278770068
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4375, precision 0.48569739952718677, recall 0.4623569023569023, F1 0.39207501094293545, AUC 0.7455780022446689
  Second-Tier acc 0.5208333333333334, precision 0.5873015873015873, recall 0.5990909090909091, F1 0.5225889728932325, AUC 0.7798484848484848
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.41496598639455784, precision 0.4686229086229086, recall 0.4983098177542622, F1 0.4009078123002174, AUC 0.7235143543013912
  Second-Tier acc 0.46938775510204084, precision 0.49892831626577755, recall 0.5579805996472663, F1 0.4745454545454546, AUC 0.7606371252204586
Test AUC: 0.7606, Test F1: 0.4745 (Best Epoch: 7)
Current LR: 2.271067313505049e-05
epoch: 8 idx: 0 First Loss : 3.5404422283172607, Second Loss : 3.3895671367645264
epoch: 8 idx: 200 First Loss : 0.9364073422612317, Second Loss : 0.9412119980503003
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4097222222222222, precision 0.47161841742486904, recall 0.45023569023569027, F1 0.37317128717207554, AUC 0.7498821548821549
  Second-Tier acc 0.5208333333333334, precision 0.5913299663299664, recall 0.6135353535353536, F1 0.5214006187637019, AUC 0.7906565656565657
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.49608201645553085, recall 0.5021310993533216, F1 0.40392156862745104, AUC 0.7330859298451889
  Second-Tier acc 0.4897959183673469, precision 0.556140350877193, recall 0.5932539682539683, F1 0.49186441343304094, AUC 0.7654320987654321
Test AUC: 0.7654, Test F1: 0.4919 (Best Epoch: 8)
Current LR: 2.271067313505049e-05
epoch: 9 idx: 0 First Loss : 3.6564719676971436, Second Loss : 3.50313138961792
epoch: 9 idx: 200 First Loss : 0.9306560721067684, Second Loss : 0.9368126061675486
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.466017316017316, recall 0.4284848484848485, F1 0.3549177735610373, AUC 0.7524803591470258
  Second-Tier acc 0.5208333333333334, precision 0.5907477025898079, recall 0.6135353535353536, F1 0.5212121212121211, AUC 0.7928787878787878
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5233799533799534, recall 0.5094797178130511, F1 0.40447736795464123, AUC 0.7358171663727221
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7811948853615519
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 10 idx: 0 First Loss : 3.753493309020996, Second Loss : 3.5788049697875977
epoch: 10 idx: 200 First Loss : 0.9261117404308262, Second Loss : 0.9331801247444764
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.47577908533358243, recall 0.4454545454545455, F1 0.36331340685680047, AUC 0.7624747474747474
  Second-Tier acc 0.4583333333333333, precision 0.546031746031746, recall 0.5446464646464646, F1 0.4583333333333333, AUC 0.7882323232323233
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.5216007786762504, recall 0.5073486184597296, F1 0.4071739632769868, AUC 0.7401957182049775
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7853284832451499
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 11 idx: 0 First Loss : 3.809490203857422, Second Loss : 3.6305253505706787
epoch: 11 idx: 200 First Loss : 0.9212876994473239, Second Loss : 0.9298221713316567
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5043799337916984, recall 0.4915151515151515, F1 0.3989223535156401, AUC 0.7637991021324355
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7888383838383839
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5467896174863388, recall 0.5270429159318049, F1 0.42335981170932624, AUC 0.7460439937291788
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7864858906525573
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 12 idx: 0 First Loss : 3.8431155681610107, Second Loss : 3.6633288860321045
epoch: 12 idx: 200 First Loss : 0.9162173132836096, Second Loss : 0.9267728237912467
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4305555555555556, precision 0.526097670250896, recall 0.5195286195286196, F1 0.428228636106395, AUC 0.7643827160493827
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7824747474747475
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46258503401360546, precision 0.5813306349607893, recall 0.5844356261022928, F1 0.46495100748379375, AUC 0.7511206643151088
  Second-Tier acc 0.46938775510204084, precision 0.5708333333333333, recall 0.5451940035273369, F1 0.4622100122100122, AUC 0.790839947089947
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 13 idx: 0 First Loss : 3.8525943756103516, Second Loss : 3.6667068004608154
epoch: 13 idx: 200 First Loss : 0.9117119173781103, Second Loss : 0.9238269731508967
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4236111111111111, precision 0.5228608947384128, recall 0.5192929292929293, F1 0.4205268434964908, AUC 0.761919191919192
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7743434343434344
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46938775510204084, precision 0.5863759296822176, recall 0.5923721340388007, F1 0.4716229729142211, AUC 0.7552358906525574
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7935956790123457
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 14 idx: 0 First Loss : 3.845510721206665, Second Loss : 3.6562318801879883
epoch: 14 idx: 200 First Loss : 0.9071327242148873, Second Loss : 0.9210907390679404
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.5004036424696461, recall 0.4879124579124579, F1 0.38928571428571423, AUC 0.7558024691358026
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7637878787878788
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5734848484848485, recall 0.5604791299235744, F1 0.4502454909048533, AUC 0.7574710954340583
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7931547619047619
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 15 idx: 0 First Loss : 3.8287899494171143, Second Loss : 3.635918378829956
epoch: 15 idx: 200 First Loss : 0.9025111090987272, Second Loss : 0.9196226649375548
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.4888888888888889, recall 0.47420875420875425, F1 0.37376775271512114, AUC 0.7497586980920316
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7462626262626263
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5720820060442702, recall 0.5501175778953556, F1 0.43395540034195496, AUC 0.7581385949441506
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7892967372134039
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 16 idx: 0 First Loss : 3.801436185836792, Second Loss : 3.600970506668091
epoch: 16 idx: 200 First Loss : 0.8986998143680023, Second Loss : 0.9176337651720743
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3819444444444444, precision 0.49037817938420347, recall 0.4693939393939394, F1 0.37386729915465544, AUC 0.740695847362514
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7323737373737375
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5588309397833208, recall 0.5163874191651969, F1 0.41523418588952454, AUC 0.7579242602390751
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7839506172839507
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 17 idx: 0 First Loss : 3.772181272506714, Second Loss : 3.5597193241119385
epoch: 17 idx: 200 First Loss : 0.8954885937499383, Second Loss : 0.9168541627462296
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.375, precision 0.48379605378033874, recall 0.464949494949495, F1 0.36601252219418745, AUC 0.7301234567901235
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7155050505050505
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.564484126984127, recall 0.5240299823633157, F1 0.4123677248677249, AUC 0.7552052714089751
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7785493827160493
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 18 idx: 0 First Loss : 3.7451865673065186, Second Loss : 3.5242373943328857
epoch: 18 idx: 200 First Loss : 0.8932013921929055, Second Loss : 0.9166963482310356
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4714908185496421, recall 0.45124579124579123, F1 0.35016571407523395, AUC 0.7195342312008979
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7022222222222222
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.5581143095536086, recall 0.5101410934744268, F1 0.4036010683523714, AUC 0.7509063296100332
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7783289241622575
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.271067313505049e-05
epoch: 19 idx: 0 First Loss : 3.7129342555999756, Second Loss : 3.4817473888397217
epoch: 19 idx: 200 First Loss : 0.8914001636813506, Second Loss : 0.9167934069835665
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.46962927698636486, recall 0.45124579124579123, F1 0.35001921673520897, AUC 0.7121492704826039
  Second-Tier acc 0.3541666666666667, precision 0.44185606060606064, recall 0.44222222222222224, F1 0.3174025390405572, AUC 0.6868181818181819
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5596424010217114, recall 0.5101410934744268, F1 0.4048070441523424, AUC 0.7470972957084069
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7751322751322752
Test AUC: 0.7812, Test F1: 0.4905 (Best Epoch: 9){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.2755817081832308, "droprate_2": 0.0, "lr": 0.0004932792667434124, "weight_decay": 0.0004970936529634346, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0004932792667434124
epoch: 0 idx: 0 First Loss : 1.2425421476364136, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0824750810490913, Second Loss : 1.067429428484606
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7269191919191919
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7372727272727273
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6939055457573976
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6803350970017638
Test AUC: 0.6803, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004932792667434124
epoch: 1 idx: 0 First Loss : 2.0602874755859375, Second Loss : 2.616194248199463
epoch: 1 idx: 200 First Loss : 0.985523212979089, Second Loss : 0.9827632950757866
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7315824915824916
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7342424242424243
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7423880560454634
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7473544973544973
Test AUC: 0.6803, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004932792667434124
epoch: 2 idx: 0 First Loss : 2.6805436611175537, Second Loss : 2.595639944076538
epoch: 2 idx: 200 First Loss : 0.9406611156923261, Second Loss : 0.9343354221970881
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5694444444444444, precision 0.4444444444444445, recall 0.40404040404040403, F1 0.34920634920634924, AUC 0.7284624017957352
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.733030303030303
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.19014084507042253, recall 0.3333333333333333, F1 0.242152466367713, AUC 0.7495529590436997
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.755621693121693
Test AUC: 0.6803, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004932792667434124
epoch: 3 idx: 0 First Loss : 3.3683016300201416, Second Loss : 3.372152328491211
epoch: 3 idx: 200 First Loss : 0.9220152294670987, Second Loss : 0.9215135438951538
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7349102132435466
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7419191919191919
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7447947285910249
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7538029100529101
Test AUC: 0.7538, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 0.0004932792667434124
epoch: 4 idx: 0 First Loss : 4.397615909576416, Second Loss : 3.931626319885254
epoch: 4 idx: 200 First Loss : 0.9158104983047207, Second Loss : 0.922501031244498
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.625, precision 0.41785375118708457, recall 0.4961616161616162, F1 0.44236111111111115, AUC 0.735959595959596
  Second-Tier acc 0.6458333333333334, precision 0.4283374283374283, recall 0.5321212121212121, F1 0.4701857282502444, AUC 0.7382323232323232
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6394557823129252, precision 0.38165266106442575, recall 0.4365079365079365, F1 0.39380952380952383, AUC 0.7432576425631982
  Second-Tier acc 0.6530612244897959, precision 0.3974358974358974, recall 0.4523809523809524, F1 0.4116161616161616, AUC 0.7497244268077602
Test AUC: 0.7538, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 0.0004932792667434124
epoch: 5 idx: 0 First Loss : 3.1373074054718018, Second Loss : 3.4217140674591064
epoch: 5 idx: 200 First Loss : 0.900502854369729, Second Loss : 0.9033933620441205
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4513888888888889, precision 0.39010261502813637, recall 0.46989898989898987, F1 0.34816748371214534, AUC 0.7207519640852974
  Second-Tier acc 0.4791666666666667, precision 0.375, recall 0.4763636363636364, F1 0.36642087351106073, AUC 0.7387373737373736
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5306122448979592, precision 0.414113475177305, recall 0.4623750734861846, F1 0.38725058685446007, AUC 0.7209545855379188
  Second-Tier acc 0.5510204081632653, precision 0.41911764705882354, recall 0.4708994708994709, F1 0.4011857707509881, AUC 0.7360008818342152
Test AUC: 0.7538, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 0.0004932792667434124
epoch: 6 idx: 0 First Loss : 3.501965284347534, Second Loss : 3.8009042739868164
epoch: 6 idx: 200 First Loss : 0.8869370992853775, Second Loss : 0.8923615328342056
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3819444444444444, precision 0.3752716210343329, recall 0.43111111111111117, F1 0.2909098856905558, AUC 0.7315824915824916
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7878282828282828
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.7334166176758771
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7308201058201059
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 7 idx: 0 First Loss : 3.0404491424560547, Second Loss : 3.3498079776763916
epoch: 7 idx: 200 First Loss : 0.8708609377407001, Second Loss : 0.875402178453161
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.7344388327721662
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7623232323232324
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.7033668920242994
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7098765432098766
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 8 idx: 0 First Loss : 3.1461918354034424, Second Loss : 3.3647286891937256
epoch: 8 idx: 200 First Loss : 0.8716148385981941, Second Loss : 0.889771587522909
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.38300849575212387, recall 0.4444444444444444, F1 0.30890505890505887, AUC 0.7176711560044895
  Second-Tier acc 0.4791666666666667, precision 0.4124542124542125, recall 0.49333333333333335, F1 0.3699466056445462, AUC 0.7473737373737374
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.48299319727891155, precision 0.44188034188034186, recall 0.45267489711934156, F1 0.35027480310499176, AUC 0.6436654908877132
  Second-Tier acc 0.5306122448979592, precision 0.4373219373219373, recall 0.48148148148148145, F1 0.3866666666666667, AUC 0.6511243386243386
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 9 idx: 0 First Loss : 4.228222370147705, Second Loss : 3.6392457485198975
epoch: 9 idx: 200 First Loss : 0.8775849516401577, Second Loss : 0.8994528530791068
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.7002020202020202
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6982323232323232
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.44623655913978494, recall 0.4279835390946502, F1 0.3161105962310781, AUC 0.6550558495002939
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6014109347442681
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 10 idx: 0 First Loss : 3.2288389205932617, Second Loss : 3.235352039337158
epoch: 10 idx: 200 First Loss : 0.8617861684746531, Second Loss : 0.8896967337590721
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6883670033670034
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6962121212121213
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.4435695538057743, recall 0.4156378600823045, F1 0.2976936746929131, AUC 0.6308543993729179
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.613150352733686
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 11 idx: 0 First Loss : 3.461503744125366, Second Loss : 3.347047805786133
epoch: 11 idx: 200 First Loss : 0.8530404580031887, Second Loss : 0.8809143851522185
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.673047138047138
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6891414141414142
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.42857142857142855, recall 0.4156378600823045, F1 0.2973856209150327, AUC 0.633493778169704
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.6317239858906526
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 12 idx: 0 First Loss : 3.22253155708313, Second Loss : 3.202846050262451
epoch: 12 idx: 200 First Loss : 0.8356811575972665, Second Loss : 0.8662549703708035
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6650112233445566
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6814646464646464
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.4326617179215271, recall 0.4238683127572016, F1 0.3107226107226107, AUC 0.6381479031941996
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6333223104056437
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 13 idx: 0 First Loss : 3.420956611633301, Second Loss : 3.374959945678711
epoch: 13 idx: 200 First Loss : 0.8644199227136374, Second Loss : 0.9079476651111247
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.36577777777777776, recall 0.39999999999999997, F1 0.246767388049544, AUC 0.6639393939393939
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6763636363636363
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.4347540983606557, recall 0.43209876543209874, F1 0.32167510354348827, AUC 0.6353982951205174
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6323853615520282
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 14 idx: 0 First Loss : 3.504751443862915, Second Loss : 3.387836456298828
epoch: 14 idx: 200 First Loss : 0.8410115483073883, Second Loss : 0.8838872755722381
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6644219977553311
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6754040404040405
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.41496598639455784, precision 0.4269028871391076, recall 0.4115226337448559, F1 0.29109301462690645, AUC 0.631772976680384
  Second-Tier acc 0.3877551020408163, precision 0.45, recall 0.3950617283950617, F1 0.2770061728395062, AUC 0.6288580246913581
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 15 idx: 0 First Loss : 3.343923330307007, Second Loss : 3.0760498046875
epoch: 15 idx: 200 First Loss : 0.8308007274768825, Second Loss : 0.8723598055929783
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.343098311817279, recall 0.43757575757575756, F1 0.31387279556885467, AUC 0.6655836139169472
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.6867171717171717
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.5102040816326531, precision 0.40328037658134747, recall 0.45385067607289825, F1 0.3720459770114943, AUC 0.6449943660591809
  Second-Tier acc 0.5510204081632653, precision 0.4261437908496732, recall 0.49382716049382713, F1 0.40079365079365087, AUC 0.6240630511463845
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 16 idx: 0 First Loss : 4.293175220489502, Second Loss : 4.30152702331543
epoch: 16 idx: 200 First Loss : 0.8385628009807861, Second Loss : 0.8773738866205064
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2986111111111111, precision 0.3403797220591114, recall 0.37777777777777777, F1 0.20990391722099042, AUC 0.6576038159371492
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6747979797979798
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.43552311435523117, recall 0.37448559670781895, F1 0.22968465426565987, AUC 0.6454842739564962
  Second-Tier acc 0.3877551020408163, precision 0.4471544715447155, recall 0.3950617283950617, F1 0.27386363636363636, AUC 0.6458333333333334
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 17 idx: 0 First Loss : 3.865652084350586, Second Loss : 3.6578187942504883
epoch: 17 idx: 200 First Loss : 0.8239584056081822, Second Loss : 0.8783555915815215
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6615207631874299
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6708080808080809
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.3621399176954732, F1 0.20687645687645687, AUC 0.6471377131099354
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6442901234567902
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 18 idx: 0 First Loss : 3.921759605407715, Second Loss : 3.698153495788574
epoch: 18 idx: 200 First Loss : 0.8186723136253415, Second Loss : 0.8735748181694131
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2777777777777778, precision 0.31542288557213927, recall 0.3644444444444444, F1 0.1866384877304215, AUC 0.6576038159371492
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.666060606060606
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.32653061224489793, precision 0.4326241134751773, recall 0.35802469135802467, F1 0.1989824759751272, AUC 0.6479583088379385
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6461089065255732
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6)
Current LR: 0.0004932792667434124
epoch: 19 idx: 0 First Loss : 3.9947757720947266, Second Loss : 3.74773907661438
epoch: 19 idx: 200 First Loss : 0.807654679570363, Second Loss : 0.872934986462786
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2777777777777778, precision 0.34074074074074073, recall 0.3644444444444444, F1 0.1865079365079365, AUC 0.6549887766554433
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6724747474747476
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6513264256319812
  Second-Tier acc 0.30612244897959184, precision 0.44186046511627913, recall 0.345679012345679, F1 0.18755221386800333, AUC 0.6624779541446209
Test AUC: 0.7308, Test F1: 0.3395 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.3166659598291641, "droprate_2": 0.0, "lr": 1.2141467888239433e-05, "weight_decay": 0.0006004083001312845, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.2141467888239433e-05
epoch: 0 idx: 0 First Loss : 1.2358613014221191, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.059835572889195, Second Loss : 1.0429087401326023
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6708922558922558
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7443434343434344
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6101067999216148
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.611221340388007
Test AUC: 0.6112, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.2141467888239433e-05
epoch: 1 idx: 0 First Loss : 2.042680025100708, Second Loss : 1.9784581661224365
epoch: 1 idx: 200 First Loss : 1.1085188070043404, Second Loss : 1.0942542472140706
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7128114478114478
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7544949494949496
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6548966294336664
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6647376543209877
Test AUC: 0.6647, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.2141467888239433e-05
epoch: 2 idx: 0 First Loss : 2.1373660564422607, Second Loss : 2.09409236907959
epoch: 2 idx: 200 First Loss : 1.0987127085971595, Second Loss : 1.0840862391155157
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7255611672278338
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7632828282828283
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6838195669214189
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7014991181657848
Test AUC: 0.7015, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.2141467888239433e-05
epoch: 3 idx: 0 First Loss : 2.2084503173828125, Second Loss : 2.1559700965881348
epoch: 3 idx: 200 First Loss : 1.085010561480451, Second Loss : 1.0706018229473884
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7362962962962962
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7663131313131313
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7011071918479326
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7072861552028219
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 4 idx: 0 First Loss : 2.293686628341675, Second Loss : 2.222860813140869
epoch: 4 idx: 200 First Loss : 1.0714432415158595, Second Loss : 1.0569910957149011
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7394668911335578
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7638383838383839
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7111196844993142
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7135692239858907
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 5 idx: 0 First Loss : 2.3851497173309326, Second Loss : 2.3035290241241455
epoch: 5 idx: 200 First Loss : 1.0573108410509071, Second Loss : 1.0446375988016081
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7382323232323232
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7546969696969698
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7179783950617283
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7209545855379189
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 6 idx: 0 First Loss : 2.4915883541107178, Second Loss : 2.3910112380981445
epoch: 6 idx: 200 First Loss : 1.041365116871708, Second Loss : 1.028792929923653
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5763888888888888, precision 0.5643939393939394, recall 0.4132996632996633, F1 0.37203369859785557, AUC 0.73824354657688
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7476767676767677
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5782312925170068, precision 0.5221445221445221, recall 0.3888888888888889, F1 0.3363095238095238, AUC 0.7189643347050755
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7154982363315696
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 7 idx: 0 First Loss : 2.6055479049682617, Second Loss : 2.492882251739502
epoch: 7 idx: 200 First Loss : 1.0236159094901227, Second Loss : 1.0124918698004228
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6041666666666666, precision 0.6402562207440257, recall 0.46080808080808083, F1 0.45395988874249743, AUC 0.7330976430976431
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7475252525252526
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6598639455782312, precision 0.8151041666666666, recall 0.5376984126984127, F1 0.519484316852738, AUC 0.7159514011365863
  Second-Tier acc 0.6326530612244898, precision 0.6957026713124274, recall 0.4464285714285714, F1 0.4340180516651104, AUC 0.7175925925925926
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 8 idx: 0 First Loss : 2.7373015880584717, Second Loss : 2.601677417755127
epoch: 8 idx: 200 First Loss : 1.005348826744663, Second Loss : 0.9951057598476682
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6875, precision 0.6638257575757576, recall 0.5987542087542087, F1 0.6148514002503815, AUC 0.7341694725028058
  Second-Tier acc 0.6458333333333334, precision 0.4166666666666667, recall 0.566060606060606, F1 0.4795321637426901, AUC 0.7453535353535354
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6054421768707483, precision 0.5284453234849679, recall 0.5434303350970017, F1 0.5164408870432079, AUC 0.7112666568685088
  Second-Tier acc 0.6326530612244898, precision 0.6222222222222222, recall 0.5330687830687831, F1 0.5446039340776183, AUC 0.7137896825396824
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 9 idx: 0 First Loss : 2.876781702041626, Second Loss : 2.7288131713867188
epoch: 9 idx: 200 First Loss : 0.9886470976197601, Second Loss : 0.9797371144577935
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5625, precision 0.4769968553459119, recall 0.4797643097643098, F1 0.46368264159596423, AUC 0.7304489337822672
  Second-Tier acc 0.6041666666666666, precision 0.5228370663153271, recall 0.5538383838383838, F1 0.49015151515151506, AUC 0.7516666666666666
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5238095238095238, precision 0.4588962062366318, recall 0.4978689006466784, F1 0.4574961753089342, AUC 0.713697824808936
  Second-Tier acc 0.5918367346938775, precision 0.5424242424242425, recall 0.5427689594356261, F1 0.5239548810977382, AUC 0.7293320105820106
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 10 idx: 0 First Loss : 3.0196855068206787, Second Loss : 2.859133243560791
epoch: 10 idx: 200 First Loss : 0.9753165499061642, Second Loss : 0.9673759898180095
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5416666666666666, precision 0.502108733992792, recall 0.5154208754208754, F1 0.4792420327304048, AUC 0.7312962962962963
  Second-Tier acc 0.5, precision 0.5249084249084249, recall 0.5160606060606061, F1 0.467425320056899, AUC 0.7577272727272728
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4965986394557823, precision 0.4672767210535908, recall 0.5205026455026455, F1 0.4521935269368122, AUC 0.7193562610229277
  Second-Tier acc 0.673469387755102, precision 0.668261562998405, recall 0.7272927689594356, F1 0.6795182950789358, AUC 0.7461970899470899
Test AUC: 0.7073, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.2141467888239433e-05
epoch: 11 idx: 0 First Loss : 3.1487843990325928, Second Loss : 2.99188494682312
epoch: 11 idx: 200 First Loss : 0.964660254376593, Second Loss : 0.9580707719910946
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4930555555555556, precision 0.5009496676163342, recall 0.5044107744107744, F1 0.452046783625731, AUC 0.7372053872053872
  Second-Tier acc 0.5416666666666666, precision 0.5957653457653458, recall 0.603030303030303, F1 0.5356613756613756, AUC 0.7804545454545454
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4489795918367347, precision 0.4563643408037001, recall 0.49551734273956494, F1 0.423152924849911, AUC 0.7234224965706447
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7593694885361552
Test AUC: 0.7594, Test F1: 0.5841 (Best Epoch: 11)
Current LR: 1.2141467888239433e-05
epoch: 12 idx: 0 First Loss : 3.2675249576568604, Second Loss : 3.1057627201080322
epoch: 12 idx: 200 First Loss : 0.9563236287818174, Second Loss : 0.9509587142783315
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4583333333333333, precision 0.4854275489758599, recall 0.4821885521885522, F1 0.42270106819486203, AUC 0.7409427609427609
  Second-Tier acc 0.5416666666666666, precision 0.6055555555555555, recall 0.6174747474747475, F1 0.5413919413919414, AUC 0.793030303030303
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.46243765537540565, recall 0.49676660787771904, F1 0.4126513379525428, AUC 0.7257679306290417
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7646604938271606
Test AUC: 0.7647, Test F1: 0.5455 (Best Epoch: 12)
Current LR: 1.2141467888239433e-05
epoch: 13 idx: 0 First Loss : 3.3654654026031494, Second Loss : 3.2016513347625732
epoch: 13 idx: 200 First Loss : 0.9496928402987211, Second Loss : 0.9451837775515235
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4444444444444444, precision 0.4906242956952896, recall 0.4781144781144781, F1 0.4106390242753879, AUC 0.7448540965207632
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8024747474747475
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.4513543394140409, recall 0.4844209288653733, F1 0.39703362959176913, AUC 0.7296504507152655
  Second-Tier acc 0.5102040816326531, precision 0.5389499389499389, recall 0.605599647266314, F1 0.5219461697722567, AUC 0.7713293650793651
Test AUC: 0.7713, Test F1: 0.5219 (Best Epoch: 13)
Current LR: 1.2141467888239433e-05
epoch: 14 idx: 0 First Loss : 3.447636365890503, Second Loss : 3.2813382148742676
epoch: 14 idx: 200 First Loss : 0.9442565905819855, Second Loss : 0.9405349385206453
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.4740232915842671, recall 0.451919191919192, F1 0.385682001614205, AUC 0.7458136924803592
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8079797979797979
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5081831119544592, recall 0.5259406231628454, F1 0.429951690821256, AUC 0.7311507936507936
  Second-Tier acc 0.4897959183673469, precision 0.5622895622895623, recall 0.6047178130511464, F1 0.49430199430199434, AUC 0.7721560846560847
Test AUC: 0.7722, Test F1: 0.4943 (Best Epoch: 14)
Current LR: 1.2141467888239433e-05
epoch: 15 idx: 0 First Loss : 3.5142648220062256, Second Loss : 3.3441245555877686
epoch: 15 idx: 200 First Loss : 0.9395500537360189, Second Loss : 0.9365514669224472
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.49204653371320034, recall 0.46202020202020205, F1 0.3956876456876457, AUC 0.7466666666666667
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.8088383838383839
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5110849056603773, recall 0.5238095238095238, F1 0.43297555929134873, AUC 0.7331594160297863
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7665895061728395
Test AUC: 0.7666, Test F1: 0.5120 (Best Epoch: 15)
Current LR: 1.2141467888239433e-05
epoch: 16 idx: 0 First Loss : 3.5719833374023438, Second Loss : 3.399073600769043
epoch: 16 idx: 200 First Loss : 0.9353095600196156, Second Loss : 0.9328694008383437
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4097222222222222, precision 0.49801365114914947, recall 0.4697306397306398, F1 0.3976190476190477, AUC 0.7491470258136924
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8096969696969696
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.5363756613756614, recall 0.5311581422692534, F1 0.430007405260955, AUC 0.7356150793650794
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7707231040564375
Test AUC: 0.7707, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.2141467888239433e-05
epoch: 17 idx: 0 First Loss : 3.6177399158477783, Second Loss : 3.4406540393829346
epoch: 17 idx: 200 First Loss : 0.9311326910829663, Second Loss : 0.9292264381766467
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4097222222222222, precision 0.5081513337268461, recall 0.48838383838383836, F1 0.4054725690709296, AUC 0.7528058361391695
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8077272727272726
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.5338775201708142, recall 0.5210905349794238, F1 0.4244772042880364, AUC 0.7370296884185774
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.773258377425044
Test AUC: 0.7707, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.2141467888239433e-05
epoch: 18 idx: 0 First Loss : 3.6534340381622314, Second Loss : 3.473886489868164
epoch: 18 idx: 200 First Loss : 0.9268505655238358, Second Loss : 0.9258165897648615
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4097222222222222, precision 0.5121319267895931, recall 0.49572390572390573, F1 0.40795071588437787, AUC 0.7567003367003368
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8053030303030303
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5571895424836601, recall 0.5369635508524397, F1 0.43816736222345715, AUC 0.740024250440917
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.7744708994708995
Test AUC: 0.7707, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.2141467888239433e-05
epoch: 19 idx: 0 First Loss : 3.6823108196258545, Second Loss : 3.500842332839966
epoch: 19 idx: 200 First Loss : 0.9227667158858767, Second Loss : 0.9224940335438285
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4236111111111111, precision 0.5219870578504354, recall 0.515084175084175, F1 0.4211771665187814, AUC 0.7578787878787878
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.8033838383838384
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5590727816550349, recall 0.5426219870664316, F1 0.4320497109951959, AUC 0.7425533999608073
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.779376102292769
Test AUC: 0.7707, Test F1: 0.5120 (Best Epoch: 16){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.23684284084265247, "droprate_2": 0.0, "lr": 4.2854745782606725e-05, "weight_decay": 0.00017754116822768794, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.21842363937599216, "droprate_2": 0.0, "lr": 0.00013573274330421227, "weight_decay": 5.063024502347718e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00013573274330421227
epoch: 0 idx: 0 First Loss : 1.1606827974319458, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.09311964084853, Second Loss : 1.0915837009896094
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7613748597081931
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.765959595959596
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7223936899862826
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7179783950617283
Test AUC: 0.7180, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00013573274330421227
epoch: 1 idx: 0 First Loss : 1.735312581062317, Second Loss : 1.738578200340271
epoch: 1 idx: 200 First Loss : 0.9940953408900778, Second Loss : 0.9945779932820382
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7412121212121212
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.748080808080808
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7172925240054869
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7103725749559082
Test AUC: 0.7180, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00013573274330421227
epoch: 2 idx: 0 First Loss : 2.290583610534668, Second Loss : 2.541259765625
epoch: 2 idx: 200 First Loss : 0.9573876417024219, Second Loss : 0.9512471498096761
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5069444444444444, precision 0.47431185167034223, recall 0.502087542087542, F1 0.43657196969696965, AUC 0.7327104377104376
  Second-Tier acc 0.6041666666666666, precision 0.5678871090770404, recall 0.553131313131313, F1 0.5396900695762176, AUC 0.732979797979798
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.5530965860353406, recall 0.551954732510288, F1 0.5369091244754496, AUC 0.7264966686262982
  Second-Tier acc 0.5102040816326531, precision 0.47875816993464054, recall 0.5304232804232805, F1 0.4753300600109111, AUC 0.7121362433862434
Test AUC: 0.7180, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00013573274330421227
epoch: 3 idx: 0 First Loss : 2.9377501010894775, Second Loss : 3.1230692863464355
epoch: 3 idx: 200 First Loss : 0.9215412244701119, Second Loss : 0.9333509834140391
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3888888888888889, precision 0.4890141791956973, recall 0.4361616161616162, F1 0.3600174091833442, AUC 0.7428002244668912
  Second-Tier acc 0.5208333333333334, precision 0.5492776057791539, recall 0.5821212121212122, F1 0.5246142694418556, AUC 0.751969696969697
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.48299319727891155, precision 0.5295414462081128, recall 0.5045561434450324, F1 0.4660872896167014, AUC 0.7386586321771507
  Second-Tier acc 0.5306122448979592, precision 0.545029239766082, recall 0.6064814814814815, F1 0.5347888826149696, AUC 0.7503858024691358
Test AUC: 0.7180, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00013573274330421227
epoch: 4 idx: 0 First Loss : 3.525663137435913, Second Loss : 3.680891275405884
epoch: 4 idx: 200 First Loss : 0.9135701419294473, Second Loss : 0.9278522995277424
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.527017543859649, recall 0.4906397306397306, F1 0.39737069947596265, AUC 0.7645903479236814
  Second-Tier acc 0.4791666666666667, precision 0.5280303030303031, recall 0.546060606060606, F1 0.477056277056277, AUC 0.7897979797979798
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46938775510204084, precision 0.5653235653235653, recall 0.5077895355673133, F1 0.45086409342844824, AUC 0.7332022829708015
  Second-Tier acc 0.5510204081632653, precision 0.6153846153846154, recall 0.6175044091710759, F1 0.5389103389103389, AUC 0.7474647266313933
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 5 idx: 0 First Loss : 3.714379072189331, Second Loss : 3.8720998764038086
epoch: 5 idx: 200 First Loss : 0.9060318957022693, Second Loss : 0.9247446894050293
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4027777777777778, precision 0.48525242873068963, recall 0.4708080808080808, F1 0.38145111417000815, AUC 0.7484960718294053
  Second-Tier acc 0.4166666666666667, precision 0.49204653371320034, recall 0.4796969696969697, F1 0.39685273790536946, AUC 0.7465656565656565
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.40816326530612246, precision 0.5016290726817043, recall 0.4142416225749559, F1 0.3673350979920323, AUC 0.7108196159122085
  Second-Tier acc 0.46938775510204084, precision 0.5104166666666666, recall 0.46230158730158727, F1 0.39673913043478254, AUC 0.7272927689594356
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 6 idx: 0 First Loss : 3.7935714721679688, Second Loss : 3.9443564414978027
epoch: 6 idx: 200 First Loss : 0.9055194213409533, Second Loss : 0.9241230217427182
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.375, precision 0.4390008576329331, recall 0.44111111111111106, F1 0.32044625996268805, AUC 0.7305443322109988
  Second-Tier acc 0.3958333333333333, precision 0.4550653594771242, recall 0.45444444444444443, F1 0.3414141414141414, AUC 0.711919191919192
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.4898989898989899, recall 0.40615814226925334, F1 0.34832156571287004, AUC 0.6941076327650402
  Second-Tier acc 0.42857142857142855, precision 0.5024509803921569, recall 0.43761022927689597, F1 0.35947712418300654, AUC 0.6862323633156967
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 7 idx: 0 First Loss : 3.823068618774414, Second Loss : 3.911893367767334
epoch: 7 idx: 200 First Loss : 0.9054607969016041, Second Loss : 0.9225441628600244
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3819444444444444, precision 0.44298897559767125, recall 0.4407407407407407, F1 0.31929367491677524, AUC 0.7018574635241303
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.6816161616161617
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.51165371809101, recall 0.4420194003527336, F1 0.3723326113570016, AUC 0.6830540858318637
  Second-Tier acc 0.40816326530612246, precision 0.4537037037037037, recall 0.3959435626102293, F1 0.31058823529411766, AUC 0.6546516754850088
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 8 idx: 0 First Loss : 3.8302719593048096, Second Loss : 3.8260202407836914
epoch: 8 idx: 200 First Loss : 0.907113494280267, Second Loss : 0.9158114315562567
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.4621434322521279, recall 0.4407407407407407, F1 0.3174081893293716, AUC 0.6896464646464647
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.6861616161616162
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.43537414965986393, precision 0.47970779220779214, recall 0.42217813051146386, F1 0.34025974025974026, AUC 0.6784367038996669
  Second-Tier acc 0.42857142857142855, precision 0.456140350877193, recall 0.4197530864197531, F1 0.3167420814479638, AUC 0.6612654320987654
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 9 idx: 0 First Loss : 3.8419721126556396, Second Loss : 3.70373272895813
epoch: 9 idx: 200 First Loss : 0.9057172089458944, Second Loss : 0.9099595564836289
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4027777777777778, precision 0.38300849575212387, recall 0.4444444444444444, F1 0.30890505890505887, AUC 0.6795959595959595
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.687929292929293
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.5602636534839924, recall 0.44628159905937687, F1 0.3575184608284297, AUC 0.6736172349598276
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.6661155202821869
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 10 idx: 0 First Loss : 3.851630210876465, Second Loss : 3.5001845359802246
epoch: 10 idx: 200 First Loss : 0.8980556025977168, Second Loss : 0.9014965729661685
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.4274199011041116, recall 0.422962962962963, F1 0.29291962174940894, AUC 0.671885521885522
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.6867676767676767
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.41496598639455784, precision 0.4957718780727631, recall 0.4234273956496178, F1 0.332897711607389, AUC 0.6665074466000391
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.6723434744268078
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 11 idx: 0 First Loss : 3.7546722888946533, Second Loss : 3.7253873348236084
epoch: 11 idx: 200 First Loss : 0.9017090812006638, Second Loss : 0.8974711093150973
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.4430205949656751, recall 0.422962962962963, F1 0.29110933319998994, AUC 0.6657182940516274
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6808585858585858
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4013605442176871, precision 0.47391688770999113, recall 0.4054232804232804, F1 0.30800651053815614, AUC 0.6648846266901822
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6666666666666666
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 12 idx: 0 First Loss : 3.7614879608154297, Second Loss : 3.6066484451293945
epoch: 12 idx: 200 First Loss : 0.8960402696606279, Second Loss : 0.8874559338829788
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.48766478342749525, recall 0.4274074074074074, F1 0.29673964159847743, AUC 0.6635465768799101
  Second-Tier acc 0.3125, precision 0.3583333333333334, recall 0.38666666666666666, F1 0.23267973856209148, AUC 0.6853030303030302
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4421768707482993, precision 0.49776149776149775, recall 0.4339359200470312, F1 0.34084903059340066, AUC 0.6629984812855184
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6731150793650794
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 13 idx: 0 First Loss : 3.665137529373169, Second Loss : 3.539667844772339
epoch: 13 idx: 200 First Loss : 0.8876436759239359, Second Loss : 0.8831916606771605
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.4583333333333333, recall 0.4181481481481481, F1 0.2797557619539044, AUC 0.6635970819304152
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6790909090909091
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.490702479338843, recall 0.42129629629629634, F1 0.313824595649749, AUC 0.6616818538114835
  Second-Tier acc 0.3877551020408163, precision 0.4471544715447155, recall 0.3950617283950617, F1 0.27386363636363636, AUC 0.6743827160493828
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4)
Current LR: 0.00013573274330421227
epoch: 14 idx: 0 First Loss : 3.8667409420013428, Second Loss : 3.6508665084838867
epoch: 14 idx: 200 First Loss : 0.8920507656103516, Second Loss : 0.8708415673171843
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.4819767999233055, recall 0.4137037037037037, F1 0.2725046782699494, AUC 0.6631425364758697
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.680959595959596
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5138211382113821, recall 0.4254115226337449, F1 0.3193521421107628, AUC 0.6667034097589655
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6858465608465609
Test AUC: 0.7475, Test F1: 0.5389 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.19660902105672753, "droprate_2": 0.0, "lr": 0.000926360658655404, "weight_decay": 0.0006805930443177406, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1577144861221313, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0920374190332878, Second Loss : 1.0859817291670177
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7250392817059484
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.723787878787879{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.29642187241647017, "droprate_2": 0.0, "lr": 6.579129140376285e-05, "weight_decay": 2.066414061597225e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.09971719358591712, "droprate_2": 0.0, "lr": 4.213783708550988e-05, "weight_decay": 0.00012380544529409012, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.16626734156579545, "droprate_2": 0.0, "lr": 1.1192775070912816e-05, "weight_decay": 0.0006033059768794633, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.06046446353737821, "droprate_2": 0.0, "lr": 2.6262224212370353e-05, "weight_decay": 0.0002818873197385461, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.11420815117953705, "droprate_2": 0.0, "lr": 0.0005715515980721236, "weight_decay": 6.991108075374577e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1443482637405396, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.077782410590803, Second Loss : 1.080470522615447{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.040711148708818846, "droprate_2": 0.0, "lr": 2.129981032787165e-05, "weight_decay": 9.337230842796591e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0885533094406128, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0996751463531855, Second Loss : 1.092766088632802
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7208522727272727
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7108585858585857
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6433049492945327
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6397156084656085
epoch: 1 idx: 0 First Loss : 1.9771974086761475, Second Loss : 2.0067126750946045
epoch: 1 idx: 200 First Loss : 1.0951165694798997, Second Loss : 1.0914994736957313
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7419286616161616
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7392929292929292
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6848028273809524
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6753196649029983
epoch: 2 idx: 0 First Loss : 2.0936498641967773, Second Loss : 2.1052989959716797
epoch: 2 idx: 200 First Loss : 1.0658447932989443, Second Loss : 1.0671251374690687
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.741395202020202
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7502525252525253
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6998766809964726
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6974206349206349
epoch: 3 idx: 0 First Loss : 2.2501864433288574, Second Loss : 2.243096113204956
epoch: 3 idx: 200 First Loss : 1.039696398399659, Second Loss : 1.0433235941315764
  First-Tier acc 0.5989583333333334, precision 0.3944508374888122, recall 0.46393939393939393, F1 0.41256418000604045, AUC 0.739715909090909
  Second-Tier acc 0.5625, precision 0.47289972899729, recall 0.40838383838383835, F1 0.37575757575757573, AUC 0.7465151515151515
  First-Tier acc 0.5816326530612245, precision 0.4652751016912866, recall 0.3865740740740741, F1 0.3482094193837966, AUC 0.6863770392416225
  Second-Tier acc 0.6326530612244898, precision 0.787878787878788, recall 0.48214285714285715, F1 0.46463223787167446, AUC 0.6878858024691358
epoch: 4 idx: 0 First Loss : 2.4330902099609375, Second Loss : 2.4271812438964844
epoch: 4 idx: 200 First Loss : 1.0131009833433142, Second Loss : 1.0162218998913741
  First-Tier acc 0.6614583333333334, precision 0.6183818922305765, recall 0.6007070707070706, F1 0.5637531310830476, AUC 0.7412468434343434
  Second-Tier acc 0.6875, precision 0.6444444444444445, recall 0.5945454545454546, F1 0.6023172905525846, AUC 0.7463636363636365
  First-Tier acc 0.6071428571428571, precision 0.5830280830280831, recall 0.5660824514991182, F1 0.5716946943049641, AUC 0.6850956238977073
  Second-Tier acc 0.5102040816326531, precision 0.4481074481074481, recall 0.4896384479717813, F1 0.4523081512417033, AUC 0.6878858024691358
epoch: 5 idx: 0 First Loss : 2.647118091583252, Second Loss : 2.6536898612976074
epoch: 5 idx: 200 First Loss : 0.989717713413547, Second Loss : 0.9904563516304268
  First-Tier acc 0.6197916666666666, precision 0.5970837587796652, recall 0.6186363636363637, F1 0.5858613089558973, AUC 0.7478440656565657
  Second-Tier acc 0.5833333333333334, precision 0.5666666666666668, recall 0.5567676767676768, F1 0.5440545808966862, AUC 0.7623232323232324
  First-Tier acc 0.5714285714285714, precision 0.553021978021978, recall 0.5986552028218695, F1 0.5605308073050008, AUC 0.6958016424162258
  Second-Tier acc 0.5510204081632653, precision 0.5178571428571429, recall 0.5665784832451499, F1 0.5170940170940171, AUC 0.7075617283950617
epoch: 6 idx: 0 First Loss : 2.858884572982788, Second Loss : 2.8812060356140137
epoch: 6 idx: 200 First Loss : 0.9718545611521497, Second Loss : 0.9686043781056926
  First-Tier acc 0.5677083333333334, precision 0.5875728815331921, recall 0.6050757575757576, F1 0.5604781164710139, AUC 0.7569854797979798
  Second-Tier acc 0.5416666666666666, precision 0.57991452991453, recall 0.5734343434343434, F1 0.5181647813226761, AUC 0.7671212121212121
  First-Tier acc 0.5408163265306123, precision 0.546476574500768, recall 0.6065917107583775, F1 0.5367335823218177, AUC 0.7109926146384481
  Second-Tier acc 0.5102040816326531, precision 0.4914529914529915, recall 0.5597442680776014, F1 0.48566001899335226, AUC 0.7298831569664902
epoch: 7 idx: 0 First Loss : 3.0377378463745117, Second Loss : 3.0783846378326416
epoch: 7 idx: 200 First Loss : 0.960014657446401, Second Loss : 0.9540531920612007
  First-Tier acc 0.546875, precision 0.5932412657764771, recall 0.6091666666666667, F1 0.5478599033816426, AUC 0.7645738636363637
  Second-Tier acc 0.5, precision 0.5349650349650349, recall 0.5297979797979798, F1 0.469076732234627, AUC 0.7786868686868686
  First-Tier acc 0.49489795918367346, precision 0.5200184979652239, recall 0.5804122574955909, F1 0.4939105342888226, AUC 0.722783702601411
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.7316468253968255
epoch: 8 idx: 0 First Loss : 3.174076557159424, Second Loss : 3.2351646423339844
epoch: 8 idx: 200 First Loss : 0.9532693258454255, Second Loss : 0.9444878092267324
  First-Tier acc 0.4635416666666667, precision 0.5379065379065379, recall 0.5261363636363636, F1 0.4639972870188697, AUC 0.7711710858585858
  Second-Tier acc 0.5208333333333334, precision 0.5718253968253968, recall 0.577070707070707, F1 0.5084656084656084, AUC 0.7871212121212121
  First-Tier acc 0.47959183673469385, precision 0.5198529411764706, recall 0.5727513227513228, F1 0.478494623655914, AUC 0.7309131117724869
  Second-Tier acc 0.46938775510204084, precision 0.489573607220666, recall 0.5465167548500882, F1 0.4658758498254958, AUC 0.742283950617284
epoch: 9 idx: 0 First Loss : 3.2822492122650146, Second Loss : 3.3542234897613525
epoch: 9 idx: 200 First Loss : 0.9486578077318805, Second Loss : 0.9370303300871926
  First-Tier acc 0.453125, precision 0.5331828927573609, recall 0.519469696969697, F1 0.45430186138559997, AUC 0.7740467171717172
  Second-Tier acc 0.5208333333333334, precision 0.5748717948717949, recall 0.577070707070707, F1 0.5085156585156585, AUC 0.808080808080808
  First-Tier acc 0.47959183673469385, precision 0.531679602493374, recall 0.5784832451499119, F1 0.47970341329597427, AUC 0.7340098655202821
  Second-Tier acc 0.4897959183673469, precision 0.5102707749766573, recall 0.5703262786596119, F1 0.49052845528455286, AUC 0.7447089947089948{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.209838482976384, "droprate_2": 0.0, "lr": 0.0002682239515371791, "weight_decay": 1.4890258180732879e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "ReduceLROnPlateau", "step_size": 7, "gamma": 0.6508145970700792, "T_max": 4, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0935121774673462, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.078367410014518, Second Loss : 1.0786887912163095
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7406818181818181
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7462121212121211
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7311542383156967
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7193011463844797
epoch: 1 idx: 0 First Loss : 1.5630056858062744, Second Loss : 1.7300482988357544
epoch: 1 idx: 200 First Loss : 0.977826296912497, Second Loss : 0.9757882495276371
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7268244949494949
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7298484848484849
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.724750606261023
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7123567019400353
epoch: 2 idx: 0 First Loss : 2.209617853164673, Second Loss : 2.307621955871582
epoch: 2 idx: 200 First Loss : 0.9400453081178428, Second Loss : 0.9325001992248184
  First-Tier acc 0.5833333333333334, precision 0.503968253968254, recall 0.5405050505050505, F1 0.47684240362811786, AUC 0.7165845959595959
  Second-Tier acc 0.6666666666666666, precision 0.4237824161922834, recall 0.5793939393939395, F1 0.48809523809523814, AUC 0.7276767676767677
  First-Tier acc 0.576530612244898, precision 0.6080691112949178, recall 0.5236441798941799, F1 0.525754787705309, AUC 0.704861111111111
  Second-Tier acc 0.5102040816326531, precision 0.3472686733556299, recall 0.4118165784832451, F1 0.36333333333333334, AUC 0.7135692239858905
epoch: 3 idx: 0 First Loss : 3.494152307510376, Second Loss : 3.6267237663269043
epoch: 3 idx: 200 First Loss : 0.9320408920734305, Second Loss : 0.923483256283054
  First-Tier acc 0.4114583333333333, precision 0.375266635450809, recall 0.4457575757575758, F1 0.3163641194729278, AUC 0.7287752525252525
  Second-Tier acc 0.4583333333333333, precision 0.36767676767676766, recall 0.46303030303030307, F1 0.3515151515151515, AUC 0.7326767676767676
  First-Tier acc 0.46938775510204084, precision 0.3888888888888889, recall 0.41865079365079366, F1 0.34423763865388235, AUC 0.7148713073192239
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6980268959435626
epoch: 4 idx: 0 First Loss : 3.685619592666626, Second Loss : 3.768141746520996
epoch: 4 idx: 200 First Loss : 0.9245457449390446, Second Loss : 0.9141131976517427
  First-Tier acc 0.375, precision 0.3756088422630199, recall 0.4224242424242424, F1 0.2868988391376451, AUC 0.7251988636363637
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.742020202020202
  First-Tier acc 0.45408163265306123, precision 0.41342940685045954, recall 0.4208553791887126, F1 0.33235042735042736, AUC 0.6946993496472663
  Second-Tier acc 0.5306122448979592, precision 0.41633986928104577, recall 0.47001763668430335, F1 0.38690476190476186, AUC 0.6838073192239859
epoch: 5 idx: 0 First Loss : 3.735832691192627, Second Loss : 3.7235872745513916
epoch: 5 idx: 200 First Loss : 0.9164935937058644, Second Loss : 0.9041341061643626
  First-Tier acc 0.3697916666666667, precision 0.38256576722797053, recall 0.42333333333333334, F1 0.28190375913460936, AUC 0.6751483585858585
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.6996969696969697
  First-Tier acc 0.4642857142857143, precision 0.4318232289584721, recall 0.4384920634920635, F1 0.3357231255067639, AUC 0.6592916391093474
  Second-Tier acc 0.5306122448979592, precision 0.44102564102564107, recall 0.48148148148148145, F1 0.3904761904761904, AUC 0.6815476190476191
epoch: 6 idx: 0 First Loss : 3.7207467555999756, Second Loss : 3.7088985443115234
epoch: 6 idx: 200 First Loss : 0.9104864456197386, Second Loss : 0.8964568239460649
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6597506313131313
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.6961111111111111
  First-Tier acc 0.44387755102040816, precision 0.4367378048780488, recall 0.4290123456790123, F1 0.3173160173160173, AUC 0.6673314869929453
  Second-Tier acc 0.5102040816326531, precision 0.4388888888888889, recall 0.46913580246913583, F1 0.3785103785103785, AUC 0.7000110229276896
epoch: 7 idx: 0 First Loss : 3.7245988845825195, Second Loss : 3.7523598670959473
epoch: 7 idx: 200 First Loss : 0.9119876823700798, Second Loss : 0.9036906166569751
  First-Tier acc 0.3489583333333333, precision 0.37448559670781895, recall 0.41, F1 0.26312973014295543, AUC 0.655451388888889
  Second-Tier acc 0.375, precision 0.3881578947368421, recall 0.4266666666666667, F1 0.29107400535971967, AUC 0.681060606060606
  First-Tier acc 0.42857142857142855, precision 0.4363585078626331, recall 0.4197530864197531, F1 0.3067248830672488, AUC 0.6811135912698413
  Second-Tier acc 0.4897959183673469, precision 0.456140350877193, recall 0.4567901234567901, F1 0.3596673596673597, AUC 0.7296626984126985
epoch: 8 idx: 0 First Loss : 3.7907347679138184, Second Loss : 3.8259999752044678
epoch: 8 idx: 200 First Loss : 0.9114715161070747, Second Loss : 0.897638864632214
  First-Tier acc 0.3177083333333333, precision 0.35766562113867506, recall 0.38999999999999996, F1 0.23268444897053256, AUC 0.6482670454545455
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6616161616161617
  First-Tier acc 0.4030612244897959, precision 0.4292483660130719, recall 0.404320987654321, F1 0.28135335657459554, AUC 0.6866767250881834
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.7082782186948854
epoch: 9 idx: 0 First Loss : 3.7501187324523926, Second Loss : 3.889113426208496
epoch: 9 idx: 200 First Loss : 0.904311149167311, Second Loss : 0.8883394888248607
  First-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6544886363636363
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6540909090909091
  First-Tier acc 0.3979591836734694, precision 0.441233140655106, recall 0.4012345679012346, F1 0.2758481692979509, AUC 0.695095486111111
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7174272486772487{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.21782604070989733, "droprate_2": 0.0, "lr": 0.0004568847763725564, "weight_decay": 2.6886591305200685e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.091652274131775, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0874324736013934, Second Loss : 1.0799621441841718
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7371622474747475
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7481818181818182
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6778687169312171
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.710758377425044
epoch: 1 idx: 0 First Loss : 2.2171921730041504, Second Loss : 1.7591453790664673
epoch: 1 idx: 200 First Loss : 0.9830233640783462, Second Loss : 0.9705182257576368
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7233585858585858
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7308585858585858
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.720803020282187
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7115850970017638
epoch: 2 idx: 0 First Loss : 2.356635332107544, Second Loss : 2.320136308670044
epoch: 2 idx: 200 First Loss : 0.9421701277073343, Second Loss : 0.9331472858008164
  First-Tier acc 0.5520833333333334, precision 0.3873843999852622, recall 0.5230303030303031, F1 0.4147290974677667, AUC 0.6971054292929293
  Second-Tier acc 0.625, precision 0.40564373897707223, recall 0.5696969696969697, F1 0.4647435897435897, AUC 0.7240404040404039
  First-Tier acc 0.5153061224489796, precision 0.36575415995705846, recall 0.4292328042328042, F1 0.37148426622110825, AUC 0.6779238315696648
  Second-Tier acc 0.4897959183673469, precision 0.3383838383838384, recall 0.39947089947089953, F1 0.35042309606769534, AUC 0.6855158730158731
epoch: 3 idx: 0 First Loss : 3.422752857208252, Second Loss : 3.2601356506347656
epoch: 3 idx: 200 First Loss : 0.9302689558432544, Second Loss : 0.9190825474731142
  First-Tier acc 0.4114583333333333, precision 0.375266635450809, recall 0.4457575757575758, F1 0.3163641194729278, AUC 0.6888131313131313
  Second-Tier acc 0.4583333333333333, precision 0.36767676767676766, recall 0.46303030303030307, F1 0.3515151515151515, AUC 0.7307575757575758
  First-Tier acc 0.4642857142857143, precision 0.3867521367521367, recall 0.4184303350970017, F1 0.33916666666666667, AUC 0.6737213403880071
  Second-Tier acc 0.5102040816326531, precision 0.37753882915173237, recall 0.4347442680776014, F1 0.3703703703703704, AUC 0.6959325396825397
epoch: 4 idx: 0 First Loss : 3.537318468093872, Second Loss : 3.5118484497070312
epoch: 4 idx: 200 First Loss : 0.9171581944677775, Second Loss : 0.9093307775297013
  First-Tier acc 0.3854166666666667, precision 0.3717523975588492, recall 0.42909090909090913, F1 0.29490518284854933, AUC 0.709352904040404
  Second-Tier acc 0.4583333333333333, precision 0.40740740740740744, recall 0.48, F1 0.35422656699252447, AUC 0.7202020202020202
  First-Tier acc 0.47959183673469385, precision 0.420701496198185, recall 0.4420194003527336, F1 0.34934166903476366, AUC 0.6726913855820106
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6887676366843033
epoch: 5 idx: 0 First Loss : 3.4751720428466797, Second Loss : 3.5745859146118164
epoch: 5 idx: 200 First Loss : 0.9042804664381969, Second Loss : 0.8999875858055418
  First-Tier acc 0.3645833333333333, precision 0.37083333333333335, recall 0.41575757575757577, F1 0.2768865121806298, AUC 0.683153409090909
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7032323232323231
  First-Tier acc 0.4642857142857143, precision 0.4237179487179487, recall 0.435626102292769, F1 0.3364779874213837, AUC 0.6616202325837742
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.6906966490299823
epoch: 6 idx: 0 First Loss : 3.5971293449401855, Second Loss : 3.712569236755371
epoch: 6 idx: 200 First Loss : 0.9005404170504099, Second Loss : 0.8916091740870413
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6676357323232324
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.707929292929293
  First-Tier acc 0.44387755102040816, precision 0.4367378048780488, recall 0.4290123456790123, F1 0.3173160173160173, AUC 0.6449342757936508
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.7010030864197532
epoch: 7 idx: 0 First Loss : 3.512491226196289, Second Loss : 3.8132548332214355
epoch: 7 idx: 200 First Loss : 0.8991994215187094, Second Loss : 0.8883352111648555
  First-Tier acc 0.3385416666666667, precision 0.36782435129740515, recall 0.4033333333333333, F1 0.2510205371248025, AUC 0.6640561868686868
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6985858585858585
  First-Tier acc 0.4387755102040816, precision 0.4457831325301205, recall 0.4259259259259259, F1 0.3130957044000522, AUC 0.6596016589506173
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.7138447971781305
epoch: 8 idx: 0 First Loss : 3.549924373626709, Second Loss : 3.8689513206481934
epoch: 8 idx: 200 First Loss : 0.9022325832509396, Second Loss : 0.8950470386311037
  First-Tier acc 0.3645833333333333, precision 0.3799861973775018, recall 0.42, F1 0.2764227642276423, AUC 0.6620486111111111
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6924747474747474
  First-Tier acc 0.44387755102040816, precision 0.44646464646464645, recall 0.4290123456790123, F1 0.31761016526145597, AUC 0.6618751377865961
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.7008928571428572
epoch: 9 idx: 0 First Loss : 3.674964427947998, Second Loss : 4.146860599517822
epoch: 9 idx: 200 First Loss : 0.9008274294287708, Second Loss : 0.89520824181677
  First-Tier acc 0.3229166666666667, precision 0.35900178253119436, recall 0.3933333333333333, F1 0.23543230682804758, AUC 0.6538415404040404
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6758080808080807
  First-Tier acc 0.4030612244897959, precision 0.441233140655106, recall 0.404320987654321, F1 0.28007600253341774, AUC 0.6691192680776016
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7105930335097002{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_4", "train_show_freq": 200, "droprate": 0.19076054248332844, "droprate_2": 0.0, "lr": 0.0001526700337230491, "weight_decay": 2.4546580117278756e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 13, "gamma": 0.786921406640846, "T_max": 12, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_4", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0875217914581299, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0956187213015793, Second Loss : 1.082891389171579
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.759498106060606
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.751111111111111
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7241443452380952
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7218915343915344
epoch: 1 idx: 0 First Loss : 1.5399832725524902, Second Loss : 1.8784587383270264
epoch: 1 idx: 200 First Loss : 0.9938348989878127, Second Loss : 0.9863793707605618
  First-Tier acc 0.5572916666666666, precision 0.5135135135135135, recall 0.3863636363636364, F1 0.32542139662882696, AUC 0.7391161616161616
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7527272727272726
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.710968501984127
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7103725749559082
epoch: 2 idx: 0 First Loss : 2.2241458892822266, Second Loss : 2.5327086448669434
epoch: 2 idx: 200 First Loss : 0.949316383520169, Second Loss : 0.9513877604657145
  First-Tier acc 0.5729166666666666, precision 0.5436647445282129, recall 0.5620959595959596, F1 0.5258023032579288, AUC 0.7399368686868687
  Second-Tier acc 0.6458333333333334, precision 0.5994871794871796, recall 0.6043434343434344, F1 0.5992929292929293, AUC 0.7504040404040403
  First-Tier acc 0.5612244897959183, precision 0.5426989676989677, recall 0.5688932980599647, F1 0.5451139085351977, AUC 0.714781746031746
  Second-Tier acc 0.5510204081632653, precision 0.5235507246376812, recall 0.548721340388007, F1 0.5318518518518519, AUC 0.7221671075837742
epoch: 3 idx: 0 First Loss : 3.143819808959961, Second Loss : 3.1579043865203857
epoch: 3 idx: 200 First Loss : 0.9368830835400381, Second Loss : 0.9243363928494613
  First-Tier acc 0.4739583333333333, precision 0.516045799064667, recall 0.4995707070707071, F1 0.41107182399371406, AUC 0.7509375
  Second-Tier acc 0.4583333333333333, precision 0.37428160919540227, recall 0.4460606060606061, F1 0.3613821138211382, AUC 0.7785353535353536
  First-Tier acc 0.4846938775510204, precision 0.5247448235637212, recall 0.4486331569664903, F1 0.4118400258944041, AUC 0.7297488150352734
  Second-Tier acc 0.5714285714285714, precision 0.6211825860948669, recall 0.5304232804232805, F1 0.5174652141778334, AUC 0.7125220458553793
epoch: 4 idx: 0 First Loss : 4.209285736083984, Second Loss : 3.9405932426452637
epoch: 4 idx: 200 First Loss : 0.9459352731665328, Second Loss : 0.9227214517159879
  First-Tier acc 0.421875, precision 0.47142628205128206, recall 0.4698484848484849, F1 0.3758585995173278, AUC 0.747171717171717
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.7663131313131313
  First-Tier acc 0.45918367346938777, precision 0.48557206893977783, recall 0.4523258377425044, F1 0.41104377104377104, AUC 0.7220017636684304
  Second-Tier acc 0.4897959183673469, precision 0.3891129032258065, recall 0.42239858906525574, F1 0.36451335055986217, AUC 0.7500551146384481
epoch: 5 idx: 0 First Loss : 4.127101898193359, Second Loss : 4.105592727661133
epoch: 5 idx: 200 First Loss : 0.9406350423484596, Second Loss : 0.9174859705798105
  First-Tier acc 0.359375, precision 0.39551192145862557, recall 0.41179292929292927, F1 0.2955513468361549, AUC 0.7140214646464647
  Second-Tier acc 0.4166666666666667, precision 0.4843915343915344, recall 0.4677777777777778, F1 0.35794970161977835, AUC 0.7267676767676767
  First-Tier acc 0.4336734693877551, precision 0.46766816774556713, recall 0.41903659611992944, F1 0.36004883307965496, AUC 0.6957189704585538
  Second-Tier acc 0.5102040816326531, precision 0.5076388888888889, recall 0.4869929453262787, F1 0.4277220364176886, AUC 0.7277888007054673
epoch: 6 idx: 0 First Loss : 3.8259449005126953, Second Loss : 3.948549270629883
epoch: 6 idx: 200 First Loss : 0.9289508964240885, Second Loss : 0.9089679134718898
  First-Tier acc 0.359375, precision 0.4073015873015873, recall 0.42027777777777775, F1 0.28695543731293643, AUC 0.6853503787878786
  Second-Tier acc 0.375, precision 0.39351851851851855, recall 0.4266666666666667, F1 0.2974425102084677, AUC 0.6979797979797979
  First-Tier acc 0.42857142857142855, precision 0.47777861144457784, recall 0.4200837742504409, F1 0.3423176167018532, AUC 0.6902729552469135
  Second-Tier acc 0.5102040816326531, precision 0.5639880952380952, recall 0.5163139329805997, F1 0.45747486617051836, AUC 0.7391424162257496
epoch: 7 idx: 0 First Loss : 3.690382242202759, Second Loss : 3.9364495277404785
epoch: 7 idx: 200 First Loss : 0.920405515372598, Second Loss : 0.9022261576706182
  First-Tier acc 0.3541666666666667, precision 0.40758896151053015, recall 0.4169444444444444, F1 0.2807461884523318, AUC 0.6709059343434344
  Second-Tier acc 0.3125, precision 0.3631578947368421, recall 0.38666666666666666, F1 0.2385487528344671, AUC 0.6769696969696971
  First-Tier acc 0.42346938775510207, precision 0.47182795698924734, recall 0.4198633156966491, F1 0.33574231298704066, AUC 0.6931044697971783
  Second-Tier acc 0.42857142857142855, precision 0.45045045045045046, recall 0.40828924162257496, F1 0.32231559290382816, AUC 0.7230489417989417
epoch: 8 idx: 0 First Loss : 3.5174808502197266, Second Loss : 3.877668857574463
epoch: 8 idx: 200 First Loss : 0.9153003570460367, Second Loss : 0.900263583501604
  First-Tier acc 0.359375, precision 0.4184333759046403, recall 0.4238888888888889, F1 0.2955455731432264, AUC 0.6675189393939394
  Second-Tier acc 0.3333333333333333, precision 0.3768768768768769, recall 0.39999999999999997, F1 0.26030465949820786, AUC 0.6885858585858586
  First-Tier acc 0.42857142857142855, precision 0.4786286286286286, recall 0.42581569664903, F1 0.33996589940323957, AUC 0.6867938436948853
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.7175374779541445
epoch: 9 idx: 0 First Loss : 3.636277437210083, Second Loss : 3.914362668991089
epoch: 9 idx: 200 First Loss : 0.914807787721204, Second Loss : 0.8989659803094162
  First-Tier acc 0.3645833333333333, precision 0.4236466444197256, recall 0.4236111111111111, F1 0.28850741340515795, AUC 0.6663162878787877
  Second-Tier acc 0.2916666666666667, precision 0.34401709401709396, recall 0.37333333333333335, F1 0.21563218390804598, AUC 0.674949494949495
  First-Tier acc 0.4336734693877551, precision 0.4788969933566194, recall 0.4244378306878307, F1 0.32956564326003984, AUC 0.6831080522486772
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.7092151675485008