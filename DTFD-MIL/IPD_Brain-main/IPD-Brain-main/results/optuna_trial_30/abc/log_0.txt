{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_30", "train_show_freq": 200, "droprate": 0.37695553747853017, "droprate_2": 0.0, "lr": 2.8237010008021847e-05, "weight_decay": 1.3196382324611605e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_30", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.8237010008021847e-05
epoch: 0 idx: 0 First Loss : 1.237583875656128, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1201584903310187, Second Loss : 1.1022869974226501
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7163973063973064
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7525252525252526
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6630046051342348
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6523368606701939
Test AUC: 0.6523, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.8237010008021847e-05
epoch: 1 idx: 0 First Loss : 2.1576931476593018, Second Loss : 2.10227370262146
epoch: 1 idx: 200 First Loss : 1.0873983381547738, Second Loss : 1.0818261813316772
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7384455667789002
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7652525252525253
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7047508818342152
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7035383597883597
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.8237010008021847e-05
epoch: 2 idx: 0 First Loss : 2.2821733951568604, Second Loss : 2.243417739868164
epoch: 2 idx: 200 First Loss : 1.0537087835037886, Second Loss : 1.0479436866679595
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7383838383838385
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7535353535353536
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7116524593376446
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7046406525573191
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.8237010008021847e-05
epoch: 3 idx: 0 First Loss : 2.475609302520752, Second Loss : 2.4330387115478516
epoch: 3 idx: 200 First Loss : 1.0182614269393, Second Loss : 1.0163212582765526
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6388888888888888, precision 0.630371834811087, recall 0.5184175084175084, F1 0.5272230185273664, AUC 0.7318406285072951
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.75510101010101
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6122448979591837, precision 0.5465465465465466, recall 0.5263080540858319, F1 0.5027006172839507, AUC 0.6923684597295708
  Second-Tier acc 0.5510204081632653, precision 0.3377289377289377, recall 0.39065255731922394, F1 0.3600159299084031, AUC 0.6999559082892416
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.8237010008021847e-05
epoch: 4 idx: 0 First Loss : 2.7511940002441406, Second Loss : 2.689368486404419
epoch: 4 idx: 200 First Loss : 0.9835202077134925, Second Loss : 0.9873467482515236
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5555555555555556, precision 0.5485407066052227, recall 0.5146801346801347, F1 0.48598754380327164, AUC 0.7326879910213243
  Second-Tier acc 0.5833333333333334, precision 0.5395382395382397, recall 0.554949494949495, F1 0.5066263659614043, AUC 0.7470707070707071
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4965986394557823, precision 0.45814107287946637, recall 0.49713403880070545, F1 0.4377755489820187, AUC 0.7000232706251225
  Second-Tier acc 0.6530612244897959, precision 0.6456349206349207, recall 0.6677689594356261, F1 0.6462418300653595, AUC 0.7206790123456791
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.8237010008021847e-05
epoch: 5 idx: 0 First Loss : 3.039598226547241, Second Loss : 3.0080132484436035
epoch: 5 idx: 200 First Loss : 0.9555411442780672, Second Loss : 0.9631899004032956
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4652777777777778, precision 0.4851798528269116, recall 0.47050505050505054, F1 0.41509149217128843, AUC 0.7429741863075195
  Second-Tier acc 0.5, precision 0.5569518716577541, recall 0.5398989898989899, F1 0.49664235982367244, AUC 0.7605555555555555
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4841269841269842, recall 0.5248383303938859, F1 0.4247344595086686, AUC 0.7154247501469723
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7440476190476191
Test AUC: 0.7035, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.8237010008021847e-05
epoch: 6 idx: 0 First Loss : 3.2769834995269775, Second Loss : 3.2745416164398193
epoch: 6 idx: 200 First Loss : 0.9374964688232734, Second Loss : 0.9493008522011006
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4375, precision 0.49068100358422934, recall 0.4631986531986532, F1 0.3992004290380771, AUC 0.7521829405162738
  Second-Tier acc 0.4791666666666667, precision 0.5533138401559454, recall 0.541010101010101, F1 0.4794433902593295, AUC 0.7758080808080807
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.4824404761904762, recall 0.5121987066431511, F1 0.40679140679140685, AUC 0.7261353615520282
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7601410934744268
Test AUC: 0.7601, Test F1: 0.4984 (Best Epoch: 6)
Current LR: 2.8237010008021847e-05
epoch: 7 idx: 0 First Loss : 3.494999647140503, Second Loss : 3.4741311073303223
epoch: 7 idx: 200 First Loss : 0.9284231870791954, Second Loss : 0.9422843804888761
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4166666666666667, precision 0.48680851063829794, recall 0.4603367003367003, F1 0.38456233421750663, AUC 0.7573681257014591
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7927777777777778
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.4752815182297819, recall 0.49191651969429745, F1 0.3809471054921129, AUC 0.7327001273760532
  Second-Tier acc 0.5102040816326531, precision 0.5736185383244207, recall 0.6170634920634921, F1 0.5154954954954954, AUC 0.7685736331569665
Test AUC: 0.7686, Test F1: 0.5155 (Best Epoch: 7)
Current LR: 2.8237010008021847e-05
epoch: 8 idx: 0 First Loss : 3.580204963684082, Second Loss : 3.6077117919921875
epoch: 8 idx: 200 First Loss : 0.921417414868686, Second Loss : 0.9383362056316799
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.49108064278342917, recall 0.4587878787878788, F1 0.38418596981337066, AUC 0.7570426487093154
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8006060606060607
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.5263492063492063, recall 0.52336860670194, F1 0.4111004464141925, AUC 0.7422900744660003
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7887455908289241
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 9 idx: 0 First Loss : 3.6406755447387695, Second Loss : 3.6993987560272217
epoch: 9 idx: 200 First Loss : 0.9156155503906347, Second Loss : 0.9354365712786974
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4236111111111111, precision 0.5138761052073746, recall 0.5004040404040404, F1 0.41434097817076543, AUC 0.7585297418630752
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7997474747474748
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4557823129251701, precision 0.5704476314645807, recall 0.5748089359200471, F1 0.4574444263786794, AUC 0.7560748579267097
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7946979717813051
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 10 idx: 0 First Loss : 3.6866934299468994, Second Loss : 3.752047538757324
epoch: 10 idx: 200 First Loss : 0.909992844378344, Second Loss : 0.9324579358944178
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4583333333333333, precision 0.5465137201979308, recall 0.5525925925925926, F1 0.4559997523431136, AUC 0.7578507295173962
  Second-Tier acc 0.4166666666666667, precision 0.5122100122100122, recall 0.4916161616161616, F1 0.41061895228561895, AUC 0.7969191919191919
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5826042202779208, recall 0.5825984714873603, F1 0.4701340627016317, AUC 0.7604227905153831
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7971781305114639
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 11 idx: 0 First Loss : 3.693773031234741, Second Loss : 3.7647273540496826
epoch: 11 idx: 200 First Loss : 0.9038783010565653, Second Loss : 0.9289302157981794
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4305555555555556, precision 0.5264326287029047, recall 0.5155555555555555, F1 0.4296263800541054, AUC 0.7513299663299664
  Second-Tier acc 0.375, precision 0.46978021978021983, recall 0.43606060606060604, F1 0.3588461538461538, AUC 0.7917171717171717
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.46938775510204084, precision 0.5857142857142857, recall 0.5864197530864197, F1 0.4705882352941176, AUC 0.7657199196551048
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7982253086419752
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 12 idx: 0 First Loss : 3.6771128177642822, Second Loss : 3.7561745643615723
epoch: 12 idx: 200 First Loss : 0.897939180577665, Second Loss : 0.9259297902526714
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.4955862626740837, recall 0.4704713804713805, F1 0.38656633221850617, AUC 0.7466105499438832
  Second-Tier acc 0.375, precision 0.46978021978021983, recall 0.43606060606060604, F1 0.3588461538461538, AUC 0.7921212121212121
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5906956892872386, recall 0.5943562610229277, F1 0.47712271869652984, AUC 0.7667915931804821
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8019179894179894
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 13 idx: 0 First Loss : 3.6397647857666016, Second Loss : 3.723994493484497
epoch: 13 idx: 200 First Loss : 0.8924636246239191, Second Loss : 0.9232539452162956
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.375, precision 0.4840777118853472, recall 0.45676767676767677, F1 0.37170625073850877, AUC 0.7372390572390572
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7743939393939394
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5861635220125786, recall 0.5801734273956497, F1 0.46210900210900213, AUC 0.7681265922006663
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8055555555555555
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 14 idx: 0 First Loss : 3.593818426132202, Second Loss : 3.691330909729004
epoch: 14 idx: 200 First Loss : 0.8882059170105796, Second Loss : 0.9215502459677493
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.48257337526205446, recall 0.45845117845117844, F1 0.3694092701583338, AUC 0.7265151515151516
  Second-Tier acc 0.3958333333333333, precision 0.4706605222734255, recall 0.4688888888888889, F1 0.3602092352092352, AUC 0.7541919191919192
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5842063492063492, recall 0.5757642563198119, F1 0.44493714571034165, AUC 0.7676856750930825
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8015321869488536
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 15 idx: 0 First Loss : 3.5578696727752686, Second Loss : 3.6527576446533203
epoch: 15 idx: 200 First Loss : 0.8850553913565529, Second Loss : 0.9212510153814566
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.47344322344322337, recall 0.46050505050505053, F1 0.35819552954384415, AUC 0.709769921436588
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7232323232323233
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.580952380952381, recall 0.5656966490299823, F1 0.43533710952735527, AUC 0.7621497158534195
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7951940035273369
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 16 idx: 0 First Loss : 3.544389486312866, Second Loss : 3.6253933906555176
epoch: 16 idx: 200 First Loss : 0.883764035469535, Second Loss : 0.9228976683506386
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4682539682539682, recall 0.45124579124579123, F1 0.3500956621560511, AUC 0.7002469135802469
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.6991414141414141
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5854700854700855, recall 0.5736331569664903, F1 0.44134615384615383, AUC 0.7562953164805016
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7905643738977073
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 17 idx: 0 First Loss : 3.5109214782714844, Second Loss : 3.6047773361206055
epoch: 17 idx: 200 First Loss : 0.8819042288197844, Second Loss : 0.9240268231320324
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.47571354436948626, recall 0.4556902356902357, F1 0.35786042721611083, AUC 0.6886475869809203
  Second-Tier acc 0.3541666666666667, precision 0.44050179211469537, recall 0.44222222222222224, F1 0.3190476190476191, AUC 0.6956060606060607
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4421768707482993, precision 0.5798076923076924, recall 0.5597442680776014, F1 0.43361734253666956, AUC 0.7525842641583381
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7890762786596119
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 18 idx: 0 First Loss : 3.493565797805786, Second Loss : 3.601388931274414
epoch: 18 idx: 200 First Loss : 0.8809800951721943, Second Loss : 0.9252819163003411
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6833726150392817
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6867171717171717
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.577751572327044, recall 0.5556290417401528, F1 0.4257596300736939, AUC 0.7515738291201254
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7858245149911817
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.8237010008021847e-05
epoch: 19 idx: 0 First Loss : 3.470043897628784, Second Loss : 3.5779905319213867
epoch: 19 idx: 200 First Loss : 0.8787967453085799, Second Loss : 0.9257404698784097
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3472222222222222, precision 0.4578735965931087, recall 0.43188552188552193, F1 0.33629624460108093, AUC 0.6777609427609427
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6804040404040403
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.43537414965986393, precision 0.577751572327044, recall 0.5556290417401528, F1 0.4257596300736939, AUC 0.7488732118361746
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7822971781305115
Test AUC: 0.7887, Test F1: 0.5128 (Best Epoch: 8)