{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.25799914225488396, "droprate_2": 0.0, "lr": 7.263970947832869e-05, "weight_decay": 0.00016587601481340438, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 7.263970947832869e-05
epoch: 0 idx: 0 First Loss : 1.1498310565948486, Second Loss : 1.19991934299469
epoch: 0 idx: 200 First Loss : 1.10885161035393, Second Loss : 1.0854460046955603
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5009185606060607
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4926262626262627
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44367972883597884
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4604828042328042
 
 test auc: 0.4604828042328042, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.3877511385677501, "droprate_2": 0.0, "lr": 0.00024805638647176125, "weight_decay": 2.3353490931567776e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00024805638647176125
epoch: 0 idx: 0 First Loss : 1.1390538215637207, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.0729291916486636, Second Loss : 1.0875751803541065
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48744949494949497
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48085858585858593
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46497464726631393
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.445271164021164
 
 test auc: 0.445271164021164, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00024805638647176125
epoch: 1 idx: 0 First Loss : 1.4214890003204346, Second Loss : 1.631359338760376
epoch: 1 idx: 200 First Loss : 0.9573716884525261, Second Loss : 0.9869707290509447
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.4866919191919192
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.47787878787878785
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46677965167548513
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4603174603174603
 
 test auc: 0.445271164021164, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00024805638647176125
epoch: 2 idx: 0 First Loss : 2.068235397338867, Second Loss : 2.311537742614746
epoch: 2 idx: 200 First Loss : 0.9115267190618894, Second Loss : 0.9522395129153385
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2708333333333333, precision 0.24404761904761907, recall 0.22767676767676767, F1 0.22960243603972794, AUC 0.4730934343434343
  Second-Tier acc 0.20833333333333334, precision 0.2571428571428571, recall 0.22757575757575757, F1 0.23097643097643097, AUC 0.4633838383838384
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.3430426339738573, recall 0.4124779541446208, F1 0.28149368320160295, AUC 0.507922729276896
  Second-Tier acc 0.2857142857142857, precision 0.3277511961722488, recall 0.394620811287478, F1 0.29033189033189033, AUC 0.4849537037037037
 
 test auc: 0.445271164021164, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00024805638647176125
epoch: 3 idx: 0 First Loss : 2.9689979553222656, Second Loss : 3.549384117126465
epoch: 3 idx: 200 First Loss : 0.8876293092196927, Second Loss : 0.9403934234716184
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3020833333333333, precision 0.27231379731379735, recall 0.32656565656565656, F1 0.2713301536830949, AUC 0.5091792929292929
  Second-Tier acc 0.22916666666666666, precision 0.21061492114123695, recall 0.24595959595959596, F1 0.21968561173958476, AUC 0.47267676767676764
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.41836734693877553, precision 0.3595302619692864, recall 0.4551366843033509, F1 0.36901740517301157, AUC 0.5335923721340388
  Second-Tier acc 0.3877551020408163, precision 0.3850250626566416, recall 0.4448853615520281, F1 0.374615479266642, AUC 0.4715057319223986
 
 test auc: 0.445271164021164, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00024805638647176125
epoch: 4 idx: 0 First Loss : 3.3185617923736572, Second Loss : 4.061591148376465
epoch: 4 idx: 200 First Loss : 0.8858356479606336, Second Loss : 0.9438621322114706
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2916666666666667, precision 0.49576082106202585, recall 0.3877777777777778, F1 0.2294692961359628, AUC 0.5541919191919192
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.47141414141414145
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3979591836734694, precision 0.16049382716049382, recall 0.24074074074074073, F1 0.19259259259259257, AUC 0.49502590388007056
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4916776895943562
 
 test auc: 0.445271164021164, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00024805638647176125
epoch: 5 idx: 0 First Loss : 3.244213819503784, Second Loss : 3.940524101257324
epoch: 5 idx: 200 First Loss : 0.8798586363297197, Second Loss : 0.9390520542241466
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.5106837606837606, recall 0.42777777777777776, F1 0.29944444444444446, AUC 0.6520454545454546
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.5678787878787879
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.35714285714285715, precision 0.15555555555555556, recall 0.21604938271604937, F1 0.1808785529715762, AUC 0.43022486772486773
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4583333333333333
 
 test auc: 0.4583333333333333, test F1: 0.18627450980392157  :  from epoch 5
 current learn rate 0.00024805638647176125
epoch: 6 idx: 0 First Loss : 3.082562208175659, Second Loss : 3.8682897090911865
epoch: 6 idx: 200 First Loss : 0.8657856231586618, Second Loss : 0.9280845707888247
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3020833333333333, precision 0.5050200803212851, recall 0.39444444444444443, F1 0.24195526695526695, AUC 0.6809343434343434
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6515151515151515
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.37755102040816324, precision 0.1522633744855967, recall 0.22839506172839508, F1 0.18271604938271604, AUC 0.3860780423280423
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.39329805996472667
 
 test auc: 0.39329805996472667, test F1: 0.19999999999999998  :  from epoch 6
 current learn rate 0.00024805638647176125
epoch: 7 idx: 0 First Loss : 3.0715012550354004, Second Loss : 3.731569290161133
epoch: 7 idx: 200 First Loss : 0.8570220780927243, Second Loss : 0.9219881853271757
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6663005050505051
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.6562626262626262
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.37755102040816324, precision 0.1522633744855967, recall 0.22839506172839508, F1 0.18271604938271604, AUC 0.3948550485008819
  Second-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.39423500881834217
 
 test auc: 0.39423500881834217, test F1: 0.20657276995305163  :  from epoch 7
 current learn rate 0.00024805638647176125
epoch: 8 idx: 0 First Loss : 3.124197483062744, Second Loss : 3.659914255142212
epoch: 8 idx: 200 First Loss : 0.8515203646184363, Second Loss : 0.919507959748697
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3645833333333333, precision 0.47740740740740745, recall 0.4344444444444444, F1 0.309886359437407, AUC 0.6718055555555557
  Second-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.6694444444444444
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.1901901901901902, recall 0.2515432098765432, F1 0.21629901960784315, AUC 0.4117614638447972
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.40305335097001765
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 9 idx: 0 First Loss : 3.1713180541992188, Second Loss : 3.8578038215637207
epoch: 9 idx: 200 First Loss : 0.8381989120930868, Second Loss : 0.912574354095549
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.34375, precision 0.4693121693121693, recall 0.42111111111111105, F1 0.28855218855218856, AUC 0.6812247474747476
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.663989898989899
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.17179487179487182, recall 0.2368827160493827, F1 0.19827305311176277, AUC 0.4044449955908289
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4071318342151676
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 10 idx: 0 First Loss : 3.1364080905914307, Second Loss : 3.6194210052490234
epoch: 10 idx: 200 First Loss : 0.8282346668185792, Second Loss : 0.9056981212532771
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.34375, precision 0.5202380952380952, recall 0.42111111111111105, F1 0.28849651761561196, AUC 0.6763762626262627
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.6571717171717172
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.37755102040816324, precision 0.17570825798673897, recall 0.24305555555555555, F1 0.2026733500417711, AUC 0.40389384920634924
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.40613977072310403
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 11 idx: 0 First Loss : 3.116722345352173, Second Loss : 3.829822063446045
epoch: 11 idx: 200 First Loss : 0.8174278702525641, Second Loss : 0.9006785347778872
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3645833333333333, precision 0.5106837606837606, recall 0.4344444444444444, F1 0.30939068100358424, AUC 0.6603661616161617
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.647070707070707
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3979591836734694, precision 0.1820196264640709, recall 0.25540123456790126, F1 0.21064282673478077, AUC 0.41597773368606705
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4112103174603175
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 12 idx: 0 First Loss : 3.1673972606658936, Second Loss : 3.896019220352173
epoch: 12 idx: 200 First Loss : 0.8087854190322032, Second Loss : 0.8979579018798439
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.5069684183608234, recall 0.42777777777777776, F1 0.29894858338292846, AUC 0.6657323232323232
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6497474747474747
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.20595238095238097, recall 0.2762345679012346, F1 0.23349917081260363, AUC 0.42121362433862436
  Second-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4098875661375661
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 13 idx: 0 First Loss : 3.237516403198242, Second Loss : 3.936880350112915
epoch: 13 idx: 200 First Loss : 0.8002535284700136, Second Loss : 0.8918187950612129
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.5069684183608234, recall 0.42777777777777776, F1 0.29894858338292846, AUC 0.6637752525252526
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6452525252525253
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.19093187514240148, recall 0.2638888888888889, F1 0.22130134496546713, AUC 0.43044532627865956
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.41859567901234573
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 14 idx: 0 First Loss : 3.167847156524658, Second Loss : 3.943549871444702
epoch: 14 idx: 200 First Loss : 0.7907034589676657, Second Loss : 0.8830316089590713
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.4211098325022376, recall 0.4072222222222222, F1 0.26579739941207237, AUC 0.6542929292929293
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6412626262626263
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.19088319088319086, recall 0.2638888888888889, F1 0.22103386809269163, AUC 0.4390707671957672
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.43634259259259256
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 15 idx: 0 First Loss : 3.1763901710510254, Second Loss : 4.135466575622559
epoch: 15 idx: 200 First Loss : 0.7889734110812269, Second Loss : 0.8778016743160074
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.44365079365079363, recall 0.4605555555555556, F1 0.3435472739820566, AUC 0.6528787878787878
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6341414141414141
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35714285714285715, precision 0.1989010989010989, recall 0.27469135802469136, F1 0.23015873015873015, AUC 0.44895006613756605
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4334766313932981
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 16 idx: 0 First Loss : 3.246438980102539, Second Loss : 4.186280250549316
epoch: 16 idx: 200 First Loss : 0.7804519065687491, Second Loss : 0.8751615355226117
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4375, precision 0.38562091503267976, recall 0.4666666666666666, F1 0.34314314314314315, AUC 0.6476388888888889
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6404040404040403
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.20202020202020202, recall 0.28317901234567905, F1 0.23357487922705314, AUC 0.45323522927689597
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.45320767195767203
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 17 idx: 0 First Loss : 3.3261377811431885, Second Loss : 4.238306522369385
epoch: 17 idx: 200 First Loss : 0.7756592533588889, Second Loss : 0.8733479657971273
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4479166666666667, precision 0.38945273631840793, recall 0.47333333333333333, F1 0.35146067415730337, AUC 0.6443055555555556
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.642020202020202
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.20022808732486153, recall 0.28317901234567905, F1 0.23203309692671395, AUC 0.45903604497354494
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.46329365079365076
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 18 idx: 0 First Loss : 3.420931339263916, Second Loss : 4.276003360748291
epoch: 18 idx: 200 First Loss : 0.768753984875819, Second Loss : 0.8778929587308845
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4895833333333333, precision 0.38558743169398907, recall 0.4915151515151515, F1 0.3800568126163189, AUC 0.641199494949495
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6463131313131313
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.21871345029239767, recall 0.32716049382716045, F1 0.25139425139425137, AUC 0.46824018959435626
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4603725749559084
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00024805638647176125
epoch: 19 idx: 0 First Loss : 3.3534274101257324, Second Loss : 4.205348491668701
epoch: 19 idx: 200 First Loss : 0.7652979973609964, Second Loss : 0.8718576834087276
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.5208333333333334, precision 0.37121212121212127, recall 0.503030303030303, F1 0.3953823953823954, AUC 0.6207323232323233
  Second-Tier acc 0.22916666666666666, precision 0.08148148148148147, recall 0.3333333333333333, F1 0.13095238095238096, AUC 0.6033333333333334
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.336734693877551, precision 0.22136970730321112, recall 0.3209876543209877, F1 0.24475166410650281, AUC 0.4841820987654321
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4737654320987655
 
 test auc: 0.40305335097001765, test F1: 0.1932367149758454  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.4035879456612983, "droprate_2": 0.0, "lr": 2.5271878549668073e-05, "weight_decay": 0.00024926282692471505, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.5271878549668073e-05
epoch: 0 idx: 0 First Loss : 1.2617707252502441, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.112721311957089, Second Loss : 1.0966083531949058
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7066666666666667
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7548989898989898
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6529186262982559
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6525022045855379
Test AUC: 0.6525, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.5271878549668073e-05
epoch: 1 idx: 0 First Loss : 2.1718637943267822, Second Loss : 2.1042397022247314
epoch: 1 idx: 200 First Loss : 1.0905571334545885, Second Loss : 1.0865091827526614
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7312962962962963
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7644949494949494
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7000355183225554
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.704916225749559
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5271878549668073e-05
epoch: 2 idx: 0 First Loss : 2.29111909866333, Second Loss : 2.230583429336548
epoch: 2 idx: 200 First Loss : 1.0599941414461207, Second Loss : 1.056731861399774
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7389506172839506
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530303030303029
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7147327552420144
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7111441798941799
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5271878549668073e-05
epoch: 3 idx: 0 First Loss : 2.4378583431243896, Second Loss : 2.38897442817688
epoch: 3 idx: 200 First Loss : 1.0280499150281521, Second Loss : 1.0267772304255571
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5694444444444444, precision 0.5814876338132152, recall 0.4128282828282828, F1 0.3826346950200008, AUC 0.7346689113355779
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7509595959595959
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6054421768707483, precision 0.8609112709832134, recall 0.4384920634920635, F1 0.41149605583213983, AUC 0.7112544091710759
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7092702821869489
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5271878549668073e-05
epoch: 4 idx: 0 First Loss : 2.640253782272339, Second Loss : 2.6101512908935547
epoch: 4 idx: 200 First Loss : 0.9933445929591336, Second Loss : 0.9979619255928851
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6111111111111112, precision 0.5455084359325125, recall 0.5182154882154882, F1 0.5148034530267803, AUC 0.7311503928170594
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7515151515151516
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5238095238095238, precision 0.4515440115440115, recall 0.49404761904761907, F1 0.4523776275474581, AUC 0.7093070252792475
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7080026455026456
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5271878549668073e-05
epoch: 5 idx: 0 First Loss : 2.8853933811187744, Second Loss : 2.876864433288574
epoch: 5 idx: 200 First Loss : 0.9632159082117069, Second Loss : 0.9732106193640635
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5277777777777778, precision 0.5274726003768277, recall 0.5008754208754209, F1 0.4603512479871175, AUC 0.7317171717171718
  Second-Tier acc 0.5416666666666666, precision 0.5625, recall 0.5571717171717172, F1 0.5161440185830429, AUC 0.7502020202020203
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.4793109105824446, recall 0.5318195179306291, F1 0.44406997271705984, AUC 0.7141571134626691
  Second-Tier acc 0.6326530612244898, precision 0.6301169590643275, recall 0.6911375661375662, F1 0.6373737373737373, AUC 0.7291666666666666
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5271878549668073e-05
epoch: 6 idx: 0 First Loss : 3.1254796981811523, Second Loss : 3.1442017555236816
epoch: 6 idx: 200 First Loss : 0.9415945506640779, Second Loss : 0.956390288968881
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4583333333333333, precision 0.4942632850241546, recall 0.4708754208754209, F1 0.40966572439786725, AUC 0.7359483726150393
  Second-Tier acc 0.5208333333333334, precision 0.5838468720821662, recall 0.5846464646464646, F1 0.5220032840722496, AUC 0.778989898989899
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.42857142857142855, precision 0.4858058608058608, recall 0.5086713697824808, F1 0.4044893378226711, AUC 0.7239981383499902
  Second-Tier acc 0.5102040816326531, precision 0.5389499389499389, recall 0.605599647266314, F1 0.5219461697722567, AUC 0.7616843033509699
Test AUC: 0.7617, Test F1: 0.5219 (Best Epoch: 6)
Current LR: 2.5271878549668073e-05
epoch: 7 idx: 0 First Loss : 3.299168348312378, Second Loss : 3.33376145362854
epoch: 7 idx: 200 First Loss : 0.9296898531463387, Second Loss : 0.9468876150951012
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4375, precision 0.4996370235934664, recall 0.468013468013468, F1 0.3985779811431547, AUC 0.7398540965207632
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.789141414141414
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.40816326530612246, precision 0.4706349206349207, recall 0.49632569077013516, F1 0.38818342151675483, AUC 0.7301954732510287
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7647156084656085
Test AUC: 0.7647, Test F1: 0.5178 (Best Epoch: 7)
Current LR: 2.5271878549668073e-05
epoch: 8 idx: 0 First Loss : 3.4258005619049072, Second Loss : 3.4868762493133545
epoch: 8 idx: 200 First Loss : 0.9199804540686495, Second Loss : 0.9410124385905503
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.46572321149640733, recall 0.44013468013468016, F1 0.3610070631123263, AUC 0.7427833894500561
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.8006565656565656
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.4932950191570881, recall 0.49191651969429745, F1 0.38112073112073114, AUC 0.7361907211444249
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.769620811287478
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 9 idx: 0 First Loss : 3.523988723754883, Second Loss : 3.5994114875793457
epoch: 9 idx: 200 First Loss : 0.9134045311235892, Second Loss : 0.9367346072671425
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.46742724867724866, recall 0.42764309764309766, F1 0.3482323232323232, AUC 0.7457744107744109
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.7961111111111111
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4013605442176871, precision 0.5194645247657296, recall 0.5074955908289241, F1 0.3950109320904203, AUC 0.7469993141289438
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7768959435626103
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 10 idx: 0 First Loss : 3.5811526775360107, Second Loss : 3.677882432937622
epoch: 10 idx: 200 First Loss : 0.9075086618152758, Second Loss : 0.9329855274663895
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.4486839780957428, recall 0.41070707070707074, F1 0.3268461007591442, AUC 0.7477497194163861
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7934343434343435
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.5313938681555491, recall 0.5172692533803644, F1 0.3951557488039866, AUC 0.7539866255144033
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7881944444444445
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 11 idx: 0 First Loss : 3.596472978591919, Second Loss : 3.714294195175171
epoch: 11 idx: 200 First Loss : 0.9018602806053111, Second Loss : 0.9291252383327492
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.48271604938271606, recall 0.45555555555555555, F1 0.3724841466776951, AUC 0.7462401795735131
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7857575757575758
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5517712334613744, recall 0.5427689594356261, F1 0.42222505931292753, AUC 0.758757103664511
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.7880842151675486
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 12 idx: 0 First Loss : 3.592458486557007, Second Loss : 3.735762357711792
epoch: 12 idx: 200 First Loss : 0.8962813913764256, Second Loss : 0.9259315737828946
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.5132303426421073, recall 0.5032996632996632, F1 0.41065241789879475, AUC 0.7443490460157127
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.776060606060606
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5712365591397849, recall 0.5685626102292769, F1 0.450988995861618, AUC 0.7620456104252401
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7920524691358025
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 13 idx: 0 First Loss : 3.5805768966674805, Second Loss : 3.7356748580932617
epoch: 13 idx: 200 First Loss : 0.8914556348903697, Second Loss : 0.9223846477787683
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.4946021571021571, recall 0.4727609427609427, F1 0.3859421656451359, AUC 0.7403142536475871
  Second-Tier acc 0.3958333333333333, precision 0.48773448773448774, recall 0.4663636363636363, F1 0.3745581477553906, AUC 0.7604040404040404
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5807271802695143, recall 0.5784832451499118, F1 0.46402611762088886, AUC 0.7644767783656672
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7928240740740741
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 14 idx: 0 First Loss : 3.528546094894409, Second Loss : 3.7116549015045166
epoch: 14 idx: 200 First Loss : 0.8859581174520053, Second Loss : 0.9194727451453653
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.47347756410256414, recall 0.43969696969696975, F1 0.35814058956916095, AUC 0.7295903479236813
  Second-Tier acc 0.3541666666666667, precision 0.4463203463203463, recall 0.4082828282828283, F1 0.32931247790738777, AUC 0.7474242424242424
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5748792270531401, recall 0.5661375661375662, F1 0.44210444210444216, AUC 0.764237948265726
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7824074074074074
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 15 idx: 0 First Loss : 3.4730184078216553, Second Loss : 3.6799612045288086
epoch: 15 idx: 200 First Loss : 0.8809451490318616, Second Loss : 0.9178161169755602
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.47877320419693303, recall 0.45148148148148143, F1 0.36461704422869473, AUC 0.7196969696969697
  Second-Tier acc 0.3541666666666667, precision 0.4463203463203463, recall 0.4082828282828283, F1 0.32931247790738777, AUC 0.7401515151515152
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.5674385294819766, recall 0.5481334509112287, F1 0.4275487356686997, AUC 0.7634357240838723
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7788249559082893
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 16 idx: 0 First Loss : 3.4097464084625244, Second Loss : 3.635193109512329
epoch: 16 idx: 200 First Loss : 0.8766889903072931, Second Loss : 0.9169721897993821
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.47158089781627616, recall 0.44787878787878793, F1 0.3561486906549, AUC 0.7080527497194163
  Second-Tier acc 0.3333333333333333, precision 0.432508104921898, recall 0.394949494949495, F1 0.31086021505376343, AUC 0.7177777777777777
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5685318473802338, recall 0.5478395061728395, F1 0.4190959490134451, AUC 0.7585427689594356
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7768408289241623
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 17 idx: 0 First Loss : 3.353062391281128, Second Loss : 3.5847721099853516
epoch: 17 idx: 200 First Loss : 0.8735273632580595, Second Loss : 0.9165255427198364
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.4604948444169785, recall 0.4293602693602694, F1 0.3417464322974249, AUC 0.7000280583613918
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7028282828282828
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5731481481481481, recall 0.5557760141093474, F1 0.42455096073517123, AUC 0.7540356163041348
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7710537918871253
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 18 idx: 0 First Loss : 3.3094098567962646, Second Loss : 3.548495054244995
epoch: 18 idx: 200 First Loss : 0.8714563024189179, Second Loss : 0.9175936187558404
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4691697191697191, recall 0.4504040404040404, F1 0.3521895235378381, AUC 0.6888832772166106
  Second-Tier acc 0.3333333333333333, precision 0.43143939393939396, recall 0.41191919191919196, F1 0.301898663071565, AUC 0.6855555555555556
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.5731481481481481, recall 0.5557760141093474, F1 0.42455096073517123, AUC 0.7502204585537919
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7728174603174603
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.5271878549668073e-05
epoch: 19 idx: 0 First Loss : 3.283224105834961, Second Loss : 3.5356767177581787
epoch: 19 idx: 200 First Loss : 0.8695472478847753, Second Loss : 0.9192706332976388
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4635714285714286, recall 0.4411447811447811, F1 0.344316465911745, AUC 0.6831088664421997
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.44222222222222224, F1 0.31616161616161614, AUC 0.6781818181818181
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5741447713152182, recall 0.5554820693709582, F1 0.4151312328816818, AUC 0.7480587399568881
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7754629629629629
Test AUC: 0.7696, Test F1: 0.5128 (Best Epoch: 8){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.39523755872474153, "droprate_2": 0.0, "lr": 1.9371761763817205e-05, "weight_decay": 2.948311435805833e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.9371761763817205e-05
epoch: 0 idx: 0 First Loss : 1.2472323179244995, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0936313701506277, Second Loss : 1.0767040870972533
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6961616161616161
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7498989898989898
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6388031550068587
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6399360670194003
Test AUC: 0.6399, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.9371761763817205e-05
epoch: 1 idx: 0 First Loss : 2.1358630657196045, Second Loss : 2.060716152191162
epoch: 1 idx: 200 First Loss : 1.1012915444018236, Second Loss : 1.0930956429361705
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7267396184062851
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7647979797979798
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6885410542817949
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6992945326278659
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 2 idx: 0 First Loss : 2.2374026775360107, Second Loss : 2.1647322177886963
epoch: 2 idx: 200 First Loss : 1.0773118964549322, Second Loss : 1.0697895248434437
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7394781144781145
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.761010101010101
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.707273907505389
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7077821869488536
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 3 idx: 0 First Loss : 2.3421144485473633, Second Loss : 2.2869248390197754
epoch: 3 idx: 200 First Loss : 1.0550140875637235, Second Loss : 1.0482698310148064
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5347222222222222, precision 0.5106382978723404, recall 0.35353535353535354, F1 0.2695767195767196, AUC 0.7380471380471381
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7534848484848484
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134467470115619
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7080577601410935
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 4 idx: 0 First Loss : 2.483389139175415, Second Loss : 2.4304537773132324
epoch: 4 idx: 200 First Loss : 1.0304146357140138, Second Loss : 1.0254757033281066
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6388888888888888, precision 0.6975524475524475, recall 0.5152861952861953, F1 0.5267404834274135, AUC 0.7386251402918069
  Second-Tier acc 0.625, precision 0.41052631578947363, recall 0.5018181818181818, F1 0.4444444444444444, AUC 0.7565151515151515
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6462585034013606, precision 0.736904761904762, recall 0.5137419165196943, F1 0.5049034578709831, AUC 0.7003233392122281
  Second-Tier acc 0.6122448979591837, precision 0.36481481481481487, recall 0.41622574955908287, F1 0.3746484966471988, AUC 0.7069554673721341
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 5 idx: 0 First Loss : 2.6528425216674805, Second Loss : 2.61899995803833
epoch: 5 idx: 200 First Loss : 1.0021368537413244, Second Loss : 1.0014091885430896
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5972222222222222, precision 0.5409214323688007, recall 0.5246127946127945, F1 0.5205642310905468, AUC 0.7323793490460156
  Second-Tier acc 0.6666666666666666, precision 0.6493477282950967, recall 0.6082828282828283, F1 0.5633986928104574, AUC 0.7535858585858586
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5306122448979592, precision 0.4718003718003718, recall 0.5155790711346268, F1 0.47348338119726624, AUC 0.7044630609445424
  Second-Tier acc 0.6326530612244898, precision 0.5963768115942029, recall 0.5967813051146384, F1 0.5852100840336135, AUC 0.7177579365079364
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 6 idx: 0 First Loss : 2.84710431098938, Second Loss : 2.8307740688323975
epoch: 6 idx: 200 First Loss : 0.976145814696503, Second Loss : 0.9796423621253291
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5347222222222222, precision 0.5198846960167715, recall 0.510976430976431, F1 0.473759154562726, AUC 0.7339730639730639
  Second-Tier acc 0.5625, precision 0.5652056277056278, recall 0.584949494949495, F1 0.5438096500530223, AUC 0.7588383838383838
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.47404794210764356, recall 0.5220458553791887, F1 0.4419547382672932, AUC 0.7118055555555557
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7291666666666666
Test AUC: 0.6993, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9371761763817205e-05
epoch: 7 idx: 0 First Loss : 3.029015302658081, Second Loss : 3.0388054847717285
epoch: 7 idx: 200 First Loss : 0.9557433605509166, Second Loss : 0.9627769940731982
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4583333333333333, precision 0.4942632850241546, recall 0.4708754208754209, F1 0.40966572439786725, AUC 0.7363860830527497
  Second-Tier acc 0.5208333333333334, precision 0.5796296296296296, recall 0.5821212121212122, F1 0.5198481116584565, AUC 0.7812121212121212
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.5024691358024692, recall 0.5286596119929453, F1 0.4291240160805378, AUC 0.7198155496766607
  Second-Tier acc 0.5306122448979592, precision 0.5480889724310777, recall 0.6179453262786596, F1 0.5349223946784923, AUC 0.7611331569664902
Test AUC: 0.7611, Test F1: 0.5349 (Best Epoch: 7)
Current LR: 1.9371761763817205e-05
epoch: 8 idx: 0 First Loss : 3.180063247680664, Second Loss : 3.2038607597351074
epoch: 8 idx: 200 First Loss : 0.9423280972570404, Second Loss : 0.9514171567407266
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4375, precision 0.4996370235934664, recall 0.468013468013468, F1 0.3985779811431547, AUC 0.740544332210999
  Second-Tier acc 0.5, precision 0.5687830687830687, recall 0.5687878787878787, F1 0.49960046714610606, AUC 0.7980808080808081
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.47673248161053045, recall 0.5042621987066431, F1 0.3976240391334731, AUC 0.7283705663335294
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.765652557319224
Test AUC: 0.7657, Test F1: 0.4984 (Best Epoch: 8)
Current LR: 1.9371761763817205e-05
epoch: 9 idx: 0 First Loss : 3.2911269664764404, Second Loss : 3.3419036865234375
epoch: 9 idx: 200 First Loss : 0.9325321468140059, Second Loss : 0.9437094166856351
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.4780676328502415, recall 0.45023569023569027, F1 0.37304473304473307, AUC 0.7452525252525253
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.8041919191919192
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.4897871054108909, recall 0.503968253968254, F1 0.3955637145824062, AUC 0.7355170977856164
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7729276895943563
Test AUC: 0.7729, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 1.9371761763817205e-05
epoch: 10 idx: 0 First Loss : 3.3769171237945557, Second Loss : 3.4548697471618652
epoch: 10 idx: 200 First Loss : 0.9254569405902974, Second Loss : 0.9384421512521618
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3958333333333333, precision 0.48114119922630566, recall 0.4421885521885522, F1 0.3660612836546587, AUC 0.749438832772166
  Second-Tier acc 0.5208333333333334, precision 0.5924185463659147, recall 0.6160606060606061, F1 0.5224625285109156, AUC 0.8138383838383838
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.5178984414278532, recall 0.5036743092298647, F1 0.3928839173630394, AUC 0.7417817950225358
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7857694003527337
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 11 idx: 0 First Loss : 3.4345109462738037, Second Loss : 3.5408921241760254
epoch: 11 idx: 200 First Loss : 0.919403067947509, Second Loss : 0.9342765773215623
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3819444444444444, precision 0.4754191991034096, recall 0.4397979797979798, F1 0.3604797855998954, AUC 0.7522446689113357
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.8105050505050505
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.534189802046945, recall 0.5351263962375074, F1 0.42023373451944884, AUC 0.7467237409367039
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7955798059964726
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 12 idx: 0 First Loss : 3.468066453933716, Second Loss : 3.602694272994995
epoch: 12 idx: 200 First Loss : 0.9135163421198188, Second Loss : 0.9303045343626198
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.5028860028860028, recall 0.4858585858585858, F1 0.39833917037429006, AUC 0.7512457912457912
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8083333333333335
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.5580380071905495, recall 0.5488683127572016, F1 0.4365642389481666, AUC 0.7509981873407799
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7954144620811286
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 13 idx: 0 First Loss : 3.478382110595703, Second Loss : 3.6402587890625
epoch: 13 idx: 200 First Loss : 0.9078245605990772, Second Loss : 0.9262396727980517
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4027777777777778, precision 0.5024964371713597, recall 0.4839393939393939, F1 0.3971865220429618, AUC 0.7528843995510662
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.8012626262626262
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4557823129251701, precision 0.5769489247311829, recall 0.5824514991181657, F1 0.4577677224736048, AUC 0.7586346266901822
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7989417989417991
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 14 idx: 0 First Loss : 3.4624321460723877, Second Loss : 3.648606061935425
epoch: 14 idx: 200 First Loss : 0.9024273536876956, Second Loss : 0.9224202946785245
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.5014073118807828, recall 0.4837037037037037, F1 0.3934149098235786, AUC 0.7543490460157126
  Second-Tier acc 0.3958333333333333, precision 0.5, recall 0.47828282828282837, F1 0.38887840868599216, AUC 0.7991919191919191
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.47619047619047616, precision 0.5903890160183066, recall 0.5943562610229277, F1 0.4760381296329008, AUC 0.7625783852635705
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7991622574955907
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 15 idx: 0 First Loss : 3.431110382080078, Second Loss : 3.6451351642608643
epoch: 15 idx: 200 First Loss : 0.8979097449143106, Second Loss : 0.9191797239617885
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.5014412997903563, recall 0.4862289562289563, F1 0.39188118027069335, AUC 0.7481762065095398
  Second-Tier acc 0.375, precision 0.47222222222222227, recall 0.45303030303030306, F1 0.3534618410700236, AUC 0.7934343434343435
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5885311871227364, recall 0.5902410346854792, F1 0.4697713134145273, AUC 0.7657382912012541
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.8060515873015873
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 16 idx: 0 First Loss : 3.39151668548584, Second Loss : 3.6258206367492676
epoch: 16 idx: 200 First Loss : 0.8935401969929851, Second Loss : 0.9167341005349003
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3819444444444444, precision 0.48766642162868573, recall 0.4781818181818182, F1 0.3748042219952332, AUC 0.7432154882154882
  Second-Tier acc 0.3958333333333333, precision 0.48333333333333334, recall 0.48333333333333334, F1 0.3697220036716496, AUC 0.7815656565656566
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5893273393273394, recall 0.583994708994709, F1 0.46154825566590274, AUC 0.7674713403880071
  Second-Tier acc 0.4897959183673469, precision 0.5952380952380952, recall 0.5804673721340388, F1 0.4792462439521263, AUC 0.8067129629629631
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 17 idx: 0 First Loss : 3.342622756958008, Second Loss : 3.598541259765625
epoch: 17 idx: 200 First Loss : 0.8892192469692015, Second Loss : 0.9149163680641091
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.5040637860082305, recall 0.5036700336700336, F1 0.39340016708437764, AUC 0.7369248035914703
  Second-Tier acc 0.3958333333333333, precision 0.48333333333333334, recall 0.48333333333333334, F1 0.3697220036716496, AUC 0.7674242424242422
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4557823129251701, precision 0.5860014892032762, recall 0.5739271017048795, F1 0.45195479844830494, AUC 0.7651197824808934
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.8055004409171076
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 18 idx: 0 First Loss : 3.287768602371216, Second Loss : 3.5530898571014404
epoch: 18 idx: 200 First Loss : 0.8855368474105128, Second Loss : 0.9132188344200545
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3958333333333333, precision 0.4980280228334199, recall 0.4944107744107744, F1 0.385518887142774, AUC 0.7275533108866442
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7512121212121213
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.5684523809523809, recall 0.5319664902998237, F1 0.4176587301587302, AUC 0.7649973055065648
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8034611992945327
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9371761763817205e-05
epoch: 19 idx: 0 First Loss : 3.2308342456817627, Second Loss : 3.503791570663452
epoch: 19 idx: 200 First Loss : 0.8828420537168887, Second Loss : 0.9120797613271934
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.46766345334120274, recall 0.4569023569023569, F1 0.3477708043644381, AUC 0.7164646464646465
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7332828282828284
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5620358781810596, recall 0.5180776014109347, F1 0.4088504121843924, AUC 0.7611086615716246
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7993276014109347
Test AUC: 0.7858, Test F1: 0.4919 (Best Epoch: 10){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.00813991022990862, "droprate_2": 0.0, "lr": 7.709066166749992e-05, "weight_decay": 0.00013045149183084581, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 7.709066166749992e-05
epoch: 0 idx: 0 First Loss : 1.152004599571228, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1065892328077287, Second Loss : 1.1145617027039552
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.757003367003367
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7520202020202019
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6976104742308445
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6949404761904763
Test AUC: 0.6949, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 7.709066166749992e-05
epoch: 1 idx: 0 First Loss : 1.9686444997787476, Second Loss : 2.029494524002075
epoch: 1 idx: 200 First Loss : 1.017931784711667, Second Loss : 1.0190740874157616
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5625, precision 0.4253816359079517, recall 0.40525252525252525, F1 0.35518648018648014, AUC 0.7426374859708194
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7491919191919191
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5578231292517006, precision 0.27214452214452217, recall 0.3412698412698412, F1 0.25556418219461696, AUC 0.7100541348226533
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7130180776014109
Test AUC: 0.6949, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 7.709066166749992e-05
epoch: 2 idx: 0 First Loss : 2.305570363998413, Second Loss : 2.4043421745300293
epoch: 2 idx: 200 First Loss : 0.9681051787897129, Second Loss : 0.9686189062930458
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5763888888888888, precision 0.502415458937198, recall 0.5369023569023569, F1 0.46012293806411453, AUC 0.7388720538720538
  Second-Tier acc 0.625, precision 0.5454212454212455, recall 0.545151515151515, F1 0.5336191156624593, AUC 0.7634343434343434
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5918367346938775, precision 0.5752519454011992, recall 0.5470311581422692, F1 0.5426627202328137, AUC 0.7112360376249264
  Second-Tier acc 0.6122448979591837, precision 0.5855614973262032, recall 0.6201499118165784, F1 0.5964206471118914, AUC 0.7366071428571428
Test AUC: 0.7366, Test F1: 0.5964 (Best Epoch: 2)
Current LR: 7.709066166749992e-05
epoch: 3 idx: 0 First Loss : 2.919377088546753, Second Loss : 3.0186197757720947
epoch: 3 idx: 200 First Loss : 0.9404466168871567, Second Loss : 0.9362680593607438
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4861111111111111, precision 0.52487922705314, recall 0.5071717171717172, F1 0.45669110137170493, AUC 0.7499438832772167
  Second-Tier acc 0.5208333333333334, precision 0.5611111111111111, recall 0.5676767676767677, F1 0.5211940050649728, AUC 0.7694949494949496
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5238095238095238, precision 0.5629493962827296, recall 0.568342151675485, F1 0.5285349912322653, AUC 0.7406488830099941
  Second-Tier acc 0.5510204081632653, precision 0.5789196310935442, recall 0.6124338624338624, F1 0.5631646684278263, AUC 0.7504409171075838
Test AUC: 0.7504, Test F1: 0.5632 (Best Epoch: 3)
Current LR: 7.709066166749992e-05
epoch: 4 idx: 0 First Loss : 3.46352481842041, Second Loss : 3.533877372741699
epoch: 4 idx: 200 First Loss : 0.936174610101465, Second Loss : 0.9283608949803446
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.4967861464004839, recall 0.4696969696969697, F1 0.38802244267360547, AUC 0.7583221099887766
  Second-Tier acc 0.5208333333333334, precision 0.5663780663780664, recall 0.5846464646464646, F1 0.5238095238095238, AUC 0.7804040404040404
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5034013605442177, precision 0.5771074803332867, recall 0.5360082304526749, F1 0.49057829759584143, AUC 0.7502327062512247
  Second-Tier acc 0.5510204081632653, precision 0.5789196310935442, recall 0.6124338624338624, F1 0.5631646684278263, AUC 0.7497244268077602
Test AUC: 0.7497, Test F1: 0.5632 (Best Epoch: 4)
Current LR: 7.709066166749992e-05
epoch: 5 idx: 0 First Loss : 3.8037965297698975, Second Loss : 3.8013579845428467
epoch: 5 idx: 200 First Loss : 0.9375202970125189, Second Loss : 0.9291939834892675
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4305555555555556, precision 0.5148148148148147, recall 0.48774410774410776, F1 0.41332847502144493, AUC 0.7641245791245792
  Second-Tier acc 0.4583333333333333, precision 0.5093240093240093, recall 0.5038383838383839, F1 0.4447708578143361, AUC 0.7851010101010102
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.5632838851229657, recall 0.5334362139917695, F1 0.46812436401976293, AUC 0.7549664413090339
  Second-Tier acc 0.5306122448979592, precision 0.6025641025641025, recall 0.593694885361552, F1 0.5222436722436723, AUC 0.757991622574956
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 6 idx: 0 First Loss : 3.871129274368286, Second Loss : 3.9394049644470215
epoch: 6 idx: 200 First Loss : 0.9353344149456652, Second Loss : 0.9283205967104591
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4236111111111111, precision 0.5060536398467433, recall 0.48895622895622887, F1 0.4051657285803627, AUC 0.756156004489338
  Second-Tier acc 0.4583333333333333, precision 0.5093240093240093, recall 0.5038383838383839, F1 0.4447708578143361, AUC 0.7672727272727272
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.575541058299679, recall 0.5390946502057613, F1 0.4594619913910802, AUC 0.7448314716833235
  Second-Tier acc 0.5102040816326531, precision 0.5873015873015873, recall 0.5634920634920635, F1 0.4904761904761905, AUC 0.7626212522045854
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 7 idx: 0 First Loss : 3.9449026584625244, Second Loss : 3.9378511905670166
epoch: 7 idx: 200 First Loss : 0.9345449096666862, Second Loss : 0.9247760255693629
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.479547480540009, recall 0.46996632996633, F1 0.3860084574370289, AUC 0.729915824915825
  Second-Tier acc 0.4375, precision 0.5030864197530863, recall 0.493030303030303, F1 0.4156346749226006, AUC 0.7323737373737375
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.5635054246165357, recall 0.5250587889476778, F1 0.4432875368159735, AUC 0.7345740250832843
  Second-Tier acc 0.5102040816326531, precision 0.584045584045584, recall 0.5634920634920635, F1 0.48877274487030586, AUC 0.7651565255731922
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 8 idx: 0 First Loss : 3.898822069168091, Second Loss : 3.9763259887695312
epoch: 8 idx: 200 First Loss : 0.9275258045205708, Second Loss : 0.9209472163156398
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.4758008939295489, recall 0.45663299663299667, F1 0.3663991539131517, AUC 0.7088439955106622
  Second-Tier acc 0.4375, precision 0.5014245014245015, recall 0.493030303030303, F1 0.41704292527821935, AUC 0.7112626262626263
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.5423868312757202, recall 0.4852292768959436, F1 0.4115567754143014, AUC 0.7217016950813248
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7614087301587301
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 9 idx: 0 First Loss : 3.880051374435425, Second Loss : 3.950082540512085
epoch: 9 idx: 200 First Loss : 0.9243776422331054, Second Loss : 0.9154645929689894
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.464710627142569, recall 0.45915824915824915, F1 0.3543160181458054, AUC 0.6941863075196409
  Second-Tier acc 0.3958333333333333, precision 0.4679487179487179, recall 0.4688888888888889, F1 0.3663675213675213, AUC 0.6946464646464646
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.5068440331598226, recall 0.4193121693121693, F1 0.35114178407896574, AUC 0.7097724377816971
  Second-Tier acc 0.42857142857142855, precision 0.5225464190981431, recall 0.45546737213403876, F1 0.3867934770807548, AUC 0.7598104056437389
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 10 idx: 0 First Loss : 3.9541499614715576, Second Loss : 3.9393866062164307
epoch: 10 idx: 200 First Loss : 0.9226157628660049, Second Loss : 0.9148473343725052
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4425925925925926, recall 0.4361952861952862, F1 0.3272649124340706, AUC 0.6871773288439954
  Second-Tier acc 0.3958333333333333, precision 0.4706605222734255, recall 0.4688888888888889, F1 0.3602092352092352, AUC 0.6936868686868687
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.5181357649442756, recall 0.4431216931216931, F1 0.36547931961690683, AUC 0.6967408877131099
  Second-Tier acc 0.40816326530612246, precision 0.49266862170087977, recall 0.4138007054673721, F1 0.35012039903680775, AUC 0.7386463844797179
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 11 idx: 0 First Loss : 3.944138288497925, Second Loss : 3.9219822883605957
epoch: 11 idx: 200 First Loss : 0.9221696905436721, Second Loss : 0.9113678809209607
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3472222222222222, precision 0.43665927568366586, recall 0.43212121212121213, F1 0.3171454807818444, AUC 0.6823849607182941
  Second-Tier acc 0.3958333333333333, precision 0.4801587301587302, recall 0.4688888888888889, F1 0.35833333333333334, AUC 0.6898989898989899
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.38095238095238093, precision 0.5024918535556834, recall 0.4130658436213992, F1 0.33617907193298135, AUC 0.6966061630413481
  Second-Tier acc 0.40816326530612246, precision 0.49523809523809526, recall 0.4138007054673721, F1 0.3449646525276777, AUC 0.7242614638447972
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 12 idx: 0 First Loss : 3.888275146484375, Second Loss : 3.9002957344055176
epoch: 12 idx: 200 First Loss : 0.923693721259965, Second Loss : 0.9073030697481547
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3402777777777778, precision 0.4178789795488087, recall 0.41323232323232323, F1 0.29667469863355955, AUC 0.676127946127946
  Second-Tier acc 0.375, precision 0.4411764705882353, recall 0.44111111111111106, F1 0.3230506822612086, AUC 0.685050505050505
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.511001100110011, recall 0.428938859494415, F1 0.3441882032947325, AUC 0.6837338330393886
  Second-Tier acc 0.42857142857142855, precision 0.5092592592592593, recall 0.43761022927689597, F1 0.3582072829131653, AUC 0.7008377425044091
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 13 idx: 0 First Loss : 3.8122308254241943, Second Loss : 3.76766037940979
epoch: 13 idx: 200 First Loss : 0.9176267106314792, Second Loss : 0.9010875667246993
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.4077441077441078, recall 0.4043434343434343, F1 0.2808080808080808, AUC 0.6744668911335577
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6821212121212121
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4013605442176871, precision 0.5056933956610332, recall 0.4271017048794827, F1 0.34264648388090874, AUC 0.6749032431902803
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.689594356261023
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5)
Current LR: 7.709066166749992e-05
epoch: 14 idx: 0 First Loss : 3.788249969482422, Second Loss : 3.6930768489837646
epoch: 14 idx: 200 First Loss : 0.9121624987974383, Second Loss : 0.895432592796617
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.4100550055005501, recall 0.4084175084175084, F1 0.28858878531720034, AUC 0.6731032547699214
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6774242424242424
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.4994531036368608, recall 0.42526455026455023, F1 0.3394409883771586, AUC 0.6695326278659612
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.677414021164021
Test AUC: 0.7580, Test F1: 0.5222 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.22938098213507463, "droprate_2": 0.0, "lr": 0.0002679824490344044, "weight_decay": 1.2075171590058907e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.18553350192463303, "droprate_2": 0.0, "lr": 0.00012077788719765459, "weight_decay": 0.0003049844892464817, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.20318134583753203, "droprate_2": 0.0, "lr": 0.0002811658472296914, "weight_decay": 3.1336821761830735e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.16603356417862367, "droprate_2": 0.0, "lr": 1.012838684593558e-05, "weight_decay": 4.5650617330698196e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.22561533473393786, "droprate_2": 0.0, "lr": 0.00017959652497515996, "weight_decay": 4.8014221986711244e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0970817804336548, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0893479778769597, Second Loss : 1.0789083771370536
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7561521464646465
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7481818181818182
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7279679232804233
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7299382716049383
epoch: 1 idx: 0 First Loss : 1.5892984867095947, Second Loss : 1.8142881393432617
epoch: 1 idx: 200 First Loss : 0.986615345771633, Second Loss : 0.9816357227255456
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7316508838383838
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7401515151515152
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7117779982363316
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7178681657848324
epoch: 2 idx: 0 First Loss : 2.5076093673706055, Second Loss : 2.5022032260894775
epoch: 2 idx: 200 First Loss : 0.9548473075328775, Second Loss : 0.9420103883713632
  First-Tier acc 0.5729166666666666, precision 0.5139479695931309, recall 0.5387121212121212, F1 0.4614668238985127, AUC 0.7317803030303031
  Second-Tier acc 0.6458333333333334, precision 0.6033009136457412, recall 0.5534343434343435, F1 0.5618010167029776, AUC 0.7444949494949494
  First-Tier acc 0.5255102040816326, precision 0.5096071618008422, recall 0.45453042328042326, F1 0.4253151885496272, AUC 0.7065593309082893
  Second-Tier acc 0.5102040816326531, precision 0.4624819624819625, recall 0.5011022927689593, F1 0.46733214497920383, AUC 0.7200176366843034
epoch: 3 idx: 0 First Loss : 3.194516181945801, Second Loss : 3.16257643699646
epoch: 3 idx: 200 First Loss : 0.9303830631670371, Second Loss : 0.9163147984674914
  First-Tier acc 0.5052083333333334, precision 0.5408272283272283, recall 0.5369949494949495, F1 0.46911796911796916, AUC 0.7490498737373738
  Second-Tier acc 0.4791666666666667, precision 0.375, recall 0.4763636363636364, F1 0.36642087351106073, AUC 0.7672727272727272
  First-Tier acc 0.5051020408163265, precision 0.5127712724434036, recall 0.509755291005291, F1 0.4810955086500437, AUC 0.7270516424162258
  Second-Tier acc 0.5306122448979592, precision 0.3853801169590643, recall 0.44708994708994715, F1 0.38405797101449274, AUC 0.7236552028218695
epoch: 4 idx: 0 First Loss : 3.944094657897949, Second Loss : 3.938103199005127
epoch: 4 idx: 200 First Loss : 0.9365293002474256, Second Loss : 0.9131912917468641
  First-Tier acc 0.3854166666666667, precision 0.3997643153989903, recall 0.428459595959596, F1 0.31635738582029027, AUC 0.7410069444444444
  Second-Tier acc 0.4375, precision 0.5158730158730159, recall 0.48111111111111104, F1 0.37529330572808833, AUC 0.7633838383838384
  First-Tier acc 0.4489795918367347, precision 0.4791769427038614, recall 0.43276014109347444, F1 0.3814615098973248, AUC 0.7094872960758378
  Second-Tier acc 0.5102040816326531, precision 0.5041666666666667, recall 0.4640652557319224, F1 0.4288231148696265, AUC 0.7389770723104055
epoch: 5 idx: 0 First Loss : 3.840606212615967, Second Loss : 3.844111680984497
epoch: 5 idx: 200 First Loss : 0.9301709131151206, Second Loss : 0.907458872737048
  First-Tier acc 0.3802083333333333, precision 0.4065280572322825, recall 0.42512626262626263, F1 0.3092677931387609, AUC 0.7133396464646465
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.7363131313131314
  First-Tier acc 0.4489795918367347, precision 0.4822647764141628, recall 0.43116181657848324, F1 0.371585557299843, AUC 0.6869040729717814
  Second-Tier acc 0.4897959183673469, precision 0.4746031746031745, recall 0.45171957671957674, F1 0.41307066916823015, AUC 0.7116953262786597
epoch: 6 idx: 0 First Loss : 4.113353729248047, Second Loss : 3.9625844955444336
epoch: 6 idx: 200 First Loss : 0.9292676839288277, Second Loss : 0.9004751805161632
  First-Tier acc 0.3697916666666667, precision 0.431131592421915, recall 0.4269444444444444, F1 0.29285823054667276, AUC 0.6769760101010102
  Second-Tier acc 0.3958333333333333, precision 0.3953953953953954, recall 0.44, F1 0.309640522875817, AUC 0.6940909090909092
  First-Tier acc 0.4336734693877551, precision 0.4619330560507032, recall 0.42157186948853614, F1 0.33150413105620274, AUC 0.6726603835978836
  Second-Tier acc 0.4897959183673469, precision 0.4940025252525253, recall 0.474647266313933, F1 0.4114634412117249, AUC 0.7053571428571429
epoch: 7 idx: 0 First Loss : 3.6616432666778564, Second Loss : 3.8963091373443604
epoch: 7 idx: 200 First Loss : 0.9145617977080668, Second Loss : 0.8926859542864157
  First-Tier acc 0.3854166666666667, precision 0.4223314223314223, recall 0.4369444444444444, F1 0.30944062132732963, AUC 0.6697537878787879
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.694040404040404
  First-Tier acc 0.4336734693877551, precision 0.48388888888888887, recall 0.43176807760141095, F1 0.34263167768866376, AUC 0.6861944720017638
  Second-Tier acc 0.4489795918367347, precision 0.5126984126984128, recall 0.44995590828924165, F1 0.3768707482993197, AUC 0.7235449735449736
epoch: 8 idx: 0 First Loss : 3.512667179107666, Second Loss : 3.8828446865081787
epoch: 8 idx: 200 First Loss : 0.9181408029937519, Second Loss : 0.8927499025374355
  First-Tier acc 0.3854166666666667, precision 0.42774410774410776, recall 0.4369444444444444, F1 0.3082620640949453, AUC 0.6693213383838383
  Second-Tier acc 0.3125, precision 0.36068376068376073, recall 0.38666666666666666, F1 0.23555555555555555, AUC 0.6843939393939394
  First-Tier acc 0.4489795918367347, precision 0.49451437451437447, recall 0.44102733686067025, F1 0.35568714758964703, AUC 0.6823640046296297
  Second-Tier acc 0.46938775510204084, precision 0.5672514619883041, recall 0.4737654320987654, F1 0.3924741924741925, AUC 0.7093253968253969
epoch: 9 idx: 0 First Loss : 3.4273681640625, Second Loss : 3.7952373027801514
epoch: 9 idx: 200 First Loss : 0.9074577402276571, Second Loss : 0.882281317464215
  First-Tier acc 0.3958333333333333, precision 0.5565284178187404, recall 0.4436111111111111, F1 0.3138234381785471, AUC 0.6663289141414142
  Second-Tier acc 0.2916666666666667, precision 0.34401709401709396, recall 0.37333333333333335, F1 0.21563218390804598, AUC 0.6714646464646465
  First-Tier acc 0.4642857142857143, precision 0.5664277180406212, recall 0.45315255731922394, F1 0.36721911484944664, AUC 0.6762772817460317
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6895392416225751{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.06839331320128862, "droprate_2": 0.0, "lr": 4.867152354187201e-05, "weight_decay": 0.0002722097993461644, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 18, "gamma": 0.807153071884859, "T_max": 18, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0899888277053833, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1218416994780451, Second Loss : 1.1114842885762304
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7436205808080807
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7322222222222221
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6791432429453262
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6727292768959435
epoch: 1 idx: 0 First Loss : 1.9142849445343018, Second Loss : 2.029425621032715
epoch: 1 idx: 200 First Loss : 1.0430052759338968, Second Loss : 1.042930963768888
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7423200757575757
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7459595959595959
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075135030864198
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7017195767195767
epoch: 2 idx: 0 First Loss : 2.153447151184082, Second Loss : 2.230836868286133
epoch: 2 idx: 200 First Loss : 0.9941304941379016, Second Loss : 0.9973308753537301
  First-Tier acc 0.6770833333333334, precision 0.6999562554680665, recall 0.5962626262626263, F1 0.5419274779469277, AUC 0.7381502525252525
  Second-Tier acc 0.6458333333333334, precision 0.5396825396825397, recall 0.5295959595959595, F1 0.5015873015873016, AUC 0.7460606060606061
  First-Tier acc 0.576530612244898, precision 0.6000635045767092, recall 0.46152998236331566, F1 0.47260441509203205, AUC 0.6888675319664902
  Second-Tier acc 0.6326530612244898, precision 0.626984126984127, recall 0.5981040564373897, F1 0.6099865047233468, AUC 0.6889880952380952
epoch: 3 idx: 0 First Loss : 2.557762622833252, Second Loss : 2.623124122619629
epoch: 3 idx: 200 First Loss : 0.9600188979387876, Second Loss : 0.9580228723845079
  First-Tier acc 0.5885416666666666, precision 0.5646205646205646, recall 0.5835606060606061, F1 0.5476665279511721, AUC 0.748560606060606
  Second-Tier acc 0.5416666666666666, precision 0.5049486461251167, recall 0.5062626262626263, F1 0.49595332204027853, AUC 0.7466161616161616
  First-Tier acc 0.5867346938775511, precision 0.5738670612088334, recall 0.607583774250441, F1 0.5769102435769102, AUC 0.7052985835537919
  Second-Tier acc 0.5714285714285714, precision 0.5501949317738791, recall 0.583994708994709, F1 0.5507246376811594, AUC 0.7116402116402116
epoch: 4 idx: 0 First Loss : 2.9631783962249756, Second Loss : 3.0632224082946777
epoch: 4 idx: 200 First Loss : 0.9411285719394091, Second Loss : 0.937033234395791
  First-Tier acc 0.5520833333333334, precision 0.5797864560479743, recall 0.5927272727272728, F1 0.5434669560470375, AUC 0.7577967171717171
  Second-Tier acc 0.5416666666666666, precision 0.5715249662618084, recall 0.5810101010101011, F1 0.539014202172097, AUC 0.774949494949495
  First-Tier acc 0.5153061224489796, precision 0.5270920107421081, recall 0.5720348324514991, F1 0.5120277962593333, AUC 0.7221498842592592
  Second-Tier acc 0.5510204081632653, precision 0.5393713040771865, recall 0.5895061728395062, F1 0.5397632236341914, AUC 0.7265211640211641
epoch: 5 idx: 0 First Loss : 3.279418706893921, Second Loss : 3.3840084075927734
epoch: 5 idx: 200 First Loss : 0.9341554898045846, Second Loss : 0.9250238499794137
  First-Tier acc 0.5104166666666666, precision 0.5625084260195483, recall 0.5641666666666666, F1 0.5084216858410406, AUC 0.7643181818181818
  Second-Tier acc 0.5208333333333334, precision 0.5772144522144522, recall 0.5871717171717172, F1 0.5247619047619048, AUC 0.7975757575757575
  First-Tier acc 0.5102040816326531, precision 0.5399135543999459, recall 0.5864748677248678, F1 0.5086299017585979, AUC 0.7320326278659612
  Second-Tier acc 0.5306122448979592, precision 0.5371794871794872, recall 0.5886243386243386, F1 0.5333854472021367, AUC 0.732363315696649
epoch: 6 idx: 0 First Loss : 3.473355770111084, Second Loss : 3.640326499938965
epoch: 6 idx: 200 First Loss : 0.9333363536800912, Second Loss : 0.9197083966648993
  First-Tier acc 0.4635416666666667, precision 0.5334719746484452, recall 0.5275757575757576, F1 0.4616089905136558, AUC 0.764592803030303
  Second-Tier acc 0.5208333333333334, precision 0.6052749719416386, recall 0.5896969696969697, F1 0.5207802113980603, AUC 0.8090404040404041
  First-Tier acc 0.4897959183673469, precision 0.5368073082845215, recall 0.5725308641975309, F1 0.48856225077259713, AUC 0.732242752425044
  Second-Tier acc 0.5510204081632653, precision 0.5633699633699635, recall 0.6124338624338624, F1 0.5523809523809523, AUC 0.7349537037037037
epoch: 7 idx: 0 First Loss : 3.52512788772583, Second Loss : 3.7499258518218994
epoch: 7 idx: 200 First Loss : 0.9299276329238728, Second Loss : 0.9147280309377099
  First-Tier acc 0.453125, precision 0.5341687478287089, recall 0.521540404040404, F1 0.45026536930561695, AUC 0.7549463383838383
  Second-Tier acc 0.4791666666666667, precision 0.5630906768837803, recall 0.5341414141414141, F1 0.46507936507936504, AUC 0.8132828282828283
  First-Tier acc 0.46938775510204084, precision 0.54353966118672, recall 0.5394620811287478, F1 0.4619907733208226, AUC 0.7312954695767195
  Second-Tier acc 0.5306122448979592, precision 0.5507825507825508, recall 0.6115520282186949, F1 0.5336700336700336, AUC 0.7421186067019402
epoch: 8 idx: 0 First Loss : 3.5506298542022705, Second Loss : 3.8003549575805664
epoch: 8 idx: 200 First Loss : 0.9272024449985011, Second Loss : 0.9101679952171126
  First-Tier acc 0.4375, precision 0.5199029771398193, recall 0.5007070707070708, F1 0.43227673500297503, AUC 0.7428945707070707
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.8030808080808081
  First-Tier acc 0.4642857142857143, precision 0.5356610232684257, recall 0.5233134920634921, F1 0.45544921416842604, AUC 0.7297832616843034
  Second-Tier acc 0.5306122448979592, precision 0.5587606837606838, recall 0.593694885361552, F1 0.5226527858106805, AUC 0.7541335978835978
epoch: 9 idx: 0 First Loss : 3.5843570232391357, Second Loss : 3.8451457023620605
epoch: 9 idx: 200 First Loss : 0.9245243874443371, Second Loss : 0.905346135724688
  First-Tier acc 0.4427083333333333, precision 0.52421849907249, recall 0.5076515151515152, F1 0.4386711664070662, AUC 0.7293655303030304
  Second-Tier acc 0.4583333333333333, precision 0.5308641975308641, recall 0.5208080808080807, F1 0.4434124527003784, AUC 0.7815656565656566
  First-Tier acc 0.4846938775510204, precision 0.5582055269555269, recall 0.5499889770723104, F1 0.4740774349667272, AUC 0.7326044422398589
  Second-Tier acc 0.5510204081632653, precision 0.5912354312354312, recall 0.6175044091710759, F1 0.539296960349592, AUC 0.7738095238095237{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.20278186869044745, "droprate_2": 0.0, "lr": 3.09624427226267e-05, "weight_decay": 1.023287565630328e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0923500061035156, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1155701647350444, Second Loss : 1.1099498970295065
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7341256313131312
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7198484848484847
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6605007164902997
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6515101410934744
epoch: 1 idx: 0 First Loss : 2.0265798568725586, Second Loss : 2.0352749824523926
epoch: 1 idx: 200 First Loss : 1.0729321245085541, Second Loss : 1.0757254371002538
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7437405303030303
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7455050505050504
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6974619708994708
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6911926807760141
epoch: 2 idx: 0 First Loss : 2.1840078830718994, Second Loss : 2.1639184951782227
epoch: 2 idx: 200 First Loss : 1.032868892473368, Second Loss : 1.0416761042911615
  First-Tier acc 0.5677083333333334, precision 0.37103174603174605, recall 0.41848484848484846, F1 0.36625695054141055, AUC 0.7394696969696969
  Second-Tier acc 0.5833333333333334, precision 0.5617886178861788, recall 0.4386868686868686, F1 0.41504329004329005, AUC 0.7463636363636365
  First-Tier acc 0.5816326530612245, precision 0.33762943379599025, recall 0.37191358024691357, F1 0.3133441900565188, AUC 0.6897149195326279
  Second-Tier acc 0.6122448979591837, precision 0.45, recall 0.4583333333333333, F1 0.4166666666666667, AUC 0.6905313051146384
epoch: 3 idx: 0 First Loss : 2.3975284099578857, Second Loss : 2.3809378147125244
epoch: 3 idx: 200 First Loss : 0.9970724564509013, Second Loss : 1.0081753145106396
  First-Tier acc 0.6458333333333334, precision 0.6078487869532646, recall 0.5907070707070707, F1 0.552155886202668, AUC 0.7392487373737374
  Second-Tier acc 0.6875, precision 0.6380587484035759, recall 0.614040404040404, F1 0.6208112874779541, AUC 0.743939393939394
  First-Tier acc 0.5969387755102041, precision 0.5660539215686274, recall 0.564373897707231, F1 0.5641065028161802, AUC 0.6843412422839507
  Second-Tier acc 0.5510204081632653, precision 0.5083527583527584, recall 0.5372574955908289, F1 0.5138364779874214, AUC 0.6827050264550264
epoch: 4 idx: 0 First Loss : 2.668287754058838, Second Loss : 2.6933484077453613
epoch: 4 idx: 200 First Loss : 0.9662146459134361, Second Loss : 0.9759910590761337
  First-Tier acc 0.5885416666666666, precision 0.5652282881115832, recall 0.5888888888888889, F1 0.5620991550442838, AUC 0.7494065656565656
  Second-Tier acc 0.5625, precision 0.5222476481057716, recall 0.5239393939393939, F1 0.49228418640183347, AUC 0.7563636363636363
  First-Tier acc 0.5714285714285714, precision 0.5600324401384889, recall 0.6206459435626103, F1 0.5644113557240442, AUC 0.7006689539241622
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.7090498236331569
epoch: 5 idx: 0 First Loss : 2.953850269317627, Second Loss : 2.9951419830322266
epoch: 5 idx: 200 First Loss : 0.9466466221828662, Second Loss : 0.954133426761301
  First-Tier acc 0.5416666666666666, precision 0.57446047008547, recall 0.5852525252525252, F1 0.5394356261022928, AUC 0.7578756313131313
  Second-Tier acc 0.5208333333333334, precision 0.5608080808080808, recall 0.5601010101010101, F1 0.49932541236889066, AUC 0.7683333333333334
  First-Tier acc 0.4846938775510204, precision 0.5026321868427132, recall 0.5554453262786596, F1 0.4790408371883501, AUC 0.7157152502204586
  Second-Tier acc 0.4489795918367347, precision 0.44999999999999996, recall 0.49338624338624343, F1 0.4318466884625665, AUC 0.7281746031746031
epoch: 6 idx: 0 First Loss : 3.17928147315979, Second Loss : 3.2267110347747803
epoch: 6 idx: 200 First Loss : 0.9361270457895389, Second Loss : 0.940031267748914
  First-Tier acc 0.484375, precision 0.552447036244187, recall 0.5430808080808082, F1 0.48484706433845076, AUC 0.7645107323232323
  Second-Tier acc 0.5, precision 0.5483091787439615, recall 0.5467676767676767, F1 0.4835164835164835, AUC 0.7947979797979797
  First-Tier acc 0.47959183673469385, precision 0.5207860922146635, recall 0.5698853615520282, F1 0.47642918357767, AUC 0.7292355599647267
  Second-Tier acc 0.4489795918367347, precision 0.46013071895424834, recall 0.5048500881834216, F1 0.44213005632360475, AUC 0.7347332451499118
epoch: 7 idx: 0 First Loss : 3.3352551460266113, Second Loss : 3.4079508781433105
epoch: 7 idx: 200 First Loss : 0.9316282080143542, Second Loss : 0.9319356555971711
  First-Tier acc 0.453125, precision 0.5341605648107196, recall 0.5158585858585858, F1 0.45545652561972827, AUC 0.767310606060606
  Second-Tier acc 0.4791666666666667, precision 0.5481481481481482, recall 0.524040404040404, F1 0.4782386072708653, AUC 0.8052525252525253
  First-Tier acc 0.47959183673469385, precision 0.5311861826390529, recall 0.5756172839506173, F1 0.4784338170362426, AUC 0.7331762566137566
  Second-Tier acc 0.46938775510204084, precision 0.48304093567251466, recall 0.5286596119929453, F1 0.46972833929355673, AUC 0.7393628747795414
epoch: 8 idx: 0 First Loss : 3.438565731048584, Second Loss : 3.5430588722229004
epoch: 8 idx: 200 First Loss : 0.9287920066442766, Second Loss : 0.925794889070835
  First-Tier acc 0.4322916666666667, precision 0.5178137543124858, recall 0.5001767676767677, F1 0.434354283269576, AUC 0.7655650252525253
  Second-Tier acc 0.5, precision 0.5648148148148148, recall 0.5543434343434344, F1 0.4997439836149513, AUC 0.8126767676767677
  First-Tier acc 0.45918367346938777, precision 0.528902384165542, recall 0.5588073192239859, F1 0.459951693200745, AUC 0.7374476410934744
  Second-Tier acc 0.46938775510204084, precision 0.501984126984127, recall 0.5515873015873015, F1 0.47289377289377293, AUC 0.7385912698412698
epoch: 9 idx: 0 First Loss : 3.5006890296936035, Second Loss : 3.636302947998047
epoch: 9 idx: 200 First Loss : 0.9255562259685897, Second Loss : 0.9198733438501385
  First-Tier acc 0.4479166666666667, precision 0.5347069223446212, recall 0.5247979797979797, F1 0.4474772539288669, AUC 0.7612279040404039
  Second-Tier acc 0.5208333333333334, precision 0.5933977455716586, recall 0.6016161616161616, F1 0.5238095238095238, AUC 0.8117171717171718
  First-Tier acc 0.45408163265306123, precision 0.5403284376424234, recall 0.5496582892416225, F1 0.4539236713149757, AUC 0.7365348048941799
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7461419753086419{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_14", "train_show_freq": 200, "droprate": 0.23225075408646198, "droprate_2": 0.0, "lr": 7.935142029960768e-05, "weight_decay": 4.6134391742305155e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 2, "gamma": 0.47575949815319885, "T_max": 10, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_14", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0989582538604736, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1158398730096533, Second Loss : 1.1074079593170936
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7434816919191919
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7473232323232324
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6959876543209876
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6986331569664902
epoch: 1 idx: 0 First Loss : 1.8452492952346802, Second Loss : 1.9954795837402344
epoch: 1 idx: 200 First Loss : 1.0127890705320965, Second Loss : 1.0138332433813246
  First-Tier acc 0.5729166666666666, precision 0.4219607843137256, recall 0.41757575757575754, F1 0.3687232985593642, AUC 0.7352556818181818
  Second-Tier acc 0.5625, precision 0.3617886178861789, recall 0.4109090909090909, F1 0.36007130124777187, AUC 0.7417171717171716
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6919539517195767
  Second-Tier acc 0.5918367346938775, precision 0.6956521739130435, recall 0.3988095238095238, F1 0.36231608320649417, AUC 0.6997354497354498
epoch: 2 idx: 0 First Loss : 2.303427219390869, Second Loss : 2.4293487071990967
epoch: 2 idx: 200 First Loss : 0.9563521227210908, Second Loss : 0.9643080823901874
  First-Tier acc 0.640625, precision 0.6090012455832634, recall 0.617979797979798, F1 0.6039742746609115, AUC 0.7391698232323233
  Second-Tier acc 0.6666666666666666, precision 0.6419753086419753, recall 0.5761616161616162, F1 0.555067155067155, AUC 0.7386868686868686
  First-Tier acc 0.5867346938775511, precision 0.5540640755531797, recall 0.5964506172839507, F1 0.5644772348015964, AUC 0.6922743055555557
  Second-Tier acc 0.46938775510204084, precision 0.4148414514547238, recall 0.4534832451499118, F1 0.4002821869488536, AUC 0.6982473544973544
epoch: 3 idx: 0 First Loss : 2.4588940143585205, Second Loss : 2.5265324115753174
epoch: 3 idx: 200 First Loss : 0.9289955701215646, Second Loss : 0.9367278644731686
  First-Tier acc 0.5364583333333334, precision 0.5619380386675984, recall 0.5636868686868687, F1 0.5276358656716769, AUC 0.7503661616161615
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7515656565656567
  First-Tier acc 0.47959183673469385, precision 0.4918405365126677, recall 0.5380291005291006, F1 0.46423113730806037, AUC 0.7020054839065256
  Second-Tier acc 0.46938775510204084, precision 0.45441595441595445, recall 0.47641093474426804, F1 0.43437796771130105, AUC 0.7278990299823634
epoch: 4 idx: 0 First Loss : 2.8533568382263184, Second Loss : 2.9495832920074463
epoch: 4 idx: 200 First Loss : 0.9134367614317296, Second Loss : 0.9187899466919068
  First-Tier acc 0.4479166666666667, precision 0.5274027098105796, recall 0.5203787878787879, F1 0.4477290554630852, AUC 0.759709595959596
  Second-Tier acc 0.4791666666666667, precision 0.5235897435897435, recall 0.5164646464646464, F1 0.452960102960103, AUC 0.7535858585858586
  First-Tier acc 0.45918367346938777, precision 0.5094949494949496, recall 0.548611111111111, F1 0.4602393835054927, AUC 0.7171757881393299
  Second-Tier acc 0.40816326530612246, precision 0.4450980392156863, recall 0.498015873015873, F1 0.40653432588916455, AUC 0.7307649911816579
epoch: 5 idx: 0 First Loss : 2.830718755722046, Second Loss : 2.9109201431274414
epoch: 5 idx: 200 First Loss : 0.902652211422425, Second Loss : 0.9075906377804664
  First-Tier acc 0.4479166666666667, precision 0.5280459770114942, recall 0.523989898989899, F1 0.4473668669747101, AUC 0.7609027777777778
  Second-Tier acc 0.4375, precision 0.516923436041083, recall 0.5067676767676768, F1 0.4239417989417989, AUC 0.7552020202020202
  First-Tier acc 0.4489795918367347, precision 0.5073099415204678, recall 0.5395723104056437, F1 0.44949494949494945, AUC 0.7161665013227513
  Second-Tier acc 0.42857142857142855, precision 0.5043859649122807, recall 0.5218253968253969, F1 0.42983892983892985, AUC 0.7254739858906526
epoch: 6 idx: 0 First Loss : 2.978468179702759, Second Loss : 3.079989194869995
epoch: 6 idx: 200 First Loss : 0.9009366752348136, Second Loss : 0.903682324405185
  First-Tier acc 0.4270833333333333, precision 0.534034034034034, recall 0.5091161616161617, F1 0.4259004151995232, AUC 0.7536079545454545
  Second-Tier acc 0.4375, precision 0.5604395604395603, recall 0.5168686868686869, F1 0.4484188034188034, AUC 0.7589898989898991
  First-Tier acc 0.4489795918367347, precision 0.5323972169512966, recall 0.5360449735449736, F1 0.4507195930630153, AUC 0.7160769400352734
  Second-Tier acc 0.4489795918367347, precision 0.5362962962962964, recall 0.5392416225749559, F1 0.45881332837854577, AUC 0.7225529100529101
epoch: 7 idx: 0 First Loss : 2.9467310905456543, Second Loss : 3.0604236125946045
epoch: 7 idx: 200 First Loss : 0.8927013415157499, Second Loss : 0.89426207868614
  First-Tier acc 0.4114583333333333, precision 0.5344961813254496, recall 0.4967676767676768, F1 0.40862414301831124, AUC 0.7535448232323233
  Second-Tier acc 0.3958333333333333, precision 0.5276124338624338, recall 0.46383838383838377, F1 0.39151901070505724, AUC 0.7702020202020202
  First-Tier acc 0.44387755102040816, precision 0.5471197194857238, recall 0.5342261904761905, F1 0.44898681880779073, AUC 0.7171310074955909
  Second-Tier acc 0.4489795918367347, precision 0.5362962962962964, recall 0.5392416225749559, F1 0.45881332837854577, AUC 0.7256944444444443
epoch: 8 idx: 0 First Loss : 3.0150983333587646, Second Loss : 3.137528896331787
epoch: 8 idx: 200 First Loss : 0.8841395931994885, Second Loss : 0.8830522473771774
  First-Tier acc 0.359375, precision 0.4885147685948252, recall 0.4309343434343435, F1 0.34031705352731634, AUC 0.7520517676767677
  Second-Tier acc 0.375, precision 0.5016233766233765, recall 0.43606060606060604, F1 0.3613636363636364, AUC 0.774090909090909
  First-Tier acc 0.44387755102040816, precision 0.5560028056837724, recall 0.5192350088183422, F1 0.4442195276525778, AUC 0.7171895667989417
  Second-Tier acc 0.5102040816326531, precision 0.5962962962962962, recall 0.5928130511463845, F1 0.5151515151515151, AUC 0.7300485008818343
epoch: 9 idx: 0 First Loss : 3.0232346057891846, Second Loss : 3.1638667583465576
epoch: 9 idx: 200 First Loss : 0.8804369860036827, Second Loss : 0.8797879925099623
  First-Tier acc 0.375, precision 0.509013209013209, recall 0.45429292929292925, F1 0.34858370295452773, AUC 0.7519444444444444
  Second-Tier acc 0.375, precision 0.5168067226890757, recall 0.43606060606060604, F1 0.3635964912280702, AUC 0.7754545454545455
  First-Tier acc 0.42346938775510207, precision 0.5383597883597884, recall 0.48489858906525574, F1 0.41583229036295366, AUC 0.7176442625661376
  Second-Tier acc 0.4897959183673469, precision 0.5879629629629629, recall 0.5511463844797179, F1 0.48872785829307563, AUC 0.734402557319224