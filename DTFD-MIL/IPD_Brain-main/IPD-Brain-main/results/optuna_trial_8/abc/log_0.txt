{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.37749245721645663, "droprate_2": 0.0, "lr": 1.0249162442104193e-05, "weight_decay": 5.205579761294048e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.0249162442104193e-05
epoch: 0 idx: 0 First Loss : 1.0090627670288086, Second Loss : 1.0700304508209229
epoch: 0 idx: 200 First Loss : 1.048397669299918, Second Loss : 1.0438518549375866
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5413860830527497
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47429292929292927
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.40901797961983144
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.41005291005291006
 
 test auc: 0.41005291005291006, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.4761647456172333, "droprate_2": 0.0, "lr": 1.4927760843247334e-05, "weight_decay": 0.00015256817224689614, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.4927760843247334e-05
epoch: 0 idx: 0 First Loss : 0.9926084280014038, Second Loss : 1.0701088905334473
epoch: 0 idx: 200 First Loss : 1.0586703532370763, Second Loss : 1.0578239471165103
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5375978535353535
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4771212121212121
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.41933972663139324
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.42680776014109356
 
 test auc: 0.42680776014109356, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.4927760843247334e-05
epoch: 1 idx: 0 First Loss : 1.9256072044372559, Second Loss : 2.0924930572509766
epoch: 1 idx: 200 First Loss : 1.0924886086983467, Second Loss : 1.092591581949547
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5259659090909091
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4890404040404041
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.42983562059082897
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4402557319223986
 
 test auc: 0.4402557319223986, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 1.4927760843247334e-05
epoch: 2 idx: 0 First Loss : 1.9968819618225098, Second Loss : 2.1342976093292236
epoch: 2 idx: 200 First Loss : 1.0730466745534346, Second Loss : 1.076266833131586
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5176672979797979
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4890909090909091
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43878141534391535
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4403659611992945
 
 test auc: 0.4403659611992945, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.4927760843247334e-05
epoch: 3 idx: 0 First Loss : 2.069119691848755, Second Loss : 2.1986794471740723
epoch: 3 idx: 200 First Loss : 1.0586483878875845, Second Loss : 1.0633737291417904
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5099589646464647
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4990909090909091
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4493634259259259
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4412477954144621
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 4 idx: 0 First Loss : 2.155092716217041, Second Loss : 2.283212423324585
epoch: 4 idx: 200 First Loss : 1.0424629704869208, Second Loss : 1.049991907616753
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.08421052631578947, recall 0.3333333333333333, F1 0.13445378151260504, AUC 0.5053314393939394
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4952020202020202
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4592737268518519
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45541225749559083
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 5 idx: 0 First Loss : 2.2628042697906494, Second Loss : 2.3872334957122803
epoch: 5 idx: 200 First Loss : 1.0250898102919261, Second Loss : 1.0353098672569094
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2708333333333333, precision 0.3510981912144702, recall 0.3570454545454545, F1 0.2123709623709624, AUC 0.4944349747474748
  Second-Tier acc 0.2708333333333333, precision 0.24796747967479674, recall 0.3686868686868687, F1 0.243433222345542, AUC 0.486919191919192
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3112244897959184, precision 0.3879233511586453, recall 0.39434523809523814, F1 0.2648148148148148, AUC 0.4726114693562609
  Second-Tier acc 0.32653061224489793, precision 0.4318181818181818, recall 0.43452380952380953, F1 0.33124346917450365, AUC 0.46935626102292766
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 6 idx: 0 First Loss : 2.377084493637085, Second Loss : 2.5146842002868652
epoch: 6 idx: 200 First Loss : 1.0043520441102745, Second Loss : 1.0185264132879859
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2916666666666667, precision 0.31964270579831217, recall 0.39618686868686864, F1 0.31668725388911345, AUC 0.48721906565656564
  Second-Tier acc 0.2916666666666667, precision 0.27619047619047615, recall 0.404040404040404, F1 0.303951367781155, AUC 0.47116161616161617
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3520408163265306, precision 0.4740858737298017, recall 0.44934964726631393, F1 0.3819501105410253, AUC 0.48429921737213394
  Second-Tier acc 0.32653061224489793, precision 0.4185185185185185, recall 0.41291887125220456, F1 0.37707761237173004, AUC 0.4931657848324515
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 7 idx: 0 First Loss : 2.519953727722168, Second Loss : 2.6506729125976562
epoch: 7 idx: 200 First Loss : 0.9821935405778648, Second Loss : 0.9999142993630757
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.25, precision 0.2862996542241825, recall 0.3092171717171717, F1 0.2758342002528049, AUC 0.4782039141414142
  Second-Tier acc 0.20833333333333334, precision 0.2623456790123457, recall 0.27595959595959596, F1 0.2530607530607531, AUC 0.471060606060606
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.32142857142857145, precision 0.361900033101622, recall 0.3999669312169312, F1 0.3467401835925405, AUC 0.5043333884479718
  Second-Tier acc 0.3673469387755102, precision 0.41143578643578643, recall 0.4261463844797178, F1 0.3932391955498502, AUC 0.521384479717813
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 8 idx: 0 First Loss : 2.6663074493408203, Second Loss : 2.800427198410034
epoch: 8 idx: 200 First Loss : 0.9624041227336547, Second Loss : 0.9826904726747553
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2552083333333333, precision 0.2698035207451403, recall 0.29449494949494953, F1 0.27138181951148166, AUC 0.47754103535353537
  Second-Tier acc 0.2708333333333333, precision 0.30370370370370375, recall 0.2870707070707071, F1 0.2920634920634921, AUC 0.4825757575757576
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3520408163265306, precision 0.3729048729048729, recall 0.4318783068783068, F1 0.36574730480628825, AUC 0.5166032848324514
  Second-Tier acc 0.3469387755102041, precision 0.3706349206349206, recall 0.4201940035273368, F1 0.3676258382140735, AUC 0.5340057319223986
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 9 idx: 0 First Loss : 2.811713457107544, Second Loss : 2.9428088665008545
epoch: 9 idx: 200 First Loss : 0.9455804128700228, Second Loss : 0.9687062223159258
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2552083333333333, precision 0.25454921422663357, recall 0.2643434343434343, F1 0.2564280444898423, AUC 0.4791540404040404
  Second-Tier acc 0.3125, precision 0.31857031857031853, recall 0.3162626262626263, F1 0.31732838589981444, AUC 0.4856565656565657
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3469387755102041, precision 0.35863679147261235, recall 0.43485449735449727, F1 0.3512620494881879, AUC 0.525452628968254
  Second-Tier acc 0.3469387755102041, precision 0.3681077694235589, recall 0.4201940035273368, F1 0.3573540280857354, AUC 0.5371472663139331
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 10 idx: 0 First Loss : 2.9363136291503906, Second Loss : 3.069368362426758
epoch: 10 idx: 200 First Loss : 0.9319983924743697, Second Loss : 0.9575098945356127
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2604166666666667, precision 0.2372810021115106, recall 0.25260101010101005, F1 0.24223904388959594, AUC 0.4835132575757575
  Second-Tier acc 0.3125, precision 0.2873015873015873, recall 0.3162626262626263, F1 0.29914656771799625, AUC 0.4928282828282828
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.37244897959183676, precision 0.37242063492063493, recall 0.45475088183421514, F1 0.3650793650793651, AUC 0.5353698192239859
  Second-Tier acc 0.42857142857142855, precision 0.416744475568005, recall 0.49889770723104054, F1 0.4175824175824175, AUC 0.5433752204585538
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 11 idx: 0 First Loss : 3.045281171798706, Second Loss : 3.1771769523620605
epoch: 11 idx: 200 First Loss : 0.9207103904244022, Second Loss : 0.9492655578277894
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.28125, precision 0.2559721324427207, recall 0.2829040404040404, F1 0.2638657005629483, AUC 0.48632575757575763
  Second-Tier acc 0.3333333333333333, precision 0.3071794871794872, recall 0.3295959595959596, F1 0.31696969696969696, AUC 0.4969191919191919
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3673469387755102, precision 0.35392145601204833, recall 0.4430665784832451, F1 0.3512702758823842, AUC 0.5448874283509699
  Second-Tier acc 0.42857142857142855, precision 0.416744475568005, recall 0.49889770723104054, F1 0.4175824175824175, AUC 0.5484457671957673
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.4927760843247334e-05
epoch: 12 idx: 0 First Loss : 3.137928009033203, Second Loss : 3.2716643810272217
epoch: 12 idx: 200 First Loss : 0.9122346562254636, Second Loss : 0.9427831742300916
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2916666666666667, precision 0.2616894302940815, recall 0.28957070707070703, F1 0.26775271512113613, AUC 0.4901136363636364
  Second-Tier acc 0.3125, precision 0.2873015873015873, recall 0.3162626262626263, F1 0.29914656771799625, AUC 0.5007575757575757
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.3426063391068693, recall 0.4373346560846561, F1 0.3443913526053765, AUC 0.552737819664903
  Second-Tier acc 0.42857142857142855, precision 0.40058479532163743, recall 0.4874338624338624, F1 0.4018993352326685, AUC 0.5609016754850088
 
 test auc: 0.5609016754850088, test F1: 0.4018993352326685  :  from epoch 12
 current learn rate 1.4927760843247334e-05
epoch: 13 idx: 0 First Loss : 3.215611457824707, Second Loss : 3.3491322994232178
epoch: 13 idx: 200 First Loss : 0.9053670969370067, Second Loss : 0.9372004449172918
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3020833333333333, precision 0.27184802033778854, recall 0.30896464646464644, F1 0.2783182941719527, AUC 0.4935164141414141
  Second-Tier acc 0.3333333333333333, precision 0.2998941798941799, recall 0.3295959595959596, F1 0.3117460317460317, AUC 0.5044444444444444
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3826530612244898, precision 0.34962486772907736, recall 0.44659391534391535, F1 0.3564123564123564, AUC 0.5596443727954145
  Second-Tier acc 0.42857142857142855, precision 0.40058479532163743, recall 0.4874338624338624, F1 0.4018993352326685, AUC 0.5633267195767196
 
 test auc: 0.5633267195767196, test F1: 0.4018993352326685  :  from epoch 13
 current learn rate 1.4927760843247334e-05
epoch: 14 idx: 0 First Loss : 3.2759389877319336, Second Loss : 3.4146904945373535
epoch: 14 idx: 200 First Loss : 0.8992937598840811, Second Loss : 0.9326098960411934
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.296875, precision 0.26432138220313595, recall 0.3062626262626263, F1 0.2676347668620262, AUC 0.4957449494949495
  Second-Tier acc 0.3541666666666667, precision 0.313305152979066, recall 0.3598989898989899, F1 0.32958553791887124, AUC 0.5069191919191919
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3979591836734694, precision 0.35570175438596485, recall 0.4485229276895944, F1 0.36528106120304704, AUC 0.5611359126984127
  Second-Tier acc 0.40816326530612246, precision 0.35803412274000507, recall 0.4636243386243386, F1 0.38000000000000006, AUC 0.5686728395061729
 
 test auc: 0.5686728395061729, test F1: 0.38000000000000006  :  from epoch 14
 current learn rate 1.4927760843247334e-05
epoch: 15 idx: 0 First Loss : 3.319840431213379, Second Loss : 3.4642984867095947
epoch: 15 idx: 200 First Loss : 0.8931054549792142, Second Loss : 0.9276773452582718
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3177083333333333, precision 0.28385582311070723, recall 0.3323232323232323, F1 0.285042696798044, AUC 0.4955902777777778
  Second-Tier acc 0.3125, precision 0.2765107212475633, recall 0.33323232323232327, F1 0.291005291005291, AUC 0.5074242424242424
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.39285714285714285, precision 0.34607054197697473, recall 0.4425705467372134, F1 0.35783904204956835, AUC 0.5608982308201059
  Second-Tier acc 0.40816326530612246, precision 0.3524064171122994, recall 0.4636243386243386, F1 0.37770975056689343, AUC 0.5648148148148148
 
 test auc: 0.5648148148148148, test F1: 0.37770975056689343  :  from epoch 15
 current learn rate 1.4927760843247334e-05
epoch: 16 idx: 0 First Loss : 3.355325698852539, Second Loss : 3.507903814315796
epoch: 16 idx: 200 First Loss : 0.8872970206088465, Second Loss : 0.9231790499669031
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3177083333333333, precision 0.28820621086630943, recall 0.34080808080808084, F1 0.2839135825051318, AUC 0.4982638888888889
  Second-Tier acc 0.3541666666666667, precision 0.3106555753614577, recall 0.3938383838383838, F1 0.3246753246753246, AUC 0.5207575757575759
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3826530612244898, precision 0.3124747474747474, recall 0.4131393298059965, F1 0.3311806503552802, AUC 0.560653659611993
  Second-Tier acc 0.3877551020408163, precision 0.3111679454390452, recall 0.4398148148148148, F1 0.3466666666666667, AUC 0.5623346560846562
 
 test auc: 0.5623346560846562, test F1: 0.3466666666666667  :  from epoch 16
 current learn rate 1.4927760843247334e-05
epoch: 17 idx: 0 First Loss : 3.378045082092285, Second Loss : 3.538795232772827
epoch: 17 idx: 200 First Loss : 0.8816509502847211, Second Loss : 0.9185938536147795
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3385416666666667, precision 0.3074206286047763, recall 0.3711111111111111, F1 0.3006896122293311, AUC 0.5029166666666667
  Second-Tier acc 0.3333333333333333, precision 0.2999084249084249, recall 0.38050505050505046, F1 0.2980595980595981, AUC 0.5265656565656566
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3826530612244898, precision 0.30504837702871407, recall 0.4176036155202822, F1 0.32915964042915036, AUC 0.56078800154321
  Second-Tier acc 0.3877551020408163, precision 0.3111679454390452, recall 0.4398148148148148, F1 0.3466666666666667, AUC 0.5577050264550265
 
 test auc: 0.5577050264550265, test F1: 0.3466666666666667  :  from epoch 17
 current learn rate 1.4927760843247334e-05
epoch: 18 idx: 0 First Loss : 3.3908426761627197, Second Loss : 3.564389705657959
epoch: 18 idx: 200 First Loss : 0.8764383926227763, Second Loss : 0.9144638857632801
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3489583333333333, precision 0.31939736346516007, recall 0.382020202020202, F1 0.3088062903449159, AUC 0.5061205808080809
  Second-Tier acc 0.3125, precision 0.28769841269841273, recall 0.3671717171717172, F1 0.2772695772695773, AUC 0.5263131313131314
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3877551020408163, precision 0.30555344478216817, recall 0.41335978835978837, F1 0.3327553343569651, AUC 0.5577050264550264
  Second-Tier acc 0.3877551020408163, precision 0.3111679454390452, recall 0.4398148148148148, F1 0.3466666666666667, AUC 0.5556106701940036
 
 test auc: 0.5577050264550265, test F1: 0.3466666666666667  :  from epoch 17
 current learn rate 1.4927760843247334e-05
epoch: 19 idx: 0 First Loss : 3.3884077072143555, Second Loss : 3.584507942199707
epoch: 19 idx: 200 First Loss : 0.8714562324524407, Second Loss : 0.9109028816820859
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.359375, precision 0.33346836649588946, recall 0.3971717171717171, F1 0.3166816471919837, AUC 0.5112468434343435
  Second-Tier acc 0.3541666666666667, precision 0.3273809523809524, recall 0.41080808080808073, F1 0.3123816123816124, AUC 0.5307575757575758
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.37244897959183676, precision 0.28292212407351003, recall 0.3865740740740741, F1 0.3131966918374685, AUC 0.5551421957671958
  Second-Tier acc 0.3673469387755102, precision 0.2916666666666667, recall 0.39814814814814814, F1 0.3235294117647059, AUC 0.5563271604938271
 
 test auc: 0.5563271604938271, test F1: 0.3235294117647059  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.41574328641325387, "droprate_2": 0.0, "lr": 1.1628416538992639e-05, "weight_decay": 0.00011401935408258582, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.1628416538992639e-05
epoch: 0 idx: 0 First Loss : 0.8803505301475525, Second Loss : 1.0359355211257935
epoch: 0 idx: 200 First Loss : 1.0726859840884138, Second Loss : 1.065145003854932
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49834455667789007
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4963131313131313
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.456539045659416
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45789241622574955
 
 test auc: 0.45789241622574955, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.1628416538992639e-05
epoch: 1 idx: 0 First Loss : 1.5778017044067383, Second Loss : 1.8483326435089111
epoch: 1 idx: 200 First Loss : 1.098667201340495, Second Loss : 1.0993598774446183
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4979292929292929
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5116161616161616
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44795953360768176
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45116843033509707
 
 test auc: 0.45116843033509707, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 1.1628416538992639e-05
epoch: 2 idx: 0 First Loss : 1.7446602582931519, Second Loss : 2.017840623855591
epoch: 2 idx: 200 First Loss : 1.0881274157199101, Second Loss : 1.09231717009746
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4987429854096521
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5117171717171717
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44712669018224577
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44389329805996475
 
 test auc: 0.44389329805996475, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.1628416538992639e-05
epoch: 3 idx: 0 First Loss : 1.7993324995040894, Second Loss : 2.0763704776763916
epoch: 3 idx: 200 First Loss : 1.0778663259240526, Second Loss : 1.08261563795716
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5008922558922558
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5146464646464647
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.449600725063688
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44852292768959434
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 4 idx: 0 First Loss : 1.822378158569336, Second Loss : 2.1378636360168457
epoch: 4 idx: 200 First Loss : 1.0647986232493054, Second Loss : 1.0723390872798748
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.504040404040404
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5120202020202019
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4540037722908094
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45386904761904767
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 5 idx: 0 First Loss : 1.8654766082763672, Second Loss : 2.2058894634246826
epoch: 5 idx: 200 First Loss : 1.0528821954827996, Second Loss : 1.0610093399882317
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5034736251402917
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5058080808080808
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46287110523221636
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46103395061728397
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 6 idx: 0 First Loss : 1.916215419769287, Second Loss : 2.2919068336486816
epoch: 6 idx: 200 First Loss : 1.039387950367892, Second Loss : 1.047173359426693
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2986111111111111, precision 0.31728322568017225, recall 0.4057239057239057, F1 0.2661633255228673, AUC 0.5001234567901234
  Second-Tier acc 0.3125, precision 0.30952380952380953, recall 0.42676767676767674, F1 0.2926652142338417, AUC 0.5020707070707071
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2857142857142857, precision 0.09859154929577464, recall 0.3333333333333333, F1 0.15217391304347824, AUC 0.4709913286302175
  Second-Tier acc 0.30612244897959184, precision 0.4326241134751773, recall 0.375, F1 0.22707953855494836, AUC 0.4697971781305115
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 7 idx: 0 First Loss : 1.9833215475082397, Second Loss : 2.3877835273742676
epoch: 7 idx: 200 First Loss : 1.0237206810371793, Second Loss : 1.0319193927432173
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2916666666666667, precision 0.26210826210826216, recall 0.40151515151515155, F1 0.2843137254901961, AUC 0.4918742985409652
  Second-Tier acc 0.3125, precision 0.3033033033033033, recall 0.4318181818181818, F1 0.32244897959183677, AUC 0.4902525252525252
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.23809523809523808, precision 0.10582010582010581, recall 0.2739564961787184, F1 0.14145658263305322, AUC 0.4873175093082501
  Second-Tier acc 0.30612244897959184, precision 0.4805555555555556, recall 0.3992504409171076, F1 0.33782267115600445, AUC 0.4762455908289241
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 8 idx: 0 First Loss : 2.064709424972534, Second Loss : 2.4899375438690186
epoch: 8 idx: 200 First Loss : 1.0076123516061413, Second Loss : 1.0165554515980368
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3472222222222222, precision 0.2684903748733536, recall 0.4865319865319866, F1 0.34046278924327705, AUC 0.48441638608305276
  Second-Tier acc 0.2916666666666667, precision 0.2722222222222222, recall 0.4065656565656566, F1 0.3140096618357488, AUC 0.4852020202020202
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.2857142857142857, precision 0.44357092941998594, recall 0.278586125808348, F1 0.26696603562275206, AUC 0.501249265138154
  Second-Tier acc 0.2857142857142857, precision 0.32243589743589746, recall 0.3181216931216931, F1 0.30357142857142855, AUC 0.48941798941798936
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 9 idx: 0 First Loss : 2.15962553024292, Second Loss : 2.606215715408325
epoch: 9 idx: 200 First Loss : 0.9903409391530414, Second Loss : 1.000794710619236
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3125, precision 0.4004991988167139, recall 0.420976430976431, F1 0.3084828378678923, AUC 0.48773288439955104
  Second-Tier acc 0.25, precision 0.2916666666666667, recall 0.3221212121212121, F1 0.2944901423162293, AUC 0.48434343434343435
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.2789115646258503, precision 0.3087890085611709, recall 0.24390064667842445, F1 0.24962755637385914, AUC 0.5100614834411131
  Second-Tier acc 0.32653061224489793, precision 0.3689839572192513, recall 0.37852733686067014, F1 0.36195286195286197, AUC 0.5033619929453262
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 10 idx: 0 First Loss : 2.262655019760132, Second Loss : 2.720590114593506
epoch: 10 idx: 200 First Loss : 0.9759163908956953, Second Loss : 0.9878658439167103
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3055555555555556, precision 0.348187134502924, recall 0.4029292929292929, F1 0.2895054862055233, AUC 0.4965656565656566
  Second-Tier acc 0.3333333333333333, precision 0.33796296296296297, recall 0.361010101010101, F1 0.3428128460686601, AUC 0.4921212121212122
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.29931972789115646, precision 0.31875901875901874, recall 0.2583774250440917, F1 0.27037312815421527, AUC 0.5160016166960611
  Second-Tier acc 0.3673469387755102, precision 0.38898150353258715, recall 0.4618606701940035, F1 0.40404040404040403, AUC 0.5158179012345679
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 11 idx: 0 First Loss : 2.3567118644714355, Second Loss : 2.8309011459350586
epoch: 11 idx: 200 First Loss : 0.96326438070678, Second Loss : 0.9762827865223387
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3125, precision 0.3428662521919337, recall 0.3985858585858586, F1 0.2885131508319914, AUC 0.5073120089786757
  Second-Tier acc 0.3541666666666667, precision 0.32049910873440285, recall 0.37686868686868685, F1 0.3379802162410858, AUC 0.5009595959595959
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.29931972789115646, precision 0.2749318582651916, recall 0.2583774250440917, F1 0.2626933895921238, AUC 0.5182735645698608
  Second-Tier acc 0.40816326530612246, precision 0.39766081871345027, recall 0.4865520282186948, F1 0.416791604197901, AUC 0.529320987654321
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 12 idx: 0 First Loss : 2.4448587894439697, Second Loss : 2.926830291748047
epoch: 12 idx: 200 First Loss : 0.9524534495260141, Second Loss : 0.9658219301285436
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.33967341725962413, recall 0.40831649831649836, F1 0.2949074074074074, AUC 0.5147025813692481
  Second-Tier acc 0.3541666666666667, precision 0.3148148148148148, recall 0.37686868686868685, F1 0.33272959479856035, AUC 0.5117676767676768
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3129251700680272, precision 0.25609403516380264, recall 0.2551440329218107, F1 0.25530474209926896, AUC 0.5206741132667059
  Second-Tier acc 0.4489795918367347, precision 0.42857142857142855, recall 0.5112433862433862, F1 0.4502164502164501, AUC 0.5383046737213404
 
 test auc: 0.44852292768959434, test F1: 0.14814814814814814  :  from epoch 3
 current learn rate 1.1628416538992639e-05
epoch: 13 idx: 0 First Loss : 2.518491506576538, Second Loss : 3.008910655975342
epoch: 13 idx: 200 First Loss : 0.9430098549291417, Second Loss : 0.9587614153099445
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3402777777777778, precision 0.3435185185185185, recall 0.41804713804713806, F1 0.30138786236347215, AUC 0.5220819304152639
  Second-Tier acc 0.375, precision 0.3302634184987126, recall 0.3902020202020202, F1 0.34988179669030733, AUC 0.5182323232323233
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3401360544217687, precision 0.28005050505050505, recall 0.2813786008230453, F1 0.2799518857211165, AUC 0.5239871154223006
  Second-Tier acc 0.4489795918367347, precision 0.41964285714285715, recall 0.5112433862433862, F1 0.4380341880341881, AUC 0.550650352733686
 
 test auc: 0.550650352733686, test F1: 0.4380341880341881  :  from epoch 13
 current learn rate 1.1628416538992639e-05
epoch: 14 idx: 0 First Loss : 2.5967507362365723, Second Loss : 3.083597421646118
epoch: 14 idx: 200 First Loss : 0.9353569185648539, Second Loss : 0.952307910709387
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.3597090937914908, recall 0.4313804713804714, F1 0.32075130085634623, AUC 0.5330639730639731
  Second-Tier acc 0.4375, precision 0.3742857142857143, recall 0.4302020202020202, F1 0.39261858349577644, AUC 0.5245454545454545
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.30493472935333404, recall 0.32106114050558493, F1 0.3115256666154869, AUC 0.5265101410934744
  Second-Tier acc 0.40816326530612246, precision 0.3524064171122994, recall 0.4636243386243386, F1 0.37770975056689343, AUC 0.5500440917107584
 
 test auc: 0.5500440917107584, test F1: 0.37770975056689343  :  from epoch 14
 current learn rate 1.1628416538992639e-05
epoch: 15 idx: 0 First Loss : 2.669252395629883, Second Loss : 3.151541233062744
epoch: 15 idx: 200 First Loss : 0.9289394509075071, Second Loss : 0.9470586993393317
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.3755085741132253, recall 0.4390572390572391, F1 0.34084210490510713, AUC 0.5408193041526376
  Second-Tier acc 0.4583333333333333, precision 0.3888888888888889, recall 0.4435353535353535, F1 0.4045025417574437, AUC 0.5273232323232323
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.29955724225173946, recall 0.33296590241034685, F1 0.31334103537437424, AUC 0.5276001861650009
  Second-Tier acc 0.3877551020408163, precision 0.3035426731078905, recall 0.4398148148148148, F1 0.33948717948717944, AUC 0.5589726631393298
 
 test auc: 0.5589726631393298, test F1: 0.33948717948717944  :  from epoch 15
 current learn rate 1.1628416538992639e-05
epoch: 16 idx: 0 First Loss : 2.7364978790283203, Second Loss : 3.210569381713867
epoch: 16 idx: 200 First Loss : 0.9234156023331024, Second Loss : 0.9424083892867636
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.37370134109264547, recall 0.4431313131313131, F1 0.3474412436276843, AUC 0.549006734006734
  Second-Tier acc 0.4375, precision 0.37160493827160496, recall 0.4132323232323232, F1 0.3831908831908832, AUC 0.53
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.28369728597726773, recall 0.3291446208112874, F1 0.30144907586127095, AUC 0.5278022731726435
  Second-Tier acc 0.3877551020408163, precision 0.3035426731078905, recall 0.4398148148148148, F1 0.33948717948717944, AUC 0.560626102292769
 
 test auc: 0.560626102292769, test F1: 0.33948717948717944  :  from epoch 16
 current learn rate 1.1628416538992639e-05
epoch: 17 idx: 0 First Loss : 2.7963736057281494, Second Loss : 3.2601706981658936
epoch: 17 idx: 200 First Loss : 0.9183707801458328, Second Loss : 0.9382268460838133
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3888888888888889, precision 0.3662565504670767, recall 0.43303030303030304, F1 0.3411161449000936, AUC 0.5561560044893378
  Second-Tier acc 0.4166666666666667, precision 0.3528104575163398, recall 0.3998989898989898, F1 0.3637037037037037, AUC 0.5365656565656566
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3401360544217687, precision 0.2575294554834197, recall 0.317092886537331, F1 0.27926896842559495, AUC 0.5276491769547326
  Second-Tier acc 0.3877551020408163, precision 0.3035426731078905, recall 0.4398148148148148, F1 0.33948717948717944, AUC 0.5602402998236332
 
 test auc: 0.5602402998236332, test F1: 0.33948717948717944  :  from epoch 17
 current learn rate 1.1628416538992639e-05
epoch: 18 idx: 0 First Loss : 2.8493239879608154, Second Loss : 3.2999112606048584
epoch: 18 idx: 200 First Loss : 0.9137042073292, Second Loss : 0.9342201846531263
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4027777777777778, precision 0.3737339602311685, recall 0.4419191919191919, F1 0.35180623973727426, AUC 0.561705948372615
  Second-Tier acc 0.4166666666666667, precision 0.3528104575163398, recall 0.3998989898989898, F1 0.3637037037037037, AUC 0.538989898989899
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.23845050215208033, recall 0.30915637860082307, F1 0.2654309545875811, AUC 0.5270612874779541
  Second-Tier acc 0.3877551020408163, precision 0.3035426731078905, recall 0.4398148148148148, F1 0.33948717948717944, AUC 0.5648699294532628
 
 test auc: 0.5648699294532628, test F1: 0.33948717948717944  :  from epoch 18
 current learn rate 1.1628416538992639e-05
epoch: 19 idx: 0 First Loss : 2.894243001937866, Second Loss : 3.3309669494628906
epoch: 19 idx: 200 First Loss : 0.9093180006179977, Second Loss : 0.9302743901475449
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3958333333333333, precision 0.3702786377708978, recall 0.4374747474747474, F1 0.3449855965699739, AUC 0.5650785634118968
  Second-Tier acc 0.4375, precision 0.3703703703703704, recall 0.4302020202020202, F1 0.38421038913649747, AUC 0.5393434343434343
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.23845050215208033, recall 0.30915637860082307, F1 0.2654309545875811, AUC 0.5266142465216539
  Second-Tier acc 0.3877551020408163, precision 0.3035426731078905, recall 0.4398148148148148, F1 0.33948717948717944, AUC 0.5710427689594356
 
 test auc: 0.5710427689594356, test F1: 0.33948717948717944  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.28323717118323066, "droprate_2": 0.0, "lr": 4.212384092990509e-05, "weight_decay": 0.00032449111138363175, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.212384092990509e-05
epoch: 0 idx: 0 First Loss : 1.24612557888031, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.125009350145041, Second Loss : 1.1144785878818426
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7258473625140293
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7552020202020202
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6823192239858905
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.673831569664903
 
 test auc: 0.673831569664903, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 4.212384092990509e-05
epoch: 1 idx: 0 First Loss : 2.1856563091278076, Second Loss : 2.1298184394836426
epoch: 1 idx: 200 First Loss : 1.0592902729019005, Second Loss : 1.0591499929997459
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7400392817059483
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7591919191919191
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7125465412502449
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118055555555557
 
 test auc: 0.7118055555555557, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.212384092990509e-05
epoch: 2 idx: 0 First Loss : 2.3629589080810547, Second Loss : 2.29984974861145
epoch: 2 idx: 200 First Loss : 1.0127347385631271, Second Loss : 1.0116155741374884
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5763888888888888, precision 0.6006495726495726, recall 0.42124579124579126, F1 0.39683062968777255, AUC 0.7340179573512907
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.751010101010101
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6054421768707483, precision 0.406620742441638, recall 0.4444444444444444, F1 0.39530693484181856, AUC 0.7085599157358416
  Second-Tier acc 0.5714285714285714, precision 0.27121212121212124, recall 0.35714285714285715, F1 0.288608846058809, AUC 0.7138999118165784
 
 test auc: 0.7118055555555557, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.212384092990509e-05
epoch: 3 idx: 0 First Loss : 2.6491105556488037, Second Loss : 2.673245668411255
epoch: 3 idx: 200 First Loss : 0.9686346348764291, Second Loss : 0.9737141282849051
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5763888888888888, precision 0.5173809523809524, recall 0.5209090909090909, F1 0.5117320164886957, AUC 0.7234792368125701
  Second-Tier acc 0.6458333333333334, precision 0.5666666666666668, recall 0.594949494949495, F1 0.5519945909398243, AUC 0.7434343434343433
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5306122448979592, precision 0.48565821256038655, recall 0.5172692533803644, F1 0.4821964821964822, AUC 0.7036792083088379
  Second-Tier acc 0.6530612244897959, precision 0.6437400318979266, recall 0.6677689594356261, F1 0.6482426303854875, AUC 0.7175374779541445
 
 test auc: 0.7118055555555557, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.212384092990509e-05
epoch: 4 idx: 0 First Loss : 3.0900685787200928, Second Loss : 3.060030698776245
epoch: 4 idx: 200 First Loss : 0.9403444102766058, Second Loss : 0.9493063341511127
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4861111111111111, precision 0.4983796296296296, recall 0.49683501683501685, F1 0.45645154630661877, AUC 0.7338271604938272
  Second-Tier acc 0.5208333333333334, precision 0.5758477633477633, recall 0.5702020202020203, F1 0.5185185185185185, AUC 0.7571212121212122
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.4716931216931217, recall 0.506981187536743, F1 0.43469235184962685, AUC 0.7141938565549676
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7461419753086419
 
 test auc: 0.7118055555555557, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.212384092990509e-05
epoch: 5 idx: 0 First Loss : 3.4207820892333984, Second Loss : 3.4380342960357666
epoch: 5 idx: 200 First Loss : 0.9284887944964405, Second Loss : 0.9404877375774271
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4513888888888889, precision 0.5049457499548243, recall 0.4898989898989899, F1 0.4311442743139116, AUC 0.7410886644219978
  Second-Tier acc 0.5, precision 0.5670454545454545, recall 0.556868686868687, F1 0.4997113997113997, AUC 0.7806060606060606
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.4910394265232974, recall 0.5102145796590242, F1 0.430098104236204, AUC 0.723232657260435
  Second-Tier acc 0.5102040816326531, precision 0.5389499389499389, recall 0.605599647266314, F1 0.5219461697722567, AUC 0.7584325396825395
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 6 idx: 0 First Loss : 3.672207832336426, Second Loss : 3.68397855758667
epoch: 6 idx: 200 First Loss : 0.9228685858325838, Second Loss : 0.9366724725154725
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4375, precision 0.5039428231089934, recall 0.49232323232323233, F1 0.4247520613169202, AUC 0.7452244668911336
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5605050505050505, F1 0.4795093795093795, AUC 0.778989898989899
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.51692037470726, recall 0.5257936507936508, F1 0.4434728417738126, AUC 0.7285114148540076
  Second-Tier acc 0.5102040816326531, precision 0.5722222222222223, recall 0.5992063492063492, F1 0.5115138021316511, AUC 0.7638888888888888
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 7 idx: 0 First Loss : 3.822739362716675, Second Loss : 3.8333938121795654
epoch: 7 idx: 200 First Loss : 0.9198296657133272, Second Loss : 0.9353550001492362
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4583333333333333, precision 0.5429516116258811, recall 0.5308080808080808, F1 0.457822148923864, AUC 0.7510886644219977
  Second-Tier acc 0.4583333333333333, precision 0.5449999999999999, recall 0.5327272727272727, F1 0.45622895622895626, AUC 0.7753535353535354
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.47619047619047616, precision 0.5711261261261261, recall 0.5709876543209876, F1 0.47852960312296683, AUC 0.735345630021556
  Second-Tier acc 0.5102040816326531, precision 0.5934065934065934, recall 0.5813492063492064, F1 0.5015151515151516, AUC 0.7807539682539684
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 8 idx: 0 First Loss : 3.890735626220703, Second Loss : 3.899625301361084
epoch: 8 idx: 200 First Loss : 0.9156834328018907, Second Loss : 0.9343195429108851
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4375, precision 0.5300740195477037, recall 0.5095286195286195, F1 0.43831588726833154, AUC 0.7557239057239057
  Second-Tier acc 0.4166666666666667, precision 0.5014245014245015, recall 0.4602020202020202, F1 0.40767355590885, AUC 0.7655050505050505
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5834004834810637, recall 0.574808935920047, F1 0.47555183946488294, AUC 0.7414633548892807
  Second-Tier acc 0.5306122448979592, precision 0.6062271062271063, recall 0.6051587301587301, F1 0.5181818181818182, AUC 0.7836750440917107
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 9 idx: 0 First Loss : 3.919170379638672, Second Loss : 3.918781280517578
epoch: 9 idx: 200 First Loss : 0.9107454088551284, Second Loss : 0.9312012035026683
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.49982726547967044, recall 0.46444444444444444, F1 0.39515534731383345, AUC 0.7508305274971941
  Second-Tier acc 0.3958333333333333, precision 0.4872222222222222, recall 0.44686868686868686, F1 0.388327721661055, AUC 0.7452525252525253
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4557823129251701, precision 0.5748816768086544, recall 0.564594356261023, F1 0.45536281031259507, AUC 0.747905643738977
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7798721340388006
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 10 idx: 0 First Loss : 3.9258623123168945, Second Loss : 3.8838441371917725
epoch: 10 idx: 200 First Loss : 0.9061158050971791, Second Loss : 0.9275891571108771
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3958333333333333, precision 0.5010145385285363, recall 0.4717845117845118, F1 0.3921393836800143, AUC 0.7436251402918069
  Second-Tier acc 0.375, precision 0.45405982905982906, recall 0.4216161616161616, F1 0.35264221158958, AUC 0.734949494949495
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.5748816768086544, recall 0.564594356261023, F1 0.45536281031259507, AUC 0.7563259357240838
  Second-Tier acc 0.46938775510204084, precision 0.5633333333333334, recall 0.5273368606701939, F1 0.4515262515262515, AUC 0.78125
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 11 idx: 0 First Loss : 3.9223053455352783, Second Loss : 3.859900951385498
epoch: 11 idx: 200 First Loss : 0.9010960433570743, Second Loss : 0.9251635650431145
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.375, precision 0.4841617026557459, recall 0.4536363636363636, F1 0.3693064182194617, AUC 0.733742985409652
  Second-Tier acc 0.3541666666666667, precision 0.4455433455433455, recall 0.4082828282828283, F1 0.33654487821154494, AUC 0.7147474747474748
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.5653530377668309, recall 0.5424750146972369, F1 0.4337224157955865, AUC 0.7584692827748384
  Second-Tier acc 0.46938775510204084, precision 0.5645424836601307, recall 0.5273368606701939, F1 0.45203007518796995, AUC 0.7770612874779541
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 12 idx: 0 First Loss : 3.894502878189087, Second Loss : 3.8233814239501953
epoch: 12 idx: 200 First Loss : 0.896309688908282, Second Loss : 0.9230472616001671
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.4936009213812107, recall 0.4786531986531986, F1 0.3814425770308123, AUC 0.7219528619528619
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.4082828282828283, F1 0.3341767881241566, AUC 0.6929292929292931
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5623781676413255, recall 0.5324074074074074, F1 0.42487250674385174, AUC 0.7537661669606114
  Second-Tier acc 0.4489795918367347, precision 0.5584313725490196, recall 0.5149911816578483, F1 0.431955756661639, AUC 0.7768408289241623
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 13 idx: 0 First Loss : 3.8852615356445312, Second Loss : 3.7967538833618164
epoch: 13 idx: 200 First Loss : 0.8934964204976794, Second Loss : 0.9209586269606197
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.4763888888888889, recall 0.45003367003367, F1 0.3597415367326871, AUC 0.7082940516273849
  Second-Tier acc 0.3541666666666667, precision 0.44413919413919417, recall 0.4082828282828283, F1 0.3321794871794872, AUC 0.6840909090909092
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5696589446589447, recall 0.5441651969429747, F1 0.42972671827351633, AUC 0.7481016068979032
  Second-Tier acc 0.46938775510204084, precision 0.5705128205128206, recall 0.5388007054673721, F1 0.4483660130718954, AUC 0.7782738095238096
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 14 idx: 0 First Loss : 3.884775161743164, Second Loss : 3.782590389251709
epoch: 14 idx: 200 First Loss : 0.8904669564121764, Second Loss : 0.9210688580037211
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.468621345787926, recall 0.44643097643097646, F1 0.3498282987020546, AUC 0.6962850729517395
  Second-Tier acc 0.3541666666666667, precision 0.44413919413919417, recall 0.4082828282828283, F1 0.3321794871794872, AUC 0.6761111111111111
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.42857142857142855, precision 0.5678836731468311, recall 0.5400499706055262, F1 0.42229712431553096, AUC 0.745505095042132
  Second-Tier acc 0.46938775510204084, precision 0.5703703703703703, recall 0.5388007054673721, F1 0.44831888216580373, AUC 0.7766203703703703
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 15 idx: 0 First Loss : 3.8656556606292725, Second Loss : 3.756016731262207
epoch: 15 idx: 200 First Loss : 0.889628997278621, Second Loss : 0.9193689564685453
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.4681559571619813, recall 0.44161616161616163, F1 0.34917594112996414, AUC 0.6903535353535354
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6692424242424243
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5748917748917749, recall 0.5518077601410935, F1 0.42689829096195436, AUC 0.7446661277679797
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7750771604938272
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 16 idx: 0 First Loss : 3.8931615352630615, Second Loss : 3.738361358642578
epoch: 16 idx: 200 First Loss : 0.8893665492360014, Second Loss : 0.919396437044442
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4675439211288665, recall 0.4424579124579125, F1 0.34603174603174597, AUC 0.68506734006734
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.673131313131313
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5655188904830225, recall 0.527851263962375, F1 0.4089983022071307, AUC 0.7406427591612776
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7707231040564374
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 17 idx: 0 First Loss : 3.8879683017730713, Second Loss : 3.7135393619537354
epoch: 17 idx: 200 First Loss : 0.8896080106790745, Second Loss : 0.9187227334881918
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.46507936507936504, recall 0.44811447811447813, F1 0.34401709401709396, AUC 0.6875196408529742
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.42525252525252527, F1 0.3297491039426523, AUC 0.6823737373737373
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41496598639455784, precision 0.5595238095238094, recall 0.5139623750734862, F1 0.4007026699168011, AUC 0.7372378992749363
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7660383597883597
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 18 idx: 0 First Loss : 3.862093687057495, Second Loss : 3.6953697204589844
epoch: 18 idx: 200 First Loss : 0.8871778855563619, Second Loss : 0.9181553419885446
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.4692460317460318, recall 0.4525589225589226, F1 0.35214692714692714, AUC 0.6876543209876544
  Second-Tier acc 0.375, precision 0.4679012345679012, recall 0.45303030303030306, F1 0.3570395522857323, AUC 0.6821212121212121
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.554563492063492, recall 0.5041887125220459, F1 0.39914021164021163, AUC 0.7330369390554576
  Second-Tier acc 0.4897959183673469, precision 0.6064814814814815, recall 0.6097883597883598, F1 0.48300073909830005, AUC 0.7649911816578484
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5
 current learn rate 4.212384092990509e-05
epoch: 19 idx: 0 First Loss : 3.83001971244812, Second Loss : 3.679532527923584
epoch: 19 idx: 200 First Loss : 0.8846618777507451, Second Loss : 0.9169159400368351
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3680555555555556, precision 0.46821371770489245, recall 0.4477441077441077, F1 0.35049434793680323, AUC 0.6856565656565657
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.6903535353535353
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.40816326530612246, precision 0.5549179021201976, recall 0.5060258671369783, F1 0.39473306923222035, AUC 0.7291727905153831
  Second-Tier acc 0.46938775510204084, precision 0.599128540305011, recall 0.5974426807760141, F1 0.45928861788617886, AUC 0.7591490299823632
 
 test auc: 0.7584325396825395, test F1: 0.5219461697722567  :  from epoch 5{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.3195298799931397, "droprate_2": 0.0, "lr": 3.4376419884360534e-05, "weight_decay": 0.00047032616657151653, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 3.4376419884360534e-05
epoch: 0 idx: 0 First Loss : 1.2364625930786133, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1248567649232808, Second Loss : 1.1097596662109763
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7213243546576881
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7609595959595961
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6701756319811875
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6647376543209876
 
 test auc: 0.6647376543209876, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 3.4376419884360534e-05
epoch: 1 idx: 0 First Loss : 2.186359167098999, Second Loss : 2.1219258308410645
epoch: 1 idx: 200 First Loss : 1.075556202685062, Second Loss : 1.0702686172664462
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7389955106621772
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7667171717171718
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7086150303742897
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7077821869488536
 
 test auc: 0.7077821869488536, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.4376419884360534e-05
epoch: 2 idx: 0 First Loss : 2.358186960220337, Second Loss : 2.2668397426605225
epoch: 2 idx: 200 First Loss : 1.0333509845520132, Second Loss : 1.0280320838612704
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17857142857142858, recall 0.3333333333333333, F1 0.23255813953488372, AUC 0.737800224466891
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7528282828282827
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.34722222222222227, F1 0.2645521292217327, AUC 0.7183948167744464
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7157738095238096
 
 test auc: 0.7077821869488536, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.4376419884360534e-05
epoch: 3 idx: 0 First Loss : 2.628316879272461, Second Loss : 2.543840169906616
epoch: 3 idx: 200 First Loss : 0.9915592800547828, Second Loss : 0.9917133857880659
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6111111111111112, precision 0.5740332168903598, recall 0.48764309764309766, F1 0.4798555101825353, AUC 0.7298989898989899
  Second-Tier acc 0.6458333333333334, precision 0.4166666666666667, recall 0.566060606060606, F1 0.4795321637426901, AUC 0.7442424242424243
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5782312925170068, precision 0.4756944444444445, recall 0.5155055849500294, F1 0.46996729110912877, AUC 0.7079659024103467
  Second-Tier acc 0.6326530612244898, precision 0.6222222222222222, recall 0.5330687830687831, F1 0.5446039340776183, AUC 0.7114197530864198
 
 test auc: 0.7077821869488536, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.4376419884360534e-05
epoch: 4 idx: 0 First Loss : 2.960134506225586, Second Loss : 2.8719308376312256
epoch: 4 idx: 200 First Loss : 0.9579461570551147, Second Loss : 0.9628194675998605
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5277777777777778, precision 0.5043583802272978, recall 0.5008754208754209, F1 0.4600694444444445, AUC 0.7276430976430976
  Second-Tier acc 0.5833333333333334, precision 0.5589095287237702, recall 0.5813131313131313, F1 0.5566378066378067, AUC 0.7490404040404041
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4897959183673469, precision 0.4637090549844092, recall 0.5066137566137566, F1 0.44241870661308, AUC 0.7141509896139526
  Second-Tier acc 0.6326530612244898, precision 0.6301169590643275, recall 0.6911375661375662, F1 0.6373737373737373, AUC 0.7312610229276896
 
 test auc: 0.7077821869488536, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 3.4376419884360534e-05
epoch: 5 idx: 0 First Loss : 3.3053877353668213, Second Loss : 3.203824996948242
epoch: 5 idx: 200 First Loss : 0.939900052460346, Second Loss : 0.9469959051603108
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4305555555555556, precision 0.45294705294705295, recall 0.4474410774410775, F1 0.3797107908681226, AUC 0.7375420875420876
  Second-Tier acc 0.5208333333333334, precision 0.5838468720821662, recall 0.5846464646464646, F1 0.5220032840722496, AUC 0.7737878787878788
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4421768707482993, precision 0.4870219386348418, recall 0.5245443856554967, F1 0.42344892023448916, AUC 0.7238082990397805
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7629519400352734
 
 test auc: 0.7629519400352734, test F1: 0.49836601307189543  :  from epoch 5
 current learn rate 3.4376419884360534e-05
epoch: 6 idx: 0 First Loss : 3.5455219745635986, Second Loss : 3.4562220573425293
epoch: 6 idx: 200 First Loss : 0.93017656523827, Second Loss : 0.9405052441529077
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4236111111111111, precision 0.46265772294693325, recall 0.4478114478114478, F1 0.3741159357438428, AUC 0.7394500561167227
  Second-Tier acc 0.5, precision 0.5743711626064568, recall 0.5713131313131313, F1 0.5023869526912123, AUC 0.787020202020202
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.48309272426919475, recall 0.5121987066431511, F1 0.40714488694028333, AUC 0.7285542817950225
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7629519400352734
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 7 idx: 0 First Loss : 3.7365481853485107, Second Loss : 3.653144359588623
epoch: 7 idx: 200 First Loss : 0.9244068807491393, Second Loss : 0.9378025200801776
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3958333333333333, precision 0.45647058823529413, recall 0.4317171717171717, F1 0.36499074873566056, AUC 0.7465768799102133
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7823737373737374
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.527635796751779, recall 0.5236625514403292, F1 0.41533844836375344, AUC 0.7331349206349206
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7708884479717812
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 8 idx: 0 First Loss : 3.849022626876831, Second Loss : 3.760896682739258
epoch: 8 idx: 200 First Loss : 0.9200436752173697, Second Loss : 0.9359320593877366
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.4852837925127082, recall 0.4531313131313131, F1 0.38198475266395215, AUC 0.7559539842873176
  Second-Tier acc 0.4583333333333333, precision 0.5416666666666666, recall 0.5327272727272727, F1 0.4556998556998557, AUC 0.7790909090909092
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.5218518518518519, recall 0.52336860670194, F1 0.4124168261781059, AUC 0.7440353713501863
  Second-Tier acc 0.5102040816326531, precision 0.5972222222222222, recall 0.5992063492063492, F1 0.5087719298245613, AUC 0.7810846560846562
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 9 idx: 0 First Loss : 3.8959391117095947, Second Loss : 3.792916774749756
epoch: 9 idx: 200 First Loss : 0.9143040018302124, Second Loss : 0.9315868196267616
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4375, precision 0.5251351351351351, recall 0.5149494949494949, F1 0.42963048365711654, AUC 0.7547979797979797
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7704545454545455
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.5790642076502732, recall 0.5865667254556143, F1 0.4644012944983819, AUC 0.7508695865177346
  Second-Tier acc 0.46938775510204084, precision 0.5708333333333333, recall 0.5451940035273369, F1 0.4622100122100122, AUC 0.7782738095238094
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 10 idx: 0 First Loss : 3.9146134853363037, Second Loss : 3.8095977306365967
epoch: 10 idx: 200 First Loss : 0.9093407644341186, Second Loss : 0.9282229172265092
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4097222222222222, precision 0.5071365832235398, recall 0.47875420875420877, F1 0.4068162831320726, AUC 0.7488047138047138
  Second-Tier acc 0.375, precision 0.4757142857142857, recall 0.4335353535353535, F1 0.36838624338624343, AUC 0.7576767676767676
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5708280790248003, recall 0.562610229276896, F1 0.44988088693421285, AUC 0.7559156378600823
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7857142857142857
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 11 idx: 0 First Loss : 3.9236128330230713, Second Loss : 3.793332576751709
epoch: 11 idx: 200 First Loss : 0.9055656343495788, Second Loss : 0.9248520155444241
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.49516908212560384, recall 0.4648148148148148, F1 0.38751844823951087, AUC 0.7407182940516274
  Second-Tier acc 0.375, precision 0.4757142857142857, recall 0.4335353535353535, F1 0.36838624338624343, AUC 0.7434343434343433
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.5757575757575758, recall 0.5705467372134039, F1 0.4564788878514368, AUC 0.7583774250440918
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7818562610229277
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 12 idx: 0 First Loss : 3.9177820682525635, Second Loss : 3.7864034175872803
epoch: 12 idx: 200 First Loss : 0.9016199992241023, Second Loss : 0.9225339106184463
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3958333333333333, precision 0.5003299637039925, recall 0.48141414141414146, F1 0.3920439759118655, AUC 0.7292536475869809
  Second-Tier acc 0.3541666666666667, precision 0.44413919413919417, recall 0.4082828282828283, F1 0.3321794871794872, AUC 0.7231818181818181
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.5663398692810457, recall 0.5484273956496178, F1 0.43503607503607505, AUC 0.7586285028414658
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7798170194003528
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 13 idx: 0 First Loss : 3.8953981399536133, Second Loss : 3.7716078758239746
epoch: 13 idx: 200 First Loss : 0.8975411298032039, Second Loss : 0.9211964692870637
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.48652449149024496, recall 0.46855218855218855, F1 0.37597622503282885, AUC 0.7165488215488215
  Second-Tier acc 0.3541666666666667, precision 0.4455433455433455, recall 0.4082828282828283, F1 0.33654487821154494, AUC 0.7100505050505049
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5585542929292929, recall 0.5322604350382129, F1 0.4139066400971163, AUC 0.7553583676268861
  Second-Tier acc 0.46938775510204084, precision 0.5703703703703703, recall 0.5388007054673721, F1 0.44831888216580373, AUC 0.7757385361552028
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 14 idx: 0 First Loss : 3.8705883026123047, Second Loss : 3.743779182434082
epoch: 14 idx: 200 First Loss : 0.8949442988236096, Second Loss : 0.9206885233578221
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3680555555555556, precision 0.47504137702747434, recall 0.45484848484848484, F1 0.3602698461785154, AUC 0.7048204264870931
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.4082828282828283, F1 0.3341767881241566, AUC 0.6895454545454545
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.5500390320062452, recall 0.5083039388594944, F1 0.3980608738340698, AUC 0.7491855281207133
  Second-Tier acc 0.46938775510204084, precision 0.5703703703703703, recall 0.5388007054673721, F1 0.44831888216580373, AUC 0.7759589947089948
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 15 idx: 0 First Loss : 3.8384838104248047, Second Loss : 3.7086005210876465
epoch: 15 idx: 200 First Loss : 0.8920730724557192, Second Loss : 0.920012654701308
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6949326599326598
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.6846969696969697
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.549812030075188, recall 0.5002204585537918, F1 0.3930084745762712, AUC 0.7440966098373506
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7761243386243386
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 16 idx: 0 First Loss : 3.825892686843872, Second Loss : 3.6851792335510254
epoch: 16 idx: 200 First Loss : 0.8900114460780219, Second Loss : 0.9212508097120714
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.47002779966727964, recall 0.44077441077441076, F1 0.3517025495465571, AUC 0.6861447811447811
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.6797474747474747
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5645021645021645, recall 0.5299823633156966, F1 0.41285723150019504, AUC 0.7418736527532824
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7751873897707231
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 17 idx: 0 First Loss : 3.833909034729004, Second Loss : 3.6479904651641846
epoch: 17 idx: 200 First Loss : 0.8891075482079123, Second Loss : 0.9200947649960246
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.4747923294450336, recall 0.4508754208754209, F1 0.3574508912790992, AUC 0.6825084175084175
  Second-Tier acc 0.3333333333333333, precision 0.42974910394265237, recall 0.41191919191919196, F1 0.30317460317460315, AUC 0.6779797979797979
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5651176133103845, recall 0.5260141093474426, F1 0.41335388127853884, AUC 0.7412735155790712
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7749669312169312
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 18 idx: 0 First Loss : 3.8724262714385986, Second Loss : 3.6454062461853027
epoch: 18 idx: 200 First Loss : 0.8868841546486579, Second Loss : 0.9199231751590379
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.4728535353535353, recall 0.45171717171717174, F1 0.3547822547822548, AUC 0.6808698092031426
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.6774242424242424
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5719203343988197, recall 0.5399029982363316, F1 0.422486301369863, AUC 0.7386953752694495
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7744708994708995
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6
 current learn rate 3.4376419884360534e-05
epoch: 19 idx: 0 First Loss : 3.7859256267547607, Second Loss : 3.600304126739502
epoch: 19 idx: 200 First Loss : 0.8839049122050266, Second Loss : 0.9191667313992442
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.46434108527131784, recall 0.44811447811447813, F1 0.3441808791026959, AUC 0.6810549943883277
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.6836868686868686
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5611744222855334, recall 0.5199147560258671, F1 0.4032662958208529, AUC 0.7387627376053302
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7675264550264549
 
 test auc: 0.7629519400352734, test F1: 0.4969423558897243  :  from epoch 6{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.4465551564440532, "droprate_2": 0.0, "lr": 3.469098921908228e-05, "weight_decay": 2.291688310567562e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.469098921908228e-05
epoch: 0 idx: 0 First Loss : 1.2541407346725464, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1297185548502415, Second Loss : 1.1119746520596356
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7222278338945006
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7551515151515152
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6742786106212032
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6560846560846559
Test AUC: 0.6561, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.469098921908228e-05
epoch: 1 idx: 0 First Loss : 2.2564096450805664, Second Loss : 2.145702600479126
epoch: 1 idx: 200 First Loss : 1.0746901700671632, Second Loss : 1.077117826140935
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7388047138047139
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7604040404040404
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7079230354693319
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703042328042328
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.469098921908228e-05
epoch: 2 idx: 0 First Loss : 2.4256503582000732, Second Loss : 2.3184142112731934
epoch: 2 idx: 200 First Loss : 1.0319884763428229, Second Loss : 1.037289078815363
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.38159203980099504, recall 0.35474747474747476, F1 0.2854864433811802, AUC 0.7356060606060607
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.751060606060606
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7039731530472272
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7043650793650794
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.469098921908228e-05
epoch: 3 idx: 0 First Loss : 2.65785813331604, Second Loss : 2.5577170848846436
epoch: 3 idx: 200 First Loss : 0.9886966068575631, Second Loss : 1.0018652711267495
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5972222222222222, precision 0.5614774390768965, recall 0.5246127946127945, F1 0.5225508385172251, AUC 0.7291245791245791
  Second-Tier acc 0.6875, precision 0.7713920817369093, recall 0.6241414141414141, F1 0.5527720470249206, AUC 0.7511616161616161
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5238095238095238, precision 0.4630940269238142, recall 0.5076425631981187, F1 0.4621259498801793, AUC 0.698920977856163
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5491622574955909, F1 0.5483058608058607, AUC 0.6991843033509699
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.469098921908228e-05
epoch: 4 idx: 0 First Loss : 2.997023820877075, Second Loss : 2.8968679904937744
epoch: 4 idx: 200 First Loss : 0.9537384217206518, Second Loss : 0.9724151669116459
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5, precision 0.4898632993512512, recall 0.4822558922558923, F1 0.4318181143082896, AUC 0.7319472502805837
  Second-Tier acc 0.5625, precision 0.5720969089390142, recall 0.5824242424242424, F1 0.5482905982905982, AUC 0.7564646464646464
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4557823129251701, precision 0.467591091231013, recall 0.5153586125808348, F1 0.42362572545677635, AUC 0.7147633744855968
  Second-Tier acc 0.5714285714285714, precision 0.5746794871794871, recall 0.6247795414462082, F1 0.5684971663083839, AUC 0.7311507936507936
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.469098921908228e-05
epoch: 5 idx: 0 First Loss : 3.305039167404175, Second Loss : 3.2391371726989746
epoch: 5 idx: 200 First Loss : 0.929641256118147, Second Loss : 0.9552833291410066
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.48403209693532273, recall 0.4631986531986532, F1 0.39897894409854, AUC 0.736010101010101
  Second-Tier acc 0.5208333333333334, precision 0.5807017543859648, recall 0.5821212121212122, F1 0.5205325140809012, AUC 0.765050505050505
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.41496598639455784, precision 0.46551218940459443, recall 0.5042621987066431, F1 0.3977270773387278, AUC 0.7305506564765825
  Second-Tier acc 0.46938775510204084, precision 0.49892831626577755, recall 0.5579805996472663, F1 0.4745454545454546, AUC 0.7589836860670194
Test AUC: 0.7590, Test F1: 0.4745 (Best Epoch: 5)
Current LR: 3.469098921908228e-05
epoch: 6 idx: 0 First Loss : 3.5433714389801025, Second Loss : 3.5049850940704346
epoch: 6 idx: 200 First Loss : 0.9174948918461725, Second Loss : 0.9467620051544697
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4097222222222222, precision 0.4700161030595813, recall 0.45023569023569027, F1 0.37333333333333335, AUC 0.7384455667788999
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.778030303030303
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.4924390968508616, recall 0.5121987066431511, F1 0.4071075123706703, AUC 0.7398956496178718
  Second-Tier acc 0.4897959183673469, precision 0.5566137566137566, recall 0.5932539682539683, F1 0.494030294030294, AUC 0.7629519400352734
Test AUC: 0.7630, Test F1: 0.4940 (Best Epoch: 6)
Current LR: 3.469098921908228e-05
epoch: 7 idx: 0 First Loss : 3.6889469623565674, Second Loss : 3.6918740272521973
epoch: 7 idx: 200 First Loss : 0.9109382074400412, Second Loss : 0.9437107657040678
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3958333333333333, precision 0.48059964726631393, recall 0.44868686868686875, F1 0.3759401709401709, AUC 0.7448597081930415
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.785
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.5454373522458629, recall 0.5471781305114639, F1 0.43392300504872056, AUC 0.7501102292768959
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7739748677248678
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 8 idx: 0 First Loss : 3.772603988647461, Second Loss : 3.8133044242858887
epoch: 8 idx: 200 First Loss : 0.9052850017926438, Second Loss : 0.9407369685197129
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4097222222222222, precision 0.5008496620338726, recall 0.48020202020202024, F1 0.397462212521105, AUC 0.7504377104377106
  Second-Tier acc 0.4583333333333333, precision 0.5515476190476191, recall 0.5471717171717172, F1 0.4583333333333333, AUC 0.7819191919191919
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.5704861111111111, recall 0.5688565549676661, F1 0.4568536039124274, AUC 0.7600124926513816
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7955798059964727
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 9 idx: 0 First Loss : 3.7780864238739014, Second Loss : 3.853581666946411
epoch: 9 idx: 200 First Loss : 0.8992337962897466, Second Loss : 0.936564941968148
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4166666666666667, precision 0.5124586829392321, recall 0.49764309764309766, F1 0.4112305854241338, AUC 0.7525028058361393
  Second-Tier acc 0.3958333333333333, precision 0.49542124542124544, recall 0.46383838383838377, F1 0.3855128205128205, AUC 0.7778787878787878
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.5935990338164251, recall 0.6044238683127572, F1 0.4855629901746406, AUC 0.7636500587889478
  Second-Tier acc 0.5102040816326531, precision 0.6043956043956044, recall 0.5928130511463845, F1 0.5015873015873016, AUC 0.7964065255731922
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 10 idx: 0 First Loss : 3.7620627880096436, Second Loss : 3.863330602645874
epoch: 10 idx: 200 First Loss : 0.8937778230652269, Second Loss : 0.9332172144679306
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.5143937176860794, recall 0.5041414141414141, F1 0.4124072737615951, AUC 0.7483333333333334
  Second-Tier acc 0.375, precision 0.472495894909688, recall 0.43606060606060604, F1 0.35833333333333334, AUC 0.7725757575757576
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.5757268424611224, recall 0.5705467372134039, F1 0.4574322855528021, AUC 0.7643971683323535
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7994378306878307
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 11 idx: 0 First Loss : 3.7304913997650146, Second Loss : 3.857743501663208
epoch: 11 idx: 200 First Loss : 0.8891673057041228, Second Loss : 0.9305939960179952
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5093954248366013, recall 0.5005387205387205, F1 0.405273937532002, AUC 0.741105499438833
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7539393939393939
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.5671228413163897, recall 0.5543797766019988, F1 0.4360264140109101, AUC 0.765542328042328
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8055555555555555
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 12 idx: 0 First Loss : 3.6596839427948, Second Loss : 3.8229024410247803
epoch: 12 idx: 200 First Loss : 0.8844077562107079, Second Loss : 0.9280022875294646
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.4890863306418726, recall 0.4626599326599326, F1 0.3788571822035982, AUC 0.7295173961840629
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7387878787878788
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.5635315486061755, recall 0.5461493239271017, F1 0.42180816226100265, AUC 0.7617516656868508
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8015321869488536
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 13 idx: 0 First Loss : 3.6046619415283203, Second Loss : 3.7892515659332275
epoch: 13 idx: 200 First Loss : 0.8806012161788461, Second Loss : 0.9264508522259285
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.47854737854737855, recall 0.44979797979797986, F1 0.3650326797385621, AUC 0.7199551066217733
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7234343434343434
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.5600490196078431, recall 0.5379188712522046, F1 0.4071969696969697, AUC 0.7564545365471291
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7905092592592592
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 14 idx: 0 First Loss : 3.5508086681365967, Second Loss : 3.7551212310791016
epoch: 14 idx: 200 First Loss : 0.8773379274513642, Second Loss : 0.9266864548904117
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3541666666666667, precision 0.466911474374161, recall 0.43693602693602696, F1 0.35034313169144626, AUC 0.7068125701459035
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.7122222222222222
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.5606060606060607, recall 0.5379188712522046, F1 0.40663580246913583, AUC 0.7520208700764256
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7830687830687831
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 15 idx: 0 First Loss : 3.5005435943603516, Second Loss : 3.7296812534332275
epoch: 15 idx: 200 First Loss : 0.8754361735321512, Second Loss : 0.9273124219338869
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.45406833603554925, recall 0.42407407407407405, F1 0.33499088573655683, AUC 0.6936980920314254
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.687979797979798
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.40816326530612246, precision 0.5641489522086537, recall 0.541740152851264, F1 0.40525958771572806, AUC 0.7464359200470311
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7786596119929453
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 16 idx: 0 First Loss : 3.4788005352020264, Second Loss : 3.724966287612915
epoch: 16 idx: 200 First Loss : 0.8721176280124016, Second Loss : 0.9271617430385054
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4477248104008667, recall 0.41565656565656567, F1 0.32736013986013984, AUC 0.6875533108866442
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6834343434343434
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.5660349312523226, recall 0.5396090534979424, F1 0.402688847106729, AUC 0.7401099843229474
  Second-Tier acc 0.46938775510204084, precision 0.5780392156862745, recall 0.5566578483245149, F1 0.45862242332830566, AUC 0.7794863315696648
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 17 idx: 0 First Loss : 3.4556877613067627, Second Loss : 3.7187252044677734
epoch: 17 idx: 200 First Loss : 0.8695688743455005, Second Loss : 0.9265978587106443
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.45677240410353304, recall 0.4358585858585859, F1 0.33937325888349573, AUC 0.6805331088664422
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6813131313131313
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.40816326530612246, precision 0.5656249999999999, recall 0.5396090534979424, F1 0.4028046421663443, AUC 0.7382177150695669
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7765101410934744
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 18 idx: 0 First Loss : 3.4824419021606445, Second Loss : 3.7040493488311768
epoch: 18 idx: 200 First Loss : 0.8671508333708023, Second Loss : 0.9268814750268838
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3402777777777778, precision 0.44781750638495477, recall 0.4322558922558923, F1 0.33073314385508334, AUC 0.6761616161616161
  Second-Tier acc 0.3541666666666667, precision 0.4523809523809524, recall 0.4396969696969697, F1 0.3339031339031339, AUC 0.6739898989898988
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3945578231292517, precision 0.559727711901625, recall 0.5275573192239859, F1 0.38892440827924696, AUC 0.7362580834803056
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7755731922398589
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7)
Current LR: 3.469098921908228e-05
epoch: 19 idx: 0 First Loss : 3.4553730487823486, Second Loss : 3.651026964187622
epoch: 19 idx: 200 First Loss : 0.8649455554074138, Second Loss : 0.9266798360365477
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3402777777777778, precision 0.4512470423487373, recall 0.4265993265993266, F1 0.33273334852282216, AUC 0.6744219977553311
  Second-Tier acc 0.3541666666666667, precision 0.4536953242835596, recall 0.4396969696969697, F1 0.33803458631044836, AUC 0.6702525252525252
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3945578231292517, precision 0.5593406593406594, recall 0.5275573192239859, F1 0.38905788846890693, AUC 0.7344209288653732
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7709435626102293
Test AUC: 0.7740, Test F1: 0.5128 (Best Epoch: 7){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.41277808881907374, "droprate_2": 0.0, "lr": 0.0001468347631766654, "weight_decay": 0.00015875112649601174, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0001468347631766654
epoch: 0 idx: 0 First Loss : 1.264755368232727, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1013761235039625, Second Loss : 1.0983799662607818
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7429854096520763
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7544444444444444
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7253270135214581
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7116402116402116
Test AUC: 0.7116, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001468347631766654
epoch: 1 idx: 0 First Loss : 1.707384467124939, Second Loss : 1.7642440795898438
epoch: 1 idx: 200 First Loss : 0.985829805260274, Second Loss : 0.9975201659534702
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7368686868686868
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.742979797979798
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.34722222222222227, F1 0.2645521292217327, AUC 0.7248248579267097
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7210097001763668
Test AUC: 0.7116, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001468347631766654
epoch: 2 idx: 0 First Loss : 2.347900629043579, Second Loss : 2.647610664367676
epoch: 2 idx: 200 First Loss : 0.9422772764529458, Second Loss : 0.965952320293111
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.48980734767025086, recall 0.48653198653198654, F1 0.46789938997181607, AUC 0.7148821548821549
  Second-Tier acc 0.6041666666666666, precision 0.5345238095238095, recall 0.5318181818181819, F1 0.5200779727095517, AUC 0.7266161616161616
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.48299319727891155, precision 0.41726230722173924, recall 0.47743974132863026, F1 0.41036080862566376, AUC 0.7286032725847541
  Second-Tier acc 0.5918367346938775, precision 0.5674074074074075, recall 0.5848765432098766, F1 0.574946689551152, AUC 0.7090498236331569
Test AUC: 0.7116, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001468347631766654
epoch: 3 idx: 0 First Loss : 3.021974802017212, Second Loss : 3.2881786823272705
epoch: 3 idx: 200 First Loss : 0.9145753648391559, Second Loss : 0.9466009256128797
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4027777777777778, precision 0.4742712587540174, recall 0.4259259259259259, F1 0.39467906820848, AUC 0.6874971941638609
  Second-Tier acc 0.4166666666666667, precision 0.5303030303030303, recall 0.44828282828282834, F1 0.3863636363636364, AUC 0.7364141414141413
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4013605442176871, precision 0.4506739526411658, recall 0.4548059964726631, F1 0.39123002601263474, AUC 0.7125097981579462
  Second-Tier acc 0.5306122448979592, precision 0.5575, recall 0.5414462081128748, F1 0.5220632081097197, AUC 0.7102072310405644
Test AUC: 0.7116, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001468347631766654
epoch: 4 idx: 0 First Loss : 3.608246088027954, Second Loss : 3.981238603591919
epoch: 4 idx: 200 First Loss : 0.9062634676634636, Second Loss : 0.9445209059892083
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3888888888888889, precision 0.47709240221049054, recall 0.434006734006734, F1 0.38733215918334696, AUC 0.712384960718294
  Second-Tier acc 0.4375, precision 0.5549169859514688, recall 0.487979797979798, F1 0.44171122994652406, AUC 0.7642929292929294
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.43537414965986393, precision 0.516168953457089, recall 0.5254997060552616, F1 0.4357120508905412, AUC 0.7273723789927494
  Second-Tier acc 0.5102040816326531, precision 0.5661881977671451, recall 0.605599647266314, F1 0.5098942642802292, AUC 0.7358355379188714
Test AUC: 0.7358, Test F1: 0.5099 (Best Epoch: 4)
Current LR: 0.0001468347631766654
epoch: 5 idx: 0 First Loss : 3.8435983657836914, Second Loss : 4.118893623352051
epoch: 5 idx: 200 First Loss : 0.8910968579827988, Second Loss : 0.9385774009722049
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3402777777777778, precision 0.45127504553734066, recall 0.4092592592592592, F1 0.2661290322580645, AUC 0.7241919191919193
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7866161616161617
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.49677158999192894, recall 0.4298206937095826, F1 0.3347335316838918, AUC 0.7234102488732118
  Second-Tier acc 0.46938775510204084, precision 0.4537037037037037, recall 0.4329805996472664, F1 0.3535135135135135, AUC 0.7489528218694885
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 6 idx: 0 First Loss : 3.8007686138153076, Second Loss : 4.2148566246032715
epoch: 6 idx: 200 First Loss : 0.8907474944216259, Second Loss : 0.9343613946256668
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3263888888888889, precision 0.4003073451602863, recall 0.4003703703703703, F1 0.2547897521581732, AUC 0.7310830527497193
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.7543939393939394
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.49498746867167914, recall 0.4154908877131099, F1 0.32842105263157895, AUC 0.7078189300411523
  Second-Tier acc 0.40816326530612246, precision 0.4473684210526316, recall 0.3959435626102293, F1 0.30392156862745096, AUC 0.7239307760141095
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 7 idx: 0 First Loss : 3.738252878189087, Second Loss : 4.177619934082031
epoch: 7 idx: 200 First Loss : 0.891754002607745, Second Loss : 0.938037927526881
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3194444444444444, precision 0.36026422764227645, recall 0.39111111111111113, F1 0.23626373626373623, AUC 0.7090460157126824
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.7157575757575758
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.38095238095238093, precision 0.4444444444444444, recall 0.3871252204585538, F1 0.2698232323232323, AUC 0.6782774838330393
  Second-Tier acc 0.3877551020408163, precision 0.4471544715447155, recall 0.3950617283950617, F1 0.27386363636363636, AUC 0.6598324514991182
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 8 idx: 0 First Loss : 3.861787796020508, Second Loss : 4.301496982574463
epoch: 8 idx: 200 First Loss : 0.8931243744089769, Second Loss : 0.9362077142290924
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.37587822014051525, recall 0.41333333333333333, F1 0.2669354838709677, AUC 0.6856341189674523
  Second-Tier acc 0.3333333333333333, precision 0.41613756613756614, recall 0.4144444444444444, F1 0.2800049769814607, AUC 0.700909090909091
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4217687074829932, precision 0.4444444444444444, recall 0.4156378600823045, F1 0.2986798679867987, AUC 0.6819211738193219
  Second-Tier acc 0.3877551020408163, precision 0.498069498069498, recall 0.41291887125220456, F1 0.3185457516339869, AUC 0.6606591710758377
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 9 idx: 0 First Loss : 4.055880546569824, Second Loss : 4.193206310272217
epoch: 9 idx: 200 First Loss : 0.8967222973217247, Second Loss : 0.9367351381064581
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3055555555555556, precision 0.3806526806526807, recall 0.387037037037037, F1 0.23310747223790698, AUC 0.6759764309764309
  Second-Tier acc 0.2708333333333333, precision 0.3162393162393162, recall 0.36000000000000004, F1 0.19428571428571428, AUC 0.693030303030303
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3741496598639456, precision 0.47866666666666674, recall 0.396604938271605, F1 0.27329401917228163, AUC 0.6659869194591418
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6666666666666666
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 10 idx: 0 First Loss : 3.519864797592163, Second Loss : 3.9711978435516357
epoch: 10 idx: 200 First Loss : 0.8959177651766059, Second Loss : 0.9236628910592805
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.3989547038327526, recall 0.3914814814814815, F1 0.2389265207399516, AUC 0.6731818181818182
  Second-Tier acc 0.2708333333333333, precision 0.31871345029239767, recall 0.36000000000000004, F1 0.19727891156462585, AUC 0.7001515151515152
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.38095238095238093, precision 0.4861111111111111, recall 0.4007201646090535, F1 0.2796985815602837, AUC 0.659385410542818
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.6588955026455027
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 11 idx: 0 First Loss : 3.441697359085083, Second Loss : 3.8746814727783203
epoch: 11 idx: 200 First Loss : 0.8932102891469991, Second Loss : 0.9156140389284846
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6718181818181819
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6975252525252525
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3945578231292517, precision 0.44020356234096686, recall 0.3991769547325103, F1 0.27181534672149055, AUC 0.6567215363511659
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6595568783068783
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 12 idx: 0 First Loss : 3.6688344478607178, Second Loss : 3.918081760406494
epoch: 12 idx: 200 First Loss : 0.8855741852102396, Second Loss : 0.9065159763519312
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.36648745519713266, recall 0.39999999999999997, F1 0.24765427025546197, AUC 0.6737373737373736
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6933838383838383
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.441025641025641, recall 0.3991769547325103, F1 0.2727563334132502, AUC 0.6577442190868116
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6628086419753086
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 13 idx: 0 First Loss : 3.4000160694122314, Second Loss : 3.754953384399414
epoch: 13 idx: 200 First Loss : 0.8723160215329572, Second Loss : 0.8931253672508591
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.3618113912231559, recall 0.3955555555555556, F1 0.23981405523653268, AUC 0.675050505050505
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6985353535353536
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6564214677640604
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6680445326278659
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 14 idx: 0 First Loss : 3.2634193897247314, Second Loss : 3.6956467628479004
epoch: 14 idx: 200 First Loss : 0.8596073416953204, Second Loss : 0.8823430186859867
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.6714253647586981
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6994949494949495
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.441025641025641, recall 0.40329218106995884, F1 0.27843695617781994, AUC 0.6584729570840682
  Second-Tier acc 0.3877551020408163, precision 0.5166666666666667, recall 0.4243827160493827, F1 0.3101430628312349, AUC 0.6666115520282188
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 15 idx: 0 First Loss : 3.246098756790161, Second Loss : 3.6322333812713623
epoch: 15 idx: 200 First Loss : 0.8447663506383435, Second Loss : 0.8705370460986739
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.6679854096520762
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6974747474747475
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.441025641025641, recall 0.40329218106995884, F1 0.27843695617781994, AUC 0.6631638252008623
  Second-Tier acc 0.3877551020408163, precision 0.45, recall 0.3950617283950617, F1 0.2770061728395062, AUC 0.6694775132275134
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 16 idx: 0 First Loss : 3.3309624195098877, Second Loss : 3.765073537826538
epoch: 16 idx: 200 First Loss : 0.8342407124600777, Second Loss : 0.86456278083197
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.665959595959596
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6947474747474748
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.4301818181818182, recall 0.4197530864197531, F1 0.30358700075577, AUC 0.6676771017048795
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.6685405643738976
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 17 idx: 0 First Loss : 3.3327362537384033, Second Loss : 3.7069685459136963
epoch: 17 idx: 200 First Loss : 0.8261171972971807, Second Loss : 0.8546979625278264
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2847222222222222, precision 0.33113391984359725, recall 0.3688888888888889, F1 0.20214289241100084, AUC 0.6653928170594837
  Second-Tier acc 0.3125, precision 0.39351851851851855, recall 0.40111111111111114, F1 0.25832721936903885, AUC 0.6824747474747473
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.36054421768707484, precision 0.441025641025641, recall 0.3786008230452675, F1 0.2425008426019548, AUC 0.6625759357240839
  Second-Tier acc 0.3469387755102041, precision 0.49279279279279287, recall 0.3996913580246913, F1 0.2660205844790024, AUC 0.6645171957671958
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 18 idx: 0 First Loss : 3.38948130607605, Second Loss : 3.7100911140441895
epoch: 18 idx: 200 First Loss : 0.8209416751255121, Second Loss : 0.8573763008711042
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2916666666666667, precision 0.3628912071535022, recall 0.3781481481481481, F1 0.21813538491005727, AUC 0.6677833894500561
  Second-Tier acc 0.3125, precision 0.3911764705882353, recall 0.40111111111111114, F1 0.2622315105073726, AUC 0.681111111111111
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.46914285714285714, recall 0.3801440329218107, F1 0.2451336239407642, AUC 0.6648356359004507
  Second-Tier acc 0.30612244897959184, precision 0.48148148148148145, recall 0.36353615520282184, F1 0.23047619047619047, AUC 0.6708553791887125
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5)
Current LR: 0.0001468347631766654
epoch: 19 idx: 0 First Loss : 3.3170864582061768, Second Loss : 3.809455633163452
epoch: 19 idx: 200 First Loss : 0.819196852607685, Second Loss : 0.861015076183303
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3781481481481481, F1 0.2187615356220007, AUC 0.663726150392817
  Second-Tier acc 0.2916666666666667, precision 0.34649122807017546, recall 0.37333333333333335, F1 0.21862538118695754, AUC 0.6680808080808082
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.47387258410880456, recall 0.3842592592592593, F1 0.2513947590870668, AUC 0.6747562708210856
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6665013227513228
Test AUC: 0.7490, Test F1: 0.3535 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.223189431300791, "droprate_2": 0.0, "lr": 5.76690380351635e-05, "weight_decay": 0.00015293321267740483, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 5.76690380351635e-05
epoch: 0 idx: 0 First Loss : 1.2493351697921753, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1225407896795083, Second Loss : 1.1170200871590952
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7339618406285072
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7550505050505051
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6953568979031942
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932870370370372
Test AUC: 0.6933, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.76690380351635e-05
epoch: 1 idx: 0 First Loss : 2.129344940185547, Second Loss : 2.107325792312622
epoch: 1 idx: 200 First Loss : 1.0400352984370285, Second Loss : 1.038696175265075
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7384624017957351
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7523737373737373
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7158472957084068
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7114748677248678
Test AUC: 0.6933, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.76690380351635e-05
epoch: 2 idx: 0 First Loss : 2.3659462928771973, Second Loss : 2.341486930847168
epoch: 2 idx: 200 First Loss : 0.9909795258768755, Second Loss : 0.9886273617916439
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6944444444444444, precision 0.6658305462653288, recall 0.6193265993265994, F1 0.6326919698056047, AUC 0.7324242424242424
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7494444444444444
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5918367346938775, precision 0.5510168126447196, recall 0.5619488536155203, F1 0.5531859358206664, AUC 0.697879923574368
  Second-Tier acc 0.6326530612244898, precision 0.6239316239316239, recall 0.5802469135802469, F1 0.5972338253040007, AUC 0.7049713403880071
Test AUC: 0.6933, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.76690380351635e-05
epoch: 3 idx: 0 First Loss : 2.8369882106781006, Second Loss : 2.83793568611145
epoch: 3 idx: 200 First Loss : 0.9501781753306069, Second Loss : 0.9539610896611688
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.5115740740740741, recall 0.5159259259259259, F1 0.49127341816896425, AUC 0.7334792368125701
  Second-Tier acc 0.5833333333333334, precision 0.5909391534391534, recall 0.6076767676767676, F1 0.5774298591792284, AUC 0.7534848484848485
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4897959183673469, precision 0.4845796474618216, recall 0.5274103468547913, F1 0.47608572960685636, AUC 0.7078556731334508
  Second-Tier acc 0.5714285714285714, precision 0.574537037037037, recall 0.642636684303351, F1 0.5711156049882036, AUC 0.7409611992945327
Test AUC: 0.6933, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.76690380351635e-05
epoch: 4 idx: 0 First Loss : 3.4011166095733643, Second Loss : 3.3816800117492676
epoch: 4 idx: 200 First Loss : 0.9330929281440243, Second Loss : 0.9397201261747239
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4791666666666667, precision 0.5382716049382716, recall 0.528013468013468, F1 0.47590311986863715, AUC 0.7389169472502806
  Second-Tier acc 0.5208333333333334, precision 0.562200956937799, recall 0.5821212121212122, F1 0.5222222222222223, AUC 0.7677777777777779
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4557823129251701, precision 0.4984608944050433, recall 0.522119341563786, F1 0.45694205008581834, AUC 0.7200911228689008
  Second-Tier acc 0.46938775510204084, precision 0.49216791979949875, recall 0.5286596119929453, F1 0.4667405764966741, AUC 0.7582671957671958
Test AUC: 0.7583, Test F1: 0.4667 (Best Epoch: 4)
Current LR: 5.76690380351635e-05
epoch: 5 idx: 0 First Loss : 3.791938066482544, Second Loss : 3.752835273742676
epoch: 5 idx: 200 First Loss : 0.9288836995334323, Second Loss : 0.9370922791859626
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4722222222222222, precision 0.54581519109821, recall 0.5422222222222222, F1 0.4746496662965998, AUC 0.7336980920314252
  Second-Tier acc 0.5208333333333334, precision 0.5899470899470899, recall 0.5990909090909091, F1 0.5235294117647059, AUC 0.771969696969697
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46258503401360546, precision 0.5235507246376812, recall 0.5279247501469723, F1 0.4617168369380759, AUC 0.7226325200862238
  Second-Tier acc 0.5306122448979592, precision 0.5902097902097903, recall 0.6115520282186949, F1 0.5368549579075894, AUC 0.7622905643738976
Test AUC: 0.7623, Test F1: 0.5369 (Best Epoch: 5)
Current LR: 5.76690380351635e-05
epoch: 6 idx: 0 First Loss : 4.002736568450928, Second Loss : 3.9528701305389404
epoch: 6 idx: 200 First Loss : 0.9280863286885641, Second Loss : 0.9386809849578758
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4305555555555556, precision 0.5177777777777778, recall 0.49797979797979797, F1 0.43097643097643096, AUC 0.742317620650954
  Second-Tier acc 0.5, precision 0.5829629629629629, recall 0.5738383838383839, F1 0.5030165912518854, AUC 0.7735353535353536
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4897959183673469, precision 0.577022460743391, recall 0.5711346266901822, F1 0.48718944219711413, AUC 0.7341698510679993
  Second-Tier acc 0.5306122448979592, precision 0.6172161172161172, recall 0.623015873015873, F1 0.5318181818181819, AUC 0.7890211640211641
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 7 idx: 0 First Loss : 4.106927394866943, Second Loss : 4.037099361419678
epoch: 7 idx: 200 First Loss : 0.9247232765916142, Second Loss : 0.9375423780579898
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3958333333333333, precision 0.5024324324324324, recall 0.46444444444444444, F1 0.395904780425308, AUC 0.7421941638608306
  Second-Tier acc 0.4375, precision 0.527065527065527, recall 0.487979797979798, F1 0.4343402225755167, AUC 0.7599494949494949
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.48299319727891155, precision 0.5873538011695907, recall 0.5767930629041741, F1 0.47998454778115796, AUC 0.7403426905741721
  Second-Tier acc 0.5102040816326531, precision 0.597340930674264, recall 0.5813492063492064, F1 0.5042586140147116, AUC 0.7903439153439153
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 8 idx: 0 First Loss : 4.119534969329834, Second Loss : 4.020913124084473
epoch: 8 idx: 200 First Loss : 0.9199887263688227, Second Loss : 0.9334382344285184
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3680555555555556, precision 0.4790379237941706, recall 0.43390572390572396, F1 0.36231025343778417, AUC 0.7321324354657688
  Second-Tier acc 0.4375, precision 0.5164049919484702, recall 0.487979797979798, F1 0.4327731092436975, AUC 0.7505050505050505
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5855880230880232, recall 0.5726778365667254, F1 0.4734716972009947, AUC 0.745725553595924
  Second-Tier acc 0.46938775510204084, precision 0.5702614379084968, recall 0.5451940035273369, F1 0.46115288220551376, AUC 0.7764550264550264
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 9 idx: 0 First Loss : 4.149453639984131, Second Loss : 3.993619918823242
epoch: 9 idx: 200 First Loss : 0.9152584339976219, Second Loss : 0.929928427165958
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3680555555555556, precision 0.4792270531400966, recall 0.4387205387205387, F1 0.36294094028579454, AUC 0.7246071829405162
  Second-Tier acc 0.4166666666666667, precision 0.5022893772893773, recall 0.47717171717171714, F1 0.40614040614040614, AUC 0.7492424242424242
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.5660818713450292, recall 0.5406378600823045, F1 0.4385975634600497, AUC 0.7446416323731139
  Second-Tier acc 0.46938775510204084, precision 0.5633333333333334, recall 0.5273368606701939, F1 0.4515262515262515, AUC 0.7730379188712523
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 10 idx: 0 First Loss : 4.1217427253723145, Second Loss : 3.9554553031921387
epoch: 10 idx: 200 First Loss : 0.911048525360538, Second Loss : 0.924949010998006
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.375, precision 0.4810699588477367, recall 0.44966329966329965, F1 0.3665695501198236, AUC 0.7140628507295174
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.4082828282828283, F1 0.3341767881241566, AUC 0.7229292929292929
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.583994708994709, recall 0.5742210464432687, F1 0.457953216374269, AUC 0.7433862433862434
  Second-Tier acc 0.46938775510204084, precision 0.5645424836601307, recall 0.5273368606701939, F1 0.45203007518796995, AUC 0.7741953262786597
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 11 idx: 0 First Loss : 4.1212592124938965, Second Loss : 3.940225601196289
epoch: 11 idx: 200 First Loss : 0.9083198961719005, Second Loss : 0.9208278331673352
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.4679495202336253, recall 0.43595959595959594, F1 0.3512271479144744, AUC 0.6996127946127947
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.4082828282828283, F1 0.3341767881241566, AUC 0.6966161616161616
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.5644250927269795, recall 0.5281452087007642, F1 0.4176135433867392, AUC 0.7380707427003723
  Second-Tier acc 0.46938775510204084, precision 0.5787037037037037, recall 0.5566578483245149, F1 0.45844248630626344, AUC 0.7767857142857143
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 12 idx: 0 First Loss : 4.094554901123047, Second Loss : 3.9504473209381104
epoch: 12 idx: 200 First Loss : 0.9076646875840002, Second Loss : 0.9191839914874345
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.6910662177328843
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.4082828282828283, F1 0.3341767881241566, AUC 0.6828282828282829
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4421768707482993, precision 0.5698765432098766, recall 0.5423280423280423, F1 0.4346024346024346, AUC 0.7358845287086027
  Second-Tier acc 0.46938775510204084, precision 0.5787037037037037, recall 0.5566578483245149, F1 0.45844248630626344, AUC 0.7766203703703703
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 13 idx: 0 First Loss : 4.093321323394775, Second Loss : 3.9108529090881348
epoch: 13 idx: 200 First Loss : 0.9087704684794128, Second Loss : 0.9172151993887165
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.4694462862976645, recall 0.4469023569023569, F1 0.35462285972974145, AUC 0.685712682379349
  Second-Tier acc 0.3125, precision 0.41773399014778323, recall 0.3816161616161617, F1 0.2901709401709402, AUC 0.6798484848484848
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.5708333333333334, recall 0.5401969429747208, F1 0.43110926249099557, AUC 0.7322775818146189
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7762896825396827
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 14 idx: 0 First Loss : 4.073948383331299, Second Loss : 3.897728204727173
epoch: 14 idx: 200 First Loss : 0.9088754523224782, Second Loss : 0.9144519118853354
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.46137327086122265, recall 0.4432996632996633, F1 0.3442092886537331, AUC 0.6841021324354658
  Second-Tier acc 0.375, precision 0.45555555555555555, recall 0.45555555555555555, F1 0.34194422589387186, AUC 0.6806060606060607
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5559150489464079, recall 0.5083039388594944, F1 0.40610645176475585, AUC 0.7280092592592592
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7716049382716049
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 15 idx: 0 First Loss : 4.014042854309082, Second Loss : 3.842190980911255
epoch: 15 idx: 200 First Loss : 0.9076708533466806, Second Loss : 0.9106886696563605
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.4656385281385282, recall 0.4534006734006734, F1 0.34951159951159944, AUC 0.6861503928170595
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.6836363636363636
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.40816326530612246, precision 0.5446808510638298, recall 0.48434744268077595, F1 0.3859307419319064, AUC 0.7209913286302175
  Second-Tier acc 0.46938775510204084, precision 0.590311986863711, recall 0.5681216931216931, F1 0.45877378435517974, AUC 0.7602513227513228
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 16 idx: 0 First Loss : 3.9898643493652344, Second Loss : 3.8494763374328613
epoch: 16 idx: 200 First Loss : 0.9071580580322318, Second Loss : 0.9080480458721663
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4568691844553914, recall 0.4497979797979798, F1 0.3380341880341881, AUC 0.6860886644219978
  Second-Tier acc 0.375, precision 0.4554966106690245, recall 0.45555555555555555, F1 0.34419354838709676, AUC 0.687020202020202
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.5399831649831649, recall 0.47427983539094654, F1 0.37435115101018984, AUC 0.71422447579855
  Second-Tier acc 0.46938775510204084, precision 0.5982905982905983, recall 0.5974426807760141, F1 0.4580128205128205, AUC 0.7525903880070546
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 17 idx: 0 First Loss : 3.992816925048828, Second Loss : 3.825052499771118
epoch: 17 idx: 200 First Loss : 0.9079353336770573, Second Loss : 0.9072055152796362
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.4565891472868217, recall 0.4497979797979798, F1 0.3385077237646114, AUC 0.6872783389450056
  Second-Tier acc 0.3958333333333333, precision 0.4677066228790367, recall 0.4688888888888889, F1 0.36388888888888893, AUC 0.6892929292929293
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3877551020408163, precision 0.5368310767246938, recall 0.4660493827160494, F1 0.359405398478547, AUC 0.7094723691945913
  Second-Tier acc 0.4489795918367347, precision 0.579520697167756, recall 0.5557760141093474, F1 0.4326219512195122, AUC 0.7420634920634921
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 18 idx: 0 First Loss : 3.9752438068389893, Second Loss : 3.7788381576538086
epoch: 18 idx: 200 First Loss : 0.9079478024922089, Second Loss : 0.9046206842431456
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.4465909090909091, recall 0.43572390572390574, F1 0.3274405020816504, AUC 0.6904938271604938
  Second-Tier acc 0.4166666666666667, precision 0.49294532627865956, recall 0.49666666666666665, F1 0.39490553306342785, AUC 0.6902525252525252
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.5144084934277048, recall 0.4243827160493827, F1 0.32980259990370725, AUC 0.7055776014109347
  Second-Tier acc 0.46938775510204084, precision 0.5982905982905983, recall 0.5974426807760141, F1 0.4580128205128205, AUC 0.7411265432098766
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.76690380351635e-05
epoch: 19 idx: 0 First Loss : 4.066908359527588, Second Loss : 3.8244588375091553
epoch: 19 idx: 200 First Loss : 0.9089623926691329, Second Loss : 0.9019589032368232
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.44883720930232557, recall 0.4405387205387205, F1 0.3300689051992105, AUC 0.6902076318742986
  Second-Tier acc 0.3958333333333333, precision 0.4802469135802469, recall 0.48333333333333334, F1 0.374583411934855, AUC 0.6903030303030303
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.38095238095238093, precision 0.5296368669597785, recall 0.45216049382716045, F1 0.34985283943668577, AUC 0.7045059278855575
  Second-Tier acc 0.4489795918367347, precision 0.579520697167756, recall 0.5557760141093474, F1 0.4326219512195122, AUC 0.7387566137566138
Test AUC: 0.7890, Test F1: 0.5318 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.2029411508042893, "droprate_2": 0.0, "lr": 0.0004771935923972496, "weight_decay": 0.0006823232821008896, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0004771935923972496
epoch: 0 idx: 0 First Loss : 1.2505511045455933, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0809501514061173, Second Loss : 1.0737507816274368
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7320482603815938
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7263131313131314
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6834031452087007
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6557539682539683
Test AUC: 0.6558, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004771935923972496
epoch: 1 idx: 0 First Loss : 1.8260771036148071, Second Loss : 2.3520994186401367
epoch: 1 idx: 200 First Loss : 0.9857173269957452, Second Loss : 0.9882301552526986
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7390684624017957
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7372727272727273
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.717170047031158
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7210097001763668
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 2 idx: 0 First Loss : 3.202838182449341, Second Loss : 3.124391794204712
epoch: 2 idx: 200 First Loss : 0.9744146215307772, Second Loss : 0.9711454994791183
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7330022446689114
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7278787878787879
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7417021849892221
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7560626102292769
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 3 idx: 0 First Loss : 3.6780338287353516, Second Loss : 3.0285775661468506
epoch: 3 idx: 200 First Loss : 0.9581157310092034, Second Loss : 0.9458010889478584
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7290123456790124
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7316666666666666
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7518861454046638
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7592592592592592
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 4 idx: 0 First Loss : 3.913745164871216, Second Loss : 3.553884267807007
epoch: 4 idx: 200 First Loss : 0.9298791778551887, Second Loss : 0.9269082350934397
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7306846240179574
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7312121212121211
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.19999999999999998, recall 0.3333333333333333, F1 0.25, AUC 0.7528904565941602
  Second-Tier acc 0.5510204081632653, precision 0.19999999999999998, recall 0.3333333333333333, F1 0.25, AUC 0.7581018518518517
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 5 idx: 0 First Loss : 3.4159507751464844, Second Loss : 3.514680862426758
epoch: 5 idx: 200 First Loss : 0.9193226080410998, Second Loss : 0.9197406554988479
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3680555555555556, precision 0.3596262494567579, recall 0.4165656565656566, F1 0.27989421458702163, AUC 0.74175645342312
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7140404040404041
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.4403967371153133, recall 0.4488536155202822, F1 0.35156720916214584, AUC 0.6956385949441506
  Second-Tier acc 0.5306122448979592, precision 0.4594594594594595, recall 0.48148148148148145, F1 0.38813474107591756, AUC 0.724371693121693
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 6 idx: 0 First Loss : 3.608922243118286, Second Loss : 3.800558567047119
epoch: 6 idx: 200 First Loss : 0.9148327175745583, Second Loss : 0.9194401461626426
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.7103423120089786
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.709040404040404
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.45098039215686275, recall 0.448559670781893, F1 0.34516686610823033, AUC 0.6778059474818733
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.664186507936508
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 7 idx: 0 First Loss : 3.7491509914398193, Second Loss : 4.053088665008545
epoch: 7 idx: 200 First Loss : 0.9033677773804992, Second Loss : 0.9129777038284573
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7017171717171719
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7036363636363636
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.4376543209876543, recall 0.44032921810699593, F1 0.3333333333333333, AUC 0.679104203409759
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6475418871252204
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 8 idx: 0 First Loss : 3.9907052516937256, Second Loss : 4.444883346557617
epoch: 8 idx: 200 First Loss : 0.8995498575522699, Second Loss : 0.9107651190918555
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6876655443322109
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.7030808080808081
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.4347540983606557, recall 0.43209876543209874, F1 0.32167510354348827, AUC 0.6457047325102881
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6487544091710757
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 9 idx: 0 First Loss : 3.629587173461914, Second Loss : 3.7729380130767822
epoch: 9 idx: 200 First Loss : 0.8897848098596155, Second Loss : 0.9067840462904401
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.6798035914702582
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6933838383838383
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.43326558265582654, recall 0.4279835390946502, F1 0.3157287157287157, AUC 0.6431633352929649
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6479276895943563
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 10 idx: 0 First Loss : 3.537060499191284, Second Loss : 3.8031396865844727
epoch: 10 idx: 200 First Loss : 0.8902758795476116, Second Loss : 0.9096774041203959
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.35260416666666666, recall 0.38666666666666666, F1 0.22553485162180817, AUC 0.6746240179573512
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6816666666666666
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.41496598639455784, precision 0.4427083333333333, recall 0.4115226337448559, F1 0.29137254901960785, AUC 0.6366659318048207
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6376212522045855
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 11 idx: 0 First Loss : 3.320950508117676, Second Loss : 3.6142690181732178
epoch: 11 idx: 200 First Loss : 0.870991193579434, Second Loss : 0.895763800189085
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.36001999000499757, recall 0.43555555555555553, F1 0.2960845460845461, AUC 0.6788215488215489
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.685
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.4041541541541542, recall 0.43709582598471486, F1 0.3465728171610524, AUC 0.6533840388007054
  Second-Tier acc 0.4897959183673469, precision 0.4258373205741626, recall 0.4567901234567901, F1 0.3549257759784075, AUC 0.6495260141093474
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 12 idx: 0 First Loss : 4.247072219848633, Second Loss : 3.7165815830230713
epoch: 12 idx: 200 First Loss : 0.8852847332118337, Second Loss : 0.8898324871675977
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.36562203228869894, recall 0.43111111111111117, F1 0.29045751633986927, AUC 0.6727721661054994
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6852525252525252
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.37641277641277643, recall 0.4209288653733098, F1 0.3305084745762712, AUC 0.6630903390162649
  Second-Tier acc 0.46938775510204084, precision 0.39553429027113235, recall 0.4444444444444444, F1 0.33738191632928477, AUC 0.6480379188712523
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 13 idx: 0 First Loss : 3.8467769622802734, Second Loss : 3.818084239959717
epoch: 13 idx: 200 First Loss : 0.8888701269788907, Second Loss : 0.9047091166007455
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.3752716210343329, recall 0.43111111111111117, F1 0.2909098856905558, AUC 0.677530864197531
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6816666666666666
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.3997873471557682, recall 0.4326866549088771, F1 0.33468286099865047, AUC 0.6630658436213992
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6477072310405644
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 14 idx: 0 First Loss : 3.7331249713897705, Second Loss : 3.6837637424468994
epoch: 14 idx: 200 First Loss : 0.8744878649813472, Second Loss : 0.8934327113099302
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.6792312008978677
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6840909090909091
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.4376543209876543, recall 0.44032921810699593, F1 0.3333333333333333, AUC 0.6653500391926318
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6509589947089948
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 15 idx: 0 First Loss : 3.612253189086914, Second Loss : 3.672197103500366
epoch: 15 idx: 200 First Loss : 0.8731759063923336, Second Loss : 0.8953686644843546
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6776487093153761
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6852525252525252
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.4233947870311507, recall 0.43209876543209874, F1 0.3213118513846683, AUC 0.6599059376837156
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6499118165784833
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 16 idx: 0 First Loss : 3.551165819168091, Second Loss : 3.6564676761627197
epoch: 16 idx: 200 First Loss : 0.8703795690077156, Second Loss : 0.8971928555168084
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.3511578947368421, recall 0.39999999999999997, F1 0.2456234850525182, AUC 0.6774971941638608
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6882323232323233
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.412962962962963, recall 0.43209876543209874, F1 0.32098765432098764, AUC 0.6617124730550658
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6539902998236332
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 17 idx: 0 First Loss : 3.490889310836792, Second Loss : 3.6170806884765625
epoch: 17 idx: 200 First Loss : 0.8682919080939016, Second Loss : 0.8943107865875911
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3263888888888889, precision 0.3472592592592593, recall 0.3955555555555556, F1 0.23959892926818202, AUC 0.679421997755331
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6853535353535354
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.43537414965986393, precision 0.5751633986928104, recall 0.4493680188124632, F1 0.36500734000940255, AUC 0.6618227023319617
  Second-Tier acc 0.42857142857142855, precision 0.5863247863247864, recall 0.478395061728395, F1 0.3828313981615869, AUC 0.6571869488536156
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 18 idx: 0 First Loss : 3.542635917663574, Second Loss : 3.6078622341156006
epoch: 18 idx: 200 First Loss : 0.867296349267027, Second Loss : 0.8930432448377048
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3402777777777778, precision 0.3583333333333334, recall 0.40444444444444444, F1 0.2560715514275886, AUC 0.6804657687991021
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6884343434343435
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4217687074829932, precision 0.5419448325829322, recall 0.45304232804232797, F1 0.37321202095395645, AUC 0.6653194199490496
  Second-Tier acc 0.40816326530612246, precision 0.5641025641025641, recall 0.4660493827160494, F1 0.3573602295452569, AUC 0.6592813051146384
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 0.0004771935923972496
epoch: 19 idx: 0 First Loss : 3.604351043701172, Second Loss : 3.695185422897339
epoch: 19 idx: 200 First Loss : 0.8594594313341004, Second Loss : 0.891936031768759
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3263888888888889, precision 0.3931436497225971, recall 0.38905723905723905, F1 0.25931227165269716, AUC 0.6827946127946127
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6881818181818181
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4013605442176871, precision 0.5564125831820932, recall 0.4581128747795414, F1 0.35204054178101485, AUC 0.6658399470899471
  Second-Tier acc 0.3877551020408163, precision 0.5804878048780489, recall 0.4537037037037037, F1 0.3389277389277389, AUC 0.6552579365079364
Test AUC: 0.7210, Test F1: 0.2368 (Best Epoch: 1){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.15315694191287849, "droprate_2": 0.0, "lr": 2.840644407338697e-05, "weight_decay": 2.0703984043911953e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.21404395459609202, "droprate_2": 0.0, "lr": 1.0797318581296948e-05, "weight_decay": 1.978324329310454e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0797318581296948e-05
epoch: 0 idx: 0 First Loss : 1.1601511240005493, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0441044312507952, Second Loss : 1.051504514555433
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7458754208754209
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6751010101010101
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.648105281207133
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.5633267195767195
Test AUC: 0.5633, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0797318581296948e-05
epoch: 1 idx: 0 First Loss : 1.821333885192871, Second Loss : 1.9020553827285767
epoch: 1 idx: 200 First Loss : 1.0923031682695323, Second Loss : 1.0983118566855863
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.754236812570146
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7055050505050504
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6699429257299627
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6326609347442681
Test AUC: 0.6327, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0797318581296948e-05
epoch: 2 idx: 0 First Loss : 1.9832402467727661, Second Loss : 2.070672035217285
epoch: 2 idx: 200 First Loss : 1.0850624350914315, Second Loss : 1.092820544147966
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7583389450056117
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7297979797979798
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6874693807564177
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.666005291005291
Test AUC: 0.6660, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0797318581296948e-05
epoch: 3 idx: 0 First Loss : 2.0360047817230225, Second Loss : 2.1344640254974365
epoch: 3 idx: 200 First Loss : 1.0738697582809487, Second Loss : 1.0820460126767704
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7581930415263748
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7485353535353535
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7020563883989809
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932319223985891
Test AUC: 0.6932, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0797318581296948e-05
epoch: 4 idx: 0 First Loss : 2.082728385925293, Second Loss : 2.202951192855835
epoch: 4 idx: 200 First Loss : 1.0619438384747624, Second Loss : 1.0699957710741765
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7557182940516274
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7472727272727272
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134528708602783
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705136684303351
Test AUC: 0.6932, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0797318581296948e-05
epoch: 5 idx: 0 First Loss : 2.142805814743042, Second Loss : 2.2866194248199463
epoch: 5 idx: 200 First Loss : 1.0503225401785243, Second Loss : 1.059603920697573
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5694444444444444, precision 0.5158150851581508, recall 0.40404040404040403, F1 0.3525157232704402, AUC 0.7507912457912459
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7476767676767677
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18493150684931506, recall 0.3333333333333333, F1 0.23788546255506607, AUC 0.7213526357044876
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7148919753086419
Test AUC: 0.6932, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0797318581296948e-05
epoch: 6 idx: 0 First Loss : 2.2138736248016357, Second Loss : 2.3725404739379883
epoch: 6 idx: 200 First Loss : 1.0377659078187018, Second Loss : 1.046864825880053
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5902777777777778, precision 0.4014711575687186, recall 0.45131313131313133, F1 0.40291806958473625, AUC 0.7509988776655443
  Second-Tier acc 0.5416666666666666, precision 0.44047619047619047, recall 0.378080808080808, F1 0.33175468809797165, AUC 0.7520202020202019
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5850340136054422, precision 0.33888888888888885, recall 0.373015873015873, F1 0.3117283950617284, AUC 0.7225406623554771
  Second-Tier acc 0.5918367346938775, precision 0.4178743961352657, recall 0.4166666666666667, F1 0.3677874636778746, AUC 0.715002204585538
Test AUC: 0.7150, Test F1: 0.3678 (Best Epoch: 6)
Current LR: 1.0797318581296948e-05
epoch: 7 idx: 0 First Loss : 2.3005759716033936, Second Loss : 2.4730591773986816
epoch: 7 idx: 200 First Loss : 1.0239701884154657, Second Loss : 1.032598927617073
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6736111111111112, precision 0.4403254278916264, recall 0.5838383838383838, F1 0.501993620414673, AUC 0.7543658810325478
  Second-Tier acc 0.6458333333333334, precision 0.6495495495495496, recall 0.5245454545454545, F1 0.53584229390681, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5850340136054422, precision 0.6809616634178037, recall 0.4210023515579071, F1 0.39858024691358024, AUC 0.7151675485008818
  Second-Tier acc 0.6530612244897959, precision 0.6611111111111111, recall 0.5352733686067019, F1 0.5276140306869016, AUC 0.7191909171075839
Test AUC: 0.7192, Test F1: 0.5276 (Best Epoch: 7)
Current LR: 1.0797318581296948e-05
epoch: 8 idx: 0 First Loss : 2.4051284790039062, Second Loss : 2.5832269191741943
epoch: 8 idx: 200 First Loss : 1.0096148577199053, Second Loss : 1.0176200557555726
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6597222222222222, precision 0.7530303030303029, recall 0.5854208754208754, F1 0.5000778804459786, AUC 0.7600897867564534
  Second-Tier acc 0.6666666666666666, precision 0.6047254150702427, recall 0.5837373737373738, F1 0.5897867564534232, AUC 0.758080808080808
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5918367346938775, precision 0.7194337194337194, recall 0.501984126984127, F1 0.4849035671616317, AUC 0.7230366941015088
  Second-Tier acc 0.5510204081632653, precision 0.5044444444444445, recall 0.5372574955908289, F1 0.5128205128205129, AUC 0.7237654320987653
Test AUC: 0.7238, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 1.0797318581296948e-05
epoch: 9 idx: 0 First Loss : 2.513357162475586, Second Loss : 2.6994240283966064
epoch: 9 idx: 200 First Loss : 0.994654043063299, Second Loss : 1.0025639672814615
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5833333333333334, precision 0.6125201288244767, recall 0.547003367003367, F1 0.4636853886853887, AUC 0.7708866442199774
  Second-Tier acc 0.6875, precision 0.6527777777777778, recall 0.6404040404040404, F1 0.6380236305048335, AUC 0.7654040404040403
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5918367346938775, precision 0.7274155538098978, recall 0.5194003527336861, F1 0.5057587854198023, AUC 0.7313896237507348
  Second-Tier acc 0.5714285714285714, precision 0.5377289377289377, recall 0.5725308641975309, F1 0.541871921182266, AUC 0.7374338624338623
Test AUC: 0.7374, Test F1: 0.5419 (Best Epoch: 9)
Current LR: 1.0797318581296948e-05
epoch: 10 idx: 0 First Loss : 2.62616229057312, Second Loss : 2.817810297012329
epoch: 10 idx: 200 First Loss : 0.9812139073451657, Second Loss : 0.9875181507671353
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5347222222222222, precision 0.557848655409631, recall 0.535993265993266, F1 0.4668492525390848, AUC 0.7781257014590347
  Second-Tier acc 0.5625, precision 0.5615384615384615, recall 0.5892929292929293, F1 0.5472222222222222, AUC 0.7598989898989897
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5374149659863946, precision 0.5887837062535858, recall 0.49243092298647856, F1 0.4787457420924574, AUC 0.7380768665490888
  Second-Tier acc 0.5714285714285714, precision 0.5569444444444445, recall 0.6197089947089948, F1 0.5545977011494253, AUC 0.7513778659611994
Test AUC: 0.7374, Test F1: 0.5419 (Best Epoch: 9)
Current LR: 1.0797318581296948e-05
epoch: 11 idx: 0 First Loss : 2.7365829944610596, Second Loss : 2.933729648590088
epoch: 11 idx: 200 First Loss : 0.9693763355970086, Second Loss : 0.974764637927066
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5, precision 0.5549937578027465, recall 0.5290572390572391, F1 0.45800362435304365, AUC 0.7869640852974186
  Second-Tier acc 0.5625, precision 0.6053077357425183, recall 0.6207070707070707, F1 0.5547089947089947, AUC 0.7718686868686868
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5034013605442177, precision 0.5297470312462816, recall 0.4816284538506761, F1 0.4596955980257669, AUC 0.7473851165980796
  Second-Tier acc 0.5306122448979592, precision 0.5330882352941176, recall 0.5950176366843033, F1 0.5215503875968993, AUC 0.7559523809523809
Test AUC: 0.7560, Test F1: 0.5216 (Best Epoch: 11)
Current LR: 1.0797318581296948e-05
epoch: 12 idx: 0 First Loss : 2.841395378112793, Second Loss : 3.04228138923645
epoch: 12 idx: 200 First Loss : 0.9596793466798998, Second Loss : 0.9645989359407431
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4652777777777778, precision 0.5167110667110667, recall 0.5124915824915824, F1 0.42821585025886105, AUC 0.7898933782267115
  Second-Tier acc 0.5416666666666666, precision 0.5927536231884059, recall 0.6073737373737373, F1 0.5347985347985348, AUC 0.7838888888888889
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5031339031339032, recall 0.4689888300999412, F1 0.43463203463203454, AUC 0.7585427689594356
  Second-Tier acc 0.4897959183673469, precision 0.5102707749766573, recall 0.5703262786596119, F1 0.49052845528455286, AUC 0.76168430335097
Test AUC: 0.7617, Test F1: 0.4905 (Best Epoch: 12)
Current LR: 1.0797318581296948e-05
epoch: 13 idx: 0 First Loss : 2.941849946975708, Second Loss : 3.1401398181915283
epoch: 13 idx: 200 First Loss : 0.952004807978053, Second Loss : 0.9567097523597194
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4583333333333333, precision 0.5384152987045089, recall 0.5176767676767676, F1 0.43301685543064855, AUC 0.7916947250280583
  Second-Tier acc 0.5208333333333334, precision 0.5824074074074074, recall 0.594040404040404, F1 0.5144126026478968, AUC 0.790151515151515
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46938775510204084, precision 0.5081807081807082, recall 0.47846854791299237, F1 0.4357839042049568, AUC 0.7623762982559278
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7630621693121693
Test AUC: 0.7631, Test F1: 0.4712 (Best Epoch: 13)
Current LR: 1.0797318581296948e-05
epoch: 14 idx: 0 First Loss : 3.0327091217041016, Second Loss : 3.224780797958374
epoch: 14 idx: 200 First Loss : 0.94678793274867, Second Loss : 0.9507908074379857
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4583333333333333, precision 0.5453371624479618, recall 0.5224915824915826, F1 0.4376463254198979, AUC 0.7978226711560045
  Second-Tier acc 0.5208333333333334, precision 0.5824074074074074, recall 0.594040404040404, F1 0.5144126026478968, AUC 0.8022222222222223
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.5124579124579124, recall 0.4803057025279247, F1 0.43646996278575223, AUC 0.7647523515579072
  Second-Tier acc 0.5306122448979592, precision 0.5831423478482302, recall 0.6294091710758377, F1 0.5335338345864661, AUC 0.7683531746031745
Test AUC: 0.7684, Test F1: 0.5335 (Best Epoch: 14){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.23116137227053252, "droprate_2": 0.0, "lr": 0.00012737384815622824, "weight_decay": 0.0002055182458661167, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.058780789664471034, "droprate_2": 0.0, "lr": 0.0001264914540793094, "weight_decay": 0.00015181458451139836, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.15061776862343115, "droprate_2": 0.0, "lr": 0.00027961700299719924, "weight_decay": 7.108480773744418e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.18376911430552947, "droprate_2": 0.0, "lr": 5.887658338938588e-05, "weight_decay": 1.5742244237166193e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.07587941288524003, "droprate_2": 0.0, "lr": 9.236628099276087e-05, "weight_decay": 0.00036356530108195873, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0895925760269165, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1120443330401213, Second Loss : 1.1077994061124266
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.746395202020202
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7536363636363638
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7088396990740741
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7036485890652556
epoch: 1 idx: 0 First Loss : 1.8075942993164062, Second Loss : 1.948839783668518
epoch: 1 idx: 200 First Loss : 1.0023771662320664, Second Loss : 1.0030959528032226
  First-Tier acc 0.5677083333333334, precision 0.4831501831501832, recall 0.40151515151515155, F1 0.3475177304964539, AUC 0.7357417929292929
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7431818181818182
  First-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7130111882716049
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7099867724867726
epoch: 2 idx: 0 First Loss : 2.414799690246582, Second Loss : 2.4150314331054688
epoch: 2 idx: 200 First Loss : 0.9564321844361314, Second Loss : 0.9553010532660271
  First-Tier acc 0.6145833333333334, precision 0.541285874619208, recall 0.5526515151515151, F1 0.48561135833863106, AUC 0.726991792929293
  Second-Tier acc 0.6666666666666666, precision 0.599027409372237, recall 0.5887878787878787, F1 0.5771604938271605, AUC 0.7441919191919192
  First-Tier acc 0.5969387755102041, precision 0.5745546035631715, recall 0.5315255731922398, F1 0.5264588263255248, AUC 0.7011305390211641
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5848765432098766, F1 0.5698005698005698, AUC 0.7245370370370371
epoch: 3 idx: 0 First Loss : 2.9906368255615234, Second Loss : 2.9917380809783936
epoch: 3 idx: 200 First Loss : 0.9356317716970373, Second Loss : 0.9287771321091782
  First-Tier acc 0.5052083333333334, precision 0.5338259441707717, recall 0.5193939393939394, F1 0.4717209842517803, AUC 0.7401294191919191
  Second-Tier acc 0.5416666666666666, precision 0.5545238095238095, recall 0.5427272727272728, F1 0.4995721009841678, AUC 0.7792424242424243
  First-Tier acc 0.5153061224489796, precision 0.5293564265962004, recall 0.5350529100529101, F1 0.5040447096713082, AUC 0.7210475914902998
  Second-Tier acc 0.5918367346938775, precision 0.5959595959595959, recall 0.6192680776014109, F1 0.5886710239651416, AUC 0.7317019400352734
epoch: 4 idx: 0 First Loss : 3.4611010551452637, Second Loss : 3.4767203330993652
epoch: 4 idx: 200 First Loss : 0.9299428420076471, Second Loss : 0.9168844252769182
  First-Tier acc 0.46875, precision 0.5241462602032317, recall 0.5051767676767677, F1 0.43916549584357806, AUC 0.7559027777777777
  Second-Tier acc 0.4791666666666667, precision 0.5081049218980253, recall 0.5052525252525253, F1 0.4337231968810917, AUC 0.8055555555555555
  First-Tier acc 0.5, precision 0.5278711484593838, recall 0.5225970017636684, F1 0.4796953874066261, AUC 0.7274650022045855
  Second-Tier acc 0.5306122448979592, precision 0.5370370370370371, recall 0.5529100529100529, F1 0.5183478532171742, AUC 0.732418430335097
epoch: 5 idx: 0 First Loss : 3.6976075172424316, Second Loss : 3.7652432918548584
epoch: 5 idx: 200 First Loss : 0.929385275019342, Second Loss : 0.9123582258329388
  First-Tier acc 0.4375, precision 0.4986504723346829, recall 0.48878787878787877, F1 0.41478436630878623, AUC 0.7555050505050506
  Second-Tier acc 0.4583333333333333, precision 0.5093795093795094, recall 0.4919191919191919, F1 0.41796224979793656, AUC 0.7879797979797981
  First-Tier acc 0.4897959183673469, precision 0.527209420143434, recall 0.5237544091710759, F1 0.47071462782715434, AUC 0.7199521880511464
  Second-Tier acc 0.5306122448979592, precision 0.5388888888888889, recall 0.5529100529100529, F1 0.5140629351155667, AUC 0.7416776895943563
epoch: 6 idx: 0 First Loss : 3.7712368965148926, Second Loss : 3.9719388484954834
epoch: 6 idx: 200 First Loss : 0.9284048311977615, Second Loss : 0.910708407605002
  First-Tier acc 0.453125, precision 0.5253413253413254, recall 0.5162121212121212, F1 0.44600389863547757, AUC 0.7305208333333333
  Second-Tier acc 0.4583333333333333, precision 0.5055555555555555, recall 0.5088888888888888, F1 0.41695702671312423, AUC 0.7691919191919192
  First-Tier acc 0.4744897959183674, precision 0.5427114963920724, recall 0.5384149029982362, F1 0.4677073003445463, AUC 0.7017471340388007
  Second-Tier acc 0.5510204081632653, precision 0.5549145299145299, recall 0.5473985890652557, F1 0.5146825396825397, AUC 0.7472442680776014
epoch: 7 idx: 0 First Loss : 3.7191998958587646, Second Loss : 4.037287712097168
epoch: 7 idx: 200 First Loss : 0.9293618056927785, Second Loss : 0.9085324864767362
  First-Tier acc 0.4166666666666667, precision 0.48780108780108783, recall 0.47608585858585856, F1 0.3967409997047197, AUC 0.7046022727272727
  Second-Tier acc 0.4375, precision 0.4876543209876543, recall 0.4955555555555556, F1 0.4054007567939457, AUC 0.7364141414141413
  First-Tier acc 0.44387755102040816, precision 0.5106152534723963, recall 0.4621913580246913, F1 0.41189876577403695, AUC 0.6901937279541447
  Second-Tier acc 0.5102040816326531, precision 0.5352564102564102, recall 0.5227072310405644, F1 0.4762547394126342, AUC 0.7416225749559082
epoch: 8 idx: 0 First Loss : 3.7076218128204346, Second Loss : 4.0590643882751465
epoch: 8 idx: 200 First Loss : 0.9240785773179786, Second Loss : 0.90453830715014
  First-Tier acc 0.4114583333333333, precision 0.4790172825887112, recall 0.47401515151515156, F1 0.3839149728075568, AUC 0.6877872474747475
  Second-Tier acc 0.4583333333333333, precision 0.49640852974186306, recall 0.5088888888888888, F1 0.4223820420616759, AUC 0.711010101010101
  First-Tier acc 0.4336734693877551, precision 0.5021654307368593, recall 0.4486882716049383, F1 0.3991461521401641, AUC 0.6883370535714285
  Second-Tier acc 0.4897959183673469, precision 0.5077777777777778, recall 0.4810405643738977, F1 0.4427350427350427, AUC 0.7423941798941799
epoch: 9 idx: 0 First Loss : 3.805418014526367, Second Loss : 4.133605480194092
epoch: 9 idx: 200 First Loss : 0.9274458495213127, Second Loss : 0.9047213512604861
  First-Tier acc 0.3854166666666667, precision 0.45769136708241626, recall 0.4501262626262626, F1 0.35332177342581256, AUC 0.671584595959596
  Second-Tier acc 0.4375, precision 0.4878547378547378, recall 0.4955555555555556, F1 0.4028679476249808, AUC 0.6916666666666668
  First-Tier acc 0.41836734693877553, precision 0.4895806451612903, recall 0.4244378306878307, F1 0.3632935272408224, AUC 0.6829048170194003
  Second-Tier acc 0.46938775510204084, precision 0.478030303030303, recall 0.45083774250440917, F1 0.3989234449760765, AUC 0.7408509700176366{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.11675106869017352, "droprate_2": 0.0, "lr": 1.3727540037610287e-05, "weight_decay": 4.4581954574676146e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 19, "gamma": 0.7312426883179477, "T_max": 16, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0848734378814697, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.069058574847321, Second Loss : 1.062886737175842
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7130429292929293
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6964141414141413
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6182622354497355
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6204254850088183
epoch: 1 idx: 0 First Loss : 1.907739520072937, Second Loss : 1.9488911628723145
epoch: 1 idx: 200 First Loss : 1.1043312097366769, Second Loss : 1.10028324198367
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7306597222222223
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7188888888888889
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.663976383377425
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6571318342151675
epoch: 2 idx: 0 First Loss : 2.0017998218536377, Second Loss : 2.0322723388671875
epoch: 2 idx: 200 First Loss : 1.085807183118009, Second Loss : 1.085780335525375
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7448516414141414
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410606060606061
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6877996858465609
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6827601410934744
epoch: 3 idx: 0 First Loss : 2.070225954055786, Second Loss : 2.1057708263397217
epoch: 3 idx: 200 First Loss : 1.069496260946663, Second Loss : 1.0730571345013766
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7435669191919193
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486363636363637
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002280368165786
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7007275132275131
epoch: 4 idx: 0 First Loss : 2.149789571762085, Second Loss : 2.184159994125366
epoch: 4 idx: 200 First Loss : 1.0547830793839783, Second Loss : 1.0606958455410762
  First-Tier acc 0.5677083333333334, precision 0.5154826958105647, recall 0.40151515151515155, F1 0.348778807476054, AUC 0.7418813131313131
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7460606060606061
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.7015128968253967
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7005070546737212
epoch: 5 idx: 0 First Loss : 2.239677667617798, Second Loss : 2.2729837894439697
epoch: 5 idx: 200 First Loss : 1.0393248726405315, Second Loss : 1.0473158559321765
  First-Tier acc 0.5885416666666666, precision 0.38641975308641974, recall 0.44878787878787874, F1 0.3974279623134585, AUC 0.7409974747474747
  Second-Tier acc 0.6041666666666666, precision 0.6673441734417344, recall 0.46646464646464647, F1 0.4646464646464647, AUC 0.7435858585858585
  First-Tier acc 0.5867346938775511, precision 0.3418574685300822, recall 0.3778659611992945, F1 0.32140350877192986, AUC 0.697186397707231
  Second-Tier acc 0.6326530612244898, precision 0.8666666666666667, recall 0.48214285714285715, F1 0.4762626262626262, AUC 0.7019400352733687
epoch: 6 idx: 0 First Loss : 2.333960771560669, Second Loss : 2.3681623935699463
epoch: 6 idx: 200 First Loss : 1.0242770572577542, Second Loss : 1.0331863190107677
  First-Tier acc 0.65625, precision 0.42458400429414916, recall 0.5557575757575758, F1 0.4809923969587835, AUC 0.7431186868686869
  Second-Tier acc 0.6458333333333334, precision 0.6708437761069339, recall 0.5270707070707071, F1 0.528042328042328, AUC 0.7488383838383837
  First-Tier acc 0.5816326530612245, precision 0.6137179837754079, recall 0.441358024691358, F1 0.44170485096866835, AUC 0.6899147100970017
  Second-Tier acc 0.6938775510204082, precision 0.8195121951219514, recall 0.5714285714285714, F1 0.5874811463046757, AUC 0.6940035273368607
epoch: 7 idx: 0 First Loss : 2.4265623092651367, Second Loss : 2.456068754196167
epoch: 7 idx: 200 First Loss : 1.0120573215075392, Second Loss : 1.020130273232709
  First-Tier acc 0.6614583333333334, precision 0.7529733204757313, recall 0.5832828282828283, F1 0.5082196482196483, AUC 0.7410132575757574
  Second-Tier acc 0.7083333333333334, precision 0.65, recall 0.6154545454545454, F1 0.6140350877192982, AUC 0.7509595959595959
  First-Tier acc 0.5561224489795918, precision 0.5559296670407782, recall 0.4501212522045856, F1 0.4360715098008341, AUC 0.6903625165343915
  Second-Tier acc 0.5510204081632653, precision 0.5154320987654321, recall 0.5372574955908289, F1 0.52326685660019, AUC 0.6902557319223984
epoch: 8 idx: 0 First Loss : 2.506535053253174, Second Loss : 2.5335731506347656
epoch: 8 idx: 200 First Loss : 1.000208649580455, Second Loss : 1.0075770974048037
  First-Tier acc 0.609375, precision 0.5129124913895062, recall 0.5584343434343435, F1 0.47703998685988, AUC 0.7442613636363636
  Second-Tier acc 0.7083333333333334, precision 0.6994047619047619, recall 0.6493939393939394, F1 0.6239517819706499, AUC 0.7493939393939394
  First-Tier acc 0.5459183673469388, precision 0.5183786121286121, recall 0.4656084656084656, F1 0.44842687979908097, AUC 0.6917334931657848
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5670194003527337, F1 0.5623931623931624, AUC 0.7002865961199295
epoch: 9 idx: 0 First Loss : 2.5687639713287354, Second Loss : 2.594310998916626
epoch: 9 idx: 200 First Loss : 0.9882347755949592, Second Loss : 0.9944325871394938
  First-Tier acc 0.5729166666666666, precision 0.5561868686868686, recall 0.5423232323232323, F1 0.4697061803444782, AUC 0.7461268939393939
  Second-Tier acc 0.6875, precision 0.6944444444444445, recall 0.653030303030303, F1 0.6121626069782752, AUC 0.752828282828283
  First-Tier acc 0.5357142857142857, precision 0.4982724157624215, recall 0.45783730158730157, F1 0.43113859288949713, AUC 0.693459270282187
  Second-Tier acc 0.5918367346938775, precision 0.5669856459330144, recall 0.5784832451499118, F1 0.5661719233147804, AUC 0.698743386243386{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.015936729802025762, "droprate_2": 0.0, "lr": 0.000540249952650885, "weight_decay": 6.409144351403933e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0898772478103638, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.087947249301334, Second Loss : 1.0822074194971603
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337310606060606
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7469191919191919
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.710710152116402
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7152226631393298
epoch: 1 idx: 0 First Loss : 1.6314713954925537, Second Loss : 1.853758692741394
epoch: 1 idx: 200 First Loss : 0.9756695278248384, Second Loss : 0.9732780381666487
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7148958333333333
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7178787878787878
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7123773699294533
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7126873897707231
epoch: 2 idx: 0 First Loss : 2.209707498550415, Second Loss : 2.4270896911621094
epoch: 2 idx: 200 First Loss : 0.9427260192694948, Second Loss : 0.9406406613650606
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.6983743686868685
  Second-Tier acc 0.6666666666666666, precision 0.5967261904761905, recall 0.5768686868686869, F1 0.5299582289055973, AUC 0.7057070707070707
  First-Tier acc 0.5561224489795918, precision 0.2976396085204375, recall 0.33928571428571425, F1 0.2505020928355576, AUC 0.689504794973545
  Second-Tier acc 0.5510204081632653, precision 0.46220828979449674, recall 0.46715167548500885, F1 0.4624089635854342, AUC 0.6832010582010583
epoch: 3 idx: 0 First Loss : 3.338876724243164, Second Loss : 3.1862683296203613
epoch: 3 idx: 200 First Loss : 0.9346564547413617, Second Loss : 0.9368003164487544
  First-Tier acc 0.4375, precision 0.37914466485895054, recall 0.4624242424242424, F1 0.3367428728660469, AUC 0.6596559343434343
  Second-Tier acc 0.5, precision 0.36055656382335144, recall 0.48969696969696974, F1 0.37878787878787873, AUC 0.6925252525252525
  First-Tier acc 0.49489795918367346, precision 0.3749855374291334, recall 0.42835097001763667, F1 0.3602574002574002, AUC 0.6921537422839507
  Second-Tier acc 0.5306122448979592, precision 0.3853801169590643, recall 0.44708994708994715, F1 0.38405797101449274, AUC 0.7040895061728394
epoch: 4 idx: 0 First Loss : 3.3711800575256348, Second Loss : 3.2810208797454834
epoch: 4 idx: 200 First Loss : 0.9265950039070823, Second Loss : 0.9104949611317904
  First-Tier acc 0.4114583333333333, precision 0.375266635450809, recall 0.4457575757575758, F1 0.3163641194729278, AUC 0.6773421717171718
  Second-Tier acc 0.4166666666666667, precision 0.3361344537815126, recall 0.43636363636363634, F1 0.3190883190883191, AUC 0.6881818181818181
  First-Tier acc 0.4846938775510204, precision 0.41572822822822825, recall 0.44223985890652556, F1 0.3536953242835596, AUC 0.6975067515432097
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6915784832451498
epoch: 5 idx: 0 First Loss : 3.561846971511841, Second Loss : 3.4137847423553467
epoch: 5 idx: 200 First Loss : 0.9095351741005161, Second Loss : 0.8904582113954261
  First-Tier acc 0.3697916666666667, precision 0.36522710349962767, recall 0.4190909090909091, F1 0.2812176740062066, AUC 0.6743907828282829
  Second-Tier acc 0.3958333333333333, precision 0.34259259259259256, recall 0.42303030303030303, F1 0.3040061337933679, AUC 0.668939393939394
  First-Tier acc 0.47959183673469385, precision 0.42772457820337434, recall 0.44488536155202824, F1 0.348849245328855, AUC 0.6942446538800705
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.6929563492063492
epoch: 6 idx: 0 First Loss : 3.6322929859161377, Second Loss : 3.52413272857666
epoch: 6 idx: 200 First Loss : 0.9117540592438916, Second Loss : 0.8874225825933155
  First-Tier acc 0.359375, precision 0.3685968075869899, recall 0.4124242424242424, F1 0.2721529200024824, AUC 0.6570359848484849
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6557070707070707
  First-Tier acc 0.4387755102040816, precision 0.42560575075912505, recall 0.4230599647266314, F1 0.3139998056931896, AUC 0.7006620645943563
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.6894290123456789
epoch: 7 idx: 0 First Loss : 3.6013259887695312, Second Loss : 3.491666555404663
epoch: 7 idx: 200 First Loss : 0.9032547774085247, Second Loss : 0.881061267213136
  First-Tier acc 0.359375, precision 0.37733587194132995, recall 0.4166666666666667, F1 0.2709058907238887, AUC 0.6554955808080808
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.6831818181818181
  First-Tier acc 0.42857142857142855, precision 0.4336155275655586, recall 0.4197530864197531, F1 0.303667092184653, AUC 0.6630807705026455
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7063492063492064
epoch: 8 idx: 0 First Loss : 3.428480625152588, Second Loss : 3.7434020042419434
epoch: 8 idx: 200 First Loss : 0.9054999661061969, Second Loss : 0.8830981929751752
  First-Tier acc 0.34375, precision 0.37040469570590057, recall 0.4066666666666667, F1 0.2560846560846561, AUC 0.6520296717171717
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6766161616161616
  First-Tier acc 0.42857142857142855, precision 0.4336155275655586, recall 0.4197530864197531, F1 0.303667092184653, AUC 0.6599633487654322
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7136243386243386
epoch: 9 idx: 0 First Loss : 3.3988399505615234, Second Loss : 3.5158770084381104
epoch: 9 idx: 200 First Loss : 0.9058250889352369, Second Loss : 0.8844601593891955
  First-Tier acc 0.34375, precision 0.37040469570590057, recall 0.4066666666666667, F1 0.2560846560846561, AUC 0.6485763888888889
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6708585858585859
  First-Tier acc 0.42346938775510207, precision 0.43253968253968256, recall 0.4166666666666667, F1 0.29901960784313725, AUC 0.6647824349647267
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7180886243386243{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_8", "train_show_freq": 200, "droprate": 0.12480439481386986, "droprate_2": 0.0, "lr": 0.0003030603941487281, "weight_decay": 3.931382216860664e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 19, "gamma": 0.4695366399151869, "T_max": 16, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_8", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.082453727722168, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0724954524665922, Second Loss : 1.0727426059062208
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7319412878787879
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444444444444445
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7182953042328042
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7293320105820106
epoch: 1 idx: 0 First Loss : 1.6805856227874756, Second Loss : 1.7858994007110596
epoch: 1 idx: 200 First Loss : 0.9768595719218847, Second Loss : 0.9783122199240015
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7204766414141414
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7227272727272727
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7142512676366843
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138999118165786
epoch: 2 idx: 0 First Loss : 2.1027133464813232, Second Loss : 2.158449411392212
epoch: 2 idx: 200 First Loss : 0.9502897251823649, Second Loss : 0.9481880490237208
  First-Tier acc 0.59375, precision 0.37749546279491836, recall 0.52, F1 0.43333333333333335, AUC 0.6975694444444445
  Second-Tier acc 0.6041666666666666, precision 0.3796296296296296, recall 0.48848484848484847, F1 0.4252791636968401, AUC 0.7105555555555556
  First-Tier acc 0.5561224489795918, precision 0.3545864875430927, recall 0.42526455026455023, F1 0.38397517280293414, AUC 0.7015576774691358
  Second-Tier acc 0.5510204081632653, precision 0.3371212121212121, recall 0.4021164021164021, F1 0.3666666666666667, AUC 0.6952160493827161
epoch: 3 idx: 0 First Loss : 2.9041736125946045, Second Loss : 2.928401470184326
epoch: 3 idx: 200 First Loss : 0.9364448614807716, Second Loss : 0.9311240954945484
  First-Tier acc 0.40625, precision 0.3675146974663129, recall 0.4424242424242424, F1 0.3117021148109231, AUC 0.6954577020202021
  Second-Tier acc 0.4583333333333333, precision 0.3541666666666667, recall 0.46303030303030307, F1 0.3501607109094347, AUC 0.7180808080808081
  First-Tier acc 0.4846938775510204, precision 0.40420227920227925, recall 0.4365079365079365, F1 0.3541666666666667, AUC 0.7058083939594356
  Second-Tier acc 0.5102040816326531, precision 0.37753882915173237, recall 0.4347442680776014, F1 0.3703703703703704, AUC 0.710758377425044
epoch: 4 idx: 0 First Loss : 3.4373955726623535, Second Loss : 3.5092055797576904
epoch: 4 idx: 200 First Loss : 0.9254010461979726, Second Loss : 0.9172337636309884
  First-Tier acc 0.3958333333333333, precision 0.375733199262611, recall 0.4357575757575758, F1 0.3037894557450486, AUC 0.7106281565656566
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.751919191919192
  First-Tier acc 0.4642857142857143, precision 0.41630591630591635, recall 0.43276014109347444, F1 0.3371428571428572, AUC 0.7025290729717814
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.7021604938271605
epoch: 5 idx: 0 First Loss : 3.6886191368103027, Second Loss : 3.7213709354400635
epoch: 5 idx: 200 First Loss : 0.9241490167801949, Second Loss : 0.9171147407472726
  First-Tier acc 0.3802083333333333, precision 0.38517247951210215, recall 0.43, F1 0.28986258750324084, AUC 0.6861963383838384
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7053030303030304
  First-Tier acc 0.45408163265306123, precision 0.4209415944925605, recall 0.4294532627865961, F1 0.3280416506635941, AUC 0.6808483520723104
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.6890432098765432
epoch: 6 idx: 0 First Loss : 3.64912748336792, Second Loss : 3.6462907791137695
epoch: 6 idx: 200 First Loss : 0.9161811494558068, Second Loss : 0.906450231272301
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6768813131313132
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7048484848484847
  First-Tier acc 0.4489795918367347, precision 0.43775175063518623, recall 0.43209876543209874, F1 0.3217720781113378, AUC 0.683659198633157
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.6841931216931217
epoch: 7 idx: 0 First Loss : 3.602019786834717, Second Loss : 3.6059963703155518
epoch: 7 idx: 200 First Loss : 0.9113812970576127, Second Loss : 0.9008909009787398
  First-Tier acc 0.359375, precision 0.37733587194132995, recall 0.4166666666666667, F1 0.2709058907238887, AUC 0.671707702020202
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.6910101010101011
  First-Tier acc 0.4387755102040816, precision 0.43571195829260345, recall 0.4259259259259259, F1 0.31281400219191163, AUC 0.6859292328042327
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7150022045855379
epoch: 8 idx: 0 First Loss : 3.5143752098083496, Second Loss : 3.5201969146728516
epoch: 8 idx: 200 First Loss : 0.9086884734289146, Second Loss : 0.8967902521922517
  First-Tier acc 0.3489583333333333, precision 0.3728395061728395, recall 0.41, F1 0.2610857853294654, AUC 0.6674210858585857
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6902020202020203
  First-Tier acc 0.41836734693877553, precision 0.431441303236175, recall 0.41358024691358025, F1 0.29432098765432096, AUC 0.6882957175925926
  Second-Tier acc 0.4897959183673469, precision 0.4258373205741626, recall 0.4567901234567901, F1 0.3549257759784075, AUC 0.716876102292769
epoch: 9 idx: 0 First Loss : 3.493342161178589, Second Loss : 3.534116268157959
epoch: 9 idx: 200 First Loss : 0.9044254676394561, Second Loss : 0.8965052767495731
  First-Tier acc 0.3385416666666667, precision 0.36782435129740515, recall 0.4033333333333333, F1 0.2510205371248025, AUC 0.6658648989898989
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6816666666666666
  First-Tier acc 0.40816326530612246, precision 0.4291617933723197, recall 0.40740740740740744, F1 0.28476477537455974, AUC 0.6883473875661377
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7402998236331569