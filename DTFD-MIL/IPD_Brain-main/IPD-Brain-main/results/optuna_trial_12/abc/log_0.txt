{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.2108845474256873, "droprate_2": 0.0, "lr": 7.827818858948105e-05, "weight_decay": 1.0086347756723274e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 7.827818858948105e-05
epoch: 0 idx: 0 First Loss : 1.051105260848999, Second Loss : 1.0701088905334473
epoch: 0 idx: 200 First Loss : 1.1040998468203331, Second Loss : 1.0958757190710275
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.506177398989899
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4892929292929293
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4439105213844798
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44323192239858905
 
 test auc: 0.44323192239858905, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.4104343469019805, "droprate_2": 0.0, "lr": 0.0004950499914700497, "weight_decay": 3.583216139300892e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0004950499914700497
epoch: 0 idx: 0 First Loss : 1.1394309997558594, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.089843760554989, Second Loss : 1.0820271901378584
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4769570707070707
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.46954545454545454
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4344824735449735
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4412477954144621
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 1 idx: 0 First Loss : 1.5633437633514404, Second Loss : 1.8413443565368652
epoch: 1 idx: 200 First Loss : 0.9844334161474337, Second Loss : 0.9853266369347549
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4642171717171717
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.46530303030303033
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4787533068783069
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.47740299823633153
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 2 idx: 0 First Loss : 2.257880926132202, Second Loss : 2.4983561038970947
epoch: 2 idx: 200 First Loss : 0.9519137693152054, Second Loss : 0.9783527898921895
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.22916666666666666, precision 0.15789473684210528, recall 0.26944444444444443, F1 0.16095238095238096, AUC 0.4516287878787879
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.44151515151515147
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2653061224489796, precision 0.20879629629629629, recall 0.37202380952380953, F1 0.25453885257806824, AUC 0.4754877645502645
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4641203703703704
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 3 idx: 0 First Loss : 2.7702107429504395, Second Loss : 3.1018259525299072
epoch: 3 idx: 200 First Loss : 0.9436787480432818, Second Loss : 0.9647844834299526
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.19502102835436166, recall 0.19141414141414145, F1 0.19002519246692387, AUC 0.3792424242424242
  Second-Tier acc 0.22916666666666666, precision 0.15967365967365968, recall 0.32575757575757575, F1 0.21424774056353005, AUC 0.4156060606060606
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.30612244897959184, precision 0.3638655462184874, recall 0.4305555555555556, F1 0.30581508253317513, AUC 0.5398754409171076
  Second-Tier acc 0.30612244897959184, precision 0.21043771043771042, recall 0.25396825396825395, F1 0.22000995520159283, AUC 0.4704585537918871
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 4 idx: 0 First Loss : 3.157565116882324, Second Loss : 3.775451183319092
epoch: 4 idx: 200 First Loss : 0.9154411152055005, Second Loss : 0.9673519373097601
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.23958333333333334, precision 0.13554463554463556, recall 0.3446969696969697, F1 0.1823671497584541, AUC 0.3823863636363636
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.3405050505050505
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3979591836734694, precision 0.19258373205741627, recall 0.25220458553791886, F1 0.21641025641025638, AUC 0.4072420634920635
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.41804453262786595
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 5 idx: 0 First Loss : 3.503173828125, Second Loss : 4.187191963195801
epoch: 5 idx: 200 First Loss : 0.901691460145049, Second Loss : 0.964036865963772
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.28125, precision 0.3563251563251563, recall 0.3556565656565656, F1 0.235016835016835, AUC 0.4706818181818182
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.3569191919191919
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3877551020408163, precision 0.19672754946727553, recall 0.24922839506172842, F1 0.21803524559430068, AUC 0.3918788580246913
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.47255291005291006
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 6 idx: 0 First Loss : 3.615781784057617, Second Loss : 4.3352861404418945
epoch: 6 idx: 200 First Loss : 0.8927286852101056, Second Loss : 0.9568799282198271
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2916666666666667, precision 0.348792270531401, recall 0.3597979797979798, F1 0.27041107041107043, AUC 0.4854419191919192
  Second-Tier acc 0.2708333333333333, precision 0.18466898954703834, recall 0.3888888888888889, F1 0.21120107962213228, AUC 0.4174242424242425
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.42857142857142855, precision 0.3202279202279202, recall 0.33509700176366847, F1 0.32102143182854537, AUC 0.42042824074074076
  Second-Tier acc 0.40816326530612246, precision 0.19572649572649573, recall 0.2583774250440917, F1 0.21969696969696972, AUC 0.49410273368606705
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 7 idx: 0 First Loss : 3.610581874847412, Second Loss : 4.390573024749756
epoch: 7 idx: 200 First Loss : 0.8952375004245373, Second Loss : 0.9568096103492153
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2604166666666667, precision 0.2636904761904762, recall 0.2822222222222222, F1 0.20438426821405545, AUC 0.42771464646464646
  Second-Tier acc 0.1875, precision 0.075, recall 0.25, F1 0.11538461538461538, AUC 0.34040404040404043
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.336734693877551, precision 0.3666849415204678, recall 0.353395061728395, F1 0.2868875086266391, AUC 0.48857749118165783
  Second-Tier acc 0.3673469387755102, precision 0.30256410256410254, recall 0.35978835978835977, F1 0.25905150433452323, AUC 0.5233134920634921
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 8 idx: 0 First Loss : 3.2628684043884277, Second Loss : 4.300179481506348
epoch: 8 idx: 200 First Loss : 0.8923315961138583, Second Loss : 0.9515997465066867
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2604166666666667, precision 0.4926787252368648, recall 0.36777777777777776, F1 0.1892784049646795, AUC 0.41946969696969694
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.44020202020202026
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4363288139329806
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.45590828924162263
 
 test auc: 0.4412477954144621, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0004950499914700497
epoch: 9 idx: 0 First Loss : 2.986750364303589, Second Loss : 3.976191997528076
epoch: 9 idx: 200 First Loss : 0.8927207492482179, Second Loss : 0.9470547624588284
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.28125, precision 0.5029411764705882, recall 0.3811111111111111, F1 0.21647416681361312, AUC 0.6358080808080808
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6304040404040404
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4897959183673469, precision 0.2574074074074074, recall 0.3109567901234568, F1 0.25092592592592594, AUC 0.4421158509700176
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4724426807760141
 
 test auc: 0.4724426807760141, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.0004950499914700497
epoch: 10 idx: 0 First Loss : 3.0247802734375, Second Loss : 3.9862611293792725
epoch: 10 idx: 200 First Loss : 0.9098731948620705, Second Loss : 0.9554794948630684
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.28125, precision 0.4853658536585366, recall 0.37262626262626264, F1 0.22321378693927715, AUC 0.6480808080808081
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.630959595959596
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3979591836734694, precision 0.19999999999999998, recall 0.25540123456790126, F1 0.216832504145937, AUC 0.4409446649029983
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.47420634920634924
 
 test auc: 0.47420634920634924, test F1: 0.2191780821917808  :  from epoch 10
 current learn rate 0.0004950499914700497
epoch: 11 idx: 0 First Loss : 3.339449882507324, Second Loss : 4.139924049377441
epoch: 11 idx: 200 First Loss : 0.8898214909716781, Second Loss : 0.9373217071708985
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3645833333333333, precision 0.44675925925925924, recall 0.4174747474747474, F1 0.31482376961100367, AUC 0.6610732323232323
  Second-Tier acc 0.22916666666666666, precision 0.1289198606271777, recall 0.33080808080808083, F1 0.16329284750337383, AUC 0.6519191919191919
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3877551020408163, precision 0.22979985174203113, recall 0.2932098765432099, F1 0.25752380952380954, AUC 0.44184027777777785
  Second-Tier acc 0.40816326530612246, precision 0.16666666666666666, recall 0.24691358024691357, F1 0.1990049751243781, AUC 0.4749779541446208
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 12 idx: 0 First Loss : 3.2447705268859863, Second Loss : 4.057313442230225
epoch: 12 idx: 200 First Loss : 0.901917756467836, Second Loss : 0.946657586170419
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3229166666666667, precision 0.40264550264550264, recall 0.4077777777777778, F1 0.26632996632996636, AUC 0.4654545454545455
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.46030303030303027
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4897959183673469, precision 0.25365853658536586, recall 0.3256172839506173, F1 0.27677224736048267, AUC 0.42135141093474426
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.47558421516754845
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 13 idx: 0 First Loss : 3.3656256198883057, Second Loss : 4.2914557456970215
epoch: 13 idx: 200 First Loss : 0.9380897416563104, Second Loss : 0.9650395637503045
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4479166666666667, precision 0.3330759330759331, recall 0.32656565656565656, F1 0.3013658820110433, AUC 0.5456691919191919
  Second-Tier acc 0.2708333333333333, precision 0.4873015873015873, recall 0.3744444444444444, F1 0.20322149178974927, AUC 0.45858585858585865
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.23469387755102042, precision 0.2445887445887446, recall 0.28858024691358025, F1 0.1915544675642595, AUC 0.43121693121693117
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.5042438271604939
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 14 idx: 0 First Loss : 3.58674955368042, Second Loss : 4.318851947784424
epoch: 14 idx: 200 First Loss : 0.9123779588049973, Second Loss : 0.9298576061984153
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3645833333333333, precision 0.23695491500369548, recall 0.32, F1 0.2691086691086691, AUC 0.5930808080808081
  Second-Tier acc 0.3333333333333333, precision 0.22020568663036902, recall 0.4696969696969697, F1 0.2956989247311828, AUC 0.5533838383838384
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.15306122448979592, precision 0.10584795321637426, recall 0.25, F1 0.14088250930356194, AUC 0.38158619929453264
  Second-Tier acc 0.3877551020408163, precision 0.21338383838383837, recall 0.2574955908289242, F1 0.2333333333333333, AUC 0.41413139329806
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 15 idx: 0 First Loss : 3.8926286697387695, Second Loss : 4.667043209075928
epoch: 15 idx: 200 First Loss : 0.9009630701623371, Second Loss : 0.932725288018075
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4270833333333333, precision 0.31487009397457155, recall 0.32171717171717173, F1 0.30332630332630334, AUC 0.5762121212121213
  Second-Tier acc 0.2708333333333333, precision 0.4873015873015873, recall 0.3744444444444444, F1 0.20322149178974927, AUC 0.5940909090909091
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.23469387755102042, precision 0.21837242359630418, recall 0.25925925925925924, F1 0.18620824762464494, AUC 0.4269317680776014
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.43546075837742504
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 16 idx: 0 First Loss : 3.9511592388153076, Second Loss : 4.52932596206665
epoch: 16 idx: 200 First Loss : 0.8989148641030489, Second Loss : 0.935884019333595
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4583333333333333, precision 0.27390180878552967, recall 0.30777777777777776, F1 0.2503267973856209, AUC 0.575479797979798
  Second-Tier acc 0.3125, precision 0.5317460317460317, recall 0.40111111111111114, F1 0.2542377957472297, AUC 0.5897979797979798
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.20408163265306123, precision 0.32592592592592595, recall 0.35802469135802467, F1 0.14582667093060442, AUC 0.4618882275132275
  Second-Tier acc 0.4897959183673469, precision 0.25757575757575757, recall 0.3256172839506173, F1 0.2715179968701095, AUC 0.43667328042328046
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 17 idx: 0 First Loss : 4.208419322967529, Second Loss : 4.916714191436768
epoch: 17 idx: 200 First Loss : 0.8833282219798263, Second Loss : 0.9246297021272156
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3645833333333333, precision 0.32437275985663083, recall 0.39454545454545453, F1 0.29493779493779493, AUC 0.5001010101010102
  Second-Tier acc 0.3333333333333333, precision 0.34259259259259256, recall 0.383030303030303, F1 0.2630560928433269, AUC 0.5028787878787879
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.37755102040816324, precision 0.1761904761904762, recall 0.22839506172839508, F1 0.19892473118279572, AUC 0.4879574514991181
  Second-Tier acc 0.42857142857142855, precision 0.16666666666666666, recall 0.25925925925925924, F1 0.2028985507246377, AUC 0.5275573192239859
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 18 idx: 0 First Loss : 4.309967517852783, Second Loss : 5.0881667137146
epoch: 18 idx: 200 First Loss : 0.8907947678692256, Second Loss : 0.9367342924954372
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.3386294261294261, recall 0.35863636363636364, F1 0.31904004845181316, AUC 0.5700126262626263
  Second-Tier acc 0.3333333333333333, precision 0.3269967580312408, recall 0.36353535353535354, F1 0.29317738791423004, AUC 0.5684848484848485
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3877551020408163, precision 0.26406926406926406, recall 0.275352733686067, F1 0.2591129591129591, AUC 0.45240850970017643
  Second-Tier acc 0.3469387755102041, precision 0.1923076923076923, recall 0.2391975308641975, F1 0.21253699219800914, AUC 0.42565035273368607
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11
 current learn rate 0.0004950499914700497
epoch: 19 idx: 0 First Loss : 4.37056827545166, Second Loss : 5.182554244995117
epoch: 19 idx: 200 First Loss : 0.8566267969949899, Second Loss : 0.9115944147816746
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.20833333333333334, precision 0.0749063670411985, recall 0.30303030303030304, F1 0.12012012012012012, AUC 0.49805555555555564
  Second-Tier acc 0.4791666666666667, precision 0.16666666666666666, recall 0.3066666666666667, F1 0.215962441314554, AUC 0.5558585858585859
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.5204081632653061, precision 0.18085106382978722, recall 0.3148148148148148, F1 0.22972972972972971, AUC 0.47405478395061723
  Second-Tier acc 0.14285714285714285, precision 0.050724637681159424, recall 0.2916666666666667, F1 0.08641975308641975, AUC 0.39858906525573196
 
 test auc: 0.4749779541446208, test F1: 0.1990049751243781  :  from epoch 11{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.4911740734022901, "droprate_2": 0.0, "lr": 1.0349094263845438e-05, "weight_decay": 7.405325951170172e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0349094263845438e-05
epoch: 0 idx: 0 First Loss : 1.2629538774490356, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.058523438611434, Second Loss : 1.03544519567371
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6632940516273849
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7424242424242425
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6031133646874388
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6021825396825397
Test AUC: 0.6022, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0349094263845438e-05
epoch: 1 idx: 0 First Loss : 1.9773305654525757, Second Loss : 1.9104126691818237
epoch: 1 idx: 200 First Loss : 1.1059313942840443, Second Loss : 1.0950617016992759
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7034736251402919
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7520707070707071
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6444248481285519
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6421957671957671
Test AUC: 0.6422, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0349094263845438e-05
epoch: 2 idx: 0 First Loss : 2.1409881114959717, Second Loss : 2.107792377471924
epoch: 2 idx: 200 First Loss : 1.104526097279283, Second Loss : 1.095183587192896
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7208193041526375
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7578787878787878
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6751114540466392
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6813271604938271
Test AUC: 0.6813, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0349094263845438e-05
epoch: 3 idx: 0 First Loss : 2.179018020629883, Second Loss : 2.163846731185913
epoch: 3 idx: 200 First Loss : 1.091327587985874, Second Loss : 1.0842851114213763
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7316386083052752
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6946587791495199
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.704971340388007
Test AUC: 0.7050, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0349094263845438e-05
epoch: 4 idx: 0 First Loss : 2.2286415100097656, Second Loss : 2.2139999866485596
epoch: 4 idx: 200 First Loss : 1.0782309957775311, Second Loss : 1.0730466191003571
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7404377104377105
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.762979797979798
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7056878306878307
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7060736331569665
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 5 idx: 0 First Loss : 2.283405065536499, Second Loss : 2.2735886573791504
epoch: 5 idx: 200 First Loss : 1.0662861458252912, Second Loss : 1.0627216426516646
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408417508417507
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7532323232323233
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7142673427395648
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7153880070546738
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 6 idx: 0 First Loss : 2.339826822280884, Second Loss : 2.3383262157440186
epoch: 6 idx: 200 First Loss : 1.0529834728928942, Second Loss : 1.051092216661617
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7394276094276094
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.75
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7165209190672153
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7117504409171076
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 7 idx: 0 First Loss : 2.397386312484741, Second Loss : 2.412585973739624
epoch: 7 idx: 200 First Loss : 1.0383396053418, Second Loss : 1.038253617412712
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.4108527131782946, recall 0.4254545454545455, F1 0.37745098039215685, AUC 0.7369360269360271
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7497979797979797
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5782312925170068, precision 0.6359338061465721, recall 0.3829365079365079, F1 0.3321321321321321, AUC 0.7117320693709583
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7120811287477954
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 8 idx: 0 First Loss : 2.467707395553589, Second Loss : 2.495407819747925
epoch: 8 idx: 200 First Loss : 1.022468154165727, Second Loss : 1.0232842756592813
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6319444444444444, precision 0.7457227138643067, recall 0.511077441077441, F1 0.46381335743037866, AUC 0.7367564534231201
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7528282828282827
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6598639455782312, precision 0.7222506490799173, recall 0.5274838330393886, F1 0.5456158220864104, AUC 0.7044875563394083
  Second-Tier acc 0.6326530612244898, precision 0.7100737100737101, recall 0.46935626102292766, F1 0.46782407407407406, AUC 0.7055224867724869
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 9 idx: 0 First Loss : 2.543161153793335, Second Loss : 2.5902650356292725
epoch: 9 idx: 200 First Loss : 1.0058476106259064, Second Loss : 1.0084156343963608
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6736111111111112, precision 0.6399215076898558, recall 0.6022558922558923, F1 0.5607169253510718, AUC 0.7338552188552189
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7505050505050505
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.6054421768707483, precision 0.5928921331434707, recall 0.567607289829512, F1 0.5771779676782144, AUC 0.7067227611209094
  Second-Tier acc 0.5510204081632653, precision 0.4806349206349206, recall 0.4658289241622575, F1 0.44998334998334993, AUC 0.7054122574955909
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 10 idx: 0 First Loss : 2.6206109523773193, Second Loss : 2.693505048751831
epoch: 10 idx: 200 First Loss : 0.990984614475153, Second Loss : 0.9952031177704903
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5902777777777778, precision 0.5435711631363805, recall 0.5560269360269361, F1 0.5341272478859717, AUC 0.730679012345679
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7468181818181817
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.6054421768707483, precision 0.5772249929457041, recall 0.6045708406819518, F1 0.5867256433294169, AUC 0.7109420928865373
  Second-Tier acc 0.5918367346938775, precision 0.5467218771566597, recall 0.5427689594356261, F1 0.522984522984523, AUC 0.7153880070546738
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 11 idx: 0 First Loss : 2.7011632919311523, Second Loss : 2.796778440475464
epoch: 11 idx: 200 First Loss : 0.9773504968398987, Second Loss : 0.9833258150043476
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5902777777777778, precision 0.5811719588894002, recall 0.5976767676767677, F1 0.5744512139466958, AUC 0.7298765432098765
  Second-Tier acc 0.5, precision 0.5326797385620915, recall 0.5016161616161617, F1 0.4475772765246449, AUC 0.7515151515151515
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5782312925170068, precision 0.5606821851128942, recall 0.603835978835979, F1 0.566119735790315, AUC 0.7099867724867724
  Second-Tier acc 0.6122448979591837, precision 0.621031746031746, recall 0.6137566137566138, F1 0.5929824561403508, AUC 0.728339947089947
Test AUC: 0.7061, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0349094263845438e-05
epoch: 12 idx: 0 First Loss : 2.779557466506958, Second Loss : 2.8938839435577393
epoch: 12 idx: 200 First Loss : 0.9654910438670893, Second Loss : 0.97317100903807
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5347222222222222, precision 0.5465701432087987, recall 0.5556228956228956, F1 0.5250233426704015, AUC 0.7324635241301909
  Second-Tier acc 0.5, precision 0.5702260702260702, recall 0.5474747474747474, F1 0.4831094831094831, AUC 0.7654545454545455
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5170068027210885, precision 0.5237749838813669, recall 0.5689300411522634, F1 0.5120360644257703, AUC 0.7150083284342544
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7401895943562611
Test AUC: 0.7402, Test F1: 0.5841 (Best Epoch: 12)
Current LR: 1.0349094263845438e-05
epoch: 13 idx: 0 First Loss : 2.846923828125, Second Loss : 2.9830567836761475
epoch: 13 idx: 200 First Loss : 0.9548440206221384, Second Loss : 0.9642036540053822
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.5, precision 0.5406032783483764, recall 0.5478451178451179, F1 0.49800711265162523, AUC 0.7349775533108867
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.7856565656565656
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.48299319727891155, precision 0.5151134689065723, recall 0.5543062904174015, F1 0.48228228228228226, AUC 0.7180151381540271
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7580467372134039
Test AUC: 0.7580, Test F1: 0.5624 (Best Epoch: 13)
Current LR: 1.0349094263845438e-05
epoch: 14 idx: 0 First Loss : 2.9091522693634033, Second Loss : 3.066941976547241
epoch: 14 idx: 200 First Loss : 0.9456952244265756, Second Loss : 0.9565866257142813
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4791666666666667, precision 0.5362266735148091, recall 0.5353535353535354, F1 0.4794818707862187, AUC 0.7437654320987654
  Second-Tier acc 0.5, precision 0.5724867724867725, recall 0.5763636363636363, F1 0.49589408412937824, AUC 0.7855050505050505
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.504474802671524, recall 0.5419606114050558, F1 0.46586317460103865, AUC 0.7251249265138154
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7606371252204586
Test AUC: 0.7580, Test F1: 0.5624 (Best Epoch: 13)
Current LR: 1.0349094263845438e-05
epoch: 15 idx: 0 First Loss : 2.9631035327911377, Second Loss : 3.14489483833313
epoch: 15 idx: 200 First Loss : 0.9379691978573651, Second Loss : 0.950419393395866
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4791666666666667, precision 0.5475142394541301, recall 0.5458249158249159, F1 0.48042238788824193, AUC 0.7472951739618406
  Second-Tier acc 0.5208333333333334, precision 0.5870571658615137, recall 0.6041414141414142, F1 0.5196078431372549, AUC 0.7981818181818182
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5157603686635945, recall 0.5498971193415638, F1 0.47245322245322247, AUC 0.7276050852439742
  Second-Tier acc 0.5306122448979592, precision 0.5907608695652175, recall 0.6408730158730159, F1 0.5367867867867869, AUC 0.7644951499118166
Test AUC: 0.7645, Test F1: 0.5368 (Best Epoch: 15)
Current LR: 1.0349094263845438e-05
epoch: 16 idx: 0 First Loss : 3.015878915786743, Second Loss : 3.2121009826660156
epoch: 16 idx: 200 First Loss : 0.9319379408125631, Second Loss : 0.9454846564235527
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4652777777777778, precision 0.5498511904761905, recall 0.5369360269360269, F1 0.466903458611213, AUC 0.7502020202020202
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8063131313131313
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.47619047619047616, precision 0.5426618072787428, recall 0.5616549088771311, F1 0.47798742138364786, AUC 0.734708749755046
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.769455467372134
Test AUC: 0.7695, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0349094263845438e-05
epoch: 17 idx: 0 First Loss : 3.0560309886932373, Second Loss : 3.272400140762329
epoch: 17 idx: 200 First Loss : 0.9266606070592407, Second Loss : 0.9412967258721442
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4652777777777778, precision 0.5491071428571429, recall 0.5377777777777778, F1 0.46652993403329573, AUC 0.75337822671156
  Second-Tier acc 0.4583333333333333, precision 0.5483660130718954, recall 0.5641414141414142, F1 0.4536316071355004, AUC 0.8073737373737373
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46938775510204084, precision 0.552985866711357, recall 0.5651822457378013, F1 0.47250280583613913, AUC 0.738842347638644
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7715498236331569
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0349094263845438e-05
epoch: 18 idx: 0 First Loss : 3.086798906326294, Second Loss : 3.3205041885375977
epoch: 18 idx: 200 First Loss : 0.9223362560504446, Second Loss : 0.937726461120061
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4513888888888889, precision 0.5473858913531208, recall 0.5458585858585859, F1 0.45198061693399966, AUC 0.7558024691358026
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.806969696969697
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5693987823439879, recall 0.5728248089359201, F1 0.4737246563333519, AUC 0.7389464530668235
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7745811287477954
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0349094263845438e-05
epoch: 19 idx: 0 First Loss : 3.109285593032837, Second Loss : 3.3627781867980957
epoch: 19 idx: 200 First Loss : 0.9177874157492497, Second Loss : 0.9345421179067992
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5432692307692307, recall 0.543939393939394, F1 0.4423617165552649, AUC 0.7571436588103255
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8073737373737373
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46938775510204084, precision 0.5838744588744589, recall 0.5706937095825985, F1 0.4715264746675369, AUC 0.740508034489516
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7765101410934744
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 17){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.35712188463945743, "droprate_2": 0.0, "lr": 1.7465821482635835e-05, "weight_decay": 1.194865022276015e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.7465821482635835e-05
epoch: 0 idx: 0 First Loss : 1.2309540510177612, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0866476665088787, Second Loss : 1.067893104766732
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6913019079685747
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495454545454546
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6319566921418773
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6348655202821869
Test AUC: 0.6349, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.7465821482635835e-05
epoch: 1 idx: 0 First Loss : 2.074861764907837, Second Loss : 2.0454819202423096
epoch: 1 idx: 200 First Loss : 1.106063155318374, Second Loss : 1.09262897326282
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7244444444444444
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.762979797979798
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6826192925729963
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6963183421516755
Test AUC: 0.6963, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.7465821482635835e-05
epoch: 2 idx: 0 First Loss : 2.1455485820770264, Second Loss : 2.137407064437866
epoch: 2 idx: 200 First Loss : 1.0847083769775743, Second Loss : 1.0714198046210985
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7367789001122335
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7646464646464647
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7041017538702724
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705136684303351
Test AUC: 0.7051, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7465821482635835e-05
epoch: 3 idx: 0 First Loss : 2.2572288513183594, Second Loss : 2.2396788597106934
epoch: 3 idx: 200 First Loss : 1.0664234310388565, Second Loss : 1.0539768625106385
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399719416386082
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530303030303029
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.711603468547913
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.707120811287478
Test AUC: 0.7051, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7465821482635835e-05
epoch: 4 idx: 0 First Loss : 2.369173526763916, Second Loss : 2.3569488525390625
epoch: 4 idx: 200 First Loss : 1.0432433441133049, Second Loss : 1.0317937418892609
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5694444444444444, precision 0.5763475529100529, recall 0.41198653198653207, F1 0.38232986681262543, AUC 0.7358193041526375
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7527272727272728
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6054421768707483, precision 0.7896728845633955, recall 0.4384920634920635, F1 0.40462443940148224, AUC 0.7034526259063297
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7091600529100529
Test AUC: 0.7051, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7465821482635835e-05
epoch: 5 idx: 0 First Loss : 2.538494348526001, Second Loss : 2.51705265045166
epoch: 5 idx: 200 First Loss : 1.0179380370461526, Second Loss : 1.0081260050114114
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6527777777777778, precision 0.6122379400411437, recall 0.5587205387205386, F1 0.5693974370100379, AUC 0.7311447811447812
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7530808080808079
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5374149659863946, precision 0.4499601275917065, recall 0.4946355085243974, F1 0.4506206146732628, AUC 0.7003478346070938
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7081128747795414
Test AUC: 0.7051, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7465821482635835e-05
epoch: 6 idx: 0 First Loss : 2.7192471027374268, Second Loss : 2.715120315551758
epoch: 6 idx: 200 First Loss : 0.9919389921856757, Second Loss : 0.9856900060688382
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5416666666666666, precision 0.5088452531075481, recall 0.5001346801346801, F1 0.46637793755730345, AUC 0.7288215488215487
  Second-Tier acc 0.5833333333333334, precision 0.5395382395382397, recall 0.554949494949495, F1 0.5066263659614043, AUC 0.7532323232323233
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5102040816326531, precision 0.4766949152542373, recall 0.5189594356261024, F1 0.45617705933451674, AUC 0.7026136586321771
  Second-Tier acc 0.6530612244897959, precision 0.6421052631578948, recall 0.685626102292769, F1 0.6511927788523533, AUC 0.7264109347442681
Test AUC: 0.7051, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.7465821482635835e-05
epoch: 7 idx: 0 First Loss : 2.9097540378570557, Second Loss : 2.914883852005005
epoch: 7 idx: 200 First Loss : 0.9712557934447011, Second Loss : 0.9678693659121718
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5, precision 0.5368694390346355, recall 0.4983838383838384, F1 0.45109783950345816, AUC 0.7328114478114478
  Second-Tier acc 0.5833333333333334, precision 0.6323232323232323, recall 0.6585858585858585, F1 0.5847362514029181, AUC 0.7758080808080808
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.4698028634198847, recall 0.5251322751322751, F1 0.4253951580632253, AUC 0.7120995002939446
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7461970899470899
Test AUC: 0.7462, Test F1: 0.6002 (Best Epoch: 7)
Current LR: 1.7465821482635835e-05
epoch: 8 idx: 0 First Loss : 3.0743892192840576, Second Loss : 3.0922930240631104
epoch: 8 idx: 200 First Loss : 0.9565019823555181, Second Loss : 0.9554546696703825
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4444444444444444, precision 0.49762426900584794, recall 0.46764309764309764, F1 0.40535409433475067, AUC 0.7357744107744107
  Second-Tier acc 0.5208333333333334, precision 0.5866471734892788, recall 0.5990909090909091, F1 0.522140522875817, AUC 0.7883838383838384
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.4848175089938034, recall 0.5124926513815402, F1 0.40865260514925145, AUC 0.7196073388203018
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7625110229276896
Test AUC: 0.7625, Test F1: 0.4984 (Best Epoch: 8)
Current LR: 1.7465821482635835e-05
epoch: 9 idx: 0 First Loss : 3.217658042907715, Second Loss : 3.235034704208374
epoch: 9 idx: 200 First Loss : 0.946380816752193, Second Loss : 0.9466571174654647
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4305555555555556, precision 0.5009430793478541, recall 0.4635690235690236, F1 0.39266388525458534, AUC 0.7428507295173962
  Second-Tier acc 0.5208333333333334, precision 0.5866471734892788, recall 0.5990909090909091, F1 0.522140522875817, AUC 0.802070707070707
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.41496598639455784, precision 0.4794864185807268, recall 0.5042621987066431, F1 0.3976350313720329, AUC 0.7269682049774642
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7666997354497355
Test AUC: 0.7667, Test F1: 0.4969 (Best Epoch: 9)
Current LR: 1.7465821482635835e-05
epoch: 10 idx: 0 First Loss : 3.314822196960449, Second Loss : 3.3510665893554688
epoch: 10 idx: 200 First Loss : 0.93937840628257, Second Loss : 0.9408358505496116
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4027777777777778, precision 0.46992907801418443, recall 0.440976430976431, F1 0.36793987621573826, AUC 0.7463131313131314
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.8075252525252526
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.5134453781512606, recall 0.5077895355673133, F1 0.39884113954611305, AUC 0.7321796002351558
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7702821869488536
Test AUC: 0.7703, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.7465821482635835e-05
epoch: 11 idx: 0 First Loss : 3.391535758972168, Second Loss : 3.4424703121185303
epoch: 11 idx: 200 First Loss : 0.933933518187546, Second Loss : 0.9362789239845614
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3958333333333333, precision 0.4823232323232323, recall 0.44303030303030305, F1 0.37136563322130334, AUC 0.7510549943883277
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.8107070707070707
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4013605442176871, precision 0.5171652421652421, recall 0.5113168724279835, F1 0.3971022891915387, AUC 0.7382299627669998
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7884149029982362
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 12 idx: 0 First Loss : 3.449345588684082, Second Loss : 3.5112409591674805
epoch: 12 idx: 200 First Loss : 0.9286540913214879, Second Loss : 0.932465646198177
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.5111801056811057, recall 0.4903030303030303, F1 0.40577372027255293, AUC 0.7546408529741863
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8085353535353534
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5381154448055857, recall 0.5430629041740153, F1 0.4280772854121118, AUC 0.7431596609837351
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7881393298059964
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 13 idx: 0 First Loss : 3.4880282878875732, Second Loss : 3.561396598815918
epoch: 13 idx: 200 First Loss : 0.9240458973159837, Second Loss : 0.9289912248322212
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4027777777777778, precision 0.4985569985569986, recall 0.47659932659932663, F1 0.39243946535954083, AUC 0.7577665544332209
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8077272727272727
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.5522540983606558, recall 0.5349794238683128, F1 0.42983230361871133, AUC 0.7447212424064276
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7956900352733686
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 14 idx: 0 First Loss : 3.5127861499786377, Second Loss : 3.5961830615997314
epoch: 14 idx: 200 First Loss : 0.9194180898400792, Second Loss : 0.9255809508315033
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4166666666666667, precision 0.5158292483660131, recall 0.5058249158249158, F1 0.41394927536231885, AUC 0.7577272727272728
  Second-Tier acc 0.4166666666666667, precision 0.5181623931623932, recall 0.5060606060606061, F1 0.41254618673973514, AUC 0.8019191919191919
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5601010101010101, recall 0.5407848324514991, F1 0.4361967009025833, AUC 0.751971879286694
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7922729276895942
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 15 idx: 0 First Loss : 3.5150859355926514, Second Loss : 3.6055307388305664
epoch: 15 idx: 200 First Loss : 0.9146136204151446, Second Loss : 0.9218530261157015
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.5111598868403083, recall 0.49824915824915833, F1 0.4075603864734299, AUC 0.7561447811447811
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.8003535353535355
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4557823129251701, precision 0.5777777777777777, recall 0.5684156378600823, F1 0.45505846880984396, AUC 0.758646874387615
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7963514109347442
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 16 idx: 0 First Loss : 3.5039455890655518, Second Loss : 3.6073436737060547
epoch: 16 idx: 200 First Loss : 0.9105027744636884, Second Loss : 0.9191323299938581
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5276931285334646, recall 0.531077441077441, F1 0.42464305737963026, AUC 0.7534455667789001
  Second-Tier acc 0.3958333333333333, precision 0.48333333333333334, recall 0.48333333333333334, F1 0.3697220036716496, AUC 0.7959090909090909
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46938775510204084, precision 0.5875324675324675, recall 0.5783362727807172, F1 0.46784483126940907, AUC 0.7639501273760532
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7992173721340388
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 17 idx: 0 First Loss : 3.4915695190429688, Second Loss : 3.596987009048462
epoch: 17 idx: 200 First Loss : 0.9070062576642547, Second Loss : 0.9168377978060005
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4097222222222222, precision 0.5103370001746116, recall 0.5137710437710438, F1 0.3995140641061583, AUC 0.7481313131313131
  Second-Tier acc 0.3958333333333333, precision 0.48333333333333334, recall 0.48333333333333334, F1 0.3697220036716496, AUC 0.7902020202020202
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46938775510204084, precision 0.5906680805938493, recall 0.5762051734273957, F1 0.4659907834101382, AUC 0.7653708602782677
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7992173721340389
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 18 idx: 0 First Loss : 3.463418960571289, Second Loss : 3.5714423656463623
epoch: 18 idx: 200 First Loss : 0.9034804625625477, Second Loss : 0.9150021636218009
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4027777777777778, precision 0.5031835205992509, recall 0.5061952861952862, F1 0.38655929441089065, AUC 0.7429124579124579
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7816161616161615
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46258503401360546, precision 0.5867724867724867, recall 0.566137566137566, F1 0.45569567308697745, AUC 0.7653524887321184
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7983906525573192
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.7465821482635835e-05
epoch: 19 idx: 0 First Loss : 3.438068389892578, Second Loss : 3.5379598140716553
epoch: 19 idx: 200 First Loss : 0.900927096467456, Second Loss : 0.913641448124006
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3888888888888889, precision 0.4942548679390784, recall 0.48683501683501684, F1 0.3726726726726726, AUC 0.7331537598204264
  Second-Tier acc 0.375, precision 0.4590277777777778, recall 0.45555555555555555, F1 0.33867557798540543, AUC 0.7713131313131313
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5673052362707535, recall 0.5260141093474426, F1 0.41514296146500396, AUC 0.7665711346266901
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.802524250440917
Test AUC: 0.7884, Test F1: 0.4919 (Best Epoch: 11){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.13065342802547825, "droprate_2": 0.0, "lr": 5.1745505913945706e-05, "weight_decay": 0.00012610614887542567, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 5.1745505913945706e-05
epoch: 0 idx: 0 First Loss : 1.1468757390975952, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1149796974747928, Second Loss : 1.119323075781414
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7605331088664422
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7413131313131314
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6933360278267685
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6634700176366843
Test AUC: 0.6635, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.1745505913945706e-05
epoch: 1 idx: 0 First Loss : 1.9555703401565552, Second Loss : 2.0429673194885254
epoch: 1 idx: 200 First Loss : 1.0411691621909687, Second Loss : 1.0463908777308109
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7484904601571268
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7487878787878787
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7158166764648245
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7063492063492062
Test AUC: 0.7063, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 5.1745505913945706e-05
epoch: 2 idx: 0 First Loss : 2.174318313598633, Second Loss : 2.3768856525421143
epoch: 2 idx: 200 First Loss : 0.9950998983721235, Second Loss : 1.0001696032003977
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6666666666666666, precision 0.42907268170426066, recall 0.585050505050505, F1 0.4943089430894309, AUC 0.7435185185185184
  Second-Tier acc 0.6875, precision 0.4479166666666667, recall 0.6096969696969697, F1 0.5159194282001299, AUC 0.760050505050505
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.5652009456264775, recall 0.42960023515579066, F1 0.4194448278506249, AUC 0.7041017538702724
  Second-Tier acc 0.6530612244897959, precision 0.6719602977667494, recall 0.5925925925925926, F1 0.6193470216458722, AUC 0.7137345679012346
Test AUC: 0.7137, Test F1: 0.6193 (Best Epoch: 2)
Current LR: 5.1745505913945706e-05
epoch: 3 idx: 0 First Loss : 2.6136863231658936, Second Loss : 2.8046634197235107
epoch: 3 idx: 200 First Loss : 0.9566769975408986, Second Loss : 0.9627880284664643
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.5732663562852243, recall 0.5634006734006733, F1 0.5043181818181818, AUC 0.7592424242424243
  Second-Tier acc 0.5208333333333334, precision 0.5464646464646464, recall 0.5243434343434343, F1 0.5030083443126921, AUC 0.7686868686868685
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.5527910685805423, recall 0.5220458553791887, F1 0.5087072116982386, AUC 0.7286216441309034
  Second-Tier acc 0.5714285714285714, precision 0.568882098293863, recall 0.5954585537918872, F1 0.5589883800410115, AUC 0.7417879188712523
Test AUC: 0.7418, Test F1: 0.5590 (Best Epoch: 3)
Current LR: 5.1745505913945706e-05
epoch: 4 idx: 0 First Loss : 3.140855550765991, Second Loss : 3.2778491973876953
epoch: 4 idx: 200 First Loss : 0.9394475661996585, Second Loss : 0.9440347756263777
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5069444444444444, precision 0.5631764069264069, recall 0.5550505050505051, F1 0.49857397504456324, AUC 0.7756116722783389
  Second-Tier acc 0.4791666666666667, precision 0.5474747474747476, recall 0.5171717171717172, F1 0.4642920432394117, AUC 0.780050505050505
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5306122448979592, precision 0.5618977020014826, recall 0.6115520282186949, F1 0.5386067644300083, AUC 0.7534354791299237
  Second-Tier acc 0.5102040816326531, precision 0.5485714285714286, recall 0.5584215167548501, F1 0.5178931276492252, AUC 0.7556768077601411
Test AUC: 0.7557, Test F1: 0.5179 (Best Epoch: 4)
Current LR: 5.1745505913945706e-05
epoch: 5 idx: 0 First Loss : 3.4378135204315186, Second Loss : 3.616809606552124
epoch: 5 idx: 200 First Loss : 0.9298890622712634, Second Loss : 0.9345818204684785
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5, precision 0.5646825396825397, recall 0.5642087542087543, F1 0.4989010989010989, AUC 0.7843827160493827
  Second-Tier acc 0.4375, precision 0.5330779054916985, recall 0.4905050505050505, F1 0.4280748663101604, AUC 0.805959595959596
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5238095238095238, precision 0.5752564102564103, recall 0.6291152263374485, F1 0.5288357582626046, AUC 0.7659526259063297
  Second-Tier acc 0.5306122448979592, precision 0.590347923681257, recall 0.593694885361552, F1 0.5297389816003423, AUC 0.7583223104056437
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 6 idx: 0 First Loss : 3.6172397136688232, Second Loss : 3.7839789390563965
epoch: 6 idx: 200 First Loss : 0.9288004469126463, Second Loss : 0.9333194222634853
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.5282975282975283, recall 0.5093939393939394, F1 0.44009555966411346, AUC 0.7796240179573513
  Second-Tier acc 0.4375, precision 0.5246512746512746, recall 0.4905050505050505, F1 0.42665092792970033, AUC 0.8037373737373738
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5034013605442177, precision 0.5778540611922521, recall 0.59891240446796, F1 0.5030452170888995, AUC 0.7693881050362531
  Second-Tier acc 0.5306122448979592, precision 0.6150793650793651, recall 0.6051587301587301, F1 0.5238095238095238, AUC 0.7664241622574955
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 7 idx: 0 First Loss : 3.7348992824554443, Second Loss : 3.905390977859497
epoch: 7 idx: 200 First Loss : 0.9266494629992663, Second Loss : 0.9322080561122046
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4375, precision 0.5203697673577192, recall 0.5114478114478115, F1 0.4292006826253401, AUC 0.7674747474747475
  Second-Tier acc 0.4375, precision 0.51455938697318, recall 0.4760606060606061, F1 0.4166666666666667, AUC 0.792020202020202
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.48299319727891155, precision 0.5825734549138805, recall 0.5648883009994121, F1 0.47315491743826454, AUC 0.7660995982755242
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7658730158730158
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 8 idx: 0 First Loss : 3.775303602218628, Second Loss : 3.9590961933135986
epoch: 8 idx: 200 First Loss : 0.9237919044217549, Second Loss : 0.9302103146829582
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4236111111111111, precision 0.5138888888888888, recall 0.4881144781144781, F1 0.4088054457619675, AUC 0.7530022446689113
  Second-Tier acc 0.4166666666666667, precision 0.49974457215836526, recall 0.4627272727272727, F1 0.3977718360071301, AUC 0.7579292929292928
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5787811222593832, recall 0.5569517930629041, F1 0.468070818070818, AUC 0.7618680188124634
  Second-Tier acc 0.5102040816326531, precision 0.584045584045584, recall 0.5634920634920635, F1 0.48877274487030586, AUC 0.7741402116402116
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 9 idx: 0 First Loss : 3.7545511722564697, Second Loss : 3.9539434909820557
epoch: 9 idx: 200 First Loss : 0.9179805528096836, Second Loss : 0.9260425237760374
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4236111111111111, precision 0.5126407384543022, recall 0.4937710437710438, F1 0.40748299319727893, AUC 0.7322053872053873
  Second-Tier acc 0.4375, precision 0.5062530062530063, recall 0.493030303030303, F1 0.41475943777734053, AUC 0.7386363636363636
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.47619047619047616, precision 0.5768939393939394, recall 0.5509994121105232, F1 0.4650186682491408, AUC 0.7570852929649226
  Second-Tier acc 0.5102040816326531, precision 0.584045584045584, recall 0.5634920634920635, F1 0.48877274487030586, AUC 0.7805886243386243
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 10 idx: 0 First Loss : 3.7522342205047607, Second Loss : 3.934431791305542
epoch: 10 idx: 200 First Loss : 0.9128223507264305, Second Loss : 0.9227412410847268
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4097222222222222, precision 0.49985257260799054, recall 0.48488215488215486, F1 0.39359062452282795, AUC 0.7229517396184063
  Second-Tier acc 0.3958333333333333, precision 0.46626984126984133, recall 0.4519191919191919, F1 0.36790986790986796, AUC 0.7166666666666667
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.5742521367521367, recall 0.548721340388007, F1 0.453921568627451, AUC 0.7523209386635313
  Second-Tier acc 0.5102040816326531, precision 0.584045584045584, recall 0.5634920634920635, F1 0.48877274487030586, AUC 0.7753527336860669
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 11 idx: 0 First Loss : 3.719977617263794, Second Loss : 3.912771701812744
epoch: 11 idx: 200 First Loss : 0.9091643544773464, Second Loss : 0.9206453297913899
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.4925861401471157, recall 0.48043771043771044, F1 0.38722838310938995, AUC 0.714949494949495
  Second-Tier acc 0.3958333333333333, precision 0.46626984126984133, recall 0.4519191919191919, F1 0.36790986790986796, AUC 0.7018686868686869
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4421768707482993, precision 0.5638888888888889, recall 0.526601998824221, F1 0.43115968427443835, AUC 0.7465767685675093
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7744157848324514
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 12 idx: 0 First Loss : 3.6882381439208984, Second Loss : 3.889463424682617
epoch: 12 idx: 200 First Loss : 0.9072279810873023, Second Loss : 0.9198198449726689
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.4797951495906105, recall 0.4723905723905724, F1 0.3700759869146684, AUC 0.7089057239057239
  Second-Tier acc 0.3958333333333333, precision 0.4672152560083595, recall 0.4519191919191919, F1 0.36605182257356167, AUC 0.7054545454545454
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5661758143685854, recall 0.528586125808348, F1 0.4336038647342995, AUC 0.7398466588281404
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7783289241622575
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 13 idx: 0 First Loss : 3.6522934436798096, Second Loss : 3.871403932571411
epoch: 13 idx: 200 First Loss : 0.9061937547232075, Second Loss : 0.9181925618125645
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.4841269841269842, recall 0.4824915824915825, F1 0.3753331495266979, AUC 0.7060718294051628
  Second-Tier acc 0.4166666666666667, precision 0.48402031063321393, recall 0.4822222222222223, F1 0.3795093795093795, AUC 0.7067676767676767
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.558768406961178, recall 0.5146972369194591, F1 0.4239420289855073, AUC 0.7330491867528904
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7780533509700177
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5)
Current LR: 5.1745505913945706e-05
epoch: 14 idx: 0 First Loss : 3.612111806869507, Second Loss : 3.844167709350586
epoch: 14 idx: 200 First Loss : 0.9048423571066134, Second Loss : 0.9151355780111463
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3888888888888889, precision 0.4768087855297158, recall 0.4732323232323232, F1 0.36574595882495614, AUC 0.7008641975308643
  Second-Tier acc 0.4166666666666667, precision 0.48402031063321393, recall 0.4822222222222223, F1 0.3795093795093795, AUC 0.7021717171717171
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5457671957671958, recall 0.4887566137566137, F1 0.4020954890520108, AUC 0.727935773074662
  Second-Tier acc 0.42857142857142855, precision 0.5222222222222223, recall 0.45546737213403876, F1 0.3857397504456328, AUC 0.7739748677248676
Test AUC: 0.7583, Test F1: 0.5297 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.07272812563503137, "droprate_2": 0.0, "lr": 2.5128556388452757e-05, "weight_decay": 0.0003377055168530544, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.1742792472620598, "droprate_2": 0.0, "lr": 7.165462234729733e-05, "weight_decay": 0.0004341630575265269, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.006541088078117062, "droprate_2": 0.0, "lr": 0.00046640971321296757, "weight_decay": 0.00030227757297378446, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.23708251222570617, "droprate_2": 0.0, "lr": 0.00017980582658646708, "weight_decay": 0.0005313307904893112, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.2097472471801628, "droprate_2": 0.0, "lr": 4.85355564746429e-05, "weight_decay": 3.551498648431906e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0935168266296387, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1163026272360959, Second Loss : 1.1115081047833855
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7448611111111111
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7343434343434344
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6768422067901234
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6773589065255732
epoch: 1 idx: 0 First Loss : 1.9509708881378174, Second Loss : 2.0382442474365234
epoch: 1 idx: 200 First Loss : 1.0422231652102067, Second Loss : 1.0454216831507375
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7439520202020202
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7433333333333332
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7006207286155203
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6983024691358025
epoch: 2 idx: 0 First Loss : 2.1859757900238037, Second Loss : 2.244192123413086
epoch: 2 idx: 200 First Loss : 0.993582125771698, Second Loss : 1.0010756280143462
  First-Tier acc 0.6822916666666666, precision 0.7177887677494287, recall 0.6068181818181818, F1 0.5619113548549203, AUC 0.7398705808080809
  Second-Tier acc 0.6875, precision 0.6212121212121212, recall 0.5876767676767677, F1 0.5713166144200627, AUC 0.748989898989899
  First-Tier acc 0.576530612244898, precision 0.6114780939476061, recall 0.47459215167548496, F1 0.4891458135360574, AUC 0.6837659832451498
  Second-Tier acc 0.5918367346938775, precision 0.5550911412980378, recall 0.5619488536155203, F1 0.5556022408963587, AUC 0.6782407407407406
epoch: 3 idx: 0 First Loss : 2.577646493911743, Second Loss : 2.671010971069336
epoch: 3 idx: 200 First Loss : 0.9557596715676844, Second Loss : 0.9637700312988675
  First-Tier acc 0.5833333333333334, precision 0.559896737111927, recall 0.5795959595959596, F1 0.5464412029108184, AUC 0.7514015151515152
  Second-Tier acc 0.6041666666666666, precision 0.5750445632798574, recall 0.5870707070707071, F1 0.5724602345292, AUC 0.7507575757575758
  First-Tier acc 0.5714285714285714, precision 0.5552438177897174, recall 0.5897266313932981, F1 0.5585039585039585, AUC 0.7019744819223986
  Second-Tier acc 0.5306122448979592, precision 0.5072055137844612, recall 0.5363756613756614, F1 0.502239789196311, AUC 0.7074514991181657
epoch: 4 idx: 0 First Loss : 2.9869236946105957, Second Loss : 3.064851760864258
epoch: 4 idx: 200 First Loss : 0.9364593183779302, Second Loss : 0.9409202553739595
  First-Tier acc 0.5416666666666666, precision 0.5694032272415616, recall 0.5786616161616162, F1 0.5365236297730577, AUC 0.7592897727272727
  Second-Tier acc 0.5416666666666666, precision 0.5757020757020758, recall 0.5835353535353535, F1 0.539136302294197, AUC 0.7780303030303032
  First-Tier acc 0.4897959183673469, precision 0.505253686288169, recall 0.5540674603174603, F1 0.4862075854438161, AUC 0.7163215112433864
  Second-Tier acc 0.5306122448979592, precision 0.5209551656920078, recall 0.5478395061728395, F1 0.5154882154882156, AUC 0.7205687830687831
epoch: 5 idx: 0 First Loss : 3.3467283248901367, Second Loss : 3.3947436809539795
epoch: 5 idx: 200 First Loss : 0.9300551321589161, Second Loss : 0.9283966948533088
  First-Tier acc 0.4895833333333333, precision 0.5534592037534869, recall 0.5544444444444445, F1 0.4895113814098046, AUC 0.7680303030303031
  Second-Tier acc 0.4791666666666667, precision 0.5505050505050505, recall 0.5316161616161617, F1 0.47607655502392343, AUC 0.8038888888888889
  First-Tier acc 0.4897959183673469, precision 0.5293478039956914, recall 0.5683972663139331, F1 0.48814093985274365, AUC 0.7275511188271606
  Second-Tier acc 0.5510204081632653, precision 0.5595238095238095, recall 0.6124338624338624, F1 0.5574750830564784, AUC 0.7320877425044091
epoch: 6 idx: 0 First Loss : 3.4929189682006836, Second Loss : 3.6451189517974854
epoch: 6 idx: 200 First Loss : 0.9267003955365858, Second Loss : 0.9214119993205836
  First-Tier acc 0.453125, precision 0.5284043441938179, recall 0.5147727272727273, F1 0.4543496985357451, AUC 0.7661584595959595
  Second-Tier acc 0.4791666666666667, precision 0.5777777777777778, recall 0.5341414141414141, F1 0.4673635307781649, AUC 0.8114141414141415
  First-Tier acc 0.4642857142857143, precision 0.5241308399203136, recall 0.5500992063492064, F1 0.46303030303030307, AUC 0.7280540399029983
  Second-Tier acc 0.5714285714285714, precision 0.5848484848484848, recall 0.6362433862433862, F1 0.5756613756613757, AUC 0.7308752204585538
epoch: 7 idx: 0 First Loss : 3.612776041030884, Second Loss : 3.8047080039978027
epoch: 7 idx: 200 First Loss : 0.9265832642246205, Second Loss : 0.916606432948243
  First-Tier acc 0.453125, precision 0.5360622250157134, recall 0.5245202020202021, F1 0.45238513763103927, AUC 0.7560353535353536
  Second-Tier acc 0.4791666666666667, precision 0.5630906768837803, recall 0.5341414141414141, F1 0.46507936507936504, AUC 0.8093434343434343
  First-Tier acc 0.45408163265306123, precision 0.5373851294903926, recall 0.5378637566137566, F1 0.4518959435626102, AUC 0.7260595789241622
  Second-Tier acc 0.5102040816326531, precision 0.5341880341880342, recall 0.5698853615520282, F1 0.5087719298245613, AUC 0.738150352733686
epoch: 8 idx: 0 First Loss : 3.597583293914795, Second Loss : 3.8519628047943115
epoch: 8 idx: 200 First Loss : 0.9208812474073907, Second Loss : 0.9122858036156577
  First-Tier acc 0.453125, precision 0.534846547314578, recall 0.5257828282828283, F1 0.45006863769541255, AUC 0.7436458333333335
  Second-Tier acc 0.4583333333333333, precision 0.5308641975308641, recall 0.5208080808080807, F1 0.4434124527003784, AUC 0.7983838383838383
  First-Tier acc 0.4387755102040816, precision 0.5233609385783299, recall 0.5050154320987654, F1 0.4322543480959323, AUC 0.7273788855820106
  Second-Tier acc 0.5102040816326531, precision 0.5355555555555556, recall 0.5520282186948854, F1 0.49230769230769234, AUC 0.7572200176366843
epoch: 9 idx: 0 First Loss : 3.6667966842651367, Second Loss : 3.880129098892212
epoch: 9 idx: 200 First Loss : 0.9181978127592479, Second Loss : 0.9077551709372198
  First-Tier acc 0.453125, precision 0.5336700336700336, recall 0.521540404040404, F1 0.45054689280926513, AUC 0.7298800505050504
  Second-Tier acc 0.4583333333333333, precision 0.527065527065527, recall 0.5208080808080807, F1 0.4437095919448861, AUC 0.7683333333333332
  First-Tier acc 0.46938775510204084, precision 0.552139605842337, recall 0.5407297178130511, F1 0.45966836371765946, AUC 0.7330625826719577
  Second-Tier acc 0.5306122448979592, precision 0.567987567987568, recall 0.5758377425044091, F1 0.5087719298245613, AUC 0.7732032627865961{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.07829945040676949, "droprate_2": 0.0, "lr": 1.033938819282042e-05, "weight_decay": 0.0009638653650175267, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 20, "gamma": 0.8975815803024708, "T_max": 14, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0900700092315674, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0625081192794723, Second Loss : 1.055354616090433
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7078566919191921
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6888383838383838
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6075562169312169
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6116622574955908
epoch: 1 idx: 0 First Loss : 1.7952144145965576, Second Loss : 1.8461437225341797
epoch: 1 idx: 200 First Loss : 1.1003698599872305, Second Loss : 1.095084921266902
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7224431818181819
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.709949494949495
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6453751929012346
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6370149911816578
epoch: 2 idx: 0 First Loss : 1.9693235158920288, Second Loss : 2.006868600845337
epoch: 2 idx: 200 First Loss : 1.0928154914681592, Second Loss : 1.0900024945907925
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7366540404040404
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7272222222222222
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6710138337742504
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.669973544973545
epoch: 3 idx: 0 First Loss : 2.0206685066223145, Second Loss : 2.0573983192443848
epoch: 3 idx: 200 First Loss : 1.0798575959691954, Second Loss : 1.0802705603749005
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7442234848484848
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7431818181818182
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6869695216049383
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6890983245149913
epoch: 4 idx: 0 First Loss : 2.074202299118042, Second Loss : 2.108131170272827
epoch: 4 idx: 200 First Loss : 1.0701076260105293, Second Loss : 1.0728464486142295
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7427020202020201
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7487373737373737
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6981440145502645
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6970899470899471
epoch: 5 idx: 0 First Loss : 2.1357927322387695, Second Loss : 2.164686679840088
epoch: 5 idx: 200 First Loss : 1.0600731443261626, Second Loss : 1.064123346956808
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7420265151515152
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7483838383838384
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7042824074074074
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7038690476190476
epoch: 6 idx: 0 First Loss : 2.189150333404541, Second Loss : 2.2177679538726807
epoch: 6 idx: 200 First Loss : 1.0490344221244996, Second Loss : 1.0539300635975986
  First-Tier acc 0.546875, precision 0.5115864527629234, recall 0.37121212121212116, F1 0.3003152480504397, AUC 0.7413762626262627
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7457070707070707
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7080095348324514
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7110890652557318
epoch: 7 idx: 0 First Loss : 2.2389233112335205, Second Loss : 2.2688705921173096
epoch: 7 idx: 200 First Loss : 1.0377863196294699, Second Loss : 1.0430090821797575
  First-Tier acc 0.5625, precision 0.4784456587735277, recall 0.393939393939394, F1 0.33620019112385274, AUC 0.7416224747474747
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.743989898989899
  First-Tier acc 0.5510204081632653, precision 0.18652849740932642, recall 0.3333333333333333, F1 0.23920265780730898, AUC 0.7108961640211641
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099316578483245
epoch: 8 idx: 0 First Loss : 2.2838380336761475, Second Loss : 2.315460205078125
epoch: 8 idx: 200 First Loss : 1.0264241122339495, Second Loss : 1.0316593533576424
  First-Tier acc 0.578125, precision 0.4531073446327684, recall 0.4209090909090909, F1 0.37386036835342357, AUC 0.7412626262626262
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7409090909090909
  First-Tier acc 0.5510204081632653, precision 0.18848167539267016, recall 0.3333333333333333, F1 0.24080267558528426, AUC 0.7121982473544973
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7118055555555555
epoch: 9 idx: 0 First Loss : 2.324951171875, Second Loss : 2.358466625213623
epoch: 9 idx: 200 First Loss : 1.01464617341312, Second Loss : 1.019844616008042
  First-Tier acc 0.59375, precision 0.4565891472868217, recall 0.44787878787878793, F1 0.40686274509803927, AUC 0.7413699494949494
  Second-Tier acc 0.5833333333333334, precision 0.43939393939393945, recall 0.42424242424242425, F1 0.3748792270531401, AUC 0.7378787878787879
  First-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.712969852292769
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7122464726631393{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.21226946837833194, "droprate_2": 0.0, "lr": 1.0658456181378173e-05, "weight_decay": 0.0009963422811280396, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0913761854171753, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.061491135934099, Second Loss : 1.0555134612825972
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7077493686868687
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6888383838383838
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6077904541446207
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6119929453262786
epoch: 1 idx: 0 First Loss : 1.828409194946289, Second Loss : 1.8566551208496094
epoch: 1 idx: 200 First Loss : 1.1005347323654897, Second Loss : 1.097203578373686
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7232828282828283
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7138383838383838
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6455853174603174
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6394400352733686
epoch: 2 idx: 0 First Loss : 1.994606375694275, Second Loss : 2.0079710483551025
epoch: 2 idx: 200 First Loss : 1.0914229819578911, Second Loss : 1.0912443200747173
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7362784090909091
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7276262626262625
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6715236441798941
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6723434744268078
epoch: 3 idx: 0 First Loss : 2.0423824787139893, Second Loss : 2.056316375732422
epoch: 3 idx: 200 First Loss : 1.0776978879425656, Second Loss : 1.0813708521833467
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445233585858585
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.742979797979798
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6890122078924162
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6881062610229276
epoch: 4 idx: 0 First Loss : 2.1059513092041016, Second Loss : 2.115375518798828
epoch: 4 idx: 200 First Loss : 1.06450987937142, Second Loss : 1.072639208083129
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7416792929292929
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7526262626262626
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7008411871693122
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7045855379188714
epoch: 5 idx: 0 First Loss : 2.1779818534851074, Second Loss : 2.1848957538604736
epoch: 5 idx: 200 First Loss : 1.0519213980406672, Second Loss : 1.0628397078137493
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7417960858585858
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7486868686868687
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7066523368606701
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113646384479718
epoch: 6 idx: 0 First Loss : 2.2566752433776855, Second Loss : 2.266329050064087
epoch: 6 idx: 200 First Loss : 1.0378649823404664, Second Loss : 1.0499676290658575
  First-Tier acc 0.5729166666666666, precision 0.4664088239507234, recall 0.41333333333333333, F1 0.3652141105451802, AUC 0.742761994949495
  Second-Tier acc 0.5625, precision 0.5185185185185185, recall 0.393939393939394, F1 0.3406593406593406, AUC 0.7410101010101009
  First-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7115024250440918
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7122464726631393
epoch: 7 idx: 0 First Loss : 2.3444318771362305, Second Loss : 2.3563103675842285
epoch: 7 idx: 200 First Loss : 1.022629460292076, Second Loss : 1.035185056724655
  First-Tier acc 0.5989583333333334, precision 0.7403643480879253, recall 0.45906565656565657, F1 0.4181793502719056, AUC 0.740429292929293
  Second-Tier acc 0.5833333333333334, precision 0.5840108401084011, recall 0.4361616161616162, F1 0.42099567099567103, AUC 0.7424242424242425
  First-Tier acc 0.5918367346938775, precision 0.5587121212121212, recall 0.3943452380952381, F1 0.3553729786124153, AUC 0.7113026344797179
  Second-Tier acc 0.6530612244897959, precision 0.8712121212121212, recall 0.5238095238095238, F1 0.52018779342723, AUC 0.7160493827160493
epoch: 8 idx: 0 First Loss : 2.439681053161621, Second Loss : 2.4562225341796875
epoch: 8 idx: 200 First Loss : 1.0074361745842653, Second Loss : 1.0200576670653192
  First-Tier acc 0.6510416666666666, precision 0.649537037037037, recall 0.5426767676767678, F1 0.4954444600950836, AUC 0.7412089646464647
  Second-Tier acc 0.6666666666666666, precision 0.6939939939939941, recall 0.5548484848484848, F1 0.5717900063251107, AUC 0.7456565656565656
  First-Tier acc 0.6326530612244898, precision 0.642827657378741, recall 0.48721340388007056, F1 0.5019129019129019, AUC 0.708664021164021
  Second-Tier acc 0.673469387755102, precision 0.7666666666666666, recall 0.5654761904761905, F1 0.5214344941956882, AUC 0.7198522927689593
epoch: 9 idx: 0 First Loss : 2.539543628692627, Second Loss : 2.5619587898254395
epoch: 9 idx: 200 First Loss : 0.9938801912525993, Second Loss : 1.0049570750686068
  First-Tier acc 0.671875, precision 0.6937873357228197, recall 0.5929292929292929, F1 0.5362401440914931, AUC 0.7408712121212121
  Second-Tier acc 0.6666666666666666, precision 0.6055555555555555, recall 0.5523232323232323, F1 0.5587766206961254, AUC 0.751111111111111
  First-Tier acc 0.5918367346938775, precision 0.5331845238095237, recall 0.5071097883597884, F1 0.5128593628593628, AUC 0.7054983741181658
  Second-Tier acc 0.5510204081632653, precision 0.49444444444444446, recall 0.5257936507936508, F1 0.5, AUC 0.7076719576719576{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_12", "train_show_freq": 200, "droprate": 0.29780586654542673, "droprate_2": 0.0, "lr": 1.0308907890812998e-05, "weight_decay": 1.5923102644587416e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "ReduceLROnPlateau", "step_size": 8, "gamma": 0.10262377118211552, "T_max": 7, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_12", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1163463592529297, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0602489508206572, Second Loss : 1.055191804965337
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7030965909090909
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6923232323232323
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6059957837301587
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.61331569664903
epoch: 1 idx: 0 First Loss : 1.8037714958190918, Second Loss : 1.832998514175415
epoch: 1 idx: 200 First Loss : 1.099976021777931, Second Loss : 1.095964736532216
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7192834595959597
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7173232323232323
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6438802083333334
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.640707671957672
epoch: 2 idx: 0 First Loss : 1.993957281112671, Second Loss : 2.0089635848999023
epoch: 2 idx: 200 First Loss : 1.0938191991392059, Second Loss : 1.093426556358883
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7351767676767677
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7301515151515151
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6684441137566138
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6731150793650794
epoch: 3 idx: 0 First Loss : 2.042551040649414, Second Loss : 2.0613298416137695
epoch: 3 idx: 200 First Loss : 1.0801981459209575, Second Loss : 1.0840052745828581
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.742834595959596
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7505050505050505
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.68736221340388
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6882164902998236
epoch: 4 idx: 0 First Loss : 2.091728925704956, Second Loss : 2.119093656539917
epoch: 4 idx: 200 First Loss : 1.0677136809968237, Second Loss : 1.0744439973611737
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7430997474747475
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7531313131313131
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6977513227513228
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6991843033509699
epoch: 5 idx: 0 First Loss : 2.145775556564331, Second Loss : 2.1852784156799316
epoch: 5 idx: 200 First Loss : 1.0550512165127701, Second Loss : 1.064250944747557
  First-Tier acc 0.5520833333333334, precision 0.5125448028673835, recall 0.37878787878787873, F1 0.3131002331002331, AUC 0.7415845959595959
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7505555555555555
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7020192625661377
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7019951499118166
epoch: 6 idx: 0 First Loss : 2.2114498615264893, Second Loss : 2.261565685272217
epoch: 6 idx: 200 First Loss : 1.0238339836472896, Second Loss : 1.0297413313789154
  First-Tier acc 0.5572916666666666, precision 0.5135135135135135, recall 0.3863636363636364, F1 0.32542139662882696, AUC 0.7416003787878788
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7515151515151515
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.7008584104938271
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7019951499118166
epoch: 7 idx: 0 First Loss : 2.226961135864258, Second Loss : 2.2878973484039307
epoch: 7 idx: 200 First Loss : 1.015681393889349, Second Loss : 1.0238118238413512
  First-Tier acc 0.5729166666666666, precision 0.5164835164835165, recall 0.4090909090909091, F1 0.3598634095087996, AUC 0.7410258838383837
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7537373737373737
  First-Tier acc 0.5510204081632653, precision 0.18652849740932642, recall 0.3333333333333333, F1 0.23920265780730898, AUC 0.7001350308641975
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7006723985890653
epoch: 8 idx: 0 First Loss : 2.2439932823181152, Second Loss : 2.3086071014404297
epoch: 8 idx: 200 First Loss : 1.0109748368091251, Second Loss : 1.0200413522213252
  First-Tier acc 0.5677083333333334, precision 0.4611111111111111, recall 0.40575757575757576, F1 0.3547619047619048, AUC 0.7403503787878788
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7525252525252525
  First-Tier acc 0.5510204081632653, precision 0.18848167539267016, recall 0.3333333333333333, F1 0.24080267558528426, AUC 0.7005587246472663
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6997905643738976
epoch: 9 idx: 0 First Loss : 2.2611773014068604, Second Loss : 2.3268768787384033
epoch: 9 idx: 200 First Loss : 1.0079997834281542, Second Loss : 1.0175256444076402
  First-Tier acc 0.5677083333333334, precision 0.4611111111111111, recall 0.40575757575757576, F1 0.3547619047619048, AUC 0.7409185606060605
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7505555555555555
  First-Tier acc 0.5510204081632653, precision 0.18947368421052632, recall 0.3333333333333333, F1 0.24161073825503354, AUC 0.7006345072751324
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.699349647266314