{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_20", "train_show_freq": 200, "droprate": 0.37129621862758816, "droprate_2": 0.0, "lr": 1.4013908554564858e-05, "weight_decay": 1.8235181338158476e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_20", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.4013908554564858e-05
epoch: 0 idx: 0 First Loss : 1.2364730834960938, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0690154316116922, Second Loss : 1.0505656536242263
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6807182940516273
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7460101010101011
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6195865177346659
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.617008377425044
Test AUC: 0.6170, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.4013908554564858e-05
epoch: 1 idx: 0 First Loss : 2.069326162338257, Second Loss : 2.019430637359619
epoch: 1 idx: 200 First Loss : 1.110119846255625, Second Loss : 1.096364737817304
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7195117845117845
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7555050505050506
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6702797374093671
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6733355379188714
Test AUC: 0.6733, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.4013908554564858e-05
epoch: 2 idx: 0 First Loss : 2.1469147205352783, Second Loss : 2.111945867538452
epoch: 2 idx: 200 First Loss : 1.0963364124891177, Second Loss : 1.083254208167394
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7317227833894501
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7627777777777777
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6961040074466
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7044753086419752
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 3 idx: 0 First Loss : 2.2231881618499756, Second Loss : 2.1936869621276855
epoch: 3 idx: 200 First Loss : 1.0807388604280368, Second Loss : 1.0677071339751951
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7406397306397307
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7580303030303029
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075556045463453
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7103725749559082
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 4 idx: 0 First Loss : 2.3176918029785156, Second Loss : 2.282536268234253
epoch: 4 idx: 200 First Loss : 1.064728499941565, Second Loss : 1.0515747359810184
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7383389450056117
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7512626262626263
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7127057613168724
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7136794532627867
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 5 idx: 0 First Loss : 2.424039125442505, Second Loss : 2.387364625930786
epoch: 5 idx: 200 First Loss : 1.0458803184293395, Second Loss : 1.0344045805323183
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5763888888888888, precision 0.4014550264550265, recall 0.4254545454545455, F1 0.3781771415033675, AUC 0.7350112233445567
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7509595959595959
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5986394557823129, precision 0.6415247364152474, recall 0.41865079365079366, F1 0.3878030403758365, AUC 0.7047447579854987
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7109237213403881
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 6 idx: 0 First Loss : 2.548698902130127, Second Loss : 2.5102598667144775
epoch: 6 idx: 200 First Loss : 1.0235766237277297, Second Loss : 1.014981165305892
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6875, precision 0.6639796659404502, recall 0.5956228956228956, F1 0.6035639412997904, AUC 0.7330190796857464
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7548989898989898
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6258503401360545, precision 0.60004400440044, recall 0.5612874779541447, F1 0.568568634240276, AUC 0.6978248089359201
  Second-Tier acc 0.5918367346938775, precision 0.5446998722860792, recall 0.4790564373897707, F1 0.4714285714285715, AUC 0.7036485890652558
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 7 idx: 0 First Loss : 2.6929855346679688, Second Loss : 2.6499545574188232
epoch: 7 idx: 200 First Loss : 1.002131960433514, Second Loss : 0.9956596196439136
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5902777777777778, precision 0.5415763351201112, recall 0.5323232323232323, F1 0.5320202456451405, AUC 0.7298989898989898
  Second-Tier acc 0.625, precision 0.5848861283643892, recall 0.5816161616161616, F1 0.5347222222222222, AUC 0.7494444444444444
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5306122448979592, precision 0.480585053095572, recall 0.5134479717813051, F1 0.4776117468669405, AUC 0.699864050558495
  Second-Tier acc 0.6122448979591837, precision 0.5836940836940837, recall 0.5844356261022927, F1 0.5700680272108843, AUC 0.7226631393298059
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4013908554564858e-05
epoch: 8 idx: 0 First Loss : 2.8428802490234375, Second Loss : 2.8081743717193604
epoch: 8 idx: 200 First Loss : 0.9831593739823322, Second Loss : 0.9788102013109928
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5277777777777778, precision 0.5031080031080032, recall 0.5082154882154882, F1 0.4808025616937464, AUC 0.7281425364758697
  Second-Tier acc 0.5416666666666666, precision 0.5790123456790123, recall 0.5596969696969697, F1 0.5032163742690058, AUC 0.7634848484848485
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.4484218208356139, recall 0.49426807760141095, F1 0.4316709487441195, AUC 0.7047937487752303
  Second-Tier acc 0.6122448979591837, precision 0.6240079365079366, recall 0.6902557319223986, F1 0.625359911406423, AUC 0.736111111111111
Test AUC: 0.7361, Test F1: 0.6254 (Best Epoch: 8)
Current LR: 1.4013908554564858e-05
epoch: 9 idx: 0 First Loss : 2.9884088039398193, Second Loss : 2.9633288383483887
epoch: 9 idx: 200 First Loss : 0.9670259405613242, Second Loss : 0.9649168373321864
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4722222222222222, precision 0.500795680591077, recall 0.49107744107744117, F1 0.43431241158513884, AUC 0.7291245791245791
  Second-Tier acc 0.5416666666666666, precision 0.6055555555555555, recall 0.6174747474747475, F1 0.5413919413919414, AUC 0.7818686868686869
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.43537414965986393, precision 0.46282312668327924, recall 0.5008818342151676, F1 0.41692207175100976, AUC 0.7134038800705467
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7545194003527337
Test AUC: 0.7545, Test F1: 0.5841 (Best Epoch: 9)
Current LR: 1.4013908554564858e-05
epoch: 10 idx: 0 First Loss : 3.1122515201568604, Second Loss : 3.1003780364990234
epoch: 10 idx: 200 First Loss : 0.9549864962678495, Second Loss : 0.9546355238619877
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4583333333333333, precision 0.5015840595497458, recall 0.4878451178451179, F1 0.4279120860259347, AUC 0.7310998877665544
  Second-Tier acc 0.5208333333333334, precision 0.5870571658615137, recall 0.6041414141414142, F1 0.5196078431372549, AUC 0.7943939393939393
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.41496598639455784, precision 0.4609001575475981, recall 0.4983098177542622, F1 0.40123872881604844, AUC 0.7196195865177346
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7665343915343916
Test AUC: 0.7665, Test F1: 0.5455 (Best Epoch: 10)
Current LR: 1.4013908554564858e-05
epoch: 11 idx: 0 First Loss : 3.2260169982910156, Second Loss : 3.220998764038086
epoch: 11 idx: 200 First Loss : 0.94579144806337, Second Loss : 0.9473512519651385
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4236111111111111, precision 0.48625119242773657, recall 0.4608080808080808, F1 0.3975945569484624, AUC 0.7404208754208755
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.80520202020202
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.47234300109600696, recall 0.5062463256907701, F1 0.41042062988797295, AUC 0.7254372427983539
  Second-Tier acc 0.5306122448979592, precision 0.5732103645147123, recall 0.6408730158730159, F1 0.5409734677469231, AUC 0.7688492063492062
Test AUC: 0.7688, Test F1: 0.5410 (Best Epoch: 11)
Current LR: 1.4013908554564858e-05
epoch: 12 idx: 0 First Loss : 3.3180863857269287, Second Loss : 3.3235926628112793
epoch: 12 idx: 200 First Loss : 0.938826017679452, Second Loss : 0.9421356300179341
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4027777777777778, precision 0.48157620536137163, recall 0.4474747474747474, F1 0.37863836395739275, AUC 0.7404882154882154
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8115151515151515
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.500925925925926, recall 0.5138888888888888, F1 0.41527518898208554, AUC 0.7280092592592592
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7755180776014109
Test AUC: 0.7755, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4013908554564858e-05
epoch: 13 idx: 0 First Loss : 3.390883207321167, Second Loss : 3.4064321517944336
epoch: 13 idx: 200 First Loss : 0.9330327856905796, Second Loss : 0.9379043038332121
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4166666666666667, precision 0.5014966740576496, recall 0.47333333333333333, F1 0.4005323388681576, AUC 0.7460157126823793
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8168181818181818
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5396291270918137, recall 0.5412257495590829, F1 0.4353737425124315, AUC 0.7328226043503822
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7770061728395062
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 14 idx: 0 First Loss : 3.449007272720337, Second Loss : 3.4766252040863037
epoch: 14 idx: 200 First Loss : 0.9282544019530106, Second Loss : 0.9344525998319263
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.4971827811584404, recall 0.46902356902356895, F1 0.391409665603214, AUC 0.752087542087542
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.8153030303030304
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5470221280602637, recall 0.5470311581422692, F1 0.4450390961870843, AUC 0.737997256515775
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7884700176366843
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 15 idx: 0 First Loss : 3.501852035522461, Second Loss : 3.52730131149292
epoch: 15 idx: 200 First Loss : 0.9240934747197105, Second Loss : 0.9311681926639667
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.5163530465949822, recall 0.5001683501683502, F1 0.415051953604854, AUC 0.754567901234568
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.8155050505050504
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5714285714285715, recall 0.562610229276896, F1 0.4527310924369748, AUC 0.7423145698608661
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7897927689594356
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 16 idx: 0 First Loss : 3.533480405807495, Second Loss : 3.5659987926483154
epoch: 16 idx: 200 First Loss : 0.919834016124945, Second Loss : 0.9277348896437579
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4166666666666667, precision 0.5199013141532615, recall 0.5083501683501684, F1 0.4153556345516969, AUC 0.7554713804713805
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8102020202020203
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4557823129251701, precision 0.5789563148053715, recall 0.5684156378600823, F1 0.45743490605218157, AUC 0.7452723887909073
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7879739858906526
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 17 idx: 0 First Loss : 3.5515472888946533, Second Loss : 3.5897340774536133
epoch: 17 idx: 200 First Loss : 0.9156487123955004, Second Loss : 0.92460827541014
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4305555555555556, precision 0.5313553679960484, recall 0.5319191919191919, F1 0.42386306846576716, AUC 0.756604938271605
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.8043939393939393
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.576388888888889, recall 0.5523956496178718, F1 0.4480085003035823, AUC 0.7510349304330787
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.787202380952381
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 18 idx: 0 First Loss : 3.5473201274871826, Second Loss : 3.6017844676971436
epoch: 18 idx: 200 First Loss : 0.9116511110665824, Second Loss : 0.9215368370256799
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4166666666666667, precision 0.5196885805064947, recall 0.5190572390572391, F1 0.40598845598845595, AUC 0.7540796857463524
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.7986868686868687
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4421768707482993, precision 0.576114081996435, recall 0.5423280423280423, F1 0.4408045251028114, AUC 0.755646188516559
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7924933862433862
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4013908554564858e-05
epoch: 19 idx: 0 First Loss : 3.5416014194488525, Second Loss : 3.5957322120666504
epoch: 19 idx: 200 First Loss : 0.9075444211699161, Second Loss : 0.9186689692679144
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4027777777777778, precision 0.5066898014266435, recall 0.5061952861952862, F1 0.3870580257677032, AUC 0.7510325476992143
  Second-Tier acc 0.3958333333333333, precision 0.4869664385793418, recall 0.48333333333333334, F1 0.3690865780627352, AUC 0.7935353535353536
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4421768707482993, precision 0.5735955056179775, recall 0.5304232804232805, F1 0.4349843858431644, AUC 0.7602329512051735
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7960758377425045
Test AUC: 0.7770, Test F1: 0.5120 (Best Epoch: 13)