{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_38", "train_show_freq": 200, "droprate": 0.204482527265607, "droprate_2": 0.0, "lr": 2.074125822062895e-05, "weight_decay": 2.9341331193442912e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_38", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.074125822062895e-05
epoch: 0 idx: 0 First Loss : 1.2488166093826294, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0963157741584588, Second Loss : 1.083679139465835
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7004152637485971
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7476262626262627
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6428877621007251
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6441798941798941
Test AUC: 0.6442, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.074125822062895e-05
epoch: 1 idx: 0 First Loss : 2.084970235824585, Second Loss : 2.068814754486084
epoch: 1 idx: 200 First Loss : 1.0957544050851271, Second Loss : 1.0849500236226552
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7289674523007856
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7652020202020203
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6897413286302175
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7040895061728395
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 2 idx: 0 First Loss : 2.1883702278137207, Second Loss : 2.177187204360962
epoch: 2 idx: 200 First Loss : 1.071266921079574, Second Loss : 1.0605065363704862
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7403086419753085
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7572222222222221
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7077638154027044
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7096560846560847
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 3 idx: 0 First Loss : 2.3530943393707275, Second Loss : 2.311296224594116
epoch: 3 idx: 200 First Loss : 1.0481856588403977, Second Loss : 1.0382642256309145
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5486111111111112, precision 0.4591503267973856, recall 0.3793939393939394, F1 0.3192773524527079, AUC 0.7372278338945005
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7497474747474747
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.34722222222222227, F1 0.2645521292217327, AUC 0.7081863609641387
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7125220458553793
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 4 idx: 0 First Loss : 2.533055067062378, Second Loss : 2.481654167175293
epoch: 4 idx: 200 First Loss : 1.0207767675246173, Second Loss : 1.0128779524371991
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6597222222222222, precision 0.6320927723840345, recall 0.5543771043771044, F1 0.5659641717694152, AUC 0.7333894500561167
  Second-Tier acc 0.6875, precision 0.4479166666666667, recall 0.6096969696969697, F1 0.5159194282001299, AUC 0.7514141414141413
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6190476190476191, precision 0.5872277764860886, recall 0.5533509700176368, F1 0.5561562220150958, AUC 0.6957855673133451
  Second-Tier acc 0.6122448979591837, precision 0.5513888888888889, recall 0.4799382716049383, F1 0.47617377751802065, AUC 0.7014440035273367
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 5 idx: 0 First Loss : 2.7618417739868164, Second Loss : 2.6981821060180664
epoch: 5 idx: 200 First Loss : 0.9946547370422539, Second Loss : 0.9885727987620071
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5833333333333334, precision 0.5446531435154708, recall 0.5527946127946128, F1 0.5429776766821837, AUC 0.7284287317620652
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7432323232323231
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5374149659863946, precision 0.4967501097935881, recall 0.5349794238683128, F1 0.49581529581529576, AUC 0.7004151969429747
  Second-Tier acc 0.6326530612244898, precision 0.6145920356446671, recall 0.6439594356261024, F1 0.6203208556149732, AUC 0.7255842151675486
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 6 idx: 0 First Loss : 3.030278205871582, Second Loss : 2.9472458362579346
epoch: 6 idx: 200 First Loss : 0.9726751036015316, Second Loss : 0.9683297861979079
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5069444444444444, precision 0.5157220040940972, recall 0.5093265993265993, F1 0.4680485273981915, AUC 0.7337149270482604
  Second-Tier acc 0.5, precision 0.5544922913343966, recall 0.5373737373737374, F1 0.495159230420632, AUC 0.7633333333333333
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.44747345578547626, recall 0.5071281599059376, F1 0.41590094716421316, AUC 0.7135937193807566
  Second-Tier acc 0.5714285714285714, precision 0.574537037037037, recall 0.642636684303351, F1 0.5711156049882036, AUC 0.7468033509700175
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.074125822062895e-05
epoch: 7 idx: 0 First Loss : 3.26800274848938, Second Loss : 3.148373603820801
epoch: 7 idx: 200 First Loss : 0.9589427622656027, Second Loss : 0.95522611244438
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4444444444444444, precision 0.4843113906529881, recall 0.46764309764309764, F1 0.4049862038273253, AUC 0.7431481481481481
  Second-Tier acc 0.5, precision 0.5685185185185185, recall 0.5662626262626262, F1 0.49589408412937824, AUC 0.785959595959596
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.4652597803282735, recall 0.5024250440917107, F1 0.40664842655035455, AUC 0.7250330687830688
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7650462962962963
Test AUC: 0.7650, Test F1: 0.4712 (Best Epoch: 7)
Current LR: 2.074125822062895e-05
epoch: 8 idx: 0 First Loss : 3.43578839302063, Second Loss : 3.299165964126587
epoch: 8 idx: 200 First Loss : 0.9501643566720521, Second Loss : 0.9467074420414309
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.471998371998372, recall 0.45468013468013463, F1 0.3801004612561178, AUC 0.749915824915825
  Second-Tier acc 0.4791666666666667, precision 0.5555555555555556, recall 0.5529292929292929, F1 0.47474747474747475, AUC 0.791060606060606
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4217687074829932, precision 0.4888267288267288, recall 0.5062463256907701, F1 0.40977021678776065, AUC 0.7333002645502645
  Second-Tier acc 0.4897959183673469, precision 0.5566137566137566, recall 0.5932539682539683, F1 0.494030294030294, AUC 0.765707671957672
Test AUC: 0.7657, Test F1: 0.4940 (Best Epoch: 8)
Current LR: 2.074125822062895e-05
epoch: 9 idx: 0 First Loss : 3.571725606918335, Second Loss : 3.417494058609009
epoch: 9 idx: 200 First Loss : 0.9441748044930807, Second Loss : 0.9413403281107989
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4027777777777778, precision 0.48587377534745957, recall 0.4531313131313131, F1 0.38175790136005033, AUC 0.7569248035914703
  Second-Tier acc 0.5, precision 0.5738491048593349, recall 0.5832323232323232, F1 0.4985569985569986, AUC 0.802020202020202
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5036075036075036, recall 0.5018371546149324, F1 0.40080987128857054, AUC 0.7383463158926121
  Second-Tier acc 0.46938775510204084, precision 0.5777777777777777, recall 0.5809082892416225, F1 0.4701632377088767, AUC 0.7768408289241623
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 10 idx: 0 First Loss : 3.6753900051116943, Second Loss : 3.5090980529785156
epoch: 10 idx: 200 First Loss : 0.9401702973250281, Second Loss : 0.9377295840531588
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.5094054580896686, recall 0.4903030303030303, F1 0.4055470900665325, AUC 0.764983164983165
  Second-Tier acc 0.5, precision 0.5775803144224197, recall 0.6002020202020203, F1 0.4988562091503268, AUC 0.7984343434343435
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.5326519916142558, recall 0.5291740152851264, F1 0.4212837057181962, AUC 0.7443293160885753
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7865410052910052
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 11 idx: 0 First Loss : 3.752363443374634, Second Loss : 3.5761215686798096
epoch: 11 idx: 200 First Loss : 0.9359865869274965, Second Loss : 0.9346374878381838
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4236111111111111, precision 0.5154770154770155, recall 0.506060606060606, F1 0.41483525961704326, AUC 0.7688776655443322
  Second-Tier acc 0.4791666666666667, precision 0.5619047619047619, recall 0.5724242424242424, F1 0.47886119257086995, AUC 0.7963131313131312
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.5572062841530054, recall 0.5429159318048207, F1 0.4376223469787255, AUC 0.7482302077209485
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.791115520282187
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 12 idx: 0 First Loss : 3.7950937747955322, Second Loss : 3.6238901615142822
epoch: 12 idx: 200 First Loss : 0.9319128816210623, Second Loss : 0.931817532039771
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4375, precision 0.5328016778850844, recall 0.5361279461279461, F1 0.43506038647343, AUC 0.7712401795735128
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7955555555555556
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5757268424611224, recall 0.5705467372134039, F1 0.4574322855528021, AUC 0.7538090339016265
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7884149029982362
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 13 idx: 0 First Loss : 3.818971872329712, Second Loss : 3.6430654525756836
epoch: 13 idx: 200 First Loss : 0.9277091413986549, Second Loss : 0.9283815408160271
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4513888888888889, precision 0.543921568627451, recall 0.554040404040404, F1 0.44745876762932757, AUC 0.7710718294051627
  Second-Tier acc 0.3958333333333333, precision 0.49581699346405234, recall 0.47828282828282837, F1 0.38913607712272896, AUC 0.794040404040404
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46938775510204084, precision 0.5864197530864197, recall 0.5864197530864197, F1 0.4719377629594348, AUC 0.7583529296492258
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7935956790123457
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 14 idx: 0 First Loss : 3.8238775730133057, Second Loss : 3.643601894378662
epoch: 14 idx: 200 First Loss : 0.9234100497323111, Second Loss : 0.9247424549548261
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5230027117229871, recall 0.5218181818181818, F1 0.4171190340430595, AUC 0.7672446689113356
  Second-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.7874747474747474
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46938775510204084, precision 0.5856524427952999, recall 0.5745149911816578, F1 0.46970569049537625, AUC 0.7622354497354498
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7978395061728395
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 15 idx: 0 First Loss : 3.8136141300201416, Second Loss : 3.629772901535034
epoch: 15 idx: 200 First Loss : 0.9191637060255164, Second Loss : 0.921570173113732
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.5132575757575758, recall 0.5097979797979798, F1 0.39761594067814165, AUC 0.7605892255892256
  Second-Tier acc 0.3541666666666667, precision 0.45634920634920634, recall 0.4227272727272728, F1 0.3382961124896609, AUC 0.7738383838383838
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5743805270992032, recall 0.5464432686654909, F1 0.4449230886675064, AUC 0.762627376053302
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7981701940035274
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 16 idx: 0 First Loss : 3.7971935272216797, Second Loss : 3.60512375831604
epoch: 16 idx: 200 First Loss : 0.915513089590414, Second Loss : 0.9189820144353296
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3888888888888889, precision 0.4961026243634939, recall 0.48683501683501684, F1 0.37294368340943684, AUC 0.7549046015712682
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7645454545454546
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5690836940836941, recall 0.5282921810699589, F1 0.4264465693037122, AUC 0.7611086615716246
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8043981481481483
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 17 idx: 0 First Loss : 3.777547836303711, Second Loss : 3.579266309738159
epoch: 17 idx: 200 First Loss : 0.9122224066050871, Second Loss : 0.9171343463199648
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3888888888888889, precision 0.49426328502415456, recall 0.482020202020202, F1 0.37168253968253967, AUC 0.7428563411896745
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7445454545454545
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5651946694538803, recall 0.5200617283950617, F1 0.41163694884356844, AUC 0.7554012345679012
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8048390652557318
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 18 idx: 0 First Loss : 3.7535717487335205, Second Loss : 3.5444467067718506
epoch: 18 idx: 200 First Loss : 0.9099442194429092, Second Loss : 0.916258695212179
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4670916421488504, recall 0.45377104377104377, F1 0.34149610284441745, AUC 0.734685746352413
  Second-Tier acc 0.375, precision 0.45555555555555555, recall 0.45555555555555555, F1 0.34194422589387186, AUC 0.7206060606060606
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.563768115942029, recall 0.5141093474426808, F1 0.40827114427860695, AUC 0.750097981579463
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8000440917107584
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)
Current LR: 2.074125822062895e-05
epoch: 19 idx: 0 First Loss : 3.7199831008911133, Second Loss : 3.503840684890747
epoch: 19 idx: 200 First Loss : 0.9077117294417717, Second Loss : 0.9156176860801023
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4621489621489621, recall 0.44367003367003366, F1 0.33608876001771976, AUC 0.7268406285072951
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7021717171717171
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.564929693961952, recall 0.5141093474426808, F1 0.40892857142857136, AUC 0.7470544287673917
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7946979717813051
Test AUC: 0.7768, Test F1: 0.4702 (Best Epoch: 9)