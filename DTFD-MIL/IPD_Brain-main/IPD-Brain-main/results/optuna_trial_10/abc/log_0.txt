{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.2876122504246887, "droprate_2": 0.0, "lr": 5.912068921064181e-05, "weight_decay": 0.0001542568525430406, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 5.912068921064181e-05
epoch: 0 idx: 0 First Loss : 0.9163896441459656, Second Loss : 1.0359247922897339
epoch: 0 idx: 200 First Loss : 1.1265634702361045, Second Loss : 1.1177581880816179
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.506010101010101
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5017171717171717
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4546578758818342
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44940476190476186
 
 test auc: 0.44940476190476186, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.382715154145535, "droprate_2": 0.0, "lr": 0.000498074288810293, "weight_decay": 3.805148323757766e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.000498074288810293
epoch: 0 idx: 0 First Loss : 1.1446559429168701, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.0782872690119554, Second Loss : 1.0831518688086252
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48457070707070704
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4893434343434344
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4417713844797178
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4537037037037037
 
 test auc: 0.4537037037037037, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.000498074288810293
epoch: 1 idx: 0 First Loss : 1.3721184730529785, Second Loss : 1.789294958114624
epoch: 1 idx: 200 First Loss : 0.9748200828311455, Second Loss : 0.978609375322043
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4929545454545454
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4994949494949495
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4671241181657848
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46615961199294526
 
 test auc: 0.46615961199294526, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.000498074288810293
epoch: 2 idx: 0 First Loss : 1.793262243270874, Second Loss : 2.2020180225372314
epoch: 2 idx: 200 First Loss : 0.9498895343337486, Second Loss : 0.9619731533141872
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.20833333333333334, precision 0.13708920187793427, recall 0.24166666666666667, F1 0.14970760233918126, AUC 0.4646212121212121
  Second-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.46782828282828287
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2653061224489796, precision 0.21096096096096098, recall 0.3988095238095238, F1 0.27124183006535946, AUC 0.4778163580246914
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4750881834215168
 
 test auc: 0.46615961199294526, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.000498074288810293
epoch: 3 idx: 0 First Loss : 2.665586471557617, Second Loss : 3.055711269378662
epoch: 3 idx: 200 First Loss : 0.9294078781533597, Second Loss : 0.9483508499552361
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.375, precision 0.18974358974358974, recall 0.2544444444444445, F1 0.21127136752136752, AUC 0.45224747474747473
  Second-Tier acc 0.22916666666666666, precision 0.12475633528265107, recall 0.33080808080808083, F1 0.16780045351473924, AUC 0.48393939393939395
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.20408163265306123, precision 0.28539682539682537, recall 0.37522045855379194, F1 0.16993720565149137, AUC 0.48640046296296297
  Second-Tier acc 0.42857142857142855, precision 0.5721611721611722, recall 0.32297178130511467, F1 0.3309438470728793, AUC 0.48710317460317465
 
 test auc: 0.46615961199294526, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.000498074288810293
epoch: 4 idx: 0 First Loss : 2.8230624198913574, Second Loss : 3.631007432937622
epoch: 4 idx: 200 First Loss : 0.9159081313244776, Second Loss : 0.9421492228052806
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.1583652618135377, recall 0.3611111111111111, F1 0.1749606153275878, AUC 0.4889015151515152
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.4864646464646465
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4387755102040816, precision 0.16475095785440613, recall 0.2654320987654321, F1 0.2033096926713948, AUC 0.44343860229276894
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4938271604938272
 
 test auc: 0.46615961199294526, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.000498074288810293
epoch: 5 idx: 0 First Loss : 2.812880277633667, Second Loss : 3.854504346847534
epoch: 5 idx: 200 First Loss : 0.9048373406296549, Second Loss : 0.9391456763955084
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.49733585858585866
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.559141414141414
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.41005291005291
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4619157848324515
 
 test auc: 0.4619157848324515, test F1: 0.19999999999999998  :  from epoch 5
 current learn rate 0.000498074288810293
epoch: 6 idx: 0 First Loss : 2.7384932041168213, Second Loss : 4.0312676429748535
epoch: 6 idx: 200 First Loss : 0.8995426117502783, Second Loss : 0.9342037905088686
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6102020202020202
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6078282828282829
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4800209435626102
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4855048500881834
 
 test auc: 0.4855048500881834, test F1: 0.19999999999999998  :  from epoch 6
 current learn rate 0.000498074288810293
epoch: 7 idx: 0 First Loss : 2.9513862133026123, Second Loss : 4.293704986572266
epoch: 7 idx: 200 First Loss : 0.8953402358476786, Second Loss : 0.9299197810408382
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6757449494949496
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6437373737373737
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.3934496252204585
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4181547619047619
 
 test auc: 0.4181547619047619, test F1: 0.21296296296296294  :  from epoch 7
 current learn rate 0.000498074288810293
epoch: 8 idx: 0 First Loss : 2.710453510284424, Second Loss : 4.013532638549805
epoch: 8 idx: 200 First Loss : 0.9133898930266339, Second Loss : 0.9466982477375558
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2604166666666667, precision 0.5009578544061303, recall 0.36777777777777776, F1 0.18929513701505066, AUC 0.6657575757575758
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6442929292929293
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.3917961860670194
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.41964285714285715
 
 test auc: 0.41964285714285715, test F1: 0.21296296296296294  :  from epoch 8
 current learn rate 0.000498074288810293
epoch: 9 idx: 0 First Loss : 2.927694082260132, Second Loss : 4.0187578201293945
epoch: 9 idx: 200 First Loss : 0.8893070366036014, Second Loss : 0.9252927025454437
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6622222222222222
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.6586363636363636
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.40757275132275134
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4231701940035273
 
 test auc: 0.4231701940035273, test F1: 0.19999999999999998  :  from epoch 9
 current learn rate 0.000498074288810293
epoch: 10 idx: 0 First Loss : 2.8596081733703613, Second Loss : 3.737119436264038
epoch: 10 idx: 200 First Loss : 0.8797440198805404, Second Loss : 0.9196644463755633
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2604166666666667, precision 0.4926787252368648, recall 0.36777777777777776, F1 0.1892784049646795, AUC 0.6684595959595959
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6535858585858586
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4180031966490299
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4268077601410935
 
 test auc: 0.4231701940035273, test F1: 0.19999999999999998  :  from epoch 9
 current learn rate 0.000498074288810293
epoch: 11 idx: 0 First Loss : 3.0243473052978516, Second Loss : 3.9253222942352295
epoch: 11 idx: 200 First Loss : 0.9103271339983974, Second Loss : 0.9474062216462544
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.25, precision 0.1583652618135377, recall 0.3611111111111111, F1 0.1749606153275878, AUC 0.666679292929293
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6524242424242425
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42051091269841273
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.433641975308642
 
 test auc: 0.4231701940035273, test F1: 0.19999999999999998  :  from epoch 9
 current learn rate 0.000498074288810293
epoch: 12 idx: 0 First Loss : 3.261777877807617, Second Loss : 3.875110149383545
epoch: 12 idx: 200 First Loss : 0.9070007710425531, Second Loss : 0.9470632359730754
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2604166666666667, precision 0.5009578544061303, recall 0.36777777777777776, F1 0.18929513701505066, AUC 0.6673232323232323
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6663131313131313
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42034556878306883
  Second-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.43242945326278664
 
 test auc: 0.43242945326278664, test F1: 0.20657276995305163  :  from epoch 12
 current learn rate 0.000498074288810293
epoch: 13 idx: 0 First Loss : 3.5076191425323486, Second Loss : 3.8894548416137695
epoch: 13 idx: 200 First Loss : 0.8758904023998093, Second Loss : 0.9064575238676954
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6701010101010101
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6567171717171717
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.1606425702811245, recall 0.24691358024691357, F1 0.194647201946472, AUC 0.4167493386243386
  Second-Tier acc 0.40816326530612246, precision 0.4916666666666667, recall 0.2762345679012346, F1 0.26312880044223325, AUC 0.42289462081128754
 
 test auc: 0.43242945326278664, test F1: 0.20657276995305163  :  from epoch 12
 current learn rate 0.000498074288810293
epoch: 14 idx: 0 First Loss : 3.695283889770508, Second Loss : 3.753898859024048
epoch: 14 idx: 200 First Loss : 0.875807201520531, Second Loss : 0.9028205959524106
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.25, precision 0.32309368191721133, recall 0.3526262626262626, F1 0.18406567471988033, AUC 0.6696212121212121
  Second-Tier acc 0.22916666666666666, precision 0.13685636856368563, recall 0.33080808080808083, F1 0.16524216524216526, AUC 0.6654545454545454
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4387755102040816, precision 0.23132530120481928, recall 0.2947530864197531, F1 0.2507954332771851, AUC 0.423804012345679
  Second-Tier acc 0.40816326530612246, precision 0.21388888888888888, recall 0.2762345679012346, F1 0.23667377398720682, AUC 0.42041446208112876
 
 test auc: 0.43242945326278664, test F1: 0.20657276995305163  :  from epoch 12
 current learn rate 0.000498074288810293
epoch: 15 idx: 0 First Loss : 4.108509063720703, Second Loss : 4.111474990844727
epoch: 15 idx: 200 First Loss : 0.8750495800357813, Second Loss : 0.8960048403475901
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3020833333333333, precision 0.43783068783068774, recall 0.37747474747474746, F1 0.25282575213427816, AUC 0.6629166666666666
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6616666666666667
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.40816326530612246, precision 0.23196881091617935, recall 0.3055555555555555, F1 0.26304675716440423, AUC 0.43391754850088177
  Second-Tier acc 0.4489795918367347, precision 0.2619047619047619, recall 0.3302469135802469, F1 0.28789386401326694, AUC 0.42791005291005285
 
 test auc: 0.43242945326278664, test F1: 0.20657276995305163  :  from epoch 12
 current learn rate 0.000498074288810293
epoch: 16 idx: 0 First Loss : 4.590458869934082, Second Loss : 4.415472984313965
epoch: 16 idx: 200 First Loss : 0.8825423379156864, Second Loss : 0.8969120174316747
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.3017857142857143, recall 0.3781818181818182, F1 0.2310049019607843, AUC 0.6656818181818182
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6659090909090909
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.2234920634920635, recall 0.3055555555555555, F1 0.25811858369997903, AUC 0.43559854497354494
  Second-Tier acc 0.46938775510204084, precision 0.2659698025551684, recall 0.34259259259259256, F1 0.29477124183006537, AUC 0.4354607583774251
 
 test auc: 0.43242945326278664, test F1: 0.20657276995305163  :  from epoch 12
 current learn rate 0.000498074288810293
epoch: 17 idx: 0 First Loss : 5.0142107009887695, Second Loss : 4.640626430511475
epoch: 17 idx: 200 First Loss : 0.8995645585581548, Second Loss : 0.9027347699472135
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4375, precision 0.4375, recall 0.45691919191919195, F1 0.3583354629866258, AUC 0.6682070707070707
  Second-Tier acc 0.2916666666666667, precision 0.3688034188034188, recall 0.37080808080808075, F1 0.2416666666666667, AUC 0.6696464646464646
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.22395833333333334, recall 0.3248456790123457, F1 0.2610640301318268, AUC 0.46401014109347444
  Second-Tier acc 0.40816326530612246, precision 0.24074074074074073, recall 0.3348765432098766, F1 0.27989417989417986, AUC 0.44990079365079366
 
 test auc: 0.44990079365079366, test F1: 0.27989417989417986  :  from epoch 17
 current learn rate 0.000498074288810293
epoch: 18 idx: 0 First Loss : 4.759415626525879, Second Loss : 4.344054698944092
epoch: 18 idx: 200 First Loss : 0.8860779494184866, Second Loss : 0.8894108761090979
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.5, precision 0.1702127659574468, recall 0.32, F1 0.2222222222222222, AUC 0.5103914141414142
  Second-Tier acc 0.5, precision 0.1702127659574468, recall 0.32, F1 0.2222222222222222, AUC 0.6278282828282827
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.17346938775510204, precision 0.3888888888888889, recall 0.3395061728395062, F1 0.10735930735930736, AUC 0.6180417768959435
  Second-Tier acc 0.20408163265306123, precision 0.3913043478260869, recall 0.35802469135802467, F1 0.1447424435930183, AUC 0.5094246031746031
 
 test auc: 0.44990079365079366, test F1: 0.27989417989417986  :  from epoch 17
 current learn rate 0.000498074288810293
epoch: 19 idx: 0 First Loss : 4.925119876861572, Second Loss : 4.5467023849487305
epoch: 19 idx: 200 First Loss : 0.9052709386180667, Second Loss : 0.9051143011204332
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.5, precision 0.1702127659574468, recall 0.32, F1 0.2222222222222222, AUC 0.39098484848484844
  Second-Tier acc 0.5, precision 0.1702127659574468, recall 0.32, F1 0.2222222222222222, AUC 0.526969696969697
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.16326530612244897, precision 0.05555555555555555, recall 0.3333333333333333, F1 0.09523809523809523, AUC 0.5610670194003528
  Second-Tier acc 0.1836734693877551, precision 0.3900709219858156, recall 0.345679012345679, F1 0.12077922077922076, AUC 0.4929453262786596
 
 test auc: 0.44990079365079366, test F1: 0.27989417989417986  :  from epoch 17{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.4636857552921486, "droprate_2": 0.0, "lr": 1.4187432902221713e-05, "weight_decay": 3.8427887120981034e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.4187432902221713e-05
epoch: 0 idx: 0 First Loss : 1.2462633848190308, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0706596158037138, Second Loss : 1.050191379749953
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6798092031425366
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7466666666666666
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.617326817558299
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6134810405643739
Test AUC: 0.6135, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.4187432902221713e-05
epoch: 1 idx: 0 First Loss : 2.1275899410247803, Second Loss : 2.0360605716705322
epoch: 1 idx: 200 First Loss : 1.113244984947627, Second Loss : 1.1028418083540836
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7164758698092032
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.756010101010101
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6682894865765237
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6696428571428572
Test AUC: 0.6696, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.4187432902221713e-05
epoch: 2 idx: 0 First Loss : 2.206519842147827, Second Loss : 2.141338586807251
epoch: 2 idx: 200 First Loss : 1.094387447285415, Second Loss : 1.0866605538633924
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7307744107744107
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7621212121212121
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6962754752106605
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7045304232804233
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 3 idx: 0 First Loss : 2.278191328048706, Second Loss : 2.2199602127075195
epoch: 3 idx: 200 First Loss : 1.0765718836615334, Second Loss : 1.0710621485810967
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7403030303030302
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7593434343434343
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7089763374485597
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7067350088183422
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 4 idx: 0 First Loss : 2.354231595993042, Second Loss : 2.3009486198425293
epoch: 4 idx: 200 First Loss : 1.0578363535564337, Second Loss : 1.0546868242212195
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7406228956228956
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.750050505050505
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7149777091906722
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118055555555555
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 5 idx: 0 First Loss : 2.448171377182007, Second Loss : 2.4041130542755127
epoch: 5 idx: 200 First Loss : 1.0376962612369167, Second Loss : 1.0367770123837599
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5763888888888888, precision 0.4108527131782946, recall 0.4254545454545455, F1 0.37745098039215685, AUC 0.737368125701459
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7496969696969696
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5850340136054422, precision 0.6373015873015874, recall 0.3968253968253968, F1 0.3543968014556249, AUC 0.70914780521262
  Second-Tier acc 0.5918367346938775, precision 0.3378787878787879, recall 0.38095238095238093, F1 0.3236965653570546, AUC 0.7100418871252204
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 6 idx: 0 First Loss : 2.5658321380615234, Second Loss : 2.5301353931427
epoch: 6 idx: 200 First Loss : 1.0170639535755068, Second Loss : 1.01736053120141
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6666666666666666, precision 0.637087912087912, recall 0.5655555555555555, F1 0.5288987921098403, AUC 0.7350505050505051
  Second-Tier acc 0.6875, precision 0.4479166666666667, recall 0.6096969696969697, F1 0.5159194282001299, AUC 0.7494949494949493
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6394557823129252, precision 0.658003144654088, recall 0.5635655496766607, F1 0.5884441429217548, AUC 0.7020625122476974
  Second-Tier acc 0.5918367346938775, precision 0.5383064516129031, recall 0.46759259259259256, F1 0.4636015325670498, AUC 0.6987433862433862
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 7 idx: 0 First Loss : 2.702122449874878, Second Loss : 2.674605131149292
epoch: 7 idx: 200 First Loss : 0.9950366464272067, Second Loss : 0.9987396383426379
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.625, precision 0.576061776061776, recall 0.5788552188552188, F1 0.5772646141356629, AUC 0.7323456790123458
  Second-Tier acc 0.625, precision 0.5848861283643892, recall 0.5816161616161616, F1 0.5347222222222222, AUC 0.7431818181818182
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5850340136054422, precision 0.5414601429716511, recall 0.5731187536743092, F1 0.5501721426293936, AUC 0.7082965902410346
  Second-Tier acc 0.6122448979591837, precision 0.5836940836940837, recall 0.5844356261022927, F1 0.5700680272108843, AUC 0.710758377425044
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 8 idx: 0 First Loss : 2.846499443054199, Second Loss : 2.8294875621795654
epoch: 8 idx: 200 First Loss : 0.9746725690731807, Second Loss : 0.9817751762434025
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5486111111111112, precision 0.5311545372866128, recall 0.5353872053872054, F1 0.5180759803921569, AUC 0.7307463524130191
  Second-Tier acc 0.5208333333333334, precision 0.5528846153846154, recall 0.5293939393939394, F1 0.48465538709441147, AUC 0.7527272727272726
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4965986394557823, precision 0.469675731240071, recall 0.5064667842445619, F1 0.4635969938908311, AUC 0.7132324123064864
  Second-Tier acc 0.6530612244897959, precision 0.6565656565656566, recall 0.7149470899470899, F1 0.6639146886824906, AUC 0.7285604056437389
Test AUC: 0.7045, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.4187432902221713e-05
epoch: 9 idx: 0 First Loss : 2.9820327758789062, Second Loss : 2.980541229248047
epoch: 9 idx: 200 First Loss : 0.9576804857070914, Second Loss : 0.9686218212956368
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4861111111111111, precision 0.4959032837081618, recall 0.492020202020202, F1 0.4561227105143826, AUC 0.7323400673400672
  Second-Tier acc 0.5416666666666666, precision 0.603030303030303, recall 0.603030303030303, F1 0.5370370370370371, AUC 0.7654040404040403
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.48518518518518516, recall 0.5249853027630805, F1 0.44804891398667684, AUC 0.7195767195767196
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7435515873015873
Test AUC: 0.7436, Test F1: 0.5841 (Best Epoch: 9)
Current LR: 1.4187432902221713e-05
epoch: 10 idx: 0 First Loss : 3.0903046131134033, Second Loss : 3.105914354324341
epoch: 10 idx: 200 First Loss : 0.9440368885980613, Second Loss : 0.9583547214110989
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4583333333333333, precision 0.5032208396178984, recall 0.48952861952861954, F1 0.4373174299024634, AUC 0.7345847362514029
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.7847474747474749
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.42857142857142855, precision 0.46540301803459694, recall 0.5005878894767783, F1 0.4165054576834653, AUC 0.7236674505193023
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7624007936507935
Test AUC: 0.7624, Test F1: 0.5455 (Best Epoch: 10)
Current LR: 1.4187432902221713e-05
epoch: 11 idx: 0 First Loss : 3.1761276721954346, Second Loss : 3.217517375946045
epoch: 11 idx: 200 First Loss : 0.9333912731514344, Second Loss : 0.9509142878099313
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4444444444444444, precision 0.501638712165028, recall 0.4854545454545455, F1 0.4246751159314943, AUC 0.7368518518518519
  Second-Tier acc 0.5, precision 0.5725644122383252, recall 0.5738383838383839, F1 0.5, AUC 0.7922727272727274
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.4775793650793651, recall 0.5082304526748972, F1 0.4218855218855219, AUC 0.7289829512051734
  Second-Tier acc 0.5306122448979592, precision 0.5732103645147123, recall 0.6408730158730159, F1 0.5409734677469231, AUC 0.7674713403880071
Test AUC: 0.7675, Test F1: 0.5410 (Best Epoch: 11)
Current LR: 1.4187432902221713e-05
epoch: 12 idx: 0 First Loss : 3.2394702434539795, Second Loss : 3.315477132797241
epoch: 12 idx: 200 First Loss : 0.9247446492805484, Second Loss : 0.9451312192423797
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.49780701754385964, recall 0.4637037037037037, F1 0.4033189033189033, AUC 0.7393490460157127
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8068686868686868
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5251807302108012, recall 0.5437977660199883, F1 0.4552553648939191, AUC 0.7339432686654908
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7685736331569665
Test AUC: 0.7686, Test F1: 0.5120 (Best Epoch: 12)
Current LR: 1.4187432902221713e-05
epoch: 13 idx: 0 First Loss : 3.2873947620391846, Second Loss : 3.3992044925689697
epoch: 13 idx: 200 First Loss : 0.9180907784979698, Second Loss : 0.940521093321714
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4375, precision 0.5235547061634018, recall 0.5005050505050505, F1 0.4341224308168033, AUC 0.7437934904601571
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8085858585858586
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5566849816849818, recall 0.5572457378012934, F1 0.46362928348909654, AUC 0.7372807662159514
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7778880070546738
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 14 idx: 0 First Loss : 3.317725896835327, Second Loss : 3.4608314037323
epoch: 14 idx: 200 First Loss : 0.9122444247312621, Second Loss : 0.9367140964859754
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5227272727272728, recall 0.5102693602693603, F1 0.4225521342456826, AUC 0.7484624017957352
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.8025252525252524
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5442374051069703, recall 0.5310111699000588, F1 0.43772893772893773, AUC 0.7398956496178718
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7858796296296298
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 15 idx: 0 First Loss : 3.331739664077759, Second Loss : 3.5019288063049316
epoch: 15 idx: 200 First Loss : 0.9068783620483617, Second Loss : 0.9329184695443519
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4236111111111111, precision 0.5244088482074752, recall 0.5111111111111111, F1 0.42336074214632086, AUC 0.7506734006734007
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.797070707070707
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5838744588744589, recall 0.5706937095825985, F1 0.4715264746675369, AUC 0.7401957182049775
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7901785714285715
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 16 idx: 0 First Loss : 3.3316457271575928, Second Loss : 3.53094482421875
epoch: 16 idx: 200 First Loss : 0.9016630004463597, Second Loss : 0.9293971248411235
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5327515621633269, recall 0.5293939393939394, F1 0.42831731987742216, AUC 0.7540965207631873
  Second-Tier acc 0.3958333333333333, precision 0.5, recall 0.47828282828282837, F1 0.38887840868599216, AUC 0.7952525252525252
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.584915611814346, recall 0.5703997648442093, F1 0.4639691241851458, AUC 0.7455663335292965
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.792989417989418
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 17 idx: 0 First Loss : 3.323512315750122, Second Loss : 3.548067808151245
epoch: 17 idx: 200 First Loss : 0.8967072128362268, Second Loss : 0.9260254665138895
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5299242424242424, recall 0.5283164983164984, F1 0.41515980032726446, AUC 0.7563131313131312
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.7870707070707071
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46258503401360546, precision 0.5930232558139535, recall 0.5720899470899471, F1 0.4622413500678426, AUC 0.7498958945718206
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7965718694885361
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 18 idx: 0 First Loss : 3.306560754776001, Second Loss : 3.554126024246216
epoch: 18 idx: 200 First Loss : 0.8918296876710965, Second Loss : 0.9226920284245126
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4236111111111111, precision 0.5321935946935947, recall 0.5291582491582492, F1 0.41339982745197057, AUC 0.7579180695847363
  Second-Tier acc 0.3541666666666667, precision 0.4581491305629237, recall 0.4227272727272728, F1 0.33752688172043016, AUC 0.7824747474747475
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46258503401360546, precision 0.5922025129342202, recall 0.566137566137566, F1 0.4596736596736597, AUC 0.7533926121889084
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7998236331569665
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.4187432902221713e-05
epoch: 19 idx: 0 First Loss : 3.2866051197052, Second Loss : 3.5539283752441406
epoch: 19 idx: 200 First Loss : 0.8873809080458576, Second Loss : 0.919796930473131
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4097222222222222, precision 0.5188620071684588, recall 0.5106397306397307, F1 0.3960056636112974, AUC 0.7544668911335578
  Second-Tier acc 0.3541666666666667, precision 0.4486111111111111, recall 0.42525252525252527, F1 0.32317170201641315, AUC 0.7833333333333333
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4421768707482993, precision 0.5719105455947561, recall 0.5244708994708994, F1 0.4314231326115876, AUC 0.7587203605722124
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.8041776895943563
Test AUC: 0.7779, Test F1: 0.5120 (Best Epoch: 13){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.3721773972996476, "droprate_2": 0.0, "lr": 1.0603765802074677e-05, "weight_decay": 1.077564658758799e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0603765802074677e-05
epoch: 0 idx: 0 First Loss : 1.2367740869522095, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0558802607047617, Second Loss : 1.0370725191647734
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6658361391694725
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7488888888888888
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6058629727611209
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6071428571428571
Test AUC: 0.6071, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0603765802074677e-05
epoch: 1 idx: 0 First Loss : 1.978331208229065, Second Loss : 1.9215741157531738
epoch: 1 idx: 200 First Loss : 1.1037773648601266, Second Loss : 1.0907710273170945
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7075533108866443
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7582323232323231
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6503833529296492
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6561948853615519
Test AUC: 0.6562, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0603765802074677e-05
epoch: 2 idx: 0 First Loss : 2.1223948001861572, Second Loss : 2.0831916332244873
epoch: 2 idx: 200 First Loss : 1.1013771484592068, Second Loss : 1.0879972068528039
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7244332210998877
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7638383838383839
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.680867871840094
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6920745149911817
Test AUC: 0.6921, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0603765802074677e-05
epoch: 3 idx: 0 First Loss : 2.175283432006836, Second Loss : 2.1432297229766846
epoch: 3 idx: 200 First Loss : 1.0901950185571736, Second Loss : 1.0772589296843875
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7350673400673401
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7688383838383839
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6968204977464237
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7024911816578484
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 4 idx: 0 First Loss : 2.248485803604126, Second Loss : 2.2073826789855957
epoch: 4 idx: 200 First Loss : 1.0801587396889776, Second Loss : 1.0666792219254508
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.741638608305275
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.75989898989899
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7065574172055653
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7093253968253969
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 5 idx: 0 First Loss : 2.323770523071289, Second Loss : 2.278574228286743
epoch: 5 idx: 200 First Loss : 1.0696722716463738, Second Loss : 1.0560203730615216
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7414927048260381
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7524242424242424
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7119953948657652
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7087742504409172
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 6 idx: 0 First Loss : 2.405085802078247, Second Loss : 2.355855703353882
epoch: 6 idx: 200 First Loss : 1.0562927501637545, Second Loss : 1.0438505243232001
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5694444444444444, precision 0.5158150851581508, recall 0.40404040404040403, F1 0.3525157232704402, AUC 0.7362626262626263
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7541919191919191
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7117688124632569
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7154982363315697
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 7 idx: 0 First Loss : 2.49696946144104, Second Loss : 2.440659284591675
epoch: 7 idx: 200 First Loss : 1.0409589416871023, Second Loss : 1.029860005264555
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.3666666666666667, recall 0.43111111111111106, F1 0.37948717948717947, AUC 0.7369753086419754
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7558585858585859
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6326530612244898, precision 0.7230639730639731, recall 0.4761904761904762, F1 0.47069284393228056, AUC 0.7023319615912209
  Second-Tier acc 0.5918367346938775, precision 0.33638211382113825, recall 0.3924162257495591, F1 0.3458110516934046, AUC 0.7135141093474427
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 8 idx: 0 First Loss : 2.599519729614258, Second Loss : 2.5326507091522217
epoch: 8 idx: 200 First Loss : 1.0242597960417543, Second Loss : 1.0147966397972545
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6805555555555556, precision 0.633311556329849, recall 0.5962289562289563, F1 0.5562465770544106, AUC 0.7320426487093155
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7585858585858585
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6462585034013606, precision 0.6402500504133898, recall 0.5850970017636684, F1 0.6023437784328711, AUC 0.6996190966098372
  Second-Tier acc 0.5714285714285714, precision 0.4854497354497354, recall 0.46671075837742504, F1 0.4575757575757576, AUC 0.7081679894179894
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 9 idx: 0 First Loss : 2.7161922454833984, Second Loss : 2.6374459266662598
epoch: 9 idx: 200 First Loss : 1.0074805020173985, Second Loss : 0.9995349110914996
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6180555555555556, precision 0.5657443157443157, recall 0.5712794612794613, F1 0.5637537285607755, AUC 0.7307575757575756
  Second-Tier acc 0.6666666666666666, precision 0.6587301587301587, recall 0.6252525252525253, F1 0.5693310657596372, AUC 0.7548484848484849
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5782312925170068, precision 0.53302034428795, recall 0.5651822457378013, F1 0.5410783055198973, AUC 0.704138496962571
  Second-Tier acc 0.5918367346938775, precision 0.5424242424242425, recall 0.5427689594356261, F1 0.5239548810977382, AUC 0.7240410052910052
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 10 idx: 0 First Loss : 2.835200071334839, Second Loss : 2.755554437637329
epoch: 10 idx: 200 First Loss : 0.9920659265040759, Second Loss : 0.985484324618062
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5833333333333334, precision 0.5680875498622489, recall 0.5858922558922558, F1 0.5648559148876207, AUC 0.7267789001122335
  Second-Tier acc 0.5, precision 0.5036199095022624, recall 0.5016161616161617, F1 0.4469427410603881, AUC 0.7609090909090909
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.54421768707483, precision 0.5158730158730159, recall 0.5543797766019988, F1 0.5170412859334356, AUC 0.7062695963158926
  Second-Tier acc 0.6326530612244898, precision 0.6246170983013088, recall 0.6439594356261024, F1 0.618438679819754, AUC 0.7357253086419752
Test AUC: 0.7025, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0603765802074677e-05
epoch: 11 idx: 0 First Loss : 2.9537994861602783, Second Loss : 2.8766074180603027
epoch: 11 idx: 200 First Loss : 0.9793706170992175, Second Loss : 0.97390224908789
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5208333333333334, precision 0.5276246170983013, recall 0.5289225589225589, F1 0.5037634408602151, AUC 0.7277946127946128
  Second-Tier acc 0.5, precision 0.5598204264870931, recall 0.5474747474747474, F1 0.48183590288853456, AUC 0.7740404040404041
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.4754146522340592, recall 0.5174897119341564, F1 0.45799564420254074, AUC 0.7132752792475016
  Second-Tier acc 0.5918367346938775, precision 0.6126262626262626, recall 0.6779100529100529, F1 0.608994708994709, AUC 0.7530864197530863
Test AUC: 0.7531, Test F1: 0.6090 (Best Epoch: 11)
Current LR: 1.0603765802074677e-05
epoch: 12 idx: 0 First Loss : 3.0631802082061768, Second Loss : 2.989635467529297
epoch: 12 idx: 200 First Loss : 0.9683405177120991, Second Loss : 0.9639247098928364
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4652777777777778, precision 0.5032282962515521, recall 0.49168350168350167, F1 0.45319135628733154, AUC 0.7306509539842874
  Second-Tier acc 0.5208333333333334, precision 0.5871794871794872, recall 0.5896969696969697, F1 0.5166137566137566, AUC 0.788989898989899
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.4891905480140774, recall 0.5225602586713697, F1 0.4488517191026151, AUC 0.7193317656280619
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7616843033509699
Test AUC: 0.7617, Test F1: 0.5624 (Best Epoch: 12)
Current LR: 1.0603765802074677e-05
epoch: 13 idx: 0 First Loss : 3.1656265258789062, Second Loss : 3.094561815261841
epoch: 13 idx: 200 First Loss : 0.9596048373339782, Second Loss : 0.9564941236332282
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4513888888888889, precision 0.5036586056922663, recall 0.4876094276094276, F1 0.441155490212094, AUC 0.7349607182940515
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.8022727272727272
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.4720169974407263, recall 0.5022780717225162, F1 0.4242355857326378, AUC 0.7239552714089751
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7667548500881834
Test AUC: 0.7668, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0603765802074677e-05
epoch: 14 idx: 0 First Loss : 3.2524197101593018, Second Loss : 3.18571138381958
epoch: 14 idx: 200 First Loss : 0.9524254041691473, Second Loss : 0.950674209845674
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4444444444444444, precision 0.5087711453908637, recall 0.48797979797979796, F1 0.43467521600177433, AUC 0.7410044893378226
  Second-Tier acc 0.5208333333333334, precision 0.5870571658615137, recall 0.6041414141414142, F1 0.5196078431372549, AUC 0.8107070707070707
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.49610306546667277, recall 0.5320399764844209, F1 0.44660748256182625, AUC 0.7301464824612972
  Second-Tier acc 0.5306122448979592, precision 0.5732103645147123, recall 0.6408730158730159, F1 0.5409734677469231, AUC 0.7757385361552028
Test AUC: 0.7757, Test F1: 0.5410 (Best Epoch: 14)
Current LR: 1.0603765802074677e-05
epoch: 15 idx: 0 First Loss : 3.327638626098633, Second Loss : 3.2671523094177246
epoch: 15 idx: 200 First Loss : 0.946712296419031, Second Loss : 0.9460847723015134
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.5038095238095238, recall 0.48474747474747476, F1 0.4236324589660991, AUC 0.7447867564534231
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8157575757575758
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4557823129251701, precision 0.5202076381164257, recall 0.5476190476190476, F1 0.4566492450638792, AUC 0.7338452870860278
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7779431216931217
Test AUC: 0.7779, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0603765802074677e-05
epoch: 16 idx: 0 First Loss : 3.389479637145996, Second Loss : 3.334277391433716
epoch: 16 idx: 200 First Loss : 0.9419511269305402, Second Loss : 0.9420028001635303
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4375, precision 0.5251223594551929, recall 0.5013468013468013, F1 0.43568072139500713, AUC 0.7471212121212121
  Second-Tier acc 0.4791666666666667, precision 0.5618580765639588, recall 0.5774747474747475, F1 0.47639573070607555, AUC 0.8196464646464646
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5447403820285176, recall 0.559376837154615, F1 0.4634548266821559, AUC 0.7364540466392319
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7780533509700177
Test AUC: 0.7781, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0603765802074677e-05
epoch: 17 idx: 0 First Loss : 3.439054489135742, Second Loss : 3.3915998935699463
epoch: 17 idx: 200 First Loss : 0.9375888084557222, Second Loss : 0.9384450764529666
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4166666666666667, precision 0.5162721095772217, recall 0.49451178451178457, F1 0.41588067558675146, AUC 0.7521717171717173
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8194949494949495
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4557823129251701, precision 0.5568181818181818, recall 0.5569517930629041, F1 0.45673133450911224, AUC 0.7404284244562023
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7762345679012346
Test AUC: 0.7781, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0603765802074677e-05
epoch: 18 idx: 0 First Loss : 3.476224899291992, Second Loss : 3.437053680419922
epoch: 18 idx: 200 First Loss : 0.93344783852229, Second Loss : 0.9349712460528855
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.5359083795703514, recall 0.5313131313131313, F1 0.43719721139075984, AUC 0.7548540965207632
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8165656565656566
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5680195501624073, recall 0.5668724279835391, F1 0.4713348479054667, AUC 0.7440598667450521
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7838403880070546
Test AUC: 0.7781, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0603765802074677e-05
epoch: 19 idx: 0 First Loss : 3.505293846130371, Second Loss : 3.474144697189331
epoch: 19 idx: 200 First Loss : 0.9295484023145516, Second Loss : 0.9316541775597713
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5432692307692307, recall 0.543939393939394, F1 0.4423617165552649, AUC 0.7566442199775533
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.815
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46258503401360546, precision 0.5804829877008708, recall 0.560626102292769, F1 0.4621685713046713, AUC 0.7442252106603959
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.785273368606702
Test AUC: 0.7781, Test F1: 0.5320 (Best Epoch: 16){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.299390888494488, "droprate_2": 0.0, "lr": 1.069570700594006e-05, "weight_decay": 0.0009685874486384293, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.29872775765911824, "droprate_2": 0.0, "lr": 3.768227944802859e-05, "weight_decay": 0.0005506921804380193, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.768227944802859e-05
epoch: 0 idx: 0 First Loss : 1.1561369895935059, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1160268901444192, Second Loss : 1.1178793858977694
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7519360269360269
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.722020202020202
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6790797080148933
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6440145502645503
Test AUC: 0.6440, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.768227944802859e-05
epoch: 1 idx: 0 First Loss : 1.927154541015625, Second Loss : 2.121366024017334
epoch: 1 idx: 200 First Loss : 1.0683914357749977, Second Loss : 1.0722371128512853
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.750381593714927
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7568181818181818
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7109849598275524
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6949404761904763
Test AUC: 0.6949, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.768227944802859e-05
epoch: 2 idx: 0 First Loss : 2.097231149673462, Second Loss : 2.330105781555176
epoch: 2 idx: 200 First Loss : 1.0250507080139806, Second Loss : 1.0300111887392713
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5763888888888888, precision 0.44216089254257196, recall 0.4254545454545455, F1 0.3811734909244407, AUC 0.7435072951739619
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7472222222222222
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.2470449172576832, recall 0.3412698412698412, F1 0.2571321321321321, AUC 0.7226815108759554
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7173721340388006
Test AUC: 0.6949, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.768227944802859e-05
epoch: 3 idx: 0 First Loss : 2.332279682159424, Second Loss : 2.611828565597534
epoch: 3 idx: 200 First Loss : 0.9859341305509135, Second Loss : 0.9923755185891739
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6666666666666666, precision 0.7571091690941878, recall 0.5898653198653198, F1 0.5049351285684338, AUC 0.7448540965207632
  Second-Tier acc 0.6666666666666666, precision 0.6013584117032392, recall 0.5862626262626262, F1 0.5867564534231201, AUC 0.7541414141414141
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5850340136054422, precision 0.584845288326301, recall 0.5021310993533216, F1 0.5032679738562091, AUC 0.7198645404663923
  Second-Tier acc 0.5510204081632653, precision 0.5044444444444445, recall 0.5372574955908289, F1 0.5128205128205129, AUC 0.7304343033509699
Test AUC: 0.6949, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.768227944802859e-05
epoch: 4 idx: 0 First Loss : 2.663797378540039, Second Loss : 2.9454526901245117
epoch: 4 idx: 200 First Loss : 0.9546388968899475, Second Loss : 0.9636229047764889
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5486111111111112, precision 0.5515468409586056, recall 0.5536700336700338, F1 0.5, AUC 0.7659427609427608
  Second-Tier acc 0.6041666666666666, precision 0.6142857142857143, recall 0.632929292929293, F1 0.5925999121651295, AUC 0.7634343434343434
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.5596634370219277, recall 0.545708406819518, F1 0.5279090441210874, AUC 0.7381564765824025
  Second-Tier acc 0.5306122448979592, precision 0.5254901960784314, recall 0.5656966490299823, F1 0.5150665136639891, AUC 0.7582120811287479
Test AUC: 0.7582, Test F1: 0.5151 (Best Epoch: 4)
Current LR: 3.768227944802859e-05
epoch: 5 idx: 0 First Loss : 2.9701993465423584, Second Loss : 3.2671217918395996
epoch: 5 idx: 200 First Loss : 0.9352605023991261, Second Loss : 0.9455596180679045
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4861111111111111, precision 0.53324534942182, recall 0.5329292929292929, F1 0.46919126357874336, AUC 0.7810101010101009
  Second-Tier acc 0.5416666666666666, precision 0.5916666666666667, recall 0.6073737373737373, F1 0.5352629940865236, AUC 0.7775252525252525
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5102040816326531, precision 0.5464607464607465, recall 0.5698853615520282, F1 0.5099232217876285, AUC 0.7582549480697628
  Second-Tier acc 0.46938775510204084, precision 0.49523809523809526, recall 0.5286596119929453, F1 0.4704218909196765, AUC 0.7608575837742505
Test AUC: 0.7609, Test F1: 0.4704 (Best Epoch: 5)
Current LR: 3.768227944802859e-05
epoch: 6 idx: 0 First Loss : 3.2097866535186768, Second Loss : 3.5054986476898193
epoch: 6 idx: 200 First Loss : 0.9215410380202591, Second Loss : 0.9359291887828218
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4652777777777778, precision 0.5369513527408264, recall 0.5283838383838384, F1 0.45864310912854606, AUC 0.790695847362514
  Second-Tier acc 0.5, precision 0.5795454545454546, recall 0.5857575757575758, F1 0.503030303030303, AUC 0.8005555555555555
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5238095238095238, precision 0.5726931864586392, recall 0.6014844209288653, F1 0.5236597625613645, AUC 0.7640787281990985
  Second-Tier acc 0.5306122448979592, precision 0.5847763347763347, recall 0.6115520282186949, F1 0.5326953748006379, AUC 0.7605820105820106
Test AUC: 0.7606, Test F1: 0.5327 (Best Epoch: 6)
Current LR: 3.768227944802859e-05
epoch: 7 idx: 0 First Loss : 3.405231475830078, Second Loss : 3.6835343837738037
epoch: 7 idx: 200 First Loss : 0.9155584245744111, Second Loss : 0.9324599001602969
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4444444444444444, precision 0.5234037456259678, recall 0.5102356902356903, F1 0.4368110927891635, AUC 0.785780022446689
  Second-Tier acc 0.4583333333333333, precision 0.549908424908425, recall 0.5327272727272727, F1 0.45742245742245746, AUC 0.8022727272727272
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5034013605442177, precision 0.5880941213258287, recall 0.587007642563198, F1 0.5001936728304125, AUC 0.7644829022143836
  Second-Tier acc 0.5102040816326531, precision 0.6, recall 0.5992063492063492, F1 0.5115198810850985, AUC 0.7704475308641975
Test AUC: 0.7704, Test F1: 0.5115 (Best Epoch: 7)
Current LR: 3.768227944802859e-05
epoch: 8 idx: 0 First Loss : 3.53497576713562, Second Loss : 3.7949109077453613
epoch: 8 idx: 200 First Loss : 0.9107489760812205, Second Loss : 0.9299398530853811
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.5, recall 0.481986531986532, F1 0.4081304270777955, AUC 0.7755611672278339
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5049494949494949, F1 0.43264221158958005, AUC 0.803131313131313
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.48299319727891155, precision 0.5854148722365776, recall 0.5648883009994121, F1 0.4755514173970672, AUC 0.7639378796786205
  Second-Tier acc 0.4897959183673469, precision 0.5777777777777777, recall 0.5575396825396826, F1 0.4825343738387216, AUC 0.7788249559082893
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 9 idx: 0 First Loss : 3.6145060062408447, Second Loss : 3.844388008117676
epoch: 9 idx: 200 First Loss : 0.9066290200794515, Second Loss : 0.9273137623879744
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.5059682187730968, recall 0.47754208754208755, F1 0.4011410192895956, AUC 0.7625028058361392
  Second-Tier acc 0.4166666666666667, precision 0.5053418803418803, recall 0.47717171717171714, F1 0.4059755449229134, AUC 0.7873737373737374
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.573540280857354, recall 0.5427689594356261, F1 0.4519291587602783, AUC 0.7628845776993926
  Second-Tier acc 0.4897959183673469, precision 0.5777777777777777, recall 0.5575396825396826, F1 0.4825343738387216, AUC 0.7814153439153438
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 10 idx: 0 First Loss : 3.662713050842285, Second Loss : 3.8819477558135986
epoch: 10 idx: 200 First Loss : 0.9022670768870884, Second Loss : 0.9245966498911455
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4027777777777778, precision 0.5014741894406896, recall 0.47875420875420877, F1 0.3927718983980328, AUC 0.7499382716049382
  Second-Tier acc 0.3958333333333333, precision 0.48214285714285715, recall 0.4493939393939394, F1 0.3785936285936286, AUC 0.77
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.5743905855982069, recall 0.5427689594356261, F1 0.45255838454784897, AUC 0.7566137566137566
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7762345679012346
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 11 idx: 0 First Loss : 3.6945269107818604, Second Loss : 3.890195608139038
epoch: 11 idx: 200 First Loss : 0.8991453596448702, Second Loss : 0.9233467532715653
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.4910027707730145, recall 0.46986531986531993, F1 0.3781510633005261, AUC 0.7346689113355781
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.7473737373737374
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4421768707482993, precision 0.5613343840294195, recall 0.52064961787184, F1 0.4275941829840834, AUC 0.7502143347050755
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7727072310405644
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 12 idx: 0 First Loss : 3.70721173286438, Second Loss : 3.8627052307128906
epoch: 12 idx: 200 First Loss : 0.8956579157233525, Second Loss : 0.9208402055036509
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.4814009661835749, recall 0.46060606060606063, F1 0.3702795977431656, AUC 0.7200280583613917
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7203030303030303
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.555298353909465, recall 0.5085978835978836, F1 0.4150242259998358, AUC 0.7444334215167547
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7747464726631393
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 13 idx: 0 First Loss : 3.7305469512939453, Second Loss : 3.858523368835449
epoch: 13 idx: 200 First Loss : 0.8936688729569974, Second Loss : 0.9203136407067091
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.45850198927521196, recall 0.438013468013468, F1 0.3395611431232175, AUC 0.7067789001122335
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.7102020202020203
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.5577574525745257, recall 0.5124191651969429, F1 0.4134359837124814, AUC 0.7390628061924359
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7817460317460317
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8)
Current LR: 3.768227944802859e-05
epoch: 14 idx: 0 First Loss : 3.7356865406036377, Second Loss : 3.840517520904541
epoch: 14 idx: 200 First Loss : 0.8923751916579986, Second Loss : 0.9204304757413908
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.46407385517905614, recall 0.4424579124579125, F1 0.3473341989511933, AUC 0.6997025813692481
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6942929292929293
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5596782563570316, recall 0.5165343915343915, F1 0.4206972037503614, AUC 0.7346842543601803
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7785493827160495
Test AUC: 0.7788, Test F1: 0.4825 (Best Epoch: 8){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.018578527466155133, "droprate_2": 0.0, "lr": 1.740427849797126e-05, "weight_decay": 0.0002738694566833589, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.2904064644276816, "droprate_2": 0.0, "lr": 0.00028342359847557974, "weight_decay": 0.0007563682853346347, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.0998395202302472, "droprate_2": 0.0, "lr": 5.852829710743549e-05, "weight_decay": 0.00022431614095462168, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.19115325099308164, "droprate_2": 0.0, "lr": 0.0002822304539325606, "weight_decay": 3.3275528323775024e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.13054478587752266, "droprate_2": 0.0, "lr": 7.09663936026875e-05, "weight_decay": 1.3875649482723657e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.079109787940979, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.118430055418418, Second Loss : 1.1110176162340155
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495296717171717
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7412626262626262
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6960117669753086
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6900352733686068
epoch: 1 idx: 0 First Loss : 1.9157936573028564, Second Loss : 2.0279605388641357
epoch: 1 idx: 200 First Loss : 1.0200952336711078, Second Loss : 1.0217095351782604
  First-Tier acc 0.5729166666666666, precision 0.4219607843137256, recall 0.41757575757575754, F1 0.3687232985593642, AUC 0.7383648989898991
  Second-Tier acc 0.5416666666666666, precision 0.35271317829457366, recall 0.3806060606060606, F1 0.3241830065359477, AUC 0.7441414141414141
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6925981040564375
  Second-Tier acc 0.5714285714285714, precision 0.524822695035461, recall 0.375, F1 0.3173173173173173, AUC 0.6961529982363315
epoch: 2 idx: 0 First Loss : 2.289006471633911, Second Loss : 2.39023494720459
epoch: 2 idx: 200 First Loss : 0.9673930860648108, Second Loss : 0.970589209032889
  First-Tier acc 0.6197916666666666, precision 0.6064991114496064, recall 0.5782828282828284, F1 0.5329092243699536, AUC 0.7411553030303031
  Second-Tier acc 0.6875, precision 0.6576354679802955, recall 0.6115151515151515, F1 0.6234567901234568, AUC 0.7394444444444445
  First-Tier acc 0.5510204081632653, precision 0.5062193852368925, recall 0.49514991181657847, F1 0.4862250796224526, AUC 0.6919332837301587
  Second-Tier acc 0.5102040816326531, precision 0.4624819624819625, recall 0.5011022927689593, F1 0.46733214497920383, AUC 0.6975859788359787
epoch: 3 idx: 0 First Loss : 2.9023337364196777, Second Loss : 2.948298692703247
epoch: 3 idx: 200 First Loss : 0.9412321220360585, Second Loss : 0.9405301245698585
  First-Tier acc 0.5520833333333334, precision 0.5694582353453531, recall 0.574040404040404, F1 0.5344587430113746, AUC 0.7488983585858585
  Second-Tier acc 0.5416666666666666, precision 0.523989898989899, recall 0.5257575757575758, F1 0.4941743011510453, AUC 0.7636868686868686
  First-Tier acc 0.5612244897959183, precision 0.5667656961774609, recall 0.6039462081128748, F1 0.5599226729087331, AUC 0.7159736000881834
  Second-Tier acc 0.5714285714285714, precision 0.5687830687830687, recall 0.5954585537918872, F1 0.564021164021164, AUC 0.7171516754850088
epoch: 4 idx: 0 First Loss : 3.3422579765319824, Second Loss : 3.465818405151367
epoch: 4 idx: 200 First Loss : 0.9335481070204458, Second Loss : 0.9253595253332189
  First-Tier acc 0.546875, precision 0.5796343402225755, recall 0.590479797979798, F1 0.5430131826741996, AUC 0.7605492424242425
  Second-Tier acc 0.4583333333333333, precision 0.3968253968253968, recall 0.46303030303030307, F1 0.3677298311444653, AUC 0.7892424242424242
  First-Tier acc 0.5, precision 0.5249118165784833, recall 0.5688381834215167, F1 0.4955103183248608, AUC 0.7286017416225748
  Second-Tier acc 0.5306122448979592, precision 0.5783587509077704, recall 0.5235890652557319, F1 0.513417476832111, AUC 0.7275132275132276
epoch: 5 idx: 0 First Loss : 3.599867820739746, Second Loss : 3.8966946601867676
epoch: 5 idx: 200 First Loss : 0.9344834645431656, Second Loss : 0.9199343491345644
  First-Tier acc 0.4479166666666667, precision 0.5132581085445774, recall 0.5014141414141414, F1 0.43510396698844955, AUC 0.7617171717171717
  Second-Tier acc 0.4375, precision 0.49136526555881394, recall 0.4785858585858586, F1 0.3994708994708995, AUC 0.7967676767676769
  First-Tier acc 0.49489795918367346, precision 0.5387984981226532, recall 0.543099647266314, F1 0.4884987069552198, AUC 0.7286844135802468
  Second-Tier acc 0.5306122448979592, precision 0.5370370370370371, recall 0.5529100529100529, F1 0.5183478532171742, AUC 0.7306547619047619
epoch: 6 idx: 0 First Loss : 3.7213351726531982, Second Loss : 3.964613199234009
epoch: 6 idx: 200 First Loss : 0.9318639282090821, Second Loss : 0.9169546238387661
  First-Tier acc 0.4427083333333333, precision 0.5177469135802469, recall 0.4987121212121212, F1 0.4276960784313726, AUC 0.7523106060606061
  Second-Tier acc 0.4375, precision 0.5027649769585253, recall 0.4785858585858586, F1 0.4003341687552213, AUC 0.7985353535353535
  First-Tier acc 0.4846938775510204, precision 0.5523101112723754, recall 0.5426587301587301, F1 0.47527511004401757, AUC 0.7236242008377426
  Second-Tier acc 0.4897959183673469, precision 0.517948717948718, recall 0.5282186948853616, F1 0.48148148148148145, AUC 0.746031746031746
epoch: 7 idx: 0 First Loss : 3.7209854125976562, Second Loss : 4.015410423278809
epoch: 7 idx: 200 First Loss : 0.9266012469932103, Second Loss : 0.9121356037542668
  First-Tier acc 0.4322916666666667, precision 0.5055374001452433, recall 0.49267676767676766, F1 0.4164326749928155, AUC 0.7413383838383837
  Second-Tier acc 0.4375, precision 0.4890166028097063, recall 0.4785858585858586, F1 0.40158730158730155, AUC 0.79
  First-Tier acc 0.4846938775510204, precision 0.5559044162129462, recall 0.5426587301587301, F1 0.47293057019084417, AUC 0.7214299492945327
  Second-Tier acc 0.5306122448979592, precision 0.5723905723905723, recall 0.5758377425044091, F1 0.5109114249037227, AUC 0.7706679894179894
epoch: 8 idx: 0 First Loss : 3.6909658908843994, Second Loss : 4.042994976043701
epoch: 8 idx: 200 First Loss : 0.9247373270631921, Second Loss : 0.9091622793528052
  First-Tier acc 0.4270833333333333, precision 0.5032051282051282, recall 0.4935858585858586, F1 0.41133791133791137, AUC 0.7306376262626263
  Second-Tier acc 0.4583333333333333, precision 0.4976190476190476, recall 0.5088888888888888, F1 0.42006882006882007, AUC 0.7724242424242425
  First-Tier acc 0.45408163265306123, precision 0.5277777777777778, recall 0.490354938271605, F1 0.43131371789908374, AUC 0.7209098048941799
  Second-Tier acc 0.5714285714285714, precision 0.5948717948717949, recall 0.6005291005291005, F1 0.5481481481481482, AUC 0.7875881834215167
epoch: 9 idx: 0 First Loss : 3.654850482940674, Second Loss : 4.0316081047058105
epoch: 9 idx: 200 First Loss : 0.9198049256168028, Second Loss : 0.9029465167353449
  First-Tier acc 0.4166666666666667, precision 0.49239293201557355, recall 0.4881818181818182, F1 0.39692307692307693, AUC 0.7123958333333335
  Second-Tier acc 0.4375, precision 0.4878547378547378, recall 0.4955555555555556, F1 0.4028679476249808, AUC 0.7390404040404039
  First-Tier acc 0.4336734693877551, precision 0.5085963588975413, recall 0.45888447971781304, F1 0.4021645150813322, AUC 0.714681850749559
  Second-Tier acc 0.5510204081632653, precision 0.5615384615384615, recall 0.5588624338624338, F1 0.5111111111111111, AUC 0.7990520282186949{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.10847121575322244, "droprate_2": 0.0, "lr": 0.0009337413106210552, "weight_decay": 7.761047319794865e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 2, "gamma": 0.8923392483579397, "T_max": 20, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0817744731903076, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0962025288733381, Second Loss : 1.087194031484388
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7188604797979798
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7255555555555556
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7250089561287477
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7302138447971781
epoch: 1 idx: 0 First Loss : 1.92953622341156, Second Loss : 2.1132049560546875
epoch: 1 idx: 200 First Loss : 0.9731582363150013, Second Loss : 0.9638353265933136
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7077430555555556
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.708939393939394
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7375062003968255
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7393077601410935
epoch: 2 idx: 0 First Loss : 2.3731698989868164, Second Loss : 2.5275962352752686
epoch: 2 idx: 200 First Loss : 0.9418484726133038, Second Loss : 0.9380366517536676
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6825883838383838
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6769696969696969
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7093012841710759
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113646384479718
epoch: 3 idx: 0 First Loss : 2.315603256225586, Second Loss : 2.4545021057128906
epoch: 3 idx: 200 First Loss : 0.9297358322499404, Second Loss : 0.9177923938305816
  First-Tier acc 0.5677083333333334, precision 0.4831501831501832, recall 0.40151515151515155, F1 0.3475177304964539, AUC 0.6636016414141414
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.6602020202020202
  First-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.6821538800705467
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.70679012345679
epoch: 4 idx: 0 First Loss : 2.3473293781280518, Second Loss : 2.5139269828796387
epoch: 4 idx: 200 First Loss : 0.9171208689610163, Second Loss : 0.9028085986180092
  First-Tier acc 0.4166666666666667, precision 0.35648148148148145, recall 0.44909090909090904, F1 0.3191489361702127, AUC 0.6385037878787879
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6894444444444444
  First-Tier acc 0.4744897959183674, precision 0.40082191780821913, recall 0.4303350970017637, F1 0.34645110080628316, AUC 0.6763771770282186
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7241512345679012
epoch: 5 idx: 0 First Loss : 2.2839434146881104, Second Loss : 2.571686267852783
epoch: 5 idx: 200 First Loss : 0.908037492403047, Second Loss : 0.8809138092198479
  First-Tier acc 0.4791666666666667, precision 0.36306467661691544, recall 0.48060606060606065, F1 0.36532851456849613, AUC 0.6644539141414142
  Second-Tier acc 0.4166666666666667, precision 0.3703703703703704, recall 0.41111111111111115, F1 0.3190690690690691, AUC 0.6762626262626262
  First-Tier acc 0.49489795918367346, precision 0.3942195568882226, recall 0.4398148148148148, F1 0.36115596406243533, AUC 0.6486131779100529
  Second-Tier acc 0.42857142857142855, precision 0.3623737373737374, recall 0.4645061728395062, F1 0.33087540177727365, AUC 0.7131834215167547
epoch: 6 idx: 0 First Loss : 2.438650131225586, Second Loss : 2.4826951026916504
epoch: 6 idx: 200 First Loss : 0.9030819533402054, Second Loss : 0.8807995975091683
  First-Tier acc 0.359375, precision 0.3683127572016461, recall 0.4166666666666667, F1 0.2705999502116007, AUC 0.6463289141414142
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.6276262626262626
  First-Tier acc 0.45408163265306123, precision 0.4209415944925605, recall 0.4294532627865961, F1 0.3280416506635941, AUC 0.6634252369929453
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.6979166666666666
epoch: 7 idx: 0 First Loss : 2.340728282928467, Second Loss : 2.5245747566223145
epoch: 7 idx: 200 First Loss : 0.8993661743287572, Second Loss : 0.8632445765093932
  First-Tier acc 0.3541666666666667, precision 0.36584161906776674, recall 0.41333333333333333, F1 0.26573793206755797, AUC 0.631729797979798
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.665959595959596
  First-Tier acc 0.4336734693877551, precision 0.4150326797385621, recall 0.41710758377425045, F1 0.31067752078218547, AUC 0.6454234182098766
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.6595017636684303
epoch: 8 idx: 0 First Loss : 2.635674476623535, Second Loss : 2.801198720932007
epoch: 8 idx: 200 First Loss : 0.8869954328103667, Second Loss : 0.8492097558907756
  First-Tier acc 0.3177083333333333, precision 0.35561125034809243, recall 0.38999999999999996, F1 0.23009802037286184, AUC 0.598175505050505
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6020707070707071
  First-Tier acc 0.39285714285714285, precision 0.42546151166840823, recall 0.39814814814814814, F1 0.27001114827201783, AUC 0.6519338348765432
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6375110229276896
epoch: 9 idx: 0 First Loss : 2.917266368865967, Second Loss : 3.0342700481414795
epoch: 9 idx: 200 First Loss : 0.8904026875374329, Second Loss : 0.847849196135831
  First-Tier acc 0.3229166666666667, precision 0.35900178253119436, recall 0.3933333333333333, F1 0.23543230682804758, AUC 0.6239078282828283
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6345454545454545
  First-Tier acc 0.4030612244897959, precision 0.4279715762273902, recall 0.404320987654321, F1 0.2799043062200957, AUC 0.6679239693562611
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6290233686067019{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.11150947430133004, "droprate_2": 0.0, "lr": 0.00012129785874395126, "weight_decay": 2.104181753461229e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.085506796836853, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1029237573271367, Second Loss : 1.1001943814665525
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7506029040404041
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7564141414141413
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705195243606702
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7073963844797179
epoch: 1 idx: 0 First Loss : 1.7450220584869385, Second Loss : 1.9074565172195435
epoch: 1 idx: 200 First Loss : 0.9967061138123422, Second Loss : 0.9980101135387942
  First-Tier acc 0.578125, precision 0.41689483825169865, recall 0.4251515151515151, F1 0.37688237688237686, AUC 0.7373926767676767
  Second-Tier acc 0.5625, precision 0.3904761904761904, recall 0.4109090909090909, F1 0.3638059701492537, AUC 0.7520202020202019
  First-Tier acc 0.576530612244898, precision 0.324926439680538, recall 0.3630952380952381, F1 0.2957318591563325, AUC 0.6982921351410935
  Second-Tier acc 0.5918367346938775, precision 0.8581560283687942, recall 0.3988095238095238, F1 0.3617617617617617, AUC 0.7071759259259259
epoch: 2 idx: 0 First Loss : 2.320034980773926, Second Loss : 2.4933207035064697
epoch: 2 idx: 200 First Loss : 0.9525455506657486, Second Loss : 0.9507109342300477
  First-Tier acc 0.5729166666666666, precision 0.5754593001056679, recall 0.5459343434343434, F1 0.47829193207223053, AUC 0.7299558080808081
  Second-Tier acc 0.6666666666666666, precision 0.5952380952380952, recall 0.5887878787878787, F1 0.5745073375262054, AUC 0.7528787878787879
  First-Tier acc 0.5204081632653061, precision 0.4663976293523609, recall 0.4514440035273369, F1 0.4212676146885373, AUC 0.7030698853615519
  Second-Tier acc 0.5918367346938775, precision 0.5874183006535948, recall 0.5963403880070547, F1 0.5895266708834072, AUC 0.7248126102292769
epoch: 3 idx: 0 First Loss : 3.189316749572754, Second Loss : 3.1944003105163574
epoch: 3 idx: 200 First Loss : 0.9376835776724626, Second Loss : 0.9279227446931512
  First-Tier acc 0.4479166666666667, precision 0.5261295822676897, recall 0.47929292929292927, F1 0.3841809688762925, AUC 0.7517392676767676
  Second-Tier acc 0.5416666666666666, precision 0.5545238095238095, recall 0.5427272727272728, F1 0.4995721009841678, AUC 0.7946464646464646
  First-Tier acc 0.49489795918367346, precision 0.5540682414698163, recall 0.4825286596119929, F1 0.44898578904587066, AUC 0.7298073743386243
  Second-Tier acc 0.5510204081632653, precision 0.5441077441077441, recall 0.5716490299823632, F1 0.5397087489966746, AUC 0.7243716931216931
epoch: 4 idx: 0 First Loss : 3.613025426864624, Second Loss : 3.6949644088745117
epoch: 4 idx: 200 First Loss : 0.9308196884992334, Second Loss : 0.9173419783772224
  First-Tier acc 0.4322916666666667, precision 0.49752664638160815, recall 0.4843686868686869, F1 0.3887495717711545, AUC 0.7515530303030303
  Second-Tier acc 0.4375, precision 0.45197132616487457, recall 0.46414141414141413, F1 0.37812602518484867, AUC 0.7937878787878788
  First-Tier acc 0.4897959183673469, precision 0.5300320292839168, recall 0.49696869488536155, F1 0.45138024272149907, AUC 0.7324769896384481
  Second-Tier acc 0.5510204081632653, precision 0.5479776451643459, recall 0.5652557319223986, F1 0.5340126222479165, AUC 0.73070987654321
epoch: 5 idx: 0 First Loss : 3.7985498905181885, Second Loss : 3.9576172828674316
epoch: 5 idx: 200 First Loss : 0.9325951441858353, Second Loss : 0.9169852481251444
  First-Tier acc 0.4166666666666667, precision 0.48757914068918856, recall 0.47734848484848486, F1 0.38482782007873806, AUC 0.7453251262626263
  Second-Tier acc 0.4166666666666667, precision 0.4519795657726693, recall 0.45080808080808077, F1 0.36984126984126986, AUC 0.780959595959596
  First-Tier acc 0.4642857142857143, precision 0.5264104524425626, recall 0.49652777777777773, F1 0.441295609152752, AUC 0.7154569003527337
  Second-Tier acc 0.5306122448979592, precision 0.5292929292929293, recall 0.5529100529100529, F1 0.508994708994709, AUC 0.7457561728395062
epoch: 6 idx: 0 First Loss : 3.7292232513427734, Second Loss : 3.9647653102874756
epoch: 6 idx: 200 First Loss : 0.9297251444013409, Second Loss : 0.9148005548950322
  First-Tier acc 0.40625, precision 0.4772791023842917, recall 0.4706818181818182, F1 0.3773349963175319, AUC 0.7181060606060606
  Second-Tier acc 0.4166666666666667, precision 0.4753086419753086, recall 0.46525252525252525, F1 0.38785689714482285, AUC 0.748888888888889
  First-Tier acc 0.4387755102040816, precision 0.5065598513874376, recall 0.4546406525573192, F1 0.40302144249512667, AUC 0.6891258818342152
  Second-Tier acc 0.5510204081632653, precision 0.5766666666666665, recall 0.5881834215167548, F1 0.5264957264957265, AUC 0.7506613756613757
epoch: 7 idx: 0 First Loss : 3.6206367015838623, Second Loss : 3.9059269428253174
epoch: 7 idx: 200 First Loss : 0.9241630897894316, Second Loss : 0.906766580166967
  First-Tier acc 0.3697916666666667, precision 0.42924344705953904, recall 0.42992424242424243, F1 0.31566373167338685, AUC 0.6851609848484848
  Second-Tier acc 0.3958333333333333, precision 0.4484064785788924, recall 0.45444444444444443, F1 0.35373298199385156, AUC 0.707020202020202
  First-Tier acc 0.42857142857142855, precision 0.48099887188924767, recall 0.4290123456790123, F1 0.3622177755748515, AUC 0.6739004629629629
  Second-Tier acc 0.4897959183673469, precision 0.5337662337662338, recall 0.5218253968253969, F1 0.45790151053308953, AUC 0.7588734567901234
epoch: 8 idx: 0 First Loss : 3.621333360671997, Second Loss : 3.9142696857452393
epoch: 8 idx: 200 First Loss : 0.9267113346227709, Second Loss : 0.9020159294995577
  First-Tier acc 0.3541666666666667, precision 0.4018618856731715, recall 0.4127020202020202, F1 0.2893446263164573, AUC 0.6613667929292929
  Second-Tier acc 0.375, precision 0.4373346560846561, recall 0.44111111111111106, F1 0.3272886674049465, AUC 0.6845959595959595
  First-Tier acc 0.42857142857142855, precision 0.467409729478695, recall 0.4200837742504409, F1 0.34239299954130065, AUC 0.670080329585538
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.7466380070546738
epoch: 9 idx: 0 First Loss : 3.550363063812256, Second Loss : 3.92797589302063
epoch: 9 idx: 200 First Loss : 0.9197233760050633, Second Loss : 0.8950835216624792
  First-Tier acc 0.3645833333333333, precision 0.42002442002442003, recall 0.4272222222222222, F1 0.3011864165956238, AUC 0.6555492424242425
  Second-Tier acc 0.3541666666666667, precision 0.39355742296918766, recall 0.41333333333333333, F1 0.287962962962963, AUC 0.6785353535353535
  First-Tier acc 0.40816326530612246, precision 0.46830566198382284, recall 0.4106040564373898, F1 0.32467556397904657, AUC 0.6715994268077602
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.7290564373897709{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_10", "train_show_freq": 200, "droprate": 0.2971226704548775, "droprate_2": 0.0, "lr": 1.083102619760097e-05, "weight_decay": 1.0612475763578862e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "ReduceLROnPlateau", "step_size": 8, "gamma": 0.13997736027889596, "T_max": 7, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_10", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1163605451583862, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0606025229046, Second Loss : 1.0555128653844197
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.703566919191919
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6903030303030304
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6054618606701939
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6124338624338624
epoch: 1 idx: 0 First Loss : 1.8289775848388672, Second Loss : 1.8560633659362793
epoch: 1 idx: 200 First Loss : 1.0991563925992196, Second Loss : 1.0957531336676423
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7193150252525252
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7154545454545455
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6454475308641975
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6415343915343915
epoch: 2 idx: 0 First Loss : 1.998746633529663, Second Loss : 2.0118908882141113
epoch: 2 idx: 200 First Loss : 1.0915978037154497, Second Loss : 1.091881477640043
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7362026515151515
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7325252525252526
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6711722883597884
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6778549382716049
epoch: 3 idx: 0 First Loss : 2.0497324466705322, Second Loss : 2.0681192874908447
epoch: 3 idx: 200 First Loss : 1.078196175507645, Second Loss : 1.0829376812598006
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7432260101010101
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.749141414141414
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.689339451058201
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6891534391534391
epoch: 4 idx: 0 First Loss : 2.0995640754699707, Second Loss : 2.128459930419922
epoch: 4 idx: 200 First Loss : 1.0649188599776274, Second Loss : 1.072755313112368
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7426578282828283
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7534848484848484
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002039241622574
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7028218694885361
epoch: 5 idx: 0 First Loss : 2.157184362411499, Second Loss : 2.19936466217041
epoch: 5 idx: 200 First Loss : 1.0507578794191132, Second Loss : 1.0617320389667553
  First-Tier acc 0.5677083333333334, precision 0.5154826958105647, recall 0.40151515151515155, F1 0.348778807476054, AUC 0.7415277777777778
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7512626262626262
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.701058201058201
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.69918430335097
epoch: 6 idx: 0 First Loss : 2.2328057289123535, Second Loss : 2.27999210357666
epoch: 6 idx: 200 First Loss : 1.0226737344961854, Second Loss : 1.0304967565693666
  First-Tier acc 0.5625, precision 0.43890560091677405, recall 0.4024242424242424, F1 0.3511287178519776, AUC 0.7411742424242425
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7505050505050505
  First-Tier acc 0.5510204081632653, precision 0.18947368421052632, recall 0.3333333333333333, F1 0.24161073825503354, AUC 0.7000110229276896
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6988536155202821
epoch: 7 idx: 0 First Loss : 2.248664617538452, Second Loss : 2.3070695400238037
epoch: 7 idx: 200 First Loss : 1.01059508924164, Second Loss : 1.0211855608284177
  First-Tier acc 0.5729166666666666, precision 0.45122410546139363, recall 0.41757575757575754, F1 0.37145362948459076, AUC 0.740473484848485
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7467676767676767
  First-Tier acc 0.5663265306122449, precision 0.29354838709677417, recall 0.3511904761904762, F1 0.2752009894867038, AUC 0.6995184358465609
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.699294532627866
epoch: 8 idx: 0 First Loss : 2.2712693214416504, Second Loss : 2.3304059505462646
epoch: 8 idx: 200 First Loss : 1.0050910140447948, Second Loss : 1.0164213998993832
  First-Tier acc 0.578125, precision 0.4415686274509804, recall 0.4251515151515151, F1 0.379652260307998, AUC 0.7401736111111111
  Second-Tier acc 0.5625, precision 0.386046511627907, recall 0.4109090909090909, F1 0.3602941176470589, AUC 0.7456565656565658
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6988053902116401
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.6979717813051147
epoch: 9 idx: 0 First Loss : 2.293980121612549, Second Loss : 2.3519177436828613
epoch: 9 idx: 200 First Loss : 1.0019500145123372, Second Loss : 1.0135953996460236
  First-Tier acc 0.5833333333333334, precision 0.4344386979008214, recall 0.4327272727272727, F1 0.38746438746438744, AUC 0.7395833333333334
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7451010101010102
  First-Tier acc 0.576530612244898, precision 0.3100061387354205, recall 0.3630952380952381, F1 0.29608330490439755, AUC 0.6978959986772487
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.6987433862433864