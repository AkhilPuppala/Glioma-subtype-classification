{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.28898700490722334, "droprate_2": 0.0, "lr": 2.300759788670895e-05, "weight_decay": 7.10281143400125e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.300759788670895e-05
epoch: 0 idx: 0 First Loss : 1.0473973751068115, Second Loss : 1.0700716972351074
epoch: 0 idx: 200 First Loss : 1.086521867495864, Second Loss : 1.0929174263827244
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5258459595959596
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48045454545454547
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43478560405643735
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43832671957671954
 
 test auc: 0.43832671957671954, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.28336467400661514, "droprate_2": 0.0, "lr": 0.00020917995130371976, "weight_decay": 2.582270041190633e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00020917995130371976
epoch: 0 idx: 0 First Loss : 1.1215224266052246, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.0766757218843668, Second Loss : 1.0823974272801509
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49597222222222226
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.478939393939394
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4474344135802469
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4475859788359788
 
 test auc: 0.4475859788359788, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00020917995130371976
epoch: 1 idx: 0 First Loss : 1.5191497802734375, Second Loss : 1.7616833448410034
epoch: 1 idx: 200 First Loss : 0.9658492724249019, Second Loss : 0.9830283421040767
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.48776515151515154
  Second-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.47838383838383836
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46886022927689597
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46114417989417983
 
 test auc: 0.4475859788359788, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00020917995130371976
epoch: 2 idx: 0 First Loss : 2.123764991760254, Second Loss : 2.4809677600860596
epoch: 2 idx: 200 First Loss : 0.9303389860511716, Second Loss : 0.9433223076943141
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.3333333333333333, precision 0.3820473311998736, recall 0.4204040404040405, F1 0.30267557174661003, AUC 0.49959595959595965
  Second-Tier acc 0.22916666666666666, precision 0.24603174603174602, recall 0.24090909090909088, F1 0.23913043478260873, AUC 0.4751010101010101
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3469387755102041, precision 0.33075906688536544, recall 0.28824955908289246, F1 0.2986225688715564, AUC 0.5022734788359788
  Second-Tier acc 0.3469387755102041, precision 0.38755980861244016, recall 0.43165784832451504, F1 0.3517632465000886, AUC 0.49377204585537915
 
 test auc: 0.4475859788359788, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00020917995130371976
epoch: 3 idx: 0 First Loss : 2.877567768096924, Second Loss : 3.395115852355957
epoch: 3 idx: 200 First Loss : 0.9116687622264176, Second Loss : 0.9315684444238594
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3020833333333333, precision 0.48171589310829815, recall 0.39444444444444443, F1 0.24285761909524287, AUC 0.5268434343434344
  Second-Tier acc 0.25, precision 0.14163614163614163, recall 0.3611111111111111, F1 0.1817543859649123, AUC 0.46702020202020206
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3877551020408163, precision 0.1955128205128205, recall 0.24603174603174602, F1 0.21212121212121213, AUC 0.501942791005291
  Second-Tier acc 0.40816326530612246, precision 0.33362193362193365, recall 0.29916225749559083, F1 0.29673509286412514, AUC 0.5064484126984127
 
 test auc: 0.4475859788359788, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00020917995130371976
epoch: 4 idx: 0 First Loss : 3.219087600708008, Second Loss : 3.839449644088745
epoch: 4 idx: 200 First Loss : 0.9021670882096653, Second Loss : 0.9302981136973706
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3020833333333333, precision 0.49683830171635046, recall 0.39444444444444443, F1 0.24203574203574205, AUC 0.6249368686868687
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.47303030303030297
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3877551020408163, precision 0.20373719107896324, recall 0.24922839506172842, F1 0.2144491663942465, AUC 0.4658289241622575
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.5050705467372134
 
 test auc: 0.4475859788359788, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00020917995130371976
epoch: 5 idx: 0 First Loss : 3.24147629737854, Second Loss : 3.9229063987731934
epoch: 5 idx: 200 First Loss : 0.8968251661677841, Second Loss : 0.9242797785054021
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3229166666666667, precision 0.507201646090535, recall 0.4077777777777778, F1 0.2659328337023789, AUC 0.6710858585858587
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.5858585858585859
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3979591836734694, precision 0.19537037037037033, recall 0.25540123456790126, F1 0.21572139303482585, AUC 0.4459876543209877
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.5024801587301587
 
 test auc: 0.5024801587301587, test F1: 0.1932367149758454  :  from epoch 5
 current learn rate 0.00020917995130371976
epoch: 6 idx: 0 First Loss : 3.214108943939209, Second Loss : 3.9568047523498535
epoch: 6 idx: 200 First Loss : 0.892924681743746, Second Loss : 0.9198386305572456
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3229166666666667, precision 0.5180023228803717, recall 0.4077777777777778, F1 0.2659077387430528, AUC 0.6893055555555557
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6643434343434343
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.40816326530612246, precision 0.20020325203252032, recall 0.26157407407407407, F1 0.21895424836601307, AUC 0.42584325396825395
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.44053130511463845
 
 test auc: 0.44053130511463845, test F1: 0.1932367149758454  :  from epoch 6
 current learn rate 0.00020917995130371976
epoch: 7 idx: 0 First Loss : 3.197875499725342, Second Loss : 3.988372564315796
epoch: 7 idx: 200 First Loss : 0.8902891609834829, Second Loss : 0.9158746020538867
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6745959595959596
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6591414141414141
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3979591836734694, precision 0.1566265060240964, recall 0.24074074074074073, F1 0.1897810218978102, AUC 0.42215057319223986
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42791005291005285
 
 test auc: 0.44053130511463845, test F1: 0.1932367149758454  :  from epoch 6
 current learn rate 0.00020917995130371976
epoch: 8 idx: 0 First Loss : 3.047496795654297, Second Loss : 3.9111876487731934
epoch: 8 idx: 200 First Loss : 0.8909183805214764, Second Loss : 0.9166374736593224
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6771590909090909
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.668939393939394
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4212825176366843
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42471340388007056
 
 test auc: 0.42471340388007056, test F1: 0.19999999999999998  :  from epoch 8
 current learn rate 0.00020917995130371976
epoch: 9 idx: 0 First Loss : 2.9235033988952637, Second Loss : 3.869441270828247
epoch: 9 idx: 200 First Loss : 0.8845535430485852, Second Loss : 0.9108859101359313
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.25, precision 0.1583652618135377, recall 0.3611111111111111, F1 0.1749606153275878, AUC 0.6805429292929293
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6764646464646464
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4097084435626102
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.41809964726631393
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 10 idx: 0 First Loss : 2.7124099731445312, Second Loss : 3.7018370628356934
epoch: 10 idx: 200 First Loss : 0.8787583442841713, Second Loss : 0.8997206266028129
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2604166666666667, precision 0.5119047619047619, recall 0.36777777777777776, F1 0.18941598144634197, AUC 0.6789141414141415
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6755555555555555
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.45918367346938777, precision 0.16853932584269662, recall 0.2777777777777778, F1 0.2097902097902098, AUC 0.40940531305114636
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4026675485008819
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 11 idx: 0 First Loss : 2.610441207885742, Second Loss : 3.7603859901428223
epoch: 11 idx: 200 First Loss : 0.8756506130301576, Second Loss : 0.8961288399460224
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2604166666666667, precision 0.5119047619047619, recall 0.36777777777777776, F1 0.18941598144634197, AUC 0.6791035353535353
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6736868686868688
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4387755102040816, precision 0.16475095785440613, recall 0.2654320987654321, F1 0.2033096926713948, AUC 0.412188602292769
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.404376102292769
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 12 idx: 0 First Loss : 2.7103359699249268, Second Loss : 3.94185209274292
epoch: 12 idx: 200 First Loss : 0.8838059683898497, Second Loss : 0.9061502242969512
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.28125, precision 0.5138427464008859, recall 0.3811111111111111, F1 0.2165490708805783, AUC 0.6789141414141415
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6657575757575757
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4387755102040816, precision 0.16475095785440613, recall 0.2654320987654321, F1 0.2033096926713948, AUC 0.4107418430335097
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.4166115520282187
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 13 idx: 0 First Loss : 2.456176519393921, Second Loss : 3.896160364151001
epoch: 13 idx: 200 First Loss : 0.8621163114434538, Second Loss : 0.881485026360018
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.28125, precision 0.42063492063492064, recall 0.3811111111111111, F1 0.21706848357791753, AUC 0.676489898989899
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6566161616161617
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41836734693877553, precision 0.19767960731816156, recall 0.2677469135802469, F1 0.22131386861313865, AUC 0.41672178130511456
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.41920194003527333
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 14 idx: 0 First Loss : 2.603795289993286, Second Loss : 4.0206298828125
epoch: 14 idx: 200 First Loss : 0.8647621406711669, Second Loss : 0.8794969256219313
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2708333333333333, precision 0.5128626163108921, recall 0.3744444444444444, F1 0.2032083532527451, AUC 0.6759974747474748
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6620707070707071
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4117339065255732
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.41644620811287475
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 15 idx: 0 First Loss : 2.5259456634521484, Second Loss : 4.087160587310791
epoch: 15 idx: 200 First Loss : 0.8522396176187038, Second Loss : 0.8694719780424743
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2604166666666667, precision 0.5009578544061303, recall 0.36777777777777776, F1 0.18929513701505066, AUC 0.6705429292929294
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6527777777777778
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.45918367346938777, precision 0.16853932584269662, recall 0.2777777777777778, F1 0.2097902097902098, AUC 0.42496141975308643
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4312720458553792
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 16 idx: 0 First Loss : 2.5286929607391357, Second Loss : 4.144974708557129
epoch: 16 idx: 200 First Loss : 0.8450331048472426, Second Loss : 0.8620172071917734
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2604166666666667, precision 0.5009578544061303, recall 0.36777777777777776, F1 0.18929513701505066, AUC 0.6708964646464647
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6524747474747475
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4300457451499118
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4333664021164021
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 17 idx: 0 First Loss : 2.5064568519592285, Second Loss : 4.21526575088501
epoch: 17 idx: 200 First Loss : 0.8325648275172646, Second Loss : 0.8568956053131096
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.28125, precision 0.5138427464008859, recall 0.3811111111111111, F1 0.2165490708805783, AUC 0.673219696969697
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6524242424242425
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.42474096119929455
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4425154320987654
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 18 idx: 0 First Loss : 2.4241034984588623, Second Loss : 4.223945140838623
epoch: 18 idx: 200 First Loss : 0.8251490054879348, Second Loss : 0.8529248055270531
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2708333333333333, precision 0.40095785440613024, recall 0.3672222222222223, F1 0.19458211770771092, AUC 0.6702651515151515
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6418686868686869
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4301421957671958
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4506723985890652
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.00020917995130371976
epoch: 19 idx: 0 First Loss : 2.5025086402893066, Second Loss : 4.314516067504883
epoch: 19 idx: 200 First Loss : 0.8178856957985633, Second Loss : 0.8436597825577622
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2604166666666667, precision 0.3879525593008739, recall 0.3605555555555556, F1 0.18109888864605847, AUC 0.6748863636363637
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6419191919191919
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.5, precision 0.17562724014336917, recall 0.30246913580246915, F1 0.2222222222222222, AUC 0.4314373897707231
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.45221560846560843
 
 test auc: 0.41809964726631393, test F1: 0.21296296296296294  :  from epoch 9{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.4115033640543319, "droprate_2": 0.0, "lr": 2.52175731924835e-05, "weight_decay": 8.806623802683126e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.52175731924835e-05
epoch: 0 idx: 0 First Loss : 1.2646292448043823, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.112468133666622, Second Loss : 1.0960056635722593
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7082098765432098
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7548989898989898
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6547067901234568
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6521715167548501
Test AUC: 0.6522, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.52175731924835e-05
epoch: 1 idx: 0 First Loss : 2.1690938472747803, Second Loss : 2.100874185562134
epoch: 1 idx: 200 First Loss : 1.0903192303370481, Second Loss : 1.0866154309973788
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7327777777777778
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7637878787878788
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6999069174995101
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7071759259259259
Test AUC: 0.7072, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.52175731924835e-05
epoch: 2 idx: 0 First Loss : 2.2908241748809814, Second Loss : 2.2288553714752197
epoch: 2 idx: 200 First Loss : 1.05945117901362, Second Loss : 1.0571288410110853
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7395061728395061
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7535858585858586
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7125710366451106
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7109788359788359
Test AUC: 0.7072, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.52175731924835e-05
epoch: 3 idx: 0 First Loss : 2.453439474105835, Second Loss : 2.378787040710449
epoch: 3 idx: 200 First Loss : 1.0289599549266237, Second Loss : 1.0280447683079326
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5833333333333334, precision 0.6006919589596755, recall 0.43303030303030304, F1 0.4097552612404097, AUC 0.7354377104377104
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7561616161616161
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6190476190476191, precision 0.8000000000000002, recall 0.4603174603174603, F1 0.43716577540106955, AUC 0.7032015481089555
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7096560846560847
Test AUC: 0.7072, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.52175731924835e-05
epoch: 4 idx: 0 First Loss : 2.661785840988159, Second Loss : 2.5887181758880615
epoch: 4 idx: 200 First Loss : 0.995946170011563, Second Loss : 0.9994202481202819
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5902777777777778, precision 0.5541666666666667, recall 0.5153535353535353, F1 0.5147684880403774, AUC 0.7307182940516274
  Second-Tier acc 0.6666666666666666, precision 0.7587719298245613, recall 0.6108080808080808, F1 0.5376552169004999, AUC 0.7530303030303029
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5238095238095238, precision 0.4563347763347763, recall 0.4978689006466784, F1 0.45926883573942395, AUC 0.7014807466196356
  Second-Tier acc 0.6122448979591837, precision 0.5782163742690059, recall 0.5729717813051146, F1 0.5670995670995671, AUC 0.7067350088183422
Test AUC: 0.7072, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.52175731924835e-05
epoch: 5 idx: 0 First Loss : 2.9192607402801514, Second Loss : 2.862133741378784
epoch: 5 idx: 200 First Loss : 0.9661003415709111, Second Loss : 0.9730763974511505
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5069444444444444, precision 0.5100981323203545, recall 0.48754208754208755, F1 0.4453412609934349, AUC 0.7341975308641976
  Second-Tier acc 0.5625, precision 0.5888888888888889, recall 0.5874747474747475, F1 0.5351851851851852, AUC 0.757020202020202
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.47619047619047616, precision 0.47324414715719065, recall 0.5277042915931806, F1 0.4392741816590813, AUC 0.7116402116402116
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7270171957671957
Test AUC: 0.7072, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.52175731924835e-05
epoch: 6 idx: 0 First Loss : 3.1520535945892334, Second Loss : 3.114034652709961
epoch: 6 idx: 200 First Loss : 0.944046851683093, Second Loss : 0.9556565842132515
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.47578221572029616, recall 0.461986531986532, F1 0.39808604552518445, AUC 0.7389842873176207
  Second-Tier acc 0.5, precision 0.5670454545454545, recall 0.556868686868687, F1 0.4997113997113997, AUC 0.7701515151515151
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.4874960430515986, recall 0.5166078777189888, F1 0.4140786749482402, AUC 0.7236062120321379
  Second-Tier acc 0.5306122448979592, precision 0.5548229548229547, recall 0.6294091710758377, F1 0.5409937888198758, AUC 0.763723544973545
Test AUC: 0.7637, Test F1: 0.5410 (Best Epoch: 6)
Current LR: 2.52175731924835e-05
epoch: 7 idx: 0 First Loss : 3.349963426589966, Second Loss : 3.32194185256958
epoch: 7 idx: 200 First Loss : 0.9310369438014516, Second Loss : 0.9458618086683958
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.4900985539283411, recall 0.4635690235690236, F1 0.39216964265507953, AUC 0.7461335578002245
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7894949494949496
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.4894320382473977, recall 0.5121987066431511, F1 0.4068975808106243, AUC 0.7322775818146189
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7642746913580248
Test AUC: 0.7643, Test F1: 0.5178 (Best Epoch: 7)
Current LR: 2.52175731924835e-05
epoch: 8 idx: 0 First Loss : 3.485896110534668, Second Loss : 3.469608783721924
epoch: 8 idx: 200 First Loss : 0.92244409103484, Second Loss : 0.9397329024238447
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.4629115702196183, recall 0.4413468013468013, F1 0.36002093144950287, AUC 0.7498148148148148
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7973737373737374
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.4958052283633679, recall 0.49191651969429745, F1 0.381243628950051, AUC 0.7418001665686851
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7730379188712523
Test AUC: 0.7730, Test F1: 0.5128 (Best Epoch: 8)
Current LR: 2.52175731924835e-05
epoch: 9 idx: 0 First Loss : 3.5785815715789795, Second Loss : 3.5884909629821777
epoch: 9 idx: 200 First Loss : 0.9156333776121375, Second Loss : 0.9353656112702925
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.47459165154264976, recall 0.4397979797979798, F1 0.3605838455747458, AUC 0.751705948372615
  Second-Tier acc 0.4583333333333333, precision 0.546031746031746, recall 0.5446464646464646, F1 0.4583333333333333, AUC 0.7996464646464646
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.5189417989417989, recall 0.5154320987654321, F1 0.4034376111651503, AUC 0.7500734861845973
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7872574955908288
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 10 idx: 0 First Loss : 3.6497743129730225, Second Loss : 3.6724119186401367
epoch: 10 idx: 200 First Loss : 0.9102397937123752, Second Loss : 0.9324688893715058
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3888888888888889, precision 0.4841269841269842, recall 0.45555555555555555, F1 0.37197132616487455, AUC 0.7543827160493827
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7968686868686868
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.42857142857142855, precision 0.5514370131614289, recall 0.5430629041740153, F1 0.427670904641307, AUC 0.7565586419753086
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7978395061728395
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 11 idx: 0 First Loss : 3.667414426803589, Second Loss : 3.7263102531433105
epoch: 11 idx: 200 First Loss : 0.9055324931529383, Second Loss : 0.9293942736688797
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4166666666666667, precision 0.5118681668507078, recall 0.5024579124579125, F1 0.4090875051770751, AUC 0.7543714927048261
  Second-Tier acc 0.4375, precision 0.5307142857142857, recall 0.5193939393939394, F1 0.43452380952380953, AUC 0.792020202020202
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.5762925598991172, recall 0.5764991181657848, F1 0.4577240241891149, AUC 0.7615373309817755
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7994378306878307
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 12 idx: 0 First Loss : 3.665005683898926, Second Loss : 3.734400510787964
epoch: 12 idx: 200 First Loss : 0.900037398041731, Second Loss : 0.9264192865600819
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.5105820105820106, recall 0.4909090909090909, F1 0.4080319322254806, AUC 0.7505892255892256
  Second-Tier acc 0.4166666666666667, precision 0.5122100122100122, recall 0.4916161616161616, F1 0.41061895228561895, AUC 0.7861616161616162
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46938775510204084, precision 0.5857142857142857, recall 0.5864197530864197, F1 0.4705882352941176, AUC 0.7657750342935529
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.8014219576719578
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 13 idx: 0 First Loss : 3.6598103046417236, Second Loss : 3.7206878662109375
epoch: 13 idx: 200 First Loss : 0.895110061629073, Second Loss : 0.9236892199292037
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.4957384841666423, recall 0.46794612794612794, F1 0.38733215918334696, AUC 0.7443602693602694
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.777929292929293
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5807271802695143, recall 0.5784832451499118, F1 0.46402611762088886, AUC 0.7671957671957671
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8070987654320988
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 14 idx: 0 First Loss : 3.6223602294921875, Second Loss : 3.695491075515747
epoch: 14 idx: 200 First Loss : 0.8894127530997981, Second Loss : 0.9207899576922953
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.48442292171105733, recall 0.46074074074074073, F1 0.3716345880883438, AUC 0.735415263748597
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7606565656565656
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5748991121872478, recall 0.5661375661375662, F1 0.4425689772075314, AUC 0.766889574759945
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7997685185185186
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 15 idx: 0 First Loss : 3.5773937702178955, Second Loss : 3.660299062728882
epoch: 15 idx: 200 First Loss : 0.8846309141438936, Second Loss : 0.9186267855951321
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.489289077212806, recall 0.46602693602693607, F1 0.3788982259570495, AUC 0.7221604938271605
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7396464646464646
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5722983257229832, recall 0.5560699588477366, F1 0.43434369990615673, AUC 0.7653831079757006
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7959656084656085
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 16 idx: 0 First Loss : 3.526068925857544, Second Loss : 3.6237857341766357
epoch: 16 idx: 200 First Loss : 0.8802512335919414, Second Loss : 0.918111570815982
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.46400966183574877, recall 0.42117845117845115, F1 0.3457245263696877, AUC 0.7085185185185185
  Second-Tier acc 0.375, precision 0.4599078341013825, recall 0.4385858585858586, F1 0.34433621933621933, AUC 0.7219191919191918
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5695882217621347, recall 0.5537918871252204, F1 0.41958553380967173, AUC 0.7590265530080345
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7957451499118166
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 17 idx: 0 First Loss : 3.468738555908203, Second Loss : 3.636760711669922
epoch: 17 idx: 200 First Loss : 0.8777064143066684, Second Loss : 0.9186384668145143
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.4604948444169785, recall 0.4293602693602694, F1 0.3417464322974249, AUC 0.7016666666666667
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7076262626262627
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.43537414965986393, precision 0.5766233766233766, recall 0.5577601410934744, F1 0.42973486863099675, AUC 0.7542070840681951
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7838403880070547
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 18 idx: 0 First Loss : 3.4378058910369873, Second Loss : 3.5470409393310547
epoch: 18 idx: 200 First Loss : 0.87527108389568, Second Loss : 0.9197955756162673
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3402777777777778, precision 0.4538511802662746, recall 0.42094276094276095, F1 0.3327204630575417, AUC 0.6899270482603815
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6915656565656566
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4421768707482993, precision 0.5823934837092732, recall 0.5716490299823632, F1 0.4376412429378531, AUC 0.7504531648050167
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7824625220458553
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 2.52175731924835e-05
epoch: 19 idx: 0 First Loss : 3.4124977588653564, Second Loss : 3.5177412033081055
epoch: 19 idx: 200 First Loss : 0.873439527573979, Second Loss : 0.9209293763689577
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.463112671228829, recall 0.4411447811447811, F1 0.3444386019938132, AUC 0.6834006734006733
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6905050505050506
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.57581310123683, recall 0.5595972957084068, F1 0.4232698489056042, AUC 0.748126102292769
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7802579365079364
Test AUC: 0.7873, Test F1: 0.5128 (Best Epoch: 9){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.48317784068417013, "droprate_2": 0.0, "lr": 5.323160514776038e-05, "weight_decay": 1.0545221563004048e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 5.323160514776038e-05
epoch: 0 idx: 0 First Loss : 1.2568398714065552, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1376655804206484, Second Loss : 1.1193364410851132
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7298316498316498
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7543939393939393
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6904455712326083
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6829254850088183
Test AUC: 0.6829, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.323160514776038e-05
epoch: 1 idx: 0 First Loss : 2.1332061290740967, Second Loss : 2.182715892791748
epoch: 1 idx: 200 First Loss : 1.050718486865065, Second Loss : 1.0527607759284736
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7369977553310886
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7546464646464646
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7143408289241623
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7044201940035274
Test AUC: 0.7044, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 5.323160514776038e-05
epoch: 2 idx: 0 First Loss : 2.2889926433563232, Second Loss : 2.4200820922851562
epoch: 2 idx: 200 First Loss : 0.9927472552627473, Second Loss : 1.0068465228475147
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6597222222222222, precision 0.6033895182831354, recall 0.5721885521885522, F1 0.5759636429723832, AUC 0.7254264870931538
  Second-Tier acc 0.6666666666666666, precision 0.43263757115749524, recall 0.5963636363636363, F1 0.5, AUC 0.7505555555555555
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5714285714285714, precision 0.5175600030672495, recall 0.5245443856554969, F1 0.515128748994781, AUC 0.6917805702527925
  Second-Tier acc 0.5918367346938775, precision 0.5317460317460317, recall 0.4561287477954144, F1 0.4539682539682539, AUC 0.6982473544973544
Test AUC: 0.7044, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 5.323160514776038e-05
epoch: 3 idx: 0 First Loss : 2.6377789974212646, Second Loss : 2.8674025535583496
epoch: 3 idx: 200 First Loss : 0.9433790866229961, Second Loss : 0.9695508439483037
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5, precision 0.4877456688190254, recall 0.49043771043771045, F1 0.4605911475241413, AUC 0.7255050505050505
  Second-Tier acc 0.6041666666666666, precision 0.593124224703172, recall 0.609090909090909, F1 0.5850938167279996, AUC 0.7416161616161615
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4489795918367347, precision 0.4428790164084282, recall 0.4776601998824221, F1 0.4279947578601189, AUC 0.7039792768959435
  Second-Tier acc 0.5918367346938775, precision 0.5911764705882353, recall 0.6371252204585538, F1 0.5885918003565062, AUC 0.7008928571428571
Test AUC: 0.7044, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 5.323160514776038e-05
epoch: 4 idx: 0 First Loss : 3.021616220474243, Second Loss : 3.3534963130950928
epoch: 4 idx: 200 First Loss : 0.9156423508657596, Second Loss : 0.9507506401162242
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.4867494824016563, recall 0.4576767676767677, F1 0.4095393122339681, AUC 0.7230639730639731
  Second-Tier acc 0.5416666666666666, precision 0.6, recall 0.6124242424242424, F1 0.5434715821812596, AUC 0.7716666666666666
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.42857142857142855, precision 0.47882989722070185, recall 0.49037330981775423, F1 0.4252991452991453, AUC 0.7194481187536743
  Second-Tier acc 0.5102040816326531, precision 0.5236111111111111, recall 0.5826719576719577, F1 0.5099206349206349, AUC 0.7565035273368607
Test AUC: 0.7565, Test F1: 0.5099 (Best Epoch: 4)
Current LR: 5.323160514776038e-05
epoch: 5 idx: 0 First Loss : 3.2788143157958984, Second Loss : 3.686583995819092
epoch: 5 idx: 200 First Loss : 0.905666655077789, Second Loss : 0.9435038574327209
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.5092063492063492, recall 0.49882154882154883, F1 0.42951987098384, AUC 0.7215375982042648
  Second-Tier acc 0.4583333333333333, precision 0.554954304954305, recall 0.5182828282828283, F1 0.4556364351760771, AUC 0.7837878787878788
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.5194246277915633, recall 0.5180041152263374, F1 0.44786494538232374, AUC 0.7278745345874976
  Second-Tier acc 0.5714285714285714, precision 0.6064659977703456, recall 0.6655643738977072, F1 0.5857357357357357, AUC 0.7641644620811289
Test AUC: 0.7642, Test F1: 0.5857 (Best Epoch: 5)
Current LR: 5.323160514776038e-05
epoch: 6 idx: 0 First Loss : 3.368178129196167, Second Loss : 3.896804094314575
epoch: 6 idx: 200 First Loss : 0.9004917100085807, Second Loss : 0.9423636722364532
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4236111111111111, precision 0.5162579957356076, recall 0.49245791245791243, F1 0.42062561361405043, AUC 0.7237485970819305
  Second-Tier acc 0.4166666666666667, precision 0.5208333333333334, recall 0.4796969696969697, F1 0.3964529011040639, AUC 0.7896969696969697
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.5544322344322344, recall 0.5471781305114639, F1 0.45764765687804415, AUC 0.7392526455026455
  Second-Tier acc 0.5306122448979592, precision 0.6150793650793651, recall 0.6051587301587301, F1 0.5238095238095238, AUC 0.7785493827160493
Test AUC: 0.7785, Test F1: 0.5238 (Best Epoch: 6)
Current LR: 5.323160514776038e-05
epoch: 7 idx: 0 First Loss : 3.369710922241211, Second Loss : 3.9859867095947266
epoch: 7 idx: 200 First Loss : 0.8959400803742662, Second Loss : 0.9417964526201918
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4097222222222222, precision 0.5090909090909091, recall 0.4892255892255892, F1 0.4064937803078221, AUC 0.7336812570145903
  Second-Tier acc 0.375, precision 0.47781385281385286, recall 0.4216161616161616, F1 0.34795321637426896, AUC 0.7936868686868687
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.5665101721439749, recall 0.5468841857730746, F1 0.44963330623610714, AUC 0.7489711934156379
  Second-Tier acc 0.4897959183673469, precision 0.5878787878787879, recall 0.5511463844797179, F1 0.4745500113921166, AUC 0.7928240740740741
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 8 idx: 0 First Loss : 3.3105621337890625, Second Loss : 4.016645431518555
epoch: 8 idx: 200 First Loss : 0.8906044824794862, Second Loss : 0.9385790693392949
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.5052472377840025, recall 0.4856228956228956, F1 0.40006038647342995, AUC 0.7356341189674523
  Second-Tier acc 0.3541666666666667, precision 0.4599567099567099, recall 0.4082828282828283, F1 0.32803030303030306, AUC 0.7701515151515151
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.5820726830116502, recall 0.5766460905349794, F1 0.46997972481261424, AUC 0.7528965804428768
  Second-Tier acc 0.4897959183673469, precision 0.5878787878787879, recall 0.5511463844797179, F1 0.4745500113921166, AUC 0.7837301587301587
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 9 idx: 0 First Loss : 3.2327778339385986, Second Loss : 4.020524024963379
epoch: 9 idx: 200 First Loss : 0.8841389415099921, Second Loss : 0.9343788919504732
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3888888888888889, precision 0.494439356939357, recall 0.4719191919191919, F1 0.3855983812666981, AUC 0.7304377104377106
  Second-Tier acc 0.3541666666666667, precision 0.46918767507002795, recall 0.4082828282828283, F1 0.3285087719298246, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.5632156676932797, recall 0.5401969429747208, F1 0.4202615349630309, AUC 0.7471034195571233
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7804783950617283
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 10 idx: 0 First Loss : 3.1500966548919678, Second Loss : 3.961677074432373
epoch: 10 idx: 200 First Loss : 0.877679132160543, Second Loss : 0.9295069017697737
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3472222222222222, precision 0.46320987654320983, recall 0.4237037037037037, F1 0.3432098765432099, AUC 0.7174017957351291
  Second-Tier acc 0.3541666666666667, precision 0.4535383597883598, recall 0.4082828282828283, F1 0.32802694721299375, AUC 0.7365151515151515
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.5722222222222222, recall 0.5560699588477366, F1 0.43310657596371877, AUC 0.7475259651185576
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7755180776014109
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 11 idx: 0 First Loss : 3.0877294540405273, Second Loss : 3.99208927154541
epoch: 11 idx: 200 First Loss : 0.8728064202769562, Second Loss : 0.926442849611984
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3402777777777778, precision 0.4542571463624096, recall 0.4249158249158249, F1 0.3336464758483107, AUC 0.7034455667789001
  Second-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.394949494949495, F1 0.3094239006906198, AUC 0.7068181818181819
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5702257941063912, recall 0.5537918871252204, F1 0.4191170154279627, AUC 0.7407529884381736
  Second-Tier acc 0.46938775510204084, precision 0.5703703703703703, recall 0.5388007054673721, F1 0.44831888216580373, AUC 0.7708884479717814
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 12 idx: 0 First Loss : 3.031355619430542, Second Loss : 3.8753464221954346
epoch: 12 idx: 200 First Loss : 0.8675345629059816, Second Loss : 0.9223093334017831
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3402777777777778, precision 0.45220619405787094, recall 0.4257575757575758, F1 0.3330839507073951, AUC 0.688973063973064
  Second-Tier acc 0.3333333333333333, precision 0.43253968253968256, recall 0.394949494949495, F1 0.31265508684863524, AUC 0.6827272727272726
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.5686717925523895, recall 0.5496766607877719, F1 0.4115313768621349, AUC 0.738413678228493
  Second-Tier acc 0.4489795918367347, precision 0.5576923076923077, recall 0.5149911816578483, F1 0.4316993464052288, AUC 0.7683531746031745
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 13 idx: 0 First Loss : 2.949037551879883, Second Loss : 3.812188148498535
epoch: 13 idx: 200 First Loss : 0.8625936893540938, Second Loss : 0.9196929100209347
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.4413419913419913, recall 0.422996632996633, F1 0.3217793700552321, AUC 0.6795230078563411
  Second-Tier acc 0.3125, precision 0.41773399014778323, recall 0.3816161616161617, F1 0.2901709401709402, AUC 0.663080808080808
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5662577616235044, recall 0.53777189888301, F1 0.4088719431837466, AUC 0.7340351263962375
  Second-Tier acc 0.42857142857142855, precision 0.552790346907994, recall 0.5026455026455027, F1 0.4112121212121212, AUC 0.7624007936507938
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 14 idx: 0 First Loss : 2.9173011779785156, Second Loss : 3.7418088912963867
epoch: 14 idx: 200 First Loss : 0.8580799303766148, Second Loss : 0.9178965390995504
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.4262292738707833, recall 0.40929292929292926, F1 0.305295474708888, AUC 0.6730134680134681
  Second-Tier acc 0.3541666666666667, precision 0.44050179211469537, recall 0.44222222222222224, F1 0.3190476190476191, AUC 0.6616666666666666
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.5593601987731966, recall 0.5157995296884186, F1 0.3955104458477578, AUC 0.7266007740544778
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7647156084656085
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 15 idx: 0 First Loss : 2.878329038619995, Second Loss : 3.670429229736328
epoch: 15 idx: 200 First Loss : 0.8541023668712028, Second Loss : 0.9149675326705945
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.44506132659442765, recall 0.4291245791245791, F1 0.3243509261412075, AUC 0.6726599326599326
  Second-Tier acc 0.3541666666666667, precision 0.4401709401709402, recall 0.44222222222222224, F1 0.3210840108401084, AUC 0.666919191919192
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5639215686274509, recall 0.5216049382716049, F1 0.3958746656232051, AUC 0.7206116500097982
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7507716049382717
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 16 idx: 0 First Loss : 2.8442304134368896, Second Loss : 3.626371145248413
epoch: 16 idx: 200 First Loss : 0.8499918816161871, Second Loss : 0.9120684500380573
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3263888888888889, precision 0.4282742451347102, recall 0.4114478114478115, F1 0.3030477386058514, AUC 0.6759876543209876
  Second-Tier acc 0.375, precision 0.4590277777777778, recall 0.45555555555555555, F1 0.33867557798540543, AUC 0.6741919191919191
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41496598639455784, precision 0.5615421455938697, recall 0.5156525573192239, F1 0.3924383873746214, AUC 0.7162882128159906
  Second-Tier acc 0.3877551020408163, precision 0.5142857142857142, recall 0.43077601410934746, F1 0.3465909090909091, AUC 0.7442680776014109
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 17 idx: 0 First Loss : 2.8974781036376953, Second Loss : 3.616163730621338
epoch: 17 idx: 200 First Loss : 0.8480766374056444, Second Loss : 0.9104752863089227
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3333333333333333, precision 0.4322618704641177, recall 0.4215488215488216, F1 0.30806807036315237, AUC 0.6809708193041527
  Second-Tier acc 0.375, precision 0.45555555555555555, recall 0.45555555555555555, F1 0.34194422589387186, AUC 0.6772727272727274
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41496598639455784, precision 0.558866634098681, recall 0.5097001763668431, F1 0.38860238505646044, AUC 0.7156697040956299
  Second-Tier acc 0.40816326530612246, precision 0.5379310344827586, recall 0.4724426807760141, F1 0.37716970003370404, AUC 0.7375992063492064
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 18 idx: 0 First Loss : 2.900141477584839, Second Loss : 3.56711745262146
epoch: 18 idx: 200 First Loss : 0.8437030007102728, Second Loss : 0.9067521961523157
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3472222222222222, precision 0.44072835377183206, recall 0.4417508417508418, F1 0.31753535353535356, AUC 0.6849943883277216
  Second-Tier acc 0.3958333333333333, precision 0.4677066228790367, recall 0.4688888888888889, F1 0.36388888888888893, AUC 0.6848484848484849
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.38095238095238093, precision 0.528031070584262, recall 0.4500293944738389, F1 0.3418907747552249, AUC 0.7107032627865961
  Second-Tier acc 0.3877551020408163, precision 0.5142857142857142, recall 0.43077601410934746, F1 0.3465909090909091, AUC 0.7340718694885361
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7)
Current LR: 5.323160514776038e-05
epoch: 19 idx: 0 First Loss : 2.9359920024871826, Second Loss : 3.5643811225891113
epoch: 19 idx: 200 First Loss : 0.8405000620679577, Second Loss : 0.9040026728175531
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3263888888888889, precision 0.41996336996336997, recall 0.4131313131313132, F1 0.29505582137161085, AUC 0.6812514029180696
  Second-Tier acc 0.3958333333333333, precision 0.4677066228790367, recall 0.4688888888888889, F1 0.36388888888888893, AUC 0.6891414141414142
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3673469387755102, precision 0.5229716520039102, recall 0.4379776601998824, F1 0.32946922358687064, AUC 0.705871546149324
  Second-Tier acc 0.40816326530612246, precision 0.5380952380952381, recall 0.4724426807760141, F1 0.3768939393939394, AUC 0.7296075837742504
Test AUC: 0.7928, Test F1: 0.4746 (Best Epoch: 7){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.2600345168178738, "droprate_2": 0.0, "lr": 0.00023961527004124437, "weight_decay": 0.0005468385574706205, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00023961527004124437
epoch: 0 idx: 0 First Loss : 1.1607481241226196, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.089888461193635, Second Loss : 1.0707445410427763
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7470089786756454
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7508585858585858
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7186826376641191
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7159391534391534
Test AUC: 0.7159, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00023961527004124437
epoch: 1 idx: 0 First Loss : 1.5419120788574219, Second Loss : 1.6915940046310425
epoch: 1 idx: 200 First Loss : 0.9691801748762083, Second Loss : 0.9772615665523567
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7325589225589226
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7358080808080808
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7359396433470508
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7372134038800705
Test AUC: 0.7159, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00023961527004124437
epoch: 2 idx: 0 First Loss : 2.26941180229187, Second Loss : 2.33400821685791
epoch: 2 idx: 200 First Loss : 0.9300899747295759, Second Loss : 0.94360063284339
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5625, precision 0.4681960375391032, recall 0.393939393939394, F1 0.33584905660377357, AUC 0.7318069584736252
  Second-Tier acc 0.5833333333333334, precision 0.43939393939393945, recall 0.42424242424242425, F1 0.3748792270531401, AUC 0.7371717171717171
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7419838820301784
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7426146384479718
Test AUC: 0.7159, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00023961527004124437
epoch: 3 idx: 0 First Loss : 3.102593421936035, Second Loss : 3.2968740463256836
epoch: 3 idx: 200 First Loss : 0.9095271145415247, Second Loss : 0.930798503408088
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6180555555555556, precision 0.401882505679974, recall 0.5595959595959595, F1 0.4570191713048856, AUC 0.7327497194163861
  Second-Tier acc 0.6666666666666666, precision 0.601364522417154, recall 0.6108080808080808, F1 0.539072039072039, AUC 0.7343434343434344
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5578231292517006, precision 0.3757104027674821, recall 0.45208700764256315, F1 0.3975617008623253, AUC 0.7255046051342348
  Second-Tier acc 0.5918367346938775, precision 0.5274170274170273, recall 0.531305114638448, F1 0.5170068027210885, AUC 0.728505291005291
Test AUC: 0.7159, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00023961527004124437
epoch: 4 idx: 0 First Loss : 3.401481866836548, Second Loss : 3.4289841651916504
epoch: 4 idx: 200 First Loss : 0.8983183791513429, Second Loss : 0.9199521309737839
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4027777777777778, precision 0.7146997929606625, recall 0.44925925925925925, F1 0.3220064724919094, AUC 0.7701571268237934
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7698484848484849
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.41316966409744027, recall 0.41681363903586127, F1 0.3301075268817204, AUC 0.7398405349794239
  Second-Tier acc 0.46938775510204084, precision 0.41984126984126985, recall 0.42151675485008816, F1 0.35129949415663697, AUC 0.7306547619047619
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 5 idx: 0 First Loss : 3.3994181156158447, Second Loss : 3.6771304607391357
epoch: 5 idx: 200 First Loss : 0.8935309059301678, Second Loss : 0.916483519779546
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.7426318742985409
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7589898989898991
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.4491525423728813, recall 0.440623162845385, F1 0.34208715596330275, AUC 0.7039792768959435
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.7310956790123457
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 6 idx: 0 First Loss : 3.3211472034454346, Second Loss : 3.8565304279327393
epoch: 6 idx: 200 First Loss : 0.8908385145686456, Second Loss : 0.9067769107844366
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3819444444444444, precision 0.4258333333333333, recall 0.4359259259259259, F1 0.3072280139000267, AUC 0.7118462401795735
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7187878787878788
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.4921171171171171, recall 0.43863903586125813, F1 0.36202179648617855, AUC 0.6777998236331569
  Second-Tier acc 0.46938775510204084, precision 0.4537037037037037, recall 0.4329805996472664, F1 0.3535135135135135, AUC 0.6862323633156966
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 7 idx: 0 First Loss : 3.6670310497283936, Second Loss : 3.9190688133239746
epoch: 7 idx: 200 First Loss : 0.8917284467574951, Second Loss : 0.9088984325815418
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.44190883190883196, recall 0.4540740740740741, F1 0.34192007337742963, AUC 0.6896352413019079
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6985858585858585
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.5065359477124184, recall 0.4384920634920635, F1 0.38095238095238093, AUC 0.689888300999412
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6812720458553793
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 8 idx: 0 First Loss : 4.007491588592529, Second Loss : 4.08877420425415
epoch: 8 idx: 200 First Loss : 0.9023532767702515, Second Loss : 0.9097872116108916
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.5515536723163842, recall 0.4359259259259259, F1 0.3046533653016748, AUC 0.6690460157126824
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6775252525252524
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.6157024793388429, recall 0.4459876543209877, F1 0.3498011191262725, AUC 0.6713514109347442
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.670083774250441
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 9 idx: 0 First Loss : 3.5399057865142822, Second Loss : 3.7600393295288086
epoch: 9 idx: 200 First Loss : 0.8944521146763894, Second Loss : 0.9065802747772344
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.37243697478991594, recall 0.4266666666666667, F1 0.2847368421052632, AUC 0.6609427609427608
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.6782828282828283
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.4376543209876543, recall 0.44032921810699593, F1 0.3333333333333333, AUC 0.6676097393689986
  Second-Tier acc 0.5306122448979592, precision 0.6296296296296297, recall 0.5108024691358025, F1 0.4463157894736842, AUC 0.6821538800705467
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 10 idx: 0 First Loss : 3.531964063644409, Second Loss : 3.669680595397949
epoch: 10 idx: 200 First Loss : 0.8940026988449103, Second Loss : 0.9086204935120076
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.3670289855072464, recall 0.4177777777777778, F1 0.27304255035347474, AUC 0.6580415263748597
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6751515151515152
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.6166666666666667, recall 0.45010288065843623, F1 0.35571323621638085, AUC 0.6701817558299039
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6723985890652556
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 11 idx: 0 First Loss : 3.3387482166290283, Second Loss : 3.590512752532959
epoch: 11 idx: 200 First Loss : 0.8869058398274469, Second Loss : 0.8963407570416854
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.3636363636363636, recall 0.41333333333333333, F1 0.2665684830633284, AUC 0.6581425364758697
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6707575757575758
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.4362152998516635, recall 0.43621399176954734, F1 0.32754238097968386, AUC 0.6712166862629827
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.679508377425044
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 12 idx: 0 First Loss : 3.33378529548645, Second Loss : 3.6007959842681885
epoch: 12 idx: 200 First Loss : 0.8772675122922942, Second Loss : 0.8903154931565461
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3888888888888889, precision 0.36863711001642036, recall 0.43555555555555553, F1 0.296518320627267, AUC 0.6610325476992144
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6678282828282828
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4897959183673469, precision 0.4342391304347826, recall 0.4567901234567901, F1 0.3553350994870639, AUC 0.6766301685283166
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6932870370370371
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 13 idx: 0 First Loss : 3.3156490325927734, Second Loss : 3.609708309173584
epoch: 13 idx: 200 First Loss : 0.8690286886542966, Second Loss : 0.8840458091630471
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.375, precision 0.37243697478991594, recall 0.4266666666666667, F1 0.2847368421052632, AUC 0.6603198653198653
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6701010101010101
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4897959183673469, precision 0.4342391304347826, recall 0.4567901234567901, F1 0.3553350994870639, AUC 0.6819517930629041
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6983024691358025
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4)
Current LR: 0.00023961527004124437
epoch: 14 idx: 0 First Loss : 3.355217695236206, Second Loss : 3.6799514293670654
epoch: 14 idx: 200 First Loss : 0.8669477525746059, Second Loss : 0.8813237482798431
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.3600052042674993, recall 0.40888888888888886, F1 0.2599910394265233, AUC 0.660314253647587
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6694444444444444
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.47619047619047616, precision 0.4307692307692308, recall 0.448559670781893, F1 0.3442687970989858, AUC 0.6853199098569469
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.705026455026455
Test AUC: 0.7307, Test F1: 0.3513 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.17797988781708135, "droprate_2": 0.0, "lr": 0.00024652373767437147, "weight_decay": 0.00012346154226158018, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.23621474165145503, "droprate_2": 0.0, "lr": 0.00036688935902126396, "weight_decay": 1.797730918032063e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.09468113763792343, "droprate_2": 0.0, "lr": 0.0009172332618002293, "weight_decay": 0.0005374279068427488, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.0967174013786466, "droprate_2": 0.0, "lr": 4.656268893490885e-05, "weight_decay": 0.00014080864571172576, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.14315223630490906, "droprate_2": 0.0, "lr": 4.384379247676441e-05, "weight_decay": 0.0008919365267995318, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0812788009643555, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1231701927843378, Second Loss : 1.1144862945993148
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7425820707070706
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7297474747474748
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6710379464285715
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6688712522045855
epoch: 1 idx: 0 First Loss : 2.004024028778076, Second Loss : 2.060763120651245
epoch: 1 idx: 200 First Loss : 1.052295238817509, Second Loss : 1.053867683926625
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7447285353535352
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7479797979797981
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7071759259259259
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7016093474426808
epoch: 2 idx: 0 First Loss : 2.1888957023620605, Second Loss : 2.2443792819976807
epoch: 2 idx: 200 First Loss : 1.0030657344715512, Second Loss : 1.0086741759186952
  First-Tier acc 0.5885416666666666, precision 0.5493324766188334, recall 0.44815656565656564, F1 0.4046627827638692, AUC 0.7399463383838384
  Second-Tier acc 0.6041666666666666, precision 0.6222222222222222, recall 0.46646464646464647, F1 0.460042735042735, AUC 0.7437373737373738
  First-Tier acc 0.6122448979591837, precision 0.6390476190476191, recall 0.4270833333333333, F1 0.4078639589068725, AUC 0.708488343253968
  Second-Tier acc 0.6326530612244898, precision 0.7045454545454546, recall 0.48214285714285715, F1 0.47700597524541183, AUC 0.7124118165784831
epoch: 3 idx: 0 First Loss : 2.5350005626678467, Second Loss : 2.5375616550445557
epoch: 3 idx: 200 First Loss : 0.9656227718093502, Second Loss : 0.9706869443035244
  First-Tier acc 0.6354166666666666, precision 0.6028358115314637, recall 0.5978535353535354, F1 0.5721524184632908, AUC 0.7430555555555555
  Second-Tier acc 0.6458333333333334, precision 0.5573192239858906, recall 0.5584848484848485, F1 0.5473144399460189, AUC 0.7365151515151517
  First-Tier acc 0.6020408163265306, precision 0.5694305694305695, recall 0.5951829805996472, F1 0.5777227552369715, AUC 0.7073722718253969
  Second-Tier acc 0.5510204081632653, precision 0.5165945165945166, recall 0.548721340388007, F1 0.5274460661457566, AUC 0.7119157848324514
epoch: 4 idx: 0 First Loss : 2.8932900428771973, Second Loss : 2.9164130687713623
epoch: 4 idx: 200 First Loss : 0.9443820973311491, Second Loss : 0.945624161307788
  First-Tier acc 0.5625, precision 0.5683127075966999, recall 0.5879292929292929, F1 0.5475003153825033, AUC 0.7564835858585859
  Second-Tier acc 0.5625, precision 0.5658312447786132, recall 0.5748484848484848, F1 0.5435483870967742, AUC 0.761010101010101
  First-Tier acc 0.5561224489795918, precision 0.5523235673484429, recall 0.5995921516754851, F1 0.5481382668458826, AUC 0.7183917548500882
  Second-Tier acc 0.5714285714285714, precision 0.5518483709273183, recall 0.6018518518518519, F1 0.5547650417215634, AUC 0.730599647266314
epoch: 5 idx: 0 First Loss : 3.1734769344329834, Second Loss : 3.226243495941162
epoch: 5 idx: 200 First Loss : 0.9337513847044896, Second Loss : 0.9311472763265691
  First-Tier acc 0.5416666666666666, precision 0.5826744952137349, recall 0.5962626262626262, F1 0.5394865323805363, AUC 0.7658743686868688
  Second-Tier acc 0.5416666666666666, precision 0.6034547152194211, recall 0.6124242424242424, F1 0.544991789819376, AUC 0.7872222222222222
  First-Tier acc 0.5, precision 0.524151656209944, recall 0.5672398589065256, F1 0.4998493247714921, AUC 0.7277853560405644
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7395282186948854
epoch: 6 idx: 0 First Loss : 3.3896307945251465, Second Loss : 3.4578144550323486
epoch: 6 idx: 200 First Loss : 0.9312148074763109, Second Loss : 0.9249428394737084
  First-Tier acc 0.484375, precision 0.5508516537928303, recall 0.5566161616161617, F1 0.4832042534882291, AUC 0.7700757575757576
  Second-Tier acc 0.5416666666666666, precision 0.6082125603864735, recall 0.6149494949494949, F1 0.5454300238613964, AUC 0.8129545454545455
  First-Tier acc 0.4897959183673469, precision 0.5336909467344251, recall 0.562334656084656, F1 0.48719851576994433, AUC 0.7319292879188711
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7427799823633157
epoch: 7 idx: 0 First Loss : 3.44061541557312, Second Loss : 3.591439723968506
epoch: 7 idx: 200 First Loss : 0.9269254815889828, Second Loss : 0.9186321056091148
  First-Tier acc 0.46875, precision 0.5397465437788018, recall 0.5393939393939394, F1 0.4661877727571158, AUC 0.7643055555555556
  Second-Tier acc 0.5416666666666666, precision 0.6128205128205129, recall 0.6174747474747475, F1 0.5432804232804233, AUC 0.817979797979798
  First-Tier acc 0.47959183673469385, precision 0.5386254986145367, recall 0.5545634920634921, F1 0.4762509308282443, AUC 0.7347470238095237
  Second-Tier acc 0.5306122448979592, precision 0.5521145521145522, recall 0.6000881834215167, F1 0.5360046457607434, AUC 0.7448192239858907
epoch: 8 idx: 0 First Loss : 3.482367515563965, Second Loss : 3.6667425632476807
epoch: 8 idx: 200 First Loss : 0.9244433922637532, Second Loss : 0.9134070761941966
  First-Tier acc 0.453125, precision 0.5355968517561024, recall 0.5221717171717172, F1 0.44893406795189295, AUC 0.7540751262626263
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.8174242424242424
  First-Tier acc 0.4642857142857143, precision 0.5387798512798513, recall 0.5290454144620812, F1 0.45632183908045976, AUC 0.7342854387125222
  Second-Tier acc 0.4897959183673469, precision 0.5170940170940171, recall 0.5575396825396826, F1 0.4880149090675407, AUC 0.7450947971781305
epoch: 9 idx: 0 First Loss : 3.52142333984375, Second Loss : 3.717759370803833
epoch: 9 idx: 200 First Loss : 0.9218226235095801, Second Loss : 0.9090696943377085
  First-Tier acc 0.453125, precision 0.5328144555694618, recall 0.5179292929292929, F1 0.44928823789952926, AUC 0.7434027777777779
  Second-Tier acc 0.4583333333333333, precision 0.5308641975308641, recall 0.5208080808080807, F1 0.4434124527003784, AUC 0.8053535353535354
  First-Tier acc 0.46938775510204084, precision 0.5424774624974159, recall 0.5349977954144621, F1 0.461008252652981, AUC 0.734691909171076
  Second-Tier acc 0.5102040816326531, precision 0.5592592592592592, recall 0.5634920634920635, F1 0.4906174467150077, AUC 0.7572200176366843{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.07355512645281256, "droprate_2": 0.0, "lr": 4.560137877894127e-05, "weight_decay": 0.0008016776859358341, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 20, "gamma": 0.7996587383913129, "T_max": 15, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0900758504867554, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1253139304729243, Second Loss : 1.1144076460481283
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408049242424243
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7309090909090908
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.673945243606702
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6688712522045855
epoch: 1 idx: 0 First Loss : 1.9342420101165771, Second Loss : 2.049232244491577
epoch: 1 idx: 200 First Loss : 1.0497654252384432, Second Loss : 1.0497728394928263
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7417045454545454
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7472727272727274
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7078166335978836
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7029320987654321
epoch: 2 idx: 0 First Loss : 2.149132490158081, Second Loss : 2.219460964202881
epoch: 2 idx: 200 First Loss : 0.9992596712797436, Second Loss : 1.0023646941084174
  First-Tier acc 0.6041666666666666, precision 0.612797807294961, recall 0.4744949494949495, F1 0.436902966314731, AUC 0.7382228535353536
  Second-Tier acc 0.5833333333333334, precision 0.5333333333333333, recall 0.4386868686868686, F1 0.4114199525964232, AUC 0.7449494949494948
  First-Tier acc 0.6479591836734694, precision 0.7227959456875119, recall 0.48947310405643735, F1 0.5019201912561356, AUC 0.7051229056437389
  Second-Tier acc 0.6326530612244898, precision 0.625968992248062, recall 0.48214285714285715, F1 0.46547619047619043, AUC 0.7071208112874778
epoch: 3 idx: 0 First Loss : 2.500725746154785, Second Loss : 2.5522408485412598
epoch: 3 idx: 200 First Loss : 0.9625980993779144, Second Loss : 0.9619933771182648
  First-Tier acc 0.6354166666666666, precision 0.6030092592592592, recall 0.616540404040404, F1 0.5919590643274854, AUC 0.7428030303030303
  Second-Tier acc 0.6041666666666666, precision 0.525, recall 0.5318181818181819, F1 0.5205128205128206, AUC 0.7389393939393939
  First-Tier acc 0.5918367346938775, precision 0.5627705627705627, recall 0.5963403880070547, F1 0.5727306429882543, AUC 0.7043168540564375
  Second-Tier acc 0.5306122448979592, precision 0.4898205659075225, recall 0.5249118165784833, F1 0.499047619047619, AUC 0.7190255731922398
epoch: 4 idx: 0 First Loss : 2.880711078643799, Second Loss : 2.966871738433838
epoch: 4 idx: 200 First Loss : 0.944059864335244, Second Loss : 0.9391403347809812
  First-Tier acc 0.5572916666666666, precision 0.5676710608913998, recall 0.5820707070707071, F1 0.5470863117337794, AUC 0.7564646464646465
  Second-Tier acc 0.5625, precision 0.5972222222222222, recall 0.6062626262626263, F1 0.5546796796796797, AUC 0.7616666666666667
  First-Tier acc 0.5561224489795918, precision 0.554933954933955, recall 0.6158509700176367, F1 0.5487267726223225, AUC 0.7183883101851851
  Second-Tier acc 0.5510204081632653, precision 0.5393713040771865, recall 0.5895061728395062, F1 0.5397632236341914, AUC 0.7332451499118166
epoch: 5 idx: 0 First Loss : 3.1655867099761963, Second Loss : 3.3160901069641113
epoch: 5 idx: 200 First Loss : 0.9355521376397627, Second Loss : 0.9275495605033577
  First-Tier acc 0.53125, precision 0.572611056027827, recall 0.5798484848484848, F1 0.5304648526077097, AUC 0.7640877525252524
  Second-Tier acc 0.5208333333333334, precision 0.5833333333333334, recall 0.5821212121212122, F1 0.5219662058371736, AUC 0.7895454545454546
  First-Tier acc 0.5, precision 0.5324719914612209, recall 0.5790343915343915, F1 0.4971029564700638, AUC 0.7293940145502645
  Second-Tier acc 0.4897959183673469, precision 0.503968253968254, recall 0.5524691358024691, F1 0.49367625838214074, AUC 0.7358906525573191
epoch: 6 idx: 0 First Loss : 3.361407995223999, Second Loss : 3.523012638092041
epoch: 6 idx: 200 First Loss : 0.9352019831111923, Second Loss : 0.9222162511032909
  First-Tier acc 0.4739583333333333, precision 0.5434472934472935, recall 0.5408333333333334, F1 0.4751457960233274, AUC 0.7686426767676767
  Second-Tier acc 0.5416666666666666, precision 0.6082125603864735, recall 0.6149494949494949, F1 0.5454300238613964, AUC 0.8116666666666666
  First-Tier acc 0.5102040816326531, precision 0.55284530835454, recall 0.5995370370370371, F1 0.509349130401762, AUC 0.7315813767636684
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7395282186948853
epoch: 7 idx: 0 First Loss : 3.4447059631347656, Second Loss : 3.646477460861206
epoch: 7 idx: 200 First Loss : 0.9329206589470381, Second Loss : 0.9158853152674155
  First-Tier acc 0.4635416666666667, precision 0.5357683982683983, recall 0.5305555555555556, F1 0.46423416965352443, AUC 0.7620549242424243
  Second-Tier acc 0.5416666666666666, precision 0.6226495726495727, recall 0.6174747474747475, F1 0.546053196053196, AUC 0.8192424242424242
  First-Tier acc 0.4744897959183674, precision 0.5336670859125173, recall 0.5441468253968255, F1 0.4687017713965365, AUC 0.7310061177248678
  Second-Tier acc 0.5306122448979592, precision 0.5521145521145522, recall 0.6000881834215167, F1 0.5360046457607434, AUC 0.7469135802469137
epoch: 8 idx: 0 First Loss : 3.4876821041107178, Second Loss : 3.735071897506714
epoch: 8 idx: 200 First Loss : 0.9303196991622373, Second Loss : 0.9126305971549481
  First-Tier acc 0.4583333333333333, precision 0.5382923029981853, recall 0.5284848484848484, F1 0.457389502476486, AUC 0.7487941919191919
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.8105050505050505
  First-Tier acc 0.45408163265306123, precision 0.5303190386521589, recall 0.5142746913580246, F1 0.44596486104665384, AUC 0.7279644786155203
  Second-Tier acc 0.5306122448979592, precision 0.5683621933621934, recall 0.623015873015873, F1 0.5326953748006379, AUC 0.7552910052910052
epoch: 9 idx: 0 First Loss : 3.4990761280059814, Second Loss : 3.7687273025512695
epoch: 9 idx: 200 First Loss : 0.9273120495212723, Second Loss : 0.9080571303195065
  First-Tier acc 0.4375, precision 0.5208572208572209, recall 0.5000757575757576, F1 0.4358281011972045, AUC 0.7337815656565656
  Second-Tier acc 0.4583333333333333, precision 0.5308641975308641, recall 0.5208080808080807, F1 0.4434124527003784, AUC 0.7873737373737374
  First-Tier acc 0.4744897959183674, precision 0.5495109760624293, recall 0.535218253968254, F1 0.464665290496993, AUC 0.7255084325396824
  Second-Tier acc 0.5102040816326531, precision 0.5592592592592592, recall 0.5634920634920635, F1 0.4906174467150077, AUC 0.7660383597883599{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.22030557829258784, "droprate_2": 0.0, "lr": 3.879223478449743e-05, "weight_decay": 0.0009886736226202937, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0926584005355835, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1182705046822183, Second Loss : 1.1124363978259006
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7366161616161616
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7272222222222222
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6675209435626103
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6633597883597883
epoch: 1 idx: 0 First Loss : 2.038186550140381, Second Loss : 2.0685412883758545
epoch: 1 idx: 200 First Loss : 1.0617212322517413, Second Loss : 1.0638106380825612
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7426988636363636
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7542929292929292
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7047784391534391
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703097442680776
epoch: 2 idx: 0 First Loss : 2.2240383625030518, Second Loss : 2.2168521881103516
epoch: 2 idx: 200 First Loss : 1.015978588949685, Second Loss : 1.0233870108996457
  First-Tier acc 0.5989583333333334, precision 0.7910331384015595, recall 0.45482323232323235, F1 0.42135451966764564, AUC 0.7399242424242424
  Second-Tier acc 0.5833333333333334, precision 0.44379844961240317, recall 0.42424242424242425, F1 0.3784313725490196, AUC 0.7429797979797979
  First-Tier acc 0.5816326530612245, precision 0.5723723723723724, recall 0.3869047619047619, F1 0.33931123681206254, AUC 0.710841049382716
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.7053571428571428
epoch: 3 idx: 0 First Loss : 2.4857635498046875, Second Loss : 2.501133918762207
epoch: 3 idx: 200 First Loss : 0.976634787015654, Second Loss : 0.9845839849677845
  First-Tier acc 0.671875, precision 0.6347290640394089, recall 0.609090909090909, F1 0.5933260711692084, AUC 0.740217803030303
  Second-Tier acc 0.6875, precision 0.6518518518518518, recall 0.614040404040404, F1 0.6253968253968254, AUC 0.7430808080808081
  First-Tier acc 0.6173469387755102, precision 0.5770890382540869, recall 0.5974426807760141, F1 0.585237057849033, AUC 0.7037829309964726
  Second-Tier acc 0.5306122448979592, precision 0.47804972804972806, recall 0.5134479717813051, F1 0.4871698113207547, AUC 0.7012786596119929
epoch: 4 idx: 0 First Loss : 2.793057441711426, Second Loss : 2.8347065448760986
epoch: 4 idx: 200 First Loss : 0.9502851171465359, Second Loss : 0.9559883322585282
  First-Tier acc 0.5729166666666666, precision 0.5604012725779967, recall 0.5763636363636363, F1 0.5534851536701333, AUC 0.7501546717171718
  Second-Tier acc 0.5833333333333334, precision 0.5741731035848683, recall 0.5856565656565657, F1 0.5516339869281045, AUC 0.751010101010101
  First-Tier acc 0.5306122448979592, precision 0.5219600072059088, recall 0.5758928571428571, F1 0.5165186393033028, AUC 0.7132454254850088
  Second-Tier acc 0.5306122448979592, precision 0.5072055137844612, recall 0.5542328042328043, F1 0.5031055900621119, AUC 0.726576278659612
epoch: 5 idx: 0 First Loss : 3.088226795196533, Second Loss : 3.1557111740112305
epoch: 5 idx: 200 First Loss : 0.9351362759590297, Second Loss : 0.9393657393642326
  First-Tier acc 0.5208333333333334, precision 0.563002364066194, recall 0.5621717171717172, F1 0.5166235185032177, AUC 0.7617392676767677
  Second-Tier acc 0.5416666666666666, precision 0.5814982119329946, recall 0.5904040404040404, F1 0.5280423280423281, AUC 0.7813636363636364
  First-Tier acc 0.4846938775510204, precision 0.5032311792138574, recall 0.564373897707231, F1 0.478129853991923, AUC 0.7232762896825397
  Second-Tier acc 0.46938775510204084, precision 0.489573607220666, recall 0.5465167548500882, F1 0.4658758498254958, AUC 0.736386684303351
epoch: 6 idx: 0 First Loss : 3.2829718589782715, Second Loss : 3.3928756713867188
epoch: 6 idx: 200 First Loss : 0.9278281109398278, Second Loss : 0.9298856087418189
  First-Tier acc 0.4791666666666667, precision 0.5500148676776687, recall 0.5355050505050505, F1 0.47974074609785883, AUC 0.7661742424242425
  Second-Tier acc 0.5, precision 0.5556818181818182, recall 0.5492929292929293, F1 0.4909637929245772, AUC 0.8054545454545455
  First-Tier acc 0.4744897959183674, precision 0.5198568316215375, recall 0.5639329805996472, F1 0.4705403528932941, AUC 0.7292045579805997
  Second-Tier acc 0.4897959183673469, precision 0.5130012531328321, recall 0.5703262786596119, F1 0.49451835427445184, AUC 0.7390321869488536
epoch: 7 idx: 0 First Loss : 3.412768602371216, Second Loss : 3.541241407394409
epoch: 7 idx: 200 First Loss : 0.9249831536849636, Second Loss : 0.9238641573792666
  First-Tier acc 0.4583333333333333, precision 0.5335733107472238, recall 0.5198232323232324, F1 0.4594009678601037, AUC 0.7661647727272728
  Second-Tier acc 0.5416666666666666, precision 0.6034547152194211, recall 0.6124242424242424, F1 0.544991789819376, AUC 0.8139898989898989
  First-Tier acc 0.4642857142857143, precision 0.525100012904891, recall 0.5590277777777778, F1 0.46372807017543854, AUC 0.7315331514550264
  Second-Tier acc 0.5306122448979592, precision 0.5645909645909647, recall 0.6179453262786596, F1 0.5386128364389234, AUC 0.7448192239858907
epoch: 8 idx: 0 First Loss : 3.4803695678710938, Second Loss : 3.630575656890869
epoch: 8 idx: 200 First Loss : 0.9220075451477028, Second Loss : 0.9190436395033452
  First-Tier acc 0.453125, precision 0.5300968580203166, recall 0.5183838383838384, F1 0.4548394725327752, AUC 0.7572537878787878
  Second-Tier acc 0.5208333333333334, precision 0.5962962962962962, recall 0.6041414141414142, F1 0.5215351097704038, AUC 0.8168686868686867
  First-Tier acc 0.45918367346938777, precision 0.5471908453303803, recall 0.564539241622575, F1 0.45948733631486904, AUC 0.7327870094797179
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7473544973544973
epoch: 9 idx: 0 First Loss : 3.5109786987304688, Second Loss : 3.676323890686035
epoch: 9 idx: 200 First Loss : 0.9205268656357715, Second Loss : 0.9135142996355854
  First-Tier acc 0.4583333333333333, precision 0.5406223893065998, recall 0.5314646464646464, F1 0.45828242098403393, AUC 0.7482039141414142
  Second-Tier acc 0.5, precision 0.5783475783475783, recall 0.5763636363636363, F1 0.49704292527821936, AUC 0.820050505050505
  First-Tier acc 0.45408163265306123, precision 0.5414090180684809, recall 0.5496582892416225, F1 0.4534076709515306, AUC 0.7318121693121693
  Second-Tier acc 0.5714285714285714, precision 0.648888888888889, recall 0.6884920634920636, F1 0.5746934225195095, AUC 0.7482914462081128{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_13", "train_show_freq": 200, "droprate": 0.2419623218924385, "droprate_2": 0.0, "lr": 2.2138929744348165e-05, "weight_decay": 6.654470078950631e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 3, "gamma": 0.45670563714458, "T_max": 8, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_13", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1084060668945312, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.09962424546925, Second Loss : 1.0937667923483683
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7189236111111111
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7146464646464646
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6433256172839507
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6382826278659611
epoch: 1 idx: 0 First Loss : 2.020540475845337, Second Loss : 2.0018272399902344
epoch: 1 idx: 200 First Loss : 1.0919955974046271, Second Loss : 1.0897788484742985
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7401357323232324
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7456565656565658
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6860015707671957
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6843584656084657
epoch: 2 idx: 0 First Loss : 2.122087001800537, Second Loss : 2.0925583839416504
epoch: 2 idx: 200 First Loss : 1.0625372420792556, Second Loss : 1.0660118531083587
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7411679292929293
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482828282828282
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6988088348765432
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6942791005291005
epoch: 3 idx: 0 First Loss : 2.2627434730529785, Second Loss : 2.2425005435943604
epoch: 3 idx: 200 First Loss : 1.0411191918141214, Second Loss : 1.0484448827766066
  First-Tier acc 0.578125, precision 0.45643939393939387, recall 0.4251515151515151, F1 0.3811594202898551, AUC 0.7376073232323233
  Second-Tier acc 0.5416666666666666, precision 0.404040404040404, recall 0.3806060606060606, F1 0.3271221532091097, AUC 0.7437878787878788
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6980613425925926
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6981922398589065
epoch: 4 idx: 0 First Loss : 2.2657248973846436, Second Loss : 2.2307753562927246
epoch: 4 idx: 200 First Loss : 1.020019548375215, Second Loss : 1.0292859925188829
  First-Tier acc 0.640625, precision 0.41697236488138906, recall 0.5287878787878788, F1 0.46363160648874935, AUC 0.7386584595959595
  Second-Tier acc 0.5833333333333334, precision 0.5333333333333333, recall 0.4386868686868686, F1 0.4114199525964232, AUC 0.7495454545454544
  First-Tier acc 0.5918367346938775, precision 0.6737561954953258, recall 0.4099426807760141, F1 0.38690375277131445, AUC 0.6894772376543209
  Second-Tier acc 0.6530612244897959, precision 0.8093023255813954, recall 0.5238095238095238, F1 0.5067155067155067, AUC 0.695216049382716
epoch: 5 idx: 0 First Loss : 2.3674092292785645, Second Loss : 2.3291618824005127
epoch: 5 idx: 200 First Loss : 1.0086837636297614, Second Loss : 1.0187533725405213
  First-Tier acc 0.6666666666666666, precision 0.7586894586894587, recall 0.5830050505050505, F1 0.5022255065864943, AUC 0.7386079545454546
  Second-Tier acc 0.6875, precision 0.6785714285714285, recall 0.5851515151515151, F1 0.5948400412796698, AUC 0.751969696969697
  First-Tier acc 0.5663265306122449, precision 0.6219829059829061, recall 0.45089285714285715, F1 0.45722000172993044, AUC 0.6863667052469135
  Second-Tier acc 0.6326530612244898, precision 0.5972222222222222, recall 0.5751763668430335, F1 0.5739898989898989, AUC 0.689373897707231
epoch: 6 idx: 0 First Loss : 2.470186948776245, Second Loss : 2.431102991104126
epoch: 6 idx: 200 First Loss : 0.9926720953254558, Second Loss : 1.0016631902895163
  First-Tier acc 0.6354166666666666, precision 0.5730434782608695, recall 0.5630050505050505, F1 0.4785798970751091, AUC 0.7387973484848483
  Second-Tier acc 0.6875, precision 0.7713920817369093, recall 0.6241414141414141, F1 0.5527720470249206, AUC 0.7509595959595959
  First-Tier acc 0.5561224489795918, precision 0.6947089947089946, recall 0.4440586419753087, F1 0.40850137493008415, AUC 0.6879340277777777
  Second-Tier acc 0.5714285714285714, precision 0.5401709401709401, recall 0.54320987654321, F1 0.541422684883973, AUC 0.6852954144620812
epoch: 7 idx: 0 First Loss : 2.507594585418701, Second Loss : 2.462397336959839
epoch: 7 idx: 200 First Loss : 0.9795493998782552, Second Loss : 0.9891659872078183
  First-Tier acc 0.6145833333333334, precision 0.5359437751004016, recall 0.5617676767676768, F1 0.4795342591055141, AUC 0.7392645202020202
  Second-Tier acc 0.6875, precision 0.7706766917293232, recall 0.6241414141414141, F1 0.5502338332527011, AUC 0.7554040404040404
  First-Tier acc 0.5510204081632653, precision 0.7021895737960894, recall 0.4597663139329806, F1 0.4270430040381333, AUC 0.6882578262786595
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5670194003527337, F1 0.5623931623931624, AUC 0.6957120811287477
epoch: 8 idx: 0 First Loss : 2.562310218811035, Second Loss : 2.5127646923065186
epoch: 8 idx: 200 First Loss : 0.9744249423270794, Second Loss : 0.9840104868867208
  First-Tier acc 0.5729166666666666, precision 0.4994860725665536, recall 0.5351010101010101, F1 0.45132179280730006, AUC 0.7395896464646464
  Second-Tier acc 0.7083333333333334, precision 0.782051282051282, recall 0.6519191919191919, F1 0.5978735580253606, AUC 0.7555555555555555
  First-Tier acc 0.5510204081632653, precision 0.6011253592214253, recall 0.46836419753086417, F1 0.42980565067719584, AUC 0.6906380897266313
  Second-Tier acc 0.5918367346938775, precision 0.5652173913043478, recall 0.5784832451499118, F1 0.5675, AUC 0.6990740740740741
epoch: 9 idx: 0 First Loss : 2.6113369464874268, Second Loss : 2.561922550201416
epoch: 9 idx: 200 First Loss : 0.9564436046564164, Second Loss : 0.9636945109165723
  First-Tier acc 0.5625, precision 0.5513177754557065, recall 0.5320454545454546, F1 0.45305239422886484, AUC 0.7387689393939394
  Second-Tier acc 0.6666666666666666, precision 0.7648484848484848, recall 0.6108080808080808, F1 0.5333022533022533, AUC 0.7568686868686868
  First-Tier acc 0.5510204081632653, precision 0.7127540924626731, recall 0.46836419753086417, F1 0.4299834677158663, AUC 0.6903521825396824
  Second-Tier acc 0.5510204081632653, precision 0.4963924963924964, recall 0.49514991181657847, F1 0.48435374149659854, AUC 0.7006723985890652