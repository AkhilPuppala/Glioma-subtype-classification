{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_25", "train_show_freq": 200, "droprate": 0.3416421892904149, "droprate_2": 0.0, "lr": 2.4377293984909777e-05, "weight_decay": 0.00017252199726801627, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_25", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.4377293984909777e-05
epoch: 0 idx: 0 First Loss : 1.2265733480453491, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1137860768766545, Second Loss : 1.094950509605123
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.70679012345679
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7544444444444446
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.650867136978248
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6500771604938271
Test AUC: 0.6501, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.4377293984909777e-05
epoch: 1 idx: 0 First Loss : 2.12528395652771, Second Loss : 2.0902698040008545
epoch: 1 idx: 200 First Loss : 1.0959920697840886, Second Loss : 1.0837608415689042
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.732682379349046
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7637373737373738
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6982657260435038
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7058531746031745
Test AUC: 0.7059, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4377293984909777e-05
epoch: 2 idx: 0 First Loss : 2.225128173828125, Second Loss : 2.2108500003814697
epoch: 2 idx: 200 First Loss : 1.0645352243932324, Second Loss : 1.0526940104231906
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7402749719416386
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7523232323232323
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7131405545757398
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118606701940035
Test AUC: 0.7059, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4377293984909777e-05
epoch: 3 idx: 0 First Loss : 2.4148614406585693, Second Loss : 2.3674304485321045
epoch: 3 idx: 200 First Loss : 1.0350845333059036, Second Loss : 1.0247657220829185
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.5779829545454546, recall 0.40188552188552196, F1 0.36665030146900635, AUC 0.7352300785634118
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7533333333333333
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6054421768707483, precision 0.4222222222222222, recall 0.4444444444444444, F1 0.39814814814814814, AUC 0.7055776014109347
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7091600529100529
Test AUC: 0.7059, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4377293984909777e-05
epoch: 4 idx: 0 First Loss : 2.6204707622528076, Second Loss : 2.5773513317108154
epoch: 4 idx: 200 First Loss : 1.0022258597301013, Second Loss : 0.996023459406338
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5833333333333334, precision 0.5164950711938664, recall 0.48828282828282826, F1 0.4726764257232317, AUC 0.7301907968574636
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7456565656565656
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5034013605442177, precision 0.41709956709956714, recall 0.4702380952380952, F1 0.416746677261173, AUC 0.7020380168528316
  Second-Tier acc 0.5714285714285714, precision 0.5178947368421053, recall 0.5074955908289241, F1 0.5023310023310023, AUC 0.7099316578483245
Test AUC: 0.7059, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4377293984909777e-05
epoch: 5 idx: 0 First Loss : 2.8721659183502197, Second Loss : 2.8441622257232666
epoch: 5 idx: 200 First Loss : 0.9739694033763302, Second Loss : 0.9715626142288915
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5277777777777778, precision 0.518303499435575, recall 0.5008754208754209, F1 0.46016479150775486, AUC 0.731705948372615
  Second-Tier acc 0.5833333333333334, precision 0.5875, recall 0.6127272727272728, F1 0.5715971675845791, AUC 0.7527777777777778
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.469873859366613, recall 0.5040417401528513, F1 0.4295789435574382, AUC 0.7072126690182245
  Second-Tier acc 0.6122448979591837, precision 0.6118917202508533, recall 0.6787918871252204, F1 0.616161616161616, AUC 0.7256944444444443
Test AUC: 0.7059, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4377293984909777e-05
epoch: 6 idx: 0 First Loss : 3.1384592056274414, Second Loss : 3.107405662536621
epoch: 6 idx: 200 First Loss : 0.9551580034529985, Second Loss : 0.9550586614424168
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4513888888888889, precision 0.491468253968254, recall 0.4664309764309764, F1 0.40399150498818276, AUC 0.7360998877665544
  Second-Tier acc 0.5, precision 0.5631578947368421, recall 0.5543434343434344, F1 0.4990271377368152, AUC 0.7731313131313131
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.4844308943089431, recall 0.5127865961199295, F1 0.4097352004983658, AUC 0.7146653929061336
  Second-Tier acc 0.4897959183673469, precision 0.5164721759149004, recall 0.58179012345679, F1 0.49474747474747477, AUC 0.7589285714285715
Test AUC: 0.7589, Test F1: 0.4947 (Best Epoch: 6)
Current LR: 2.4377293984909777e-05
epoch: 7 idx: 0 First Loss : 3.345759153366089, Second Loss : 3.305873394012451
epoch: 7 idx: 200 First Loss : 0.9428291835159582, Second Loss : 0.9448555335773164
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.48297035692679974, recall 0.4579124579124579, F1 0.3859993647909534, AUC 0.7412345679012345
  Second-Tier acc 0.5208333333333334, precision 0.5866471734892788, recall 0.5990909090909091, F1 0.522140522875817, AUC 0.7923232323232323
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.40816326530612246, precision 0.476846409404549, recall 0.49632569077013516, F1 0.388235294117647, AUC 0.7249473349010387
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7646604938271606
Test AUC: 0.7647, Test F1: 0.5178 (Best Epoch: 7)
Current LR: 2.4377293984909777e-05
epoch: 8 idx: 0 First Loss : 3.4988081455230713, Second Loss : 3.4658610820770264
epoch: 8 idx: 200 First Loss : 0.9351366800557247, Second Loss : 0.9386276087227894
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.4505716963448922, recall 0.43003367003367005, F1 0.34888585099111413, AUC 0.7449214365881033
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.8003535353535353
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.5141430354913501, recall 0.49985302763080536, F1 0.39066676890416435, AUC 0.731738683127572
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.7746362433862434
Test AUC: 0.7746, Test F1: 0.5109 (Best Epoch: 8)
Current LR: 2.4377293984909777e-05
epoch: 9 idx: 0 First Loss : 3.6081228256225586, Second Loss : 3.5710041522979736
epoch: 9 idx: 200 First Loss : 0.9291214061488596, Second Loss : 0.9344122360057351
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3611111111111111, precision 0.4437284937284937, recall 0.40383838383838383, F1 0.3272836110797155, AUC 0.7516835016835016
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.801010101010101
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3945578231292517, precision 0.5163824289405684, recall 0.4995590828924162, F1 0.386840832123851, AUC 0.738940329218107
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7827932098765432
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 10 idx: 0 First Loss : 3.68674373626709, Second Loss : 3.6423614025115967
epoch: 10 idx: 200 First Loss : 0.9244924509453017, Second Loss : 0.9309610718773187
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.5028083028083028, recall 0.478989898989899, F1 0.40300269905533065, AUC 0.7567115600448933
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7967171717171717
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.5457657657657659, recall 0.5351263962375074, F1 0.4202841671785771, AUC 0.7467849794238685
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7941468253968255
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 11 idx: 0 First Loss : 3.746439218521118, Second Loss : 3.6878135204315186
epoch: 11 idx: 200 First Loss : 0.919868807946633, Second Loss : 0.9281571831285435
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.4965206577048682, recall 0.47094276094276094, F1 0.39156250750635574, AUC 0.753658810325477
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7886363636363636
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.562420544113908, recall 0.558641975308642, F1 0.43637513656488985, AUC 0.7483343131491279
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.7927138447971781
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 12 idx: 0 First Loss : 3.735886335372925, Second Loss : 3.6853885650634766
epoch: 12 idx: 200 First Loss : 0.9151569941898909, Second Loss : 0.9243550696665078
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.507627765064836, recall 0.48838383838383836, F1 0.40488137907492744, AUC 0.7516217732884399
  Second-Tier acc 0.4166666666666667, precision 0.5122100122100122, recall 0.4916161616161616, F1 0.41061895228561895, AUC 0.7811616161616163
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5718369062631358, recall 0.5745149911816578, F1 0.4509162233672786, AUC 0.7559095140113659
  Second-Tier acc 0.4897959183673469, precision 0.5854700854700855, recall 0.5690035273368607, F1 0.4806418219461697, AUC 0.7933201058201057
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 13 idx: 0 First Loss : 3.736375093460083, Second Loss : 3.681297779083252
epoch: 13 idx: 200 First Loss : 0.9107418583772048, Second Loss : 0.92123200098604
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.49535347637814436, recall 0.46794612794612794, F1 0.3871635610766046, AUC 0.7488103254769922
  Second-Tier acc 0.375, precision 0.46978021978021983, recall 0.43606060606060604, F1 0.3588461538461538, AUC 0.7709090909090909
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.5696924603174603, recall 0.5644473838918284, F1 0.4434850627919935, AUC 0.7615189594356261
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7972332451499118
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 14 idx: 0 First Loss : 3.7131118774414062, Second Loss : 3.661353826522827
epoch: 14 idx: 200 First Loss : 0.9061999329752682, Second Loss : 0.918760044927667
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.4736714975845411, recall 0.4413804713804714, F1 0.35808823529411765, AUC 0.7408529741863076
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.75010101010101
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5724991854024112, recall 0.5682686654908877, F1 0.4437783519954062, AUC 0.7625722614148539
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7942570546737214
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 15 idx: 0 First Loss : 3.682469129562378, Second Loss : 3.6264331340789795
epoch: 15 idx: 200 First Loss : 0.9016901293166552, Second Loss : 0.916747890571503
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.47904351395730704, recall 0.4466666666666666, F1 0.3652924917126528, AUC 0.7304882154882155
  Second-Tier acc 0.375, precision 0.4682539682539682, recall 0.45303030303030306, F1 0.35539012958367794, AUC 0.7365151515151515
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5700483091787439, recall 0.5582010582010583, F1 0.43609843609843607, AUC 0.7630989124044679
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7851631393298061
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 16 idx: 0 First Loss : 3.6574676036834717, Second Loss : 3.5938987731933594
epoch: 16 idx: 200 First Loss : 0.8986092808992898, Second Loss : 0.9156364850463596
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.375, precision 0.48182261208577, recall 0.46326599326599327, F1 0.3694828469022018, AUC 0.7175533108866442
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.7185858585858586
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41496598639455784, precision 0.5652506697282816, recall 0.5458553791887125, F1 0.41300080747689244, AUC 0.759338869292573
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7808641975308642
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 17 idx: 0 First Loss : 3.6233766078948975, Second Loss : 3.553802967071533
epoch: 17 idx: 200 First Loss : 0.8958522863770066, Second Loss : 0.9156830345210387
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.4638030888030888, recall 0.44030303030303036, F1 0.34685589579462084, AUC 0.7055611672278338
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7049494949494949
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.5688172043010752, recall 0.5478395061728395, F1 0.41812015503875966, AUC 0.7541091024887322
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7778880070546736
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 18 idx: 0 First Loss : 3.5933468341827393, Second Loss : 3.517789602279663
epoch: 18 idx: 200 First Loss : 0.8939752128426697, Second Loss : 0.9162622068713845
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.4625091889242832, recall 0.4411447811447811, F1 0.3448416751787538, AUC 0.6962850729517397
  Second-Tier acc 0.3333333333333333, precision 0.42974910394265237, recall 0.41191919191919196, F1 0.30317460317460315, AUC 0.6945959595959595
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.562962962962963, recall 0.5339506172839507, F1 0.41076649958228906, AUC 0.7496325690770135
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7748015873015873
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)
Current LR: 2.4377293984909777e-05
epoch: 19 idx: 0 First Loss : 3.570180654525757, Second Loss : 3.4922420978546143
epoch: 19 idx: 200 First Loss : 0.8925352722195855, Second Loss : 0.916972873127783
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.463112671228829, recall 0.4411447811447811, F1 0.3444386019938132, AUC 0.6904320987654321
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6854545454545454
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5745614035087719, recall 0.5536449147560258, F1 0.42153500512108893, AUC 0.746239956888105
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7755180776014109
Test AUC: 0.7828, Test F1: 0.4905 (Best Epoch: 9)