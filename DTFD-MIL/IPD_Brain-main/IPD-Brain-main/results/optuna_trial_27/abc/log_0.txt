{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_27", "train_show_freq": 200, "droprate": 0.34883733118052473, "droprate_2": 0.0, "lr": 4.0194373004670555e-05, "weight_decay": 5.673511774035617e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_27", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 4.0194373004670555e-05
epoch: 0 idx: 0 First Loss : 1.2249430418014526, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1300834524097727, Second Loss : 1.1144374210146528
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7252525252525253
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7578282828282829
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6814373897707231
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.670138888888889
Test AUC: 0.6701, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.0194373004670555e-05
epoch: 1 idx: 0 First Loss : 2.1611058712005615, Second Loss : 2.13486647605896
epoch: 1 idx: 200 First Loss : 1.0650228256387497, Second Loss : 1.0608008997653848
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7389113355780023
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7608585858585858
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7119464040760337
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7059634038800705
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.0194373004670555e-05
epoch: 2 idx: 0 First Loss : 2.3150360584259033, Second Loss : 2.298535108566284
epoch: 2 idx: 200 First Loss : 1.0191207412834191, Second Loss : 1.0163981545327314
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5763888888888888, precision 0.5557422969187675, recall 0.4260606060606061, F1 0.404958877600387, AUC 0.7335578002244669
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7532323232323233
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6190476190476191, precision 0.42081447963800905, recall 0.4819958847736625, F1 0.43162640157207255, AUC 0.6954671271800902
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7038690476190476
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.0194373004670555e-05
epoch: 3 idx: 0 First Loss : 2.6161324977874756, Second Loss : 2.6300604343414307
epoch: 3 idx: 200 First Loss : 0.9756411742511674, Second Loss : 0.9786352122675127
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5486111111111112, precision 0.5577644105372979, recall 0.4997643097643098, F1 0.47014030964814263, AUC 0.7234343434343434
  Second-Tier acc 0.6458333333333334, precision 0.5972222222222222, recall 0.6093939393939394, F1 0.5765110641957932, AUC 0.7431818181818182
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4965986394557823, precision 0.45968156137647664, recall 0.49713403880070545, F1 0.43756659290222116, AUC 0.6951425631981186
  Second-Tier acc 0.6530612244897959, precision 0.6313131313131314, recall 0.6677689594356261, F1 0.6429321728691476, AUC 0.7093805114638446
Test AUC: 0.7060, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 4.0194373004670555e-05
epoch: 4 idx: 0 First Loss : 3.0104920864105225, Second Loss : 3.031982660293579
epoch: 4 idx: 200 First Loss : 0.9440987919322887, Second Loss : 0.9538359397568217
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4722222222222222, precision 0.49280303030303024, recall 0.47494949494949495, F1 0.42062188129108585, AUC 0.7271492704826038
  Second-Tier acc 0.5, precision 0.5599747474747475, recall 0.5398989898989899, F1 0.4976851851851852, AUC 0.7614141414141414
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4557823129251701, precision 0.5036939150863201, recall 0.5327748383303939, F1 0.4345198020798027, AUC 0.7113340192043897
  Second-Tier acc 0.5714285714285714, precision 0.574537037037037, recall 0.642636684303351, F1 0.5711156049882036, AUC 0.7487323633156966
Test AUC: 0.7487, Test F1: 0.5711 (Best Epoch: 4)
Current LR: 4.0194373004670555e-05
epoch: 5 idx: 0 First Loss : 3.354599714279175, Second Loss : 3.391669273376465
epoch: 5 idx: 200 First Loss : 0.9289056252854974, Second Loss : 0.9433691851627916
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4444444444444444, precision 0.49882232462877624, recall 0.47245791245791247, F1 0.4045281161560232, AUC 0.7328843995510662
  Second-Tier acc 0.5208333333333334, precision 0.5838468720821662, recall 0.5846464646464646, F1 0.5220032840722496, AUC 0.7794949494949495
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4217687074829932, precision 0.49202418969161227, recall 0.5121987066431511, F1 0.40693734290776556, AUC 0.7251004311189497
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7631723985890652
Test AUC: 0.7632, Test F1: 0.4984 (Best Epoch: 5)
Current LR: 4.0194373004670555e-05
epoch: 6 idx: 0 First Loss : 3.5951268672943115, Second Loss : 3.6605892181396484
epoch: 6 idx: 200 First Loss : 0.922651098985503, Second Loss : 0.9391653404260675
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3958333333333333, precision 0.4577020202020203, recall 0.43653198653198655, F1 0.36288526288526285, AUC 0.7315993265993265
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5605050505050505, F1 0.4795093795093795, AUC 0.790050505050505
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.41496598639455784, precision 0.49310035842293914, recall 0.5119047619047619, F1 0.40430402930402937, AUC 0.7269743288261807
  Second-Tier acc 0.5306122448979592, precision 0.5907608695652175, recall 0.6408730158730159, F1 0.5367867867867869, AUC 0.7679673721340388
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 7 idx: 0 First Loss : 3.7466166019439697, Second Loss : 3.838258981704712
epoch: 7 idx: 200 First Loss : 0.917678379592722, Second Loss : 0.9388148959665861
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.47623851472956336, recall 0.44663299663299666, F1 0.37448617008187873, AUC 0.7349438832772166
  Second-Tier acc 0.4583333333333333, precision 0.549908424908425, recall 0.5327272727272727, F1 0.45742245742245746, AUC 0.7895959595959595
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.5312529550827424, recall 0.5313051146384479, F1 0.4189417316404809, AUC 0.7394057417205566
  Second-Tier acc 0.5102040816326531, precision 0.5934065934065934, recall 0.5813492063492064, F1 0.5015151515151516, AUC 0.7900683421516755
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 8 idx: 0 First Loss : 3.8093459606170654, Second Loss : 3.8956451416015625
epoch: 8 idx: 200 First Loss : 0.9118430684552301, Second Loss : 0.9363697986906181
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4097222222222222, precision 0.49354561101549055, recall 0.46804713804713804, F1 0.3899936687003569, AUC 0.7393490460157125
  Second-Tier acc 0.4166666666666667, precision 0.5099206349206349, recall 0.47717171717171714, F1 0.40637140637140634, AUC 0.7821212121212121
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.5437631027253669, recall 0.5250587889476778, F1 0.41454394481349005, AUC 0.7490201842053694
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.8032958553791887
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 9 idx: 0 First Loss : 3.8321964740753174, Second Loss : 3.9316976070404053
epoch: 9 idx: 200 First Loss : 0.905912094655683, Second Loss : 0.9335342298391558
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4305555555555556, precision 0.5190789473684211, recall 0.5048484848484849, F1 0.42132646430892046, AUC 0.7417789001122334
  Second-Tier acc 0.3958333333333333, precision 0.48214285714285715, recall 0.4493939393939394, F1 0.3785936285936286, AUC 0.7713131313131313
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.5642477268828273, recall 0.5568048206937096, F1 0.442907642519293, AUC 0.7573057515187144
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7991622574955909
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 10 idx: 0 First Loss : 3.8390579223632812, Second Loss : 3.9164488315582275
epoch: 10 idx: 200 First Loss : 0.9004471866832119, Second Loss : 0.9312800924735033
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3958333333333333, precision 0.4969135802469136, recall 0.46902356902356895, F1 0.3906260728655982, AUC 0.7364702581369249
  Second-Tier acc 0.4166666666666667, precision 0.4975182863113898, recall 0.4796969696969697, F1 0.39503732981993855, AUC 0.7559595959595958
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.5810844892812106, recall 0.5784832451499118, F1 0.462341946124244, AUC 0.7613719870664316
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7920524691358025
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 11 idx: 0 First Loss : 3.8261003494262695, Second Loss : 3.8779096603393555
epoch: 11 idx: 200 First Loss : 0.8961158824061733, Second Loss : 0.9276786237209108
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.47840698468442105, recall 0.4376430976430976, F1 0.3657078966519454, AUC 0.7273063973063972
  Second-Tier acc 0.4166666666666667, precision 0.4787095088819227, recall 0.4822222222222223, F1 0.38271848924022844, AUC 0.7381818181818183
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.562067562067562, recall 0.5404908877131099, F1 0.4280237762738568, AUC 0.7618129041740153
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7837852733686067
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 12 idx: 0 First Loss : 3.8280155658721924, Second Loss : 3.869941234588623
epoch: 12 idx: 200 First Loss : 0.8917118571333782, Second Loss : 0.9259350714968768
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.4739972377840025, recall 0.4300673400673401, F1 0.35997959574830934, AUC 0.7122109988776656
  Second-Tier acc 0.3958333333333333, precision 0.46854256854256854, recall 0.4688888888888889, F1 0.36183280311063976, AUC 0.7244949494949496
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5692307692307692, recall 0.5540858318636097, F1 0.42745276205620336, AUC 0.7601288457769938
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7849426807760141
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 13 idx: 0 First Loss : 3.7912445068359375, Second Loss : 3.823892831802368
epoch: 13 idx: 200 First Loss : 0.8874502413919478, Second Loss : 0.9237763192785547
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.4684160797950576, recall 0.4216498316498316, F1 0.35296789801496214, AUC 0.6972053872053872
  Second-Tier acc 0.3958333333333333, precision 0.46854256854256854, recall 0.4688888888888889, F1 0.36183280311063976, AUC 0.693181818181818
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.5676767676767677, recall 0.5499706055261612, F1 0.42010755335738476, AUC 0.7579671271800902
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7851080246913581
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 14 idx: 0 First Loss : 3.7962429523468018, Second Loss : 3.8604674339294434
epoch: 14 idx: 200 First Loss : 0.886974130764972, Second Loss : 0.9243053993403064
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.45640900195694717, recall 0.41444444444444445, F1 0.33594932093701574, AUC 0.6874859708193042
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6804040404040403
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5662153750389044, recall 0.5440182245737801, F1 0.4191958691069961, AUC 0.7543540564373897
  Second-Tier acc 0.4897959183673469, precision 0.5913461538461539, recall 0.5804673721340388, F1 0.47614379084967323, AUC 0.7820767195767195
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 15 idx: 0 First Loss : 3.7356555461883545, Second Loss : 3.780644416809082
epoch: 15 idx: 200 First Loss : 0.8841473371077465, Second Loss : 0.9239933873884106
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3541666666666667, precision 0.4659259259259259, recall 0.43464646464646467, F1 0.3481481481481481, AUC 0.6819135802469137
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6799494949494949
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5640552995391704, recall 0.5399029982363316, F1 0.4121677740863787, AUC 0.7511390358612582
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7803130511463845
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 16 idx: 0 First Loss : 3.6974027156829834, Second Loss : 3.7402899265289307
epoch: 16 idx: 200 First Loss : 0.8815447214956972, Second Loss : 0.9225382417727398
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3680555555555556, precision 0.476636302294197, recall 0.4491919191919192, F1 0.3617796576512173, AUC 0.6788776655443322
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6717171717171717
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.57581310123683, recall 0.5595972957084068, F1 0.4232698489056042, AUC 0.7462277091906722
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7803130511463845
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 17 idx: 0 First Loss : 3.664602279663086, Second Loss : 3.684129476547241
epoch: 17 idx: 200 First Loss : 0.8785341947412741, Second Loss : 0.9211092033575229
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.47440476190476194, recall 0.4556902356902357, F1 0.3579848458557464, AUC 0.6811335578002243
  Second-Tier acc 0.3541666666666667, precision 0.45303776683087027, recall 0.4396969696969697, F1 0.33247863247863246, AUC 0.6736363636363635
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5745614035087719, recall 0.5536449147560258, F1 0.42153500512108893, AUC 0.7450029394473839
  Second-Tier acc 0.46938775510204084, precision 0.5856481481481481, recall 0.5681216931216931, F1 0.4552229613205223, AUC 0.7743055555555557
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 18 idx: 0 First Loss : 3.668625593185425, Second Loss : 3.6564996242523193
epoch: 18 idx: 200 First Loss : 0.8758294655880903, Second Loss : 0.9199345198068831
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.4785714285714285, recall 0.4657912457912458, F1 0.3638845508704957, AUC 0.6833445566778901
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.6832828282828283
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.5730519480519481, recall 0.5476925338036449, F1 0.4191839893852278, AUC 0.7428228493043308
  Second-Tier acc 0.46938775510204084, precision 0.5856481481481481, recall 0.5681216931216931, F1 0.4552229613205223, AUC 0.7740299823633157
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)
Current LR: 4.0194373004670555e-05
epoch: 19 idx: 0 First Loss : 3.6464264392852783, Second Loss : 3.626146078109741
epoch: 19 idx: 200 First Loss : 0.8731224034261741, Second Loss : 0.9175913021756412
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.48421488848704036, recall 0.4702356902356903, F1 0.37170868347338937, AUC 0.685645342312009
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.6858585858585858
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5670995670995671, recall 0.533803644914756, F1 0.41085065605189436, AUC 0.7388729668822261
  Second-Tier acc 0.46938775510204084, precision 0.5982905982905983, recall 0.5974426807760141, F1 0.4580128205128205, AUC 0.7593694885361552
Test AUC: 0.7680, Test F1: 0.5368 (Best Epoch: 6)