{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.28516688815245794, "droprate_2": 0.0, "lr": 0.00023720865386277925, "weight_decay": 2.3508948918591703e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00023720865386277925
epoch: 0 idx: 0 First Loss : 1.0454392433166504, Second Loss : 1.0700304508209229
epoch: 0 idx: 200 First Loss : 1.083390253285567, Second Loss : 1.0745159650397538
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4983052749719416
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4909090909090909
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45336076817558296
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45673500881834217
 
 test auc: 0.45673500881834217, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.31360776928906037, "droprate_2": 0.0, "lr": 0.00011467846158452143, "weight_decay": 2.1116794805453924e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00011467846158452143
epoch: 0 idx: 0 First Loss : 1.1133201122283936, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.0979567741354306, Second Loss : 1.1006725155447252
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48674242424242425
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47666666666666674
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44516093474426816
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44422398589065254
 
 test auc: 0.44422398589065254, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00011467846158452143
epoch: 1 idx: 0 First Loss : 1.623583436012268, Second Loss : 2.029820680618286
epoch: 1 idx: 200 First Loss : 0.9924996831820379, Second Loss : 1.0129318117947128
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2916666666666667, precision 0.3545787545787546, recall 0.393939393939394, F1 0.23789586688137412, AUC 0.4811868686868686
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.4838383838383839
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.47084435626102294
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46119929453262776
 
 test auc: 0.46119929453262776, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00011467846158452143
epoch: 2 idx: 0 First Loss : 1.9241993427276611, Second Loss : 2.3862698078155518
epoch: 2 idx: 200 First Loss : 0.9345589145573218, Second Loss : 0.9606389000048092
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2916666666666667, precision 0.29723362213102295, recall 0.3657575757575757, F1 0.2904707233065442, AUC 0.4960353535353536
  Second-Tier acc 0.22916666666666666, precision 0.15666666666666665, recall 0.32575757575757575, F1 0.21064814814814814, AUC 0.45363636363636367
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.35714285714285715, precision 0.3803418803418803, recall 0.40277777777777773, F1 0.38386918454323365, AUC 0.5085427689594356
  Second-Tier acc 0.3469387755102041, precision 0.3935064935064935, recall 0.373015873015873, F1 0.3786581299186342, AUC 0.5002755731922398
 
 test auc: 0.46119929453262776, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00011467846158452143
epoch: 3 idx: 0 First Loss : 2.471449375152588, Second Loss : 3.222468376159668
epoch: 3 idx: 200 First Loss : 0.9009856725880756, Second Loss : 0.9405852863333415
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3020833333333333, precision 0.3314814814814815, recall 0.39444444444444443, F1 0.24671357812360337, AUC 0.5033585858585858
  Second-Tier acc 0.20833333333333334, precision 0.125, recall 0.30050505050505055, F1 0.16099290780141842, AUC 0.4587373737373737
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.37755102040816324, precision 0.31181716833890744, recall 0.2953042328042328, F1 0.29727788551317963, AUC 0.5210124559082893
  Second-Tier acc 0.3877551020408163, precision 0.37481481481481477, recall 0.3862433862433862, F1 0.37967441618557235, AUC 0.5318562610229277
 
 test auc: 0.46119929453262776, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00011467846158452143
epoch: 4 idx: 0 First Loss : 2.9388320446014404, Second Loss : 3.8958051204681396
epoch: 4 idx: 200 First Loss : 0.886745643695418, Second Loss : 0.9391298021991454
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3333333333333333, precision 0.3606060606060606, recall 0.4059595959595959, F1 0.28257684344640865, AUC 0.5185984848484848
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.3744444444444444, F1 0.205519244734931, AUC 0.4619191919191919
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.35714285714285715, precision 0.24751486436269046, recall 0.2657627865961199, F1 0.2521387126096966, AUC 0.5356040564373897
  Second-Tier acc 0.3469387755102041, precision 0.1452991452991453, recall 0.20987654320987656, F1 0.1717171717171717, AUC 0.5650903880070547
 
 test auc: 0.46119929453262776, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00011467846158452143
epoch: 5 idx: 0 First Loss : 3.048316478729248, Second Loss : 4.119440078735352
epoch: 5 idx: 200 First Loss : 0.8796598568028163, Second Loss : 0.9347634891115258
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3645833333333333, precision 0.3977455716586151, recall 0.4259595959595959, F1 0.3118972530737237, AUC 0.571830808080808
  Second-Tier acc 0.3125, precision 0.3412698412698412, recall 0.3841414141414141, F1 0.26529790660225444, AUC 0.504090909090909
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3469387755102041, precision 0.19607843137254902, recall 0.2391975308641975, F1 0.2152674283821825, AUC 0.5188492063492064
  Second-Tier acc 0.3673469387755102, precision 0.26666666666666666, recall 0.3395061728395062, F1 0.2970760233918129, AUC 0.5601851851851852
 
 test auc: 0.5601851851851852, test F1: 0.2970760233918129  :  from epoch 5
 current learn rate 0.00011467846158452143
epoch: 6 idx: 0 First Loss : 3.0710506439208984, Second Loss : 4.007015705108643
epoch: 6 idx: 200 First Loss : 0.8736791643464651, Second Loss : 0.9326639912474614
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.46875, precision 0.47084367245657566, recall 0.5011111111111111, F1 0.40048036758563077, AUC 0.6308838383838384
  Second-Tier acc 0.2916666666666667, precision 0.4894308943089431, recall 0.3877777777777778, F1 0.22962404334953357, AUC 0.5887878787878787
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.32653061224489793, precision 0.19270833333333334, recall 0.24151234567901236, F1 0.21384180790960453, AUC 0.484416335978836
  Second-Tier acc 0.3673469387755102, precision 0.20870870870870872, recall 0.2515432098765432, F1 0.22470238095238093, AUC 0.5165343915343916
 
 test auc: 0.5165343915343916, test F1: 0.22470238095238093  :  from epoch 6
 current learn rate 0.00011467846158452143
epoch: 7 idx: 0 First Loss : 3.1012461185455322, Second Loss : 3.869323968887329
epoch: 7 idx: 200 First Loss : 0.8801473963189643, Second Loss : 0.9231423759486628
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4375, precision 0.478500355366027, recall 0.48111111111111104, F1 0.37547475866434565, AUC 0.6686363636363636
  Second-Tier acc 0.3125, precision 0.49166666666666664, recall 0.40111111111111114, F1 0.2544351073762839, AUC 0.6378787878787878
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3163265306122449, precision 0.17424242424242423, recall 0.22067901234567902, F1 0.19444444444444445, AUC 0.46396880511463845
  Second-Tier acc 0.3673469387755102, precision 0.2007722007722008, recall 0.2515432098765432, F1 0.22152777777777777, AUC 0.48947310405643735
 
 test auc: 0.48947310405643735, test F1: 0.22152777777777777  :  from epoch 7
 current learn rate 0.00011467846158452143
epoch: 8 idx: 0 First Loss : 3.3779146671295166, Second Loss : 3.8310110569000244
epoch: 8 idx: 200 First Loss : 0.8916837643303176, Second Loss : 0.920845313450618
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.5108154372860255, recall 0.4677777777777778, F1 0.35824310158200073, AUC 0.6719444444444443
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6542424242424243
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.35714285714285715, precision 0.18611111111111112, recall 0.24537037037037038, F1 0.21164021164021163, AUC 0.4593253968253968
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.46863977072310403
 
 test auc: 0.46863977072310403, test F1: 0.1791044776119403  :  from epoch 8
 current learn rate 0.00011467846158452143
epoch: 9 idx: 0 First Loss : 3.5270633697509766, Second Loss : 3.7962656021118164
epoch: 9 idx: 200 First Loss : 0.8954705382723058, Second Loss : 0.9201387794649539
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.5199999999999999, recall 0.45444444444444443, F1 0.33923693717508147, AUC 0.6832449494949495
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6648484848484849
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.18858447488584473, recall 0.2515432098765432, F1 0.21551472732575094, AUC 0.45515046296296297
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.46064814814814814
 
 test auc: 0.46064814814814814, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.00011467846158452143
epoch: 10 idx: 0 First Loss : 3.682929515838623, Second Loss : 3.818023443222046
epoch: 10 idx: 200 First Loss : 0.89816311196643, Second Loss : 0.9173847493314212
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4375, precision 0.5301869697718474, recall 0.48111111111111104, F1 0.3760635811126695, AUC 0.6796590909090909
  Second-Tier acc 0.3125, precision 0.5317460317460317, recall 0.40111111111111114, F1 0.2542377957472297, AUC 0.6678282828282828
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.19840783833435394, recall 0.2662037037037037, F1 0.22728205128205128, AUC 0.4503554894179895
  Second-Tier acc 0.3877551020408163, precision 0.2014652014652015, recall 0.2638888888888889, F1 0.22626262626262625, AUC 0.44394841269841273
 
 test auc: 0.44394841269841273, test F1: 0.22626262626262625  :  from epoch 10
 current learn rate 0.00011467846158452143
epoch: 11 idx: 0 First Loss : 3.9217443466186523, Second Loss : 3.917304515838623
epoch: 11 idx: 200 First Loss : 0.8977280409549958, Second Loss : 0.9140750430309328
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4270833333333333, precision 0.5133392950294359, recall 0.47444444444444445, F1 0.36738351254480284, AUC 0.6818308080808081
  Second-Tier acc 0.3125, precision 0.5317460317460317, recall 0.40111111111111114, F1 0.2542377957472297, AUC 0.6713636363636364
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.35714285714285715, precision 0.195689287238583, recall 0.26003086419753085, F1 0.2232982456140351, AUC 0.44166115520282184
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4416335978835979
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 12 idx: 0 First Loss : 3.8878748416900635, Second Loss : 3.827993392944336
epoch: 12 idx: 200 First Loss : 0.8920898202030102, Second Loss : 0.907486527939692
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3854166666666667, precision 0.5025396825396825, recall 0.4477777777777778, F1 0.3296301684957322, AUC 0.6739646464646465
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6645454545454546
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3877551020408163, precision 0.20551378446115287, recall 0.2638888888888889, F1 0.22905982905982905, AUC 0.4421847442680776
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.43716931216931215
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 13 idx: 0 First Loss : 3.8932442665100098, Second Loss : 3.805814027786255
epoch: 13 idx: 200 First Loss : 0.8814048635445327, Second Loss : 0.9000477595981289
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3229166666666667, precision 0.45856774496014996, recall 0.4077777777777778, F1 0.2660783319711281, AUC 0.6677398989898989
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.662070707070707
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3979591836734694, precision 0.19804526748971193, recall 0.25540123456790126, F1 0.21543209876543212, AUC 0.4364941578483245
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.43678350970017626
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 14 idx: 0 First Loss : 3.829150676727295, Second Loss : 3.8286449909210205
epoch: 14 idx: 200 First Loss : 0.8720837311004144, Second Loss : 0.8895891136366009
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.34375, precision 0.4693121693121693, recall 0.42111111111111105, F1 0.28855218855218856, AUC 0.6661111111111111
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6507070707070707
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35714285714285715, precision 0.19309309309309308, recall 0.24537037037037038, F1 0.21488575268817203, AUC 0.4348958333333333
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.4341931216931217
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 15 idx: 0 First Loss : 3.7841248512268066, Second Loss : 3.899043083190918
epoch: 15 idx: 200 First Loss : 0.864338955551427, Second Loss : 0.8765706973079169
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3020833333333333, precision 0.4423868312757202, recall 0.39444444444444443, F1 0.24232267193432241, AUC 0.6602272727272728
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6504545454545454
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.40816326530612246, precision 0.18883961566888396, recall 0.26157407407407407, F1 0.21586782861292664, AUC 0.4371417548500882
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4429563492063493
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 16 idx: 0 First Loss : 3.8325753211975098, Second Loss : 3.873969316482544
epoch: 16 idx: 200 First Loss : 0.8516128361904851, Second Loss : 0.8725267187417024
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.46438746438746437, recall 0.4144444444444444, F1 0.27746618729669575, AUC 0.6575126262626262
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6481818181818181
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3877551020408163, precision 0.20527670527670527, recall 0.2785493827160494, F1 0.23634572072072071, AUC 0.44500936948853614
  Second-Tier acc 0.42857142857142855, precision 0.2181571815718157, recall 0.28858024691358025, F1 0.24369747899159666, AUC 0.4476410934744268
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 17 idx: 0 First Loss : 3.8733904361724854, Second Loss : 4.013607025146484
epoch: 17 idx: 200 First Loss : 0.8390957423676013, Second Loss : 0.8685781580155736
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3854166666666667, precision 0.4977777777777778, recall 0.4477777777777778, F1 0.32898052691867125, AUC 0.655
  Second-Tier acc 0.375, precision 0.5131578947368421, recall 0.44111111111111106, F1 0.320358788676761, AUC 0.6458585858585859
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3877551020408163, precision 0.20555555555555557, recall 0.2785493827160494, F1 0.23643410852713176, AUC 0.44681437389770723
  Second-Tier acc 0.40816326530612246, precision 0.22456140350877193, recall 0.3055555555555555, F1 0.2586894586894587, AUC 0.45563271604938266
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 18 idx: 0 First Loss : 3.898813247680664, Second Loss : 4.181892395019531
epoch: 18 idx: 200 First Loss : 0.8385904335964505, Second Loss : 0.8674444419003516
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4479166666666667, precision 0.49437337123904285, recall 0.4877777777777777, F1 0.38486443002584797, AUC 0.6484090909090909
  Second-Tier acc 0.3958333333333333, precision 0.5157657657657658, recall 0.45444444444444443, F1 0.34027777777777773, AUC 0.6472727272727273
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.2057142857142857, recall 0.28086419753086417, F1 0.23708366115919222, AUC 0.4484540343915344
  Second-Tier acc 0.3673469387755102, precision 0.2037037037037037, recall 0.28086419753086417, F1 0.23597883597883595, AUC 0.45557760141093473
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11
 current learn rate 0.00011467846158452143
epoch: 19 idx: 0 First Loss : 4.027503490447998, Second Loss : 4.225550651550293
epoch: 19 idx: 200 First Loss : 0.8374992570018965, Second Loss : 0.8672804930914668
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4895833333333333, precision 0.5305982905982906, recall 0.5144444444444444, F1 0.41747126436781606, AUC 0.6498611111111111
  Second-Tier acc 0.3541666666666667, precision 0.5106837606837606, recall 0.42777777777777776, F1 0.29944444444444446, AUC 0.650909090909091
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3673469387755102, precision 0.21403692093347268, recall 0.29552469135802467, F1 0.24629629629629632, AUC 0.44051752645502645
  Second-Tier acc 0.40816326530612246, precision 0.22456140350877193, recall 0.3055555555555555, F1 0.2586894586894587, AUC 0.45888447971781304
 
 test auc: 0.4416335978835979, test F1: 0.18627450980392157  :  from epoch 11{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.49899567186622007, "droprate_2": 0.0, "lr": 1.0791398438723328e-05, "weight_decay": 6.133372985602381e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0791398438723328e-05
epoch: 0 idx: 0 First Loss : 1.2704240083694458, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0599707440653843, Second Loss : 1.0366598716126152
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6668742985409652
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410606060606061
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6058078581226729
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6001984126984127
Test AUC: 0.6002, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0791398438723328e-05
epoch: 1 idx: 0 First Loss : 1.9799190759658813, Second Loss : 1.927751064300537
epoch: 1 idx: 200 First Loss : 1.110263088597587, Second Loss : 1.0975758437048737
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7058866442199777
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7552020202020202
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6498505780913187
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6437389770723103
Test AUC: 0.6437, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0791398438723328e-05
epoch: 2 idx: 0 First Loss : 2.112769365310669, Second Loss : 2.110095500946045
epoch: 2 idx: 200 First Loss : 1.1049315017550738, Second Loss : 1.0947682742603975
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7232098765432099
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7570707070707071
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6800289045659417
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6828703703703703
Test AUC: 0.6829, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0791398438723328e-05
epoch: 3 idx: 0 First Loss : 2.163241147994995, Second Loss : 2.1668572425842285
epoch: 3 idx: 200 First Loss : 1.0918551868763728, Second Loss : 1.0841168009523134
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7345903479236813
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7628282828282829
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.699741573584166
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7022707231040565
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 4 idx: 0 First Loss : 2.212186574935913, Second Loss : 2.221571445465088
epoch: 4 idx: 200 First Loss : 1.0782923748466506, Second Loss : 1.0729910027031875
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.741391694725028
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7580808080808081
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7085721634332746
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7067350088183422
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 5 idx: 0 First Loss : 2.2723402976989746, Second Loss : 2.2845988273620605
epoch: 5 idx: 200 First Loss : 1.0656134137021962, Second Loss : 1.0620110135025054
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7418294051627384
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530808080808081
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7145122966882226
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138447971781305
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 6 idx: 0 First Loss : 2.336488723754883, Second Loss : 2.358031988143921
epoch: 6 idx: 200 First Loss : 1.0509319546729772, Second Loss : 1.0493366837279121
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5555555555555556, precision 0.513189448441247, recall 0.38383838383838387, F1 0.3213641580586981, AUC 0.7375925925925926
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7494444444444444
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.715626837154615
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7104828042328043
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 7 idx: 0 First Loss : 2.4089834690093994, Second Loss : 2.438142776489258
epoch: 7 idx: 200 First Loss : 1.0351481506999451, Second Loss : 1.0346775107567583
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5902777777777778, precision 0.40519298245614027, recall 0.44565656565656564, F1 0.3971794871794872, AUC 0.7363187429854096
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7484848484848484
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6054421768707483, precision 0.6444444444444445, recall 0.42658730158730157, F1 0.40277777777777773, AUC 0.7087252596511856
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7080026455026456
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 8 idx: 0 First Loss : 2.4891512393951416, Second Loss : 2.531576156616211
epoch: 8 idx: 200 First Loss : 1.0182620692090016, Second Loss : 1.0191894106529837
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.5797696592089115, recall 0.525993265993266, F1 0.48532578532578535, AUC 0.7343771043771045
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7512626262626262
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6258503401360545, precision 0.6476989118498553, recall 0.541740152851264, F1 0.5688925871992233, AUC 0.7035751028806585
  Second-Tier acc 0.5918367346938775, precision 0.5383064516129031, recall 0.46759259259259256, F1 0.4636015325670498, AUC 0.703097442680776
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 9 idx: 0 First Loss : 2.573352098464966, Second Loss : 2.6337456703186035
epoch: 9 idx: 200 First Loss : 1.0017073266208172, Second Loss : 1.0041479851809603
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6388888888888888, precision 0.5774293457220286, recall 0.5758249158249158, F1 0.5651716080814304, AUC 0.7306060606060606
  Second-Tier acc 0.6458333333333334, precision 0.41798941798941797, recall 0.583030303030303, F1 0.4775641025641026, AUC 0.7468181818181817
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.6122448979591837, precision 0.5759225650332729, recall 0.5972222222222222, F1 0.5846452750070102, AUC 0.7081557417205566
  Second-Tier acc 0.6122448979591837, precision 0.5543133195307108, recall 0.5551146384479718, F1 0.5387545787545788, AUC 0.7049713403880071
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 10 idx: 0 First Loss : 2.6603076457977295, Second Loss : 2.738720417022705
epoch: 10 idx: 200 First Loss : 0.9862333162507014, Second Loss : 0.9902933266440138
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6180555555555556, precision 0.5916808470410285, recall 0.608956228956229, F1 0.5938622166470268, AUC 0.7261672278338945
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7487878787878789
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5850340136054422, precision 0.5501675629335204, recall 0.5845825984714873, F1 0.5580298251518084, AUC 0.7109298451891045
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.7181988536155203
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 11 idx: 0 First Loss : 2.7418105602264404, Second Loss : 2.8463125228881836
epoch: 11 idx: 200 First Loss : 0.9729604288398181, Second Loss : 0.9784905670664796
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5625, precision 0.5532212885154062, recall 0.5669023569023569, F1 0.5442875387702973, AUC 0.7271043771043771
  Second-Tier acc 0.5, precision 0.5636604774535808, recall 0.5330303030303031, F1 0.47076023391812866, AUC 0.7578282828282829
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5102040816326531, precision 0.499073756432247, recall 0.5457084068195179, F1 0.4901732694165877, AUC 0.7148184891240447
  Second-Tier acc 0.6122448979591837, precision 0.6150581444699091, recall 0.6609347442680776, F1 0.6131237183868763, AUC 0.728835978835979
Test AUC: 0.7023, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0791398438723328e-05
epoch: 12 idx: 0 First Loss : 2.814990997314453, Second Loss : 2.950829267501831
epoch: 12 idx: 200 First Loss : 0.9609399338933959, Second Loss : 0.9690629418068264
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4930555555555556, precision 0.5182881781242437, recall 0.515959595959596, F1 0.48195308640235385, AUC 0.7303984287317621
  Second-Tier acc 0.4791666666666667, precision 0.5630906768837803, recall 0.5341414141414141, F1 0.46507936507936504, AUC 0.7667171717171716
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.4983124841615407, recall 0.5387272192827748, F1 0.4693513832071175, AUC 0.7164596805800509
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7452601410934744
Test AUC: 0.7453, Test F1: 0.5841 (Best Epoch: 12)
Current LR: 1.0791398438723328e-05
epoch: 13 idx: 0 First Loss : 2.8782122135162354, Second Loss : 3.0463478565216064
epoch: 13 idx: 200 First Loss : 0.9505130910680661, Second Loss : 0.9607482121895943
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4444444444444444, precision 0.4880144730890999, recall 0.47269360269360267, F1 0.43237506829739836, AUC 0.7371043771043772
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.7790909090909092
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46938775510204084, precision 0.5018993352326685, recall 0.5384332745443857, F1 0.46517094017094013, AUC 0.723244904957868
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.751984126984127
Test AUC: 0.7520, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0791398438723328e-05
epoch: 14 idx: 0 First Loss : 2.9360992908477783, Second Loss : 3.1316325664520264
epoch: 14 idx: 200 First Loss : 0.9419388133912018, Second Loss : 0.953735430799054
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4513888888888889, precision 0.5119078445758347, recall 0.49242424242424243, F1 0.4416666666666667, AUC 0.7422615039281707
  Second-Tier acc 0.4583333333333333, precision 0.5308641975308641, recall 0.5208080808080807, F1 0.4434124527003784, AUC 0.7916161616161617
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.5088426686127835, recall 0.5479129923574368, F1 0.4642735042735042, AUC 0.7252596511855772
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7580467372134039
Test AUC: 0.7580, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0791398438723328e-05
epoch: 15 idx: 0 First Loss : 2.985912561416626, Second Loss : 3.2098796367645264
epoch: 15 idx: 200 First Loss : 0.9349491918339065, Second Loss : 0.9481210126981732
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.504071947952545, recall 0.48474747474747476, F1 0.42456120312202544, AUC 0.7432098765432098
  Second-Tier acc 0.4583333333333333, precision 0.5389194139194139, recall 0.5352525252525252, F1 0.4497994497994498, AUC 0.8042929292929294
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5295454545454547, recall 0.5596707818930041, F1 0.47122301368178054, AUC 0.7313528806584362
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7705026455026456
Test AUC: 0.7705, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0791398438723328e-05
epoch: 16 idx: 0 First Loss : 3.023299217224121, Second Loss : 3.2747528553009033
epoch: 16 idx: 200 First Loss : 0.929177239120229, Second Loss : 0.9436327316775103
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5144500561167228, recall 0.48474747474747476, F1 0.4251644231360256, AUC 0.7436363636363637
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333332, recall 0.563030303030303, F1 0.47474747474747475, AUC 0.8094949494949494
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46938775510204084, precision 0.5501387878297895, recall 0.5673133450911229, F1 0.47106635766166854, AUC 0.7362887027238879
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.771494708994709
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0791398438723328e-05
epoch: 17 idx: 0 First Loss : 3.053884267807007, Second Loss : 3.3293778896331787
epoch: 17 idx: 200 First Loss : 0.9242251709807868, Second Loss : 0.9398169168572298
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.51673183447377, recall 0.48764309764309766, F1 0.422516018933901, AUC 0.7461447811447811
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8073232323232323
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46258503401360546, precision 0.5600359874044084, recall 0.5670194003527337, F1 0.46508516000473127, AUC 0.7392526455026456
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7707231040564375
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0791398438723328e-05
epoch: 18 idx: 0 First Loss : 3.072643280029297, Second Loss : 3.3723256587982178
epoch: 18 idx: 200 First Loss : 0.9195409432720782, Second Loss : 0.9363026460586348
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4166666666666667, precision 0.5176767676767677, recall 0.5001683501683502, F1 0.4158181275116759, AUC 0.7492873176206509
  Second-Tier acc 0.4166666666666667, precision 0.5158730158730159, recall 0.5085858585858586, F1 0.4066721808657292, AUC 0.8082828282828283
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4557823129251701, precision 0.5738496663154198, recall 0.5607730746619636, F1 0.45978612635429855, AUC 0.7410163139329806
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7742504409171076
Test AUC: 0.7715, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0791398438723328e-05
epoch: 19 idx: 0 First Loss : 3.0843417644500732, Second Loss : 3.4048051834106445
epoch: 19 idx: 200 First Loss : 0.9149445561525315, Second Loss : 0.9329488013699576
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5416666666666666, recall 0.5414141414141413, F1 0.44403481822836666, AUC 0.7521548821548821
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.8097474747474748
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4557823129251701, precision 0.577516339869281, recall 0.564594356261023, F1 0.4599899446958271, AUC 0.7442190868116795
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7786044973544973
Test AUC: 0.7786, Test F1: 0.4990 (Best Epoch: 19){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.32507502033393304, "droprate_2": 0.0, "lr": 1.0200423591280735e-05, "weight_decay": 2.8294747671635806e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0200423591280735e-05
epoch: 0 idx: 0 First Loss : 1.23357093334198, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.05388323421502, Second Loss : 1.036354931284539
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6626879910213244
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495454545454545
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6024336174799138
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6071428571428571
Test AUC: 0.6071, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0200423591280735e-05
epoch: 1 idx: 0 First Loss : 1.9535399675369263, Second Loss : 1.9116339683532715
epoch: 1 idx: 200 First Loss : 1.1018538397936086, Second Loss : 1.0887064722491735
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.705662177328844
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7593434343434343
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6468988830099941
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6557539682539683
Test AUC: 0.6558, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0200423591280735e-05
epoch: 2 idx: 0 First Loss : 2.1046814918518066, Second Loss : 2.0792555809020996
epoch: 2 idx: 200 First Loss : 1.1019413251781938, Second Loss : 1.0870705737699917
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7214758698092032
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7624242424242423
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6760851459925535
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6928461199294532
Test AUC: 0.6928, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0200423591280735e-05
epoch: 3 idx: 0 First Loss : 2.1630101203918457, Second Loss : 2.141115427017212
epoch: 3 idx: 200 First Loss : 1.091946827831553, Second Loss : 1.0765466525483487
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7328787878787879
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7677777777777778
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932135508524397
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703042328042328
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 4 idx: 0 First Loss : 2.2357823848724365, Second Loss : 2.2063241004943848
epoch: 4 idx: 200 First Loss : 1.0818526821943064, Second Loss : 1.0659168849685299
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7415095398428732
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7044446893983931
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075066137566136
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 5 idx: 0 First Loss : 2.3062613010406494, Second Loss : 2.2766997814178467
epoch: 5 idx: 200 First Loss : 1.0712370573362309, Second Loss : 1.055799425241366
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408698092031424
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.751919191919192
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7122403488144228
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7128527336860669
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 6 idx: 0 First Loss : 2.388731002807617, Second Loss : 2.3512749671936035
epoch: 6 idx: 200 First Loss : 1.0592791355812727, Second Loss : 1.0442085722044332
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7395791245791244
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7514141414141413
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.713128306878307
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7106481481481483
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 7 idx: 0 First Loss : 2.4805710315704346, Second Loss : 2.4283409118652344
epoch: 7 idx: 200 First Loss : 1.0456227749141294, Second Loss : 1.0310009759827632
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.4014550264550265, recall 0.4254545454545455, F1 0.3781771415033675, AUC 0.7367845117845118
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7528282828282827
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6054421768707483, precision 0.6763071895424836, recall 0.42658730158730157, F1 0.4025122288677539, AUC 0.7074147560258671
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7110890652557318
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 8 idx: 0 First Loss : 2.580719232559204, Second Loss : 2.517754077911377
epoch: 8 idx: 200 First Loss : 1.0305747032832744, Second Loss : 1.016740679889176
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.5813988543864937, recall 0.5251515151515151, F1 0.49519230769230765, AUC 0.7372222222222221
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7565656565656566
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6394557823129252, precision 0.6577093397745571, recall 0.5597442680776014, F1 0.5831298331298331, AUC 0.7024299431706839
  Second-Tier acc 0.5714285714285714, precision 0.5187499999999999, recall 0.4437830687830688, F1 0.44188583674264564, AUC 0.7084986772486772
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 9 idx: 0 First Loss : 2.681899309158325, Second Loss : 2.615215539932251
epoch: 9 idx: 200 First Loss : 1.0137993306366366, Second Loss : 1.0015766910319008
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6597222222222222, precision 0.6072567783094098, recall 0.5931313131313131, F1 0.5898754051090319, AUC 0.7329236812570145
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7563636363636363
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.6122448979591837, precision 0.5733333333333334, recall 0.5972222222222222, F1 0.5826210826210826, AUC 0.7055531060160689
  Second-Tier acc 0.6122448979591837, precision 0.5543133195307108, recall 0.5551146384479718, F1 0.5387545787545788, AUC 0.7158840388007054
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 10 idx: 0 First Loss : 2.7938778400421143, Second Loss : 2.721890449523926
epoch: 10 idx: 200 First Loss : 0.9994980818337172, Second Loss : 0.9885150174892957
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6180555555555556, precision 0.585063085063085, recall 0.5984848484848485, F1 0.5876997398736529, AUC 0.7298877665544333
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.748030303030303
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5510204081632653, precision 0.5118215118215118, recall 0.5449000587889476, F1 0.5136550692106248, AUC 0.7064226925338036
  Second-Tier acc 0.6326530612244898, precision 0.6238095238095238, recall 0.6261022927689593, F1 0.6084318360914106, AUC 0.7246472663139331
Test AUC: 0.7030, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0200423591280735e-05
epoch: 11 idx: 0 First Loss : 2.9073755741119385, Second Loss : 2.8355789184570312
epoch: 11 idx: 200 First Loss : 0.9869462400860157, Second Loss : 0.9771089921728592
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5486111111111112, precision 0.5381542930562538, recall 0.5467003367003367, F1 0.5261904761904762, AUC 0.7302020202020202
  Second-Tier acc 0.5, precision 0.5636604774535808, recall 0.5330303030303031, F1 0.47076023391812866, AUC 0.7707575757575759
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5034013605442177, precision 0.49178776381109707, recall 0.53777189888301, F1 0.481627158326017, AUC 0.7090436997844405
  Second-Tier acc 0.6326530612244898, precision 0.6453611747729394, recall 0.7026014109347442, F1 0.6482114376851219, AUC 0.740079365079365
Test AUC: 0.7401, Test F1: 0.6482 (Best Epoch: 11)
Current LR: 1.0200423591280735e-05
epoch: 12 idx: 0 First Loss : 3.0153863430023193, Second Loss : 2.944664239883423
epoch: 12 idx: 200 First Loss : 0.9762075012688761, Second Loss : 0.967478112081316
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4930555555555556, precision 0.5244135488037927, recall 0.5199326599326599, F1 0.4805845761728114, AUC 0.7325589225589226
  Second-Tier acc 0.5, precision 0.5598204264870931, recall 0.5474747474747474, F1 0.48183590288853456, AUC 0.7837878787878787
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46258503401360546, precision 0.4849773242630386, recall 0.522854203409759, F1 0.45250528604187146, AUC 0.7155472271213011
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7551256613756614
Test AUC: 0.7551, Test F1: 0.5624 (Best Epoch: 12)
Current LR: 1.0200423591280735e-05
epoch: 13 idx: 0 First Loss : 3.111999750137329, Second Loss : 3.042837381362915
epoch: 13 idx: 200 First Loss : 0.9669117369406407, Second Loss : 0.9594741853519311
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4583333333333333, precision 0.5005653550429671, recall 0.4920538720538721, F1 0.4475055688647922, AUC 0.7363860830527497
  Second-Tier acc 0.4791666666666667, precision 0.5527065527065527, recall 0.5485858585858586, F1 0.4703762586115527, AUC 0.7953535353535353
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.48322649572649573, recall 0.5146237507348618, F1 0.4396825396825397, AUC 0.7193930041152262
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7615189594356262
Test AUC: 0.7615, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0200423591280735e-05
epoch: 14 idx: 0 First Loss : 3.191138505935669, Second Loss : 3.1359448432922363
epoch: 14 idx: 200 First Loss : 0.9601402861710212, Second Loss : 0.9537578745240077
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4513888888888889, precision 0.5139317778921485, recall 0.49326599326599324, F1 0.4437675373489829, AUC 0.7456734006734007
  Second-Tier acc 0.5, precision 0.5685185185185185, recall 0.5763636363636363, F1 0.49548708372237776, AUC 0.8010606060606061
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.4963924963924964, recall 0.52608759553204, F1 0.4467566076958975, AUC 0.7241083676268861
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7715498236331569
Test AUC: 0.7715, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0200423591280735e-05
epoch: 15 idx: 0 First Loss : 3.264308214187622, Second Loss : 3.2149133682250977
epoch: 15 idx: 200 First Loss : 0.9541737568467411, Second Loss : 0.9487697719573159
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4444444444444444, precision 0.5187566137566137, recall 0.5057912457912458, F1 0.44242499905421256, AUC 0.7478900112233445
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333332, recall 0.563030303030303, F1 0.47474747474747475, AUC 0.812020202020202
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5050505050505051, recall 0.5299088771310992, F1 0.4480674188276527, AUC 0.7282113462669019
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.773423721340388
Test AUC: 0.7734, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0200423591280735e-05
epoch: 16 idx: 0 First Loss : 3.3308804035186768, Second Loss : 3.283635377883911
epoch: 16 idx: 200 First Loss : 0.9492509082812278, Second Loss : 0.9446526367115367
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4583333333333333, precision 0.5436856028961292, recall 0.5268350168350168, F1 0.4595144998370804, AUC 0.7510213243546578
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8160101010101011
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4557823129251701, precision 0.5304042062662753, recall 0.545487948265726, F1 0.45759585000091335, AUC 0.7315059768763472
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7783840388007054
Test AUC: 0.7784, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0200423591280735e-05
epoch: 17 idx: 0 First Loss : 3.388360023498535, Second Loss : 3.343672513961792
epoch: 17 idx: 200 First Loss : 0.9450797369351509, Second Loss : 0.9411448377847152
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4583333333333333, precision 0.5477611940298507, recall 0.538989898989899, F1 0.4597417015973717, AUC 0.7531313131313131
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8150505050505051
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.48299319727891155, precision 0.5698377434977454, recall 0.5772339800117577, F1 0.484017398390487, AUC 0.737066431510876
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7767305996472663
Test AUC: 0.7784, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0200423591280735e-05
epoch: 18 idx: 0 First Loss : 3.4374444484710693, Second Loss : 3.3934085369110107
epoch: 18 idx: 200 First Loss : 0.9410459544620852, Second Loss : 0.9375963927853611
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4444444444444444, precision 0.5423307923307924, recall 0.5422558922558922, F1 0.4437630754332593, AUC 0.7571829405162739
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8140909090909091
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.48299319727891155, precision 0.5793267757553472, recall 0.588697824808936, F1 0.48621439443357256, AUC 0.7410836762688615
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7802579365079364
Test AUC: 0.7784, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0200423591280735e-05
epoch: 19 idx: 0 First Loss : 3.474353075027466, Second Loss : 3.433446168899536
epoch: 19 idx: 200 First Loss : 0.9369754446971587, Second Loss : 0.9342352963928411
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4583333333333333, precision 0.5561690157704163, recall 0.5632996632996633, F1 0.45685275664871466, AUC 0.759304152637486
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8162121212121213
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.47619047619047616, precision 0.593482905982906, recall 0.5884038800705467, F1 0.4798474945533769, AUC 0.7447579854987262
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7861552028218695
Test AUC: 0.7862, Test F1: 0.5263 (Best Epoch: 19){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.295375740992868, "droprate_2": 0.0, "lr": 0.0003098971767652929, "weight_decay": 0.0009715012209819378, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0003098971767652929
epoch: 0 idx: 0 First Loss : 1.156076431274414, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0899917597127198, Second Loss : 1.074144544997322
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7308473625140292
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7374747474747475
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6825886733294141
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6914131393298059
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 1 idx: 0 First Loss : 1.9645205736160278, Second Loss : 2.247185230255127
epoch: 1 idx: 200 First Loss : 0.9818783644123457, Second Loss : 0.9863294017552143
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7252413019079684
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7216666666666667
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7449539486576523
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7535273368606702
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 2 idx: 0 First Loss : 2.156179189682007, Second Loss : 2.077277898788452
epoch: 2 idx: 200 First Loss : 0.9466186558355146, Second Loss : 0.9537042394576974
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7216778900112234
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7302525252525252
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7536130707427003
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7572751322751324
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 3 idx: 0 First Loss : 2.630711317062378, Second Loss : 2.729905605316162
epoch: 3 idx: 200 First Loss : 0.9166577330498553, Second Loss : 0.9395447792068347
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5833333333333334, precision 0.4606971975393028, recall 0.42424242424242425, F1 0.3767482517482517, AUC 0.725050505050505
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7297474747474748
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.19424460431654678, recall 0.3333333333333333, F1 0.24545454545454545, AUC 0.754494904957868
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7578262786596119
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 4 idx: 0 First Loss : 3.8389148712158203, Second Loss : 3.8258111476898193
epoch: 4 idx: 200 First Loss : 0.9151890579893703, Second Loss : 0.9357412930772598
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5972222222222222, precision 0.407859649122807, recall 0.4501010101010101, F1 0.4005128205128205, AUC 0.7301515151515151
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7289393939393939
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5578231292517006, precision 0.22681704260651628, recall 0.3412698412698412, F1 0.26424121050289273, AUC 0.7459705075445816
  Second-Tier acc 0.5714285714285714, precision 0.27121212121212124, recall 0.35714285714285715, F1 0.288608846058809, AUC 0.7487874779541447
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 5 idx: 0 First Loss : 4.459195613861084, Second Loss : 4.4531989097595215
epoch: 5 idx: 200 First Loss : 0.9051090170657123, Second Loss : 0.9351354465768927
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4097222222222222, precision 0.36882336882336886, recall 0.4432323232323232, F1 0.3148148148148148, AUC 0.7314029180695846
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7321212121212121
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5238095238095238, precision 0.44117173668115245, recall 0.4735449735449735, F1 0.3826961248075389, AUC 0.7322898295120517
  Second-Tier acc 0.5510204081632653, precision 0.43856209150326797, recall 0.482363315696649, F1 0.40277777777777773, AUC 0.753968253968254
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 6 idx: 0 First Loss : 3.7461605072021484, Second Loss : 3.8224029541015625
epoch: 6 idx: 200 First Loss : 0.8833340987208674, Second Loss : 0.9193092507613703
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4236111111111111, precision 0.7218701996927802, recall 0.4625925925925925, F1 0.3395534767037695, AUC 0.6897530864197531
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.693939393939394
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5034013605442177, precision 0.566468253968254, recall 0.4709729570840682, F1 0.3909710959858452, AUC 0.6960856359004507
  Second-Tier acc 0.5306122448979592, precision 0.4594594594594595, recall 0.48148148148148145, F1 0.38813474107591756, AUC 0.7084435626102293
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 7 idx: 0 First Loss : 4.162866115570068, Second Loss : 3.9628453254699707
epoch: 7 idx: 200 First Loss : 0.8798813473425148, Second Loss : 0.9167119548789258
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.5041971916971917, recall 0.4540740740740741, F1 0.3352853511952181, AUC 0.6619584736251402
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6770202020202021
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46938775510204084, precision 0.4951201201201201, recall 0.44657554379776604, F1 0.3663790949611241, AUC 0.6899617871840095
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6945546737213403
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 8 idx: 0 First Loss : 3.6876468658447266, Second Loss : 3.9369325637817383
epoch: 8 idx: 200 First Loss : 0.8793289785430332, Second Loss : 0.9231508578563605
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.5018768768768769, recall 0.45444444444444443, F1 0.3386363636363636, AUC 0.6542648709315375
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6681313131313131
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.5356386732533521, recall 0.469944150499706, F1 0.3923022109952011, AUC 0.6860057809131882
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6862874779541447
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 9 idx: 0 First Loss : 3.672255516052246, Second Loss : 3.858628034591675
epoch: 9 idx: 200 First Loss : 0.873492201548116, Second Loss : 0.9146466895650356
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3680555555555556, precision 0.45465077788811653, recall 0.44148148148148153, F1 0.32023340708477704, AUC 0.6522671156004489
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.666010101010101
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4489795918367347, precision 0.5314906490649064, recall 0.4695032333921223, F1 0.3936574482690987, AUC 0.6806290417401528
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6811067019400352
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 10 idx: 0 First Loss : 3.6797306537628174, Second Loss : 3.8430256843566895
epoch: 10 idx: 200 First Loss : 0.8688872294129505, Second Loss : 0.9123097763169327
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3680555555555556, precision 0.45524869866975126, recall 0.4301683501683502, F1 0.32433642999336426, AUC 0.6503984287317621
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6631313131313131
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.5254125412541254, recall 0.45745149911816574, F1 0.3824382900013152, AUC 0.6801513815402704
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6878858024691358
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 11 idx: 0 First Loss : 3.860889434814453, Second Loss : 3.9623091220855713
epoch: 11 idx: 200 First Loss : 0.8662342778651742, Second Loss : 0.910037944230178
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.5964646464646464, recall 0.4274074074074074, F1 0.29634342265921215, AUC 0.6576936026936028
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6762121212121213
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.44623655913978494, recall 0.4156378600823045, F1 0.3006879001153127, AUC 0.6850137174211248
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.69945987654321
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 12 idx: 0 First Loss : 3.772810935974121, Second Loss : 4.026188373565674
epoch: 12 idx: 200 First Loss : 0.8588979994292911, Second Loss : 0.899282258509973
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3402777777777778, precision 0.4305555555555556, recall 0.4172053872053872, F1 0.30446442142748575, AUC 0.6593490460157126
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6756060606060607
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.5499999999999999, recall 0.48985890652557323, F1 0.37510301389215917, AUC 0.68985768175583
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6979717813051146
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 13 idx: 0 First Loss : 3.69348406791687, Second Loss : 3.8925631046295166
epoch: 13 idx: 200 First Loss : 0.8515161763719501, Second Loss : 0.8925535304166188
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.4359121336706726, recall 0.42164983164983166, F1 0.3114072374896666, AUC 0.6656172839506173
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6724242424242424
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5263888888888889, recall 0.4842004703115814, F1 0.3807971014492754, AUC 0.6939361650009799
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.7123015873015873
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0003098971767652929
epoch: 14 idx: 0 First Loss : 3.683319330215454, Second Loss : 3.827260732650757
epoch: 14 idx: 200 First Loss : 0.8648650170052589, Second Loss : 0.8929422004627455
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3263888888888889, precision 0.4182957393483709, recall 0.40831649831649836, F1 0.2908036938861634, AUC 0.6683557800224467
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.674090909090909
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.5584229390681004, recall 0.5052910052910052, F1 0.37026301663982825, AUC 0.6947016460905351
  Second-Tier acc 0.3469387755102041, precision 0.43703703703703706, recall 0.3703703703703704, F1 0.2248587570621469, AUC 0.7248677248677248
Test AUC: 0.6914, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.06291733722678818, "droprate_2": 0.0, "lr": 3.0001643167274897e-05, "weight_decay": 6.13306629668549e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.2543414070290755, "droprate_2": 0.0, "lr": 2.056379039082778e-05, "weight_decay": 5.4939842098760566e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.08419133255147651, "droprate_2": 0.0, "lr": 8.246951575578449e-05, "weight_decay": 0.00018343092227690824, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.22261588967639617, "droprate_2": 0.0, "lr": 2.2880354848990372e-05, "weight_decay": 0.0005383226314069194, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.18176119934934828, "droprate_2": 0.0, "lr": 1.1467444747272751e-05, "weight_decay": 7.18900117542663e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0765143632888794, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0631328969452511, Second Loss : 1.056724764073073
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7108743686868687
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.689949494949495
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6117277061287477
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6141975308641975
epoch: 1 idx: 0 First Loss : 1.8583447933197021, Second Loss : 1.887643575668335
epoch: 1 idx: 200 First Loss : 1.1041478632546182, Second Loss : 1.099528391488749
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7261458333333334
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7171717171717171
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6537560626102293
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6469907407407408
epoch: 2 idx: 0 First Loss : 1.9984036684036255, Second Loss : 2.020101547241211
epoch: 2 idx: 200 First Loss : 1.091997624333225, Second Loss : 1.0903665505683244
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410574494949494
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7328787878787879
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6785955412257495
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6792328042328042
epoch: 3 idx: 0 First Loss : 2.052137851715088, Second Loss : 2.077847957611084
epoch: 3 idx: 200 First Loss : 1.0774645554040796, Second Loss : 1.0795974858216386
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7451294191919192
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486868686868685
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6940241953262786
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6900903880070547
epoch: 4 idx: 0 First Loss : 2.119323492050171, Second Loss : 2.1496517658233643
epoch: 4 idx: 200 First Loss : 1.0638848964996006, Second Loss : 1.0690268069802231
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7429387626262626
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7504040404040403
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7015266754850088
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7019400352733687
epoch: 5 idx: 0 First Loss : 2.196274757385254, Second Loss : 2.2295496463775635
epoch: 5 idx: 200 First Loss : 1.0503369903757205, Second Loss : 1.0572776498263747
  First-Tier acc 0.5729166666666666, precision 0.45122410546139363, recall 0.41757575757575754, F1 0.37145362948459076, AUC 0.7405776515151515
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.7457070707070708
  First-Tier acc 0.5663265306122449, precision 0.29354838709677417, recall 0.3511904761904762, F1 0.2752009894867038, AUC 0.6985539296737212
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6951609347442681
epoch: 6 idx: 0 First Loss : 2.2855050563812256, Second Loss : 2.3259639739990234
epoch: 6 idx: 200 First Loss : 1.035181132937545, Second Loss : 1.0435031842977847
  First-Tier acc 0.6458333333333334, precision 0.7546226886556721, recall 0.5357323232323232, F1 0.47951625094482236, AUC 0.7405429292929293
  Second-Tier acc 0.5833333333333334, precision 0.5146520146520147, recall 0.4336363636363636, F1 0.4065452091767881, AUC 0.747171717171717
  First-Tier acc 0.5816326530612245, precision 0.5572203724256998, recall 0.4037698412698412, F1 0.38158254562748944, AUC 0.689215443121693
  Second-Tier acc 0.6530612244897959, precision 0.8093023255813954, recall 0.5238095238095238, F1 0.5067155067155067, AUC 0.6933972663139331
epoch: 7 idx: 0 First Loss : 2.400592565536499, Second Loss : 2.43569016456604
epoch: 7 idx: 200 First Loss : 1.019755642249513, Second Loss : 1.028456257276274
  First-Tier acc 0.6666666666666666, precision 0.6271206690561529, recall 0.5859848484848484, F1 0.5236615277392919, AUC 0.7401736111111111
  Second-Tier acc 0.6666666666666666, precision 0.6055555555555555, recall 0.5523232323232323, F1 0.5587766206961254, AUC 0.7508585858585858
  First-Tier acc 0.5561224489795918, precision 0.5469589991329121, recall 0.45778218694885364, F1 0.46442328042328046, AUC 0.6862530313051146
  Second-Tier acc 0.5306122448979592, precision 0.46428571428571436, recall 0.501984126984127, F1 0.4718050065876153, AUC 0.6902557319223984
epoch: 8 idx: 0 First Loss : 2.520430088043213, Second Loss : 2.552567720413208
epoch: 8 idx: 200 First Loss : 1.0034281171821242, Second Loss : 1.0114936580260594
  First-Tier acc 0.609375, precision 0.5691326530612245, recall 0.5722474747474747, F1 0.5199847941783425, AUC 0.7432607323232322
  Second-Tier acc 0.6666666666666666, precision 0.6062271062271063, recall 0.5812121212121212, F1 0.5848777078965758, AUC 0.7520202020202019
  First-Tier acc 0.5561224489795918, precision 0.5147100606999871, recall 0.49823633156966496, F1 0.4903624294487239, AUC 0.689535796957672
  Second-Tier acc 0.5102040816326531, precision 0.4624819624819625, recall 0.5011022927689593, F1 0.46733214497920383, AUC 0.7022707231040565
epoch: 9 idx: 0 First Loss : 2.636347770690918, Second Loss : 2.6685800552368164
epoch: 9 idx: 200 First Loss : 0.9895200771256466, Second Loss : 0.9965537216013937
  First-Tier acc 0.5833333333333334, precision 0.5627428127428127, recall 0.5778787878787879, F1 0.5322370378550154, AUC 0.7483207070707071
  Second-Tier acc 0.6041666666666666, precision 0.576858813700919, recall 0.5701010101010101, F1 0.5587706995398735, AUC 0.7594949494949496
  First-Tier acc 0.5357142857142857, precision 0.5214785214785215, recall 0.5152116402116402, F1 0.5020040448611877, AUC 0.6962494488536155
  Second-Tier acc 0.5918367346938775, precision 0.5663461538461538, recall 0.6320546737213404, F1 0.5695429472025216, AUC 0.7048059964726631{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.13946924107706987, "droprate_2": 0.0, "lr": 4.222303092318435e-05, "weight_decay": 9.348895110463827e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 12, "gamma": 0.7741570960455356, "T_max": 12, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0825029611587524, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1245054265308143, Second Loss : 1.1145479562715512
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7414141414141414
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7284848484848485
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6702284501763668
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.669973544973545
epoch: 1 idx: 0 First Loss : 2.0136568546295166, Second Loss : 2.0679101943969727
epoch: 1 idx: 200 First Loss : 1.0554831515793777, Second Loss : 1.0564335073108104
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7429356060606059
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.750151515151515
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033867945326279
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7021604938271605
epoch: 2 idx: 0 First Loss : 2.2060706615448, Second Loss : 2.2488625049591064
epoch: 2 idx: 200 First Loss : 1.0086587440982386, Second Loss : 1.0137595426087356
  First-Tier acc 0.65625, precision 0.6432098765432098, recall 0.5587373737373739, F1 0.5008579318252123, AUC 0.7412563131313131
  Second-Tier acc 0.625, precision 0.5185185185185185, recall 0.4992929292929293, F1 0.4734061930783242, AUC 0.748939393939394
  First-Tier acc 0.5867346938775511, precision 0.6344415924707896, recall 0.459104938271605, F1 0.4716495145066573, AUC 0.6853160824514992
  Second-Tier acc 0.6122448979591837, precision 0.596096096096096, recall 0.5220458553791887, F1 0.5300595238095238, AUC 0.6805555555555557
epoch: 3 idx: 0 First Loss : 2.5133485794067383, Second Loss : 2.547774076461792
epoch: 3 idx: 200 First Loss : 0.9736384672682676, Second Loss : 0.978272572345105
  First-Tier acc 0.6145833333333334, precision 0.5870112272551297, recall 0.601489898989899, F1 0.560928941363724, AUC 0.7474305555555555
  Second-Tier acc 0.625, precision 0.5918880837359098, recall 0.5859595959595959, F1 0.5833333333333334, AUC 0.748888888888889
  First-Tier acc 0.5867346938775511, precision 0.5728498074454428, recall 0.6018518518518519, F1 0.5777701830333409, AUC 0.697275958994709
  Second-Tier acc 0.5510204081632653, precision 0.5134865134865135, recall 0.548721340388007, F1 0.5192743764172335, AUC 0.7058531746031745
epoch: 4 idx: 0 First Loss : 2.7966837882995605, Second Loss : 2.8758225440979004
epoch: 4 idx: 200 First Loss : 0.9492592277626196, Second Loss : 0.9502957673252221
  First-Tier acc 0.5677083333333334, precision 0.5918862901541528, recall 0.612929292929293, F1 0.5629463830785569, AUC 0.760792297979798
  Second-Tier acc 0.5416666666666666, precision 0.5734343434343434, recall 0.5734343434343434, F1 0.5176085176085176, AUC 0.7655050505050505
  First-Tier acc 0.5357142857142857, precision 0.5432474629195941, recall 0.603505291005291, F1 0.5320644345228009, AUC 0.7131076388888888
  Second-Tier acc 0.4897959183673469, precision 0.4721444133208839, recall 0.5180776014109347, F1 0.4626455026455026, AUC 0.728615520282187
epoch: 5 idx: 0 First Loss : 2.9992237091064453, Second Loss : 3.0900168418884277
epoch: 5 idx: 200 First Loss : 0.9344824867332308, Second Loss : 0.9326424006539494
  First-Tier acc 0.4947916666666667, precision 0.5576962446705297, recall 0.5588636363636363, F1 0.49520509075615243, AUC 0.7702051767676767
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7881313131313131
  First-Tier acc 0.4744897959183674, precision 0.5145330859616574, recall 0.5594686948853616, F1 0.47121991817293335, AUC 0.7257943397266313
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7345679012345677
epoch: 6 idx: 0 First Loss : 3.087221384048462, Second Loss : 3.2108047008514404
epoch: 6 idx: 200 First Loss : 0.9259097168120134, Second Loss : 0.9211859232398556
  First-Tier acc 0.4583333333333333, precision 0.5370370370370371, recall 0.5410353535353535, F1 0.4590785132180481, AUC 0.7730871212121212
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.8030808080808081
  First-Tier acc 0.4744897959183674, precision 0.5290411403950267, recall 0.5753968253968255, F1 0.47491405853808183, AUC 0.728305500440917
  Second-Tier acc 0.42857142857142855, precision 0.4727272727272727, recall 0.5103615520282186, F1 0.41844974948423225, AUC 0.7330798059964727
epoch: 7 idx: 0 First Loss : 3.1159565448760986, Second Loss : 3.2508201599121094
epoch: 7 idx: 200 First Loss : 0.9202975710594461, Second Loss : 0.913732614780577
  First-Tier acc 0.4583333333333333, precision 0.547190410246265, recall 0.5478030303030303, F1 0.45646263747558846, AUC 0.7718750000000001
  Second-Tier acc 0.4791666666666667, precision 0.5491261722080137, recall 0.5504040404040405, F1 0.46998556998557, AUC 0.8013131313131314
  First-Tier acc 0.44387755102040816, precision 0.5272257551669316, recall 0.5390211640211641, F1 0.44456624442672804, AUC 0.7293113425925926
  Second-Tier acc 0.46938775510204084, precision 0.5394736842105263, recall 0.5694444444444444, F1 0.47225657029578594, AUC 0.7304343033509699
epoch: 8 idx: 0 First Loss : 3.1218466758728027, Second Loss : 3.245626926422119
epoch: 8 idx: 200 First Loss : 0.9141778562088214, Second Loss : 0.9058254448168758
  First-Tier acc 0.4166666666666667, precision 0.5247603121516166, recall 0.5037121212121213, F1 0.4113291404612159, AUC 0.7662941919191919
  Second-Tier acc 0.4791666666666667, precision 0.5788766788766789, recall 0.5749494949494949, F1 0.48469302635969297, AUC 0.7978787878787879
  First-Tier acc 0.45408163265306123, precision 0.5461004273504274, recall 0.544863315696649, F1 0.4558488612836438, AUC 0.7282951664462081
  Second-Tier acc 0.5102040816326531, precision 0.576268115942029, recall 0.6170634920634921, F1 0.5187687687687688, AUC 0.7375992063492064
epoch: 9 idx: 0 First Loss : 3.1117067337036133, Second Loss : 3.2465829849243164
epoch: 9 idx: 200 First Loss : 0.9069865159227035, Second Loss : 0.896887224663364
  First-Tier acc 0.390625, precision 0.508695652173913, recall 0.4781060606060606, F1 0.37501168115129424, AUC 0.7619665404040404
  Second-Tier acc 0.4375, precision 0.5750661375661376, recall 0.5219191919191919, F1 0.4387689184200812, AUC 0.7965151515151515
  First-Tier acc 0.44387755102040816, precision 0.5393640802767475, recall 0.5045745149911817, F1 0.43330107165965853, AUC 0.7276647927689593
  Second-Tier acc 0.5510204081632653, precision 0.6205128205128205, recall 0.6646825396825397, F1 0.5677177177177177, AUC 0.7385361552028219{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.24284888328212617, "droprate_2": 0.0, "lr": 1.0272292486977307e-05, "weight_decay": 0.00027232929747682245, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.109089732170105, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.061714594933524, Second Loss : 1.0552551193320336
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7032733585858585
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6912121212121211
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6063402502204586
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6119929453262786
epoch: 1 idx: 0 First Loss : 1.8431442975997925, Second Loss : 1.836410403251648
epoch: 1 idx: 200 First Loss : 1.100911881941468, Second Loss : 1.0955694317817688
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7191035353535353
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7168181818181818
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6431258267195767
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6392195767195767
epoch: 2 idx: 0 First Loss : 2.0336480140686035, Second Loss : 2.00601863861084
epoch: 2 idx: 200 First Loss : 1.0945760098411077, Second Loss : 1.092250762368316
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7342992424242425
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7295959595959597
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6694534005731921
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.67173721340388
epoch: 3 idx: 0 First Loss : 2.080012559890747, Second Loss : 2.0526418685913086
epoch: 3 idx: 200 First Loss : 1.081064074490201, Second Loss : 1.0823089985260324
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.742885101010101
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7465151515151516
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6876825672398589
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6876102292768959
epoch: 4 idx: 0 First Loss : 2.1356940269470215, Second Loss : 2.1085197925567627
epoch: 4 idx: 200 First Loss : 1.0680866790796393, Second Loss : 1.0733356621134933
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7421906565656565
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7508080808080808
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6990155147707231
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.697255291005291
epoch: 5 idx: 0 First Loss : 2.2029049396514893, Second Loss : 2.1716485023498535
epoch: 5 idx: 200 First Loss : 1.0557251565936785, Second Loss : 1.0643287069391256
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7424368686868688
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7473232323232324
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7039930555555557
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075617283950617
epoch: 6 idx: 0 First Loss : 2.2815439701080322, Second Loss : 2.243410587310791
epoch: 6 idx: 200 First Loss : 1.0427503009414791, Second Loss : 1.053044349844776
  First-Tier acc 0.578125, precision 0.4415686274509804, recall 0.4251515151515151, F1 0.379652260307998, AUC 0.7413162878787878
  Second-Tier acc 0.5625, precision 0.5185185185185185, recall 0.393939393939394, F1 0.3406593406593406, AUC 0.7466161616161616
  First-Tier acc 0.5663265306122449, precision 0.29354838709677417, recall 0.3511904761904762, F1 0.2752009894867038, AUC 0.7044064153439153
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7005070546737212
epoch: 7 idx: 0 First Loss : 2.3708536624908447, Second Loss : 2.3287601470947266
epoch: 7 idx: 200 First Loss : 1.029033102873546, Second Loss : 1.0400953398118564
  First-Tier acc 0.609375, precision 0.395640802092415, recall 0.47909090909090907, F1 0.4238198983297023, AUC 0.7401609848484849
  Second-Tier acc 0.625, precision 0.7000000000000001, recall 0.4942424242424242, F1 0.5044871794871795, AUC 0.7472222222222221
  First-Tier acc 0.6173469387755102, precision 0.6994810744810745, recall 0.42250881834215165, F1 0.3952307681644591, AUC 0.6987330522486772
  Second-Tier acc 0.6530612244897959, precision 0.8093023255813954, recall 0.5238095238095238, F1 0.5067155067155067, AUC 0.710703262786596
epoch: 8 idx: 0 First Loss : 2.47639799118042, Second Loss : 2.4232993125915527
epoch: 8 idx: 200 First Loss : 1.0150168823143142, Second Loss : 1.0269070355156762
  First-Tier acc 0.671875, precision 0.7626546681664791, recall 0.589949494949495, F1 0.5182197702663758, AUC 0.7396401515151515
  Second-Tier acc 0.6666666666666666, precision 0.6333333333333333, recall 0.5548484848484848, F1 0.562962962962963, AUC 0.7494949494949495
  First-Tier acc 0.576530612244898, precision 0.6297777777777779, recall 0.4599316578483245, F1 0.4655908739322501, AUC 0.6935488315696648
  Second-Tier acc 0.5918367346938775, precision 0.5, recall 0.5275573192239859, F1 0.4962962962962963, AUC 0.6991291887125218
epoch: 9 idx: 0 First Loss : 2.5761561393737793, Second Loss : 2.519117832183838
epoch: 9 idx: 200 First Loss : 0.9994199669628001, Second Loss : 1.0114979555654289
  First-Tier acc 0.6197916666666666, precision 0.5454001977420616, recall 0.5602272727272727, F1 0.49154704944178634, AUC 0.7397001262626262
  Second-Tier acc 0.6875, precision 0.6369047619047619, recall 0.6115151515151515, F1 0.6188348229063224, AUC 0.7561616161616161
  First-Tier acc 0.5714285714285714, precision 0.5276895090724878, recall 0.49570105820105814, F1 0.4859755903126545, AUC 0.6944444444444443
  Second-Tier acc 0.5510204081632653, precision 0.5044444444444445, recall 0.5372574955908289, F1 0.5128205128205129, AUC 0.7053571428571428{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_15", "train_show_freq": 200, "droprate": 0.14240051739517698, "droprate_2": 0.0, "lr": 2.059038273822739e-05, "weight_decay": 1.0025600014676077e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 5, "gamma": 0.6149459200002168, "T_max": 3, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_15", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0813251733779907, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0966957752680897, Second Loss : 1.089407703918011
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7212531565656567
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7084343434343433
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6398637290564374
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6370701058201057
epoch: 1 idx: 0 First Loss : 1.9775159358978271, Second Loss : 2.0061402320861816
epoch: 1 idx: 200 First Loss : 1.0977424919160443, Second Loss : 1.093738134301717
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7435921717171716
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399494949494949
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6827601410934744
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6785714285714285
epoch: 2 idx: 0 First Loss : 2.0819406509399414, Second Loss : 2.097583770751953
epoch: 2 idx: 200 First Loss : 1.0687250249569689, Second Loss : 1.0710137635469437
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7424558080808081
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7471212121212121
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7003038194444443
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6988536155202821
epoch: 3 idx: 0 First Loss : 2.2109837532043457, Second Loss : 2.224721670150757
epoch: 3 idx: 200 First Loss : 1.0429920934103614, Second Loss : 1.0485128671375674
  First-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7405934343434343
  Second-Tier acc 0.6041666666666666, precision 0.6673441734417344, recall 0.46646464646464647, F1 0.4646464646464647, AUC 0.7476262626262624
  First-Tier acc 0.5867346938775511, precision 0.3418574685300822, recall 0.3778659611992945, F1 0.32140350877192986, AUC 0.6886436287477954
  Second-Tier acc 0.6326530612244898, precision 0.8666666666666667, recall 0.48214285714285715, F1 0.4762626262626262, AUC 0.6922949735449736
epoch: 4 idx: 0 First Loss : 2.379967451095581, Second Loss : 2.3991127014160156
epoch: 4 idx: 200 First Loss : 1.0162579071388316, Second Loss : 1.023357534289953
  First-Tier acc 0.6614583333333334, precision 0.642850174895829, recall 0.5862626262626262, F1 0.5274772489384362, AUC 0.7415025252525252
  Second-Tier acc 0.7083333333333334, precision 0.6984848484848486, recall 0.6078787878787879, F1 0.6212814645308925, AUC 0.7528282828282827
  First-Tier acc 0.5561224489795918, precision 0.5441889290512001, recall 0.4679783950617284, F1 0.4762699859967113, AUC 0.6832837301587302
  Second-Tier acc 0.5306122448979592, precision 0.46749084249084244, recall 0.501984126984127, F1 0.46782106782106786, AUC 0.6857914462081128
epoch: 5 idx: 0 First Loss : 2.580678701400757, Second Loss : 2.6058907508850098
epoch: 5 idx: 200 First Loss : 0.9924843999283823, Second Loss : 0.9998291918813292
  First-Tier acc 0.5989583333333334, precision 0.5736434108527132, recall 0.5806565656565656, F1 0.5330543797336966, AUC 0.7475220959595958
  Second-Tier acc 0.625, precision 0.7391304347826088, recall 0.563939393939394, F1 0.5378815628815629, AUC 0.7589393939393939
  First-Tier acc 0.5561224489795918, precision 0.5337129054520359, recall 0.5112985008818343, F1 0.5018335643335643, AUC 0.6924189814814814
  Second-Tier acc 0.5102040816326531, precision 0.4600713012477719, recall 0.5189594356261024, F1 0.4610204081632652, AUC 0.7017746913580246
epoch: 6 idx: 0 First Loss : 2.6255059242248535, Second Loss : 2.652219533920288
epoch: 6 idx: 200 First Loss : 0.9754595424220041, Second Loss : 0.9810517041466722
  First-Tier acc 0.5572916666666666, precision 0.5566785706264178, recall 0.5654545454545454, F1 0.5132860520094563, AUC 0.7542487373737373
  Second-Tier acc 0.5625, precision 0.5608024691358025, recall 0.5528282828282829, F1 0.4990097977902856, AUC 0.76010101010101
  First-Tier acc 0.5306122448979592, precision 0.5347156353795891, recall 0.5251873897707231, F1 0.50620201940013, AUC 0.7002693727954146
  Second-Tier acc 0.5306122448979592, precision 0.507177033492823, recall 0.5720899470899471, F1 0.4968974771873323, AUC 0.7175925925925926
epoch: 7 idx: 0 First Loss : 2.7545323371887207, Second Loss : 2.7925703525543213
epoch: 7 idx: 200 First Loss : 0.9665687999766858, Second Loss : 0.9702707210101595
  First-Tier acc 0.53125, precision 0.5742551011696406, recall 0.5717171717171717, F1 0.509671944087862, AUC 0.7627588383838383
  Second-Tier acc 0.5208333333333334, precision 0.5524691358024691, recall 0.5431313131313131, F1 0.48623238623238624, AUC 0.7707575757575759
  First-Tier acc 0.5153061224489796, precision 0.5266819177826204, recall 0.5305886243386243, F1 0.49877881316008404, AUC 0.7062562003968255
  Second-Tier acc 0.5306122448979592, precision 0.518954248366013, recall 0.6014109347442681, F1 0.5051615051615052, AUC 0.7226631393298061
epoch: 8 idx: 0 First Loss : 2.8679137229919434, Second Loss : 2.9158432483673096
epoch: 8 idx: 200 First Loss : 0.9600651119997845, Second Loss : 0.9618292975132886
  First-Tier acc 0.515625, precision 0.5723646723646724, recall 0.5731818181818182, F1 0.5014519056261343, AUC 0.7691098484848485
  Second-Tier acc 0.5, precision 0.5388327721661055, recall 0.5297979797979798, F1 0.46845746845746844, AUC 0.7737373737373737
  First-Tier acc 0.5204081632653061, precision 0.5423757021011025, recall 0.5731922398589065, F1 0.5189947220581438, AUC 0.7162457286155203
  Second-Tier acc 0.4897959183673469, precision 0.49523809523809526, recall 0.5767195767195767, F1 0.4761904761904761, AUC 0.7312059082892416
epoch: 9 idx: 0 First Loss : 2.9693093299865723, Second Loss : 3.0255022048950195
epoch: 9 idx: 200 First Loss : 0.954380531151274, Second Loss : 0.9542693313563344
  First-Tier acc 0.4947916666666667, precision 0.5660621993311515, recall 0.5670707070707072, F1 0.4857960014300251, AUC 0.7763604797979798
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.783939393939394
  First-Tier acc 0.5255102040816326, precision 0.5596689809944596, recall 0.5966710758377425, F1 0.5273624061331159, AUC 0.7224564594356261
  Second-Tier acc 0.4489795918367347, precision 0.4722832722832723, recall 0.5520282186948854, F1 0.44252873563218387, AUC 0.7409611992945327