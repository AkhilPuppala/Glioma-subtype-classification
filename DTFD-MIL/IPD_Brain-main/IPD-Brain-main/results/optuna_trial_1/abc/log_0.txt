{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.26084827927228543, "droprate_2": 0.0, "lr": 1.1541276969906801e-05, "weight_decay": 0.0005730453036046599, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.1541276969906801e-05
epoch: 0 idx: 0 First Loss : 0.9005629420280457, Second Loss : 1.1262527704238892
epoch: 0 idx: 200 First Loss : 1.0622560800011478, Second Loss : 1.0490355844521404
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5080555555555556
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47474747474747475
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45192625661375657
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4611992945326279
 
 test auc: 0.4611992945326279, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.29218246791628855, "droprate_2": 0.0, "lr": 5.554150792931498e-05, "weight_decay": 0.00033591206457113956, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 5.554150792931498e-05
epoch: 0 idx: 0 First Loss : 0.9053807258605957, Second Loss : 1.0359355211257935
epoch: 0 idx: 200 First Loss : 1.1321401168309635, Second Loss : 1.1171087536645765
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5010044893378226
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49893939393939396
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4478982951205173
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44951499118165783
 
 test auc: 0.44951499118165783, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 5.554150792931498e-05
epoch: 1 idx: 0 First Loss : 1.6632513999938965, Second Loss : 2.010453939437866
epoch: 1 idx: 200 First Loss : 1.0474117494637694, Second Loss : 1.0400469658238378
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2638888888888889, precision 0.4178403755868545, recall 0.35353535353535354, F1 0.1729266987693954, AUC 0.5035465768799102
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.502070707070707
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45857828728199096
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4575066137566137
 
 test auc: 0.4575066137566137, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 5.554150792931498e-05
epoch: 2 idx: 0 First Loss : 1.8586243391036987, Second Loss : 2.2840144634246826
epoch: 2 idx: 200 First Loss : 0.9922937610330274, Second Loss : 0.9919221057598271
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.3541666666666667, precision 0.2743055555555556, recall 0.49579124579124584, F1 0.34661429105873554, AUC 0.4852020202020202
  Second-Tier acc 0.2708333333333333, precision 0.3562091503267974, recall 0.3737373737373737, F1 0.31202046035805625, AUC 0.4831313131313131
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2925170068027211, precision 0.4599673202614379, recall 0.31540270429159317, F1 0.2839497377114932, AUC 0.49528463648834026
  Second-Tier acc 0.3469387755102041, precision 0.4648792068146907, recall 0.4367283950617284, F1 0.41364522417154, AUC 0.48941798941798936
 
 test auc: 0.4575066137566137, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 5.554150792931498e-05
epoch: 3 idx: 0 First Loss : 2.2076404094696045, Second Loss : 2.711604595184326
epoch: 3 idx: 200 First Loss : 0.9473256253410335, Second Loss : 0.9562970700103846
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3194444444444444, precision 0.3286713286713287, recall 0.3956902356902357, F1 0.31503150315031503, AUC 0.4955892255892256
  Second-Tier acc 0.2916666666666667, precision 0.32411837674995564, recall 0.31737373737373736, F1 0.31717171717171716, AUC 0.49454545454545457
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3401360544217687, precision 0.3571558678116055, recall 0.3808054085831864, F1 0.36293244475672376, AUC 0.5234359690378209
  Second-Tier acc 0.3469387755102041, precision 0.35694444444444445, recall 0.44951499118165783, F1 0.37392568250758346, AUC 0.5145502645502645
 
 test auc: 0.4575066137566137, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 5.554150792931498e-05
epoch: 4 idx: 0 First Loss : 2.624974250793457, Second Loss : 3.205408811569214
epoch: 4 idx: 200 First Loss : 0.9241856604499455, Second Loss : 0.9391768817507212
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3402777777777778, precision 0.3253376466449472, recall 0.3945791245791246, F1 0.3160793346504698, AUC 0.5097250280583614
  Second-Tier acc 0.3333333333333333, precision 0.3012581959950381, recall 0.36353535353535354, F1 0.31895415928399434, AUC 0.5036363636363637
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3741496598639456, precision 0.34409409409409414, recall 0.38991769547325106, F1 0.3590710834497191, AUC 0.5354080932784636
  Second-Tier acc 0.42857142857142855, precision 0.41031746031746025, recall 0.49889770723104054, F1 0.43035549094753534, AUC 0.5287698412698413
 
 test auc: 0.5287698412698413, test F1: 0.43035549094753534  :  from epoch 4
 current learn rate 5.554150792931498e-05
epoch: 5 idx: 0 First Loss : 2.9297540187835693, Second Loss : 3.5065712928771973
epoch: 5 idx: 200 First Loss : 0.9133748195287007, Second Loss : 0.9331899957351424
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3333333333333333, precision 0.313858253059705, recall 0.37966329966329965, F1 0.3053102056482066, AUC 0.5108585858585859
  Second-Tier acc 0.375, precision 0.3280423280423281, recall 0.40717171717171713, F1 0.34327703949796967, AUC 0.5153535353535353
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.36054421768707484, precision 0.31040099618018746, recall 0.38594944150499705, F1 0.3311094392721928, AUC 0.5440365961199295
  Second-Tier acc 0.3877551020408163, precision 0.3522727272727273, recall 0.4334215167548501, F1 0.3696598639455782, AUC 0.5535714285714287
 
 test auc: 0.5535714285714287, test F1: 0.3696598639455782  :  from epoch 5
 current learn rate 5.554150792931498e-05
epoch: 6 idx: 0 First Loss : 3.181499481201172, Second Loss : 3.7253997325897217
epoch: 6 idx: 200 First Loss : 0.9109998503329223, Second Loss : 0.9325477658766345
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.33432329943957856, recall 0.3873400673400673, F1 0.3202533812703304, AUC 0.518327721661055
  Second-Tier acc 0.4375, precision 0.37826510721247564, recall 0.44717171717171716, F1 0.3947089947089946, AUC 0.5302020202020201
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.36054421768707484, precision 0.28489458846601706, recall 0.3783068783068783, F1 0.3110584412396167, AUC 0.544820448755634
  Second-Tier acc 0.30612244897959184, precision 0.24296675191815856, recall 0.3317901234567901, F1 0.26666666666666666, AUC 0.562334656084656
 
 test auc: 0.562334656084656, test F1: 0.26666666666666666  :  from epoch 6
 current learn rate 5.554150792931498e-05
epoch: 7 idx: 0 First Loss : 3.2710635662078857, Second Loss : 3.852273464202881
epoch: 7 idx: 200 First Loss : 0.9061264003886476, Second Loss : 0.931746025528036
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3819444444444444, precision 0.348727317013762, recall 0.3994612794612795, F1 0.34339468879538, AUC 0.5325701459034792
  Second-Tier acc 0.4166666666666667, precision 0.36072124756335283, recall 0.41686868686868683, F1 0.3724867724867725, AUC 0.5452020202020202
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3401360544217687, precision 0.25597119775201965, recall 0.3523662551440329, F1 0.28309409888357256, AUC 0.5386966000391927
  Second-Tier acc 0.30612244897959184, precision 0.24296675191815856, recall 0.3317901234567901, F1 0.26666666666666666, AUC 0.5536816578483245
 
 test auc: 0.5536816578483245, test F1: 0.26666666666666666  :  from epoch 7
 current learn rate 5.554150792931498e-05
epoch: 8 idx: 0 First Loss : 3.345625877380371, Second Loss : 3.9056553840637207
epoch: 8 idx: 200 First Loss : 0.9022662297507461, Second Loss : 0.9291450503381868
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4097222222222222, precision 0.3574103168368683, recall 0.4067676767676767, F1 0.3557142857142857, AUC 0.5480976430976431
  Second-Tier acc 0.3958333333333333, precision 0.34920634920634924, recall 0.4035353535353536, F1 0.3534514581026209, AUC 0.5519191919191919
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3333333333333333, precision 0.247843734145104, recall 0.3482510288065844, F1 0.2753912753912754, AUC 0.5319542426023908
  Second-Tier acc 0.2653061224489796, precision 0.20833333333333334, recall 0.27777777777777773, F1 0.22875816993464052, AUC 0.5385251322751322
 
 test auc: 0.5385251322751322, test F1: 0.22875816993464052  :  from epoch 8
 current learn rate 5.554150792931498e-05
epoch: 9 idx: 0 First Loss : 3.405749559402466, Second Loss : 3.951951742172241
epoch: 9 idx: 200 First Loss : 0.8992935533239159, Second Loss : 0.9258122727441699
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4444444444444444, precision 0.3850011268875366, recall 0.44030303030303025, F1 0.3825046665067509, AUC 0.5664365881032548
  Second-Tier acc 0.4583333333333333, precision 0.41944444444444445, recall 0.47747474747474744, F1 0.4018518518518519, AUC 0.5690909090909091
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.32653061224489793, precision 0.24167089463893113, recall 0.3343621399176955, F1 0.2668442668442668, AUC 0.5261488340192043
  Second-Tier acc 0.2653061224489796, precision 0.2088888888888889, recall 0.27777777777777773, F1 0.23132664437012262, AUC 0.5328483245149912
 
 test auc: 0.5328483245149912, test F1: 0.23132664437012262  :  from epoch 9
 current learn rate 5.554150792931498e-05
epoch: 10 idx: 0 First Loss : 3.44731068611145, Second Loss : 3.997063398361206
epoch: 10 idx: 200 First Loss : 0.8968893536024806, Second Loss : 0.9263387463722768
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4583333333333333, precision 0.40009337068160594, recall 0.44919191919191914, F1 0.39146733871042355, AUC 0.5795791245791245
  Second-Tier acc 0.4791666666666667, precision 0.4309523809523809, recall 0.4908080808080808, F1 0.41539485570294293, AUC 0.5837373737373738
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.32653061224489793, precision 0.24167089463893113, recall 0.3343621399176955, F1 0.2668442668442668, AUC 0.5186042524005486
  Second-Tier acc 0.2653061224489796, precision 0.2088888888888889, recall 0.27777777777777773, F1 0.23132664437012262, AUC 0.5245811287477954
 
 test auc: 0.5245811287477954, test F1: 0.23132664437012262  :  from epoch 10
 current learn rate 5.554150792931498e-05
epoch: 11 idx: 0 First Loss : 3.4756805896759033, Second Loss : 3.9967405796051025
epoch: 11 idx: 200 First Loss : 0.8956452085962635, Second Loss : 0.9258194004633784
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4583333333333333, precision 0.40546388542963885, recall 0.45484848484848484, F1 0.3917271407837446, AUC 0.5861111111111111
  Second-Tier acc 0.4791666666666667, precision 0.4309523809523809, recall 0.4908080808080808, F1 0.41539485570294293, AUC 0.5876767676767677
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3401360544217687, precision 0.24558774558774557, recall 0.34259259259259256, F1 0.27470575172107486, AUC 0.5111943954536547
  Second-Tier acc 0.2857142857142857, precision 0.2170940170940171, recall 0.29012345679012347, F1 0.24172819250751984, AUC 0.5202270723104057
 
 test auc: 0.5202270723104057, test F1: 0.24172819250751984  :  from epoch 11
 current learn rate 5.554150792931498e-05
epoch: 12 idx: 0 First Loss : 3.4814796447753906, Second Loss : 3.975851535797119
epoch: 12 idx: 200 First Loss : 0.896550862064738, Second Loss : 0.9268954246361689
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4583333333333333, precision 0.4115028136378682, recall 0.46050505050505053, F1 0.3918533009534089, AUC 0.5944332210998878
  Second-Tier acc 0.5, precision 0.4553113553113553, recall 0.5211111111111111, F1 0.43328591749644385, AUC 0.5822222222222222
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.23666666666666666, recall 0.32870370370370366, F1 0.2661854400984836, AUC 0.5056890554575739
  Second-Tier acc 0.30612244897959184, precision 0.23104056437389767, recall 0.30246913580246915, F1 0.2570145903479237, AUC 0.5203373015873016
 
 test auc: 0.5202270723104057, test F1: 0.24172819250751984  :  from epoch 11
 current learn rate 5.554150792931498e-05
epoch: 13 idx: 0 First Loss : 3.443343162536621, Second Loss : 3.9604461193084717
epoch: 13 idx: 200 First Loss : 0.8961417148823951, Second Loss : 0.9261126077469828
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4722222222222222, precision 0.4290295358649789, recall 0.4807070707070707, F1 0.40383473389355745, AUC 0.6023456790123456
  Second-Tier acc 0.4791666666666667, precision 0.45952041785375114, recall 0.5077777777777778, F1 0.4192982456140351, AUC 0.6033333333333334
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3197278911564626, precision 0.22117139538742325, recall 0.3009259259259259, F1 0.2476958848082472, AUC 0.5007716049382716
  Second-Tier acc 0.2857142857142857, precision 0.19393939393939394, recall 0.23148148148148148, F1 0.21052631578947367, AUC 0.5224316578483245
 
 test auc: 0.5224316578483245, test F1: 0.21052631578947367  :  from epoch 13
 current learn rate 5.554150792931498e-05
epoch: 14 idx: 0 First Loss : 3.3877315521240234, Second Loss : 3.9342410564422607
epoch: 14 idx: 200 First Loss : 0.8953309370764005, Second Loss : 0.9249407609907878
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4722222222222222, precision 0.43239795918367346, recall 0.4807070707070707, F1 0.40385551879901266, AUC 0.6071099887766555
  Second-Tier acc 0.4166666666666667, precision 0.43256528417818735, recall 0.4677777777777778, F1 0.3620718462823726, AUC 0.6187373737373737
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3197278911564626, precision 0.21485260770975056, recall 0.2911522633744856, F1 0.2408191504081915, AUC 0.49145723104056444
  Second-Tier acc 0.30612244897959184, precision 0.17845117845117844, recall 0.21450617283950615, F1 0.19477124183006536, AUC 0.5197310405643738
 
 test auc: 0.5197310405643738, test F1: 0.19477124183006536  :  from epoch 14
 current learn rate 5.554150792931498e-05
epoch: 15 idx: 0 First Loss : 3.3738105297088623, Second Loss : 3.9038617610931396
epoch: 15 idx: 200 First Loss : 0.8955218973291565, Second Loss : 0.9204420763700946
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4791666666666667, precision 0.45633737494202614, recall 0.4964646464646465, F1 0.40893023876217155, AUC 0.6163468013468014
  Second-Tier acc 0.4166666666666667, precision 0.4368055555555556, recall 0.4677777777777778, F1 0.35996062507690413, AUC 0.62510101010101
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3129251700680272, precision 0.1958874458874459, recall 0.25771604938271603, F1 0.21979024167806657, AUC 0.4809364589457181
  Second-Tier acc 0.30612244897959184, precision 0.17474747474747476, recall 0.21450617283950615, F1 0.19259259259259257, AUC 0.5106371252204586
 
 test auc: 0.5106371252204586, test F1: 0.19259259259259257  :  from epoch 15
 current learn rate 5.554150792931498e-05
epoch: 16 idx: 0 First Loss : 3.2233612537384033, Second Loss : 3.8320083618164062
epoch: 16 idx: 200 First Loss : 0.8910015949787427, Second Loss : 0.9173291843791089
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4652777777777778, precision 0.460030574664721, recall 0.48757575757575755, F1 0.39849317916120747, AUC 0.6252076318742985
  Second-Tier acc 0.375, precision 0.41339869281045755, recall 0.44111111111111106, F1 0.3212121212121212, AUC 0.6241919191919192
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.30612244897959184, precision 0.18629657414353587, recall 0.24382716049382713, F1 0.20912677989363526, AUC 0.4688724769743288
  Second-Tier acc 0.32653061224489793, precision 0.1840958605664488, recall 0.22685185185185186, F1 0.20315011250401802, AUC 0.5037477954144621
 
 test auc: 0.5106371252204586, test F1: 0.19259259259259257  :  from epoch 15
 current learn rate 5.554150792931498e-05
epoch: 17 idx: 0 First Loss : 3.1383273601531982, Second Loss : 3.793919801712036
epoch: 17 idx: 200 First Loss : 0.8890720664532809, Second Loss : 0.9150235490376519
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4861111111111111, precision 0.4847936731657662, recall 0.5009090909090909, F1 0.41396470221463844, AUC 0.6291470258136925
  Second-Tier acc 0.3958333333333333, precision 0.425925925925926, recall 0.45444444444444443, F1 0.340958605664488, AUC 0.6308080808080808
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3129251700680272, precision 0.1894630192502533, recall 0.2479423868312757, F1 0.21298701298701297, AUC 0.45560822065451695
  Second-Tier acc 0.32653061224489793, precision 0.1840958605664488, recall 0.22685185185185186, F1 0.20315011250401802, AUC 0.48390652557319225
 
 test auc: 0.48390652557319225, test F1: 0.20315011250401802  :  from epoch 17
 current learn rate 5.554150792931498e-05
epoch: 18 idx: 0 First Loss : 3.065943717956543, Second Loss : 3.7367451190948486
epoch: 18 idx: 200 First Loss : 0.8863863072029242, Second Loss : 0.9097098766568937
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4930555555555556, precision 0.4873169901259789, recall 0.5053535353535353, F1 0.4192350117584529, AUC 0.6329741863075197
  Second-Tier acc 0.3958333333333333, precision 0.425925925925926, recall 0.45444444444444443, F1 0.340958605664488, AUC 0.6408080808080808
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3129251700680272, precision 0.1894630192502533, recall 0.2479423868312757, F1 0.21298701298701297, AUC 0.4403047227121301
  Second-Tier acc 0.32653061224489793, precision 0.18452380952380953, recall 0.22685185185185186, F1 0.20295698924731184, AUC 0.4728284832451499
 
 test auc: 0.4728284832451499, test F1: 0.20295698924731184  :  from epoch 18
 current learn rate 5.554150792931498e-05
epoch: 19 idx: 0 First Loss : 3.0194997787475586, Second Loss : 3.701084852218628
epoch: 19 idx: 200 First Loss : 0.8855283964523496, Second Loss : 0.9054402593806049
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4930555555555556, precision 0.48106060606060613, recall 0.5053535353535353, F1 0.4197484779035581, AUC 0.6332884399551065
  Second-Tier acc 0.3541666666666667, precision 0.43015873015873013, recall 0.42777777777777776, F1 0.3020348908737482, AUC 0.6415151515151515
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.30612244897959184, precision 0.18003341687552213, recall 0.23405349794238683, F1 0.20202020202020202, AUC 0.43433397021359976
  Second-Tier acc 0.32653061224489793, precision 0.18055555555555558, recall 0.22685185185185186, F1 0.20039682539682538, AUC 0.4581128747795414
 
 test auc: 0.4581128747795414, test F1: 0.20039682539682538  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.46866531932529026, "droprate_2": 0.0, "lr": 2.5554028887765087e-05, "weight_decay": 2.7459763462521e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.5554028887765087e-05
epoch: 0 idx: 0 First Loss : 0.8933200836181641, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.086801737695191, Second Loss : 1.0824914448593386
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4982547699214366
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48530303030303035
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44436483441113067
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45530202821869487
 
 test auc: 0.45530202821869487, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.5554028887765087e-05
epoch: 1 idx: 0 First Loss : 1.930302619934082, Second Loss : 2.0372633934020996
epoch: 1 idx: 200 First Loss : 1.0625152561201978, Second Loss : 1.0647429923216503
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5007800224466892
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5013131313131313
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4487188908485205
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4503968253968254
 
 test auc: 0.4503968253968254, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.5554028887765087e-05
epoch: 2 idx: 0 First Loss : 1.995322585105896, Second Loss : 2.0960662364959717
epoch: 2 idx: 200 First Loss : 1.0371113756847619, Second Loss : 1.0419490087536436
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.507401795735129
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5063131313131313
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4524483147168333
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4583333333333333
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 3 idx: 0 First Loss : 2.0890774726867676, Second Loss : 2.1904871463775635
epoch: 3 idx: 200 First Loss : 1.0198007539581897, Second Loss : 1.0259838137608857
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5014197530864197
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.49883838383838386
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46875
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4732694003527336
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 4 idx: 0 First Loss : 2.152374267578125, Second Loss : 2.286777973175049
epoch: 4 idx: 200 First Loss : 1.0003353444794518, Second Loss : 1.0077555245205538
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2986111111111111, precision 0.2876500193573364, recall 0.4090909090909091, F1 0.2862799906825064, AUC 0.48753647586980914
  Second-Tier acc 0.2708333333333333, precision 0.24166666666666667, recall 0.37121212121212127, F1 0.2557354925775978, AUC 0.48484848484848486
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2585034013605442, precision 0.11768082663605052, recall 0.2977660199882422, F1 0.14724371373307543, AUC 0.49139599255339994
  Second-Tier acc 0.24489795918367346, precision 0.0909090909090909, recall 0.2857142857142857, F1 0.13793103448275862, AUC 0.48666225749559083
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 5 idx: 0 First Loss : 2.256736993789673, Second Loss : 2.372349500656128
epoch: 5 idx: 200 First Loss : 0.9790195961348453, Second Loss : 0.9899455582472816
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3194444444444444, precision 0.2518518518518518, recall 0.44612794612794615, F1 0.3137701804368471, AUC 0.4811840628507295
  Second-Tier acc 0.3125, precision 0.24193548387096775, recall 0.43686868686868685, F1 0.3060579959804766, AUC 0.4696969696969697
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.2789115646258503, precision 0.3824655095683133, recall 0.30504115226337447, F1 0.25171642366736097, AUC 0.5034232314324907
  Second-Tier acc 0.3469387755102041, precision 0.4398148148148148, recall 0.4481922398589065, F1 0.3983494363929146, AUC 0.5011022927689593
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 6 idx: 0 First Loss : 2.3522729873657227, Second Loss : 2.4383697509765625
epoch: 6 idx: 200 First Loss : 0.960493407142696, Second Loss : 0.9747474520879599
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3125, precision 0.38393048701995286, recall 0.42579124579124583, F1 0.3087493290391841, AUC 0.48419191919191923
  Second-Tier acc 0.2708333333333333, precision 0.2261904761904762, recall 0.3813131313131313, F1 0.28086419753086417, AUC 0.4572727272727273
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2789115646258503, precision 0.3079310982536789, recall 0.2613168724279835, F1 0.26387635353152594, AUC 0.513086664707035
  Second-Tier acc 0.3469387755102041, precision 0.39999999999999997, recall 0.4138007054673722, F1 0.3844764088666528, AUC 0.5165895061728395
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 7 idx: 0 First Loss : 2.4271557331085205, Second Loss : 2.5119805335998535
epoch: 7 idx: 200 First Loss : 0.942848824798616, Second Loss : 0.9599696860384586
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2986111111111111, precision 0.33886418533157664, recall 0.39764309764309763, F1 0.2884328925368597, AUC 0.4912065095398428
  Second-Tier acc 0.2708333333333333, precision 0.2938205585264409, recall 0.33545454545454545, F1 0.2843137254901961, AUC 0.46126262626262626
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.29931972789115646, precision 0.31883012820512824, recall 0.27197236919459145, F1 0.2828927890779696, AUC 0.523160395845581
  Second-Tier acc 0.3469387755102041, precision 0.3799663299663299, recall 0.4201940035273368, F1 0.3878683637197569, AUC 0.5313602292768959
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 8 idx: 0 First Loss : 2.5017786026000977, Second Loss : 2.5864639282226562
epoch: 8 idx: 200 First Loss : 0.9265459258646811, Second Loss : 0.9468569968322024
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2986111111111111, precision 0.3154802971673116, recall 0.3871717171717172, F1 0.2863646670836586, AUC 0.4953928170594837
  Second-Tier acc 0.2708333333333333, precision 0.2731338149294806, recall 0.321010101010101, F1 0.2736046391218805, AUC 0.4637373737373737
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3129251700680272, precision 0.3223684210526316, recall 0.2959288653733098, F1 0.30481283422459887, AUC 0.5289719282774838
  Second-Tier acc 0.3877551020408163, precision 0.4078947368421053, recall 0.47420634920634913, F1 0.42626811594202896, AUC 0.5395171957671957
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 9 idx: 0 First Loss : 2.569766044616699, Second Loss : 2.63993763923645
epoch: 9 idx: 200 First Loss : 0.9117657572253427, Second Loss : 0.9351525530775091
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2916666666666667, precision 0.28497181113460185, recall 0.36912457912457913, F1 0.27249712313003455, AUC 0.4991806958473626
  Second-Tier acc 0.3125, precision 0.2867521367521368, recall 0.3671717171717172, F1 0.3035483870967742, AUC 0.47287878787878784
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3469387755102041, precision 0.3301571616789008, recall 0.3284097589653145, F1 0.329065976217875, AUC 0.5345078875171468
  Second-Tier acc 0.40816326530612246, precision 0.4086538461538461, recall 0.4865520282186948, F1 0.4307328605200946, AUC 0.55054012345679
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 10 idx: 0 First Loss : 2.6362855434417725, Second Loss : 2.684011459350586
epoch: 10 idx: 200 First Loss : 0.897875581214677, Second Loss : 0.9245635312402722
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.3022167487684729, recall 0.38245791245791244, F1 0.289063174143568, AUC 0.5045735129068462
  Second-Tier acc 0.3125, precision 0.2748792270531401, recall 0.3671717171717172, F1 0.29010695187165775, AUC 0.47580808080808085
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.35374149659863946, precision 0.33466568720652207, recall 0.35207231040564374, F1 0.34198423190130917, AUC 0.5389538016852832
  Second-Tier acc 0.4489795918367347, precision 0.42540792540792544, recall 0.5112433862433862, F1 0.4494605923177352, AUC 0.5553350970017638
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 11 idx: 0 First Loss : 2.6968071460723877, Second Loss : 2.718374729156494
epoch: 11 idx: 200 First Loss : 0.8859191863468631, Second Loss : 0.9150044123517044
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3194444444444444, precision 0.304070423470065, recall 0.3820875420875421, F1 0.2907710994135732, AUC 0.5085802469135802
  Second-Tier acc 0.3333333333333333, precision 0.2912698412698413, recall 0.3974747474747475, F1 0.30624930624930624, AUC 0.4792929292929293
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3469387755102041, precision 0.30763586298717016, recall 0.336493239271017, F1 0.3188449518858875, AUC 0.5402030668234373
  Second-Tier acc 0.4489795918367347, precision 0.42070707070707075, recall 0.5112433862433862, F1 0.44308693377016367, AUC 0.5661926807760141
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 12 idx: 0 First Loss : 2.7503926753997803, Second Loss : 2.7486114501953125
epoch: 12 idx: 200 First Loss : 0.8748160175960603, Second Loss : 0.9065965515427032
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.31502463054187196, recall 0.390976430976431, F1 0.3031870784083173, AUC 0.5110549943883277
  Second-Tier acc 0.3541666666666667, precision 0.32051282051282054, recall 0.41080808080808073, F1 0.32075137338295234, AUC 0.48414141414141415
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.36054421768707484, precision 0.31547619047619047, recall 0.3604497354497354, F1 0.33199701438463414, AUC 0.543987605330198
  Second-Tier acc 0.42857142857142855, precision 0.38825757575757575, recall 0.4874338624338624, F1 0.41104308390022676, AUC 0.5692239858906526
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 13 idx: 0 First Loss : 2.791445016860962, Second Loss : 2.762136936187744
epoch: 13 idx: 200 First Loss : 0.8646145399974946, Second Loss : 0.8987069044966455
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3611111111111111, precision 0.3360493827160494, recall 0.4030976430976431, F1 0.3286528286528287, AUC 0.5102132435465768
  Second-Tier acc 0.3958333333333333, precision 0.3537037037037037, recall 0.4374747474747474, F1 0.35555555555555557, AUC 0.4902525252525252
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3469387755102041, precision 0.2903259502997609, recall 0.35435038212815995, F1 0.3127608242044862, AUC 0.5472087497550461
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5734678130511464
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 14 idx: 0 First Loss : 2.82782244682312, Second Loss : 2.7733261585235596
epoch: 14 idx: 200 First Loss : 0.8549191288520299, Second Loss : 0.891444783592921
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3680555555555556, precision 0.341824686940966, recall 0.4075420875420876, F1 0.3339712046655732, AUC 0.509668911335578
  Second-Tier acc 0.3958333333333333, precision 0.3537037037037037, recall 0.4374747474747474, F1 0.35555555555555557, AUC 0.4948989898989899
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.2953333928943685, recall 0.3682392710170488, F1 0.31964429700278757, AUC 0.5491316382520086
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5680114638447972
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 15 idx: 0 First Loss : 2.8490302562713623, Second Loss : 2.787409782409668
epoch: 15 idx: 200 First Loss : 0.8462477022995106, Second Loss : 0.8851764250491092
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.375, precision 0.3507332460820833, recall 0.41198653198653207, F1 0.33802431090566687, AUC 0.5104152637485971
  Second-Tier acc 0.4166666666666667, precision 0.3650227767874827, recall 0.45080808080808077, F1 0.3766233766233766, AUC 0.4982828282828282
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3469387755102041, precision 0.27867223216060427, recall 0.3603027630805408, F1 0.3058081770209257, AUC 0.5503257887517147
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5694995590828924
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 16 idx: 0 First Loss : 2.878676652908325, Second Loss : 2.788067579269409
epoch: 16 idx: 200 First Loss : 0.8377831822437285, Second Loss : 0.8790085377143835
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.375, precision 0.3507332460820833, recall 0.41198653198653207, F1 0.33802431090566687, AUC 0.5123232323232324
  Second-Tier acc 0.3958333333333333, precision 0.34863123993558776, recall 0.4374747474747474, F1 0.35790576393158896, AUC 0.503030303030303
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.35374149659863946, precision 0.2697881828316611, recall 0.3703703703703704, F1 0.3033243486073675, AUC 0.5533509700176368
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5725859788359788
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 17 idx: 0 First Loss : 2.9019784927368164, Second Loss : 2.7908167839050293
epoch: 17 idx: 200 First Loss : 0.8298249784254687, Second Loss : 0.8732898973289933
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.33483483483483484, recall 0.3917845117845118, F1 0.3269294474052333, AUC 0.5111054994388328
  Second-Tier acc 0.3958333333333333, precision 0.3537037037037037, recall 0.4374747474747474, F1 0.35555555555555557, AUC 0.5033333333333334
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.35374149659863946, precision 0.262469900240798, recall 0.3703703703703704, F1 0.2950884642604388, AUC 0.5531427591612778
  Second-Tier acc 0.3877551020408163, precision 0.30392156862745096, recall 0.4398148148148148, F1 0.3435294117647059, AUC 0.5736882716049383
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.5554028887765087e-05
epoch: 18 idx: 0 First Loss : 2.917696714401245, Second Loss : 2.7933192253112793
epoch: 18 idx: 200 First Loss : 0.8218807723391709, Second Loss : 0.8682199038926568
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.34573737674541727, recall 0.4006734006734007, F1 0.3379317995290602, AUC 0.5114590347923681
  Second-Tier acc 0.3958333333333333, precision 0.34857203751065646, recall 0.4205050505050505, F1 0.35266106442577033, AUC 0.5097474747474747
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.35374149659863946, precision 0.262469900240798, recall 0.3703703703703704, F1 0.2950884642604388, AUC 0.5523711542230061
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5731922398589065
 
 test auc: 0.5731922398589065, test F1: 0.36512820512820515  :  from epoch 18
 current learn rate 2.5554028887765087e-05
epoch: 19 idx: 0 First Loss : 2.9219605922698975, Second Loss : 2.7888970375061035
epoch: 19 idx: 200 First Loss : 0.8144851900841021, Second Loss : 0.8631079871513283
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.375, precision 0.34682978432978434, recall 0.4006734006734007, F1 0.33724160638319245, AUC 0.511307519640853
  Second-Tier acc 0.4166666666666667, precision 0.3632390154129284, recall 0.43383838383838386, F1 0.36659706722346225, AUC 0.5137878787878788
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.2604588394062078, recall 0.3703703703703704, F1 0.29321711923119903, AUC 0.5530019106407996
  Second-Tier acc 0.3673469387755102, precision 0.285, recall 0.39814814814814814, F1 0.32051282051282054, AUC 0.5718694885361552
 
 test auc: 0.5718694885361552, test F1: 0.32051282051282054  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.360945598101634, "droprate_2": 0.0, "lr": 2.9173504162232192e-05, "weight_decay": 3.2737117663676865e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.9173504162232192e-05
epoch: 0 idx: 0 First Loss : 1.2331169843673706, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1221673278814523, Second Loss : 1.1038104274972755
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7162177328843994
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7557070707070707
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6645171957671958
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6552028218694884
 
 test auc: 0.6552028218694884, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 2.9173504162232192e-05
epoch: 1 idx: 0 First Loss : 2.1398699283599854, Second Loss : 2.116617202758789
epoch: 1 idx: 200 First Loss : 1.086932237690954, Second Loss : 1.0784060161060363
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7382267115600448
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7616161616161615
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7053877621007251
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7037037037037037
 
 test auc: 0.7037037037037037, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.9173504162232192e-05
epoch: 2 idx: 0 First Loss : 2.265472412109375, Second Loss : 2.2659778594970703
epoch: 2 idx: 200 First Loss : 1.0507776846191776, Second Loss : 1.0428564989225781
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7360942760942759
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7533333333333333
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7102011071918479
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134038800705468
 
 test auc: 0.7037037037037037, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.9173504162232192e-05
epoch: 3 idx: 0 First Loss : 2.445922613143921, Second Loss : 2.457361936569214
epoch: 3 idx: 200 First Loss : 1.013395162771887, Second Loss : 1.0096179372561511
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6111111111111112, precision 0.5645424836601307, recall 0.481986531986532, F1 0.46876382081012097, AUC 0.7309539842873177
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7577777777777778
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.564625850340136, precision 0.44275889967637544, recall 0.4898589065255732, F1 0.44283413848631237, AUC 0.6959019204389575
  Second-Tier acc 0.5918367346938775, precision 0.5383064516129031, recall 0.46759259259259256, F1 0.4636015325670498, AUC 0.703042328042328
 
 test auc: 0.7037037037037037, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.9173504162232192e-05
epoch: 4 idx: 0 First Loss : 2.7007968425750732, Second Loss : 2.7369327545166016
epoch: 4 idx: 200 First Loss : 0.9769173159231594, Second Loss : 0.9785663945535522
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5277777777777778, precision 0.5148493481826816, recall 0.5008754208754209, F1 0.4598777307511435, AUC 0.7271043771043771
  Second-Tier acc 0.5833333333333334, precision 0.5523809523809524, recall 0.5693939393939395, F1 0.529800194931774, AUC 0.7501515151515151
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.48299319727891155, precision 0.46139784946236556, recall 0.49272486772486773, F1 0.43410114198921274, AUC 0.6964163237311386
  Second-Tier acc 0.6122448979591837, precision 0.5964912280701754, recall 0.6494708994708995, F1 0.604891304347826, AUC 0.7231040564373897
 
 test auc: 0.7037037037037037, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.9173504162232192e-05
epoch: 5 idx: 0 First Loss : 3.006981611251831, Second Loss : 3.056882381439209
epoch: 5 idx: 200 First Loss : 0.95192624359804, Second Loss : 0.9583598273755306
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4652777777777778, precision 0.4969990594990595, recall 0.47531986531986536, F1 0.4152806792008142, AUC 0.7324859708193042
  Second-Tier acc 0.5, precision 0.5544922913343966, recall 0.5373737373737374, F1 0.495159230420632, AUC 0.7634848484848483
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4557823129251701, precision 0.5186314363143631, recall 0.5327748383303939, F1 0.43526824071210085, AUC 0.7110461983147168
  Second-Tier acc 0.5510204081632653, precision 0.5625730994152046, recall 0.6302910052910052, F1 0.5549909028169898, AUC 0.7550705467372133
 
 test auc: 0.7550705467372133, test F1: 0.5549909028169898  :  from epoch 5
 current learn rate 2.9173504162232192e-05
epoch: 6 idx: 0 First Loss : 3.2372848987579346, Second Loss : 3.300941228866577
epoch: 6 idx: 200 First Loss : 0.9369981852985585, Second Loss : 0.9470205824840722
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.49882232462877624, recall 0.47245791245791247, F1 0.4045281161560232, AUC 0.7380583613916946
  Second-Tier acc 0.5, precision 0.5687830687830687, recall 0.5687878787878787, F1 0.49960046714610606, AUC 0.77989898989899
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.4824404761904762, recall 0.5121987066431511, F1 0.40679140679140685, AUC 0.7234592396629433
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.765432098765432
 
 test auc: 0.765432098765432, test F1: 0.49836601307189543  :  from epoch 6
 current learn rate 2.9173504162232192e-05
epoch: 7 idx: 0 First Loss : 3.4262869358062744, Second Loss : 3.5052480697631836
epoch: 7 idx: 200 First Loss : 0.9290201893002166, Second Loss : 0.9423278334425457
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4097222222222222, precision 0.47161841742486904, recall 0.45023569023569027, F1 0.37317128717207554, AUC 0.7389674523007855
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.7955555555555556
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.40816326530612246, precision 0.5014897026529764, recall 0.5077895355673133, F1 0.39854351256220416, AUC 0.7307160003919263
  Second-Tier acc 0.5102040816326531, precision 0.5736185383244207, recall 0.6170634920634921, F1 0.5154954954954954, AUC 0.771164021164021
 
 test auc: 0.771164021164021, test F1: 0.5154954954954954  :  from epoch 7
 current learn rate 2.9173504162232192e-05
epoch: 8 idx: 0 First Loss : 3.5419912338256836, Second Loss : 3.6260793209075928
epoch: 8 idx: 200 First Loss : 0.9219756420071593, Second Loss : 0.9383477125066653
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.4600437876299945, recall 0.42764309764309766, F1 0.3509926947095558, AUC 0.7436531986531986
  Second-Tier acc 0.4583333333333333, precision 0.5425084175084175, recall 0.5302020202020202, F1 0.45858585858585865, AUC 0.7959595959595959
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.40816326530612246, precision 0.5243561176352505, recall 0.5154320987654321, F1 0.4030757351057419, AUC 0.7387994806976289
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.789076278659612
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 9 idx: 0 First Loss : 3.6345112323760986, Second Loss : 3.718337059020996
epoch: 9 idx: 200 First Loss : 0.9165094347754076, Second Loss : 0.9345740503098686
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4166666666666667, precision 0.5062119081106423, recall 0.4846464646464647, F1 0.4043224002034071, AUC 0.7471997755331089
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7944444444444443
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.5593869731800766, recall 0.5589359200470311, F1 0.4437321937321937, AUC 0.7504286694101509
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7978946208112875
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 10 idx: 0 First Loss : 3.7036330699920654, Second Loss : 3.7613463401794434
epoch: 10 idx: 200 First Loss : 0.9108752359355804, Second Loss : 0.9308755757467849
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4027777777777778, precision 0.49625730994152045, recall 0.47094276094276094, F1 0.3920670221618696, AUC 0.74675645342312
  Second-Tier acc 0.4166666666666667, precision 0.5122100122100122, recall 0.4916161616161616, F1 0.41061895228561895, AUC 0.790959595959596
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.5661375661375662, recall 0.560626102292769, F1 0.44420618822241537, AUC 0.7591122868900646
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.8019179894179894
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 11 idx: 0 First Loss : 3.6626675128936768, Second Loss : 3.761483669281006
epoch: 11 idx: 200 First Loss : 0.9047186003305222, Second Loss : 0.928183390321071
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5105820105820106, recall 0.4909090909090909, F1 0.4080319322254806, AUC 0.7459708193041527
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7867676767676768
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.5906956892872386, recall 0.5943562610229277, F1 0.47712271869652984, AUC 0.7638705173427395
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7984457671957671
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 12 idx: 0 First Loss : 3.636981725692749, Second Loss : 3.751086711883545
epoch: 12 idx: 200 First Loss : 0.8994171690619759, Second Loss : 0.9248932250856482
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.49006504363428754, recall 0.46434343434343434, F1 0.37956799214531173, AUC 0.7404040404040404
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7737373737373737
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5906956892872386, recall 0.5943562610229277, F1 0.47712271869652984, AUC 0.7620578581226729
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8003196649029981
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 13 idx: 0 First Loss : 3.6163489818573, Second Loss : 3.7239084243774414
epoch: 13 idx: 200 First Loss : 0.8951653886461325, Second Loss : 0.9229643415203271
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.375, precision 0.4844576719576719, recall 0.45676767676767677, F1 0.3717046238785369, AUC 0.7324803591470258
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.7622222222222222
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.5788486627527724, recall 0.5681216931216931, F1 0.44766139657444004, AUC 0.7616046933176562
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.8004298941798941
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 14 idx: 0 First Loss : 3.5760409832000732, Second Loss : 3.6785240173339844
epoch: 14 idx: 200 First Loss : 0.8906799527070489, Second Loss : 0.9221296596858622
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.48345267745952675, recall 0.4576094276094276, F1 0.3707236160066349, AUC 0.7213916947250282
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.736868686868687
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5749372253609542, recall 0.5598912404467961, F1 0.43216672078075363, AUC 0.7603003135410544
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7926036155202821
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 15 idx: 0 First Loss : 3.5445759296417236, Second Loss : 3.644538640975952
epoch: 15 idx: 200 First Loss : 0.8878566211660563, Second Loss : 0.9215252687057031
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.45479407979407976, recall 0.42010101010101014, F1 0.3343948366045897, AUC 0.7064141414141414
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.708030303030303
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5822222222222222, recall 0.5716490299823632, F1 0.43718344412788857, AUC 0.7562402018420536
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7891865079365079
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 16 idx: 0 First Loss : 3.547137975692749, Second Loss : 3.6284255981445312
epoch: 16 idx: 200 First Loss : 0.8869855704703438, Second Loss : 0.9227754869541751
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.47088477366255144, recall 0.4455892255892256, F1 0.352046783625731, AUC 0.6934511784511784
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6944949494949495
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5822222222222222, recall 0.5716490299823632, F1 0.43718344412788857, AUC 0.7534171075837742
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.784997795414462
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 17 idx: 0 First Loss : 3.522679090499878, Second Loss : 3.6185507774353027
epoch: 17 idx: 200 First Loss : 0.8852937441158215, Second Loss : 0.9234647238580742
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.469704641350211, recall 0.4455892255892256, F1 0.35217792543373944, AUC 0.6860998877665544
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6851010101010101
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.43537414965986393, precision 0.5777777777777777, recall 0.5637125220458553, F1 0.4314854384298828, AUC 0.7476729374877523
  Second-Tier acc 0.4897959183673469, precision 0.5952380952380952, recall 0.5804673721340388, F1 0.4792462439521263, AUC 0.783344356261023
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 18 idx: 0 First Loss : 3.5017640590667725, Second Loss : 3.596548318862915
epoch: 18 idx: 200 First Loss : 0.883293916075143, Second Loss : 0.924722289026394
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.469704641350211, recall 0.4455892255892256, F1 0.35217792543373944, AUC 0.6805443322109989
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6779292929292929
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.40816326530612246, precision 0.5624338624338624, recall 0.535787771898883, F1 0.4045537694811742, AUC 0.7429024593376446
  Second-Tier acc 0.4897959183673469, precision 0.5952380952380952, recall 0.5804673721340388, F1 0.4792462439521263, AUC 0.7822420634920636
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8
 current learn rate 2.9173504162232192e-05
epoch: 19 idx: 0 First Loss : 3.4736344814300537, Second Loss : 3.6190333366394043
epoch: 19 idx: 200 First Loss : 0.8811360584790309, Second Loss : 0.9262410604114939
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4635714285714286, recall 0.4411447811447811, F1 0.344316465911745, AUC 0.6774971941638608
  Second-Tier acc 0.3541666666666667, precision 0.45303776683087027, recall 0.4396969696969697, F1 0.33247863247863246, AUC 0.6774747474747475
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4013605442176871, precision 0.5582274652147611, recall 0.5197677836566726, F1 0.39425177158370933, AUC 0.7415858318636097
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7783289241622575
 
 test auc: 0.789076278659612, test F1: 0.5128205128205128  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.3760797837453316, "droprate_2": 0.0, "lr": 0.00014940011799053507, "weight_decay": 8.580807910286593e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00014940011799053507
epoch: 0 idx: 0 First Loss : 1.2253917455673218, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.0960693803815107, Second Loss : 1.0830468156963438
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7448428731762066
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7636868686868686
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7204218106995884
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7089395943562611
 
 test auc: 0.7089395943562611, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014940011799053507
epoch: 1 idx: 0 First Loss : 1.694809913635254, Second Loss : 1.8395006656646729
epoch: 1 idx: 200 First Loss : 0.9911448105205944, Second Loss : 0.9858509575697914
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7396127946127947
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7530808080808081
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7228039878502841
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7221119929453262
 
 test auc: 0.7089395943562611, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014940011799053507
epoch: 2 idx: 0 First Loss : 2.232649087905884, Second Loss : 2.2484676837921143
epoch: 2 idx: 200 First Loss : 0.9571746684499641, Second Loss : 0.9482651473351972
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5972222222222222, precision 0.5629399585921325, recall 0.46370370370370373, F1 0.44447164422684615, AUC 0.7346296296296296
  Second-Tier acc 0.6041666666666666, precision 0.543859649122807, recall 0.46141414141414133, F1 0.4385836385836386, AUC 0.7496464646464647
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6462585034013606, precision 0.7256613756613758, recall 0.5235155790711347, F1 0.5111659300373453, AUC 0.7097234469919655
  Second-Tier acc 0.6326530612244898, precision 0.4018518518518519, recall 0.5293209876543209, F1 0.45478489903424063, AUC 0.7302138447971781
 
 test auc: 0.7089395943562611, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014940011799053507
epoch: 3 idx: 0 First Loss : 2.511106252670288, Second Loss : 2.494669198989868
epoch: 3 idx: 200 First Loss : 0.9299067813736289, Second Loss : 0.9207050178329743
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.53955525606469, recall 0.5518518518518518, F1 0.5310056683077339, AUC 0.7309988776655443
  Second-Tier acc 0.6041666666666666, precision 0.5793650793650794, recall 0.5675757575757575, F1 0.5458420522359141, AUC 0.7577777777777778
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5578231292517006, precision 0.5387087087087087, recall 0.5876690182245738, F1 0.5485223322532432, AUC 0.7082108563590045
  Second-Tier acc 0.5102040816326531, precision 0.47612085769980506, recall 0.5482804232804233, F1 0.47380156075808255, AUC 0.7377645502645502
 
 test auc: 0.7089395943562611, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00014940011799053507
epoch: 4 idx: 0 First Loss : 2.688789129257202, Second Loss : 2.7304210662841797
epoch: 4 idx: 200 First Loss : 0.9128415554354143, Second Loss : 0.9005254117670047
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5601428524406702, recall 0.5667003367003367, F1 0.5212445425360522, AUC 0.7280359147025814
  Second-Tier acc 0.5208333333333334, precision 0.5603174603174603, recall 0.5676767676767677, F1 0.5212835212835213, AUC 0.7749999999999999
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4897959183673469, precision 0.5108082706766918, recall 0.564373897707231, F1 0.48421158285656934, AUC 0.7140652557319225
  Second-Tier acc 0.5102040816326531, precision 0.5285714285714286, recall 0.6119929453262786, F1 0.5072690135768353, AUC 0.7534171075837742
 
 test auc: 0.7534171075837742, test F1: 0.5072690135768353  :  from epoch 4
 current learn rate 0.00014940011799053507
epoch: 5 idx: 0 First Loss : 2.923875570297241, Second Loss : 2.935595989227295
epoch: 5 idx: 200 First Loss : 0.906902606548065, Second Loss : 0.8906659408755119
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4791666666666667, precision 0.5352657004830917, recall 0.5263299663299663, F1 0.471062271062271, AUC 0.7344107744107743
  Second-Tier acc 0.5, precision 0.5484126984126985, recall 0.5662626262626262, F1 0.49756613756613755, AUC 0.77989898989899
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4897959183673469, precision 0.5417542016806722, recall 0.5915637860082305, F1 0.488628762541806, AUC 0.7108624828532236
  Second-Tier acc 0.5102040816326531, precision 0.5700757575757577, recall 0.6234567901234568, F1 0.5087719298245613, AUC 0.7610229276895945
 
 test auc: 0.7610229276895945, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 0.00014940011799053507
epoch: 6 idx: 0 First Loss : 2.911341428756714, Second Loss : 3.043276071548462
epoch: 6 idx: 200 First Loss : 0.9065975088357406, Second Loss : 0.8816532919470647
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4097222222222222, precision 0.48529696698710784, recall 0.44925925925925925, F1 0.40336133162454635, AUC 0.7317283950617285
  Second-Tier acc 0.4375, precision 0.4978557504873294, recall 0.5024242424242424, F1 0.4383301707779886, AUC 0.7626262626262625
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.5319941168163296, recall 0.5296149323927102, F1 0.4577128633965229, AUC 0.6985841661767588
  Second-Tier acc 0.5306122448979592, precision 0.6078947368421052, recall 0.6294091710758377, F1 0.5286650286650286, AUC 0.7765652557319225
 
 test auc: 0.7610229276895945, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 0.00014940011799053507
epoch: 7 idx: 0 First Loss : 2.9679384231567383, Second Loss : 3.0822548866271973{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.20760322953248442, "droprate_2": 0.0, "lr": 2.752701059562387e-05, "weight_decay": 6.779674271831235e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.3340885237628597, "droprate_2": 0.0, "lr": 2.4738176179135055e-05, "weight_decay": 5.452968170769885e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.752701059562387e-05
epoch: 0 idx: 0 First Loss : 1.2453935146331787, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1102985582541471, Second Loss : 1.1002417552975279
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7141301907968575
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7592929292929295
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6599610523221634
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6544863315696648
 
 test auc: 0.6544863315696648, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 2.752701059562387e-05
epoch: 1 idx: 0 First Loss : 2.1067306995391846, Second Loss : 2.103332281112671
epoch: 1 idx: 200 First Loss : 1.0844511893851247, Second Loss : 1.0774005684093457
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7358136924803592
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7671717171717173
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7014195081324711
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7049713403880071
 
 test auc: 0.7049713403880071, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.752701059562387e-05
epoch: 2 idx: 0 First Loss : 2.2479069232940674, Second Loss : 2.239292860031128
epoch: 2 idx: 200 First Loss : 1.0512981921879214, Second Loss : 1.0444061275738388
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.5093896713615024, recall 0.3434343434343434, F1 0.2500225896810337, AUC 0.7381705948372614
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7564646464646465
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7124853027630804
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7078924162257495
 
 test auc: 0.7049713403880071, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.752701059562387e-05
epoch: 3 idx: 0 First Loss : 2.4375505447387695, Second Loss : 2.4079041481018066
epoch: 3 idx: 200 First Loss : 1.01913304515739, Second Loss : 1.0143940948802441
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.625, precision 0.6046509046509047, recall 0.499057239057239, F1 0.503249702792037, AUC 0.73341189674523
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7530303030303029
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6190476190476191, precision 0.5499452654625069, recall 0.5227807172251616, F1 0.48568378281938834, AUC 0.6935687340779934
  Second-Tier acc 0.5510204081632653, precision 0.3284193284193284, recall 0.3791887125220459, F1 0.34625, AUC 0.6979166666666666
 
 test auc: 0.7049713403880071, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.752701059562387e-05
epoch: 4 idx: 0 First Loss : 2.715426206588745, Second Loss : 2.67671799659729
epoch: 4 idx: 200 First Loss : 0.9867722617823687, Second Loss : 0.9851663888649858
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5763888888888888, precision 0.5274044795783926, recall 0.5305387205387205, F1 0.5167757774140753, AUC 0.7283052749719415
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7444949494949494
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5034013605442177, precision 0.45180453378812496, recall 0.49529688418577306, F1 0.4474499851964641, AUC 0.6979717813051146
  Second-Tier acc 0.6530612244897959, precision 0.6437400318979266, recall 0.6677689594356261, F1 0.6482426303854875, AUC 0.7229938271604938
 
 test auc: 0.7049713403880071, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.752701059562387e-05
epoch: 5 idx: 0 First Loss : 3.0178234577178955, Second Loss : 2.9833269119262695
epoch: 5 idx: 200 First Loss : 0.9627635136654424, Second Loss : 0.9632171611880782
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5, precision 0.5198232323232324, recall 0.5048821548821549, F1 0.4630665630665631, AUC 0.7335690235690236
  Second-Tier acc 0.5208333333333334, precision 0.5739854687223108, recall 0.5676767676767677, F1 0.5185185185185185, AUC 0.7634343434343434
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4634259259259259, recall 0.5150646678424456, F1 0.42421144548804124, AUC 0.7123015873015873
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7503858024691358
 
 test auc: 0.7049713403880071, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.752701059562387e-05
epoch: 6 idx: 0 First Loss : 3.2863361835479736, Second Loss : 3.255614995956421
epoch: 6 idx: 200 First Loss : 0.949200811012838, Second Loss : 0.9503161110428732
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.49289698360919815, recall 0.47329966329966333, F1 0.41072669094118947, AUC 0.7426430976430977
  Second-Tier acc 0.5, precision 0.5685185185185185, recall 0.5662626262626262, F1 0.49589408412937824, AUC 0.7871717171717171
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.41496598639455784, precision 0.46221221221221226, recall 0.4983098177542622, F1 0.4009263123187174, AUC 0.7265395355673133
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7605820105820106
 
 test auc: 0.7605820105820106, test F1: 0.4711538461538461  :  from epoch 6
 current learn rate 2.752701059562387e-05
epoch: 7 idx: 0 First Loss : 3.488652467727661, Second Loss : 3.4411001205444336
epoch: 7 idx: 200 First Loss : 0.9407914960015547, Second Loss : 0.9429303100749628
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4236111111111111, precision 0.48568715235381904, recall 0.46478114478114474, F1 0.3909713018545949, AUC 0.7543490460157126
  Second-Tier acc 0.5, precision 0.5738491048593349, recall 0.5832323232323232, F1 0.4985569985569986, AUC 0.7967171717171717
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.41496598639455784, precision 0.49740053377763377, recall 0.5119047619047619, F1 0.4043422234832364, AUC 0.7358294140701549
  Second-Tier acc 0.4897959183673469, precision 0.556140350877193, recall 0.5932539682539683, F1 0.49186441343304094, AUC 0.76548721340388
 
 test auc: 0.76548721340388, test F1: 0.49186441343304094  :  from epoch 7
 current learn rate 2.752701059562387e-05
epoch: 8 idx: 0 First Loss : 3.6230287551879883, Second Loss : 3.5891356468200684
epoch: 8 idx: 200 First Loss : 0.9363759186313446, Second Loss : 0.9406303594037149
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4027777777777778, precision 0.48587377534745957, recall 0.4531313131313131, F1 0.38175790136005033, AUC 0.7591582491582493
  Second-Tier acc 0.5208333333333334, precision 0.5907477025898079, recall 0.6135353535353536, F1 0.5212121212121211, AUC 0.7982323232323232
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.5343974960876369, recall 0.5392416225749559, F1 0.42719316042184996, AUC 0.7403488144228886
  Second-Tier acc 0.5102040816326531, precision 0.6, recall 0.6170634920634921, F1 0.5098039215686274, AUC 0.7792107583774252
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 9 idx: 0 First Loss : 3.7020809650421143, Second Loss : 3.672234535217285
epoch: 9 idx: 200 First Loss : 0.9324260042790342, Second Loss : 0.9380951437181724
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4444444444444444, precision 0.5296929582643869, recall 0.5193939393939394, F1 0.4368994826311899, AUC 0.7652693602693602
  Second-Tier acc 0.5, precision 0.5775803144224197, recall 0.6002020202020203, F1 0.4988562091503268, AUC 0.7957575757575758
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.43537414965986393, precision 0.5416666666666666, recall 0.5450470311581422, F1 0.4376702405099971, AUC 0.7507042426023908
  Second-Tier acc 0.4897959183673469, precision 0.5944444444444444, recall 0.6047178130511464, F1 0.4897710808461316, AUC 0.7903990299823634
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 10 idx: 0 First Loss : 3.763113260269165, Second Loss : 3.7247776985168457
epoch: 10 idx: 200 First Loss : 0.9273901474963299, Second Loss : 0.933842584775733
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4444444444444444, precision 0.5349477657086618, recall 0.5323905723905724, F1 0.4412250972878942, AUC 0.7671548821548821
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7899494949494948
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5833762223365929, recall 0.5885508524397413, F1 0.47214793605137445, AUC 0.7548745835782874
  Second-Tier acc 0.46938775510204084, precision 0.5761904761904763, recall 0.5630511463844797, F1 0.4666666666666666, AUC 0.7933752204585538
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 11 idx: 0 First Loss : 3.7790634632110596, Second Loss : 3.727602481842041
epoch: 11 idx: 200 First Loss : 0.9221943543021526, Second Loss : 0.9298390559110772
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4375, precision 0.5330827067669173, recall 0.5273400673400673, F1 0.4364596362117536, AUC 0.7652861952861952
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7840909090909092
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.5752454118651301, recall 0.564594356261023, F1 0.45688449010163046, AUC 0.7585978835978836
  Second-Tier acc 0.46938775510204084, precision 0.5702614379084968, recall 0.5451940035273369, F1 0.46115288220551376, AUC 0.7935405643738976
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 12 idx: 0 First Loss : 3.770862579345703, Second Loss : 3.715749740600586
epoch: 12 idx: 200 First Loss : 0.9176884144822608, Second Loss : 0.9264761578680863
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4027777777777778, precision 0.5047262541380189, recall 0.4923569023569024, F1 0.3968685847351166, AUC 0.7592368125701459
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7757070707070707
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5752454118651301, recall 0.564594356261023, F1 0.45688449010163046, AUC 0.7597001763668431
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7912808641975309
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 13 idx: 0 First Loss : 3.7551021575927734, Second Loss : 3.688140392303467
epoch: 13 idx: 200 First Loss : 0.9137204952459245, Second Loss : 0.9236158682693686
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3958333333333333, precision 0.4975594493116395, recall 0.48393939393939395, F1 0.38712294348614157, AUC 0.750729517396184
  Second-Tier acc 0.3958333333333333, precision 0.4901234567901234, recall 0.4808080808080808, F1 0.3817309103104236, AUC 0.7516161616161616
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5665822784810127, recall 0.5343915343915344, F1 0.4306455215546125, AUC 0.757979374877523
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7975639329805997
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 14 idx: 0 First Loss : 3.730487823486328, Second Loss : 3.6526381969451904
epoch: 14 idx: 200 First Loss : 0.9100754242575732, Second Loss : 0.9210305020134358
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3819444444444444, precision 0.48800505050505044, recall 0.4702356902356903, F1 0.37144892144892144, AUC 0.7421604938271603
  Second-Tier acc 0.375, precision 0.4682539682539682, recall 0.45303030303030306, F1 0.35539012958367794, AUC 0.733939393939394
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.42857142857142855, precision 0.5629461661207693, recall 0.524323927101705, F1 0.4206542400900665, AUC 0.7552113952576915
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7958002645502645
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 15 idx: 0 First Loss : 3.706066846847534, Second Loss : 3.609724998474121
epoch: 15 idx: 200 First Loss : 0.907271272831235, Second Loss : 0.9194629379676711
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.4693033001571503, recall 0.44643097643097646, F1 0.3497523595925614, AUC 0.7297474747474748
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.42525252525252527, F1 0.3297491039426523, AUC 0.7137878787878789
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.5486178861788618, recall 0.494268077601411, F1 0.391583115373438, AUC 0.7500734861845973
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7892967372134039
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 16 idx: 0 First Loss : 3.6867971420288086, Second Loss : 3.5729336738586426
epoch: 16 idx: 200 First Loss : 0.9057221431997535, Second Loss : 0.9192370235333821
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3541666666666667, precision 0.46193863724351525, recall 0.441986531986532, F1 0.3420933460503563, AUC 0.7177328843995511
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.42525252525252527, F1 0.3297491039426523, AUC 0.6942929292929293
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41496598639455784, precision 0.5545876887340301, recall 0.5063198118753675, F1 0.40448618368403705, AUC 0.7460746129727611
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7842813051146384
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 17 idx: 0 First Loss : 3.6824655532836914, Second Loss : 3.5581352710723877
epoch: 17 idx: 200 First Loss : 0.9048735895886234, Second Loss : 0.9195212858942782
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.46193863724351525, recall 0.441986531986532, F1 0.3420933460503563, AUC 0.7041414141414141
  Second-Tier acc 0.375, precision 0.4682539682539682, recall 0.45303030303030306, F1 0.35539012958367794, AUC 0.6890404040404041
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5647058823529412, recall 0.5281452087007642, F1 0.4181623570503071, AUC 0.7436618165784833
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7784942680776016
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 18 idx: 0 First Loss : 3.66974139213562, Second Loss : 3.5323662757873535
epoch: 18 idx: 200 First Loss : 0.9042030619851207, Second Loss : 0.9194886126304718
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.468621345787926, recall 0.44643097643097646, F1 0.3498282987020546, AUC 0.6946127946127945
  Second-Tier acc 0.3541666666666667, precision 0.45303776683087027, recall 0.4396969696969697, F1 0.33247863247863246, AUC 0.6777272727272727
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.5637292464878673, recall 0.5200617283950617, F1 0.4106490843725424, AUC 0.7393506270821085
  Second-Tier acc 0.4897959183673469, precision 0.5952380952380952, recall 0.5804673721340388, F1 0.4792462439521263, AUC 0.7784391534391535
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
 current learn rate 2.752701059562387e-05
epoch: 19 idx: 0 First Loss : 3.682657480239868, Second Loss : 3.511687755584717
epoch: 19 idx: 200 First Loss : 0.903861545842368, Second Loss : 0.9191966125505875
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.375, precision 0.4798238135834043, recall 0.45531986531986535, F1 0.3650350691149932, AUC 0.6855050505050505
  Second-Tier acc 0.3541666666666667, precision 0.45303776683087027, recall 0.4396969696969697, F1 0.33247863247863246, AUC 0.6751010101010101
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5678104575163399, recall 0.5298353909465021, F1 0.4116022777854522, AUC 0.7373909954928473
  Second-Tier acc 0.46938775510204084, precision 0.5802469135802469, recall 0.5566578483245149, F1 0.46104422681055457, AUC 0.7791005291005292
 
 test auc: 0.7792107583774252, test F1: 0.5098039215686274  :  from epoch 8
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.4738176179135055e-05
epoch: 0 idx: 0 First Loss : 1.2315301895141602, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1149729084019637, Second Loss : 1.0957896333577029
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.70841189674523
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7548989898989898
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6523307368214776
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6526124338624338
 
 test auc: 0.6526124338624338, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 2.4738176179135055e-05
epoch: 1 idx: 0 First Loss : 2.1070234775543213, Second Loss : 2.0952444076538086
epoch: 1 idx: 200 First Loss : 1.094948200592354, Second Loss : 1.083189200480186
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7340123456790124
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.76489898989899
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.698669900058789
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7068452380952381
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 2 idx: 0 First Loss : 2.2260677814483643, Second Loss : 2.2219789028167725
epoch: 2 idx: 200 First Loss : 1.0629290072479058, Second Loss : 1.0516992795526685
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399719416386082
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7546969696969695
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7105379188712523
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7081128747795414
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 3 idx: 0 First Loss : 2.403640031814575, Second Loss : 2.383096694946289
epoch: 3 idx: 200 First Loss : 1.0323070448948377, Second Loss : 1.0233782939427527
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5763888888888888, precision 0.5994990892531876, recall 0.4260606060606061, F1 0.40604798472818776, AUC 0.7374130190796858
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7539393939393939
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6122448979591837, precision 0.4118956743002545, recall 0.46810699588477367, F1 0.41823899371069184, AUC 0.7010275818146189
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7089395943562611
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 4 idx: 0 First Loss : 2.6256885528564453, Second Loss : 2.596484422683716
epoch: 4 idx: 200 First Loss : 0.9992081208237961, Second Loss : 0.9931117106803614
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5625, precision 0.4982758620689655, recall 0.4789225589225589, F1 0.4555151046462475, AUC 0.729949494949495
  Second-Tier acc 0.6666666666666666, precision 0.6493477282950967, recall 0.6082828282828283, F1 0.5633986928104574, AUC 0.7474747474747474
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4965986394557823, precision 0.4352255177221381, recall 0.4737654320987654, F1 0.42534921219131744, AUC 0.6991598079561042
  Second-Tier acc 0.6530612244897959, precision 0.6298354582107443, recall 0.6384479717813051, F1 0.6266666666666666, AUC 0.7128527336860669
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 5 idx: 0 First Loss : 2.902489423751831, Second Loss : 2.876654624938965
epoch: 5 idx: 200 First Loss : 0.9716600949380232, Second Loss : 0.9692741742737554
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5, precision 0.500328587075575, recall 0.4774410774410775, F1 0.4308021390374332, AUC 0.7298877665544333
  Second-Tier acc 0.5833333333333334, precision 0.5927350427350427, recall 0.6127272727272728, F1 0.5702150537634408, AUC 0.7528787878787879
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.477124183006536, recall 0.5235890652557319, F1 0.43371212121212127, AUC 0.7108134920634921
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7346781305114639
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 6 idx: 0 First Loss : 3.1608874797821045, Second Loss : 3.1377553939819336
epoch: 6 idx: 200 First Loss : 0.9531046433365019, Second Loss : 0.9530869655088702
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4375, precision 0.47276541155259694, recall 0.4575420875420875, F1 0.3922275641025641, AUC 0.735016835016835
  Second-Tier acc 0.4791666666666667, precision 0.5444444444444444, recall 0.524040404040404, F1 0.4760262725779967, AUC 0.7630303030303031
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.4874960430515986, recall 0.5166078777189888, F1 0.4140786749482402, AUC 0.7198216735253773
  Second-Tier acc 0.4897959183673469, precision 0.5164721759149004, recall 0.58179012345679, F1 0.49474747474747477, AUC 0.7625110229276896
 
 test auc: 0.7068452380952381, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 2.4738176179135055e-05
epoch: 7 idx: 0 First Loss : 3.365154266357422, Second Loss : 3.3377108573913574
epoch: 7 idx: 200 First Loss : 0.9421009611968526, Second Loss : 0.9442708466239088
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.49323308270676686, recall 0.4635690235690236, F1 0.3922637526728537, AUC 0.7400841750841751
  Second-Tier acc 0.4791666666666667, precision 0.5542412617220801, recall 0.5529292929292929, F1 0.47474747474747475, AUC 0.7842929292929292
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.42857142857142855, precision 0.5027768778636553, recall 0.520135214579659, F1 0.41606976299908977, AUC 0.7285114148540076
  Second-Tier acc 0.5102040816326531, precision 0.5724867724867725, recall 0.6170634920634921, F1 0.513077913077913, AUC 0.7697310405643739
 
 test auc: 0.7697310405643739, test F1: 0.513077913077913  :  from epoch 7
 current learn rate 2.4738176179135055e-05
epoch: 8 idx: 0 First Loss : 3.529010057449341, Second Loss : 3.478729248046875
epoch: 8 idx: 200 First Loss : 0.9351670731424322, Second Loss : 0.9382842192518993
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.4623788909503195, recall 0.4356902356902357, F1 0.35449017538569777, AUC 0.7402020202020202
  Second-Tier acc 0.5208333333333334, precision 0.5907477025898079, recall 0.6135353535353536, F1 0.5212121212121211, AUC 0.7945959595959596
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.40816326530612246, precision 0.5215478784106234, recall 0.5077895355673133, F1 0.39894650598014514, AUC 0.7311752890456594
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.7704475308641975
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 9 idx: 0 First Loss : 3.6425974369049072, Second Loss : 3.584360122680664
epoch: 9 idx: 200 First Loss : 0.9295007444788419, Second Loss : 0.9339021476893802
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3680555555555556, precision 0.44820788530465944, recall 0.41309764309764313, F1 0.33158829729362166, AUC 0.7475364758698092
  Second-Tier acc 0.5, precision 0.5775803144224197, recall 0.6002020202020203, F1 0.4988562091503268, AUC 0.7935353535353536
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.5109821121431029, recall 0.4954438565549677, F1 0.38058832095529344, AUC 0.738830099941211
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.783234126984127
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 10 idx: 0 First Loss : 3.7154815196990967, Second Loss : 3.649806022644043
epoch: 10 idx: 200 First Loss : 0.9242407856879765, Second Loss : 0.9302722563508398
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.47292010514090105, recall 0.4397979797979798, F1 0.3612229250527123, AUC 0.7502076318742986
  Second-Tier acc 0.5, precision 0.5785714285714285, recall 0.6027272727272727, F1 0.5, AUC 0.7945959595959596
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.5331519274376418, recall 0.5192533803644914, F1 0.40547415547415544, AUC 0.7486466294336666
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7926036155202821
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 11 idx: 0 First Loss : 3.75593638420105, Second Loss : 3.6854944229125977
epoch: 11 idx: 200 First Loss : 0.9190851878930828, Second Loss : 0.9272229547464099
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4027777777777778, precision 0.49459064327485375, recall 0.47010101010101013, F1 0.38845307297251547, AUC 0.7494332210998879
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.784949494949495
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.5557804199342272, recall 0.550705467372134, F1 0.43044026445307754, AUC 0.7516595630021556
  Second-Tier acc 0.5102040816326531, precision 0.6076555023923446, recall 0.6285273368606702, F1 0.5104056437389771, AUC 0.7950286596119929
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 12 idx: 0 First Loss : 3.7522428035736084, Second Loss : 3.696201801300049
epoch: 12 idx: 200 First Loss : 0.9149331481865519, Second Loss : 0.9235817802819744
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.5108024691358025, recall 0.4968013468013468, F1 0.40914459138411674, AUC 0.7485521885521885
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7831818181818182
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5714285714285715, recall 0.5745149911816578, F1 0.4518690234714575, AUC 0.757991622574956
  Second-Tier acc 0.4897959183673469, precision 0.5854700854700855, recall 0.5690035273368607, F1 0.4806418219461697, AUC 0.7961860670194003
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 13 idx: 0 First Loss : 3.7612311840057373, Second Loss : 3.6886088848114014
epoch: 13 idx: 200 First Loss : 0.9098225866892695, Second Loss : 0.9215970745006696
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.4933823529411765, recall 0.47107744107744104, F1 0.38452676355902166, AUC 0.745314253647587
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7797979797979799
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5638350720317934, recall 0.5505584950029395, F1 0.43702409456631935, AUC 0.7608698314716834
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.79701278659612
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 14 idx: 0 First Loss : 3.7432548999786377, Second Loss : 3.6577017307281494
epoch: 14 idx: 200 First Loss : 0.9055753186749369, Second Loss : 0.9192284480697563
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3680555555555556, precision 0.47878787878787876, recall 0.44979797979797986, F1 0.36498316498316496, AUC 0.7378451178451177
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.756060606060606
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5797312611299984, recall 0.5740740740740741, F1 0.4490054876413607, AUC 0.7609739368998628
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7958002645502645
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 15 idx: 0 First Loss : 3.721283197402954, Second Loss : 3.6278419494628906
epoch: 15 idx: 200 First Loss : 0.9009837851276394, Second Loss : 0.917313686929949
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.4896367521367521, recall 0.46434343434343434, F1 0.3795093795093795, AUC 0.727766554433221
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.7416666666666667
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.5683111954459202, recall 0.5540858318636097, F1 0.42826077576908145, AUC 0.7607228591024887
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7975088183421516
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 16 idx: 0 First Loss : 3.6846065521240234, Second Loss : 3.6133134365081787
epoch: 16 idx: 200 First Loss : 0.8974954422994225, Second Loss : 0.9163742621501083
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3541666666666667, precision 0.4674737691686845, recall 0.432962962962963, F1 0.35058195650939644, AUC 0.7160325476992143
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7200000000000001
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.574181564894358, recall 0.5617283950617283, F1 0.4271280775275013, AUC 0.7600369880462473
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7878086419753086
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 17 idx: 0 First Loss : 3.668926239013672, Second Loss : 3.558227777481079
epoch: 17 idx: 200 First Loss : 0.8950390597876041, Second Loss : 0.9164072027761809
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.4649698960043788, recall 0.4394612794612795, F1 0.34825313343123526, AUC 0.7052918069584737
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.7031313131313132
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5731593662628146, recall 0.5557760141093474, F1 0.4253048780487805, AUC 0.7562034587497551
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7838403880070547
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 18 idx: 0 First Loss : 3.6483066082000732, Second Loss : 3.529221773147583
epoch: 18 idx: 200 First Loss : 0.8938962171868935, Second Loss : 0.917635297900835
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.46489621489621485, recall 0.44030303030303036, F1 0.34618351753183213, AUC 0.6955331088664423
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6915151515151515
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5776638707673191, recall 0.5637125220458553, F1 0.43105200448556213, AUC 0.7520821085635901
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.7815806878306878
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8
 current learn rate 2.4738176179135055e-05
epoch: 19 idx: 0 First Loss : 3.6338729858398438, Second Loss : 3.5032331943511963
epoch: 19 idx: 200 First Loss : 0.8924188094327414, Second Loss : 0.9185707620316097
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3472222222222222, precision 0.4588932619461287, recall 0.43104377104377106, F1 0.33848622104143217, AUC 0.6888888888888888
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6867676767676768
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.43537414965986393, precision 0.5814307458143074, recall 0.5734861845972957, F1 0.4308888162435072, AUC 0.7493631197334901
  Second-Tier acc 0.4489795918367347, precision 0.5665024630541872, recall 0.5264550264550264, F1 0.42847075405214935, AUC 0.777006172839506
 
 test auc: 0.7704475308641975, test F1: 0.5109347442680776  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 30, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.4388070965063813, "droprate_2": 0.0, "lr": 0.00022529156844378664, "weight_decay": 0.0007141217038107242, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00022529156844378664
epoch: 0 idx: 0 First Loss : 1.267621397972107, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0925539972177192, Second Loss : 1.0821586247181418
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.744371492704826
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7549494949494949
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7134038800705467
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7184193121693122
Test AUC: 0.7184, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022529156844378664
epoch: 1 idx: 0 First Loss : 1.7978382110595703, Second Loss : 1.849697470664978
epoch: 1 idx: 200 First Loss : 0.9782452053988158, Second Loss : 0.986581215811013
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.732418630751964
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7319696969696969
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7390444346462864
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7451499118165786
Test AUC: 0.7184, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022529156844378664
epoch: 2 idx: 0 First Loss : 2.240063428878784, Second Loss : 2.3399133682250977
epoch: 2 idx: 200 First Loss : 0.9340346130120813, Second Loss : 0.9537453361189188
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7306060606060606
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.737929292929293
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.1956521739130435, recall 0.3333333333333333, F1 0.2465753424657534, AUC 0.7449049578679209
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7474096119929453
Test AUC: 0.7184, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022529156844378664
epoch: 3 idx: 0 First Loss : 3.2053983211517334, Second Loss : 3.3027186393737793
epoch: 3 idx: 200 First Loss : 0.9070381064857564, Second Loss : 0.9418259436051496
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6597222222222222, precision 0.42113475177304965, recall 0.574949494949495, F1 0.4851120458164017, AUC 0.7237205387205389
  Second-Tier acc 0.5625, precision 0.325, recall 0.4033333333333333, F1 0.3461538461538462, AUC 0.7348484848484849
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6122448979591837, precision 0.3775510204081633, recall 0.4506172839506173, F1 0.4108293940696175, AUC 0.7053816382520086
  Second-Tier acc 0.6530612244897959, precision 0.4278455284552846, recall 0.5416666666666666, F1 0.47303921568627444, AUC 0.7242614638447972
Test AUC: 0.7184, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00022529156844378664
epoch: 4 idx: 0 First Loss : 4.357969760894775, Second Loss : 4.134627819061279
epoch: 4 idx: 200 First Loss : 0.8987544662346925, Second Loss : 0.9512750560241701
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3888888888888889, precision 0.3779677113010447, recall 0.43555555555555553, F1 0.2969934640522876, AUC 0.7487822671156005
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.757979797979798
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.42857142857142855, precision 0.3868162692847125, recall 0.4006466784244562, F1 0.3118744313011829, AUC 0.7052836566725457
  Second-Tier acc 0.46938775510204084, precision 0.4201474201474202, recall 0.4329805996472664, F1 0.34537323701410383, AUC 0.7310956790123457
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 5 idx: 0 First Loss : 3.8748228549957275, Second Loss : 4.104373931884766
epoch: 5 idx: 200 First Loss : 0.89647174765013, Second Loss : 0.9393618849351706
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3402777777777778, precision 0.35537634408602153, recall 0.40444444444444444, F1 0.25240809028941785, AUC 0.7404826038159372
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7395959595959596
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.6888166274740349
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7020502645502645
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 6 idx: 0 First Loss : 3.7760331630706787, Second Loss : 4.070667266845703
epoch: 6 idx: 200 First Loss : 0.890544665743949, Second Loss : 0.9336217348127909
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.7154489337822673
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.702878787878788
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.4490358126721763, recall 0.43209876543209874, F1 0.3241600934852469, AUC 0.6534820203801686
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6761463844797179
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 7 idx: 0 First Loss : 3.7093098163604736, Second Loss : 4.288550853729248
epoch: 7 idx: 200 First Loss : 0.88266330759275, Second Loss : 0.929391870110363
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3194444444444444, precision 0.3567708333333333, recall 0.39111111111111113, F1 0.2318840579710145, AUC 0.6719753086419753
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.6817676767676768
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.41496598639455784, precision 0.4427083333333333, recall 0.4115226337448559, F1 0.29137254901960785, AUC 0.6244611013129532
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6681547619047619
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 8 idx: 0 First Loss : 3.587951898574829, Second Loss : 4.427117347717285
epoch: 8 idx: 200 First Loss : 0.8713349806265304, Second Loss : 0.9283645365380541
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3125, precision 0.35260416666666666, recall 0.38666666666666666, F1 0.22553485162180817, AUC 0.6560942760942762
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6766666666666667
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.44020356234096686, recall 0.3991769547325103, F1 0.27181534672149055, AUC 0.6322077699392514
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.669808201058201
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 9 idx: 0 First Loss : 3.496793031692505, Second Loss : 4.419711112976074
epoch: 9 idx: 200 First Loss : 0.8644398570886642, Second Loss : 0.9240582118570151
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.6566610549943883
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.6700505050505049
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6469050068587107
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6608245149911817
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 10 idx: 0 First Loss : 3.4755232334136963, Second Loss : 4.22047758102417
epoch: 10 idx: 200 First Loss : 0.8541282516694512, Second Loss : 0.9152363358060128
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.3780427223050174, recall 0.4177777777777778, F1 0.27251967631083024, AUC 0.6537149270482604
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6726767676767677
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.6613817852243778
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6730048500881834
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 11 idx: 0 First Loss : 3.3495090007781982, Second Loss : 4.422642230987549
epoch: 11 idx: 200 First Loss : 0.8416397533094538, Second Loss : 0.9083021653122029
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.3779677113010447, recall 0.43555555555555553, F1 0.2969934640522876, AUC 0.6559090909090909
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6762121212121213
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4489795918367347, precision 0.4233947870311507, recall 0.43209876543209874, F1 0.3213118513846683, AUC 0.6692325592788556
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.673831569664903
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 12 idx: 0 First Loss : 3.4742443561553955, Second Loss : 4.404105186462402
epoch: 12 idx: 200 First Loss : 0.8389373410597967, Second Loss : 0.9013093141917098
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.4583333333333333, recall 0.4181481481481481, F1 0.2797557619539044, AUC 0.6587093153759821
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6723232323232323
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.4326617179215271, recall 0.4238683127572016, F1 0.3107226107226107, AUC 0.6681302665098962
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6755952380952381
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 13 idx: 0 First Loss : 3.2523422241210938, Second Loss : 4.048324108123779
epoch: 13 idx: 200 First Loss : 0.8387991961068445, Second Loss : 0.8940116612836179
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.40405752781101806, recall 0.42703703703703705, F1 0.29807016703394973, AUC 0.6579854096520763
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6729292929292928
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.4244827586206896, recall 0.4200470311581423, F1 0.3176498686410318, AUC 0.679147070350774
  Second-Tier acc 0.46938775510204084, precision 0.5427927927927928, recall 0.4737654320987654, F1 0.39094304388422035, AUC 0.6924052028218695
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 14 idx: 0 First Loss : 3.2882931232452393, Second Loss : 4.281298637390137
epoch: 14 idx: 200 First Loss : 0.8331677659139742, Second Loss : 0.8971198014273366
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.461484593837535, recall 0.4225925925925926, F1 0.2864035087719298, AUC 0.6619921436588103
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6784343434343434
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.6138211382113822, recall 0.44341563786008226, F1 0.34932921863614935, AUC 0.6824110817166374
  Second-Tier acc 0.46938775510204084, precision 0.5427927927927928, recall 0.4737654320987654, F1 0.39094304388422035, AUC 0.6900352733686067
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 15 idx: 0 First Loss : 3.2195827960968018, Second Loss : 4.116021156311035
epoch: 15 idx: 200 First Loss : 0.8266518881460997, Second Loss : 0.898120222870616
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.4165714285714286, recall 0.3914814814814815, F1 0.2378976726760583, AUC 0.6602076318742985
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.674949494949495
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.5769028871391076, recall 0.42283950617283944, F1 0.3158241515337006, AUC 0.6802126200274348
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.704916225749559
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 16 idx: 0 First Loss : 3.1710569858551025, Second Loss : 3.9623169898986816
epoch: 16 idx: 200 First Loss : 0.8208353059580352, Second Loss : 0.8935346674776129
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.43253968253968256, recall 0.3914814814814815, F1 0.23742845028619888, AUC 0.6588832772166104
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6724242424242424
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.6640826873385013, recall 0.42283950617283944, F1 0.3172920727745289, AUC 0.6804330785812267
  Second-Tier acc 0.42857142857142855, precision 0.5611111111111111, recall 0.4490740740740741, F1 0.3546576879910213, AUC 0.707120811287478
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 17 idx: 0 First Loss : 3.3836863040924072, Second Loss : 4.0282883644104
epoch: 17 idx: 200 First Loss : 0.8217425065846347, Second Loss : 0.8883369875205501
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.40616999487967226, recall 0.3914814814814815, F1 0.2383974081533661, AUC 0.6617171717171717
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6746969696969698
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3945578231292517, precision 0.5546806649168854, recall 0.4187242798353909, F1 0.30837053185231317, AUC 0.6809474818734079
  Second-Tier acc 0.42857142857142855, precision 0.5611111111111111, recall 0.4490740740740741, F1 0.3546576879910213, AUC 0.7099316578483245
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 18 idx: 0 First Loss : 3.324547529220581, Second Loss : 4.031797885894775
epoch: 18 idx: 200 First Loss : 0.8151839215383576, Second Loss : 0.8777016090073164
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2986111111111111, precision 0.3803763440860215, recall 0.3825925925925926, F1 0.2242444209279263, AUC 0.663641975308642
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6748484848484848
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.5050505050505051, recall 0.40226337448559674, F1 0.27802197802197803, AUC 0.6792021849892219
  Second-Tier acc 0.40816326530612246, precision 0.5333333333333333, recall 0.4367283950617284, F1 0.3325617283950617, AUC 0.7100418871252204
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 19 idx: 0 First Loss : 3.296095848083496, Second Loss : 4.01629114151001
epoch: 19 idx: 200 First Loss : 0.811953527576488, Second Loss : 0.8742131844505979
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2847222222222222, precision 0.32639370807309737, recall 0.3688888888888889, F1 0.19616184533938363, AUC 0.662401795735129
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6693434343434342
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.4385964912280702, recall 0.3662551440329218, F1 0.21992509363295878, AUC 0.6716208602782677
  Second-Tier acc 0.3469387755102041, precision 0.5111111111111111, recall 0.3996913580246913, F1 0.2639257294429708, AUC 0.711033950617284
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 20 idx: 0 First Loss : 3.2982890605926514, Second Loss : 3.983149290084839
epoch: 20 idx: 200 First Loss : 0.8148082364594809, Second Loss : 0.8766996999252568
>>>>>>>>>>> Validation Epoch: 20
  First-Tier acc 0.2847222222222222, precision 0.3276955602536998, recall 0.3688888888888889, F1 0.19781797301177143, AUC 0.666290684624018
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6717171717171717
>>>>>>>>>>> Test Epoch: 20
  First-Tier acc 0.3333333333333333, precision 0.4393939393939394, recall 0.3621399176954732, F1 0.2139498432601881, AUC 0.6724965706447188
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.7145612874779541
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 21 idx: 0 First Loss : 3.231125593185425, Second Loss : 4.039952278137207
epoch: 21 idx: 200 First Loss : 0.806170175922145, Second Loss : 0.8704294658968165
>>>>>>>>>>> Validation Epoch: 21
  First-Tier acc 0.2847222222222222, precision 0.45370370370370366, recall 0.37370370370370365, F1 0.205982905982906, AUC 0.667732884399551
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.667979797979798
>>>>>>>>>>> Test Epoch: 21
  First-Tier acc 0.3129251700680272, precision 0.43703703703703706, recall 0.3497942386831276, F1 0.18956463941508805, AUC 0.6761096413874191
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.7087191358024691
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 22 idx: 0 First Loss : 3.277679204940796, Second Loss : 4.123506546020508
epoch: 22 idx: 200 First Loss : 0.7946425555320044, Second Loss : 0.8668656460204023
>>>>>>>>>>> Validation Epoch: 22
  First-Tier acc 0.2986111111111111, precision 0.46371527777777777, recall 0.3874074074074074, F1 0.2311370925181667, AUC 0.6686363636363636
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.671060606060606
>>>>>>>>>>> Test Epoch: 22
  First-Tier acc 0.32653061224489793, precision 0.46880341880341875, recall 0.3677983539094651, F1 0.22006890611541774, AUC 0.673139574759945
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.7115299823633157
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 23 idx: 0 First Loss : 3.3281307220458984, Second Loss : 4.149839878082275
epoch: 23 idx: 200 First Loss : 0.7935469858368663, Second Loss : 0.8667863624845634
>>>>>>>>>>> Validation Epoch: 23
  First-Tier acc 0.2986111111111111, precision 0.4167036215816704, recall 0.3874074074074074, F1 0.23213953339109786, AUC 0.6710886644219979
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.666969696969697
>>>>>>>>>>> Test Epoch: 23
  First-Tier acc 0.32653061224489793, precision 0.48523622047244097, recall 0.3775720164609053, F1 0.23038635572572222, AUC 0.6745603076621597
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.7118055555555555
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 24 idx: 0 First Loss : 3.331127405166626, Second Loss : 4.24965763092041
epoch: 24 idx: 200 First Loss : 0.7925550352335915, Second Loss : 0.8696220220557388
>>>>>>>>>>> Validation Epoch: 24
  First-Tier acc 0.3055555555555556, precision 0.4127832951362363, recall 0.3918518518518519, F1 0.24117095063239494, AUC 0.6699719416386083
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6657070707070708
>>>>>>>>>>> Test Epoch: 24
  First-Tier acc 0.32653061224489793, precision 0.4911452184179457, recall 0.37970311581422694, F1 0.24680331637101505, AUC 0.6745419361160101
  Second-Tier acc 0.32653061224489793, precision 0.4861111111111111, recall 0.3758818342151676, F1 0.2511656907395359, AUC 0.7139550264550264
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 25 idx: 0 First Loss : 3.433150053024292, Second Loss : 4.314024448394775
epoch: 25 idx: 200 First Loss : 0.7913799496268442, Second Loss : 0.8678757444475538
>>>>>>>>>>> Validation Epoch: 25
  First-Tier acc 0.3263888888888889, precision 0.46296296296296297, recall 0.42444444444444446, F1 0.2857142857142857, AUC 0.6658922558922559
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6663131313131313
>>>>>>>>>>> Test Epoch: 25
  First-Tier acc 0.3197278911564626, precision 0.49800969193492556, recall 0.38749265138154027, F1 0.2569504759398166, AUC 0.6740520282186949
  Second-Tier acc 0.32653061224489793, precision 0.48928571428571427, recall 0.3758818342151676, F1 0.25091528309919114, AUC 0.7095458553791887
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 26 idx: 0 First Loss : 3.4642906188964844, Second Loss : 4.398730278015137
epoch: 26 idx: 200 First Loss : 0.7943441104528274, Second Loss : 0.8680464907942641
>>>>>>>>>>> Validation Epoch: 26
  First-Tier acc 0.2916666666666667, precision 0.40089988751406075, recall 0.3781481481481481, F1 0.21574897400820792, AUC 0.6671717171717172
  Second-Tier acc 0.2916666666666667, precision 0.35784313725490197, recall 0.37333333333333335, F1 0.23192848020434229, AUC 0.666919191919192
>>>>>>>>>>> Test Epoch: 26
  First-Tier acc 0.3129251700680272, precision 0.43781094527363185, recall 0.3497942386831276, F1 0.19046345811051693, AUC 0.6718106995884773
  Second-Tier acc 0.3469387755102041, precision 0.530952380952381, recall 0.43540564373897706, F1 0.30924231761670185, AUC 0.7108134920634921
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 27 idx: 0 First Loss : 3.5541086196899414, Second Loss : 4.343739986419678
epoch: 27 idx: 200 First Loss : 0.7915739304328011, Second Loss : 0.8625124306843563
>>>>>>>>>>> Validation Epoch: 27
  First-Tier acc 0.2777777777777778, precision 0.4075060532687651, recall 0.37888888888888883, F1 0.21411641686998953, AUC 0.6519248035914703
  Second-Tier acc 0.2916666666666667, precision 0.34649122807017546, recall 0.37333333333333335, F1 0.21862538118695754, AUC 0.6586363636363636
>>>>>>>>>>> Test Epoch: 27
  First-Tier acc 0.32653061224489793, precision 0.5024154589371981, recall 0.38947677836566724, F1 0.2527191911700325, AUC 0.6763056045463453
  Second-Tier acc 0.32653061224489793, precision 0.5110565110565111, recall 0.4052028218694885, F1 0.26391960292889083, AUC 0.7053571428571428
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 28 idx: 0 First Loss : 3.615903615951538, Second Loss : 4.157464027404785
epoch: 28 idx: 200 First Loss : 0.7967727144709589, Second Loss : 0.8627559934496143
>>>>>>>>>>> Validation Epoch: 28
  First-Tier acc 0.2847222222222222, precision 0.4189624764337408, recall 0.37767676767676767, F1 0.23084995498072822, AUC 0.6474579124579124
  Second-Tier acc 0.2916666666666667, precision 0.3547619047619048, recall 0.37333333333333335, F1 0.22838580709645176, AUC 0.6468686868686868
>>>>>>>>>>> Test Epoch: 28
  First-Tier acc 0.3129251700680272, precision 0.4898721730580138, recall 0.37360376249265137, F1 0.24419612528404433, AUC 0.6804943170683911
  Second-Tier acc 0.3469387755102041, precision 0.517117117117117, recall 0.41754850088183426, F1 0.28998572609120277, AUC 0.6963734567901235
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4)
Current LR: 0.00022529156844378664
epoch: 29 idx: 0 First Loss : 3.822467803955078, Second Loss : 4.297022819519043
epoch: 29 idx: 200 First Loss : 0.808046868479712, Second Loss : 0.8714354185423868
>>>>>>>>>>> Validation Epoch: 29
  First-Tier acc 0.2777777777777778, precision 0.4220430107526882, recall 0.37888888888888883, F1 0.212676408142875, AUC 0.6568883277216611
  Second-Tier acc 0.3333333333333333, precision 0.4201388888888889, recall 0.42888888888888893, F1 0.29506370845584956, AUC 0.6549242424242424
>>>>>>>>>>> Test Epoch: 29
  First-Tier acc 0.3129251700680272, precision 0.4630860095976375, recall 0.3557466196355085, F1 0.2087604632496273, AUC 0.6723802175191066
  Second-Tier acc 0.32653061224489793, precision 0.5224089635854342, recall 0.4230599647266314, F1 0.28138528138528135, AUC 0.6899250440917107
Test AUC: 0.7311, Test F1: 0.3454 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.49957942388043625, "droprate_2": 0.0, "lr": 1.851131339968989e-05, "weight_decay": 1.1746862063050548e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_1", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.851131339968989e-05
epoch: 0 idx: 0 First Loss : 1.1821609735488892, Second Loss : 1.1108416318893433
epoch: 0 idx: 200 First Loss : 1.072670719516811, Second Loss : 1.0612205516046553
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7040852974186308
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7063131313131312
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6050546247305506
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6503527336860669
Test AUC: 0.6504, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.851131339968989e-05
epoch: 1 idx: 0 First Loss : 1.9703620672225952, Second Loss : 1.9624470472335815
epoch: 1 idx: 200 First Loss : 1.0810799672087628, Second Loss : 1.074901582070844
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7322334455667789
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7315656565656564
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6523429845189105
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.67961860670194
Test AUC: 0.6796, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.851131339968989e-05
epoch: 2 idx: 0 First Loss : 1.9855642318725586, Second Loss : 2.0114011764526367
epoch: 2 idx: 200 First Loss : 1.0623391386288314, Second Loss : 1.0589613288047894
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.745942760942761
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7492424242424242
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6818905545757398
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7043650793650794
Test AUC: 0.7044, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.851131339968989e-05
epoch: 3 idx: 0 First Loss : 2.0159409046173096, Second Loss : 2.065143346786499
epoch: 3 idx: 200 First Loss : 1.0427276849450164, Second Loss : 1.0450067317752696
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7449270482603816
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7555050505050503
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7001212522045855
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7104828042328042
Test AUC: 0.7105, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.851131339968989e-05
epoch: 4 idx: 0 First Loss : 2.059720039367676, Second Loss : 2.132814645767212
epoch: 4 idx: 200 First Loss : 1.0261580803945882, Second Loss : 1.0321126821177515
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7440628507295175
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7578787878787878
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099990201842052
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099867724867724
Test AUC: 0.7100, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.851131339968989e-05
epoch: 5 idx: 0 First Loss : 2.091632604598999, Second Loss : 2.196834087371826
epoch: 5 idx: 200 First Loss : 1.0093490167785046, Second Loss : 1.0195404833080757
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.44825870646766175, recall 0.40525252525252525, F1 0.3568858721857498, AUC 0.7460381593714928
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7558080808080808
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5578231292517006, precision 0.3528735632183908, recall 0.3412698412698412, F1 0.25408956824886025, AUC 0.7039057907113463
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7054673721340388
Test AUC: 0.7100, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.851131339968989e-05
epoch: 6 idx: 0 First Loss : 2.121189832687378, Second Loss : 2.2734527587890625
epoch: 6 idx: 200 First Loss : 0.9926839712173191, Second Loss : 1.006389186156923
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7449102132435467
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7558585858585859
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5850340136054422, precision 0.3285361842105263, recall 0.38065843621399176, F1 0.3284963526551102, AUC 0.7000845091122869
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7007275132275131
Test AUC: 0.7100, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.851131339968989e-05
epoch: 7 idx: 0 First Loss : 2.1634907722473145, Second Loss : 2.3406057357788086
epoch: 7 idx: 200 First Loss : 0.977167625851299, Second Loss : 0.9939303902251211
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6458333333333334, precision 0.4119584675975654, recall 0.5604040404040403, F1 0.4741272118603539, AUC 0.742615039281706
  Second-Tier acc 0.6875, precision 0.4407407407407408, recall 0.6096969696969697, F1 0.5086729362591432, AUC 0.764090909090909
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5374149659863946, precision 0.49434421534937, recall 0.399838330393886, F1 0.38003137104260704, AUC 0.7040588869292573
  Second-Tier acc 0.5714285714285714, precision 0.5261437908496732, recall 0.4552469135802469, F1 0.4511224297302396, AUC 0.7068452380952381
Test AUC: 0.7068, Test F1: 0.4511 (Best Epoch: 7)
Current LR: 1.851131339968989e-05
epoch: 8 idx: 0 First Loss : 2.211184501647949, Second Loss : 2.4150140285491943
epoch: 8 idx: 200 First Loss : 0.9614940072173503, Second Loss : 0.9817268730544332
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.4118773946360153, recall 0.5672727272727273, F1 0.4731123133120636, AUC 0.7420145903479236
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7609090909090908
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5510204081632653, precision 0.5208835341365462, recall 0.44459141681363906, F1 0.42805902848944455, AUC 0.7119280325298843
  Second-Tier acc 0.5918367346938775, precision 0.56, recall 0.5491622574955909, F1 0.5483058608058607, AUC 0.7157738095238094
Test AUC: 0.7068, Test F1: 0.4511 (Best Epoch: 7)
Current LR: 1.851131339968989e-05
epoch: 9 idx: 0 First Loss : 2.2484683990478516, Second Loss : 2.477644920349121
epoch: 9 idx: 200 First Loss : 0.9458158208956173, Second Loss : 0.9691396786354074
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5972222222222222, precision 0.5337061585197459, recall 0.5558922558922559, F1 0.475081019628859, AUC 0.7432379349046014
  Second-Tier acc 0.6666666666666666, precision 0.6025641025641025, recall 0.6108080808080808, F1 0.5371826149814765, AUC 0.7576767676767676
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5578231292517006, precision 0.5205532713187336, recall 0.47758671369782474, F1 0.4578297966822089, AUC 0.716876102292769
  Second-Tier acc 0.6122448979591837, precision 0.5836940836940837, recall 0.5844356261022927, F1 0.5700680272108843, AUC 0.722773368606702
Test AUC: 0.7068, Test F1: 0.4511 (Best Epoch: 7)
Current LR: 1.851131339968989e-05
epoch: 10 idx: 0 First Loss : 2.288590431213379, Second Loss : 2.528235912322998
epoch: 10 idx: 200 First Loss : 0.9314316052813731, Second Loss : 0.958270442704508
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5555555555555556, precision 0.49933862433862425, recall 0.534040404040404, F1 0.46045548654244306, AUC 0.7455443322109989
  Second-Tier acc 0.625, precision 0.5647907647907648, recall 0.5985858585858586, F1 0.5420838548185232, AUC 0.7663636363636362
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5306122448979592, precision 0.474016874016874, recall 0.4611258083480306, F1 0.4384531590413943, AUC 0.7218854105428179
  Second-Tier acc 0.5918367346938775, precision 0.5813397129186603, recall 0.5899470899470899, F1 0.5692431561996779, AUC 0.7318121693121693
Test AUC: 0.7318, Test F1: 0.5692 (Best Epoch: 10)
Current LR: 1.851131339968989e-05
epoch: 11 idx: 0 First Loss : 2.324756622314453, Second Loss : 2.5658092498779297
epoch: 11 idx: 200 First Loss : 0.9175236510363087, Second Loss : 0.9479465831386212
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5347222222222222, precision 0.5047483380816714, recall 0.5311784511784512, F1 0.457957957957958, AUC 0.748361391694725
  Second-Tier acc 0.5416666666666666, precision 0.5423669467787114, recall 0.5427272727272728, F1 0.4989139515455305, AUC 0.7713131313131313
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5238095238095238, precision 0.47679269882659714, recall 0.46083186360964135, F1 0.4350140056022409, AUC 0.7293687536743092
  Second-Tier acc 0.5714285714285714, precision 0.5675854883016008, recall 0.5776014109347443, F1 0.5491641373994316, AUC 0.7412918871252204
Test AUC: 0.7413, Test F1: 0.5492 (Best Epoch: 11)
Current LR: 1.851131339968989e-05
epoch: 12 idx: 0 First Loss : 2.354719638824463, Second Loss : 2.599039077758789
epoch: 12 idx: 200 First Loss : 0.904383946636423, Second Loss : 0.9381720614781723
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5416666666666666, precision 0.5717678941495298, recall 0.5605387205387206, F1 0.4970057424118129, AUC 0.7499158249158248
  Second-Tier acc 0.5208333333333334, precision 0.5771604938271605, recall 0.5608080808080808, F1 0.5006209216735532, AUC 0.7795959595959596
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5034013605442177, precision 0.4809255784865541, recall 0.4582598471487361, F1 0.4338636477855493, AUC 0.7362152165392907
  Second-Tier acc 0.5918367346938775, precision 0.5926916221033868, recall 0.6192680776014109, F1 0.5824915824915825, AUC 0.7562279541446207
Test AUC: 0.7562, Test F1: 0.5825 (Best Epoch: 12)
Current LR: 1.851131339968989e-05
epoch: 13 idx: 0 First Loss : 2.3832576274871826, Second Loss : 2.62817120552063
epoch: 13 idx: 200 First Loss : 0.8917775541840501, Second Loss : 0.9294689049508738
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.5138888888888888, precision 0.5443732720155484, recall 0.5419191919191919, F1 0.4800362976406533, AUC 0.7557182940516274
  Second-Tier acc 0.5208333333333334, precision 0.5771604938271605, recall 0.5608080808080808, F1 0.5006209216735532, AUC 0.7905555555555557
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.47619047619047616, precision 0.4662790697674419, recall 0.4417989417989418, F1 0.4133928571428571, AUC 0.7408815892612189
  Second-Tier acc 0.5714285714285714, precision 0.582427536231884, recall 0.6069223985890653, F1 0.5669157529622646, AUC 0.7613536155202821
Test AUC: 0.7614, Test F1: 0.5669 (Best Epoch: 13)
Current LR: 1.851131339968989e-05
epoch: 14 idx: 0 First Loss : 2.40649151802063, Second Loss : 2.655531644821167
epoch: 14 idx: 200 First Loss : 0.8796288851111089, Second Loss : 0.9214616907362024
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4861111111111111, precision 0.5247612069901226, recall 0.5241414141414141, F1 0.45693760262725786, AUC 0.7592199775533107
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.7956565656565657
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4557823129251701, precision 0.4632200158515947, recall 0.43709582598471486, F1 0.397562533785444, AUC 0.7464420438957475
  Second-Tier acc 0.5102040816326531, precision 0.5412587412587413, recall 0.5698853615520282, F1 0.5130454340980656, AUC 0.7705577601410935
Test AUC: 0.7706, Test F1: 0.5130 (Best Epoch: 14)
Current LR: 1.851131339968989e-05
epoch: 15 idx: 0 First Loss : 2.42789888381958, Second Loss : 2.6798195838928223
epoch: 15 idx: 200 First Loss : 0.8685021932000545, Second Loss : 0.9137858122642806
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4791666666666667, precision 0.5326020384843914, recall 0.5301683501683502, F1 0.4555076308311227, AUC 0.7621604938271606
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.8006565656565656
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4557823129251701, precision 0.46751843376557334, recall 0.4409171075837743, F1 0.3971347792937518, AUC 0.750097981579463
  Second-Tier acc 0.5102040816326531, precision 0.5412587412587413, recall 0.5698853615520282, F1 0.5130454340980656, AUC 0.7787147266313932
Test AUC: 0.7787, Test F1: 0.5130 (Best Epoch: 15)
Current LR: 1.851131339968989e-05
epoch: 16 idx: 0 First Loss : 2.4473249912261963, Second Loss : 2.701730966567993
epoch: 16 idx: 200 First Loss : 0.8581576118736867, Second Loss : 0.9067741722072387
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4722222222222222, precision 0.5434653043848446, recall 0.5305387205387205, F1 0.4537037037037037, AUC 0.7662401795735129
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.8036868686868687
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.48264811300864435, recall 0.44885361552028225, F1 0.4024203386522227, AUC 0.7529639427787576
  Second-Tier acc 0.5306122448979592, precision 0.5870370370370371, recall 0.6051587301587301, F1 0.5239507800483411, AUC 0.7760141093474427
Test AUC: 0.7760, Test F1: 0.5240 (Best Epoch: 16)
Current LR: 1.851131339968989e-05
epoch: 17 idx: 0 First Loss : 2.4650604724884033, Second Loss : 2.716801166534424
epoch: 17 idx: 200 First Loss : 0.8486764723833521, Second Loss : 0.9003399985828506
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4583333333333333, precision 0.5340909090909091, recall 0.5216498316498317, F1 0.44072203723020137, AUC 0.7669248035914702
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.8102020202020203
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.48299319727891155, precision 0.5207509881422925, recall 0.4845679012345679, F1 0.4365244714641893, AUC 0.7556278169704096
  Second-Tier acc 0.5510204081632653, precision 0.6300366300366301, recall 0.6468253968253969, F1 0.5484848484848485, AUC 0.7848324514991182
Test AUC: 0.7848, Test F1: 0.5485 (Best Epoch: 17)
Current LR: 1.851131339968989e-05
epoch: 18 idx: 0 First Loss : 2.4815263748168945, Second Loss : 2.7302980422973633
epoch: 18 idx: 200 First Loss : 0.8395027609643948, Second Loss : 0.8940540606350597
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4513888888888889, precision 0.5278116413173884, recall 0.5172053872053872, F1 0.43394620827775904, AUC 0.768047138047138
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.8091919191919192
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5221811080275466, recall 0.47633744855967075, F1 0.4248431785978719, AUC 0.7570056829316089
  Second-Tier acc 0.5510204081632653, precision 0.6300366300366301, recall 0.6468253968253969, F1 0.5484848484848485, AUC 0.7849426807760141
Test AUC: 0.7848, Test F1: 0.5485 (Best Epoch: 17)
Current LR: 1.851131339968989e-05
epoch: 19 idx: 0 First Loss : 2.4914329051971436, Second Loss : 2.738370656967163
epoch: 19 idx: 200 First Loss : 0.8309381000549343, Second Loss : 0.8882125560008917
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4375, precision 0.5152733806793873, recall 0.5026599326599327, F1 0.42133392443721984, AUC 0.7672895622895624
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.8070707070707072
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46938775510204084, precision 0.5291261895933753, recall 0.48611111111111116, F1 0.4317139650472983, AUC 0.7565157750342936
  Second-Tier acc 0.5510204081632653, precision 0.6300366300366301, recall 0.6468253968253969, F1 0.5484848484848485, AUC 0.7871472663139331
Test AUC: 0.7848, Test F1: 0.5485 (Best Epoch: 17){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.22639187454159052, "droprate_2": 0.0, "lr": 4.49802356395971e-05, "weight_decay": 4.031117225215412e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 4.49802356395971e-05
epoch: 0 idx: 0 First Loss : 1.2499417066574097, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1216827888245606, Second Loss : 1.115718642722315
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7286531986531987
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7545454545454545
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6854117675876935
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6836970899470899
Test AUC: 0.6837, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.49802356395971e-05
epoch: 1 idx: 0 First Loss : 2.1583011150360107, Second Loss : 2.1423914432525635
epoch: 1 idx: 200 First Loss : 1.056101225872538, Second Loss : 1.0529679832470358
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7409988776655444
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7522727272727273
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7122403488144228
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.706955467372134
Test AUC: 0.6837, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.49802356395971e-05
epoch: 2 idx: 0 First Loss : 2.3535890579223633, Second Loss : 2.331540822982788
epoch: 2 idx: 200 First Loss : 1.007029106960961, Second Loss : 1.0046314992640741
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6388888888888888, precision 0.6123246569583, recall 0.5201010101010101, F1 0.5277430038085775, AUC 0.7344444444444443
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7537878787878788
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6258503401360545, precision 0.592001092001092, recall 0.5421810699588477, F1 0.5327596618357489, AUC 0.6955161179698216
  Second-Tier acc 0.5714285714285714, precision 0.35185185185185186, recall 0.40299823633156967, F1 0.3715913715913716, AUC 0.6984126984126985
Test AUC: 0.6837, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.49802356395971e-05
epoch: 3 idx: 0 First Loss : 2.726590156555176, Second Loss : 2.697657823562622
epoch: 3 idx: 200 First Loss : 0.9646775159447347, Second Loss : 0.9671129449757178
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5555555555555556, precision 0.5353305337039885, recall 0.5438047138047138, F1 0.5224754190844617, AUC 0.7287485970819304
  Second-Tier acc 0.5625, precision 0.5261904761904762, recall 0.5340404040404041, F1 0.5246191007060573, AUC 0.7460101010101011
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5102040816326531, precision 0.48014184397163123, recall 0.5185185185185185, F1 0.4768218374422282, AUC 0.7033240250832843
  Second-Tier acc 0.6326530612244898, precision 0.6239316239316239, recall 0.6911375661375662, F1 0.6319444444444443, AUC 0.7246472663139331
Test AUC: 0.6837, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 4.49802356395971e-05
epoch: 4 idx: 0 First Loss : 3.2059009075164795, Second Loss : 3.159294366836548
epoch: 4 idx: 200 First Loss : 0.9413834911636749, Second Loss : 0.9462364771732347
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4583333333333333, precision 0.48771643160188055, recall 0.48387205387205384, F1 0.4347732105625029, AUC 0.7455611672278338
  Second-Tier acc 0.5208333333333334, precision 0.5833333333333334, recall 0.5821212121212122, F1 0.5219662058371736, AUC 0.7658080808080808
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4421768707482993, precision 0.4791644425465285, recall 0.5105085243974132, F1 0.4356678942229921, AUC 0.7187806192435823
  Second-Tier acc 0.5102040816326531, precision 0.5215686274509804, recall 0.5826719576719577, F1 0.5061751152073732, AUC 0.7565586419753086
Test AUC: 0.7566, Test F1: 0.5062 (Best Epoch: 4)
Current LR: 4.49802356395971e-05
epoch: 5 idx: 0 First Loss : 3.5661725997924805, Second Loss : 3.5206756591796875
epoch: 5 idx: 200 First Loss : 0.9329692723498267, Second Loss : 0.939756763153779
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4722222222222222, precision 0.5308264710928118, recall 0.521885521885522, F1 0.4649429738426502, AUC 0.74841189674523
  Second-Tier acc 0.5, precision 0.5708576998050682, recall 0.5687878787878787, F1 0.5009487666034156, AUC 0.7735353535353534
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4557823129251701, precision 0.5089423088758416, recall 0.5340241034685479, F1 0.4559216456762733, AUC 0.7270416911620615
  Second-Tier acc 0.4897959183673469, precision 0.5316993464052288, recall 0.58179012345679, F1 0.49486173956762186, AUC 0.7646053791887125
Test AUC: 0.7646, Test F1: 0.4949 (Best Epoch: 5)
Current LR: 4.49802356395971e-05
epoch: 6 idx: 0 First Loss : 3.807798385620117, Second Loss : 3.757904052734375
epoch: 6 idx: 200 First Loss : 0.9310458305092594, Second Loss : 0.9382175050156923
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4861111111111111, precision 0.5520158108596417, recall 0.559057239057239, F1 0.48580253214324864, AUC 0.7544781144781144
  Second-Tier acc 0.5, precision 0.5714285714285714, recall 0.5713131313131313, F1 0.5013071895424837, AUC 0.7821212121212122
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.5733667017913593, recall 0.5751028806584362, F1 0.48474874712176624, AUC 0.7366867528904567
  Second-Tier acc 0.5102040816326531, precision 0.566798418972332, recall 0.5877425044091711, F1 0.5115138021316511, AUC 0.7782738095238094
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 7 idx: 0 First Loss : 3.9371278285980225, Second Loss : 3.874417304992676
epoch: 7 idx: 200 First Loss : 0.9274184306138264, Second Loss : 0.9379228562376096
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4444444444444444, precision 0.5355815681902638, recall 0.5156565656565656, F1 0.44547212824523746, AUC 0.7575308641975309
  Second-Tier acc 0.5, precision 0.5768518518518518, recall 0.5738383838383839, F1 0.5011308226994501, AUC 0.7772727272727273
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.47619047619047616, precision 0.5694172494172495, recall 0.5590828924162258, F1 0.47447280799112096, AUC 0.7500122476974328
  Second-Tier acc 0.5102040816326531, precision 0.5934065934065934, recall 0.5813492063492064, F1 0.5015151515151516, AUC 0.7966269841269842
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 8 idx: 0 First Loss : 3.9878904819488525, Second Loss : 3.9056484699249268
epoch: 8 idx: 200 First Loss : 0.9227478766596102, Second Loss : 0.9355380286634043
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4305555555555556, precision 0.527408947901669, recall 0.5092929292929292, F1 0.42859971998084084, AUC 0.7552749719416386
  Second-Tier acc 0.4375, precision 0.5185185185185185, recall 0.4905050505050505, F1 0.4258685930512556, AUC 0.7681313131313131
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5849445041174365, recall 0.5726778365667254, F1 0.472787206496837, AUC 0.7566504997060552
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7975088183421516
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 9 idx: 0 First Loss : 4.022320747375488, Second Loss : 3.915895700454712
epoch: 9 idx: 200 First Loss : 0.9179955347341517, Second Loss : 0.9324521052034859
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.49970760233918127, recall 0.4661279461279461, F1 0.39307136342385013, AUC 0.7479573512906846
  Second-Tier acc 0.3958333333333333, precision 0.4664112388250319, recall 0.434949494949495, F1 0.36746880570409984, AUC 0.7489393939393939
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4897959183673469, precision 0.5963487071977638, recall 0.6004556143445031, F1 0.4881835362162393, AUC 0.7614944640407604
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.796957671957672
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 10 idx: 0 First Loss : 3.9969189167022705, Second Loss : 3.903240919113159
epoch: 10 idx: 200 First Loss : 0.9133954700679097, Second Loss : 0.9289176455914363
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.48964598856869257, recall 0.4580808080808081, F1 0.3768183332407973, AUC 0.7364983164983165
  Second-Tier acc 0.3958333333333333, precision 0.46626984126984133, recall 0.4519191919191919, F1 0.36790986790986796, AUC 0.7282828282828283
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5838530838530839, recall 0.5745149911816578, F1 0.4675634319063378, AUC 0.7619782480893592
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7889109347442681
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 11 idx: 0 First Loss : 3.969623327255249, Second Loss : 3.8515777587890625
epoch: 11 idx: 200 First Loss : 0.9089544773175942, Second Loss : 0.9251694207314856
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.47504171881518564, recall 0.4452188552188552, F1 0.35925927642853067, AUC 0.7202132435465769
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.705050505050505
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.46258503401360546, precision 0.5826585695006747, recall 0.5682686654908876, F1 0.45658043413618793, AUC 0.7601349696257103
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7870370370370369
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 12 idx: 0 First Loss : 3.955598831176758, Second Loss : 3.825716257095337
epoch: 12 idx: 200 First Loss : 0.9055326117853638, Second Loss : 0.9235906003761819
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3819444444444444, precision 0.48556998556998554, recall 0.4589225589225589, F1 0.37490656086481516, AUC 0.7081649831649832
  Second-Tier acc 0.375, precision 0.45621237000547343, recall 0.4385858585858586, F1 0.34722222222222227, AUC 0.6963131313131313
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5793153326904532, recall 0.5681216931216931, F1 0.4459893048128342, AUC 0.754121350186165
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7840057319223986
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 13 idx: 0 First Loss : 3.97196364402771, Second Loss : 3.856903553009033
epoch: 13 idx: 200 First Loss : 0.9056661648815382, Second Loss : 0.9216442118124892
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3680555555555556, precision 0.47556336456938864, recall 0.4508754208754209, F1 0.3574063938048613, AUC 0.6943041526374859
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.6831313131313131
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.561872090173977, recall 0.524323927101705, F1 0.4191858561606461, AUC 0.7502572016460904
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7799823633156967
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 14 idx: 0 First Loss : 3.9279985427856445, Second Loss : 3.775315999984741
epoch: 14 idx: 200 First Loss : 0.9026027988582799, Second Loss : 0.9195483433263983
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3541666666666667, precision 0.4629356010857193, recall 0.43151515151515146, F1 0.34367042103250095, AUC 0.6883277216610549
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.68010101010101
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5786224821312541, recall 0.5600382128159906, F1 0.44173636425452406, AUC 0.7485425240054869
  Second-Tier acc 0.46938775510204084, precision 0.5785256410256411, recall 0.5566578483245149, F1 0.4594771241830065, AUC 0.7819664902998236
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 15 idx: 0 First Loss : 3.890408754348755, Second Loss : 3.7498300075531006
epoch: 15 idx: 200 First Loss : 0.9021279099702879, Second Loss : 0.9180176283633371
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.375, precision 0.4762828535669586, recall 0.45616161616161616, F1 0.36302655794397287, AUC 0.685381593714927
  Second-Tier acc 0.3958333333333333, precision 0.48399014778325117, recall 0.4663636363636363, F1 0.375, AUC 0.6853535353535354
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5801158301158301, recall 0.5659905937683716, F1 0.44380717804363123, AUC 0.7469870664315108
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7794312169312171
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 16 idx: 0 First Loss : 3.873555898666382, Second Loss : 3.7820518016815186
epoch: 16 idx: 200 First Loss : 0.9005460789602653, Second Loss : 0.9176098797697659
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.46407385517905614, recall 0.4424579124579125, F1 0.3473341989511933, AUC 0.68837822671156
  Second-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.4663636363636363, F1 0.3759401709401709, AUC 0.6920202020202021
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5767145135566188, recall 0.5559229864785421, F1 0.4342165118026234, AUC 0.7445865177346659
  Second-Tier acc 0.4897959183673469, precision 0.5925925925925926, recall 0.5804673721340388, F1 0.4773043894121805, AUC 0.7734788359788359
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 17 idx: 0 First Loss : 3.831899642944336, Second Loss : 3.712252378463745
epoch: 17 idx: 200 First Loss : 0.8990689610084461, Second Loss : 0.9156748549630448
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3819444444444444, precision 0.4823885918003565, recall 0.46542087542087546, F1 0.3719214388577381, AUC 0.6890684624017958
  Second-Tier acc 0.3958333333333333, precision 0.4805996472663139, recall 0.4663636363636363, F1 0.377361673414305, AUC 0.695858585858586
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4421768707482993, precision 0.5808270676691729, recall 0.5656966490299823, F1 0.4349576271186441, AUC 0.739730305702528
  Second-Tier acc 0.46938775510204084, precision 0.5856481481481481, recall 0.5681216931216931, F1 0.4552229613205223, AUC 0.7689594356261021
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 18 idx: 0 First Loss : 3.793658494949341, Second Loss : 3.7071633338928223
epoch: 18 idx: 200 First Loss : 0.8979363825049979, Second Loss : 0.9134076182345775
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3888888888888889, precision 0.48869783810960277, recall 0.47468013468013465, F1 0.3803493875957644, AUC 0.6878395061728395
  Second-Tier acc 0.3958333333333333, precision 0.4805996472663139, recall 0.4663636363636363, F1 0.377361673414305, AUC 0.6972222222222223
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5709185329438494, recall 0.542034097589653, F1 0.42662505287671765, AUC 0.7346842543601803
  Second-Tier acc 0.4489795918367347, precision 0.579520697167756, recall 0.5557760141093474, F1 0.4326219512195122, AUC 0.767691798941799
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6)
Current LR: 4.49802356395971e-05
epoch: 19 idx: 0 First Loss : 3.7977588176727295, Second Loss : 3.6996898651123047
epoch: 19 idx: 200 First Loss : 0.8960241842081751, Second Loss : 0.9107640501293753
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.48425339366515835, recall 0.4645791245791246, F1 0.37417654808959155, AUC 0.687766554433221
  Second-Tier acc 0.3958333333333333, precision 0.48154761904761906, recall 0.4663636363636363, F1 0.38161375661375657, AUC 0.6985353535353536
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5772504708097929, recall 0.5574661963550852, F1 0.41911307714947815, AUC 0.7308507250636881
  Second-Tier acc 0.46938775510204084, precision 0.5982905982905983, recall 0.5974426807760141, F1 0.4580128205128205, AUC 0.7671957671957671
Test AUC: 0.7783, Test F1: 0.5115 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.2651441271673904, "droprate_2": 0.0, "lr": 0.00025083649648644554, "weight_decay": 0.00018187698859138703, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00025083649648644554
epoch: 0 idx: 0 First Loss : 1.2409356832504272, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0854992799979835, Second Loss : 1.0757597365708493
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337822671156005
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7525757575757576
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7007336370762296
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7152777777777777
Test AUC: 0.7153, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00025083649648644554
epoch: 1 idx: 0 First Loss : 1.8021186590194702, Second Loss : 1.8944249153137207
epoch: 1 idx: 200 First Loss : 0.9868586640897675, Second Loss : 0.9837849117185345
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7269472502805835
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7346464646464647
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7465400254752107
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7498346560846562
Test AUC: 0.7153, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00025083649648644554
epoch: 2 idx: 0 First Loss : 1.9813898801803589, Second Loss : 2.002246141433716
epoch: 2 idx: 200 First Loss : 0.9534522984825556, Second Loss : 0.9531757852331323
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7282379349046016
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7286868686868687
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7243349500293945
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.726245590828924
Test AUC: 0.7153, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00025083649648644554
epoch: 3 idx: 0 First Loss : 2.7735071182250977, Second Loss : 2.959656238555908
epoch: 3 idx: 200 First Loss : 0.93262432727833, Second Loss : 0.9437221314535656
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5555555555555556, precision 0.553621232568601, recall 0.5386195286195287, F1 0.5152225989664414, AUC 0.7284231200897867
  Second-Tier acc 0.4791666666666667, precision 0.39355742296918766, recall 0.49333333333333335, F1 0.3680911680911681, AUC 0.7490404040404041
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.5336715367965368, recall 0.5420340975896532, F1 0.5218631719741599, AUC 0.6927787575935724
  Second-Tier acc 0.4897959183673469, precision 0.3819444444444444, recall 0.42239858906525574, F1 0.35757875639122544, AUC 0.7138999118165784
Test AUC: 0.7153, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00025083649648644554
epoch: 4 idx: 0 First Loss : 3.2707741260528564, Second Loss : 3.509725332260132
epoch: 4 idx: 200 First Loss : 0.9196197820007245, Second Loss : 0.9287769341266793
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.7271324354657688
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7654040404040403
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.43537414965986393, precision 0.4305555555555556, recall 0.4200470311581423, F1 0.3116883116883117, AUC 0.6845544287673917
  Second-Tier acc 0.4897959183673469, precision 0.4594594594594595, recall 0.4567901234567901, F1 0.3631867161278926, AUC 0.7069554673721341
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 5 idx: 0 First Loss : 3.4497764110565186, Second Loss : 3.6593966484069824
epoch: 5 idx: 200 First Loss : 0.915689602735179, Second Loss : 0.9242923675239345
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.721043771043771
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.74989898989899
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6597834607093866
  Second-Tier acc 0.4897959183673469, precision 0.4594594594594595, recall 0.4567901234567901, F1 0.3631867161278926, AUC 0.6866181657848324
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 6 idx: 0 First Loss : 3.3865718841552734, Second Loss : 3.6757185459136963
epoch: 6 idx: 200 First Loss : 0.9055317072348382, Second Loss : 0.9165577260656884
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6918294051627386
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.719191919191919
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.4490358126721763, recall 0.43621399176954734, F1 0.32901184550681023, AUC 0.6673464138741917
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.6753747795414462
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 7 idx: 0 First Loss : 3.2979605197906494, Second Loss : 3.5822553634643555
epoch: 7 idx: 200 First Loss : 0.900189767116727, Second Loss : 0.9104100244284251
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.3795454545454546, recall 0.4177777777777778, F1 0.2743750421130651, AUC 0.6806341189674523
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7055050505050505
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.44808743169398907, recall 0.43209876543209874, F1 0.32311265969802555, AUC 0.6623799725651578
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6528880070546738
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 8 idx: 0 First Loss : 3.327486753463745, Second Loss : 3.624506711959839
epoch: 8 idx: 200 First Loss : 0.8901638651274802, Second Loss : 0.9066777118401769
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3472222222222222, precision 0.375, recall 0.40888888888888886, F1 0.26308909528723773, AUC 0.6850448933782266
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7112121212121213
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6745970507544582
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6534942680776015
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 9 idx: 0 First Loss : 3.450010061264038, Second Loss : 3.69606876373291
epoch: 9 idx: 200 First Loss : 0.8948231231367948, Second Loss : 0.9092138858853182
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.5489587139203508, recall 0.4314814814814814, F1 0.2983351235230935, AUC 0.6918967452300787
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7134343434343434
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.45, recall 0.44032921810699593, F1 0.33483327564324444, AUC 0.6749706055261612
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6532738095238095
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 10 idx: 0 First Loss : 3.608870267868042, Second Loss : 3.6789088249206543
epoch: 10 idx: 200 First Loss : 0.9021582652183958, Second Loss : 0.909112955392014
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.4657192959945254, recall 0.44555555555555554, F1 0.3263300964352635, AUC 0.6755387205387205
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7092424242424243
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5454227812718379, recall 0.4656819517930629, F1 0.3979721479721479, AUC 0.6772792964922595
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6714065255731922
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 11 idx: 0 First Loss : 3.3266141414642334, Second Loss : 4.079868316650391
epoch: 11 idx: 200 First Loss : 0.8873386608621462, Second Loss : 0.9100770601681005
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6712850729517396
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.7012121212121212
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3877551020408163, precision 0.4444444444444444, recall 0.3950617283950617, F1 0.2708333333333333, AUC 0.6624044679600235
  Second-Tier acc 0.40816326530612246, precision 0.45, recall 0.40740740740740744, F1 0.2940516273849607, AUC 0.6611552028218695
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 12 idx: 0 First Loss : 3.3086111545562744, Second Loss : 3.6880087852478027
epoch: 12 idx: 200 First Loss : 0.8805291844724181, Second Loss : 0.9062272651663713
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3125, precision 0.35537634408602153, recall 0.38666666666666666, F1 0.22901627742392075, AUC 0.6724635241301907
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6915151515151515
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3741496598639456, precision 0.4444444444444444, recall 0.3868312757201646, F1 0.2588652482269504, AUC 0.6616451107191847
  Second-Tier acc 0.3673469387755102, precision 0.45, recall 0.38271604938271603, F1 0.25886101154918356, AUC 0.6589506172839505
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 13 idx: 0 First Loss : 3.289530038833618, Second Loss : 3.639260768890381
epoch: 13 idx: 200 First Loss : 0.8732206275484198, Second Loss : 0.8969830112942347
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.669438832772166
  Second-Tier acc 0.375, precision 0.5463980463980463, recall 0.44111111111111106, F1 0.31928571428571423, AUC 0.6833838383838383
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6687426513815402
  Second-Tier acc 0.40816326530612246, precision 0.5370370370370371, recall 0.4660493827160494, F1 0.3511195445920304, AUC 0.6683201058201057
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 14 idx: 0 First Loss : 3.679121971130371, Second Loss : 3.842930793762207
epoch: 14 idx: 200 First Loss : 0.8674837161994781, Second Loss : 0.8929301598791833
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.34990476190476194, recall 0.38222222222222224, F1 0.22163751007443225, AUC 0.6604713804713805
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6691414141414141
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3673469387755102, precision 0.4427083333333333, recall 0.38271604938271603, F1 0.25072738772928527, AUC 0.6692141877327064
  Second-Tier acc 0.3673469387755102, precision 0.49780701754385964, recall 0.41203703703703703, F1 0.28782051282051285, AUC 0.6775793650793651
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 15 idx: 0 First Loss : 3.3245770931243896, Second Loss : 3.746933937072754
epoch: 15 idx: 200 First Loss : 0.8602791594822696, Second Loss : 0.8875295840747667
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6614478114478114
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6634848484848485
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3469387755102041, precision 0.441025641025641, recall 0.3703703703703704, F1 0.22945736434108524, AUC 0.6689753576327652
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6951058201058201
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 16 idx: 0 First Loss : 3.3008406162261963, Second Loss : 3.8281638622283936
epoch: 16 idx: 200 First Loss : 0.8538481709533223, Second Loss : 0.8832363380348008
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3055555555555556, precision 0.3806526806526807, recall 0.387037037037037, F1 0.23310747223790698, AUC 0.6564927048260382
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6507575757575758
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3401360544217687, precision 0.4871111111111111, recall 0.3819811875367431, F1 0.250890991908956, AUC 0.6717678326474624
  Second-Tier acc 0.3469387755102041, precision 0.502710027100271, recall 0.3996913580246913, F1 0.26329302881027017, AUC 0.691247795414462
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 17 idx: 0 First Loss : 3.2802417278289795, Second Loss : 3.79573392868042
epoch: 17 idx: 200 First Loss : 0.842471409180947, Second Loss : 0.8782739510786914
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3125, precision 0.41190476190476183, recall 0.40026936026936033, F1 0.2637110016420361, AUC 0.6587542087542088
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6495959595959596
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.5214953271028037, recall 0.4273221634332746, F1 0.2923523794155228, AUC 0.6729007446600038
  Second-Tier acc 0.32653061224489793, precision 0.4444444444444444, recall 0.35802469135802467, F1 0.21264367816091956, AUC 0.6921296296296297
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 18 idx: 0 First Loss : 3.3358895778656006, Second Loss : 3.9000985622406006
epoch: 18 idx: 200 First Loss : 0.8406374310828173, Second Loss : 0.8769965454739193
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3125, precision 0.40204678362573104, recall 0.40111111111111114, F1 0.2556624182239946, AUC 0.6645398428731761
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6687878787878788
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.36054421768707484, precision 0.5352214960058097, recall 0.44914756025867136, F1 0.30849149068876414, AUC 0.6716453556731334
  Second-Tier acc 0.32653061224489793, precision 0.4900284900284901, recall 0.3873456790123457, F1 0.2391258390148512, AUC 0.6722883597883597
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4)
Current LR: 0.00025083649648644554
epoch: 19 idx: 0 First Loss : 3.5522968769073486, Second Loss : 4.0998077392578125
epoch: 19 idx: 200 First Loss : 0.839794598148873, Second Loss : 0.8749054867472439
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.4297619047619048, recall 0.39666666666666667, F1 0.2465359477124183, AUC 0.6772390572390572
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6597474747474749
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.49955791335101685, recall 0.39359200470311584, F1 0.26086939456383085, AUC 0.6859690378208896
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.7023809523809524
Test AUC: 0.7070, Test F1: 0.3632 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.21204122650508525, "droprate_2": 0.0, "lr": 0.00021978549400895214, "weight_decay": 1.1369303612434904e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00021978549400895214
epoch: 0 idx: 0 First Loss : 1.2492890357971191, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0869791706773773, Second Loss : 1.0789318880186745
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7424074074074074
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7581313131313131
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7293871252204586
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7176477072310407
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 1 idx: 0 First Loss : 1.577876091003418, Second Loss : 1.7513072490692139
epoch: 1 idx: 200 First Loss : 0.9843733146119473, Second Loss : 0.9831040184296186
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7344388327721662
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7366666666666667
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7312548990789732
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7296626984126985
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 2 idx: 0 First Loss : 1.8509091138839722, Second Loss : 2.030881643295288
epoch: 2 idx: 200 First Loss : 0.9532240746329673, Second Loss : 0.9571616418326079
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5555555555555556, precision 0.6381766381766382, recall 0.3997306397306397, F1 0.3521571262913768, AUC 0.7302918069584736
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7256060606060606
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.6258503401360545, precision 0.4305555555555555, recall 0.4958847736625514, F1 0.44565960355434037, AUC 0.7212117871840095
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7056878306878307
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 3 idx: 0 First Loss : 2.5397942066192627, Second Loss : 2.88515305519104
epoch: 3 idx: 200 First Loss : 0.9320492534736051, Second Loss : 0.9350238273763538
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4722222222222222, precision 0.5707843137254902, recall 0.512962962962963, F1 0.4213635404826386, AUC 0.7452132435465769
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7566161616161616
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.46938775510204084, precision 0.49310833806012483, recall 0.46700470311581427, F1 0.4371739940387482, AUC 0.7113707622966882
  Second-Tier acc 0.46938775510204084, precision 0.37450980392156863, recall 0.41005291005291006, F1 0.3432539682539682, AUC 0.7353946208112875
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 4 idx: 0 First Loss : 3.2005608081817627, Second Loss : 3.376833438873291
epoch: 4 idx: 200 First Loss : 0.9139180863368793, Second Loss : 0.9235279658410828
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.375, precision 0.37482758620689655, recall 0.4266666666666667, F1 0.28765100671140936, AUC 0.741902356902357
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7466666666666666
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.42857142857142855, precision 0.42963728191000916, recall 0.4121105232216343, F1 0.30963092803583603, AUC 0.6813883989809915
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.73804012345679
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 5 idx: 0 First Loss : 3.320119857788086, Second Loss : 3.5516960620880127
epoch: 5 idx: 200 First Loss : 0.9114402787278022, Second Loss : 0.9193526916785064
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.7357575757575758
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7497979797979798
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.47619047619047616, precision 0.4519774011299435, recall 0.448559670781893, F1 0.3462538226299694, AUC 0.6609347442680776
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.7015542328042329
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 6 idx: 0 First Loss : 3.4131405353546143, Second Loss : 3.5507490634918213
epoch: 6 idx: 200 First Loss : 0.9098476232156918, Second Loss : 0.915386210105368
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3611111111111111, precision 0.3670289855072464, recall 0.4177777777777778, F1 0.27304255035347474, AUC 0.68334455667789
  Second-Tier acc 0.3958333333333333, precision 0.3657657657657658, recall 0.44, F1 0.30515873015873013, AUC 0.7065656565656565
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.45, recall 0.43621399176954734, F1 0.33007221057535524, AUC 0.6389623750734862
  Second-Tier acc 0.5102040816326531, precision 0.4666666666666666, recall 0.46913580246913583, F1 0.38345864661654133, AUC 0.6681547619047619
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 7 idx: 0 First Loss : 3.390352964401245, Second Loss : 3.626363754272461
epoch: 7 idx: 200 First Loss : 0.9091849179940752, Second Loss : 0.910385913114221
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3472222222222222, precision 0.36075036075036077, recall 0.40888888888888886, F1 0.26091269841269843, AUC 0.677317620650954
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.6926262626262627
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.44808743169398907, recall 0.43209876543209874, F1 0.32311265969802555, AUC 0.6355391436409955
  Second-Tier acc 0.4897959183673469, precision 0.4594594594594595, recall 0.4567901234567901, F1 0.3631867161278926, AUC 0.6440145502645503
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 8 idx: 0 First Loss : 3.3845980167388916, Second Loss : 3.526367425918579
epoch: 8 idx: 200 First Loss : 0.9020457616862401, Second Loss : 0.904676290508128
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.3766233766233766, recall 0.41333333333333333, F1 0.26785714285714285, AUC 0.6733894500561167
  Second-Tier acc 0.4166666666666667, precision 0.5092592592592592, recall 0.4677777777777778, F1 0.3573355583368099, AUC 0.7074242424242424
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.44808743169398907, recall 0.43209876543209874, F1 0.32311265969802555, AUC 0.6493912894375858
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.6668320105820106
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 9 idx: 0 First Loss : 3.3851382732391357, Second Loss : 3.491583824157715
epoch: 9 idx: 200 First Loss : 0.904443127584449, Second Loss : 0.9064270970136488
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3541666666666667, precision 0.37587822014051525, recall 0.41333333333333333, F1 0.2669354838709677, AUC 0.6698148148148148
  Second-Tier acc 0.4375, precision 0.7324324324324324, recall 0.48111111111111104, F1 0.3754884004884005, AUC 0.6998484848484848
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4421768707482993, precision 0.44808743169398907, recall 0.4279835390946502, F1 0.3181676047529706, AUC 0.6533840388007054
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.6607142857142857
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 10 idx: 0 First Loss : 3.3779075145721436, Second Loss : 3.4671790599823
epoch: 10 idx: 200 First Loss : 0.9049895222623722, Second Loss : 0.9023738230575127
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3541666666666667, precision 0.37587822014051525, recall 0.41333333333333333, F1 0.2669354838709677, AUC 0.6707968574635242
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6969696969696969
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.43537414965986393, precision 0.44623655913978494, recall 0.4238683127572016, F1 0.3110695208016532, AUC 0.654265873015873
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.6657297178130511
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 11 idx: 0 First Loss : 3.441319465637207, Second Loss : 3.594482660293579
epoch: 11 idx: 200 First Loss : 0.9002277659505967, Second Loss : 0.8974030325199368
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3333333333333333, precision 0.36577777777777776, recall 0.39999999999999997, F1 0.246767388049544, AUC 0.6684006734006734
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.6781818181818182
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6561887615128356
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6688161375661376
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 12 idx: 0 First Loss : 3.2955734729766846, Second Loss : 3.3868937492370605
epoch: 12 idx: 200 First Loss : 0.8902852487107751, Second Loss : 0.889988102217275
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3263888888888889, precision 0.3618113912231559, recall 0.3955555555555556, F1 0.23981405523653268, AUC 0.6674859708193042
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.674040404040404
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4013605442176871, precision 0.44533333333333336, recall 0.40329218106995884, F1 0.28331092916208395, AUC 0.6581300215559476
  Second-Tier acc 0.40816326530612246, precision 0.452991452991453, recall 0.40740740740740744, F1 0.29731275014293884, AUC 0.6762566137566138
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 13 idx: 0 First Loss : 3.2200801372528076, Second Loss : 3.3405373096466064
epoch: 13 idx: 200 First Loss : 0.8869829147030276, Second Loss : 0.8886717852109908
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6642929292929293
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6712121212121213
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.43781094527363185, recall 0.38271604938271603, F1 0.24511241446725318, AUC 0.66060405643739
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6787367724867724
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 14 idx: 0 First Loss : 3.3976948261260986, Second Loss : 3.55090069770813
epoch: 14 idx: 200 First Loss : 0.8853913180984946, Second Loss : 0.8904279953664685
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.34652014652014645, recall 0.38222222222222224, F1 0.2173663288986926, AUC 0.6635521885521886
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6656060606060606
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.4362745098039216, recall 0.37448559670781895, F1 0.2305634440465901, AUC 0.6635863707622968
  Second-Tier acc 0.3877551020408163, precision 0.5166666666666667, recall 0.4243827160493827, F1 0.3101430628312349, AUC 0.6968694885361552
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 15 idx: 0 First Loss : 3.551316499710083, Second Loss : 3.655618190765381
epoch: 15 idx: 200 First Loss : 0.8700687286892114, Second Loss : 0.879145737341511
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2986111111111111, precision 0.3403797220591114, recall 0.37777777777777777, F1 0.20990391722099042, AUC 0.6599551066217733
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6559090909090909
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3401360544217687, precision 0.43478260869565216, recall 0.3662551440329218, F1 0.21548064918851437, AUC 0.6730109739368998
  Second-Tier acc 0.3673469387755102, precision 0.5055555555555556, recall 0.41203703703703703, F1 0.28712522045855376, AUC 0.6999559082892416
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 16 idx: 0 First Loss : 3.5801048278808594, Second Loss : 3.6986377239227295
epoch: 16 idx: 200 First Loss : 0.8609770018768571, Second Loss : 0.8730863690376571
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2916666666666667, precision 0.33396946564885494, recall 0.37333333333333335, F1 0.20311185870479395, AUC 0.666324354657688
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6615656565656566
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3401360544217687, precision 0.43405275779376495, recall 0.3662551440329218, F1 0.21462122622964386, AUC 0.675025720164609
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6877204585537919
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 17 idx: 0 First Loss : 3.6418914794921875, Second Loss : 3.7935726642608643
epoch: 17 idx: 200 First Loss : 0.8576571822844682, Second Loss : 0.8717418483362072
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6657912457912458
  Second-Tier acc 0.2708333333333333, precision 0.34259259259259256, recall 0.343030303030303, F1 0.210809488872585, AUC 0.6556060606060606
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3401360544217687, precision 0.43405275779376495, recall 0.3662551440329218, F1 0.21462122622964386, AUC 0.66349451303155
  Second-Tier acc 0.32653061224489793, precision 0.5224089635854342, recall 0.4230599647266314, F1 0.28138528138528135, AUC 0.6830357142857143
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 18 idx: 0 First Loss : 3.7152230739593506, Second Loss : 3.9465174674987793
epoch: 18 idx: 200 First Loss : 0.8436718021937044, Second Loss : 0.8556121940435907
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3263888888888889, precision 0.4737624471667024, recall 0.42191919191919186, F1 0.30107047631691664, AUC 0.6640628507295173
  Second-Tier acc 0.3333333333333333, precision 0.43154761904761907, recall 0.42636363636363633, F1 0.3113342596101217, AUC 0.660050505050505
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3401360544217687, precision 0.5380856760374834, recall 0.45892122281011166, F1 0.31054715219421103, AUC 0.6778304428767391
  Second-Tier acc 0.30612244897959184, precision 0.5104364326375712, recall 0.3992504409171076, F1 0.26677248677248677, AUC 0.667713844797178
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021978549400895214
epoch: 19 idx: 0 First Loss : 3.77909255027771, Second Loss : 3.989255428314209
epoch: 19 idx: 200 First Loss : 0.850497139489433, Second Loss : 0.8667335749273672
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3402777777777778, precision 0.48882890988154143, recall 0.4404377104377104, F1 0.32252529026722576, AUC 0.6722053872053871
  Second-Tier acc 0.3333333333333333, precision 0.43160919540229886, recall 0.42636363636363633, F1 0.30970625798212004, AUC 0.6558585858585858
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.5483110761979576, recall 0.47876249265138154, F1 0.32205361936169513, AUC 0.6762014991181657
  Second-Tier acc 0.32653061224489793, precision 0.5143790849673203, recall 0.4115961199294533, F1 0.2926436781609196, AUC 0.6546516754850088
Test AUC: 0.7176, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.3688406223084466, "droprate_2": 0.0, "lr": 3.5619671363345314e-05, "weight_decay": 0.0007337388476565976, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.5619671363345314e-05
epoch: 0 idx: 0 First Loss : 1.2375210523605347, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1286018135684046, Second Loss : 1.1100172392319685
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7256341189674522
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7618181818181818
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6768873701744073
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6630291005291005
Test AUC: 0.6630, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.5619671363345314e-05
epoch: 1 idx: 0 First Loss : 2.1637401580810547, Second Loss : 2.1322641372680664
epoch: 1 idx: 200 First Loss : 1.0756672012865247, Second Loss : 1.0681340371198322
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7392312008978675
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7652020202020203
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7105624142661181
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7057980599647267
Test AUC: 0.7058, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.5619671363345314e-05
epoch: 2 idx: 0 First Loss : 2.269047498703003, Second Loss : 2.292112112045288
epoch: 2 idx: 200 First Loss : 1.0338334467873644, Second Loss : 1.0265194435988492
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.5119047619047619, recall 0.3434343434343434, F1 0.25216598267213863, AUC 0.7379124579124579
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7528787878787879
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.34722222222222227, F1 0.2645521292217327, AUC 0.7168209876543209
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7179232804232804
Test AUC: 0.7058, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.5619671363345314e-05
epoch: 3 idx: 0 First Loss : 2.524590253829956, Second Loss : 2.5365583896636963
epoch: 3 idx: 200 First Loss : 0.9900820598525194, Second Loss : 0.9887185027795051
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6111111111111112, precision 0.5976205822322483, recall 0.478013468013468, F1 0.4704547485035289, AUC 0.7310774410774412
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7442929292929293
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6122448979591837, precision 0.37946428571428575, recall 0.5169753086419754, F1 0.43763878608438195, AUC 0.7105807858122674
  Second-Tier acc 0.673469387755102, precision 0.7466329966329965, recall 0.5348324514991182, F1 0.5578835978835978, AUC 0.712907848324515
Test AUC: 0.7058, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.5619671363345314e-05
epoch: 4 idx: 0 First Loss : 2.850227117538452, Second Loss : 2.8925907611846924
epoch: 4 idx: 200 First Loss : 0.9543834809417748, Second Loss : 0.960267865205582
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5277777777777778, precision 0.48493827160493824, recall 0.4952188552188552, F1 0.4511139046022767, AUC 0.7279349046015712
  Second-Tier acc 0.6458333333333334, precision 0.6060606060606061, recall 0.6213131313131314, F1 0.6043651646488526, AUC 0.7526767676767676
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4897959183673469, precision 0.4637090549844092, recall 0.5066137566137566, F1 0.44241870661308, AUC 0.7132997746423673
  Second-Tier acc 0.6326530612244898, precision 0.6151515151515151, recall 0.6618165784832452, F1 0.6249766703994027, AUC 0.7371031746031745
Test AUC: 0.7058, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.5619671363345314e-05
epoch: 5 idx: 0 First Loss : 3.1765124797821045, Second Loss : 3.232858896255493
epoch: 5 idx: 200 First Loss : 0.9343302508176707, Second Loss : 0.9450439995442012
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4375, precision 0.4669071669071669, recall 0.4575420875420875, F1 0.3924162257495591, AUC 0.7376374859708194
  Second-Tier acc 0.5208333333333334, precision 0.5838468720821662, recall 0.5846464646464646, F1 0.5220032840722496, AUC 0.7755050505050504
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4421768707482993, precision 0.48457883490778225, recall 0.5245443856554967, F1 0.4235435435435435, AUC 0.7200605036253185
  Second-Tier acc 0.5102040816326531, precision 0.5305451127819548, recall 0.5941358024691358, F1 0.5147203744764721, AUC 0.7598104056437389
Test AUC: 0.7598, Test F1: 0.5147 (Best Epoch: 5)
Current LR: 3.5619671363345314e-05
epoch: 6 idx: 0 First Loss : 3.3937976360321045, Second Loss : 3.498762607574463
epoch: 6 idx: 200 First Loss : 0.9236842252230689, Second Loss : 0.9390818720674189
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4166666666666667, precision 0.4619594964422551, recall 0.4442087542087543, F1 0.3771249269022599, AUC 0.742615039281706
  Second-Tier acc 0.5208333333333334, precision 0.5899470899470899, recall 0.5990909090909091, F1 0.5235294117647059, AUC 0.7876262626262626
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.4945239357004063, recall 0.528071722516167, F1 0.42477169074822624, AUC 0.725786302175191
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7658730158730158
Test AUC: 0.7659, Test F1: 0.5178 (Best Epoch: 6)
Current LR: 3.5619671363345314e-05
epoch: 7 idx: 0 First Loss : 3.5311014652252197, Second Loss : 3.669595241546631
epoch: 7 idx: 200 First Loss : 0.9190075097012504, Second Loss : 0.9370048762535426
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4097222222222222, precision 0.4696825396825397, recall 0.45107744107744113, F1 0.38084967320261437, AUC 0.7452413019079686
  Second-Tier acc 0.4791666666666667, precision 0.5625, recall 0.5605050505050505, F1 0.4795093795093795, AUC 0.7907070707070707
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.42857142857142855, precision 0.5287824055939998, recall 0.5315990593768372, F1 0.42379005474243564, AUC 0.7321428571428571
  Second-Tier acc 0.5306122448979592, precision 0.6155157715260017, recall 0.6408730158730159, F1 0.5335135135135135, AUC 0.7686287477954145
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 8 idx: 0 First Loss : 3.606942892074585, Second Loss : 3.778639316558838
epoch: 8 idx: 200 First Loss : 0.912800270980641, Second Loss : 0.9352887435630891
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4097222222222222, precision 0.49529456051195186, recall 0.4688888888888889, F1 0.3948181546618872, AUC 0.7505443322109988
  Second-Tier acc 0.4375, precision 0.5307142857142857, recall 0.5193939393939394, F1 0.43452380952380953, AUC 0.7836868686868687
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.43537414965986393, precision 0.5388144561025917, recall 0.5352733686067019, F1 0.43621330252739005, AUC 0.7415429649225945
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7826278659611993
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 9 idx: 0 First Loss : 3.6279594898223877, Second Loss : 3.8177409172058105
epoch: 9 idx: 200 First Loss : 0.9074023194861278, Second Loss : 0.9322048089703294
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4236111111111111, precision 0.5184783884569891, recall 0.5029292929292929, F1 0.42010059072649447, AUC 0.7474466891133558
  Second-Tier acc 0.3958333333333333, precision 0.49938949938949934, recall 0.46131313131313134, F1 0.3926009342676009, AUC 0.7756060606060605
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46938775510204084, precision 0.5805946791862284, recall 0.5706937095825985, F1 0.4673324212803549, AUC 0.7455173427395648
  Second-Tier acc 0.46938775510204084, precision 0.5708333333333333, recall 0.5451940035273369, F1 0.4622100122100122, AUC 0.7816909171075839
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 10 idx: 0 First Loss : 3.627427339553833, Second Loss : 3.835066318511963
epoch: 10 idx: 200 First Loss : 0.902270538080252, Second Loss : 0.9283158675250852
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.5184959236869835, recall 0.49872053872053873, F1 0.41593372504653114, AUC 0.7439955106621774
  Second-Tier acc 0.3958333333333333, precision 0.496547619047619, recall 0.46131313131313134, F1 0.3921957671957672, AUC 0.7617171717171717
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5849122807017544, recall 0.5745149911816578, F1 0.4689085895466753, AUC 0.7505633940819125
  Second-Tier acc 0.4489795918367347, precision 0.5499999999999999, recall 0.5035273368606702, F1 0.4344322344322344, AUC 0.7799272486772487
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 11 idx: 0 First Loss : 3.62544846534729, Second Loss : 3.8045387268066406
epoch: 11 idx: 200 First Loss : 0.8980119792832553, Second Loss : 0.9250952607155105
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3888888888888889, precision 0.4956540825285338, recall 0.46878787878787875, F1 0.3872826086956522, AUC 0.7366722783389449
  Second-Tier acc 0.3541666666666667, precision 0.44915514592933947, recall 0.4082828282828283, F1 0.3284632034632035, AUC 0.7578787878787878
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.5748792270531401, recall 0.564594356261023, F1 0.4557956649459918, AUC 0.7504715363511659
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7761243386243386
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 12 idx: 0 First Loss : 3.5590364933013916, Second Loss : 3.7965095043182373
epoch: 12 idx: 200 First Loss : 0.893811625826395, Second Loss : 0.9213657416420669
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3680555555555556, precision 0.4794073551459564, recall 0.4384848484848485, F1 0.366650740563784, AUC 0.724337822671156
  Second-Tier acc 0.375, precision 0.4599078341013825, recall 0.4385858585858586, F1 0.34433621933621933, AUC 0.7454545454545455
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.5601250601250601, recall 0.5363756613756614, F1 0.421126978598243, AUC 0.7531292866941016
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7706679894179894
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 13 idx: 0 First Loss : 3.491572618484497, Second Loss : 3.859575033187866
epoch: 13 idx: 200 First Loss : 0.8897242756243053, Second Loss : 0.9194565553789198
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.4880188875051889, recall 0.4677104377104377, F1 0.3770129241827355, AUC 0.7127384960718294
  Second-Tier acc 0.3541666666666667, precision 0.4447181171319103, recall 0.4082828282828283, F1 0.33055555555555555, AUC 0.715
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.5664836476486035, recall 0.5421810699588477, F1 0.4254163121693928, AUC 0.7503551832255537
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.771164021164021
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 14 idx: 0 First Loss : 3.5069339275360107, Second Loss : 3.7585513591766357
epoch: 14 idx: 200 First Loss : 0.8870546665455016, Second Loss : 0.9184305686269081
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.4814266615737204, recall 0.4592929292929293, F1 0.36775638154948503, AUC 0.698327721661055
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.6892929292929293
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.41496598639455784, precision 0.562962962962963, recall 0.5339506172839507, F1 0.41076649958228906, AUC 0.7485608955516364
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7736992945326279
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 15 idx: 0 First Loss : 3.4554622173309326, Second Loss : 3.7377870082855225
epoch: 15 idx: 200 First Loss : 0.8839937532178719, Second Loss : 0.9175291292216462
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.47088477366255144, recall 0.4455892255892256, F1 0.352046783625731, AUC 0.6903030303030304
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.6847474747474749
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.5616651133892513, recall 0.5279982363315696, F1 0.40904471544715443, AUC 0.7439496374681559
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7753527336860669
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 16 idx: 0 First Loss : 3.404698610305786, Second Loss : 3.7128400802612305
epoch: 16 idx: 200 First Loss : 0.880955394551758, Second Loss : 0.9181129777084674
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6854377104377104
  Second-Tier acc 0.3333333333333333, precision 0.42974910394265237, recall 0.41191919191919196, F1 0.30317460317460315, AUC 0.6754545454545454
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5645021645021645, recall 0.5299823633156966, F1 0.41285723150019504, AUC 0.7405876445228298
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7755731922398589
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 17 idx: 0 First Loss : 3.351630926132202, Second Loss : 3.6760077476501465
epoch: 17 idx: 200 First Loss : 0.8780057806653707, Second Loss : 0.9176215977372951
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.4702380952380952, recall 0.4455892255892256, F1 0.3520851408409971, AUC 0.6793265993265992
  Second-Tier acc 0.3541666666666667, precision 0.44185606060606064, recall 0.44222222222222224, F1 0.3174025390405572, AUC 0.6728282828282829
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5713392717612127, recall 0.541740152851264, F1 0.4168159326054062, AUC 0.7397731726435429
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7722663139329805
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 18 idx: 0 First Loss : 3.323094129562378, Second Loss : 3.6569788455963135
epoch: 18 idx: 200 First Loss : 0.8763667498524093, Second Loss : 0.9176996216190683
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.4652872359001223, recall 0.4363299663299663, F1 0.34400523315577985, AUC 0.679141414141414
  Second-Tier acc 0.3541666666666667, precision 0.44185606060606064, recall 0.44222222222222224, F1 0.3174025390405572, AUC 0.667878787878788
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.569583931133429, recall 0.535787771898883, F1 0.4143746462931522, AUC 0.7385422790515382
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7693452380952381
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7)
Current LR: 3.5619671363345314e-05
epoch: 19 idx: 0 First Loss : 3.299173593521118, Second Loss : 3.6212542057037354
epoch: 19 idx: 200 First Loss : 0.8738745073999269, Second Loss : 0.9171105663952955
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3472222222222222, precision 0.45481054653396197, recall 0.42791245791245797, F1 0.3334921969909354, AUC 0.6773961840628507
  Second-Tier acc 0.375, precision 0.4590277777777778, recall 0.45555555555555555, F1 0.33867557798540543, AUC 0.6712626262626262
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5682539682539682, recall 0.5316725455614345, F1 0.40722789658959874, AUC 0.7355477170291985
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7593694885361552
Test AUC: 0.7686, Test F1: 0.5335 (Best Epoch: 7){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.17135072919818098, "droprate_2": 0.0, "lr": 2.727506153166419e-05, "weight_decay": 3.35246771896255e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.21715670277528834, "droprate_2": 0.0, "lr": 0.00040548197461272805, "weight_decay": 0.00018613907346344723, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00040548197461272805
epoch: 0 idx: 0 First Loss : 1.1606392860412598, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.094683792201144, Second Loss : 1.086655700718289
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7278507295173963
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.743030303030303
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6995578581226729
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6990189594356261
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 1 idx: 0 First Loss : 1.9911259412765503, Second Loss : 2.3963563442230225
epoch: 1 idx: 200 First Loss : 0.980497389735274, Second Loss : 0.9763075776805925
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7293097643097642
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7294444444444445
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.741493974132863
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7410163139329806
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 2 idx: 0 First Loss : 2.547604560852051, Second Loss : 2.730022430419922
epoch: 2 idx: 200 First Loss : 0.957991559892448, Second Loss : 0.9475297023778531
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.39947089947089953, recall 0.44, F1 0.38923031899326893, AUC 0.7099775533108866
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7166666666666668
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.2470449172576832, recall 0.3412698412698412, F1 0.2571321321321321, AUC 0.7202319713893788
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7222222222222223
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 3 idx: 0 First Loss : 2.838108777999878, Second Loss : 3.1310994625091553
epoch: 3 idx: 200 First Loss : 0.9165275968259099, Second Loss : 0.9248417955336731
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4722222222222222, precision 0.5122900516795865, recall 0.48720538720538725, F1 0.39046715654385555, AUC 0.7228956228956228
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7322222222222222
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.48299319727891155, precision 0.4468864468864469, recall 0.42041446208112876, F1 0.3746867167919799, AUC 0.7167842445620224
  Second-Tier acc 0.4897959183673469, precision 0.3819444444444444, recall 0.42239858906525574, F1 0.35757875639122544, AUC 0.7057980599647267
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 4 idx: 0 First Loss : 3.1789252758026123, Second Loss : 3.7139148712158203
epoch: 4 idx: 200 First Loss : 0.8983188179270619, Second Loss : 0.9158966991568531
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4027777777777778, precision 0.3669294294294294, recall 0.4387878787878788, F1 0.31014191761855314, AUC 0.739517396184063
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7175757575757574
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.48299319727891155, precision 0.5332144979203802, recall 0.45098471487360375, F1 0.3754541345311749, AUC 0.7226080246913581
  Second-Tier acc 0.5306122448979592, precision 0.4594594594594595, recall 0.48148148148148145, F1 0.38813474107591756, AUC 0.7094907407407408
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 5 idx: 0 First Loss : 3.2132675647735596, Second Loss : 3.5473716259002686
epoch: 5 idx: 200 First Loss : 0.8941095588515647, Second Loss : 0.9063554989424214
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4097222222222222, precision 0.5513681212491099, recall 0.45370370370370366, F1 0.3284852014123824, AUC 0.7020258136924804
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7079292929292929
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4965986394557823, precision 0.5560515873015873, recall 0.4668577307466197, F1 0.3850713909710959, AUC 0.6800472761120909
  Second-Tier acc 0.5306122448979592, precision 0.4594594594594595, recall 0.48148148148148145, F1 0.38813474107591756, AUC 0.6584545855379189
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 6 idx: 0 First Loss : 3.2420027256011963, Second Loss : 3.4834117889404297
epoch: 6 idx: 200 First Loss : 0.8825929851702122, Second Loss : 0.8933609087247197
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4027777777777778, precision 0.558029689608637, recall 0.4540740740740741, F1 0.33480837879706343, AUC 0.6823456790123457
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7086868686868687
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.5334757834757835, recall 0.44628159905937687, F1 0.357711050093346, AUC 0.6698755633940818
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6713514109347442
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 7 idx: 0 First Loss : 3.373398780822754, Second Loss : 3.6396706104278564
epoch: 7 idx: 200 First Loss : 0.9036325911877778, Second Loss : 0.9121515456516416
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3819444444444444, precision 0.4504611330698287, recall 0.4407407407407407, F1 0.3182693699411025, AUC 0.6757239057239057
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.693030303030303
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.5047355047355047, recall 0.43988830099941206, F1 0.3577638724697548, AUC 0.6646274250440917
  Second-Tier acc 0.5306122448979592, precision 0.7927927927927928, recall 0.5108024691358025, F1 0.45006306616213737, AUC 0.6600529100529101
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 8 idx: 0 First Loss : 3.4537670612335205, Second Loss : 3.6899573802948
epoch: 8 idx: 200 First Loss : 0.8861622024270757, Second Loss : 0.9005731323841654
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.375, precision 0.45806028833551765, recall 0.44111111111111106, F1 0.31992957746478873, AUC 0.6729292929292928
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6914646464646464
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46258503401360546, precision 0.548941798941799, recall 0.46796002351557914, F1 0.40074147633234025, AUC 0.6628025181265922
  Second-Tier acc 0.5102040816326531, precision 0.7894736842105262, recall 0.49845679012345673, F1 0.4337414337414338, AUC 0.6607142857142857
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 9 idx: 0 First Loss : 3.435415029525757, Second Loss : 3.7011666297912598
epoch: 9 idx: 200 First Loss : 0.8937591197810701, Second Loss : 0.9059179083021955
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3819444444444444, precision 0.4444444444444444, recall 0.4407407407407407, F1 0.31751179577266536, AUC 0.6658305274971942
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6787373737373738
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46938775510204084, precision 0.5507215007215007, recall 0.46230158730158727, F1 0.3967963068639071, AUC 0.6666727905153831
  Second-Tier acc 0.5102040816326531, precision 0.7894736842105262, recall 0.49845679012345673, F1 0.4337414337414338, AUC 0.6633597883597884
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 10 idx: 0 First Loss : 3.2766191959381104, Second Loss : 3.660747766494751
epoch: 10 idx: 200 First Loss : 0.8742372719224933, Second Loss : 0.8943291258986921
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4166666666666667, precision 0.46488469601677146, recall 0.46296296296296297, F1 0.34730657032815304, AUC 0.6633221099887767
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6723232323232322
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.4850467289719626, recall 0.44047619047619047, F1 0.37140021980132526, AUC 0.675387027238879
  Second-Tier acc 0.4897959183673469, precision 0.4258373205741626, recall 0.4567901234567901, F1 0.3549257759784075, AUC 0.6792879188712523
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 11 idx: 0 First Loss : 3.2986834049224854, Second Loss : 3.749267816543579
epoch: 11 idx: 200 First Loss : 0.8670771801340352, Second Loss : 0.8850527420080793
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4791666666666667, precision 0.38798065853096936, recall 0.49333333333333335, F1 0.3675689349860865, AUC 0.6641358024691358
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.6745959595959596
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.3796594569719282, recall 0.43327454438565544, F1 0.34603455914931325, AUC 0.6780325298843817
  Second-Tier acc 0.5306122448979592, precision 0.41904761904761906, recall 0.48148148148148145, F1 0.3855981416957026, AUC 0.6871141975308642
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 12 idx: 0 First Loss : 4.220403671264648, Second Loss : 3.9216768741607666
epoch: 12 idx: 200 First Loss : 0.8695344913986758, Second Loss : 0.8863038945754449
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.5291764705882352, recall 0.4048148148148148, F1 0.25823364134055554, AUC 0.6559820426487093
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6579292929292929
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.42516447368421045, recall 0.40740740740740744, F1 0.2847058823529412, AUC 0.6891840583970213
  Second-Tier acc 0.40816326530612246, precision 0.5333333333333333, recall 0.4367283950617284, F1 0.3325617283950617, AUC 0.6948853615520282
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 13 idx: 0 First Loss : 3.3514702320098877, Second Loss : 3.851273775100708
epoch: 13 idx: 200 First Loss : 0.8502750456829373, Second Loss : 0.8715448893405361
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.6894308943089431, recall 0.4137037037037037, F1 0.271324360798045, AUC 0.659057239057239
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6558080808080808
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.42142076502732245, recall 0.4279835390946502, F1 0.31538579536738764, AUC 0.6907640113658632
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.7114197530864197
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00040548197461272805
epoch: 14 idx: 0 First Loss : 3.3694770336151123, Second Loss : 4.024815082550049
epoch: 14 idx: 200 First Loss : 0.8471359062881023, Second Loss : 0.8670381889918536
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6498540965207632
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6387878787878788
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.42334194659776053, recall 0.40329218106995884, F1 0.278220804536594, AUC 0.7025891632373114
  Second-Tier acc 0.3877551020408163, precision 0.5304878048780488, recall 0.4243827160493827, F1 0.3112740306288693, AUC 0.7114748677248679
Test AUC: 0.6990, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.20236257846092934, "droprate_2": 0.0, "lr": 0.0002456310726274653, "weight_decay": 3.419908868929223e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.162162184715271, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0814325005483272, Second Loss : 1.0727697272428232
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.746638608305275
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7581313131313131{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.19801632867982236, "droprate_2": 0.0, "lr": 7.448332886302447e-05, "weight_decay": 0.0003846996327674731, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.15923011302948, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1166303496603942, Second Loss : 1.1141798556295794
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7588945005611673
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.747020202020202{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.00034169400924624057, "droprate_2": 0.0, "lr": 1.272964157949793e-05, "weight_decay": 0.0006430192255294017, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1514661312103271, Second Loss : 1.03431236743927{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.0666950439460128, "droprate_2": 0.0, "lr": 1.783363706843362e-05, "weight_decay": 0.00033412212584710033, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1318060159683228, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0697515319235882, Second Loss : 1.0793262552562637
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7490628507295174
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7037878787878787{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.27827663863592694, "droprate_2": 0.0, "lr": 6.809937851803926e-05, "weight_decay": 0.00010207949053803628, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.20961923925896828, "droprate_2": 0.0, "lr": 1.3697497307905823e-05, "weight_decay": 0.0001434744585175349, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.023025602548124358, "droprate_2": 0.0, "lr": 0.0005145517253195574, "weight_decay": 0.0006602609846928858, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.03170756003027201, "droprate_2": 0.0, "lr": 8.519408058434865e-05, "weight_decay": 0.000454597541721036, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.052461063824042906, "droprate_2": 0.0, "lr": 2.3716639998321694e-05, "weight_decay": 3.862914328988172e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1409560441970825, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0900846074766188, Second Loss : 1.0999398138096084{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.24194723162795156, "droprate_2": 0.0, "lr": 3.765965768603549e-05, "weight_decay": 0.00033061743538918056, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.158419132232666, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1166659533532697, Second Loss : 1.116987535164724
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7559652076318742
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7236868686868686
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6813210366451107
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6429673721340388
epoch: 1 idx: 0 First Loss : 1.9369293451309204, Second Loss : 2.113180637359619
epoch: 1 idx: 200 First Loss : 1.069545861574548, Second Loss : 1.0725529798079485
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7493602693602693
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7548484848484849
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7100480109739369
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.69538139329806
epoch: 2 idx: 0 First Loss : 2.0816516876220703, Second Loss : 2.33636474609375
epoch: 2 idx: 200 First Loss : 1.0255511409014613, Second Loss : 1.0274245455045605
  First-Tier acc 0.5902777777777778, precision 0.41534391534391535, recall 0.44565656565656564, F1 0.3989854648326993, AUC 0.7432323232323231
  Second-Tier acc 0.5625, precision 0.3904761904761904, recall 0.4109090909090909, F1 0.3638059701492537, AUC 0.75
  First-Tier acc 0.5714285714285714, precision 0.29708029197080293, recall 0.35714285714285715, F1 0.2861679604798871, AUC 0.7183029590436997
  Second-Tier acc 0.5918367346938775, precision 0.6956521739130435, recall 0.3988095238095238, F1 0.36231608320649417, AUC 0.7127425044091712
epoch: 3 idx: 0 First Loss : 2.325911045074463, Second Loss : 2.6180667877197266
epoch: 3 idx: 200 First Loss : 0.9861411800357833, Second Loss : 0.9888586819320175
  First-Tier acc 0.625, precision 0.5722222222222223, recall 0.568013468013468, F1 0.49211469534050184, AUC 0.7512514029180696
  Second-Tier acc 0.6458333333333334, precision 0.5799663299663299, recall 0.5729292929292928, F1 0.5729532521985352, AUC 0.7646969696969697
  First-Tier acc 0.5986394557823129, precision 0.5782302188552189, recall 0.5315990593768372, F1 0.5276124705647458, AUC 0.7265824025083284
  Second-Tier acc 0.5918367346938775, precision 0.5611769872639437, recall 0.5963403880070547, F1 0.5726799758015728, AUC 0.7329144620811286
epoch: 4 idx: 0 First Loss : 2.6498348712921143, Second Loss : 2.9860377311706543{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.26422039375526724, "droprate_2": 0.0, "lr": 0.0002455022225852985, "weight_decay": 0.00016176323607653437, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1024487018585205, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.075164651544533, Second Loss : 1.0778625524088519
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7340214646464647
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7498989898989898
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7144648368606702
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7199074074074074
epoch: 1 idx: 0 First Loss : 1.707512378692627, Second Loss : 1.7267409563064575
epoch: 1 idx: 200 First Loss : 0.9783397898893451, Second Loss : 0.9825181125556651
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7265940656565656
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7369696969696969
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7344990079365079
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7329695767195767
epoch: 2 idx: 0 First Loss : 2.2008581161499023, Second Loss : 2.14994740486145
epoch: 2 idx: 200 First Loss : 0.9375236485134902, Second Loss : 0.9398834671991975
  First-Tier acc 0.5989583333333334, precision 0.3853853853853854, recall 0.5360606060606061, F1 0.4416050552922591, AUC 0.7154577020202021
  Second-Tier acc 0.6458333333333334, precision 0.5784770784770785, recall 0.5465656565656566, F1 0.5064313081554461, AUC 0.7192929292929292
  First-Tier acc 0.5612244897959183, precision 0.3667887667887668, recall 0.4426807760141094, F1 0.3948771997061735, AUC 0.705267581569665
  Second-Tier acc 0.5918367346938775, precision 0.6203703703703703, recall 0.5376984126984127, F1 0.5555555555555555, AUC 0.712907848324515
epoch: 3 idx: 0 First Loss : 3.263875961303711, Second Loss : 3.3093760013580322
epoch: 3 idx: 200 First Loss : 0.9286622837074657, Second Loss : 0.9273393802919346
  First-Tier acc 0.40625, precision 0.37947558283529853, recall 0.4424242424242424, F1 0.31249318057828696, AUC 0.7200915404040403
  Second-Tier acc 0.4375, precision 0.3599439775910364, recall 0.4496969696969697, F1 0.33618233618233617, AUC 0.7366161616161616
  First-Tier acc 0.47959183673469385, precision 0.4025242280820374, recall 0.4334215167548501, F1 0.35032385243593356, AUC 0.7159736000881834
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6976410934744269
epoch: 4 idx: 0 First Loss : 3.600184917449951, Second Loss : 3.681328773498535
epoch: 4 idx: 200 First Loss : 0.9148028686397074, Second Loss : 0.9125382088180354
  First-Tier acc 0.3958333333333333, precision 0.375733199262611, recall 0.4357575757575758, F1 0.3037894557450486, AUC 0.740451388888889
  Second-Tier acc 0.4375, precision 0.3599439775910364, recall 0.4496969696969697, F1 0.33618233618233617, AUC 0.791010101010101
  First-Tier acc 0.4744897959183674, precision 0.4192583732057416, recall 0.4389329805996473, F1 0.3453103913630229, AUC 0.7180369543650794
  Second-Tier acc 0.5102040816326531, precision 0.3958333333333333, recall 0.4462081128747795, F1 0.37546343107516006, AUC 0.7181437389770723
epoch: 5 idx: 0 First Loss : 3.983774185180664, Second Loss : 4.251500606536865
epoch: 5 idx: 200 First Loss : 0.9177665950762877, Second Loss : 0.9136624822615466
  First-Tier acc 0.3697916666666667, precision 0.3814198891337741, recall 0.42333333333333334, F1 0.2804940110469807, AUC 0.7086584595959596
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7455555555555556
  First-Tier acc 0.45408163265306123, precision 0.4209415944925605, recall 0.4294532627865961, F1 0.3280416506635941, AUC 0.6611724261463845
  Second-Tier acc 0.4897959183673469, precision 0.4069264069264069, recall 0.4338624338624338, F1 0.365334717176959, AUC 0.6809964726631392
epoch: 6 idx: 0 First Loss : 3.652914047241211, Second Loss : 3.9846413135528564
epoch: 6 idx: 200 First Loss : 0.9066664905111255, Second Loss : 0.902915687999336
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.681780303030303
  Second-Tier acc 0.4583333333333333, precision 0.40740740740740744, recall 0.48, F1 0.35422656699252447, AUC 0.7197474747474747
  First-Tier acc 0.45918367346938777, precision 0.44047619047619047, recall 0.4382716049382716, F1 0.331347664680998, AUC 0.6548204640652557
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.691523368606702
epoch: 7 idx: 0 First Loss : 3.3524649143218994, Second Loss : 4.0899977684021
epoch: 7 idx: 200 First Loss : 0.8984004061238201, Second Loss : 0.8990563870058974
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.673510101010101
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6903030303030303
  First-Tier acc 0.45408163265306123, precision 0.4387557492132655, recall 0.4351851851851852, F1 0.32618340009475816, AUC 0.6671006944444443
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.7150573192239859
epoch: 8 idx: 0 First Loss : 3.3266360759735107, Second Loss : 3.7944936752319336
epoch: 8 idx: 200 First Loss : 0.8919345556773692, Second Loss : 0.8921099480829985
  First-Tier acc 0.359375, precision 0.37733587194132995, recall 0.4166666666666667, F1 0.2709058907238887, AUC 0.6691161616161616
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7002525252525252
  First-Tier acc 0.44387755102040816, precision 0.4367378048780488, recall 0.4290123456790123, F1 0.3173160173160173, AUC 0.6749407517636684
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7217813051146384
epoch: 9 idx: 0 First Loss : 3.2494893074035645, Second Loss : 3.712693452835083
epoch: 9 idx: 200 First Loss : 0.8869300657772953, Second Loss : 0.8845626609570773
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6709848484848484
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6923232323232323
  First-Tier acc 0.4336734693877551, precision 0.4353535353535354, recall 0.42283950617283955, F1 0.3090257284630686, AUC 0.6762703924162258
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7114748677248678{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.19159026211032762, "droprate_2": 0.0, "lr": 0.00010442011939984298, "weight_decay": 1.9520302290209164e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 19, "gamma": 0.41372086256870577, "T_max": 39, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0857632160186768, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1089809241505404, Second Loss : 1.1038851569318653
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7428914141414141
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7466666666666666
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703266231261023
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7096009700176366
epoch: 1 idx: 0 First Loss : 1.8688409328460693, Second Loss : 2.032012462615967
epoch: 1 idx: 200 First Loss : 0.9988577502283884, Second Loss : 1.0003870105862025
  First-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7331344696969696
  Second-Tier acc 0.5625, precision 0.3617886178861789, recall 0.4109090909090909, F1 0.36007130124777187, AUC 0.7495959595959595
  First-Tier acc 0.5816326530612245, precision 0.32431360888095945, recall 0.37191358024691357, F1 0.3125146198830409, AUC 0.6943927744708995
  Second-Tier acc 0.5918367346938775, precision 0.6444444444444445, recall 0.3988095238095238, F1 0.3632897603485839, AUC 0.7033179012345677
epoch: 2 idx: 0 First Loss : 2.4207653999328613, Second Loss : 2.5220541954040527
epoch: 2 idx: 200 First Loss : 0.9480791494472703, Second Loss : 0.9562916707117759
  First-Tier acc 0.546875, precision 0.5221334644217771, recall 0.5256565656565656, F1 0.45294948390966233, AUC 0.7363352272727273
  Second-Tier acc 0.625, precision 0.5813823857302118, recall 0.5884848484848485, F1 0.5839130434782609, AUC 0.7431313131313132
  First-Tier acc 0.5255102040816326, precision 0.5558608058608058, recall 0.4854497354497355, F1 0.4785764375876578, AUC 0.7005725033068783
  Second-Tier acc 0.5306122448979592, precision 0.48931623931623935, recall 0.5249118165784833, F1 0.499273783587509, AUC 0.720844356261023
epoch: 3 idx: 0 First Loss : 3.224355697631836, Second Loss : 3.1070165634155273
epoch: 3 idx: 200 First Loss : 0.930520120044401, Second Loss : 0.9302938474777771
  First-Tier acc 0.453125, precision 0.5019747899159664, recall 0.4758585858585859, F1 0.41357779327356603, AUC 0.7526609848484848
  Second-Tier acc 0.4583333333333333, precision 0.39233716475095787, recall 0.4460606060606061, F1 0.3666666666666667, AUC 0.789141414141414
  First-Tier acc 0.49489795918367346, precision 0.5436662086218135, recall 0.5032517636684304, F1 0.472815734989648, AUC 0.722577022707231
  Second-Tier acc 0.5510204081632653, precision 0.5437710437710438, recall 0.5537918871252204, F1 0.5309368191721133, AUC 0.7330798059964726
epoch: 4 idx: 0 First Loss : 3.6367173194885254, Second Loss : 3.642094135284424
epoch: 4 idx: 200 First Loss : 0.9287702941720314, Second Loss : 0.9206972411782736
  First-Tier acc 0.421875, precision 0.48978106125970666, recall 0.46795454545454546, F1 0.39104679587916885, AUC 0.7537720959595959
  Second-Tier acc 0.4375, precision 0.4738636363636364, recall 0.46414141414141413, F1 0.3794396311496175, AUC 0.7922727272727274
  First-Tier acc 0.5051020408163265, precision 0.5437818209044624, recall 0.54320987654321, F1 0.49219732553065887, AUC 0.7220878802910052
  Second-Tier acc 0.5306122448979592, precision 0.5499999999999999, recall 0.5529100529100529, F1 0.5236533492347446, AUC 0.7369378306878307
epoch: 5 idx: 0 First Loss : 3.829071044921875, Second Loss : 3.8022608757019043
epoch: 5 idx: 200 First Loss : 0.9272554498791361, Second Loss : 0.917759421411253
  First-Tier acc 0.4166666666666667, precision 0.4923815359477124, recall 0.4737373737373738, F1 0.38042049739377054, AUC 0.7523642676767676
  Second-Tier acc 0.4375, precision 0.4911764705882353, recall 0.48111111111111104, F1 0.37605820105820104, AUC 0.7802525252525253
  First-Tier acc 0.46938775510204084, precision 0.5298561342039603, recall 0.5053461199294532, F1 0.4473872368609211, AUC 0.7143718309082893
  Second-Tier acc 0.5102040816326531, precision 0.5382580382580383, recall 0.5405643738977072, F1 0.5023912003825921, AUC 0.7493937389770724
epoch: 6 idx: 0 First Loss : 3.8342323303222656, Second Loss : 3.9039266109466553
epoch: 6 idx: 200 First Loss : 0.924165130401753, Second Loss : 0.9137626123748979
  First-Tier acc 0.40625, precision 0.47798605056669574, recall 0.47131313131313135, F1 0.3707845988268081, AUC 0.7308080808080808
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.774090909090909
  First-Tier acc 0.4336734693877551, precision 0.49699739237608304, recall 0.44582231040564374, F1 0.40000527885554416, AUC 0.6939036320546736
  Second-Tier acc 0.5306122448979592, precision 0.5723905723905723, recall 0.5758377425044091, F1 0.5109114249037227, AUC 0.7625661375661376
epoch: 7 idx: 0 First Loss : 3.7529685497283936, Second Loss : 3.899876356124878
epoch: 7 idx: 200 First Loss : 0.9248890344300238, Second Loss : 0.9067598170883472
  First-Tier acc 0.40625, precision 0.47480767549610975, recall 0.47131313131313135, F1 0.3721264217531102, AUC 0.7026767676767677
  Second-Tier acc 0.4166666666666667, precision 0.4560664112388251, recall 0.4677777777777778, F1 0.3704991087344028, AUC 0.7517676767676768
  First-Tier acc 0.413265306122449, precision 0.4807889822595705, recall 0.41721781305114636, F1 0.3671675837168795, AUC 0.6833698467813051
  Second-Tier acc 0.46938775510204084, precision 0.5045977011494253, recall 0.4801587301587302, F1 0.42228274786414327, AUC 0.7736441798941799
epoch: 8 idx: 0 First Loss : 3.7107977867126465, Second Loss : 3.9425106048583984
epoch: 8 idx: 200 First Loss : 0.9171280822078396, Second Loss : 0.9006696653347324
  First-Tier acc 0.3854166666666667, precision 0.45875618006765545, recall 0.45436868686868687, F1 0.34954261490406074, AUC 0.6842329545454545
  Second-Tier acc 0.375, precision 0.43823953823953815, recall 0.44111111111111106, F1 0.332847295864263, AUC 0.7044444444444444
  First-Tier acc 0.4030612244897959, precision 0.478494623655914, recall 0.41391093474426804, F1 0.35744535504513425, AUC 0.6811997078924161
  Second-Tier acc 0.46938775510204084, precision 0.547979797979798, recall 0.4916225749559083, F1 0.42011144883485313, AUC 0.777281746031746
epoch: 9 idx: 0 First Loss : 3.5483851432800293, Second Loss : 3.9295034408569336
epoch: 9 idx: 200 First Loss : 0.9135847054120728, Second Loss : 0.8978568312314695
  First-Tier acc 0.3541666666666667, precision 0.4312890766702943, recall 0.42714646464646466, F1 0.3126213907770918, AUC 0.6652651515151515
  Second-Tier acc 0.3333333333333333, precision 0.38562091503267976, recall 0.39999999999999997, F1 0.27048984468339304, AUC 0.6752525252525251
  First-Tier acc 0.4030612244897959, precision 0.4877782140969889, recall 0.42091049382716045, F1 0.3466167864859339, AUC 0.6824501212522046
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.753747795414462{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.2702662546505231, "droprate_2": 0.0, "lr": 1.937414573080211e-05, "weight_decay": 0.0002616781301759285, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 14, "gamma": 0.6529727509095331, "T_max": 3, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.106648325920105, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0885176200475266, Second Loss : 1.0838202881575816
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7156881313131312
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7093434343434343
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.634913745590829
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6361882716049382
epoch: 1 idx: 0 First Loss : 2.008906841278076, Second Loss : 1.986304521560669
epoch: 1 idx: 200 First Loss : 1.094398563774071, Second Loss : 1.0928317042280786
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7377462121212122
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.732979797979798
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6778377149470899
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6809964726631393
epoch: 2 idx: 0 First Loss : 2.1010541915893555, Second Loss : 2.063153028488159
epoch: 2 idx: 200 First Loss : 1.0686106798215884, Second Loss : 1.0735157649611953
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7412910353535355
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482323232323232
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6995632164902998
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6975308641975309
epoch: 3 idx: 0 First Loss : 2.211066961288452, Second Loss : 2.169807195663452
epoch: 3 idx: 200 First Loss : 1.044274023108518, Second Loss : 1.0540544316543274
  First-Tier acc 0.5625, precision 0.4550477147162231, recall 0.3981818181818182, F1 0.34396635393076674, AUC 0.740457702020202
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7488888888888888
  First-Tier acc 0.5561224489795918, precision 0.5198618307426598, recall 0.34375, F1 0.25940467800932915, AUC 0.7037450396825399
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7003968253968255
epoch: 4 idx: 0 First Loss : 2.3659324645996094, Second Loss : 2.3276443481445312
epoch: 4 idx: 200 First Loss : 1.020098505476814, Second Loss : 1.0319483062965953
  First-Tier acc 0.65625, precision 0.678852628852629, recall 0.5496212121212122, F1 0.5088303675486364, AUC 0.7391887626262627
  Second-Tier acc 0.6041666666666666, precision 0.594017094017094, recall 0.46393939393939393, F1 0.4563492063492063, AUC 0.7471212121212121
  First-Tier acc 0.6326530612244898, precision 0.649621212121212, recall 0.5152667548500882, F1 0.535610480150603, AUC 0.6911720127865961
  Second-Tier acc 0.6530612244897959, precision 0.8093023255813954, recall 0.5238095238095238, F1 0.5067155067155067, AUC 0.7007275132275131
epoch: 5 idx: 0 First Loss : 2.5483341217041016, Second Loss : 2.511537551879883
epoch: 5 idx: 200 First Loss : 0.9951304026429926, Second Loss : 1.0062984994691402
  First-Tier acc 0.6354166666666666, precision 0.597330068246514, recall 0.587020202020202, F1 0.5564220346829042, AUC 0.7393213383838385
  Second-Tier acc 0.6666666666666666, precision 0.6062271062271063, recall 0.5812121212121212, F1 0.5848777078965758, AUC 0.7455050505050504
  First-Tier acc 0.5969387755102041, precision 0.5624978665301246, recall 0.5892305996472663, F1 0.571817615935263, AUC 0.6902006172839505
  Second-Tier acc 0.5306122448979592, precision 0.4790476190476191, recall 0.5134479717813051, F1 0.4805749805749806, AUC 0.6995701058201057
epoch: 6 idx: 0 First Loss : 2.737471580505371, Second Loss : 2.7191293239593506
epoch: 6 idx: 200 First Loss : 0.9736216623910624, Second Loss : 0.9831187524531612
  First-Tier acc 0.6145833333333334, precision 0.597538643165033, recall 0.6206313131313131, F1 0.5930366073072946, AUC 0.7478314393939395
  Second-Tier acc 0.625, precision 0.6060985797827904, recall 0.6123232323232323, F1 0.584795321637427, AUC 0.7588888888888888
  First-Tier acc 0.5612244897959183, precision 0.5486344903645228, recall 0.6087411816578484, F1 0.5523951186934613, AUC 0.7009066358024691
  Second-Tier acc 0.5306122448979592, precision 0.4954248366013072, recall 0.5427689594356261, F1 0.4895144571740316, AUC 0.7166005291005292
epoch: 7 idx: 0 First Loss : 2.9086923599243164, Second Loss : 2.9093408584594727
epoch: 7 idx: 200 First Loss : 0.9571798711885415, Second Loss : 0.9644069242944469
  First-Tier acc 0.5677083333333334, precision 0.5947936252126421, recall 0.619520202020202, F1 0.5661535989236377, AUC 0.7555555555555555
  Second-Tier acc 0.5, precision 0.5349650349650349, recall 0.5297979797979798, F1 0.469076732234627, AUC 0.7678787878787879
  First-Tier acc 0.5255102040816326, precision 0.5307791292845639, recall 0.58586860670194, F1 0.5165489355953139, AUC 0.7114541997354498
  Second-Tier acc 0.5102040816326531, precision 0.5067307692307693, recall 0.5890652557319224, F1 0.4907920101718551, AUC 0.7283950617283951
epoch: 8 idx: 0 First Loss : 3.055443286895752, Second Loss : 3.0646214485168457
epoch: 8 idx: 200 First Loss : 0.9453055210115008, Second Loss : 0.9512470283670657
  First-Tier acc 0.5052083333333334, precision 0.5636193705442532, recall 0.565530303030303, F1 0.5053252443545669, AUC 0.763080808080808
  Second-Tier acc 0.5, precision 0.5349650349650349, recall 0.5297979797979798, F1 0.469076732234627, AUC 0.7793939393939393
  First-Tier acc 0.47959183673469385, precision 0.5183858353467969, recall 0.5654210758377425, F1 0.4771748325272056, AUC 0.7213403880070546
  Second-Tier acc 0.46938775510204084, precision 0.48412698412698413, recall 0.564373897707231, F1 0.45800792983299293, AUC 0.7322530864197532
epoch: 9 idx: 0 First Loss : 3.1565351486206055, Second Loss : 3.1974666118621826
epoch: 9 idx: 200 First Loss : 0.9375632945772502, Second Loss : 0.941938978967382
  First-Tier acc 0.4895833333333333, precision 0.5562918833899623, recall 0.555530303030303, F1 0.4909883114625182, AUC 0.7668907828282828
  Second-Tier acc 0.5, precision 0.5492307692307693, recall 0.5467676767676767, F1 0.48073788073788065, AUC 0.8022727272727272
  First-Tier acc 0.4897959183673469, precision 0.5330130574033013, recall 0.58179012345679, F1 0.4876883254795248, AUC 0.7279403659611994
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7400793650793651{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.10575862731590295, "droprate_2": 0.0, "lr": 0.000597800641613522, "weight_decay": 3.593123404359337e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.082858681678772, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0933721913997807, Second Loss : 1.0843351369918282
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7249337121212122
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7308585858585858
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7130421902557318
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7251432980599648
epoch: 1 idx: 0 First Loss : 2.0021109580993652, Second Loss : 1.9450128078460693
epoch: 1 idx: 200 First Loss : 0.9760598331986375, Second Loss : 0.9647761258616376
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7064141414141414
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7011111111111111
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7137517912257496
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7219466490299825
epoch: 2 idx: 0 First Loss : 2.398439407348633, Second Loss : 2.3328025341033936
epoch: 2 idx: 200 First Loss : 0.9491750838522294, Second Loss : 0.9419758882911051
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6831597222222222
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6882828282828282
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6770833333333334
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6764770723104055
epoch: 3 idx: 0 First Loss : 2.5102179050445557, Second Loss : 2.3800220489501953
epoch: 3 idx: 200 First Loss : 0.9343451053942021, Second Loss : 0.9254353988674743
  First-Tier acc 0.578125, precision 0.38690476190476186, recall 0.4293939393939394, F1 0.37854843429909274, AUC 0.6891729797979798
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.6934848484848485
  First-Tier acc 0.5459183673469388, precision 0.25031210986267166, recall 0.3388447971781305, F1 0.26945126945126946, AUC 0.6489404210758378
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6770282186948854
epoch: 4 idx: 0 First Loss : 2.5811710357666016, Second Loss : 2.510153293609619
epoch: 4 idx: 200 First Loss : 0.9266118569976062, Second Loss : 0.9126416492224926
  First-Tier acc 0.5260416666666666, precision 0.36267104542966616, recall 0.49363636363636365, F1 0.3937120913038797, AUC 0.6802840909090909
  Second-Tier acc 0.5416666666666666, precision 0.3665458937198068, recall 0.49939393939393945, F1 0.40776310524209686, AUC 0.6876262626262625
  First-Tier acc 0.5051020408163265, precision 0.3556553986592497, recall 0.4230599647266314, F1 0.36429308565531476, AUC 0.63110050154321
  Second-Tier acc 0.5714285714285714, precision 0.3833333333333333, recall 0.4603174603174603, F1 0.4062342885872298, AUC 0.6687059082892416
epoch: 5 idx: 0 First Loss : 2.6233232021331787, Second Loss : 2.5820846557617188
epoch: 5 idx: 200 First Loss : 0.9128566373658565, Second Loss : 0.8982352101016994
  First-Tier acc 0.4166666666666667, precision 0.37157974300831437, recall 0.44909090909090904, F1 0.3202022025636397, AUC 0.680228851010101
  Second-Tier acc 0.4583333333333333, precision 0.3697478991596639, recall 0.48, F1 0.350997150997151, AUC 0.6825252525252526
  First-Tier acc 0.46938775510204084, precision 0.40541062801932365, recall 0.4329805996472664, F1 0.34144496280418607, AUC 0.6496534667107584
  Second-Tier acc 0.4897959183673469, precision 0.3843137254901961, recall 0.4338624338624338, F1 0.35714285714285715, AUC 0.6721781305114639
epoch: 6 idx: 0 First Loss : 2.7445201873779297, Second Loss : 2.662630558013916
epoch: 6 idx: 200 First Loss : 0.9069111825277408, Second Loss : 0.8908703001818402
  First-Tier acc 0.375, precision 0.36733680814097786, recall 0.4266666666666667, F1 0.2845180040392099, AUC 0.6694949494949495
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.712070707070707
  First-Tier acc 0.4387755102040816, precision 0.40840840840840836, recall 0.4173280423280423, F1 0.31606522320235236, AUC 0.660273368606702
  Second-Tier acc 0.4897959183673469, precision 0.4024216524216524, recall 0.445326278659612, F1 0.3566666666666667, AUC 0.6870039682539684
epoch: 7 idx: 0 First Loss : 2.846825122833252, Second Loss : 2.8398780822753906
epoch: 7 idx: 200 First Loss : 0.9035702722879192, Second Loss : 0.8856167633837061
  First-Tier acc 0.34375, precision 0.36049382716049383, recall 0.4066666666666667, F1 0.2558364414974444, AUC 0.6523579545454545
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6882323232323232
  First-Tier acc 0.40816326530612246, precision 0.40663500585036827, recall 0.4016754850088184, F1 0.2879556588436822, AUC 0.6558986441798942
  Second-Tier acc 0.46938775510204084, precision 0.39489489489489493, recall 0.4329805996472664, F1 0.3408748114630467, AUC 0.7196869488536155
epoch: 8 idx: 0 First Loss : 2.903794288635254, Second Loss : 2.9609076976776123
epoch: 8 idx: 200 First Loss : 0.9057842159958843, Second Loss : 0.8871198408954327
  First-Tier acc 0.3072916666666667, precision 0.33527131782945735, recall 0.3833333333333333, F1 0.2191358024691358, AUC 0.6084753787878788
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.590959595959596
  First-Tier acc 0.3877551020408163, precision 0.4103208511351261, recall 0.3921957671957672, F1 0.2669866773336889, AUC 0.6526916611552028
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7081679894179894
epoch: 9 idx: 0 First Loss : 3.1884405612945557, Second Loss : 3.208794593811035
epoch: 9 idx: 200 First Loss : 0.9058762885959105, Second Loss : 0.8760148391373159
  First-Tier acc 0.3020833333333333, precision 0.3435504469987229, recall 0.38000000000000006, F1 0.21365262012128752, AUC 0.623030303030303
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6829292929292929
  First-Tier acc 0.3826530612244898, precision 0.4387947269303201, recall 0.39197530864197533, F1 0.2599664312347223, AUC 0.6129195601851852
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.625165343915344{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_1", "train_show_freq": 200, "droprate": 0.19320461315485948, "droprate_2": 0.0, "lr": 1.1847703048256832e-05, "weight_decay": 3.723302232579912e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 7, "gamma": 0.14952737361100416, "T_max": 20, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_1", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0856587886810303, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0635709464550018, Second Loss : 1.0573737799231686
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7107575757575758
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6917171717171717
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6116898148148148
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6140873015873015
epoch: 1 idx: 0 First Loss : 1.880542278289795, Second Loss : 1.8980382680892944
epoch: 1 idx: 200 First Loss : 1.1043421540835603, Second Loss : 1.0999178062030925
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7265467171717171
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7153535353535353
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6551477072310404
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6459435626102293
epoch: 2 idx: 0 First Loss : 2.0081870555877686, Second Loss : 2.019296169281006
epoch: 2 idx: 200 First Loss : 1.0910268220587156, Second Loss : 1.0896105782606116
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7421685606060606
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7353030303030303
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.679708167989418
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6808862433862434
epoch: 3 idx: 0 First Loss : 2.068162441253662, Second Loss : 2.07983136177063
epoch: 3 idx: 200 First Loss : 1.0760002316378836, Second Loss : 1.0785880259316951
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7446811868686868
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7460101010101009
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6948130235890653
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932319223985891
epoch: 4 idx: 0 First Loss : 2.1396324634552, Second Loss : 2.153082847595215
epoch: 4 idx: 200 First Loss : 1.0618849958649916, Second Loss : 1.067447425343504
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7434217171717172
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7485353535353535
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7015680114638448
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703152557319224
epoch: 5 idx: 0 First Loss : 2.2222981452941895, Second Loss : 2.235628366470337
epoch: 5 idx: 200 First Loss : 1.0472577492618442, Second Loss : 1.054672216190331
  First-Tier acc 0.578125, precision 0.45643939393939387, recall 0.4251515151515151, F1 0.3811594202898551, AUC 0.739927398989899
  Second-Tier acc 0.5, precision 0.1818181818181818, recall 0.32, F1 0.2318840579710145, AUC 0.7461616161616161
  First-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6965663580246915
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.697585978835979
epoch: 6 idx: 0 First Loss : 2.3214399814605713, Second Loss : 2.336132526397705
epoch: 6 idx: 200 First Loss : 1.0304709374533958, Second Loss : 1.0399731279012576
  First-Tier acc 0.65625, precision 0.5953345877358035, recall 0.5508838383838384, F1 0.49118101102038997, AUC 0.7418213383838385
  Second-Tier acc 0.5833333333333334, precision 0.5146520146520147, recall 0.4336363636363636, F1 0.4065452091767881, AUC 0.7488383838383837
  First-Tier acc 0.5816326530612245, precision 0.568864468864469, recall 0.4286265432098766, F1 0.42919373568088376, AUC 0.6886780753968255
  Second-Tier acc 0.6530612244897959, precision 0.7698412698412698, recall 0.5238095238095238, F1 0.49579020013802627, AUC 0.6899801587301587
epoch: 7 idx: 0 First Loss : 2.4420580863952637, Second Loss : 2.4514663219451904
epoch: 7 idx: 200 First Loss : 1.0037102136594147, Second Loss : 1.0100566304071033
  First-Tier acc 0.6666666666666666, precision 0.42929292929292934, recall 0.5751515151515152, F1 0.4916003536693192, AUC 0.7410069444444445
  Second-Tier acc 0.6875, precision 0.7841269841269841, recall 0.5902020202020202, F1 0.5498327759197325, AUC 0.7487878787878787
  First-Tier acc 0.5612244897959183, precision 0.6725280944296225, recall 0.4127535273368606, F1 0.38804317171290936, AUC 0.6876033399470899
  Second-Tier acc 0.6326530612244898, precision 0.6051051051051051, recall 0.5343915343915343, F1 0.5404761904761904, AUC 0.6902557319223986
epoch: 8 idx: 0 First Loss : 2.45086407661438, Second Loss : 2.460730791091919
epoch: 8 idx: 200 First Loss : 0.9868431923104756, Second Loss : 0.9946415071463703
  First-Tier acc 0.6614583333333334, precision 0.42346052897233993, recall 0.576060606060606, F1 0.48743752441768046, AUC 0.74010101010101
  Second-Tier acc 0.6875, precision 0.7841269841269841, recall 0.5902020202020202, F1 0.5498327759197325, AUC 0.7494949494949495
  First-Tier acc 0.5510204081632653, precision 0.6710374971244537, recall 0.4123126102292769, F1 0.38715358715358716, AUC 0.6871762014991182
  Second-Tier acc 0.6122448979591837, precision 0.5982905982905983, recall 0.4977954144620811, F1 0.5138047138047138, AUC 0.6862323633156966
epoch: 9 idx: 0 First Loss : 2.4782073497772217, Second Loss : 2.4832804203033447
epoch: 9 idx: 200 First Loss : 0.9805732800889371, Second Loss : 0.9882687015542343
  First-Tier acc 0.65625, precision 0.4191044776119403, recall 0.5727272727272728, F1 0.4828828828828829, AUC 0.7391982323232323
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7503030303030304
  First-Tier acc 0.5459183673469388, precision 0.6746277458351763, recall 0.4178240740740741, F1 0.390691051484003, AUC 0.6867456183862434
  Second-Tier acc 0.5714285714285714, precision 0.5261437908496732, recall 0.4552469135802469, F1 0.4511224297302396, AUC 0.6877204585537919