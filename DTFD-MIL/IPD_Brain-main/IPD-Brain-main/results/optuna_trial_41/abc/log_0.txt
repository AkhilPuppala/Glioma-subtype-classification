{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_41", "train_show_freq": 200, "droprate": 0.3386875855760151, "droprate_2": 0.0, "lr": 1.165810634312813e-05, "weight_decay": 4.873432269837594e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_41", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.165810634312813e-05
epoch: 0 idx: 0 First Loss : 1.224515438079834, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0590075297438684, Second Loss : 1.04074154416127
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6707744107744107
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7456060606060606
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6111601019008427
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6100088183421516
Test AUC: 0.6100, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.165810634312813e-05
epoch: 1 idx: 0 First Loss : 2.012240171432495, Second Loss : 1.9652553796768188
epoch: 1 idx: 200 First Loss : 1.1078141800206691, Second Loss : 1.0932548095041246
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7100785634118966
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7550505050505051
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6555396335488929
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6614307760141093
Test AUC: 0.6614, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.165810634312813e-05
epoch: 2 idx: 0 First Loss : 2.116988182067871, Second Loss : 2.0911755561828613
epoch: 2 idx: 200 First Loss : 1.099615390250339, Second Loss : 1.0846046208593976
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7251122334455667
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7611616161616163
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6846340388007054
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7005621693121693
Test AUC: 0.7006, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.165810634312813e-05
epoch: 3 idx: 0 First Loss : 2.1819489002227783, Second Loss : 2.1540298461914062
epoch: 3 idx: 200 First Loss : 1.0875287445178672, Second Loss : 1.0726465726669747
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7371773288439956
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7656060606060606
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7005499216147365
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7053020282186949
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 4 idx: 0 First Loss : 2.2638771533966064, Second Loss : 2.225017547607422
epoch: 4 idx: 200 First Loss : 1.0749801180849028, Second Loss : 1.0604425409984826
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.740516273849607
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7550505050505051
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7092151675485008
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138999118165784
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 5 idx: 0 First Loss : 2.346747636795044, Second Loss : 2.302676200866699
epoch: 5 idx: 200 First Loss : 1.0620005187851873, Second Loss : 1.0477630187993618
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7388888888888889
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.75
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7132201646090536
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7137345679012346
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 6 idx: 0 First Loss : 2.4476163387298584, Second Loss : 2.391636610031128
epoch: 6 idx: 200 First Loss : 1.0457898344270034, Second Loss : 1.0325017986235334
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5763888888888888, precision 0.4014550264550265, recall 0.4254545454545455, F1 0.3781771415033675, AUC 0.7349663299663299
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.750909090909091
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5918367346938775, precision 0.6386890487609912, recall 0.41071428571428564, F1 0.37521188900499247, AUC 0.708535420340976
  Second-Tier acc 0.5714285714285714, precision 0.27121212121212124, recall 0.35714285714285715, F1 0.288608846058809, AUC 0.7167107583774252
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 7 idx: 0 First Loss : 2.558490037918091, Second Loss : 2.4950032234191895
epoch: 7 idx: 200 First Loss : 1.027713973612631, Second Loss : 1.0151337931924198
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6666666666666666, precision 0.6767393561786085, recall 0.5621885521885522, F1 0.561522535435579, AUC 0.7350056116722783
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7547474747474747
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6666666666666666, precision 0.682261208576998, recall 0.5685626102292769, F1 0.5797185270869482, AUC 0.6994476288457769
  Second-Tier acc 0.6122448979591837, precision 0.5460030165912518, recall 0.46847442680776014, F1 0.46618093503339403, AUC 0.71086860670194
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 8 idx: 0 First Loss : 2.681074380874634, Second Loss : 2.615309000015259
epoch: 8 idx: 200 First Loss : 1.009567065748261, Second Loss : 0.9986539123144316
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.5813008130081301, recall 0.5724579124579124, F1 0.5754101704851539, AUC 0.7305780022446688
  Second-Tier acc 0.6458333333333334, precision 0.41798941798941797, recall 0.583030303030303, F1 0.4775641025641026, AUC 0.7539393939393939
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5782312925170068, precision 0.5307186886134255, recall 0.5613609641387419, F1 0.5391151813377073, AUC 0.7033730158730158
  Second-Tier acc 0.6122448979591837, precision 0.5543133195307108, recall 0.5551146384479718, F1 0.5387545787545788, AUC 0.7203483245149913
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 9 idx: 0 First Loss : 2.8204305171966553, Second Loss : 2.746381998062134
epoch: 9 idx: 200 First Loss : 0.9932338781840172, Second Loss : 0.9837728684666145
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5416666666666666, precision 0.5140350877192983, recall 0.5148148148148148, F1 0.5013809368648078, AUC 0.7272166105499439
  Second-Tier acc 0.5625, precision 0.5304347826086957, recall 0.5416161616161617, F1 0.4919389978213508, AUC 0.7538888888888889
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5170068027210885, precision 0.4770975056689342, recall 0.5149911816578483, F1 0.4722370475795133, AUC 0.7047141387419166
  Second-Tier acc 0.673469387755102, precision 0.668261562998405, recall 0.7272927689594356, F1 0.6795182950789358, AUC 0.7337962962962962
Test AUC: 0.7053, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.165810634312813e-05
epoch: 10 idx: 0 First Loss : 2.9568259716033936, Second Loss : 2.8786532878875732
epoch: 10 idx: 200 First Loss : 0.9794798874995898, Second Loss : 0.9712964530607954
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5, precision 0.48600769922316217, recall 0.4895959595959596, F1 0.45497061748720435, AUC 0.7285690235690235
  Second-Tier acc 0.5416666666666666, precision 0.603030303030303, recall 0.603030303030303, F1 0.5370370370370371, AUC 0.770959595959596
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.4396253345227475, recall 0.4916960611405055, F1 0.4209946656856433, AUC 0.709313149127964
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7497795414462081
Test AUC: 0.7498, Test F1: 0.6002 (Best Epoch: 10)
Current LR: 1.165810634312813e-05
epoch: 11 idx: 0 First Loss : 3.0830516815185547, Second Loss : 3.005283832550049
epoch: 11 idx: 200 First Loss : 0.9687372477196935, Second Loss : 0.9616215805898407
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4583333333333333, precision 0.48641599364490934, recall 0.4773737373737374, F1 0.42292084784607215, AUC 0.7303030303030303
  Second-Tier acc 0.5416666666666666, precision 0.6055555555555555, recall 0.6174747474747475, F1 0.5413919413919414, AUC 0.7871212121212121
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4421768707482993, precision 0.4719582704876823, recall 0.5147707231040565, F1 0.4245270742855283, AUC 0.7157370664315108
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7605268959435625
Test AUC: 0.7605, Test F1: 0.5624 (Best Epoch: 11)
Current LR: 1.165810634312813e-05
epoch: 12 idx: 0 First Loss : 3.192305326461792, Second Loss : 3.113987922668457
epoch: 12 idx: 200 First Loss : 0.9604779138271489, Second Loss : 0.9547009890834194
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4444444444444444, precision 0.49639370023129753, recall 0.47895622895622897, F1 0.41581196581196583, AUC 0.7389057239057238
  Second-Tier acc 0.5208333333333334, precision 0.5870571658615137, recall 0.6041414141414142, F1 0.5196078431372549, AUC 0.8016161616161616
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.4611504399415322, recall 0.5024250440917107, F1 0.40838257348694945, AUC 0.720776993925142
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7641093474426809
Test AUC: 0.7641, Test F1: 0.5455 (Best Epoch: 12)
Current LR: 1.165810634312813e-05
epoch: 13 idx: 0 First Loss : 3.285015106201172, Second Loss : 3.2084412574768066
epoch: 13 idx: 200 First Loss : 0.9534535542992291, Second Loss : 0.9487953403714433
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4305555555555556, precision 0.4907701352145797, recall 0.4660942760942761, F1 0.408817265185055, AUC 0.7446969696969696
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.807020202020202
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.4764539808018069, recall 0.5141828336272781, F1 0.42070707070707075, AUC 0.7260802469135802
  Second-Tier acc 0.5306122448979592, precision 0.5732103645147123, recall 0.6408730158730159, F1 0.5409734677469231, AUC 0.7699514991181658
Test AUC: 0.7700, Test F1: 0.5410 (Best Epoch: 13)
Current LR: 1.165810634312813e-05
epoch: 14 idx: 0 First Loss : 3.35886549949646, Second Loss : 3.2885031700134277
epoch: 14 idx: 200 First Loss : 0.9477315864836177, Second Loss : 0.944025982648542
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5041666666666667, recall 0.472962962962963, F1 0.40853742908537427, AUC 0.7468350168350169
  Second-Tier acc 0.4791666666666667, precision 0.5593563512361466, recall 0.5605050505050505, F1 0.4788042698793206, AUC 0.8102020202020203
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5166666666666667, recall 0.5376984126984127, F1 0.4400329088352039, AUC 0.7307343719380756
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7729828042328042
Test AUC: 0.7730, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.165810634312813e-05
epoch: 15 idx: 0 First Loss : 3.428368330001831, Second Loss : 3.3541793823242188
epoch: 15 idx: 200 First Loss : 0.9431429508383112, Second Loss : 0.9401739073444658
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.5133443512162047, recall 0.4887205387205387, F1 0.41978458049886624, AUC 0.7487149270482604
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8138888888888888
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5437668244685788, recall 0.543503821281599, F1 0.4484306668214714, AUC 0.7359090241034686
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.773423721340388
Test AUC: 0.7734, Test F1: 0.5120 (Best Epoch: 15)
Current LR: 1.165810634312813e-05
epoch: 16 idx: 0 First Loss : 3.4842689037323, Second Loss : 3.409069061279297
epoch: 16 idx: 200 First Loss : 0.9386105384487677, Second Loss : 0.9363630759223962
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4027777777777778, precision 0.5001822738664844, recall 0.47262626262626267, F1 0.3969228616960452, AUC 0.7538664421997755
  Second-Tier acc 0.4375, precision 0.5324074074074074, recall 0.5338383838383839, F1 0.434511008704557, AUC 0.8141919191919191
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5470136318232564, recall 0.5470311581422692, F1 0.4439201321554263, AUC 0.7403304428767391
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7761794532627867
Test AUC: 0.7762, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.165810634312813e-05
epoch: 17 idx: 0 First Loss : 3.530510663986206, Second Loss : 3.453641414642334
epoch: 17 idx: 200 First Loss : 0.934453555334137, Second Loss : 0.9327080106450736
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5207213261648745, recall 0.5094276094276095, F1 0.42121109224674586, AUC 0.7558754208754209
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8125252525252525
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5644374782305818, recall 0.5549676660787771, F1 0.45201283209413284, AUC 0.7424370468351951
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7884700176366843
Test AUC: 0.7762, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.165810634312813e-05
epoch: 18 idx: 0 First Loss : 3.5684688091278076, Second Loss : 3.4899508953094482
epoch: 18 idx: 200 First Loss : 0.9302828900043422, Second Loss : 0.9291088333937214
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.5337301587301587, recall 0.5321548821548822, F1 0.4360058461217246, AUC 0.7575982042648709
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8083838383838383
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.571916346564234, recall 0.562610229276896, F1 0.4535238986375328, AUC 0.7423758083480306
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7905092592592592
Test AUC: 0.7762, Test F1: 0.5120 (Best Epoch: 16)
Current LR: 1.165810634312813e-05
epoch: 19 idx: 0 First Loss : 3.5941905975341797, Second Loss : 3.513338565826416
epoch: 19 idx: 200 First Loss : 0.9259703479236946, Second Loss : 0.9254694488038545
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5413537755527743, recall 0.5504377104377104, F1 0.4390829960859213, AUC 0.7593209876543211
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8025757575757576
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.47619047619047616, precision 0.5956312349501204, recall 0.5981775426219871, F1 0.4792825045216386, AUC 0.7447579854987262
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7919973544973544
Test AUC: 0.7762, Test F1: 0.5120 (Best Epoch: 16)