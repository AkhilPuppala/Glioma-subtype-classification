{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.23230280762374697, "droprate_2": 0.0, "lr": 0.00011893630190866766, "weight_decay": 3.95877849485057e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00011893630190866766
epoch: 0 idx: 0 First Loss : 0.9286659359931946, Second Loss : 1.0359247922897339
epoch: 0 idx: 200 First Loss : 1.1155228769749552, Second Loss : 1.1007389174913293
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4994981060606061
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49540404040404046
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4601727843915344
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4561838624338624
 
 test auc: 0.4561838624338624, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.2506273348608872, "droprate_2": 0.0, "lr": 0.00012980420347097224, "weight_decay": 0.00013022519050794723, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00012980420347097224
epoch: 0 idx: 0 First Loss : 1.1390862464904785, Second Loss : 1.1625142097473145
epoch: 0 idx: 200 First Loss : 1.086914983221251, Second Loss : 1.098564418394174
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.47888888888888886
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4782323232323232
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4463045634920635
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43904320987654316
 
 test auc: 0.43904320987654316, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00012980420347097224
epoch: 1 idx: 0 First Loss : 1.6153898239135742, Second Loss : 1.9959585666656494
epoch: 1 idx: 200 First Loss : 0.976198631732618, Second Loss : 0.9990374787678173
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4877146464646464
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4819191919191919
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46213624338624343
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4549162257495591
 
 test auc: 0.4549162257495591, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00012980420347097224
epoch: 2 idx: 0 First Loss : 2.0786168575286865, Second Loss : 2.454984188079834
epoch: 2 idx: 200 First Loss : 0.9298967974844263, Second Loss : 0.9577098930097041
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.28125, precision 0.29114676173499704, recall 0.3675757575757575, F1 0.26793250578842626, AUC 0.48323232323232324
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.35606060606060613, F1 0.22456140350877193, AUC 0.45873737373737383
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3673469387755102, precision 0.39282051282051283, recall 0.36496913580246915, F1 0.3760192553296002, AUC 0.5080605158730158
  Second-Tier acc 0.3469387755102041, precision 0.37320574162679426, recall 0.373015873015873, F1 0.3699237270665842, AUC 0.5138888888888888
 
 test auc: 0.4549162257495591, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00012980420347097224
epoch: 3 idx: 0 First Loss : 2.764575719833374, Second Loss : 3.3630623817443848
epoch: 3 idx: 200 First Loss : 0.9004059706383677, Second Loss : 0.9389694878618368
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2604166666666667, precision 0.22496947496947498, recall 0.36777777777777776, F1 0.19410006497725796, AUC 0.48728535353535357
  Second-Tier acc 0.20833333333333334, precision 0.16472520908004779, recall 0.2835353535353536, F1 0.17992530345471522, AUC 0.4682323232323233
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.35714285714285715, precision 0.1937377690802348, recall 0.23324514991181655, F1 0.20879532915528418, AUC 0.5263861331569665
  Second-Tier acc 0.42857142857142855, precision 0.4070929070929071, recall 0.46957671957671954, F1 0.4251700680272108, AUC 0.5369268077601411
 
 test auc: 0.4549162257495591, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00012980420347097224
epoch: 4 idx: 0 First Loss : 3.3724703788757324, Second Loss : 3.9863667488098145
epoch: 4 idx: 200 First Loss : 0.890012126005908, Second Loss : 0.9362200326564263
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.28125, precision 0.33127572016460904, recall 0.3811111111111111, F1 0.2185131481247986, AUC 0.5075883838383839
  Second-Tier acc 0.2916666666666667, precision 0.2638888888888889, recall 0.3198989898989899, F1 0.2633936261843239, AUC 0.47787878787878785
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.37755102040816324, precision 0.1522633744855967, recall 0.22839506172839508, F1 0.18271604938271604, AUC 0.5414737654320988
  Second-Tier acc 0.3673469387755102, precision 0.3, recall 0.42746913580246915, F1 0.32269503546099293, AUC 0.5647045855379189
 
 test auc: 0.4549162257495591, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00012980420347097224
epoch: 5 idx: 0 First Loss : 3.6263086795806885, Second Loss : 4.175439834594727
epoch: 5 idx: 200 First Loss : 0.8810694689071269, Second Loss : 0.935276330522243
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3020833333333333, precision 0.4423868312757202, recall 0.39444444444444443, F1 0.24232267193432241, AUC 0.5591919191919192
  Second-Tier acc 0.3333333333333333, precision 0.3796296296296296, recall 0.4144444444444444, F1 0.2790869112077074, AUC 0.5335858585858585
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3469387755102041, precision 0.1452991452991453, recall 0.20987654320987656, F1 0.1717171717171717, AUC 0.5128830467372135
  Second-Tier acc 0.3673469387755102, precision 0.2767676767676768, recall 0.3395061728395062, F1 0.30409356725146197, AUC 0.5299823633156967
 
 test auc: 0.5299823633156967, test F1: 0.30409356725146197  :  from epoch 5
 current learn rate 0.00012980420347097224
epoch: 6 idx: 0 First Loss : 3.9540960788726807, Second Loss : 4.1230692863464355
epoch: 6 idx: 200 First Loss : 0.8794298970096499, Second Loss : 0.9311121056529355
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3125, precision 0.45958259847148736, recall 0.40111111111111114, F1 0.2542369272696304, AUC 0.6312121212121212
  Second-Tier acc 0.3541666666666667, precision 0.4964912280701754, recall 0.42777777777777776, F1 0.29998666133119917, AUC 0.6168686868686869
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3877551020408163, precision 0.15637860082304525, recall 0.23456790123456792, F1 0.18765432098765433, AUC 0.4846092372134039
  Second-Tier acc 0.3673469387755102, precision 0.20870870870870872, recall 0.2515432098765432, F1 0.22470238095238093, AUC 0.4985670194003527
 
 test auc: 0.4985670194003527, test F1: 0.22470238095238093  :  from epoch 6
 current learn rate 0.00012980420347097224
epoch: 7 idx: 0 First Loss : 3.7831854820251465, Second Loss : 4.075617790222168
epoch: 7 idx: 200 First Loss : 0.8828948717486155, Second Loss : 0.9305725486567407
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3125, precision 0.47038327526132395, recall 0.40111111111111114, F1 0.2542118323103043, AUC 0.6744318181818182
  Second-Tier acc 0.3125, precision 0.5060975609756098, recall 0.40111111111111114, F1 0.2541208791208791, AUC 0.6676767676767678
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.44447200176366836
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.4737103174603175
 
 test auc: 0.4737103174603175, test F1: 0.1791044776119403  :  from epoch 7
 current learn rate 0.00012980420347097224
epoch: 8 idx: 0 First Loss : 3.6584086418151855, Second Loss : 3.984816789627075
epoch: 8 idx: 200 First Loss : 0.8816462582482872, Second Loss : 0.9259221190275376
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3229166666666667, precision 0.49220867208672087, recall 0.4077777777777778, F1 0.26592985558502796, AUC 0.6651262626262627
  Second-Tier acc 0.3125, precision 0.5060975609756098, recall 0.40111111111111114, F1 0.2541208791208791, AUC 0.6620707070707071
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4312444885361552
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4375
 
 test auc: 0.4737103174603175, test F1: 0.1791044776119403  :  from epoch 7
 current learn rate 0.00012980420347097224
epoch: 9 idx: 0 First Loss : 3.589667797088623, Second Loss : 3.8481428623199463
epoch: 9 idx: 200 First Loss : 0.8825547336751308, Second Loss : 0.9256361991926374
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.28125, precision 0.4124274877286925, recall 0.3811111111111111, F1 0.21712361712361714, AUC 0.6664015151515151
  Second-Tier acc 0.3125, precision 0.5060975609756098, recall 0.40111111111111114, F1 0.2541208791208791, AUC 0.6724747474747476
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.41836734693877553, precision 0.1607843137254902, recall 0.25308641975308643, F1 0.19664268585131894, AUC 0.4229359567901234
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4243276014109348
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 10 idx: 0 First Loss : 3.974372386932373, Second Loss : 3.9838383197784424
epoch: 10 idx: 200 First Loss : 0.8866276168045446, Second Loss : 0.926082633078082
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3333333333333333, precision 0.48320105820105813, recall 0.4144444444444444, F1 0.27719708258736336, AUC 0.6684217171717171
  Second-Tier acc 0.2916666666666667, precision 0.5297157622739018, recall 0.3877777777777778, F1 0.22962962962962963, AUC 0.6697474747474748
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3877551020408163, precision 0.17992766726943943, recall 0.24922839506172842, F1 0.2076858813700919, AUC 0.4264357363315696
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.43309082892416234
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 11 idx: 0 First Loss : 3.6389241218566895, Second Loss : 4.033154487609863
epoch: 11 idx: 200 First Loss : 0.8860176510192901, Second Loss : 0.9186290859545069
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3020833333333333, precision 0.46136928667049154, recall 0.39444444444444443, F1 0.24221710189452125, AUC 0.668939393939394
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6638383838383838
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41836734693877553, precision 0.1607843137254902, recall 0.25308641975308643, F1 0.19664268585131894, AUC 0.423817791005291
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.43105158730158727
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 12 idx: 0 First Loss : 3.5655784606933594, Second Loss : 4.0615010261535645
epoch: 12 idx: 200 First Loss : 0.8835404611242453, Second Loss : 0.9130262543001311
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2604166666666667, precision 0.3270152505446623, recall 0.36777777777777776, F1 0.1902962043148959, AUC 0.6683964646464645
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6611616161616162
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4205798059964727
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.43088624338624343
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 13 idx: 0 First Loss : 3.487562656402588, Second Loss : 4.007539749145508
epoch: 13 idx: 200 First Loss : 0.8747843772654951, Second Loss : 0.9047047827517413
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.28125, precision 0.42063492063492064, recall 0.3811111111111111, F1 0.21706848357791753, AUC 0.6641666666666667
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6558585858585858
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.42405202821869487
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4225088183421517
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 14 idx: 0 First Loss : 3.6377313137054443, Second Loss : 4.0995988845825195
epoch: 14 idx: 200 First Loss : 0.8694747171532289, Second Loss : 0.8968620182329786
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3229166666666667, precision 0.47743974132863015, recall 0.4077777777777778, F1 0.26586534480958707, AUC 0.658939393939394
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6489898989898989
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.41836734693877553, precision 0.1909456005841548, recall 0.2677469135802469, F1 0.21933855997116336, AUC 0.4287781084656084
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4243827160493827
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 15 idx: 0 First Loss : 3.5735249519348145, Second Loss : 4.114237308502197
epoch: 15 idx: 200 First Loss : 0.8615912601712875, Second Loss : 0.8901007254342367
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2916666666666667, precision 0.4492063492063492, recall 0.3877777777777778, F1 0.22986038104723436, AUC 0.6579924242424242
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6424747474747474
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.45918367346938777, precision 0.16853932584269662, recall 0.2777777777777778, F1 0.2097902097902098, AUC 0.43001818783068785
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4286265432098766
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 16 idx: 0 First Loss : 3.5110607147216797, Second Loss : 3.9906115531921387
epoch: 16 idx: 200 First Loss : 0.8489244015465727, Second Loss : 0.8802547239840252
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.48320105820105813, recall 0.4144444444444444, F1 0.27719708258736336, AUC 0.6556691919191919
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6427777777777778
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.21388367729831145, recall 0.28858024691358025, F1 0.2420554428668019, AUC 0.43610835537918874
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.43595679012345684
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 17 idx: 0 First Loss : 3.5077767372131348, Second Loss : 4.086940288543701
epoch: 17 idx: 200 First Loss : 0.8507602275195988, Second Loss : 0.8734630580393467
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.375, precision 0.49942163100057835, recall 0.44111111111111106, F1 0.31965474361787727, AUC 0.6587121212121212
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6373737373737374
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41836734693877553, precision 0.20694444444444446, recall 0.2824074074074074, F1 0.2370406034344407, AUC 0.43521274250440917
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4258156966490299
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 18 idx: 0 First Loss : 3.44114351272583, Second Loss : 4.184237957000732
epoch: 18 idx: 200 First Loss : 0.8462348727437901, Second Loss : 0.8646403103292263
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.28125, precision 0.42063492063492064, recall 0.3811111111111111, F1 0.21706848357791753, AUC 0.6664267676767676
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6478282828282828
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.16666666666666666, recall 0.2716049382716049, F1 0.20657276995305163, AUC 0.4293292548500882
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4205798059964727
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9
 current learn rate 0.00012980420347097224
epoch: 19 idx: 0 First Loss : 3.577484607696533, Second Loss : 4.193000316619873
epoch: 19 idx: 200 First Loss : 0.8421142201078686, Second Loss : 0.8587478647854033
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2604166666666667, precision 0.5009578544061303, recall 0.36777777777777776, F1 0.18929513701505066, AUC 0.6678030303030303
  Second-Tier acc 0.25, precision 0.19259259259259257, recall 0.3611111111111111, F1 0.1753968253968254, AUC 0.6551515151515152
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.45918367346938777, precision 0.16853932584269662, recall 0.2777777777777778, F1 0.2097902097902098, AUC 0.4248098544973545
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4203042328042328
 
 test auc: 0.4243276014109348, test F1: 0.18627450980392157  :  from epoch 9{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.4190868499247099, "droprate_2": 0.0, "lr": 5.407014482835409e-05, "weight_decay": 2.3666461842305376e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 5.407014482835409e-05
epoch: 0 idx: 0 First Loss : 1.2678383588790894, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1307313181645242, Second Loss : 1.119150777213016
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.730364758698092
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7525252525252526
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6908742406427592
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6855158730158731
Test AUC: 0.6855, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 5.407014482835409e-05
epoch: 1 idx: 0 First Loss : 2.2137904167175293, Second Loss : 2.188098192214966
epoch: 1 idx: 200 First Loss : 1.04686979330446, Second Loss : 1.0487588810090402
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7377384960718293
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7546464646464646
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7122464726631392
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7075066137566138
Test AUC: 0.7075, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 5.407014482835409e-05
epoch: 2 idx: 0 First Loss : 2.4337503910064697, Second Loss : 2.3874599933624268
epoch: 2 idx: 200 First Loss : 0.9947563888718239, Second Loss : 0.9999223738463957
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6527777777777778, precision 0.6132616487455197, recall 0.5595622895622896, F1 0.5713268786346793, AUC 0.7284062850729517
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.756060606060606
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.47554347826086957, recall 0.5007348618459729, F1 0.4760782570031125, AUC 0.6921357534783462
  Second-Tier acc 0.6122448979591837, precision 0.6035842293906809, recall 0.5092592592592592, F1 0.5235109717868339, AUC 0.7001763668430335
Test AUC: 0.7002, Test F1: 0.5235 (Best Epoch: 2)
Current LR: 5.407014482835409e-05
epoch: 3 idx: 0 First Loss : 2.87819766998291, Second Loss : 2.817432403564453
epoch: 3 idx: 200 First Loss : 0.9467926509122351, Second Loss : 0.9615898484836763
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5277777777777778, precision 0.5388247863247863, recall 0.5121885521885522, F1 0.47764745196324143, AUC 0.727418630751964
  Second-Tier acc 0.5833333333333334, precision 0.5615705931495406, recall 0.5762626262626264, F1 0.5601122334455667, AUC 0.7523232323232323
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.43537414965986393, precision 0.42890560380479736, recall 0.46391828336272783, F1 0.40145585008598705, AUC 0.7068268665490888
  Second-Tier acc 0.5918367346938775, precision 0.5869281045751634, recall 0.6549823633156966, F1 0.587062773598538, AUC 0.7239307760141093
Test AUC: 0.7002, Test F1: 0.5235 (Best Epoch: 2)
Current LR: 5.407014482835409e-05
epoch: 4 idx: 0 First Loss : 3.3480284214019775, Second Loss : 3.311483860015869
epoch: 4 idx: 200 First Loss : 0.920312564662514, Second Loss : 0.9433205866935983
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4513888888888889, precision 0.4856345408976988, recall 0.47942760942760937, F1 0.4275210084033613, AUC 0.722351290684624
  Second-Tier acc 0.5208333333333334, precision 0.5772144522144522, recall 0.5871717171717172, F1 0.5247619047619048, AUC 0.7696464646464647
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4217687074829932, precision 0.46557734204793033, recall 0.4943415637860082, F1 0.4163942389748841, AUC 0.72074637468156
  Second-Tier acc 0.5510204081632653, precision 0.5666666666666668, recall 0.6302910052910052, F1 0.5594601476954417, AUC 0.7525352733686068
Test AUC: 0.7525, Test F1: 0.5595 (Best Epoch: 4)
Current LR: 5.407014482835409e-05
epoch: 5 idx: 0 First Loss : 3.7720272541046143, Second Loss : 3.726257085800171
epoch: 5 idx: 200 First Loss : 0.9115757352779087, Second Loss : 0.9391790114584105
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4444444444444444, precision 0.510513439861266, recall 0.4976094276094276, F1 0.4339315084813686, AUC 0.7252132435465768
  Second-Tier acc 0.5208333333333334, precision 0.599074074074074, recall 0.6016161616161616, F1 0.5258221807241416, AUC 0.7829292929292929
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.5120673952641165, recall 0.5239564961787183, F1 0.44848773244683543, AUC 0.7265027924750148
  Second-Tier acc 0.5918367346938775, precision 0.6378205128205128, recall 0.689373897707231, F1 0.6032388663967612, AUC 0.7656525573192239
Test AUC: 0.7657, Test F1: 0.6032 (Best Epoch: 5)
Current LR: 5.407014482835409e-05
epoch: 6 idx: 0 First Loss : 3.941721200942993, Second Loss : 3.956549882888794
epoch: 6 idx: 200 First Loss : 0.9071379106570573, Second Loss : 0.9401280169852486
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.5195354597950748, recall 0.5154208754208754, F1 0.44052182590388567, AUC 0.7251964085297419
  Second-Tier acc 0.4375, precision 0.527065527065527, recall 0.487979797979798, F1 0.4343402225755167, AUC 0.7862121212121211
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.556269387290475, recall 0.5512933568489123, F1 0.46312254723469676, AUC 0.7374889770723104
  Second-Tier acc 0.5306122448979592, precision 0.6172161172161172, recall 0.623015873015873, F1 0.5318181818181819, AUC 0.7857694003527337
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 7 idx: 0 First Loss : 3.992137908935547, Second Loss : 4.035010814666748
epoch: 7 idx: 200 First Loss : 0.9038526771766184, Second Loss : 0.938214681998581
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3958333333333333, precision 0.4954203691045796, recall 0.46336700336700337, F1 0.3906335535199445, AUC 0.7306621773288441
  Second-Tier acc 0.3958333333333333, precision 0.49299620132953464, recall 0.44686868686868686, F1 0.3884316852737906, AUC 0.7672222222222222
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.5629746006808065, recall 0.5430629041740153, F1 0.44848924436080395, AUC 0.748499657064472
  Second-Tier acc 0.5102040816326531, precision 0.597340930674264, recall 0.5813492063492064, F1 0.5042586140147116, AUC 0.8023037918871253
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 8 idx: 0 First Loss : 3.9832775592803955, Second Loss : 4.052888870239258
epoch: 8 idx: 200 First Loss : 0.8980716342646258, Second Loss : 0.9362932851500995
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.5137098009533335, recall 0.4936700336700337, F1 0.413844600436536, AUC 0.7321548821548821
  Second-Tier acc 0.3958333333333333, precision 0.49299620132953464, recall 0.44686868686868686, F1 0.3884316852737906, AUC 0.7587878787878788
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5865800865800866, recall 0.5845825984714873, F1 0.47535142236813616, AUC 0.7498040368410739
  Second-Tier acc 0.4897959183673469, precision 0.582375478927203, recall 0.5511463844797179, F1 0.47176079734219273, AUC 0.7874228395061729
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 9 idx: 0 First Loss : 3.990778684616089, Second Loss : 4.043444633483887
epoch: 9 idx: 200 First Loss : 0.8918523424599245, Second Loss : 0.9319044729510545
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3888888888888889, precision 0.49650664863646604, recall 0.4631313131313132, F1 0.3884762532533281, AUC 0.7264085297418631
  Second-Tier acc 0.375, precision 0.4771672771672771, recall 0.4335353535353535, F1 0.3679095762429096, AUC 0.7467676767676767
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.583747927031509, recall 0.5823045267489712, F1 0.4619971826802602, AUC 0.7515738291201254
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7870370370370371
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 10 idx: 0 First Loss : 3.94197940826416, Second Loss : 3.9717559814453125
epoch: 10 idx: 200 First Loss : 0.886431432424683, Second Loss : 0.9273912934493737
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3680555555555556, precision 0.48164393962713287, recall 0.44269360269360264, F1 0.36507760957888835, AUC 0.7218294051627385
  Second-Tier acc 0.3958333333333333, precision 0.48914565826330536, recall 0.46383838383838377, F1 0.3883825944170772, AUC 0.7342424242424243
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.577059202059202, recall 0.5640064667842446, F1 0.4406462585034013, AUC 0.74628282382912
  Second-Tier acc 0.5102040816326531, precision 0.6052631578947368, recall 0.6106701940035273, F1 0.5042328042328043, AUC 0.7754629629629629
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 11 idx: 0 First Loss : 3.888707160949707, Second Loss : 3.8895821571350098
epoch: 11 idx: 200 First Loss : 0.8797757066270818, Second Loss : 0.9237819697692833
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.4722503373819163, recall 0.43909090909090914, F1 0.35566344970014696, AUC 0.7116778900112234
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7162626262626262
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41496598639455784, precision 0.5592331768388106, recall 0.5241769547325102, F1 0.41007801107244585, AUC 0.7405386537330982
  Second-Tier acc 0.4489795918367347, precision 0.5580246913580247, recall 0.5149911816578483, F1 0.4320587195641778, AUC 0.7755731922398589
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 12 idx: 0 First Loss : 3.8290226459503174, Second Loss : 3.906986951828003
epoch: 12 idx: 200 First Loss : 0.8776656867251662, Second Loss : 0.9222481259079974
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.46446949277137956, recall 0.44030303030303036, F1 0.3462717058222676, AUC 0.7014365881032548
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.42525252525252527, F1 0.3297491039426523, AUC 0.6964646464646465
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.5559179869524696, recall 0.5141093474426808, F1 0.40091463414634143, AUC 0.732945081324711
  Second-Tier acc 0.4897959183673469, precision 0.5972222222222222, recall 0.5983245149911817, F1 0.48408351194728905, AUC 0.7664792768959435
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 13 idx: 0 First Loss : 3.782160520553589, Second Loss : 3.812070369720459
epoch: 13 idx: 200 First Loss : 0.8742605219693595, Second Loss : 0.9210504935496887
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.4581801845952789, recall 0.43104377104377106, F1 0.3387810691181478, AUC 0.6847306397306397
  Second-Tier acc 0.3333333333333333, precision 0.4292282430213465, recall 0.41191919191919196, F1 0.3068376068376068, AUC 0.6840909090909092
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.5661696178937559, recall 0.5359347442680776, F1 0.4147918418839361, AUC 0.728835978835979
  Second-Tier acc 0.46938775510204084, precision 0.5780392156862745, recall 0.5566578483245149, F1 0.45862242332830566, AUC 0.7554012345679012
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 14 idx: 0 First Loss : 3.739593267440796, Second Loss : 3.7646522521972656
epoch: 14 idx: 200 First Loss : 0.871310719180434, Second Loss : 0.9191887943971547
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.45023809523809527, recall 0.4226262626262626, F1 0.3288125899427527, AUC 0.6719753086419753
  Second-Tier acc 0.3333333333333333, precision 0.4301587301587302, recall 0.41191919191919196, F1 0.3092117758784425, AUC 0.6706565656565656
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.5524475524475524, recall 0.5040417401528513, F1 0.39149455918276704, AUC 0.7221058690966098
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7485119047619048
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 15 idx: 0 First Loss : 3.713465452194214, Second Loss : 3.6942105293273926
epoch: 15 idx: 200 First Loss : 0.867872095701287, Second Loss : 0.9154851565293015
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3541666666666667, precision 0.45905923344947736, recall 0.4428282828282828, F1 0.3399539395631237, AUC 0.6756677890011223
  Second-Tier acc 0.3333333333333333, precision 0.4317901234567902, recall 0.41191919191919196, F1 0.3119465329991646, AUC 0.6657575757575758
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3945578231292517, precision 0.5515909793018227, recall 0.4977954144620811, F1 0.3794951895868704, AUC 0.7145429159318049
  Second-Tier acc 0.46938775510204084, precision 0.5856481481481481, recall 0.5681216931216931, F1 0.4552229613205223, AUC 0.7457010582010581
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 16 idx: 0 First Loss : 3.7042934894561768, Second Loss : 3.694732666015625
epoch: 16 idx: 200 First Loss : 0.8650013687827831, Second Loss : 0.913250580467026
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4353761198640717, recall 0.42070707070707075, F1 0.3138528138528139, AUC 0.6763411896745231
  Second-Tier acc 0.375, precision 0.45634920634920634, recall 0.45555555555555555, F1 0.34684312103666937, AUC 0.6736868686868686
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.5557889822595704, recall 0.5057319223985891, F1 0.3850691244239632, AUC 0.7134038800705467
  Second-Tier acc 0.3877551020408163, precision 0.5136476426799007, recall 0.43077601410934746, F1 0.345436507936508, AUC 0.7379298941798941
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 17 idx: 0 First Loss : 3.6794350147247314, Second Loss : 3.6285722255706787
epoch: 17 idx: 200 First Loss : 0.8618019582980703, Second Loss : 0.9093377598298833
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3333333333333333, precision 0.4353531379106827, recall 0.42070707070707075, F1 0.31277011537449734, AUC 0.6815151515151516
  Second-Tier acc 0.3958333333333333, precision 0.4691358024691357, recall 0.4688888888888889, F1 0.36926450742240213, AUC 0.6824747474747475
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3945578231292517, precision 0.541615716964213, recall 0.47611699000587887, F1 0.371195560852055, AUC 0.7082904663923183
  Second-Tier acc 0.3877551020408163, precision 0.5136476426799007, recall 0.43077601410934746, F1 0.345436507936508, AUC 0.7340718694885361
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 18 idx: 0 First Loss : 3.666898488998413, Second Loss : 3.5989022254943848
epoch: 18 idx: 200 First Loss : 0.8581996224070575, Second Loss : 0.9064955636537857
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.43195884575194926, recall 0.4215488215488216, F1 0.3090909090909091, AUC 0.6856285072951739
  Second-Tier acc 0.375, precision 0.45802469135802465, recall 0.45555555555555555, F1 0.3498920539101637, AUC 0.6893434343434343
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.5245421245421246, recall 0.440108759553204, F1 0.33709273182957394, AUC 0.7014684989222025
  Second-Tier acc 0.40816326530612246, precision 0.5380952380952381, recall 0.4724426807760141, F1 0.3768939393939394, AUC 0.7288910934744267
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6)
Current LR: 5.407014482835409e-05
epoch: 19 idx: 0 First Loss : 3.6549293994903564, Second Loss : 3.5809264183044434
epoch: 19 idx: 200 First Loss : 0.8556434978666977, Second Loss : 0.9040414604101147
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.4281356403307623, recall 0.42239057239057237, F1 0.3043853165804385, AUC 0.6847811447811448
  Second-Tier acc 0.375, precision 0.45634920634920634, recall 0.45555555555555555, F1 0.34684312103666937, AUC 0.6907070707070707
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.515780998389694, recall 0.42210464432686656, F1 0.31970898810613285, AUC 0.6971328140309622
  Second-Tier acc 0.40816326530612246, precision 0.5380952380952381, recall 0.4724426807760141, F1 0.3768939393939394, AUC 0.7318121693121693
Test AUC: 0.7858, Test F1: 0.5318 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.3256428481560258, "droprate_2": 0.0, "lr": 1.5677009693016808e-05, "weight_decay": 1.5963719569848784e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.5677009693016808e-05
epoch: 0 idx: 0 First Loss : 1.233679175376892, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0772298399488724, Second Loss : 1.0596798467102335
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6861167227833894
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748888888888889
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6244917205565356
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6238425925925926
Test AUC: 0.6238, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.5677009693016808e-05
epoch: 1 idx: 0 First Loss : 2.063176155090332, Second Loss : 2.0351827144622803
epoch: 1 idx: 200 First Loss : 1.1076796860688956, Second Loss : 1.0941667375872977
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7214814814814815
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7594444444444445
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6743765922006664
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.685626102292769
Test AUC: 0.6856, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.5677009693016808e-05
epoch: 2 idx: 0 First Loss : 2.1495819091796875, Second Loss : 2.128599166870117
epoch: 2 idx: 200 First Loss : 1.0912114803619053, Second Loss : 1.0779534914155504
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7350448933782268
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7642929292929294
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6984126984126985
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7052469135802468
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 3 idx: 0 First Loss : 2.2448081970214844, Second Loss : 2.217641592025757
epoch: 3 idx: 200 First Loss : 1.0730347109226446, Second Loss : 1.0598010778871936
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7401739618406286
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530808080808081
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7100480109739369
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7129629629629629
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 4 idx: 0 First Loss : 2.352733612060547, Second Loss : 2.3238754272460938
epoch: 4 idx: 200 First Loss : 1.0530020827010496, Second Loss : 1.0407426035522822
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5486111111111112, precision 0.5158150851581508, recall 0.3737373737373737, F1 0.30792112867584565, AUC 0.736010101010101
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7485858585858586
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.564625850340136, precision 0.5195402298850574, recall 0.3611111111111111, F1 0.29022010437939644, AUC 0.7098214285714285
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7134038800705467
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 5 idx: 0 First Loss : 2.4964439868927, Second Loss : 2.4559407234191895
epoch: 5 idx: 200 First Loss : 1.0321376383008056, Second Loss : 1.0203022168050357
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.6319444444444444, precision 0.6457431457431458, recall 0.5035016835016836, F1 0.5100071926697314, AUC 0.7356060606060607
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.754090909090909
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.6326530612244898, precision 0.6305555555555555, recall 0.5271898883009994, F1 0.47946379215035934, AUC 0.6964653145208701
  Second-Tier acc 0.5918367346938775, precision 0.5162162162162162, recall 0.43320105820105814, F1 0.42777777777777776, AUC 0.7053571428571428
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 6 idx: 0 First Loss : 2.6547510623931885, Second Loss : 2.6124367713928223
epoch: 6 idx: 200 First Loss : 1.0088796765909562, Second Loss : 0.9989181006725748
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5972222222222222, precision 0.5464743589743589, recall 0.5246127946127945, F1 0.5211640211640212, AUC 0.7306341189674522
  Second-Tier acc 0.6875, precision 0.7692307692307692, recall 0.6385858585858586, F1 0.584801662600524, AUC 0.7517676767676768
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5306122448979592, precision 0.4690085512799156, recall 0.5058054085831863, F1 0.46769067564427963, AUC 0.6998762982559278
  Second-Tier acc 0.6122448979591837, precision 0.5543133195307108, recall 0.5551146384479718, F1 0.5387545787545788, AUC 0.7152226631393298
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 7 idx: 0 First Loss : 2.8266451358795166, Second Loss : 2.793972969055176
epoch: 7 idx: 200 First Loss : 0.9875254400667564, Second Loss : 0.979507690045371
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5347222222222222, precision 0.5101227912548667, recall 0.5118181818181818, F1 0.48018940717447006, AUC 0.7300224466891133
  Second-Tier acc 0.5625, precision 0.5652056277056278, recall 0.584949494949495, F1 0.5438096500530223, AUC 0.7564141414141415
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4965986394557823, precision 0.46192435709284146, recall 0.5107289829512052, F1 0.449387548017685, AUC 0.7031954242602391
  Second-Tier acc 0.6326530612244898, precision 0.6301169590643275, recall 0.6911375661375662, F1 0.6373737373737373, AUC 0.7299382716049383
Test AUC: 0.7052, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.5677009693016808e-05
epoch: 8 idx: 0 First Loss : 2.994732618331909, Second Loss : 2.970763921737671
epoch: 8 idx: 200 First Loss : 0.9711083872290096, Second Loss : 0.9646826908733714
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4791666666666667, precision 0.5105454291500803, recall 0.49552188552188553, F1 0.4403424697140544, AUC 0.7351964085297419
  Second-Tier acc 0.5833333333333334, precision 0.6284271284271284, recall 0.6585858585858585, F1 0.583994708994709, AUC 0.7738383838383838
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.47154939419786457, recall 0.5248383303938859, F1 0.4253226489788666, AUC 0.7141448657652361
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7503858024691358
Test AUC: 0.7504, Test F1: 0.5841 (Best Epoch: 8)
Current LR: 1.5677009693016808e-05
epoch: 9 idx: 0 First Loss : 3.1444756984710693, Second Loss : 3.1257753372192383
epoch: 9 idx: 200 First Loss : 0.9587519609309103, Second Loss : 0.9536517442699837
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4583333333333333, precision 0.5172769360269361, recall 0.4878451178451179, F1 0.4292151600562815, AUC 0.7415207631874298
  Second-Tier acc 0.5, precision 0.5699148346207169, recall 0.5687878787878787, F1 0.5, AUC 0.7903030303030304
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.42857142857142855, precision 0.4766194766194767, recall 0.5163139329805997, F1 0.4124838246536518, AUC 0.7202319713893788
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7626763668430335
Test AUC: 0.7627, Test F1: 0.4984 (Best Epoch: 9)
Current LR: 1.5677009693016808e-05
epoch: 10 idx: 0 First Loss : 3.26932430267334, Second Loss : 3.255858898162842
epoch: 10 idx: 200 First Loss : 0.9494973614265151, Second Loss : 0.9460084288571011
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4375, precision 0.5012345679012346, recall 0.4793265993265993, F1 0.40852785558667915, AUC 0.7508080808080808
  Second-Tier acc 0.5, precision 0.574874686716792, recall 0.5857575757575758, F1 0.501010101010101, AUC 0.8014646464646464
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.4745335561125035, recall 0.5121987066431511, F1 0.40735042735042737, AUC 0.7262333431314913
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7678020282186949
Test AUC: 0.7678, Test F1: 0.4969 (Best Epoch: 10)
Current LR: 1.5677009693016808e-05
epoch: 11 idx: 0 First Loss : 3.3673934936523438, Second Loss : 3.3642141819000244
epoch: 11 idx: 200 First Loss : 0.9421766973448111, Second Loss : 0.940851552620419
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4166666666666667, precision 0.49379304095686843, recall 0.4611784511784512, F1 0.3900808080808081, AUC 0.7530808080808081
  Second-Tier acc 0.5, precision 0.574874686716792, recall 0.5882828282828282, F1 0.5009571521668296, AUC 0.8086868686868686
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.40816326530612246, precision 0.4942416814961555, recall 0.5077895355673133, F1 0.3987360116809955, AUC 0.73043430335097
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7765101410934744
Test AUC: 0.7765, Test F1: 0.4919 (Best Epoch: 11)
Current LR: 1.5677009693016808e-05
epoch: 12 idx: 0 First Loss : 3.449129819869995, Second Loss : 3.4410171508789062
epoch: 12 idx: 200 First Loss : 0.9361763742650437, Second Loss : 0.9362343258933344
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.4987789987789988, recall 0.4688888888888889, F1 0.39351851851851855, AUC 0.7553086419753087
  Second-Tier acc 0.4583333333333333, precision 0.5448849396217817, recall 0.5471717171717172, F1 0.45735581622678395, AUC 0.8127777777777778
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.5220015220700153, recall 0.5133009994121105, F1 0.40630367192446976, AUC 0.7343106995884773
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7858796296296297
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 13 idx: 0 First Loss : 3.5160372257232666, Second Loss : 3.50197696685791
epoch: 13 idx: 200 First Loss : 0.9310168561141067, Second Loss : 0.9324775817178523
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4097222222222222, precision 0.5032051282051282, recall 0.4858585858585858, F1 0.3981918156602178, AUC 0.7599551066217733
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8118181818181817
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.536605461393597, recall 0.5311581422692534, F1 0.42956009886702956, AUC 0.7402140897511269
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7851631393298059
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 14 idx: 0 First Loss : 3.5678632259368896, Second Loss : 3.549927234649658
epoch: 14 idx: 200 First Loss : 0.9260562405161634, Second Loss : 0.9287009376300434
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.507627765064836, recall 0.48838383838383836, F1 0.40488137907492744, AUC 0.7629741863075196
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8072222222222223
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5572062841530054, recall 0.5429159318048207, F1 0.4376223469787255, AUC 0.7423574368018812
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7924382716049383
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 15 idx: 0 First Loss : 3.6016921997070312, Second Loss : 3.5816783905029297
epoch: 15 idx: 200 First Loss : 0.921170178719736, Second Loss : 0.9251578258262456
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4236111111111111, precision 0.5210375816993463, recall 0.515084175084175, F1 0.4206159420289855, AUC 0.7634736251402918
  Second-Tier acc 0.4166666666666667, precision 0.5181623931623932, recall 0.5060606060606061, F1 0.41254618673973514, AUC 0.8026767676767678
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5642178910544727, recall 0.5505584950029395, F1 0.4387589714805363, AUC 0.7472810111699001
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7892967372134039
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 16 idx: 0 First Loss : 3.6210975646972656, Second Loss : 3.5977256298065186
epoch: 16 idx: 200 First Loss : 0.9166364712798181, Second Loss : 0.9216548455496832
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5291251885369532, recall 0.5293939393939394, F1 0.4272068511198946, AUC 0.763989898989899
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.8008585858585859
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4557823129251701, precision 0.5829162495829162, recall 0.5781893004115227, F1 0.4585263778367226, AUC 0.7533191260043112
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7937059082892416
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 17 idx: 0 First Loss : 3.6346523761749268, Second Loss : 3.603449583053589
epoch: 17 idx: 200 First Loss : 0.9123088851135539, Second Loss : 0.9184168091690196
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4375, precision 0.5360720660419456, recall 0.5468350168350168, F1 0.4297776156013704, AUC 0.7616442199775534
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.7945454545454546
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46258503401360546, precision 0.5873864697394109, recall 0.5801734273956497, F1 0.4636227824463119, AUC 0.7595287086027827
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7952491181657848
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 18 idx: 0 First Loss : 3.635981321334839, Second Loss : 3.598515748977661
epoch: 18 idx: 200 First Loss : 0.9084479774896342, Second Loss : 0.9157240055130785
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4097222222222222, precision 0.51010101010101, recall 0.5202693602693603, F1 0.3954576804423587, AUC 0.7591358024691358
  Second-Tier acc 0.3958333333333333, precision 0.4869664385793418, recall 0.48333333333333334, F1 0.3690865780627352, AUC 0.7918686868686868
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5893405600722673, recall 0.5723838918283363, F1 0.4683074198022888, AUC 0.7632091416813639
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7975639329805997
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12)
Current LR: 1.5677009693016808e-05
epoch: 19 idx: 0 First Loss : 3.626413583755493, Second Loss : 3.581765651702881
epoch: 19 idx: 200 First Loss : 0.9045650155975052, Second Loss : 0.9137202207281704
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4027777777777778, precision 0.5031835205992509, recall 0.5061952861952862, F1 0.38655929441089065, AUC 0.7554433221099889
  Second-Tier acc 0.375, precision 0.4590277777777778, recall 0.45555555555555555, F1 0.33867557798540543, AUC 0.7842424242424242
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46938775510204084, precision 0.5954545454545453, recall 0.580026455026455, F1 0.4663564781675018, AUC 0.7660016166960611
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7965167548500882
Test AUC: 0.7859, Test F1: 0.4919 (Best Epoch: 12){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.09773697439508125, "droprate_2": 0.0, "lr": 2.239471094578523e-05, "weight_decay": 8.038355922044954e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.239471094578523e-05
epoch: 0 idx: 0 First Loss : 1.1370123624801636, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0882494594920333, Second Loss : 1.0967019430143916
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7531593714927048
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7077777777777778
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6718413188320596
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6214175485008818
Test AUC: 0.6214, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.239471094578523e-05
epoch: 1 idx: 0 First Loss : 1.9447275400161743, Second Loss : 2.0651025772094727
epoch: 1 idx: 200 First Loss : 1.084623292903995, Second Loss : 1.0904597617796998
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7572951739618405
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7412121212121212
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002498530276308
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6791225749559083
Test AUC: 0.6791, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.239471094578523e-05
epoch: 2 idx: 0 First Loss : 2.064488410949707, Second Loss : 2.203348398208618
epoch: 2 idx: 200 First Loss : 1.0562980950471774, Second Loss : 1.0639298329898967
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.750347923681257
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7491414141414142
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7166801391338429
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7056327160493826
Test AUC: 0.7056, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.239471094578523e-05
epoch: 3 idx: 0 First Loss : 2.194674253463745, Second Loss : 2.347048044204712
epoch: 3 idx: 200 First Loss : 1.029715533873335, Second Loss : 1.0386553611699028
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5902777777777778, precision 0.4014711575687186, recall 0.45131313131313133, F1 0.40291806958473625, AUC 0.747530864197531
  Second-Tier acc 0.5416666666666666, precision 0.5904761904761905, recall 0.378080808080808, F1 0.33357721197931905, AUC 0.7455050505050504
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5850340136054422, precision 0.32969766551856106, recall 0.373015873015873, F1 0.31176885130373505, AUC 0.716723006074858
  Second-Tier acc 0.6122448979591837, precision 0.45, recall 0.4583333333333333, F1 0.4166666666666667, AUC 0.7138999118165784
Test AUC: 0.7056, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 2.239471094578523e-05
epoch: 4 idx: 0 First Loss : 2.374666452407837, Second Loss : 2.539135694503784
epoch: 4 idx: 200 First Loss : 0.9997942571468021, Second Loss : 1.010117063437825
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6597222222222222, precision 0.6441038739889314, recall 0.5902356902356903, F1 0.5162371330953707, AUC 0.7545342312008979
  Second-Tier acc 0.6666666666666666, precision 0.6298576902025178, recall 0.5837373737373738, F1 0.595679012345679, AUC 0.7602525252525253
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5850340136054422, precision 0.5535535535535535, recall 0.5097736625514403, F1 0.5037739827113642, AUC 0.7234898589065256
  Second-Tier acc 0.5306122448979592, precision 0.4790476190476191, recall 0.5134479717813051, F1 0.4805749805749806, AUC 0.7221671075837742
Test AUC: 0.7222, Test F1: 0.4806 (Best Epoch: 4)
Current LR: 2.239471094578523e-05
epoch: 5 idx: 0 First Loss : 2.598583936691284, Second Loss : 2.8018364906311035
epoch: 5 idx: 200 First Loss : 0.9735478117728411, Second Loss : 0.9799783204992613
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.570440251572327, recall 0.5682154882154883, F1 0.5117076210826211, AUC 0.7663916947250281
  Second-Tier acc 0.5625, precision 0.5642857142857144, recall 0.5892929292929293, F1 0.5469477382520861, AUC 0.7590909090909091
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5782312925170068, precision 0.5822796161779212, recall 0.5621693121693122, F1 0.5515873015873015, AUC 0.7377216833235352
  Second-Tier acc 0.5714285714285714, precision 0.5569444444444445, recall 0.6197089947089948, F1 0.5545977011494253, AUC 0.7486772486772487
Test AUC: 0.7222, Test F1: 0.4806 (Best Epoch: 4)
Current LR: 2.239471094578523e-05
epoch: 6 idx: 0 First Loss : 2.8090102672576904, Second Loss : 3.039996385574341
epoch: 6 idx: 200 First Loss : 0.953641432545968, Second Loss : 0.9578176728862139
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5069444444444444, precision 0.5543214095845675, recall 0.5558922558922559, F1 0.49445391288231333, AUC 0.7769248035914703
  Second-Tier acc 0.5625, precision 0.6096542346542346, recall 0.6207070707070707, F1 0.5555555555555556, AUC 0.7704545454545455
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5374149659863946, precision 0.5609452736318408, recall 0.6118459729570841, F1 0.5411785705259433, AUC 0.7571832745443857
  Second-Tier acc 0.4897959183673469, precision 0.509181450357921, recall 0.5703262786596119, F1 0.4873812261695818, AUC 0.7541887125220459
Test AUC: 0.7542, Test F1: 0.4874 (Best Epoch: 6)
Current LR: 2.239471094578523e-05
epoch: 7 idx: 0 First Loss : 2.9779415130615234, Second Loss : 3.2302794456481934
epoch: 7 idx: 200 First Loss : 0.9413896641921048, Second Loss : 0.9440325843587295
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4930555555555556, precision 0.5618007662835248, recall 0.5606060606060607, F1 0.490990653271355, AUC 0.791638608305275
  Second-Tier acc 0.5208333333333334, precision 0.5858201058201058, recall 0.594040404040404, F1 0.5150609432962374, AUC 0.7890909090909091
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5374149659863946, precision 0.5730654761904762, recall 0.6411669606114051, F1 0.5435010482180295, AUC 0.7691431510875956
  Second-Tier acc 0.4897959183673469, precision 0.5302144249512671, recall 0.58179012345679, F1 0.4896130104463438, AUC 0.7569995590828924
Test AUC: 0.7570, Test F1: 0.4896 (Best Epoch: 7)
Current LR: 2.239471094578523e-05
epoch: 8 idx: 0 First Loss : 3.1147878170013428, Second Loss : 3.3709182739257812
epoch: 8 idx: 200 First Loss : 0.936037594823176, Second Loss : 0.9366808951883322
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4722222222222222, precision 0.5456494522691706, recall 0.5512457912457912, F1 0.4718070818070818, AUC 0.7984624017957351
  Second-Tier acc 0.5208333333333334, precision 0.5902777777777778, recall 0.611010101010101, F1 0.5179573512906847, AUC 0.805050505050505
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5374149659863946, precision 0.6028856201269994, recall 0.6547619047619048, F1 0.5418040049618997, AUC 0.770355673133451
  Second-Tier acc 0.46938775510204084, precision 0.5666666666666667, recall 0.5515873015873015, F1 0.4663865546218487, AUC 0.7706679894179894
Test AUC: 0.7707, Test F1: 0.4664 (Best Epoch: 8)
Current LR: 2.239471094578523e-05
epoch: 9 idx: 0 First Loss : 3.221281051635742, Second Loss : 3.481687307357788
epoch: 9 idx: 200 First Loss : 0.9311240294355139, Second Loss : 0.9319700310979762
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4513888888888889, precision 0.5438759065269944, recall 0.5427272727272728, F1 0.4500291065986371, AUC 0.7945959595959596
  Second-Tier acc 0.5416666666666666, precision 0.6082915622389305, recall 0.6438383838383839, F1 0.5434343434343435, AUC 0.8123232323232322
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5170068027210885, precision 0.5996471157403455, recall 0.6326425631981187, F1 0.5193996035117531, AUC 0.7720887223202038
  Second-Tier acc 0.5102040816326531, precision 0.5959079283887468, recall 0.5992063492063492, F1 0.5068468468468469, AUC 0.7735890652557319
Test AUC: 0.7736, Test F1: 0.5068 (Best Epoch: 9)
Current LR: 2.239471094578523e-05
epoch: 10 idx: 0 First Loss : 3.297875165939331, Second Loss : 3.5621750354766846
epoch: 10 idx: 200 First Loss : 0.9285539770498872, Second Loss : 0.9284502740587983
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4444444444444444, precision 0.5406432748538011, recall 0.5334680134680135, F1 0.4431660190230929, AUC 0.7877272727272727
  Second-Tier acc 0.4791666666666667, precision 0.5619047619047618, recall 0.5749494949494949, F1 0.4791666666666667, AUC 0.8119191919191918
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4897959183673469, precision 0.5984299516908212, recall 0.6123603762492652, F1 0.4915689961806467, AUC 0.7734420928865374
  Second-Tier acc 0.4897959183673469, precision 0.5893719806763285, recall 0.5868606701940036, F1 0.4864072864072864, AUC 0.7834545855379188
Test AUC: 0.7736, Test F1: 0.5068 (Best Epoch: 9)
Current LR: 2.239471094578523e-05
epoch: 11 idx: 0 First Loss : 3.3567326068878174, Second Loss : 3.616218328475952
epoch: 11 idx: 200 First Loss : 0.9256094561528359, Second Loss : 0.9251003111110286
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4444444444444444, precision 0.53888711139551, recall 0.5286531986531986, F1 0.4427480564459674, AUC 0.7804657687991021
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.8128787878787879
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4897959183673469, precision 0.5984299516908212, recall 0.6123603762492652, F1 0.4915689961806467, AUC 0.7751506466784245
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7808641975308642
Test AUC: 0.7809, Test F1: 0.4793 (Best Epoch: 11)
Current LR: 2.239471094578523e-05
epoch: 12 idx: 0 First Loss : 3.378485918045044, Second Loss : 3.6363792419433594
epoch: 12 idx: 200 First Loss : 0.9226069389610778, Second Loss : 0.9220401109775427
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3958333333333333, precision 0.501170238975117, recall 0.47828282828282837, F1 0.38904862085086495, AUC 0.7709427609427609
  Second-Tier acc 0.3958333333333333, precision 0.48998778998778997, recall 0.46383838383838377, F1 0.38592759426092754, AUC 0.8099999999999999
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46938775510204084, precision 0.5846350832266325, recall 0.5804673721340388, F1 0.468683900131129, AUC 0.7745076425631982
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7798721340388006
Test AUC: 0.7809, Test F1: 0.4793 (Best Epoch: 11)
Current LR: 2.239471094578523e-05
epoch: 13 idx: 0 First Loss : 3.3743896484375, Second Loss : 3.6456706523895264
epoch: 13 idx: 200 First Loss : 0.9201432645844472, Second Loss : 0.9181184380023337
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.4935944813993594, recall 0.46902356902356906, F1 0.38071528751753153, AUC 0.7619191919191919
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.8014646464646464
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.47619047619047616, precision 0.5875077303648732, recall 0.5764991181657848, F1 0.47177775219676904, AUC 0.7710966588281402
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.783123897707231
Test AUC: 0.7809, Test F1: 0.4793 (Best Epoch: 11)
Current LR: 2.239471094578523e-05
epoch: 14 idx: 0 First Loss : 3.3652753829956055, Second Loss : 3.638263463973999
epoch: 14 idx: 200 First Loss : 0.9176121891432196, Second Loss : 0.9153513778406497
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3819444444444444, precision 0.4833605825535418, recall 0.4671043771043771, F1 0.36448280069092615, AUC 0.7550112233445567
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7781818181818183
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.47619047619047616, precision 0.5884751773049646, recall 0.5743680188124632, F1 0.4680402928309455, AUC 0.7680531060160689
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7822971781305115
Test AUC: 0.7809, Test F1: 0.4793 (Best Epoch: 11){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.006364299002794102, "droprate_2": 0.0, "lr": 9.681663561862372e-05, "weight_decay": 0.0003970750030438846, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.19071175688713143, "droprate_2": 0.0, "lr": 0.00018507474012978553, "weight_decay": 6.885462772196351e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.11944157105440975, "droprate_2": 0.0, "lr": 0.000535095599323517, "weight_decay": 0.0001312528340218214, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.1392436644788522, "droprate_2": 0.0, "lr": 0.00032804188041942747, "weight_decay": 2.5375574779176386e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.11108649298243249, "droprate_2": 0.0, "lr": 1.0530071831726938e-05, "weight_decay": 1.0646556575416159e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.085839033126831, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0617361021279104, Second Loss : 1.0555733823361089
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7097664141414141
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6864646464646466
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6088135196208113
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6121031746031745
epoch: 1 idx: 0 First Loss : 1.8115108013153076, Second Loss : 1.857545018196106
epoch: 1 idx: 200 First Loss : 1.1011743228233868, Second Loss : 1.0970417932046586
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7233459595959596
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7134343434343435
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6483376047178131
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6397156084656085
epoch: 2 idx: 0 First Loss : 1.9781184196472168, Second Loss : 2.0144994258880615
epoch: 2 idx: 200 First Loss : 1.0928297159980185, Second Loss : 1.0912083159780028
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7394002525252525
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7288888888888888
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6741553681657848
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6723985890652558
epoch: 3 idx: 0 First Loss : 2.0302085876464844, Second Loss : 2.068678855895996
epoch: 3 idx: 200 First Loss : 1.0794611788952528, Second Loss : 1.0812012432374765
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445801767676766
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7482323232323232
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6920745149911817
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.689594356261023
epoch: 4 idx: 0 First Loss : 2.0918002128601074, Second Loss : 2.128480911254883
epoch: 4 idx: 200 First Loss : 1.0673921266895028, Second Loss : 1.0718824126530642
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7441729797979798
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7504545454545454
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7021053791887125
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7039792768959435
epoch: 5 idx: 0 First Loss : 2.171318769454956, Second Loss : 2.20302152633667
epoch: 5 idx: 200 First Loss : 1.0568006552422224, Second Loss : 1.0634335864761575
  First-Tier acc 0.5677083333333334, precision 0.4611111111111111, recall 0.40575757575757576, F1 0.3547619047619048, AUC 0.7408933080808081
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7484343434343433
  First-Tier acc 0.5510204081632653, precision 0.18652849740932642, recall 0.3333333333333333, F1 0.23920265780730898, AUC 0.7019124779541445
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6990189594356261
epoch: 6 idx: 0 First Loss : 2.2590456008911133, Second Loss : 2.290576696395874
epoch: 6 idx: 200 First Loss : 1.0421643580740958, Second Loss : 1.0506846699029653
  First-Tier acc 0.5989583333333334, precision 0.3979166666666667, recall 0.46393939393939393, F1 0.41282051282051285, AUC 0.7406218434343433
  Second-Tier acc 0.5833333333333334, precision 0.5617886178861788, recall 0.4386868686868686, F1 0.41504329004329005, AUC 0.7429797979797979
  First-Tier acc 0.5918367346938775, precision 0.6704761904761906, recall 0.3882826278659612, F1 0.342438707326191, AUC 0.6947475749559082
  Second-Tier acc 0.6326530612244898, precision 0.8666666666666667, recall 0.48214285714285715, F1 0.4762626262626262, AUC 0.7014991181657848
epoch: 7 idx: 0 First Loss : 2.3570940494537354, Second Loss : 2.3843233585357666
epoch: 7 idx: 200 First Loss : 1.02683610268938, Second Loss : 1.0362141051176768
  First-Tier acc 0.6666666666666666, precision 0.5969174503657263, recall 0.5745202020202019, F1 0.5027969348659004, AUC 0.7422727272727272
  Second-Tier acc 0.6666666666666666, precision 0.6174603174603175, recall 0.5573737373737374, F1 0.5499999999999999, AUC 0.750050505050505
  First-Tier acc 0.5867346938775511, precision 0.6373889268626111, recall 0.464836860670194, F1 0.4771462067922245, AUC 0.6891052138447972
  Second-Tier acc 0.6530612244897959, precision 0.6305555555555555, recall 0.576058201058201, F1 0.5675647451963242, AUC 0.689484126984127
epoch: 8 idx: 0 First Loss : 2.4611122608184814, Second Loss : 2.4854865074157715
epoch: 8 idx: 200 First Loss : 1.0121187679284247, Second Loss : 1.0207257578103104
  First-Tier acc 0.640625, precision 0.5803571428571429, recall 0.5771717171717171, F1 0.5155218886513616, AUC 0.7417297979797978
  Second-Tier acc 0.6875, precision 0.6316614420062696, recall 0.6165656565656565, F1 0.6170594837261504, AUC 0.7474747474747474
  First-Tier acc 0.5663265306122449, precision 0.5270590052517763, recall 0.4840167548500882, F1 0.4795225358174999, AUC 0.6886884093915344
  Second-Tier acc 0.5510204081632653, precision 0.5083527583527584, recall 0.5372574955908289, F1 0.5174802026837777, AUC 0.6919642857142857
epoch: 9 idx: 0 First Loss : 2.5653886795043945, Second Loss : 2.5947000980377197
epoch: 9 idx: 200 First Loss : 0.998701034178633, Second Loss : 1.0057163382347543
  First-Tier acc 0.59375, precision 0.5676532769556025, recall 0.569469696969697, F1 0.5217874324257303, AUC 0.746628787878788
  Second-Tier acc 0.6666666666666666, precision 0.6185185185185186, recall 0.6126262626262626, F1 0.6116150163769212, AUC 0.7547979797979799
  First-Tier acc 0.5612244897959183, precision 0.533891323072314, recall 0.5070546737213404, F1 0.49776910931550106, AUC 0.6923535328483245
  Second-Tier acc 0.5714285714285714, precision 0.5397727272727273, recall 0.5725308641975309, F1 0.5486812268767155, AUC 0.6973104056437389{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.03950509284897717, "droprate_2": 0.0, "lr": 1.809030277507614e-05, "weight_decay": 0.0003422723537099712, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 18, "gamma": 0.56910055012341, "T_max": 20, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0886099338531494, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0872422692491048, Second Loss : 1.0802925074871499
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7177525252525253
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7054545454545454
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6349654155643739
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6304563492063492
epoch: 1 idx: 0 First Loss : 1.9630483388900757, Second Loss : 1.9819152355194092
epoch: 1 idx: 200 First Loss : 1.0978910346232837, Second Loss : 1.093845797118856
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7384501262626263
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7294444444444445
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6768663194444445
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.67554012345679
epoch: 2 idx: 0 First Loss : 2.066534996032715, Second Loss : 2.069899797439575
epoch: 2 idx: 200 First Loss : 1.0755856512346078, Second Loss : 1.0749283478924292
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7438162878787878
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748030303030303
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6995976631393299
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6961529982363315
epoch: 3 idx: 0 First Loss : 2.1789939403533936, Second Loss : 2.176767110824585
epoch: 3 idx: 200 First Loss : 1.0536330767087083, Second Loss : 1.0555186585629757
  First-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7419665404040403
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.745909090909091
  First-Tier acc 0.5510204081632653, precision 0.18556701030927836, recall 0.3333333333333333, F1 0.23841059602649006, AUC 0.7055569334215166
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705136684303351
epoch: 4 idx: 0 First Loss : 2.317390203475952, Second Loss : 2.320476770401001
epoch: 4 idx: 200 First Loss : 1.0307154978315036, Second Loss : 1.0334908672752072
  First-Tier acc 0.6145833333333334, precision 0.624752266497997, recall 0.48540404040404045, F1 0.44806435394670685, AUC 0.7404198232323232
  Second-Tier acc 0.5833333333333334, precision 0.5333333333333333, recall 0.4336363636363636, F1 0.4085470085470086, AUC 0.7435858585858585
  First-Tier acc 0.6275510204081632, precision 0.638047138047138, recall 0.4624669312169312, F1 0.4642484886387326, AUC 0.6960875496031745
  Second-Tier acc 0.6326530612244898, precision 0.4315245478036176, recall 0.5, F1 0.44761904761904764, AUC 0.703042328042328
epoch: 5 idx: 0 First Loss : 2.4921932220458984, Second Loss : 2.4979634284973145
epoch: 5 idx: 200 First Loss : 1.0066675764337107, Second Loss : 1.0095056616029336
  First-Tier acc 0.6614583333333334, precision 0.6183818922305765, recall 0.6007070707070706, F1 0.5637531310830476, AUC 0.7403472222222223
  Second-Tier acc 0.6666666666666666, precision 0.6289419392867669, recall 0.5812121212121212, F1 0.5884676833696442, AUC 0.7468686868686868
  First-Tier acc 0.6173469387755102, precision 0.595607787274454, recall 0.5824514991181657, F1 0.5866592488245539, AUC 0.6918092757936508
  Second-Tier acc 0.5306122448979592, precision 0.4794871794871795, recall 0.5134479717813051, F1 0.4836777478286913, AUC 0.6964836860670194
epoch: 6 idx: 0 First Loss : 2.685114860534668, Second Loss : 2.6926002502441406
epoch: 6 idx: 200 First Loss : 0.9858453969902067, Second Loss : 0.986382088832446
  First-Tier acc 0.6197916666666666, precision 0.5961179741667547, recall 0.6150252525252525, F1 0.5818696828797839, AUC 0.7468592171717171
  Second-Tier acc 0.625, precision 0.6103174603174603, recall 0.5978787878787879, F1 0.582024959742351, AUC 0.7578787878787878
  First-Tier acc 0.576530612244898, precision 0.5577838827838828, recall 0.6046075837742505, F1 0.5658218125960062, AUC 0.6988363921957671
  Second-Tier acc 0.5306122448979592, precision 0.49328449328449325, recall 0.5249118165784833, F1 0.49060654857756303, AUC 0.7112544091710759
epoch: 7 idx: 0 First Loss : 2.8622477054595947, Second Loss : 2.878087282180786
epoch: 7 idx: 200 First Loss : 0.9707005034520555, Second Loss : 0.9682666797617182
  First-Tier acc 0.6041666666666666, precision 0.6115204678362572, recall 0.6447474747474748, F1 0.5975606909430439, AUC 0.7548516414141414
  Second-Tier acc 0.5208333333333334, precision 0.5341880341880342, recall 0.5431313131313131, F1 0.48596491228070177, AUC 0.7646464646464647
  First-Tier acc 0.5459183673469388, precision 0.5493104345563362, recall 0.6052138447971781, F1 0.5408099100798591, AUC 0.7099833278218695
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.730379188712522
epoch: 8 idx: 0 First Loss : 3.016300916671753, Second Loss : 3.040985584259033
epoch: 8 idx: 200 First Loss : 0.9605616500128561, Second Loss : 0.9555016181603149
  First-Tier acc 0.5364583333333334, precision 0.5753595661808222, recall 0.596540404040404, F1 0.5358403038752172, AUC 0.7633996212121213
  Second-Tier acc 0.5208333333333334, precision 0.5608080808080808, recall 0.5601010101010101, F1 0.49932541236889066, AUC 0.7675252525252526
  First-Tier acc 0.5153061224489796, precision 0.5311293284301613, recall 0.595623897707231, F1 0.5138253819118209, AUC 0.7203104332010583
  Second-Tier acc 0.4897959183673469, precision 0.49523809523809526, recall 0.5767195767195767, F1 0.4761904761904761, AUC 0.7299933862433864
epoch: 9 idx: 0 First Loss : 3.1344785690307617, Second Loss : 3.173577308654785
epoch: 9 idx: 200 First Loss : 0.9537940881034331, Second Loss : 0.9460127660031639
  First-Tier acc 0.5104166666666666, precision 0.5707377417903734, recall 0.5828535353535353, F1 0.5118793062485151, AUC 0.7706313131313131
  Second-Tier acc 0.5208333333333334, precision 0.5718253968253968, recall 0.577070707070707, F1 0.5084656084656084, AUC 0.7813636363636364
  First-Tier acc 0.4897959183673469, precision 0.5270326636786264, recall 0.58179012345679, F1 0.48888168307276586, AUC 0.7274236662257495
  Second-Tier acc 0.46938775510204084, precision 0.4841269841269842, recall 0.564373897707231, F1 0.46129200208258236, AUC 0.7379298941798941{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.2492251228977458, "droprate_2": 0.0, "lr": 0.000219339504260572, "weight_decay": 0.0003388098707338016, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1122286319732666, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0880911653833603, Second Loss : 1.0809896703234954
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7519949494949495
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7495454545454546
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7334724977954145
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7220568783068783
epoch: 1 idx: 0 First Loss : 1.5358985662460327, Second Loss : 1.7867268323898315
epoch: 1 idx: 200 First Loss : 0.9845810548138263, Second Loss : 0.9840506433847531
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7329103535353535
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7430303030303028
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7372719631834214
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7332451499118166
epoch: 2 idx: 0 First Loss : 2.197550058364868, Second Loss : 2.367932081222534
epoch: 2 idx: 200 First Loss : 0.9470299960146495, Second Loss : 0.9417663024580893
  First-Tier acc 0.6197916666666666, precision 0.3981902665688432, recall 0.506969696969697, F1 0.44353741496598637, AUC 0.7152304292929292
  Second-Tier acc 0.6875, precision 0.6785714285714285, recall 0.5851515151515151, F1 0.5948400412796698, AUC 0.7382828282828283
  First-Tier acc 0.5816326530612245, precision 0.3415071770334928, recall 0.40057319223985893, F1 0.36205128205128206, AUC 0.6947337962962964
  Second-Tier acc 0.673469387755102, precision 0.6556036556036556, recall 0.611331569664903, F1 0.6103641456582634, AUC 0.7137896825396824
epoch: 3 idx: 0 First Loss : 3.5409116744995117, Second Loss : 3.393911600112915
epoch: 3 idx: 200 First Loss : 0.9351027850200658, Second Loss : 0.9255922709902128
  First-Tier acc 0.4427083333333333, precision 0.37564102564102564, recall 0.4615151515151515, F1 0.3407704042715484, AUC 0.7262689393939393
  Second-Tier acc 0.6041666666666666, precision 0.5742424242424242, recall 0.5827272727272728, F1 0.545794249980935, AUC 0.7542424242424243
  First-Tier acc 0.46938775510204084, precision 0.36702868281815654, recall 0.4071869488536155, F1 0.3427086234103778, AUC 0.7013716655643739
  Second-Tier acc 0.5510204081632653, precision 0.5297619047619048, recall 0.578042328042328, F1 0.5416666666666666, AUC 0.7135692239858905
epoch: 4 idx: 0 First Loss : 4.317267417907715, Second Loss : 4.214503765106201
epoch: 4 idx: 200 First Loss : 0.930589909285344, Second Loss : 0.9259466571520217
  First-Tier acc 0.3854166666666667, precision 0.4161840411840412, recall 0.428459595959596, F1 0.30935320205202116, AUC 0.7433743686868688
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7890404040404041
  First-Tier acc 0.45918367346938777, precision 0.41640898783755925, recall 0.4210758377425044, F1 0.3396422089707026, AUC 0.7058566192680776
  Second-Tier acc 0.4897959183673469, precision 0.3891129032258065, recall 0.42239858906525574, F1 0.36451335055986217, AUC 0.7088293650793651
epoch: 5 idx: 0 First Loss : 4.105027198791504, Second Loss : 4.048238277435303
epoch: 5 idx: 200 First Loss : 0.9274898428030878, Second Loss : 0.915443269403846
  First-Tier acc 0.3697916666666667, precision 0.381989247311828, recall 0.42333333333333334, F1 0.28119542982587437, AUC 0.7115246212121212
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7358080808080808
  First-Tier acc 0.4489795918367347, precision 0.4202464202464203, recall 0.42063492063492064, F1 0.32834467120181404, AUC 0.6717509920634921
  Second-Tier acc 0.4897959183673469, precision 0.4069264069264069, recall 0.4338624338624338, F1 0.365334717176959, AUC 0.6712962962962963
epoch: 6 idx: 0 First Loss : 3.8954663276672363, Second Loss : 3.955239772796631
epoch: 6 idx: 200 First Loss : 0.9187300097358306, Second Loss : 0.9067305700143391
  First-Tier acc 0.3645833333333333, precision 0.3817158931082982, recall 0.42, F1 0.27854785478547855, AUC 0.6833680555555556
  Second-Tier acc 0.3958333333333333, precision 0.3953953953953954, recall 0.44, F1 0.309640522875817, AUC 0.7025252525252524
  First-Tier acc 0.4336734693877551, precision 0.4277039848197344, recall 0.4142416225749559, F1 0.31769129786618605, AUC 0.6549858079805997
  Second-Tier acc 0.4897959183673469, precision 0.4402852049910873, recall 0.4567901234567901, F1 0.36988304093567254, AUC 0.693617724867725
epoch: 7 idx: 0 First Loss : 3.9496774673461914, Second Loss : 4.276845455169678
epoch: 7 idx: 200 First Loss : 0.9211020883785523, Second Loss : 0.9130997428512988
  First-Tier acc 0.40625, precision 0.39348370927318294, recall 0.4466666666666667, F1 0.31239935587761675, AUC 0.6734785353535354
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6922727272727274
  First-Tier acc 0.46938775510204084, precision 0.41847041847041844, recall 0.43871252204585537, F1 0.34031746031746035, AUC 0.6760878251763668
  Second-Tier acc 0.4897959183673469, precision 0.42915642915642915, recall 0.4567901234567901, F1 0.35844513243894055, AUC 0.7159942680776016
epoch: 8 idx: 0 First Loss : 3.9395334720611572, Second Loss : 4.164247512817383
epoch: 8 idx: 200 First Loss : 0.9180595095691315, Second Loss : 0.903879301908046
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6691982323232323
  Second-Tier acc 0.375, precision 0.3881578947368421, recall 0.4266666666666667, F1 0.29107400535971967, AUC 0.6886868686868687
  First-Tier acc 0.4642857142857143, precision 0.4407407407407407, recall 0.441358024691358, F1 0.33487654320987653, AUC 0.67389701829806
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.7182539682539683
epoch: 9 idx: 0 First Loss : 3.645772933959961, Second Loss : 3.8737478256225586
epoch: 9 idx: 200 First Loss : 0.9057105236144652, Second Loss : 0.8941747997826619
  First-Tier acc 0.390625, precision 0.3886563542614498, recall 0.4366666666666667, F1 0.2990234015109637, AUC 0.6709280303030303
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6840909090909092
  First-Tier acc 0.4489795918367347, precision 0.42013888888888884, recall 0.4292328042328042, F1 0.32253086419753085, AUC 0.6724743716931217
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7162698412698413{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_17", "train_show_freq": 200, "droprate": 0.16446290979464173, "droprate_2": 0.0, "lr": 1.909647338666868e-05, "weight_decay": 6.415812905215921e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 7, "gamma": 0.5992537819144812, "T_max": 5, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_17", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0833470821380615, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0903908390903947, Second Loss : 1.0835903147559853
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7208333333333333
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.706060606060606
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6369219852292769
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6350859788359787
epoch: 1 idx: 0 First Loss : 1.9554088115692139, Second Loss : 1.9956464767456055
epoch: 1 idx: 200 First Loss : 1.0993848711400482, Second Loss : 1.0950976059359698
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7417171717171717
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7346969696969697
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6802558697089948
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.677799823633157
epoch: 2 idx: 0 First Loss : 2.045001268386841, Second Loss : 2.0822739601135254
epoch: 2 idx: 200 First Loss : 1.073234058731231, Second Loss : 1.0746436059030133
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7435290404040403
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7484343434343433
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7000248015873015
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6986882716049383
epoch: 3 idx: 0 First Loss : 2.15226411819458, Second Loss : 2.193434715270996
epoch: 3 idx: 200 First Loss : 1.0494874923012742, Second Loss : 1.0553233779188413
  First-Tier acc 0.5729166666666666, precision 0.45122410546139363, recall 0.41757575757575754, F1 0.37145362948459076, AUC 0.7396748737373736
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.747171717171717
  First-Tier acc 0.5714285714285714, precision 0.3158067158067158, recall 0.35714285714285715, F1 0.28553478342078004, AUC 0.6947579089506174
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6916335978835978
epoch: 4 idx: 0 First Loss : 2.2978978157043457, Second Loss : 2.346622943878174
epoch: 4 idx: 200 First Loss : 1.0252081760348966, Second Loss : 1.0324202216234966
  First-Tier acc 0.6666666666666666, precision 0.5980902777777778, recall 0.5823737373737374, F1 0.5160818713450293, AUC 0.740464015151515
  Second-Tier acc 0.6666666666666666, precision 0.6619047619047619, recall 0.5523232323232323, F1 0.5666666666666668, AUC 0.7513131313131313
  First-Tier acc 0.576530612244898, precision 0.5955988455988456, recall 0.45579805996472667, F1 0.4670634920634921, AUC 0.6826154651675486
  Second-Tier acc 0.5918367346938775, precision 0.528042328042328, recall 0.5275573192239859, F1 0.5028130097539866, AUC 0.6841380070546738
epoch: 5 idx: 0 First Loss : 2.474857807159424, Second Loss : 2.539449691772461
epoch: 5 idx: 200 First Loss : 1.0002925440075978, Second Loss : 1.0070944270536082
  First-Tier acc 0.609375, precision 0.5753402975625198, recall 0.5830808080808081, F1 0.539700646750847, AUC 0.7445107323232323
  Second-Tier acc 0.6875, precision 0.6507936507936508, recall 0.6089898989898991, F1 0.6130794843336463, AUC 0.7556060606060605
  First-Tier acc 0.6071428571428571, precision 0.5956046641530514, recall 0.6024029982363316, F1 0.592015753669889, AUC 0.691616374559083
  Second-Tier acc 0.5102040816326531, precision 0.4624819624819625, recall 0.5011022927689593, F1 0.46733214497920383, AUC 0.6962632275132274
epoch: 6 idx: 0 First Loss : 2.665428638458252, Second Loss : 2.743678092956543
epoch: 6 idx: 200 First Loss : 0.9785503299897583, Second Loss : 0.9832219170285991
  First-Tier acc 0.578125, precision 0.571682665160926, recall 0.588989898989899, F1 0.5452853191500088, AUC 0.7558207070707069
  Second-Tier acc 0.5625, precision 0.5335714285714285, recall 0.5528282828282829, F1 0.4999145486950365, AUC 0.7662626262626263
  First-Tier acc 0.5816326530612245, precision 0.5773182957393485, recall 0.6354166666666666, F1 0.582266900299238, AUC 0.7043719686948853
  Second-Tier acc 0.5306122448979592, precision 0.5038986354775828, recall 0.5720899470899471, F1 0.4994425863991081, AUC 0.7183090828924162
epoch: 7 idx: 0 First Loss : 2.834813117980957, Second Loss : 2.93609881401062
epoch: 7 idx: 200 First Loss : 0.964646248878976, Second Loss : 0.9674959089514331
  First-Tier acc 0.515625, precision 0.5663552660371324, recall 0.568939393939394, F1 0.5009250526572409, AUC 0.7629545454545456
  Second-Tier acc 0.5208333333333334, precision 0.5670054583098061, recall 0.5626262626262627, F1 0.508994708994709, AUC 0.7766161616161616
  First-Tier acc 0.5459183673469388, precision 0.5601606034609351, recall 0.6122134038800705, F1 0.550112739056081, AUC 0.7147231867283951
  Second-Tier acc 0.4897959183673469, precision 0.49523809523809526, recall 0.5767195767195767, F1 0.4761904761904761, AUC 0.7226080246913581
epoch: 8 idx: 0 First Loss : 2.825044870376587, Second Loss : 2.9265835285186768
epoch: 8 idx: 200 First Loss : 0.953995689897988, Second Loss : 0.9548100782419319
  First-Tier acc 0.4947916666666667, precision 0.5661357111211115, recall 0.5664393939393939, F1 0.4878041634463354, AUC 0.7682859848484848
  Second-Tier acc 0.5, precision 0.5560386473429951, recall 0.5492929292929293, F1 0.4901098901098901, AUC 0.7808080808080807
  First-Tier acc 0.5306122448979592, precision 0.5606349206349207, recall 0.6086860670194003, F1 0.532896154189721, AUC 0.7209821428571429
  Second-Tier acc 0.46938775510204084, precision 0.4939102564102564, recall 0.5758377425044091, F1 0.4682539682539682, AUC 0.7391975308641975
epoch: 9 idx: 0 First Loss : 2.9205503463745117, Second Loss : 3.031247138977051
epoch: 9 idx: 200 First Loss : 0.9505442289162928, Second Loss : 0.9493261129034692
  First-Tier acc 0.484375, precision 0.5569315946674437, recall 0.555530303030303, F1 0.4778254362421719, AUC 0.7733838383838384
  Second-Tier acc 0.5, precision 0.5560386473429951, recall 0.5492929292929293, F1 0.4901098901098901, AUC 0.7925757575757576
  First-Tier acc 0.5204081632653061, precision 0.5540413533834586, recall 0.6025132275132276, F1 0.5233126958648628, AUC 0.724530147707231
  Second-Tier acc 0.4897959183673469, precision 0.5156695156695157, recall 0.599647266313933, F1 0.4967948717948718, AUC 0.7414572310405644