{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.345320017601622, "droprate_2": 0.0, "lr": 0.00012142419970294637, "weight_decay": 3.508923639080806e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00012142419970294637
epoch: 0 idx: 0 First Loss : 0.8910598158836365, Second Loss : 1.1262527704238892
epoch: 0 idx: 200 First Loss : 1.091959375054089, Second Loss : 1.0873911531262137
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4933712121212121
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4909090909090909
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44718639770723106
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4530423280423281
 
 test auc: 0.4530423280423281, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.28419793917401714, "droprate_2": 0.0, "lr": 0.00017947476871317728, "weight_decay": 6.199963242095842e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00017947476871317728
epoch: 0 idx: 0 First Loss : 0.9188212752342224, Second Loss : 1.1262272596359253
epoch: 0 idx: 200 First Loss : 1.0745654413059575, Second Loss : 1.0668019097835864
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48979482323232326
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48419191919191923
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4637896825396825
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4685295414462081
 
 test auc: 0.4685295414462081, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00017947476871317728
epoch: 1 idx: 0 First Loss : 1.4565863609313965, Second Loss : 1.7168570756912231
epoch: 1 idx: 200 First Loss : 0.9844269959339454, Second Loss : 0.9869760029499803
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08465608465608465, recall 0.3333333333333333, F1 0.1350210970464135, AUC 0.4963983585858586
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5055555555555555
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4666177524250441
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46759259259259256
 
 test auc: 0.46759259259259256, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017947476871317728
epoch: 2 idx: 0 First Loss : 1.7082922458648682, Second Loss : 1.987015724182129
epoch: 2 idx: 200 First Loss : 0.9428742972031161, Second Loss : 0.9500262329530953
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.23958333333333334, precision 0.45152263374485596, recall 0.31176767676767675, F1 0.20466213151927437, AUC 0.4904135101010101
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.42676767676767674, F1 0.3, AUC 0.4907070707070707
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.32653061224489793, precision 0.32803030303030306, recall 0.44345238095238093, F1 0.3231653404067197, AUC 0.4768828538359789
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.47167107583774254
 
 test auc: 0.46759259259259256, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017947476871317728
epoch: 3 idx: 0 First Loss : 2.1187853813171387, Second Loss : 2.3771464824676514
epoch: 3 idx: 200 First Loss : 0.9197550737368527, Second Loss : 0.9194494761637787
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.28125, precision 0.363731396172927, recall 0.29058080808080805, F1 0.3069393992857425, AUC 0.5013604797979798
  Second-Tier acc 0.3333333333333333, precision 0.2518518518518518, recall 0.4696969696969697, F1 0.3251231527093596, AUC 0.4901010101010101
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3112244897959184, precision 0.37478902353454324, recall 0.42471340388007056, F1 0.32070990489529994, AUC 0.5045469576719577
  Second-Tier acc 0.30612244897959184, precision 0.20555555555555557, recall 0.24250440917107582, F1 0.21618903971845146, AUC 0.4900242504409171
 
 test auc: 0.46759259259259256, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 0.00017947476871317728
epoch: 4 idx: 0 First Loss : 2.2853853702545166, Second Loss : 2.7394638061523438
epoch: 4 idx: 200 First Loss : 0.9052383930454799, Second Loss : 0.8981387292901378
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3541666666666667, precision 0.3594119984904198, recall 0.42164141414141415, F1 0.32999321819197597, AUC 0.5055366161616162
  Second-Tier acc 0.3125, precision 0.5069444444444444, recall 0.413030303030303, F1 0.2834129134942143, AUC 0.546060606060606
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.32653061224489793, precision 0.2926209168937884, recall 0.29056437389770723, F1 0.29139693290636687, AUC 0.5071821263227513
  Second-Tier acc 0.30612244897959184, precision 0.18596491228070175, recall 0.21957671957671956, F1 0.20095693779904308, AUC 0.4733796296296297
 
 test auc: 0.4733796296296297, test F1: 0.20095693779904308  :  from epoch 4
 current learn rate 0.00017947476871317728
epoch: 5 idx: 0 First Loss : 2.4591033458709717, Second Loss : 2.9826161861419678
epoch: 5 idx: 200 First Loss : 0.8952981885244597, Second Loss : 0.882982847693177
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.359375, precision 0.36692657569850556, recall 0.4285858585858586, F1 0.33892204224685046, AUC 0.5098611111111112
  Second-Tier acc 0.2708333333333333, precision 0.1574074074074074, recall 0.3888888888888889, F1 0.2115839243498818, AUC 0.5637878787878788
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.33163265306122447, precision 0.30679771908763503, recall 0.30831128747795417, F1 0.3068353437285476, AUC 0.5121286651234568
  Second-Tier acc 0.30612244897959184, precision 0.18145161290322584, recall 0.20811287477954143, F1 0.19386973180076628, AUC 0.464891975308642
 
 test auc: 0.464891975308642, test F1: 0.19386973180076628  :  from epoch 5
 current learn rate 0.00017947476871317728
epoch: 6 idx: 0 First Loss : 2.7007603645324707, Second Loss : 3.2429466247558594
epoch: 6 idx: 200 First Loss : 0.897963567345, Second Loss : 0.8745299946627955
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2760416666666667, precision 0.3789895600298285, recall 0.3886111111111111, F1 0.21796146992333923, AUC 0.5486616161616161
  Second-Tier acc 0.25, precision 0.12982456140350876, recall 0.3611111111111111, F1 0.17996289424860853, AUC 0.5828787878787879
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.37244897959183676, precision 0.1993431855500821, recall 0.24537037037037038, F1 0.2183574879227053, AUC 0.49726149140211645
  Second-Tier acc 0.3469387755102041, precision 0.1915032679738562, recall 0.2328042328042328, F1 0.20991143772376106, AUC 0.458994708994709
 
 test auc: 0.458994708994709, test F1: 0.20991143772376106  :  from epoch 6
 current learn rate 0.00017947476871317728
epoch: 7 idx: 0 First Loss : 2.587216377258301, Second Loss : 3.1891655921936035
epoch: 7 idx: 200 First Loss : 0.8906899210325077, Second Loss : 0.8644048113362002
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.265625, precision 0.1526975703657458, recall 0.3819444444444444, F1 0.20326823435631725, AUC 0.5615498737373738
  Second-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.6105050505050506
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.37244897959183676, precision 0.19764957264957264, recall 0.24537037037037038, F1 0.2178130511463845, AUC 0.49787119708994715
  Second-Tier acc 0.40816326530612246, precision 0.21771771771771772, recall 0.2698412698412698, F1 0.2387820512820513, AUC 0.4861662257495591
 
 test auc: 0.4861662257495591, test F1: 0.2387820512820513  :  from epoch 7
 current learn rate 0.00017947476871317728
epoch: 8 idx: 0 First Loss : 2.609591007232666, Second Loss : 3.18774676322937
epoch: 8 idx: 200 First Loss : 0.8902172358864131, Second Loss : 0.8587762188184914
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2604166666666667, precision 0.14867770996803256, recall 0.375, F1 0.1944625086215391, AUC 0.5936363636363636
  Second-Tier acc 0.25, precision 0.13704994192799072, recall 0.3611111111111111, F1 0.1761133603238866, AUC 0.6416666666666667
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3826530612244898, precision 0.19691560759674423, recall 0.24867724867724864, F1 0.21782327830455972, AUC 0.47712053571428575
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4910714285714286
 
 test auc: 0.4910714285714286, test F1: 0.1932367149758454  :  from epoch 8
 current learn rate 0.00017947476871317728
epoch: 9 idx: 0 First Loss : 2.575714111328125, Second Loss : 3.0990641117095947
epoch: 9 idx: 200 First Loss : 0.886751109613708, Second Loss : 0.8505711400862875
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2604166666666667, precision 0.1505611161662117, recall 0.375, F1 0.19412975284221465, AUC 0.6257354797979798
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6639393939393939
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.39285714285714285, precision 0.1893162393162393, recall 0.24911816578483245, F1 0.21212121212121213, AUC 0.46580825617283955
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.48241843033509707
 
 test auc: 0.48241843033509707, test F1: 0.19999999999999998  :  from epoch 9
 current learn rate 0.00017947476871317728
epoch: 10 idx: 0 First Loss : 2.5410025119781494, Second Loss : 3.06099009513855
epoch: 10 idx: 200 First Loss : 0.8832667066984398, Second Loss : 0.8433274894290191
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2604166666666667, precision 0.1556134375208709, recall 0.375, F1 0.193722342286714, AUC 0.6411868686868688
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6605050505050505
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.413265306122449, precision 0.18140243902439024, recall 0.25573192239858905, F1 0.2087789661319073, AUC 0.45829888668430324
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.4711750440917107
 
 test auc: 0.48241843033509707, test F1: 0.19999999999999998  :  from epoch 9
 current learn rate 0.00017947476871317728
epoch: 11 idx: 0 First Loss : 2.5272738933563232, Second Loss : 3.0509512424468994
epoch: 11 idx: 200 First Loss : 0.8790029360917374, Second Loss : 0.8370980495200099
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2604166666666667, precision 0.1556134375208709, recall 0.375, F1 0.193722342286714, AUC 0.6455587121212121
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6646969696969697
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3979591836734694, precision 0.17639751552795033, recall 0.2464726631393298, F1 0.20300393534594277, AUC 0.447289737654321
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.46428571428571425
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 12 idx: 0 First Loss : 2.5444674491882324, Second Loss : 3.062910556793213
epoch: 12 idx: 200 First Loss : 0.876451251698213, Second Loss : 0.833838348930229
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2604166666666667, precision 0.1589450673436288, recall 0.375, F1 0.1936549762636719, AUC 0.6376988636363636
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6549999999999999
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.39285714285714285, precision 0.16618252239167272, recall 0.24052028218694887, F1 0.19506172839506175, AUC 0.4356536596119929
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.43904320987654316
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 13 idx: 0 First Loss : 2.4774060249328613, Second Loss : 2.983349084854126
epoch: 13 idx: 200 First Loss : 0.871191531983876, Second Loss : 0.8266229847520219
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.265625, precision 0.16458333333333333, recall 0.3819444444444444, F1 0.20212418300653598, AUC 0.6384122474747475
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6474242424242425
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.17315428636183353, recall 0.24029982363315697, F1 0.199105956264347, AUC 0.4207417052469136
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.41220238095238093
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 14 idx: 0 First Loss : 2.414476156234741, Second Loss : 2.9011800289154053
epoch: 14 idx: 200 First Loss : 0.8658635408428743, Second Loss : 0.8186809444132224
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2604166666666667, precision 0.15720164609053497, recall 0.375, F1 0.19367687328852376, AUC 0.6259627525252526
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6345959595959596
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.17366200310903843, recall 0.24029982363315697, F1 0.19964805631099022, AUC 0.4216373181216932
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.39770723104056444
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 15 idx: 0 First Loss : 2.3840670585632324, Second Loss : 2.9450385570526123
epoch: 15 idx: 200 First Loss : 0.8600359086754653, Second Loss : 0.8133268163574799
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2604166666666667, precision 0.16296296296296295, recall 0.375, F1 0.1936842105263158, AUC 0.617209595959596
  Second-Tier acc 0.2708333333333333, precision 0.501937984496124, recall 0.3744444444444444, F1 0.20311016144349478, AUC 0.6240909090909091
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.39285714285714285, precision 0.16618252239167272, recall 0.24052028218694887, F1 0.19506172839506175, AUC 0.41893325617283955
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.3988095238095237
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 16 idx: 0 First Loss : 2.3519649505615234, Second Loss : 2.9279396533966064
epoch: 16 idx: 200 First Loss : 0.8537347307428718, Second Loss : 0.8057082473643272
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2604166666666667, precision 0.16527649057769542, recall 0.375, F1 0.19373659373659372, AUC 0.6188794191919192
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.616919191919192
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41836734693877553, precision 0.17317089958015006, recall 0.255952380952381, F1 0.20420677361853834, AUC 0.4228946208112874
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.3914792768959436
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 17 idx: 0 First Loss : 2.2703747749328613, Second Loss : 2.9272239208221436
epoch: 17 idx: 200 First Loss : 0.8454797785487073, Second Loss : 0.799733614724967
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2604166666666667, precision 0.1556134375208709, recall 0.375, F1 0.193722342286714, AUC 0.5984185606060606
  Second-Tier acc 0.2708333333333333, precision 0.478319783197832, recall 0.3744444444444444, F1 0.20370370370370372, AUC 0.5871212121212122
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.39285714285714285, precision 0.16687370600414078, recall 0.24052028218694887, F1 0.19567792801993547, AUC 0.42909157297178124
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4052028218694885
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 18 idx: 0 First Loss : 2.363741159439087, Second Loss : 3.1844053268432617
epoch: 18 idx: 200 First Loss : 0.8516493585714793, Second Loss : 0.8010500080372231
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2604166666666667, precision 0.1706349206349206, recall 0.375, F1 0.19392033542976939, AUC 0.628415404040404
  Second-Tier acc 0.2708333333333333, precision 0.478319783197832, recall 0.3744444444444444, F1 0.20370370370370372, AUC 0.6123232323232323
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.17605376579735554, recall 0.2621252204585538, F1 0.20779145462717294, AUC 0.4260740465167549
  Second-Tier acc 0.40816326530612246, precision 0.225, recall 0.2762345679012346, F1 0.24033677765021047, AUC 0.41583994708994715
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11
 current learn rate 0.00017947476871317728
epoch: 19 idx: 0 First Loss : 2.3277206420898438, Second Loss : 3.0465962886810303
epoch: 19 idx: 200 First Loss : 0.8455334366267357, Second Loss : 0.7924415367289559
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.265625, precision 0.16831275720164607, recall 0.3819444444444444, F1 0.2022238818355323, AUC 0.6342897727272727
  Second-Tier acc 0.2708333333333333, precision 0.478319783197832, recall 0.3744444444444444, F1 0.20370370370370372, AUC 0.6282323232323231
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3979591836734694, precision 0.168944099378882, recall 0.24360670194003528, F1 0.19815624276590818, AUC 0.4274105764991181
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4157297178130512
 
 test auc: 0.46428571428571425, test F1: 0.19999999999999998  :  from epoch 11{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.30003032211935265, "droprate_2": 0.0, "lr": 2.6718192800609334e-05, "weight_decay": 0.0003670268286218047, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 2.6718192800609334e-05
epoch: 0 idx: 0 First Loss : 0.9145792126655579, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.086963470302411, Second Loss : 1.0839315071627869
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.50003367003367
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48156565656565653
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4488352439741328
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4574514991181658
 
 test auc: 0.4574514991181658, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 2.6718192800609334e-05
epoch: 1 idx: 0 First Loss : 1.8721426725387573, Second Loss : 2.042529344558716
epoch: 1 idx: 200 First Loss : 1.0563129501704553, Second Loss : 1.062167920802363
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4994219977553311
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4998989898989899
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45096634332745444
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4583333333333333
 
 test auc: 0.4583333333333333, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 2.6718192800609334e-05
epoch: 2 idx: 0 First Loss : 1.9072575569152832, Second Loss : 2.0943708419799805
epoch: 2 idx: 200 First Loss : 1.0318724810335766, Second Loss : 1.0365358496186745
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5041077441077441
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.501010101010101
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4576045953360768
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4597663139329806
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 3 idx: 0 First Loss : 1.9615119695663452, Second Loss : 2.1667020320892334
epoch: 3 idx: 200 First Loss : 1.0111040804368348, Second Loss : 1.0162934600862104
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.5036644219977554
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.49873737373737376
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46688834999020185
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4701829805996472
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 4 idx: 0 First Loss : 2.0224392414093018, Second Loss : 2.2591919898986816
epoch: 4 idx: 200 First Loss : 0.9899577807208791, Second Loss : 0.9978827348914906
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2986111111111111, precision 0.29319298245614034, recall 0.4082491582491583, F1 0.2822105430801083, AUC 0.49589225589225583
  Second-Tier acc 0.3125, precision 0.30952380952380953, recall 0.42676767676767674, F1 0.2926652142338417, AUC 0.49277777777777776
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2653061224489796, precision 0.0948905109489051, recall 0.30952380952380953, F1 0.14525139664804468, AUC 0.4779051538310797
  Second-Tier acc 0.2653061224489796, precision 0.09629629629629628, recall 0.30952380952380953, F1 0.14689265536723164, AUC 0.47503306878306883
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 5 idx: 0 First Loss : 2.0881786346435547, Second Loss : 2.3331151008605957
epoch: 5 idx: 200 First Loss : 0.9707367438730315, Second Loss : 0.9799969667819008
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3125, precision 0.2596822244289971, recall 0.4343434343434343, F1 0.30985915492957744, AUC 0.4826599326599326
  Second-Tier acc 0.3541666666666667, precision 0.2927170868347339, recall 0.494949494949495, F1 0.35594202898550725, AUC 0.4759595959595959
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.272108843537415, precision 0.38536982730531116, recall 0.31452087007642565, F1 0.2577485380116959, AUC 0.4951866549088771
  Second-Tier acc 0.2653061224489796, precision 0.3516081871345029, recall 0.33377425044091713, F1 0.2684648684648685, AUC 0.4854497354497355
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 6 idx: 0 First Loss : 2.155580759048462, Second Loss : 2.4068617820739746
epoch: 6 idx: 200 First Loss : 0.9527040199186672, Second Loss : 0.9634414209951809
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3125, precision 0.39065032058056787, recall 0.4306060606060606, F1 0.30831865798358726, AUC 0.4791301907968575
  Second-Tier acc 0.3125, precision 0.24470899470899474, recall 0.4419191919191919, F1 0.31321839080459773, AUC 0.466060606060606
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.2857142857142857, precision 0.3276350120612416, recall 0.2752057613168724, F1 0.28103358336481216, AUC 0.508506025867137
  Second-Tier acc 0.30612244897959184, precision 0.36296296296296293, recall 0.3304673721340388, F1 0.33203093203093204, AUC 0.5049603174603173
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 7 idx: 0 First Loss : 2.228626251220703, Second Loss : 2.4824211597442627
epoch: 7 idx: 200 First Loss : 0.9369791659030748, Second Loss : 0.9487498369976063
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3055555555555556, precision 0.35932857991681527, recall 0.40774410774410774, F1 0.29599430531288423, AUC 0.4860549943883277
  Second-Tier acc 0.3125, precision 0.3621212121212121, recall 0.39606060606060606, F1 0.31688804554079697, AUC 0.4597979797979798
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.2789115646258503, precision 0.2992547358744542, recall 0.24603174603174605, F1 0.2569168247722109, AUC 0.5189594356261024
  Second-Tier acc 0.32653061224489793, precision 0.38928571428571423, recall 0.37852733686067014, F1 0.37895136778115507, AUC 0.5254629629629629
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 8 idx: 0 First Loss : 2.299194097518921, Second Loss : 2.5611844062805176
epoch: 8 idx: 200 First Loss : 0.9227267074681337, Second Loss : 0.9357888614805183
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2916666666666667, precision 0.2970647773279352, recall 0.38441077441077437, F1 0.27435637756738673, AUC 0.492665544332211
  Second-Tier acc 0.3125, precision 0.33631713554987214, recall 0.3816161616161617, F1 0.3032556805376278, AUC 0.4680808080808081
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3129251700680272, precision 0.3127705627705628, recall 0.2763815402704291, F1 0.2865481968936809, AUC 0.526461150303743
  Second-Tier acc 0.3877551020408163, precision 0.4078947368421053, recall 0.47420634920634913, F1 0.42626811594202896, AUC 0.5459656084656085
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 9 idx: 0 First Loss : 2.3540995121002197, Second Loss : 2.627277374267578
epoch: 9 idx: 200 First Loss : 0.9094350331866029, Second Loss : 0.9248433327163333
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3055555555555556, precision 0.30104617604617606, recall 0.3893265993265993, F1 0.2815818632806134, AUC 0.5008417508417508
  Second-Tier acc 0.3333333333333333, precision 0.31604506604506605, recall 0.3974747474747475, F1 0.3097354497354497, AUC 0.48020202020202013
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.35374149659863946, precision 0.3341088374109838, recall 0.3265726043503821, F1 0.32995718050065875, AUC 0.5329830491867529
  Second-Tier acc 0.3877551020408163, precision 0.3962054457410495, recall 0.47420634920634913, F1 0.41717313386317595, AUC 0.550650352733686
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 10 idx: 0 First Loss : 2.4086315631866455, Second Loss : 2.6717023849487305
epoch: 10 idx: 200 First Loss : 0.8978179362023351, Second Loss : 0.914855088389928
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3263888888888889, precision 0.32166769146683066, recall 0.397003367003367, F1 0.2998773844700396, AUC 0.5087317620650954
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.4873232323232323
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3741496598639456, precision 0.3422190787441263, recall 0.3508230452674897, F1 0.34613821138211387, AUC 0.5406133646874388
  Second-Tier acc 0.4489795918367347, precision 0.42540792540792544, recall 0.5112433862433862, F1 0.4494605923177352, AUC 0.5588073192239859
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 11 idx: 0 First Loss : 2.4523258209228516, Second Loss : 2.7093796730041504
epoch: 11 idx: 200 First Loss : 0.8879118885900548, Second Loss : 0.9061928996399268
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3194444444444444, precision 0.30396825396825394, recall 0.3877441077441078, F1 0.2881858881858882, AUC 0.5128170594837261
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.4894949494949495
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3877551020408163, precision 0.34698620188816265, recall 0.3590534979423869, F1 0.3519675851355511, AUC 0.544281550068587
  Second-Tier acc 0.42857142857142855, precision 0.38825757575757575, recall 0.4874338624338624, F1 0.41104308390022676, AUC 0.5671296296296297
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 12 idx: 0 First Loss : 2.493664264678955, Second Loss : 2.7363181114196777
epoch: 12 idx: 200 First Loss : 0.8789189178867275, Second Loss : 0.8985216075656426
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3194444444444444, precision 0.30426014402437335, recall 0.3820875420875421, F1 0.28917259558574415, AUC 0.5147586980920315
  Second-Tier acc 0.3333333333333333, precision 0.3083052749719416, recall 0.3974747474747475, F1 0.29833421938685095, AUC 0.4896464646464646
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.31423149905123343, recall 0.34501763668430335, F1 0.3264895197227265, AUC 0.5484886341367824
  Second-Tier acc 0.4489795918367347, precision 0.40456741326306545, recall 0.49977954144620806, F1 0.4295652173913043, AUC 0.5734678130511464
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 13 idx: 0 First Loss : 2.528106689453125, Second Loss : 2.7639830112457275
epoch: 13 idx: 200 First Loss : 0.8705447419866252, Second Loss : 0.8915213127504682
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.3317698561601001, recall 0.39986531986531987, F1 0.3134377013759903, AUC 0.5186475869809203
  Second-Tier acc 0.375, precision 0.34472934472934474, recall 0.4241414141414141, F1 0.3347332294700716, AUC 0.4944949494949495
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.2887346297781342, recall 0.3291446208112874, F1 0.3054203464298767, AUC 0.5527202135998432
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5752865961199295
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 14 idx: 0 First Loss : 2.555499792098999, Second Loss : 2.7792959213256836
epoch: 14 idx: 200 First Loss : 0.8626258636810886, Second Loss : 0.8850201033148452
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3611111111111111, precision 0.340365682137834, recall 0.4087542087542088, F1 0.32663648368232406, AUC 0.5243434343434343
  Second-Tier acc 0.375, precision 0.337037037037037, recall 0.4241414141414141, F1 0.3365893365893366, AUC 0.4985858585858585
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.2916495621237, recall 0.333259847148736, F1 0.30873015873015874, AUC 0.5553657162453459
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5695546737213405
 
 test auc: 0.4597663139329806, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 2.6718192800609334e-05
epoch: 15 idx: 0 First Loss : 2.5757157802581787, Second Loss : 2.790921449661255
epoch: 15 idx: 200 First Loss : 0.8550513448073199, Second Loss : 0.8789979442120043
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.3402113135055402, recall 0.4030976430976431, F1 0.32584838533114396, AUC 0.5276711560044892
  Second-Tier acc 0.3958333333333333, precision 0.3537037037037037, recall 0.4374747474747474, F1 0.35555555555555557, AUC 0.5021212121212121
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.2631468677980306, recall 0.33127572016460904, F1 0.2908281797061614, AUC 0.5562904174015285
  Second-Tier acc 0.3877551020408163, precision 0.3125, recall 0.4398148148148148, F1 0.3513071895424837, AUC 0.5698302469135803
 
 test auc: 0.5698302469135803, test F1: 0.3513071895424837  :  from epoch 15
 current learn rate 2.6718192800609334e-05
epoch: 16 idx: 0 First Loss : 2.59629225730896, Second Loss : 2.8021485805511475
epoch: 16 idx: 200 First Loss : 0.8479785516311354, Second Loss : 0.8731700980118406
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.3402113135055402, recall 0.4030976430976431, F1 0.32584838533114396, AUC 0.5301627384960718
  Second-Tier acc 0.4166666666666667, precision 0.36946457326892107, recall 0.45080808080808077, F1 0.37416592653321495, AUC 0.5039393939393939
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3741496598639456, precision 0.2749546279491833, recall 0.353395061728395, F1 0.3064516129032258, AUC 0.559321722516167
  Second-Tier acc 0.3877551020408163, precision 0.30392156862745096, recall 0.4398148148148148, F1 0.3435294117647059, AUC 0.5708223104056437
 
 test auc: 0.5708223104056437, test F1: 0.3435294117647059  :  from epoch 16
 current learn rate 2.6718192800609334e-05
epoch: 17 idx: 0 First Loss : 2.6077029705047607, Second Loss : 2.806997776031494
epoch: 17 idx: 200 First Loss : 0.8412044713116107, Second Loss : 0.8680368034743625
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3680555555555556, precision 0.3435305435305435, recall 0.4018855218855219, F1 0.33133054684778823, AUC 0.5308641975308642
  Second-Tier acc 0.4375, precision 0.38267263427109977, recall 0.46414141414141413, F1 0.3881419234360411, AUC 0.5084343434343435
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3741496598639456, precision 0.26848175458498774, recall 0.353395061728395, F1 0.300998003992016, AUC 0.5598606212032138
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5716490299823633
 
 test auc: 0.5716490299823633, test F1: 0.36512820512820515  :  from epoch 17
 current learn rate 2.6718192800609334e-05
epoch: 18 idx: 0 First Loss : 2.6174380779266357, Second Loss : 2.8026793003082275
epoch: 18 idx: 200 First Loss : 0.8348255955581716, Second Loss : 0.8631141092396568
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3680555555555556, precision 0.3435305435305435, recall 0.4018855218855219, F1 0.33133054684778823, AUC 0.5311391694725028
  Second-Tier acc 0.4375, precision 0.38267263427109977, recall 0.46414141414141413, F1 0.3881419234360411, AUC 0.5093434343434343
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3741496598639456, precision 0.26848175458498774, recall 0.353395061728395, F1 0.300998003992016, AUC 0.5587460807368214
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5713183421516755
 
 test auc: 0.5713183421516755, test F1: 0.36512820512820515  :  from epoch 18
 current learn rate 2.6718192800609334e-05
epoch: 19 idx: 0 First Loss : 2.6254279613494873, Second Loss : 2.7970240116119385
epoch: 19 idx: 200 First Loss : 0.8287917498721561, Second Loss : 0.8580749106051316
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.33692185007974484, recall 0.3917845117845118, F1 0.3256039733564107, AUC 0.5305218855218855
  Second-Tier acc 0.3958333333333333, precision 0.34408939014202167, recall 0.4035353535353536, F1 0.35151515151515156, AUC 0.5054545454545454
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.38095238095238093, precision 0.27581699346405225, recall 0.36728395061728397, F1 0.3100888402093221, AUC 0.5600749559082893
  Second-Tier acc 0.40816326530612246, precision 0.322061191626409, recall 0.48148148148148145, F1 0.36512820512820515, AUC 0.5715939153439153
 
 test auc: 0.5713183421516755, test F1: 0.36512820512820515  :  from epoch 18{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.37907162000281797, "droprate_2": 0.0, "lr": 9.742594992024019e-05, "weight_decay": 1.1473370079778114e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 9.742594992024019e-05
epoch: 0 idx: 0 First Loss : 1.2227070331573486, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.111302789912295, Second Loss : 1.094540445958797
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7415432098765432
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7689393939393939
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6959386635312561
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6895392416225748
 
 test auc: 0.6895392416225748, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.742594992024019e-05
epoch: 1 idx: 0 First Loss : 1.971165657043457, Second Loss : 1.9230210781097412
epoch: 1 idx: 200 First Loss : 1.0171527558594793, Second Loss : 1.0108009133469407
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7429180695847362
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7588888888888888
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7094723691945916
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.70679012345679
 
 test auc: 0.6895392416225748, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 9.742594992024019e-05
epoch: 2 idx: 0 First Loss : 2.1946163177490234, Second Loss : 2.1140024662017822
epoch: 2 idx: 200 First Loss : 0.9749915885613926, Second Loss : 0.9723459523708666
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6388888888888888, precision 0.4076199585525267, recall 0.5333333333333333, F1 0.46185168219066525, AUC 0.7457744107744109
  Second-Tier acc 0.6875, precision 0.7737556561085973, recall 0.5902020202020202, F1 0.5446907141822396, AUC 0.773888888888889
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5986394557823129, precision 0.6272617227319063, recall 0.4606848912404468, F1 0.47384226331594753, AUC 0.7041752400548696
  Second-Tier acc 0.6122448979591837, precision 0.6225961538461539, recall 0.5271164021164021, F1 0.5521029504080351, AUC 0.7211750440917107
 
 test auc: 0.7211750440917107, test F1: 0.5521029504080351  :  from epoch 2
 current learn rate 9.742594992024019e-05
epoch: 3 idx: 0 First Loss : 2.4178178310394287, Second Loss : 2.3498730659484863
epoch: 3 idx: 200 First Loss : 0.9441144508286495, Second Loss : 0.9430197712719737
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5833333333333334, precision 0.5293706293706294, recall 0.5557912457912458, F1 0.4996381531335939, AUC 0.7616161616161615
  Second-Tier acc 0.6041666666666666, precision 0.5298754131706077, recall 0.5682828282828283, F1 0.5240740740740741, AUC 0.7767171717171717
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.493157679738562, recall 0.48508230452674894, F1 0.47125900919004365, AUC 0.7171516754850087
  Second-Tier acc 0.5510204081632653, precision 0.5007215007215007, recall 0.5066137566137566, F1 0.4887566137566138, AUC 0.7334104938271605
 
 test auc: 0.7334104938271605, test F1: 0.4887566137566138  :  from epoch 3
 current learn rate 9.742594992024019e-05
epoch: 4 idx: 0 First Loss : 2.659865617752075, Second Loss : 2.5923800468444824
epoch: 4 idx: 200 First Loss : 0.9193949817832726, Second Loss : 0.918245387481368
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5416666666666666, precision 0.5680947537926944, recall 0.5636700336700337, F1 0.5127749270028853, AUC 0.7689786756453424
  Second-Tier acc 0.5416666666666666, precision 0.5579365079365078, recall 0.5741414141414142, F1 0.5168165168165167, AUC 0.7877777777777778
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5238095238095238, precision 0.5247895100069013, recall 0.5411522633744855, F1 0.5103094874087241, AUC 0.7307772388790909
  Second-Tier acc 0.5510204081632653, precision 0.5578703703703703, recall 0.5652557319223986, F1 0.5338517291861665, AUC 0.7464175485008818
 
 test auc: 0.7464175485008818, test F1: 0.5338517291861665  :  from epoch 4
 current learn rate 9.742594992024019e-05
epoch: 5 idx: 0 First Loss : 2.943082571029663, Second Loss : 2.861168622970581
epoch: 5 idx: 200 First Loss : 0.906020565746139, Second Loss : 0.9005179932035172
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4791666666666667, precision 0.5314935064935065, recall 0.5284848484848484, F1 0.46288846075604, AUC 0.7668967452300786
  Second-Tier acc 0.5, precision 0.5398212898212899, recall 0.5619191919191919, F1 0.4904761904761905, AUC 0.796060606060606
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4897959183673469, precision 0.5195306485629066, recall 0.5243974132863022, F1 0.4801417536711654, AUC 0.7302628355869096
  Second-Tier acc 0.5102040816326531, precision 0.5341880341880342, recall 0.5698853615520282, F1 0.5087719298245613, AUC 0.7758487654320988
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 6 idx: 0 First Loss : 2.9879531860351562, Second Loss : 2.997382164001465
epoch: 6 idx: 200 First Loss : 0.8937144273873511, Second Loss : 0.8891821568970805
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.5163084421075288, recall 0.5037373737373737, F1 0.4388488099642373, AUC 0.7654264870931536
  Second-Tier acc 0.4583333333333333, precision 0.5082125603864734, recall 0.5182828282828283, F1 0.4523083307397033, AUC 0.7943939393939393
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.5436622669180808, recall 0.5436507936507936, F1 0.47387943785267517, AUC 0.734084117185969
  Second-Tier acc 0.5714285714285714, precision 0.6333333333333333, recall 0.6591710758377425, F1 0.5646195394479148, AUC 0.7765101410934744
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 7 idx: 0 First Loss : 3.028799057006836, Second Loss : 3.0652811527252197
epoch: 7 idx: 200 First Loss : 0.8898892343526159, Second Loss : 0.8786283461933038
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4166666666666667, precision 0.492121212121212, recall 0.47717171717171714, F1 0.4062004662004662, AUC 0.7572615039281706
  Second-Tier acc 0.4583333333333333, precision 0.5337301587301587, recall 0.5377777777777778, F1 0.4405594405594406, AUC 0.7833333333333333
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.48299319727891155, precision 0.576146076146076, recall 0.5512933568489125, F1 0.47226538414107777, AUC 0.7349047129139722
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.785108024691358
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 8 idx: 0 First Loss : 3.020390748977661, Second Loss : 3.0886404514312744
epoch: 8 idx: 200 First Loss : 0.8811432210686825, Second Loss : 0.8700050358377879
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.4764844209288654, recall 0.47033670033670033, F1 0.3816632928475034, AUC 0.7492255892255892
  Second-Tier acc 0.4375, precision 0.509012539184953, recall 0.51, F1 0.4117039964866052, AUC 0.7785353535353535
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.47619047619047616, precision 0.5793116348671904, recall 0.5548206937095826, F1 0.463931566785685, AUC 0.7334594846168919
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.798776455026455
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 9 idx: 0 First Loss : 3.0929043292999268, Second Loss : 3.1290111541748047
epoch: 9 idx: 200 First Loss : 0.8769445350157348, Second Loss : 0.8639490677805998
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.4773845044847755, recall 0.46468013468013464, F1 0.3826921255027604, AUC 0.7400897867564534
  Second-Tier acc 0.4375, precision 0.509012539184953, recall 0.51, F1 0.4117039964866052, AUC 0.7724242424242425
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4557823129251701, precision 0.5659645232815964, recall 0.5288800705467372, F1 0.4421252371916508, AUC 0.7311752890456594
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7971230158730158
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 10 idx: 0 First Loss : 3.0297152996063232, Second Loss : 3.0512192249298096
epoch: 10 idx: 200 First Loss : 0.8691054389346391, Second Loss : 0.8574959411325201
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4097222222222222, precision 0.4881907308377897, recall 0.4857239057239058, F1 0.38974833351590615, AUC 0.7276038159371493
  Second-Tier acc 0.3958333333333333, precision 0.4743716931216932, recall 0.4688888888888889, F1 0.35903469915097824, AUC 0.7378282828282828
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4557823129251701, precision 0.5634920634920634, recall 0.5229276895943563, F1 0.43836120306708537, AUC 0.7241573584166178
  Second-Tier acc 0.42857142857142855, precision 0.49621212121212127, recall 0.4261463844797178, F1 0.36426038500506586, AUC 0.7990520282186949
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 11 idx: 0 First Loss : 3.1300458908081055, Second Loss : 3.02207088470459
epoch: 11 idx: 200 First Loss : 0.8672879075223756, Second Loss : 0.849297217115417
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.4603437719337545, recall 0.4511111111111112, F1 0.3301445088721888, AUC 0.707648709315376
  Second-Tier acc 0.3541666666666667, precision 0.44858387799564275, recall 0.44222222222222224, F1 0.3153439153439153, AUC 0.7057070707070707
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.38095238095238093, precision 0.5156946420104315, recall 0.4287918871252205, F1 0.34611952056160505, AUC 0.6995823535175387
  Second-Tier acc 0.40816326530612246, precision 0.506006006006006, recall 0.42526455026455023, F1 0.33876580935404466, AUC 0.78125
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 12 idx: 0 First Loss : 3.0370349884033203, Second Loss : 2.9496986865997314
epoch: 12 idx: 200 First Loss : 0.8612321834218924, Second Loss : 0.8446416286201406
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.450385860094598, recall 0.44222222222222224, F1 0.3151697238034999, AUC 0.7001402918069585
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6783838383838384
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.38095238095238093, precision 0.49869281045751634, recall 0.4109347442680776, F1 0.3248456790123457, AUC 0.6824110817166372
  Second-Tier acc 0.42857142857142855, precision 0.5228070175438596, recall 0.4490740740740741, F1 0.35198135198135194, AUC 0.7548500881834214
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 13 idx: 0 First Loss : 3.019991874694824, Second Loss : 2.9671247005462646
epoch: 13 idx: 200 First Loss : 0.8562212783567589, Second Loss : 0.8433600445978797
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.4149249504389691, recall 0.4144444444444444, F1 0.2805145046524357, AUC 0.6909147025813692
  Second-Tier acc 0.3125, precision 0.4106837606837606, recall 0.40111111111111114, F1 0.2548478701825558, AUC 0.6680808080808082
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3741496598639456, precision 0.4984126984126984, recall 0.40681951793062904, F1 0.3173281188318782, AUC 0.6677199686458946
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.7278439153439153
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 14 idx: 0 First Loss : 2.958932876586914, Second Loss : 2.856353759765625
epoch: 14 idx: 200 First Loss : 0.853507275037486, Second Loss : 0.8370793436014496
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3263888888888889, precision 0.41190476190476183, recall 0.41, F1 0.27195744330575794, AUC 0.6885072951739618
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.6804545454545453
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.38095238095238093, precision 0.4950664950664951, recall 0.40498236331569665, F1 0.31418845315904137, AUC 0.6544250930825005
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.7002865961199295
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 15 idx: 0 First Loss : 2.8298885822296143, Second Loss : 2.779888153076172
epoch: 15 idx: 200 First Loss : 0.8490083280305577, Second Loss : 0.8323099505215934
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3194444444444444, precision 0.40550935550935546, recall 0.4055555555555555, F1 0.26424963924963923, AUC 0.6849438832772167
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.6723232323232322
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.4874474474474475, recall 0.38852145796590243, F1 0.2861038135060788, AUC 0.6480317950225357
  Second-Tier acc 0.3673469387755102, precision 0.45, recall 0.38271604938271603, F1 0.25886101154918356, AUC 0.6855709876543209
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 16 idx: 0 First Loss : 2.7208402156829834, Second Loss : 2.774839401245117
epoch: 16 idx: 200 First Loss : 0.8482257494510648, Second Loss : 0.8280059745009938
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2986111111111111, precision 0.3723845598845599, recall 0.3874074074074074, F1 0.23713145467250055, AUC 0.6801964085297417
  Second-Tier acc 0.2916666666666667, precision 0.38055555555555554, recall 0.3877777777777778, F1 0.23062558356676002, AUC 0.6643434343434343
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4819139194139194, recall 0.3723544973544974, F1 0.2668398268398268, AUC 0.645814961787184
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6678240740740741
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 17 idx: 0 First Loss : 2.6340863704681396, Second Loss : 2.7340822219848633
epoch: 17 idx: 200 First Loss : 0.8454930340785496, Second Loss : 0.823809453032839
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3055555555555556, precision 0.3824328520416085, recall 0.3918518518518519, F1 0.24389287299065288, AUC 0.6796913580246913
  Second-Tier acc 0.2708333333333333, precision 0.3116531165311653, recall 0.36000000000000004, F1 0.18864468864468864, AUC 0.6596464646464647
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.32653061224489793, precision 0.4809394145677332, recall 0.3682392710170488, F1 0.25906487857919536, AUC 0.6416140015677053
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6570216049382717
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 18 idx: 0 First Loss : 2.58581805229187, Second Loss : 2.703911066055298
epoch: 18 idx: 200 First Loss : 0.8387739378886543, Second Loss : 0.818280190526246
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.3835282651072125, recall 0.3918518518518519, F1 0.2433167392116489, AUC 0.6743097643097643
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6633333333333333
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.38095238095238093, precision 0.5, recall 0.40498236331569665, F1 0.3141788766788767, AUC 0.6376028806584363
  Second-Tier acc 0.3469387755102041, precision 0.4471544715447155, recall 0.3703703703703704, F1 0.23636363636363633, AUC 0.6472663139329806
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5
 current learn rate 9.742594992024019e-05
epoch: 19 idx: 0 First Loss : 2.626763343811035, Second Loss : 2.70395565032959
epoch: 19 idx: 200 First Loss : 0.8307754042597756, Second Loss : 0.8159445230773794
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3263888888888889, precision 0.40567846607669616, recall 0.40518518518518515, F1 0.2652148460367638, AUC 0.6720258136924803
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6592424242424242
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.49510945505356313, recall 0.3970458553791887, F1 0.30981807951988, AUC 0.6296296296296297
  Second-Tier acc 0.3469387755102041, precision 0.4471544715447155, recall 0.3703703703703704, F1 0.23636363636363633, AUC 0.6363536155202821
 
 test auc: 0.7758487654320988, test F1: 0.5087719298245613  :  from epoch 5{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.21149806320028977, "droprate_2": 0.0, "lr": 1.3122327417574968e-05, "weight_decay": 0.0001970347371926804, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.4185426816040093, "droprate_2": 0.0, "lr": 4.871768243378921e-05, "weight_decay": 6.087137147672917e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.3122327417574968e-05
epoch: 0 idx: 0 First Loss : 1.235066294670105, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.0580847537636164, Second Loss : 1.0470969057201747
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6799438832772168
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7018181818181818
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.5907003233392122
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6044973544973545
 
 test auc: 0.6044973544973545, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.3122327417574968e-05
epoch: 1 idx: 0 First Loss : 1.931645393371582, Second Loss : 1.9400594234466553
epoch: 1 idx: 200 First Loss : 1.0827281946566567, Second Loss : 1.0740943753452443
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7253759820426486
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7284848484848485
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6403647364295512
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6372354497354497
 
 test auc: 0.6372354497354497, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.3122327417574968e-05
epoch: 2 idx: 0 First Loss : 1.9741144180297852, Second Loss : 1.9709264039993286
epoch: 2 idx: 200 First Loss : 1.0681020087418864, Second Loss : 1.0593184556682311
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7409932659932661
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7397979797979798
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.669808201058201
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6625881834215167
 
 test auc: 0.6625881834215167, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3122327417574968e-05
epoch: 3 idx: 0 First Loss : 2.0195510387420654, Second Loss : 1.9846322536468506
epoch: 3 idx: 200 First Loss : 1.053938306979279, Second Loss : 1.0472164433542175
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748260381593715
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7437878787878788
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6883205957280031
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6857914462081128
 
 test auc: 0.6857914462081128, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.3122327417574968e-05
epoch: 4 idx: 0 First Loss : 2.0576515197753906, Second Loss : 1.9968847036361694
epoch: 4 idx: 200 First Loss : 1.041660695971541, Second Loss : 1.0362440338775294
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7540684624017957
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7520202020202019
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6966061630413481
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6929012345679011
 
 test auc: 0.6929012345679011, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.3122327417574968e-05
epoch: 5 idx: 0 First Loss : 2.1021597385406494, Second Loss : 2.0235378742218018
epoch: 5 idx: 200 First Loss : 1.0323394387219083, Second Loss : 1.027785385351869
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7549046015712682
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7542929292929292
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.702638154027043
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7078924162257496
 
 test auc: 0.7078924162257496, test F1: 0.23684210526315788  :  from epoch 5
 current learn rate 1.3122327417574968e-05
epoch: 6 idx: 0 First Loss : 2.1665468215942383, Second Loss : 2.0561623573303223
epoch: 6 idx: 200 First Loss : 1.0222917392627517, Second Loss : 1.0185572751867238
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7539113355780023
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7535858585858586
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7081986086615716
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7081679894179893
 
 test auc: 0.7078924162257496, test F1: 0.23684210526315788  :  from epoch 5
 current learn rate 1.3122327417574968e-05
epoch: 7 idx: 0 First Loss : 2.213984251022339, Second Loss : 2.0934948921203613
epoch: 7 idx: 200 First Loss : 1.0129436541404298, Second Loss : 1.0102967443454325
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5555555555555556, precision 0.513189448441247, recall 0.38383838383838387, F1 0.3213641580586981, AUC 0.750578002244669
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7547474747474747
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7149164707035077
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7127976190476191
 
 test auc: 0.7127976190476191, test F1: 0.24  :  from epoch 7
 current learn rate 1.3122327417574968e-05
epoch: 8 idx: 0 First Loss : 2.2558577060699463, Second Loss : 2.1233909130096436
epoch: 8 idx: 200 First Loss : 1.0032341966210907, Second Loss : 1.001244560180612
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5763888888888888, precision 0.44216089254257196, recall 0.4254545454545455, F1 0.3811734909244407, AUC 0.7502244668911335
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7521717171717172
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5578231292517006, precision 0.5221445221445221, recall 0.34722222222222227, F1 0.2677380952380952, AUC 0.7177456888105036
  Second-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.7132385361552028
 
 test auc: 0.7127976190476191, test F1: 0.24  :  from epoch 7
 current learn rate 1.3122327417574968e-05
epoch: 9 idx: 0 First Loss : 2.29547119140625, Second Loss : 2.155787467956543
epoch: 9 idx: 200 First Loss : 0.9941301608634232, Second Loss : 0.9928403185004026
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7517059483726151
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7564141414141415
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5918367346938775, precision 0.6737147595356551, recall 0.3869047619047619, F1 0.33955785242606945, AUC 0.7116340877914951
  Second-Tier acc 0.5918367346938775, precision 0.3378787878787879, recall 0.38095238095238093, F1 0.3236965653570546, AUC 0.720623897707231
 
 test auc: 0.720623897707231, test F1: 0.3236965653570546  :  from epoch 9
 current learn rate 1.3122327417574968e-05
epoch: 10 idx: 0 First Loss : 2.3369171619415283, Second Loss : 2.189624547958374
epoch: 10 idx: 200 First Loss : 0.9851451397905895, Second Loss : 0.9842228952480193
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.625, precision 0.40178571428571425, recall 0.5018181818181818, F1 0.4412998765939942, AUC 0.7521773288439956
  Second-Tier acc 0.6666666666666666, precision 0.4444444444444444, recall 0.5624242424242424, F1 0.4941791399382276, AUC 0.7635858585858585
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.6054421768707483, precision 0.5747863247863249, recall 0.4435626102292769, F1 0.4424242424242424, AUC 0.7094601214971584
  Second-Tier acc 0.5918367346938775, precision 0.34700854700854705, recall 0.4038800705467372, F1 0.3636363636363636, AUC 0.7195216049382717
 
 test auc: 0.7195216049382717, test F1: 0.3636363636363636  :  from epoch 10
 current learn rate 1.3122327417574968e-05
epoch: 11 idx: 0 First Loss : 2.3789422512054443, Second Loss : 2.221808433532715
epoch: 11 idx: 200 First Loss : 0.9761168287316365, Second Loss : 0.9757286331695111
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.6736111111111112, precision 0.43569496234554367, recall 0.5894949494949495, F1 0.5007751937984496, AUC 0.7502076318742986
  Second-Tier acc 0.7083333333333334, precision 0.4646464646464647, recall 0.623030303030303, F1 0.5322723253757736, AUC 0.7693434343434342
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5850340136054422, precision 0.6182539682539683, recall 0.45796590241034685, F1 0.4662853393087724, AUC 0.7086211542230062
  Second-Tier acc 0.5918367346938775, precision 0.6963946869070208, recall 0.46759259259259256, F1 0.4659910188275038, AUC 0.7196869488536155
 
 test auc: 0.7196869488536155, test F1: 0.4659910188275038  :  from epoch 11
 current learn rate 1.3122327417574968e-05
epoch: 12 idx: 0 First Loss : 2.4174444675445557, Second Loss : 2.2529966831207275
epoch: 12 idx: 200 First Loss : 0.9671013660691864, Second Loss : 0.9673659099794146
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.6666666666666666, precision 0.6483228511530398, recall 0.5946801346801347, F1 0.5211809480606742, AUC 0.7517227833894501
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7692929292929293
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5714285714285714, precision 0.5361842105263158, recall 0.4862580834803057, F1 0.48739864852396825, AUC 0.7128404859886341
  Second-Tier acc 0.5510204081632653, precision 0.5296969696969697, recall 0.4658289241622575, F1 0.45128205128205123, AUC 0.7321979717813051
 
 test auc: 0.7196869488536155, test F1: 0.4659910188275038  :  from epoch 11
 current learn rate 1.3122327417574968e-05
epoch: 13 idx: 0 First Loss : 2.4564003944396973, Second Loss : 2.2834699153900146
epoch: 13 idx: 200 First Loss : 0.9584385666310491, Second Loss : 0.9592576370903508
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.6319444444444444, precision 0.6008050330084228, recall 0.5820875420875421, F1 0.5219946646223931, AUC 0.7519023569023568
  Second-Tier acc 0.6666666666666666, precision 0.7592592592592592, recall 0.6108080808080808, F1 0.5355665839536807, AUC 0.7702525252525252
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5850340136054422, precision 0.541672432083391, recall 0.5097736625514403, F1 0.5024531024531025, AUC 0.7151185577111502
  Second-Tier acc 0.5714285714285714, precision 0.5063131313131313, recall 0.5011022927689593, F1 0.4712755915763434, AUC 0.736386684303351
 
 test auc: 0.736386684303351, test F1: 0.4712755915763434  :  from epoch 13
 current learn rate 1.3122327417574968e-05
epoch: 14 idx: 0 First Loss : 2.493528366088867, Second Loss : 2.3157222270965576
epoch: 14 idx: 200 First Loss : 0.9498244611852205, Second Loss : 0.9511982950182697
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.5972222222222222, precision 0.5194060419866872, recall 0.5655218855218855, F1 0.5027424884049204, AUC 0.7553535353535353
  Second-Tier acc 0.6666666666666666, precision 0.7612942612942613, recall 0.6108080808080808, F1 0.5341251885369532, AUC 0.7756565656565656
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5782312925170068, precision 0.5332406594478588, recall 0.5133009994121105, F1 0.4997924776571412, AUC 0.7175497256515776
  Second-Tier acc 0.5714285714285714, precision 0.5063131313131313, recall 0.5011022927689593, F1 0.4712755915763434, AUC 0.7380952380952381
 
 test auc: 0.7380952380952381, test F1: 0.4712755915763434  :  from epoch 14
 current learn rate 1.3122327417574968e-05
epoch: 15 idx: 0 First Loss : 2.5278842449188232, Second Loss : 2.3488430976867676
epoch: 15 idx: 200 First Loss : 0.941486514993568, Second Loss : 0.9435611258061668
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.5902777777777778, precision 0.5774991292232672, recall 0.5899663299663299, F1 0.5449102554365712, AUC 0.7579854096520764
  Second-Tier acc 0.6041666666666666, precision 0.5782828282828283, recall 0.5708080808080808, F1 0.4934143870314083, AUC 0.7831818181818182
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.5714285714285714, precision 0.5415694055399938, recall 0.5287330981775427, F1 0.516077441077441, AUC 0.718596903782089
  Second-Tier acc 0.5714285714285714, precision 0.49666666666666665, recall 0.5011022927689593, F1 0.47054009819967263, AUC 0.7395833333333334
 
 test auc: 0.7395833333333334, test F1: 0.47054009819967263  :  from epoch 15
 current learn rate 1.3122327417574968e-05
epoch: 16 idx: 0 First Loss : 2.5604703426361084, Second Loss : 2.378870725631714
epoch: 16 idx: 200 First Loss : 0.9334641672411368, Second Loss : 0.9364795946511463
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.5763888888888888, precision 0.5757451462947771, recall 0.5915488215488216, F1 0.5412652129817445, AUC 0.7587991021324353
  Second-Tier acc 0.5208333333333334, precision 0.51772030651341, recall 0.5174747474747475, F1 0.4387533875338754, AUC 0.7903535353535354
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.5578231292517006, precision 0.5418667817890742, recall 0.5302763080540858, F1 0.5150064524865569, AUC 0.723398001175779
  Second-Tier acc 0.5510204081632653, precision 0.49691358024691357, recall 0.4887566137566138, F1 0.45663956639566394, AUC 0.7479607583774252
 
 test auc: 0.7479607583774252, test F1: 0.45663956639566394  :  from epoch 16
 current learn rate 1.3122327417574968e-05
epoch: 17 idx: 0 First Loss : 2.5928099155426025, Second Loss : 2.4060020446777344
epoch: 17 idx: 200 First Loss : 0.9258943019777685, Second Loss : 0.9293319799043053
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.5833333333333334, precision 0.5927862829148806, recall 0.6064646464646465, F1 0.5529778357235985, AUC 0.7606397306397307
  Second-Tier acc 0.5, precision 0.5521367521367521, recall 0.5185858585858586, F1 0.45155931435475344, AUC 0.7950505050505049
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.54421768707483, precision 0.5347452715873768, recall 0.5220458553791887, F1 0.5038522082627936, AUC 0.7278561630413481
  Second-Tier acc 0.5510204081632653, precision 0.49691358024691357, recall 0.4887566137566138, F1 0.45663956639566394, AUC 0.7562279541446207
 
 test auc: 0.7562279541446207, test F1: 0.45663956639566394  :  from epoch 17
 current learn rate 1.3122327417574968e-05
epoch: 18 idx: 0 First Loss : 2.6175408363342285, Second Loss : 2.430123805999756
epoch: 18 idx: 200 First Loss : 0.9186617555791763, Second Loss : 0.9230182361765881
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.5763888888888888, precision 0.6022708054671525, recall 0.6116498316498317, F1 0.5560018556688923, AUC 0.7641077441077441
  Second-Tier acc 0.4791666666666667, precision 0.546415770609319, recall 0.5052525252525253, F1 0.43535972947737656, AUC 0.791111111111111
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.5170068027210885, precision 0.51497113997114, recall 0.5055849500293944, F1 0.4803916848168321, AUC 0.7286890064667843
  Second-Tier acc 0.5306122448979592, precision 0.4887955182072829, recall 0.47641093474426804, F1 0.44227994227994233, AUC 0.7605820105820106
 
 test auc: 0.7562279541446207, test F1: 0.45663956639566394  :  from epoch 17
 current learn rate 1.3122327417574968e-05
epoch: 19 idx: 0 First Loss : 2.6373889446258545, Second Loss : 2.4519166946411133
epoch: 19 idx: 200 First Loss : 0.9117038030900172, Second Loss : 0.9167886525392532
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.5347222222222222, precision 0.5758204288149842, recall 0.584983164983165, F1 0.5202590919405078, AUC 0.7648484848484848
  Second-Tier acc 0.4375, precision 0.5343434343434343, recall 0.4785858585858586, F1 0.4013750954927426, AUC 0.7932323232323233
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4965986394557823, precision 0.5060772560772561, recall 0.4991916519694297, F1 0.46913165266106444, AUC 0.7313222614148539
  Second-Tier acc 0.46938775510204084, precision 0.46351766513056836, recall 0.439373897707231, F1 0.39738030713640476, AUC 0.7601410934744268
 
 test auc: 0.7562279541446207, test F1: 0.45663956639566394  :  from epoch 17
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.871768243378921e-05
epoch: 0 idx: 0 First Loss : 1.2548803091049194, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.1217795734974876, Second Loss : 1.103417968127265
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7257968574635241
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7431818181818182
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6620676562806193
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6604387125220459
 
 test auc: 0.6604387125220459, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 4.871768243378921e-05
epoch: 1 idx: 0 First Loss : 2.170198917388916, Second Loss : 2.04221773147583
epoch: 1 idx: 200 First Loss : 1.0593452808720556, Second Loss : 1.046151931013041
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7449326599326599
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7565151515151515
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7020563883989811
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7028218694885361
 
 test auc: 0.7028218694885361, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.871768243378921e-05
epoch: 2 idx: 0 First Loss : 2.247040271759033, Second Loss : 2.106679916381836
epoch: 2 idx: 200 First Loss : 1.0211963751422826, Second Loss : 1.0117619246689242
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5555555555555556, precision 0.4657629475147724, recall 0.3894949494949495, F1 0.33270440251572325, AUC 0.7460998877665542
  Second-Tier acc 0.5625, precision 0.4318181818181818, recall 0.4109090909090909, F1 0.36521739130434777, AUC 0.7615656565656566
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7000783852635704
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7036485890652556
 
 test auc: 0.7036485890652556, test F1: 0.24  :  from epoch 2
 current learn rate 4.871768243378921e-05
epoch: 3 idx: 0 First Loss : 2.361010789871216, Second Loss : 2.2333734035491943
epoch: 3 idx: 200 First Loss : 0.9892837999027166, Second Loss : 0.9846314511340649
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6458333333333334, precision 0.4162528963919232, recall 0.5377777777777778, F1 0.4680828988664955, AUC 0.7481088664421999
  Second-Tier acc 0.7083333333333334, precision 0.4583333333333333, recall 0.623030303030303, F1 0.5276153346328785, AUC 0.7693939393939394
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.3132002801120448, recall 0.3712522045855379, F1 0.3348331969820926, AUC 0.6928951107191849
  Second-Tier acc 0.5714285714285714, precision 0.5187499999999999, recall 0.4437830687830688, F1 0.44188583674264564, AUC 0.7099867724867724
 
 test auc: 0.7099867724867724, test F1: 0.44188583674264564  :  from epoch 3
 current learn rate 4.871768243378921e-05
epoch: 4 idx: 0 First Loss : 2.500821352005005, Second Loss : 2.3807928562164307
epoch: 4 idx: 200 First Loss : 0.9602071894193763, Second Loss : 0.9627654216627577
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6180555555555556, precision 0.5686172788268659, recall 0.5635690235690236, F1 0.48732614902827676, AUC 0.7514253647586981
  Second-Tier acc 0.6666666666666666, precision 0.601364522417154, recall 0.6108080808080808, F1 0.539072039072039, AUC 0.7708585858585858
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5714285714285714, precision 0.5100193477059148, recall 0.48581716637272193, F1 0.4664495512782076, AUC 0.7061654908877131
  Second-Tier acc 0.5714285714285714, precision 0.48517786561264825, recall 0.5011022927689593, F1 0.47144082858368574, AUC 0.726741622574956
 
 test auc: 0.726741622574956, test F1: 0.47144082858368574  :  from epoch 4
 current learn rate 4.871768243378921e-05
epoch: 5 idx: 0 First Loss : 2.6135129928588867, Second Loss : 2.508002996444702
epoch: 5 idx: 200 First Loss : 0.9360896080954751, Second Loss : 0.940757311843521
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.5327990934110409, recall 0.5585858585858586, F1 0.496302974631148, AUC 0.759635241301908
  Second-Tier acc 0.5416666666666666, precision 0.5009077705156136, recall 0.5308080808080807, F1 0.4552005012531328, AUC 0.7829292929292929
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5374149659863946, precision 0.47458850803113095, recall 0.4728835978835979, F1 0.4450486394148366, AUC 0.7153512639623751
  Second-Tier acc 0.5510204081632653, precision 0.5266465560583208, recall 0.5180776014109347, F1 0.4906926406926407, AUC 0.7395282186948853
 
 test auc: 0.7395282186948853, test F1: 0.4906926406926407  :  from epoch 5
 current learn rate 4.871768243378921e-05
epoch: 6 idx: 0 First Loss : 2.6998512744903564, Second Loss : 2.609562635421753
epoch: 6 idx: 200 First Loss : 0.9153133852787279, Second Loss : 0.9225103169939115
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5837121212121212, recall 0.5746127946127947, F1 0.5148236285664708, AUC 0.7658922558922558
  Second-Tier acc 0.5, precision 0.5401234567901234, recall 0.5330303030303031, F1 0.46887488992752147, AUC 0.7947474747474748
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5034013605442177, precision 0.4840534979423869, recall 0.4718547912992357, F1 0.44376918852245, AUC 0.7219160297864002
  Second-Tier acc 0.5306122448979592, precision 0.545326278659612, recall 0.5350529100529101, F1 0.50267131242741, AUC 0.7559523809523809
 
 test auc: 0.7559523809523809, test F1: 0.50267131242741  :  from epoch 6
 current learn rate 4.871768243378921e-05
epoch: 7 idx: 0 First Loss : 2.7681491374969482, Second Loss : 2.6688733100891113
epoch: 7 idx: 200 First Loss : 0.8954925070984743, Second Loss : 0.9080906002527446
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5, precision 0.5489424364123159, recall 0.5483164983164983, F1 0.47855967895538276, AUC 0.7705892255892256
  Second-Tier acc 0.5, precision 0.5598204264870931, recall 0.5474747474747474, F1 0.48183590288853456, AUC 0.8068181818181818
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.4726708074534162, recall 0.4531158142269254, F1 0.4201450816537857, AUC 0.7327674897119341
  Second-Tier acc 0.4489795918367347, precision 0.47345679012345676, recall 0.47420634920634924, F1 0.4275588909735251, AUC 0.7615189594356261
 
 test auc: 0.7615189594356261, test F1: 0.4275588909735251  :  from epoch 7
 current learn rate 4.871768243378921e-05
epoch: 8 idx: 0 First Loss : 2.8384411334991455, Second Loss : 2.7361388206481934
epoch: 8 idx: 200 First Loss : 0.879212849018215, Second Loss : 0.8960143417601858
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5069444444444444, precision 0.5643004920113354, recall 0.5632323232323232, F1 0.4879203916560238, AUC 0.7702020202020202
  Second-Tier acc 0.4791666666666667, precision 0.5393162393162393, recall 0.5341414141414141, F1 0.4627198627198627, AUC 0.8096464646464646
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.4706257982120052, recall 0.4487066431510876, F1 0.4087822169217518, AUC 0.7409918185381148
  Second-Tier acc 0.4897959183673469, precision 0.5379310344827587, recall 0.5218253968253969, F1 0.45931978490118025, AUC 0.7717702821869489
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 9 idx: 0 First Loss : 2.8679091930389404, Second Loss : 2.8090455532073975
epoch: 9 idx: 200 First Loss : 0.8654453622001173, Second Loss : 0.8873267631736858
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4791666666666667, precision 0.5461798512508452, recall 0.5454545454545454, F1 0.4622594919205089, AUC 0.7726711560044892
  Second-Tier acc 0.4791666666666667, precision 0.5393162393162393, recall 0.5341414141414141, F1 0.4627198627198627, AUC 0.8032323232323231
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.5024901668613158, recall 0.46840094062316284, F1 0.41812602903756924, AUC 0.744378306878307
  Second-Tier acc 0.4897959183673469, precision 0.5621734587251829, recall 0.5218253968253969, F1 0.45797633618931055, AUC 0.7793209876543211
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 10 idx: 0 First Loss : 2.905500650405884, Second Loss : 2.8658509254455566
epoch: 10 idx: 200 First Loss : 0.8545159274406398, Second Loss : 0.8788346098782263
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4722222222222222, precision 0.5402367398572333, recall 0.541010101010101, F1 0.455533751351847, AUC 0.7687205387205388
  Second-Tier acc 0.4375, precision 0.5112388250319285, recall 0.493030303030303, F1 0.4144385026737967, AUC 0.7974747474747476
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5044152526911148, recall 0.4601704879482657, F1 0.406210276558208, AUC 0.7465828924162258
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7846671075837742
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 11 idx: 0 First Loss : 2.907639741897583, Second Loss : 2.8613474369049072
epoch: 11 idx: 200 First Loss : 0.8451887558802814, Second Loss : 0.8700387143664321
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4583333333333333, precision 0.5240241466957153, recall 0.5273063973063973, F1 0.4389608950925003, AUC 0.7663916947250279
  Second-Tier acc 0.4166666666666667, precision 0.4975182863113898, recall 0.4796969696969697, F1 0.39503732981993855, AUC 0.7962626262626262
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.5090582535743826, recall 0.4519400352733686, F1 0.39409673411659507, AUC 0.7513839898099158
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7873126102292769
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 12 idx: 0 First Loss : 2.890033721923828, Second Loss : 2.869136333465576
epoch: 12 idx: 200 First Loss : 0.8368123531508357, Second Loss : 0.8617972007707058
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4513888888888889, precision 0.5206656231365533, recall 0.5228619528619529, F1 0.4323293673905206, AUC 0.7602581369248037
  Second-Tier acc 0.4375, precision 0.513888888888889, recall 0.51, F1 0.41118502094111853, AUC 0.7881818181818181
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4421768707482993, precision 0.5276595744680851, recall 0.4636978248089359, F1 0.39798055974526564, AUC 0.7511635312561239
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7940365961199295
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 13 idx: 0 First Loss : 2.889704465866089, Second Loss : 2.867414951324463
epoch: 13 idx: 200 First Loss : 0.8295411023459587, Second Loss : 0.8567862522774445
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4375, precision 0.5087390029325513, recall 0.5091582491582493, F1 0.4158110275070926, AUC 0.7542031425364758
  Second-Tier acc 0.4166666666666667, precision 0.4895833333333333, recall 0.4822222222222223, F1 0.37862344373972284, AUC 0.7809090909090909
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.5298245614035088, recall 0.46751910640799527, F1 0.39651755788103316, AUC 0.7494549774642367
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7992724867724869
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 14 idx: 0 First Loss : 2.8777472972869873, Second Loss : 2.8484861850738525
epoch: 14 idx: 200 First Loss : 0.8217152177810261, Second Loss : 0.8510678212241783
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4166666666666667, precision 0.49720051648522895, recall 0.49101010101010106, F1 0.3923138699924414, AUC 0.7448540965207631
  Second-Tier acc 0.4166666666666667, precision 0.4895833333333333, recall 0.4822222222222223, F1 0.37862344373972284, AUC 0.7678787878787879
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5187134502923977, recall 0.4536302175191063, F1 0.3841718788686875, AUC 0.7503796786204194
  Second-Tier acc 0.4897959183673469, precision 0.5660919540229885, recall 0.533289241622575, F1 0.45393133997785157, AUC 0.8070436507936508
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 15 idx: 0 First Loss : 2.8501837253570557, Second Loss : 2.828216075897217
epoch: 15 idx: 200 First Loss : 0.8139845763069036, Second Loss : 0.8470187186777814
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.5024336936617638, recall 0.49185185185185193, F1 0.3871152770959472, AUC 0.7361447811447811
  Second-Tier acc 0.3958333333333333, precision 0.4801587301587302, recall 0.4688888888888889, F1 0.35833333333333334, AUC 0.7444949494949494
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.5221088435374149, recall 0.45745149911816574, F1 0.38230984701572934, AUC 0.7516656868508722
  Second-Tier acc 0.46938775510204084, precision 0.5640273704789834, recall 0.5209435626102293, F1 0.4351106524481137, AUC 0.8075396825396824
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 16 idx: 0 First Loss : 2.8203718662261963, Second Loss : 2.798041820526123
epoch: 16 idx: 200 First Loss : 0.8072643594767676, Second Loss : 0.8428697856942386
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4097222222222222, precision 0.49674185463659154, recall 0.48740740740740734, F1 0.3802083333333333, AUC 0.7279405162738497
  Second-Tier acc 0.3958333333333333, precision 0.4801587301587302, recall 0.4688888888888889, F1 0.35833333333333334, AUC 0.7295454545454545
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.41496598639455784, precision 0.5076190476190475, recall 0.4353321575543798, F1 0.35635247381726254, AUC 0.7480709876543211
  Second-Tier acc 0.46938775510204084, precision 0.5640273704789834, recall 0.5209435626102293, F1 0.4351106524481137, AUC 0.8058862433862434
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 17 idx: 0 First Loss : 2.787984609603882, Second Loss : 2.7726104259490967
epoch: 17 idx: 200 First Loss : 0.8016383625087398, Second Loss : 0.8384591347621336
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.48885993731354555, recall 0.47814814814814816, F1 0.3694995864350703, AUC 0.723260381593715
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7086363636363636
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.51002792586951, recall 0.4394473838918284, F1 0.3625027118096425, AUC 0.7456826866549089
  Second-Tier acc 0.4489795918367347, precision 0.5354166666666667, recall 0.47927689594356265, F1 0.3997347731363076, AUC 0.8052248677248678
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 18 idx: 0 First Loss : 2.8219621181488037, Second Loss : 2.7630834579467773
epoch: 18 idx: 200 First Loss : 0.7976846042950985, Second Loss : 0.8353979761923075
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3958333333333333, precision 0.4853218210361067, recall 0.4737037037037037, F1 0.36250599411604606, AUC 0.7194332210998877
  Second-Tier acc 0.375, precision 0.4689542483660131, recall 0.45555555555555555, F1 0.3371565113500597, AUC 0.696868686868687
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.40816326530612246, precision 0.5068990559186638, recall 0.4312169312169312, F1 0.34942562883739353, AUC 0.7409428277483833
  Second-Tier acc 0.4489795918367347, precision 0.5387205387205388, recall 0.47927689594356265, F1 0.4000834376303713, AUC 0.8053350970017638
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.871768243378921e-05
epoch: 19 idx: 0 First Loss : 2.731870651245117, Second Loss : 2.735370635986328
epoch: 19 idx: 200 First Loss : 0.7923296503444661, Second Loss : 0.8321113024875336
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3888888888888889, precision 0.47936640543156833, recall 0.46925925925925926, F1 0.3554881826767485, AUC 0.7163692480359147
  Second-Tier acc 0.3541666666666667, precision 0.46375661375661376, recall 0.44222222222222224, F1 0.3150926962797063, AUC 0.6918686868686867
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4013605442176871, precision 0.5047228860817116, recall 0.4271017048794827, F1 0.3431169010683835, AUC 0.7346291397217324
  Second-Tier acc 0.42857142857142855, precision 0.5348583877995643, recall 0.4669312169312169, F1 0.3801990493166964, AUC 0.8041225749559083
 
 test auc: 0.7717702821869489, test F1: 0.45931978490118025  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 25, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.26100376494073363, "droprate_2": 0.0, "lr": 0.00017956198176280287, "weight_decay": 2.1325006150818444e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00017956198176280287
epoch: 0 idx: 0 First Loss : 1.2300312519073486, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.08393019193144, Second Loss : 1.0770747246433847
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7503984287317621
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7619696969696969
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7243165784832453
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7218915343915344
Test AUC: 0.7219, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017956198176280287
epoch: 1 idx: 0 First Loss : 1.6551189422607422, Second Loss : 1.7404507398605347
epoch: 1 idx: 200 First Loss : 0.9795056424330716, Second Loss : 0.9779385681917419
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7400056116722783
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7524747474747474
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.727880658436214
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.732418430335097
Test AUC: 0.7219, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017956198176280287
epoch: 2 idx: 0 First Loss : 2.094589948654175, Second Loss : 2.1367597579956055
epoch: 2 idx: 200 First Loss : 0.9416882753817003, Second Loss : 0.9416696783247872
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.37511870845204176, recall 0.45696969696969697, F1 0.40208333333333335, AUC 0.7391358024691357
  Second-Tier acc 0.6041666666666666, precision 0.6222222222222222, recall 0.46646464646464647, F1 0.460042735042735, AUC 0.7493939393939394
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5850340136054422, precision 0.32277526395173456, recall 0.37683715461493233, F1 0.3205612231236779, AUC 0.7185111699000588
  Second-Tier acc 0.6326530612244898, precision 0.8666666666666667, recall 0.48214285714285715, F1 0.4762626262626262, AUC 0.7326940035273367
Test AUC: 0.7219, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00017956198176280287
epoch: 3 idx: 0 First Loss : 2.3670225143432617, Second Loss : 2.5334644317626953
epoch: 3 idx: 200 First Loss : 0.9099068516003552, Second Loss : 0.9132687473549178
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5416666666666666, precision 0.4955555555555555, recall 0.5251515151515151, F1 0.4506172839506173, AUC 0.7630976430976432
  Second-Tier acc 0.5833333333333334, precision 0.5337662337662338, recall 0.554949494949495, F1 0.5070661243220692, AUC 0.764848484848485
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5238095238095238, precision 0.4790628551446805, recall 0.44510582010582017, F1 0.40114823448156783, AUC 0.7226570154810896
  Second-Tier acc 0.6326530612244898, precision 0.6381578947368421, recall 0.6554232804232805, F1 0.6294283413848631, AUC 0.7294973544973544
Test AUC: 0.7295, Test F1: 0.6294 (Best Epoch: 3)
Current LR: 0.00017956198176280287
epoch: 4 idx: 0 First Loss : 2.616976737976074, Second Loss : 2.723817825317383
epoch: 4 idx: 200 First Loss : 0.8933183670192215, Second Loss : 0.8930611190251747
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4444444444444444, precision 0.5028447742733458, recall 0.4790572390572391, F1 0.3902559786594219, AUC 0.7591470258136924
  Second-Tier acc 0.4791666666666667, precision 0.49633699633699635, recall 0.5052525252525253, F1 0.43409806567701303, AUC 0.7764141414141413
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4557823129251701, precision 0.4169734904270987, recall 0.4115961199294533, F1 0.3579685032461835, AUC 0.721138300999412
  Second-Tier acc 0.5306122448979592, precision 0.541904761904762, recall 0.564373897707231, F1 0.5150441248002223, AUC 0.7544091710758378
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 5 idx: 0 First Loss : 2.8053853511810303, Second Loss : 2.9347879886627197
epoch: 5 idx: 200 First Loss : 0.8855660704302772, Second Loss : 0.8783432522566238
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4097222222222222, precision 0.470378128692663, recall 0.45286195286195285, F1 0.3429403929403929, AUC 0.7376430976430975
  Second-Tier acc 0.3958333333333333, precision 0.47301587301587306, recall 0.4374747474747474, F1 0.3417529330572809, AUC 0.7708585858585858
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4421768707482993, precision 0.4652143555369362, recall 0.4246031746031746, F1 0.36207482993197276, AUC 0.7093192729766805
  Second-Tier acc 0.5102040816326531, precision 0.5639880952380952, recall 0.5163139329805997, F1 0.45747486617051836, AUC 0.7512125220458555
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 6 idx: 0 First Loss : 2.8859736919403076, Second Loss : 3.0304815769195557
epoch: 6 idx: 200 First Loss : 0.879410110298192, Second Loss : 0.8688589674930334
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.44467448815274907, recall 0.42619528619528624, F1 0.30600776709151095, AUC 0.7147474747474747
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.7343939393939394
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.4993324432576769, recall 0.43636096413874187, F1 0.36710386013330387, AUC 0.6835439937291788
  Second-Tier acc 0.4489795918367347, precision 0.4537037037037037, recall 0.42063492063492064, F1 0.34, AUC 0.7350088183421516
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 7 idx: 0 First Loss : 2.8816707134246826, Second Loss : 3.05702543258667
epoch: 7 idx: 200 First Loss : 0.8725463577768585, Second Loss : 0.8625309076994213
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.474969474969475, recall 0.4274074074074074, F1 0.296468253968254, AUC 0.695314253647587
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6982323232323232
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.49594395280235987, recall 0.44628159905937687, F1 0.35917118882524374, AUC 0.6855036253184402
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.732363315696649
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 8 idx: 0 First Loss : 2.9552247524261475, Second Loss : 3.0309817790985107
epoch: 8 idx: 200 First Loss : 0.8705266093005848, Second Loss : 0.8557511933613569
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3472222222222222, precision 0.375, recall 0.40888888888888886, F1 0.26308909528723773, AUC 0.6741189674523008
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6505555555555556
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4421768707482993, precision 0.4490358126721763, recall 0.4279835390946502, F1 0.3192150385401919, AUC 0.6839787869880462
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.728615520282187
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 9 idx: 0 First Loss : 2.8962409496307373, Second Loss : 2.965369462966919
epoch: 9 idx: 200 First Loss : 0.8680959231699747, Second Loss : 0.8476251588603806
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.43134040501446475, recall 0.4048148148148148, F1 0.2596449218349126, AUC 0.6637542087542088
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6276767676767677
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6832071820497747
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.712907848324515
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 10 idx: 0 First Loss : 2.8326947689056396, Second Loss : 2.9614193439483643
epoch: 10 idx: 200 First Loss : 0.8595177588720264, Second Loss : 0.84407077100538
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.4465737514518002, recall 0.4007407407407408, F1 0.25443039670894385, AUC 0.6557687991021325
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6185353535353536
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.38095238095238093, precision 0.44533333333333336, recall 0.3909465020576131, F1 0.26591028469377037, AUC 0.680727023319616
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6909722222222223
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 11 idx: 0 First Loss : 2.7677876949310303, Second Loss : 2.9622485637664795
epoch: 11 idx: 200 First Loss : 0.858820307425302, Second Loss : 0.8394489002481232
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2916666666666667, precision 0.3346153846153846, recall 0.37333333333333335, F1 0.20393484239475354, AUC 0.6525308641975309
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6299494949494949
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6676342347638644
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6844686948853616
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 12 idx: 0 First Loss : 2.650190591812134, Second Loss : 2.9863884449005127
epoch: 12 idx: 200 First Loss : 0.8566469504394851, Second Loss : 0.8380223124221996
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3055555555555556, precision 0.3471760797342192, recall 0.38222222222222224, F1 0.21819947288112082, AUC 0.6581481481481481
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6434848484848485
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6603162355477169
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6739417989417991
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 13 idx: 0 First Loss : 2.5671181678771973, Second Loss : 2.867121696472168
epoch: 13 idx: 200 First Loss : 0.8519463637978097, Second Loss : 0.8314422732934388
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3194444444444444, precision 0.3567708333333333, recall 0.39111111111111113, F1 0.2318840579710145, AUC 0.6597699214365881
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6551515151515152
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6590730942582794
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6663910934744268
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 14 idx: 0 First Loss : 2.4970996379852295, Second Loss : 2.831852436065674
epoch: 14 idx: 200 First Loss : 0.8420987865077888, Second Loss : 0.8299624393737541
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.534608378870674, recall 0.4185185185185185, F1 0.28279569892473116, AUC 0.6596913580246914
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6519696969696969
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.41496598639455784, precision 0.42777777777777776, recall 0.4115226337448559, F1 0.29207920792079206, AUC 0.6654174015285127
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6620921516754851
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 15 idx: 0 First Loss : 2.53959059715271, Second Loss : 2.7335901260375977
epoch: 15 idx: 200 First Loss : 0.8388012435437245, Second Loss : 0.8189129727111842
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3194444444444444, precision 0.4268879268879269, recall 0.4007407407407408, F1 0.25488377623209085, AUC 0.6560830527497193
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6444949494949495
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.36054421768707484, precision 0.4797453703703704, recall 0.3883744855967079, F1 0.25816797581503464, AUC 0.6547557809131884
  Second-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6575727513227513
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 16 idx: 0 First Loss : 2.6284573078155518, Second Loss : 2.857191801071167
epoch: 16 idx: 200 First Loss : 0.8367639197123791, Second Loss : 0.8112130989415417
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3472222222222222, precision 0.534608378870674, recall 0.4185185185185185, F1 0.28279569892473116, AUC 0.6622502805836139
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6479292929292929
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.4250510352872558, recall 0.40329218106995884, F1 0.28015858785089554, AUC 0.6476337448559671
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.6499118165784833
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 17 idx: 0 First Loss : 2.5345118045806885, Second Loss : 2.814948558807373
epoch: 17 idx: 200 First Loss : 0.8326297860331393, Second Loss : 0.8061138948723784
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.663709315375982
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6528787878787878
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41496598639455784, precision 0.41358730158730156, recall 0.4115226337448559, F1 0.29184767719463034, AUC 0.6421406525573193
  Second-Tier acc 0.32653061224489793, precision 0.43703703703703706, recall 0.35802469135802467, F1 0.2041691018897331, AUC 0.642416225749559
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 18 idx: 0 First Loss : 2.523820161819458, Second Loss : 2.808884382247925
epoch: 18 idx: 200 First Loss : 0.8258384201611654, Second Loss : 0.8021747901618269
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3611111111111111, precision 0.4884920634920635, recall 0.4225925925925926, F1 0.28588486676721975, AUC 0.6687934904601572
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6442424242424242
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4013605442176871, precision 0.40935672514619886, recall 0.40329218106995884, F1 0.28, AUC 0.6637823339212229
  Second-Tier acc 0.32653061224489793, precision 0.43703703703703706, recall 0.35802469135802467, F1 0.2041691018897331, AUC 0.6522266313932981
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 19 idx: 0 First Loss : 2.7116048336029053, Second Loss : 3.0117270946502686
epoch: 19 idx: 200 First Loss : 0.8261952189989539, Second Loss : 0.8044887770781284
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.4064814814814815, recall 0.4048148148148148, F1 0.2600222884852866, AUC 0.665976430976431
  Second-Tier acc 0.3125, precision 0.3583333333333334, recall 0.38666666666666666, F1 0.23267973856209148, AUC 0.6291414141414141
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3877551020408163, precision 0.4707301587301587, recall 0.40483539094650206, F1 0.2863922692249909, AUC 0.6689937291789144
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.6506834215167548
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 20 idx: 0 First Loss : 2.8836071491241455, Second Loss : 3.114082098007202
epoch: 20 idx: 200 First Loss : 0.823355354927596, Second Loss : 0.8020229489851392
>>>>>>>>>>> Validation Epoch: 20
  First-Tier acc 0.3263888888888889, precision 0.34796893667861406, recall 0.3955555555555556, F1 0.24048581147409998, AUC 0.6709090909090909
  Second-Tier acc 0.3333333333333333, precision 0.32976190476190476, recall 0.39999999999999997, F1 0.2479575163398693, AUC 0.6693939393939394
>>>>>>>>>>> Test Epoch: 20
  First-Tier acc 0.38095238095238093, precision 0.40172919561525394, recall 0.3871252204585538, F1 0.26377651652376927, AUC 0.6664033411718596
  Second-Tier acc 0.3469387755102041, precision 0.36744186046511623, recall 0.35890652557319225, F1 0.23538011695906433, AUC 0.6523368606701939
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 21 idx: 0 First Loss : 2.9182777404785156, Second Loss : 3.1666436195373535
epoch: 21 idx: 200 First Loss : 0.8203926730290112, Second Loss : 0.8021682734797831
>>>>>>>>>>> Validation Epoch: 21
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.6722109988776656
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6611616161616162
>>>>>>>>>>> Test Epoch: 21
  First-Tier acc 0.40816326530612246, precision 0.3972121212121212, recall 0.403586125808348, F1 0.2866500009689359, AUC 0.6702001273760533
  Second-Tier acc 0.30612244897959184, precision 0.4318181818181818, recall 0.33421516754850095, F1 0.19540229885057472, AUC 0.6676036155202821
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 22 idx: 0 First Loss : 2.790173292160034, Second Loss : 3.086573839187622
epoch: 22 idx: 200 First Loss : 0.8135627148294589, Second Loss : 0.7961067518225904
>>>>>>>>>>> Validation Epoch: 22
  First-Tier acc 0.3819444444444444, precision 0.35712143928035983, recall 0.4254545454545455, F1 0.2915800415800416, AUC 0.6653591470258137
  Second-Tier acc 0.3541666666666667, precision 0.3416666666666666, recall 0.41333333333333333, F1 0.2650029708853238, AUC 0.6699999999999999
>>>>>>>>>>> Test Epoch: 22
  First-Tier acc 0.42857142857142855, precision 0.3854938271604938, recall 0.4159318048206937, F1 0.3045267489711934, AUC 0.6711309523809524
  Second-Tier acc 0.30612244897959184, precision 0.3207070707070707, recall 0.33421516754850095, F1 0.19386973180076628, AUC 0.6699184303350969
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 23 idx: 0 First Loss : 2.8897902965545654, Second Loss : 2.9904026985168457
epoch: 23 idx: 200 First Loss : 0.8129069370025985, Second Loss : 0.791757448011219
>>>>>>>>>>> Validation Epoch: 23
  First-Tier acc 0.3541666666666667, precision 0.3527777777777778, recall 0.4076767676767677, F1 0.26737967914438504, AUC 0.6541919191919191
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6537878787878787
>>>>>>>>>>> Test Epoch: 23
  First-Tier acc 0.41496598639455784, precision 0.3888888888888889, recall 0.40770135214579656, F1 0.29264069264069265, AUC 0.6690488438173623
  Second-Tier acc 0.30612244897959184, precision 0.26744186046511625, recall 0.33421516754850095, F1 0.19505753631390302, AUC 0.6698082010582009
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4)
Current LR: 0.00017956198176280287
epoch: 24 idx: 0 First Loss : 2.7405433654785156, Second Loss : 3.027231454849243
epoch: 24 idx: 200 First Loss : 0.8074162033716589, Second Loss : 0.7904820225783769
>>>>>>>>>>> Validation Epoch: 24
  First-Tier acc 0.375, precision 0.6932203389830508, recall 0.4314814814814814, F1 0.297046715589762, AUC 0.6676094276094275
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6410606060606061
>>>>>>>>>>> Test Epoch: 24
  First-Tier acc 0.42857142857142855, precision 0.5607627666451196, recall 0.4218841857730747, F1 0.3283441467106644, AUC 0.6935197432882618
  Second-Tier acc 0.32653061224489793, precision 0.34848484848484845, recall 0.34656084656084657, F1 0.2139414163885799, AUC 0.656194885361552
Test AUC: 0.7544, Test F1: 0.5150 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.30949312268237084, "droprate_2": 0.0, "lr": 0.00013896244090941918, "weight_decay": 8.786020529073962e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_3", "disable_writer": true, "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.31138142729363216, "droprate_2": 0.0, "lr": 9.30975410358371e-05, "weight_decay": 1.9474498987326312e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 9.30975410358371e-05
epoch: 0 idx: 0 First Loss : 1.2323145866394043, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1117644104272573, Second Loss : 1.1076787692768064
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.742514029180696
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7599494949494949
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7090988144228886
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7065696649029981
Test AUC: 0.7066, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.30975410358371e-05
epoch: 1 idx: 0 First Loss : 2.045078992843628, Second Loss : 1.938733696937561
epoch: 1 idx: 200 First Loss : 1.0041274554397337, Second Loss : 1.0145850559668754
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5277777777777778, precision 0.5106382978723404, recall 0.3434343434343434, F1 0.2510893246187364, AUC 0.7374859708193041
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7476767676767677
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7110033313737016
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7111992945326279
Test AUC: 0.7066, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.30975410358371e-05
epoch: 2 idx: 0 First Loss : 2.5444023609161377, Second Loss : 2.245931625366211
epoch: 2 idx: 200 First Loss : 0.955952017424415, Second Loss : 0.9668482251428253
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5694444444444444, precision 0.5307090841974563, recall 0.5311447811447811, F1 0.5276099798993038, AUC 0.7155443322109988
  Second-Tier acc 0.625, precision 0.5398190045248868, recall 0.5476767676767677, F1 0.5196078431372549, AUC 0.7281313131313132
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5986394557823129, precision 0.5666977611940299, recall 0.6004556143445032, F1 0.577069927069927, AUC 0.6958406819517932
  Second-Tier acc 0.6326530612244898, precision 0.6454178925574806, recall 0.6439594356261024, F1 0.6375757575757576, AUC 0.7022156084656085
Test AUC: 0.7066, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.30975410358371e-05
epoch: 3 idx: 0 First Loss : 3.290600061416626, Second Loss : 3.054250478744507
epoch: 3 idx: 200 First Loss : 0.9244083862992661, Second Loss : 0.9439654257426511
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4513888888888889, precision 0.5273224859431757, recall 0.48410774410774415, F1 0.4351445489376524, AUC 0.7133221099887767
  Second-Tier acc 0.4166666666666667, precision 0.49713261648745516, recall 0.43131313131313137, F1 0.3855956797133268, AUC 0.7314141414141414
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5034013605442177, precision 0.5581325301204819, recall 0.5326278659611993, F1 0.5031515151515151, AUC 0.7031893004115227
  Second-Tier acc 0.5510204081632653, precision 0.589514652014652, recall 0.5652557319223986, F1 0.5459948320413437, AUC 0.7421737213403881
Test AUC: 0.7066, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.30975410358371e-05
epoch: 4 idx: 0 First Loss : 4.009231090545654, Second Loss : 3.6814510822296143
epoch: 4 idx: 200 First Loss : 0.918374961967214, Second Loss : 0.9366613798380936
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4027777777777778, precision 0.5131387525004546, recall 0.4529966329966329, F1 0.3928085721958023, AUC 0.7149382716049383
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7341414141414142
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4965986394557823, precision 0.5771072796934865, recall 0.5557025279247502, F1 0.5048856382464121, AUC 0.7154921124828532
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.7500551146384481
Test AUC: 0.7066, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 9.30975410358371e-05
epoch: 5 idx: 0 First Loss : 4.212557315826416, Second Loss : 4.042574882507324
epoch: 5 idx: 200 First Loss : 0.9144526995644344, Second Loss : 0.9387289510358736
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.4724556489262372, recall 0.4231986531986532, F1 0.3381985055230669, AUC 0.725381593714927
  Second-Tier acc 0.4166666666666667, precision 0.611111111111111, recall 0.46525252525252525, F1 0.3875956056181338, AUC 0.7628787878787878
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5102040816326531, precision 0.6228287841191067, recall 0.5889917695473251, F1 0.5144894827119256, AUC 0.7311630413482265
  Second-Tier acc 0.5510204081632653, precision 0.6414141414141414, recall 0.58179012345679, F1 0.521618883321011, AUC 0.7813051146384481
Test AUC: 0.7813, Test F1: 0.5216 (Best Epoch: 5)
Current LR: 9.30975410358371e-05
epoch: 6 idx: 0 First Loss : 4.241833209991455, Second Loss : 4.120556831359863
epoch: 6 idx: 200 First Loss : 0.90519363561527, Second Loss : 0.9385668045658137
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3888888888888889, precision 0.48457389428263214, recall 0.46925925925925926, F1 0.3559167526659787, AUC 0.7436026936026936
  Second-Tier acc 0.3958333333333333, precision 0.5509259259259259, recall 0.4519191919191919, F1 0.3665914463786804, AUC 0.7671212121212121
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.5764069264069264, recall 0.5352733686067019, F1 0.4623331470789098, AUC 0.7434229864785421
  Second-Tier acc 0.5102040816326531, precision 0.6313131313131314, recall 0.5749559082892416, F1 0.5034447821681864, AUC 0.8039572310405644
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 7 idx: 0 First Loss : 4.240367412567139, Second Loss : 4.116028308868408
epoch: 7 idx: 200 First Loss : 0.8978295317742121, Second Loss : 0.929250870735746
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3541666666666667, precision 0.4461475854584916, recall 0.4244107744107744, F1 0.32801759410801967, AUC 0.7340067340067341
  Second-Tier acc 0.375, precision 0.49206349206349204, recall 0.4385858585858586, F1 0.34400161030595805, AUC 0.7582323232323231
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4489795918367347, precision 0.5590062111801242, recall 0.5069077013521458, F1 0.4241120292145582, AUC 0.7289951989026063
  Second-Tier acc 0.46938775510204084, precision 0.5795454545454546, recall 0.5094797178130511, F1 0.44759371833839917, AUC 0.7783840388007054
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 8 idx: 0 First Loss : 4.288223743438721, Second Loss : 4.064489364624023
epoch: 8 idx: 200 First Loss : 0.8963579209043588, Second Loss : 0.9248708819846544
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3472222222222222, precision 0.43501280535855, recall 0.41996632996632993, F1 0.3212168450480692, AUC 0.7220145903479237
  Second-Tier acc 0.375, precision 0.47899159663865537, recall 0.4385858585858586, F1 0.34332358674463936, AUC 0.736919191919192
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.5249706227967098, recall 0.44708994708994704, F1 0.3728229196788042, AUC 0.7078495492847345
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.7602513227513228
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 9 idx: 0 First Loss : 4.257686614990234, Second Loss : 4.028113842010498
epoch: 9 idx: 200 First Loss : 0.8964176646705116, Second Loss : 0.9227074281050736
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3263888888888889, precision 0.4165959453088166, recall 0.40350168350168353, F1 0.2847844112769486, AUC 0.6966778900112233
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7036363636363636
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.5101836697581378, recall 0.416740152851264, F1 0.33408439399151474, AUC 0.6819211738193219
  Second-Tier acc 0.3877551020408163, precision 0.48801742919389984, recall 0.40145502645502645, F1 0.3270944741532977, AUC 0.7315365961199295
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 10 idx: 0 First Loss : 4.242529392242432, Second Loss : 3.8631207942962646
epoch: 10 idx: 200 First Loss : 0.9003150563472645, Second Loss : 0.9227307796368517
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.40316493187780317, recall 0.39461279461279464, F1 0.2703904718830092, AUC 0.6828563411896744
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.6890404040404041
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.4904040404040404, recall 0.3909465020576132, F1 0.30934848859237296, AUC 0.667517881638252
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7171516754850087
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 11 idx: 0 First Loss : 4.139803409576416, Second Loss : 3.806256055831909
epoch: 11 idx: 200 First Loss : 0.9024092314388534, Second Loss : 0.9208347202249425
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2986111111111111, precision 0.37094276094276096, recall 0.3874074074074074, F1 0.239901796167563, AUC 0.6810549943883277
  Second-Tier acc 0.3125, precision 0.3917989417989418, recall 0.40111111111111114, F1 0.26013183884248353, AUC 0.6891414141414142
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3673469387755102, precision 0.4885687441277795, recall 0.3967519106407995, F1 0.303274861602081, AUC 0.6607265334117186
  Second-Tier acc 0.3877551020408163, precision 0.4941798941798942, recall 0.41291887125220456, F1 0.3202531012404962, AUC 0.7019400352733686
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 12 idx: 0 First Loss : 4.204877853393555, Second Loss : 3.7320005893707275
epoch: 12 idx: 200 First Loss : 0.9024498384532855, Second Loss : 0.9135875860809763
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2916666666666667, precision 0.36108374384236447, recall 0.38296296296296295, F1 0.2348350711522067, AUC 0.6815207631874299
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.694949494949495
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.36054421768707484, precision 0.4947619047619048, recall 0.39858906525573196, F1 0.3049281656771318, AUC 0.6630229766803841
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6854607583774252
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 13 idx: 0 First Loss : 4.19313383102417, Second Loss : 3.6129026412963867
epoch: 13 idx: 200 First Loss : 0.8986544010053628, Second Loss : 0.9044539790785296
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3055555555555556, precision 0.3825851335133514, recall 0.39666666666666667, F1 0.25560637305946327, AUC 0.6805555555555557
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6922727272727273
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.5017418408507517, recall 0.4042475014697237, F1 0.3013098013098013, AUC 0.6696122378992749
  Second-Tier acc 0.3673469387755102, precision 0.4904761904761905, recall 0.40057319223985893, F1 0.29992929071270086, AUC 0.6716269841269842
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 14 idx: 0 First Loss : 4.250476837158203, Second Loss : 3.592655658721924
epoch: 14 idx: 200 First Loss : 0.8988262007299802, Second Loss : 0.8977340843189109
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3125, precision 0.3928165007112376, recall 0.40111111111111114, F1 0.2682377775153519, AUC 0.6781593714927049
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6845959595959595
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.5017721070352649, recall 0.4042475014697237, F1 0.301964412465442, AUC 0.6685834313149127
  Second-Tier acc 0.3673469387755102, precision 0.4904761904761905, recall 0.40057319223985893, F1 0.29992929071270086, AUC 0.6720679012345679
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 15 idx: 0 First Loss : 4.272622585296631, Second Loss : 3.657322645187378
epoch: 15 idx: 200 First Loss : 0.8885278765982417, Second Loss : 0.8957573339117263
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3194444444444444, precision 0.4028985507246377, recall 0.41037037037037044, F1 0.28005323653962494, AUC 0.6728619528619527
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6903030303030303
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.36054421768707484, precision 0.5152046783625731, recall 0.42408877131099354, F1 0.3191496257189688, AUC 0.6748297570056829
  Second-Tier acc 0.32653061224489793, precision 0.4849206349206349, recall 0.3758818342151676, F1 0.2561810931269059, AUC 0.673776455026455
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 16 idx: 0 First Loss : 4.2840447425842285, Second Loss : 3.794650077819824
epoch: 16 idx: 200 First Loss : 0.8874300803585701, Second Loss : 0.8944981651332803
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3194444444444444, precision 0.40786652372018234, recall 0.4095286195286196, F1 0.2842985712841108, AUC 0.6702581369248035
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.680959595959596
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3673469387755102, precision 0.5231724796942188, recall 0.4379776601998824, F1 0.3299016772700983, AUC 0.6775487458357828
  Second-Tier acc 0.3469387755102041, precision 0.49326599326599324, recall 0.3996913580246913, F1 0.2677313974591652, AUC 0.6710758377425045
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 17 idx: 0 First Loss : 4.198337078094482, Second Loss : 3.769550085067749
epoch: 17 idx: 200 First Loss : 0.8814343841501221, Second Loss : 0.8876876786655147
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3194444444444444, precision 0.40820105820105823, recall 0.4095286195286196, F1 0.2851422943937662, AUC 0.6669584736251403
  Second-Tier acc 0.2916666666666667, precision 0.3603174603174603, recall 0.3877777777777778, F1 0.23734236777715043, AUC 0.6761111111111111
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3673469387755102, precision 0.5350564468211527, recall 0.45752498530276303, F1 0.3334293671372323, AUC 0.6783570938663531
  Second-Tier acc 0.32653061224489793, precision 0.4943977591036414, recall 0.3873456790123457, F1 0.24855699855699856, AUC 0.6743827160493826
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 18 idx: 0 First Loss : 4.124138355255127, Second Loss : 3.7429518699645996
epoch: 18 idx: 200 First Loss : 0.8786728415882985, Second Loss : 0.8838067090275118
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.4090909090909091, recall 0.4095286195286196, F1 0.28694072385294955, AUC 0.6651627384960718
  Second-Tier acc 0.2916666666666667, precision 0.36036838978015445, recall 0.3877777777777778, F1 0.23956751782838737, AUC 0.671919191919192
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3673469387755102, precision 0.5350564468211527, recall 0.45752498530276303, F1 0.3334293671372323, AUC 0.676979227905154
  Second-Tier acc 0.30612244897959184, precision 0.4868686868686869, recall 0.36353615520282184, F1 0.237192194176468, AUC 0.6734457671957671
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6)
Current LR: 9.30975410358371e-05
epoch: 19 idx: 0 First Loss : 4.105296611785889, Second Loss : 3.748516082763672
epoch: 19 idx: 200 First Loss : 0.8761502506497696, Second Loss : 0.8805537447936657
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3263888888888889, precision 0.4180433875677931, recall 0.4187878787878789, F1 0.2979492487776941, AUC 0.6683221099887766
  Second-Tier acc 0.2916666666666667, precision 0.36036838978015445, recall 0.3877777777777778, F1 0.23956751782838737, AUC 0.664949494949495
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3741496598639456, precision 0.5420506069913705, recall 0.471413874191652, F1 0.342663188871054, AUC 0.6735743680188125
  Second-Tier acc 0.32653061224489793, precision 0.5104166666666666, recall 0.4052028218694885, F1 0.2677708764665286, AUC 0.6742173721340388
Test AUC: 0.8040, Test F1: 0.5034 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.21311600888766552, "droprate_2": 0.0, "lr": 0.0002349274769800312, "weight_decay": 0.0001818857082682599, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0002349274769800312
epoch: 0 idx: 0 First Loss : 1.2494851350784302, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0852301540918907, Second Loss : 1.0786815599644954
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.744371492704826
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7537373737373737
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138203017832647
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7125771604938271
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 1 idx: 0 First Loss : 1.712532639503479, Second Loss : 1.8447966575622559
epoch: 1 idx: 200 First Loss : 0.9826449219563708, Second Loss : 0.9765979966417474
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337598204264871
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7323737373737375
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7420328728199098
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7481812169312169
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 2 idx: 0 First Loss : 1.9347981214523315, Second Loss : 2.2021524906158447
epoch: 2 idx: 200 First Loss : 0.9478986635804176, Second Loss : 0.9499631696820852
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7313636363636364
  Second-Tier acc 0.5833333333333334, precision 0.3984126984126984, recall 0.42424242424242425, F1 0.3737562189054726, AUC 0.7311616161616161
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.19424460431654678, recall 0.3333333333333333, F1 0.24545454545454545, AUC 0.7297361845972957
  Second-Tier acc 0.5714285714285714, precision 0.524822695035461, recall 0.375, F1 0.3173173173173173, AUC 0.7328042328042329
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 3 idx: 0 First Loss : 3.184891939163208, Second Loss : 3.2221457958221436
epoch: 3 idx: 200 First Loss : 0.9278554886357108, Second Loss : 0.9336889639070526
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5347222222222222, precision 0.3897963299052229, recall 0.5119191919191919, F1 0.40404040404040403, AUC 0.7328956228956228
  Second-Tier acc 0.5, precision 0.3703703703703704, recall 0.48969696969696974, F1 0.37965588958215163, AUC 0.7419191919191919
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.564625850340136, precision 0.5142857142857142, recall 0.4774397413286302, F1 0.43097301962550194, AUC 0.7070656966490301
  Second-Tier acc 0.5510204081632653, precision 0.3849206349206349, recall 0.4594356261022927, F1 0.3968253968253968, AUC 0.7086640211640213
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 4 idx: 0 First Loss : 3.3722972869873047, Second Loss : 3.5864968299865723
epoch: 4 idx: 200 First Loss : 0.9176133539648125, Second Loss : 0.9238595337287259
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.375, precision 0.37322033898305085, recall 0.4266666666666667, F1 0.2856953642384106, AUC 0.7493153759820427
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7380303030303029
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.43398200460347347, recall 0.42445620223397995, F1 0.32716049382716045, AUC 0.6854668822261415
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.726851851851852
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 5 idx: 0 First Loss : 3.618804931640625, Second Loss : 3.7076423168182373
epoch: 5 idx: 200 First Loss : 0.917651377625263, Second Loss : 0.9217205522836774
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.6833333333333335
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6956060606060607
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6384173525377229
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6969797178130511
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 6 idx: 0 First Loss : 3.6696321964263916, Second Loss : 3.6260087490081787
epoch: 6 idx: 200 First Loss : 0.9105109431924512, Second Loss : 0.9114304982850894
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3888888888888889, precision 0.3779677113010447, recall 0.43555555555555553, F1 0.2969934640522876, AUC 0.6775364758698091
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6887878787878788
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.4519774011299435, recall 0.45267489711934156, F1 0.35075757575757577, AUC 0.6608183911424652
  Second-Tier acc 0.5102040816326531, precision 0.4594594594594595, recall 0.46913580246913583, F1 0.3759889920880633, AUC 0.6805004409171076
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 7 idx: 0 First Loss : 3.8360087871551514, Second Loss : 3.298804759979248
epoch: 7 idx: 200 First Loss : 0.9106750049383903, Second Loss : 0.9057753020156156
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.375, precision 0.3841036414565826, recall 0.4266666666666667, F1 0.28615098351940454, AUC 0.6601459034792369
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6842424242424242
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.663604742308446
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6910824514991182
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 8 idx: 0 First Loss : 3.6194145679473877, Second Loss : 3.4466729164123535
epoch: 8 idx: 200 First Loss : 0.9024391231577107, Second Loss : 0.9066650338235789
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3611111111111111, precision 0.37878787878787873, recall 0.4177777777777778, F1 0.2734413352970054, AUC 0.6471717171717172
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6781818181818182
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.6576584852047814
  Second-Tier acc 0.4897959183673469, precision 0.456140350877193, recall 0.4567901234567901, F1 0.3596673596673597, AUC 0.6685956790123457
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 9 idx: 0 First Loss : 3.6278982162475586, Second Loss : 3.4398865699768066
epoch: 9 idx: 200 First Loss : 0.9053526903726786, Second Loss : 0.9038139705451215
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3263888888888889, precision 0.3646737383477981, recall 0.3955555555555556, F1 0.2433847592332866, AUC 0.6363468013468013
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6691919191919192
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3945578231292517, precision 0.4490358126721763, recall 0.3991769547325103, F1 0.2817447768431261, AUC 0.6582035077405448
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6698082010582009
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 10 idx: 0 First Loss : 3.7649714946746826, Second Loss : 3.79136323928833
epoch: 10 idx: 200 First Loss : 0.9050540490370169, Second Loss : 0.9040277011113922
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.3780427223050174, recall 0.4177777777777778, F1 0.27251967631083024, AUC 0.6407744107744108
  Second-Tier acc 0.4375, precision 0.7324324324324324, recall 0.48111111111111104, F1 0.3754884004884005, AUC 0.6744949494949495
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.4490358126721763, recall 0.4279835390946502, F1 0.3192150385401919, AUC 0.6604448363707623
  Second-Tier acc 0.4489795918367347, precision 0.5126984126984128, recall 0.44995590828924165, F1 0.3768707482993197, AUC 0.6720679012345679
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 11 idx: 0 First Loss : 3.6641104221343994, Second Loss : 3.3868567943573
epoch: 11 idx: 200 First Loss : 0.8895238999712318, Second Loss : 0.8985891716458617
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3472222222222222, precision 0.3727642276422764, recall 0.40888888888888886, F1 0.26032388663967615, AUC 0.6362401795735129
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.6712626262626262
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.44533333333333336, recall 0.4156378600823045, F1 0.2996778719788146, AUC 0.6551722026259065
  Second-Tier acc 0.42857142857142855, precision 0.5047619047619047, recall 0.43761022927689597, F1 0.3585700947045485, AUC 0.6646825396825397
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 12 idx: 0 First Loss : 3.419562339782715, Second Loss : 3.315906524658203
epoch: 12 idx: 200 First Loss : 0.8833943114938725, Second Loss : 0.8963308501051824
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3472222222222222, precision 0.3727642276422764, recall 0.40888888888888886, F1 0.26032388663967615, AUC 0.6403086419753087
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.6671212121212121
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.44533333333333336, recall 0.4197530864197531, F1 0.30491957261946695, AUC 0.6561213991769547
  Second-Tier acc 0.42857142857142855, precision 0.5047619047619047, recall 0.43761022927689597, F1 0.3585700947045485, AUC 0.6728395061728395
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 13 idx: 0 First Loss : 3.4140002727508545, Second Loss : 3.444146156311035
epoch: 13 idx: 200 First Loss : 0.8791375831965909, Second Loss : 0.885502299061045
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3263888888888889, precision 0.36112397714991507, recall 0.3955555555555556, F1 0.23894927536231883, AUC 0.6423512906846239
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6699999999999999
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.40816326530612246, precision 0.4427083333333333, recall 0.40740740740740744, F1 0.2859180035650624, AUC 0.6640640309621791
  Second-Tier acc 0.42857142857142855, precision 0.5092592592592593, recall 0.43761022927689597, F1 0.3582072829131653, AUC 0.6830357142857143
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 14 idx: 0 First Loss : 3.5517005920410156, Second Loss : 3.536949396133423
epoch: 14 idx: 200 First Loss : 0.8765870992436393, Second Loss : 0.8868598922129227
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.34652014652014645, recall 0.38222222222222224, F1 0.2173663288986926, AUC 0.6469921436588103
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6718181818181819
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.43552311435523117, recall 0.37448559670781895, F1 0.22968465426565987, AUC 0.6667156574563983
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6839726631393298
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 15 idx: 0 First Loss : 3.490432024002075, Second Loss : 3.539130449295044
epoch: 15 idx: 200 First Loss : 0.8733479791195956, Second Loss : 0.885113655007915
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.34652014652014645, recall 0.38222222222222224, F1 0.2173663288986926, AUC 0.6502300785634119
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6672727272727274
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.43552311435523117, recall 0.37448559670781895, F1 0.22968465426565987, AUC 0.6779223006074858
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6934523809523809
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 16 idx: 0 First Loss : 3.6418230533599854, Second Loss : 3.6821844577789307
epoch: 16 idx: 200 First Loss : 0.8696525565246114, Second Loss : 0.8821824429377833
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2986111111111111, precision 0.3403797220591114, recall 0.37777777777777777, F1 0.20990391722099042, AUC 0.6524410774410775
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6640404040404041
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.43478260869565216, recall 0.3703703703703704, F1 0.22222222222222224, AUC 0.6717433372525966
  Second-Tier acc 0.32653061224489793, precision 0.4444444444444444, recall 0.35802469135802467, F1 0.21264367816091956, AUC 0.7070656966490301
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 17 idx: 0 First Loss : 3.649843215942383, Second Loss : 3.7992796897888184
epoch: 17 idx: 200 First Loss : 0.8727781695819956, Second Loss : 0.8777730861190787
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6556453423120089
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6691919191919192
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3401360544217687, precision 0.43405275779376495, recall 0.3662551440329218, F1 0.21462122622964386, AUC 0.6739356750930825
  Second-Tier acc 0.32653061224489793, precision 0.44186046511627913, recall 0.35802469135802467, F1 0.20971970155273242, AUC 0.7084435626102293
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 18 idx: 0 First Loss : 3.763211488723755, Second Loss : 3.8391616344451904
epoch: 18 idx: 200 First Loss : 0.8732136910778567, Second Loss : 0.8804672205361312
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6684736251402917
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6618686868686868
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.3621399176954732, F1 0.20687645687645687, AUC 0.6863977072310407
  Second-Tier acc 0.3469387755102041, precision 0.4393939393939394, recall 0.3703703703703704, F1 0.22758620689655173, AUC 0.7073963844797179
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0002349274769800312
epoch: 19 idx: 0 First Loss : 4.390869617462158, Second Loss : 4.1957831382751465
epoch: 19 idx: 200 First Loss : 0.8689023554681741, Second Loss : 0.876455987880988
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2847222222222222, precision 0.32513100934153566, recall 0.3688888888888889, F1 0.19454562435789668, AUC 0.6636083052749719
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6572222222222223
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.3621399176954732, F1 0.20687645687645687, AUC 0.6827050264550265
  Second-Tier acc 0.3469387755102041, precision 0.517117117117117, recall 0.41754850088183426, F1 0.28998572609120277, AUC 0.6887676366843033
Test AUC: 0.7126, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.23794606541805996, "droprate_2": 0.0, "lr": 2.4287391042385938e-05, "weight_decay": 0.0005688020618119089, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.4287391042385938e-05
epoch: 0 idx: 0 First Loss : 1.2445569038391113, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.10572123616489, Second Loss : 1.0937184844147507
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7083557800224467
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7581818181818182
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6500649127963943
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6517305996472662
Test AUC: 0.6517, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.4287391042385938e-05
epoch: 1 idx: 0 First Loss : 2.097369432449341, Second Loss : 2.0883212089538574
epoch: 1 idx: 200 First Loss : 1.090152844786644, Second Loss : 1.08215182989984
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7344949494949494
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.767020202020202
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.696893983931021
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7036485890652558
Test AUC: 0.7036, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4287391042385938e-05
epoch: 2 idx: 0 First Loss : 2.2192771434783936, Second Loss : 2.215284824371338
epoch: 2 idx: 200 First Loss : 1.0613087372696814, Second Loss : 1.053425731053993
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408978675645342
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7618686868686867
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7149654614932391
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118055555555555
Test AUC: 0.7036, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4287391042385938e-05
epoch: 3 idx: 0 First Loss : 2.3766794204711914, Second Loss : 2.376228094100952
epoch: 3 idx: 200 First Loss : 1.0313118906756538, Second Loss : 1.0254411720369585
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5763888888888888, precision 0.6046365914786967, recall 0.4132996632996633, F1 0.3737179487179487, AUC 0.7365319865319865
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.74989898989899
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5782312925170068, precision 0.5221445221445221, recall 0.3888888888888889, F1 0.3363095238095238, AUC 0.7174150009798158
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7164351851851851
Test AUC: 0.7036, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4287391042385938e-05
epoch: 4 idx: 0 First Loss : 2.586878538131714, Second Loss : 2.5732569694519043
epoch: 4 idx: 200 First Loss : 0.9974260993338936, Second Loss : 0.9955637400126576
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6736111111111112, precision 0.6608476637137398, recall 0.5737373737373738, F1 0.5907925407925408, AUC 0.7330695847362514
  Second-Tier acc 0.6666666666666666, precision 0.4323232323232323, recall 0.5793939393939395, F1 0.4951370468611848, AUC 0.744040404040404
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6054421768707483, precision 0.5129569892473119, recall 0.5357877718988829, F1 0.5012441042160988, AUC 0.7102378502841465
  Second-Tier acc 0.6530612244897959, precision 0.6611111111111111, recall 0.5747354497354498, F1 0.5961887477313974, AUC 0.7167658730158729
Test AUC: 0.7036, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4287391042385938e-05
epoch: 5 idx: 0 First Loss : 2.8438262939453125, Second Loss : 2.827889919281006
epoch: 5 idx: 200 First Loss : 0.9701408237700735, Second Loss : 0.9702448819889061
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5555555555555556, precision 0.5209715057725375, recall 0.5194949494949496, F1 0.4868920702609402, AUC 0.7318686868686869
  Second-Tier acc 0.6458333333333334, precision 0.6147752030104972, recall 0.6213131313131314, F1 0.6045254981425194, AUC 0.7418181818181817
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5034013605442177, precision 0.4593208874458874, recall 0.49529688418577306, F1 0.44602273908253826, AUC 0.7163861943954535
  Second-Tier acc 0.6326530612244898, precision 0.6151515151515151, recall 0.6618165784832452, F1 0.6249766703994027, AUC 0.7356701940035274
Test AUC: 0.7036, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.4287391042385938e-05
epoch: 6 idx: 0 First Loss : 3.109708070755005, Second Loss : 3.0908114910125732
epoch: 6 idx: 200 First Loss : 0.9510388618325861, Second Loss : 0.9546361414817583
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4791666666666667, precision 0.497514740161799, recall 0.48420875420875426, F1 0.4263157894736842, AUC 0.7413748597081931
  Second-Tier acc 0.5625, precision 0.6053077357425183, recall 0.6207070707070707, F1 0.5547089947089947, AUC 0.7703535353535353
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4557823129251701, precision 0.48152803966757457, recall 0.5289535567313345, F1 0.43042449954892353, AUC 0.7245125416421713
  Second-Tier acc 0.5102040816326531, precision 0.5215686274509804, recall 0.5826719576719577, F1 0.5061751152073732, AUC 0.7608575837742504
Test AUC: 0.7609, Test F1: 0.5062 (Best Epoch: 6)
Current LR: 2.4287391042385938e-05
epoch: 7 idx: 0 First Loss : 3.3079683780670166, Second Loss : 3.292302370071411
epoch: 7 idx: 200 First Loss : 0.9401921021256281, Second Loss : 0.9452823862637305
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4444444444444444, precision 0.4930615278441366, recall 0.47245791245791247, F1 0.40448693913260847, AUC 0.7527384960718294
  Second-Tier acc 0.5208333333333334, precision 0.5858201058201058, recall 0.594040404040404, F1 0.5150609432962374, AUC 0.7886868686868685
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.46977165135059873, recall 0.5121987066431511, F1 0.4071469271469272, AUC 0.7303730648638056
  Second-Tier acc 0.46938775510204084, precision 0.49686433277764547, recall 0.5579805996472663, F1 0.4685384309040223, AUC 0.7669201940035274
Test AUC: 0.7669, Test F1: 0.4685 (Best Epoch: 7)
Current LR: 2.4287391042385938e-05
epoch: 8 idx: 0 First Loss : 3.4459187984466553, Second Loss : 3.4335684776306152
epoch: 8 idx: 200 First Loss : 0.9342783394487417, Second Loss : 0.940944092806929
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4166666666666667, precision 0.471998371998372, recall 0.45468013468013463, F1 0.3801004612561178, AUC 0.7569753086419754
  Second-Tier acc 0.5, precision 0.5716666666666667, recall 0.5807070707070707, F1 0.4934584934584934, AUC 0.7891414141414143
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.5136752136752136, recall 0.5277777777777778, F1 0.4211793492839244, AUC 0.7371460415441896
  Second-Tier acc 0.46938775510204084, precision 0.5672514619883041, recall 0.5694444444444444, F1 0.4690003483106932, AUC 0.771494708994709
Test AUC: 0.7715, Test F1: 0.4690 (Best Epoch: 8)
Current LR: 2.4287391042385938e-05
epoch: 9 idx: 0 First Loss : 3.55082631111145, Second Loss : 3.5341479778289795
epoch: 9 idx: 200 First Loss : 0.9295411688224667, Second Loss : 0.9367159142840042
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3958333333333333, precision 0.4816849816849817, recall 0.44868686868686875, F1 0.375, AUC 0.758973063973064
  Second-Tier acc 0.5, precision 0.5787899700943179, recall 0.6002020202020203, F1 0.49938423645320196, AUC 0.7858080808080808
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.5324332570556827, recall 0.5313051146384479, F1 0.41882218410520294, AUC 0.7409550754458162
  Second-Tier acc 0.46938775510204084, precision 0.5777777777777777, recall 0.5809082892416225, F1 0.4701632377088767, AUC 0.7775573192239859
Test AUC: 0.7715, Test F1: 0.4690 (Best Epoch: 8)
Current LR: 2.4287391042385938e-05
epoch: 10 idx: 0 First Loss : 3.612628936767578, Second Loss : 3.605269193649292
epoch: 10 idx: 200 First Loss : 0.9246208499746388, Second Loss : 0.9335417130739608
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4375, precision 0.5228902371759515, recall 0.5092929292929292, F1 0.4287694013303769, AUC 0.7652861952861952
  Second-Tier acc 0.5, precision 0.5775803144224197, recall 0.6002020202020203, F1 0.4988562091503268, AUC 0.7901010101010101
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.5474635122410546, recall 0.5529835390946501, F1 0.4437365165087937, AUC 0.7473851165980795
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7869819223985891
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 11 idx: 0 First Loss : 3.66227650642395, Second Loss : 3.6521992683410645
epoch: 11 idx: 200 First Loss : 0.9198126627655876, Second Loss : 0.930522927259146
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4375, precision 0.5299726413305523, recall 0.5231313131313131, F1 0.4347526053785091, AUC 0.766408529741863
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7842929292929294
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.46258503401360546, precision 0.578551912568306, recall 0.5865667254556143, F1 0.4658872378407308, AUC 0.7511635312561239
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7859898589065256
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 12 idx: 0 First Loss : 3.68322491645813, Second Loss : 3.6780712604522705
epoch: 12 idx: 200 First Loss : 0.915136016739662, Second Loss : 0.9272385561475021
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4305555555555556, precision 0.5284820031298905, recall 0.5228956228956229, F1 0.4289554531490016, AUC 0.7628058361391695
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7777272727272727
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5924230867022628, recall 0.6062610229276896, F1 0.4804870229706831, AUC 0.7552848814422889
  Second-Tier acc 0.4897959183673469, precision 0.5893719806763285, recall 0.5868606701940036, F1 0.4864072864072864, AUC 0.7911706349206349
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 13 idx: 0 First Loss : 3.6909372806549072, Second Loss : 3.673323392868042
epoch: 13 idx: 200 First Loss : 0.9105985623399787, Second Loss : 0.923672312070194
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4097222222222222, precision 0.5123433988980207, recall 0.5016161616161616, F1 0.4047879081127163, AUC 0.7589113355780022
  Second-Tier acc 0.3958333333333333, precision 0.49581699346405234, recall 0.47828282828282837, F1 0.38913607712272896, AUC 0.763080808080808
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.46258503401360546, precision 0.5813060179257362, recall 0.5784832451499118, F1 0.46532330866703125, AUC 0.7577344209288656
  Second-Tier acc 0.46938775510204084, precision 0.5708333333333333, recall 0.5451940035273369, F1 0.4622100122100122, AUC 0.7905092592592592
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 14 idx: 0 First Loss : 3.671733856201172, Second Loss : 3.653578758239746
epoch: 14 idx: 200 First Loss : 0.9062846854238757, Second Loss : 0.9206968131220311
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.5142568680588767, recall 0.5024579124579125, F1 0.40368581141528, AUC 0.753428731762065
  Second-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.7493434343434343
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5778331257783312, recall 0.5702527924750148, F1 0.45196477710511834, AUC 0.7584264158338231
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.7895723104056437
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 15 idx: 0 First Loss : 3.6448490619659424, Second Loss : 3.6293067932128906
epoch: 15 idx: 200 First Loss : 0.9027632171564981, Second Loss : 0.9187592801039075
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3819444444444444, precision 0.49037817938420347, recall 0.4693939393939394, F1 0.37386729915465544, AUC 0.7429797979797982
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7374242424242423
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.5668686868686869, recall 0.5421810699588477, F1 0.4270891522247761, AUC 0.75724451303155
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7824625220458555
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 16 idx: 0 First Loss : 3.6164438724517822, Second Loss : 3.5948119163513184
epoch: 16 idx: 200 First Loss : 0.8997618552993529, Second Loss : 0.9170048346213616
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3819444444444444, precision 0.49161255411255406, recall 0.4693939393939394, F1 0.3740842490842491, AUC 0.7334960718294052
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.728030303030303
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.40816326530612246, precision 0.5548293391430646, recall 0.5081569664902998, F1 0.40010162601626015, AUC 0.7532395159709976
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.783344356261023
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 17 idx: 0 First Loss : 3.592405319213867, Second Loss : 3.5612359046936035
epoch: 17 idx: 200 First Loss : 0.8975835616754794, Second Loss : 0.9158845574476882
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.4583762935807844, recall 0.4327272727272727, F1 0.33366282653012846, AUC 0.7231874298540966
  Second-Tier acc 0.3541666666666667, precision 0.4440023577954612, recall 0.42525252525252527, F1 0.3275268817204301, AUC 0.7083838383838383
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4217687074829932, precision 0.5634567901234567, recall 0.5261610817166372, F1 0.4167114058992359, AUC 0.7492835097001763
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7752425044091712
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 18 idx: 0 First Loss : 3.569424867630005, Second Loss : 3.5285370349884033
epoch: 18 idx: 200 First Loss : 0.8961298605152035, Second Loss : 0.9156845282451643
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.4632505175983437, recall 0.441986531986532, F1 0.34193421450204137, AUC 0.7123905723905724
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.42525252525252527, F1 0.3297491039426523, AUC 0.6957070707070708
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4217687074829932, precision 0.5613904098224656, recall 0.5202087007642563, F1 0.4136186037753613, AUC 0.7447518616500098
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7742504409171076
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10)
Current LR: 2.4287391042385938e-05
epoch: 19 idx: 0 First Loss : 3.545459508895874, Second Loss : 3.49487566947937
epoch: 19 idx: 200 First Loss : 0.8946304125581006, Second Loss : 0.9154649879105751
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.4625370784048046, recall 0.441986531986532, F1 0.3419870882211527, AUC 0.7018350168350169
  Second-Tier acc 0.3333333333333333, precision 0.42905982905982903, recall 0.41191919191919196, F1 0.30482384823848235, AUC 0.6925252525252525
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5638882058847635, recall 0.5240299823633157, F1 0.4118196347031963, AUC 0.7429759455222418
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7749669312169312
Test AUC: 0.7870, Test F1: 0.4905 (Best Epoch: 10){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.2562832297003464, "droprate_2": 0.0, "lr": 1.239922235286342e-05, "weight_decay": 9.324606287118721e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.1499180022524432, "droprate_2": 0.0, "lr": 0.0004658797100247109, "weight_decay": 0.0002572535648137262, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0004658797100247109
epoch: 0 idx: 0 First Loss : 1.1533514261245728, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0754708179193944, Second Loss : 1.0779972708788677
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337710437710437
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7426262626262625
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099745247893395
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033179012345679
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004658797100247109
epoch: 1 idx: 0 First Loss : 1.7039610147476196, Second Loss : 1.9961862564086914
epoch: 1 idx: 200 First Loss : 0.9745155465395297, Second Loss : 0.9722682081199997
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7306565656565657
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7354040404040404
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7383646874387614
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7395833333333334
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004658797100247109
epoch: 2 idx: 0 First Loss : 2.1843149662017822, Second Loss : 2.3995769023895264
epoch: 2 idx: 200 First Loss : 0.9442165690052569, Second Loss : 0.9440360135625844
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5694444444444444, precision 0.4444444444444445, recall 0.40404040404040403, F1 0.34920634920634924, AUC 0.7227048260381593
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7289393939393939
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.19014084507042253, recall 0.3333333333333333, F1 0.242152466367713, AUC 0.751843278463649
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7582120811287477
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004658797100247109
epoch: 3 idx: 0 First Loss : 2.5605838298797607, Second Loss : 2.9890711307525635
epoch: 3 idx: 200 First Loss : 0.9046284040130341, Second Loss : 0.9125253593187723
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7293097643097642
  Second-Tier acc 0.6041666666666666, precision 0.42063492063492064, recall 0.4545454545454546, F1 0.4056189640035119, AUC 0.7327777777777778
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.19852941176470587, recall 0.3333333333333333, F1 0.2488479262672811, AUC 0.7515738291201254
  Second-Tier acc 0.5510204081632653, precision 0.19999999999999998, recall 0.3333333333333333, F1 0.25, AUC 0.7528659611992944
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004658797100247109
epoch: 4 idx: 0 First Loss : 2.529787302017212, Second Loss : 3.0559349060058594
epoch: 4 idx: 200 First Loss : 0.8888927732978887, Second Loss : 0.8955151076655631
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6527777777777778, precision 0.43065210195299564, recall 0.5535353535353535, F1 0.48317900033719813, AUC 0.7334960718294052
  Second-Tier acc 0.6875, precision 0.4593406593406593, recall 0.5927272727272728, F1 0.5166666666666667, AUC 0.7417171717171717
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6122448979591837, precision 0.3552469135802469, recall 0.41240446796002356, F1 0.36830341048381277, AUC 0.7385422790515385
  Second-Tier acc 0.6326530612244898, precision 0.37958532695374797, recall 0.44003527336860665, F1 0.4000000000000001, AUC 0.736166225749559
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004658797100247109
epoch: 5 idx: 0 First Loss : 2.509000062942505, Second Loss : 3.074047327041626
epoch: 5 idx: 200 First Loss : 0.8857452640801076, Second Loss : 0.8917751593228004
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4166666666666667, precision 0.3714795008912655, recall 0.4476767676767677, F1 0.3204379718141186, AUC 0.7429910213243547
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7667171717171718
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5034013605442177, precision 0.44447336456706577, recall 0.4611992945326278, F1 0.3676484338475923, AUC 0.7421063590045072
  Second-Tier acc 0.5510204081632653, precision 0.46296296296296297, recall 0.49382716049382713, F1 0.4033333333333333, AUC 0.752094356261023
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 6 idx: 0 First Loss : 2.5872457027435303, Second Loss : 3.013923406600952
epoch: 6 idx: 200 First Loss : 0.8848925967242068, Second Loss : 0.8893640162747595
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4027777777777778, precision 0.3742690058479532, recall 0.4444444444444444, F1 0.30839002267573695, AUC 0.6980415263748597
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7187373737373738
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46938775510204084, precision 0.43907563025210083, recall 0.4444444444444444, F1 0.33905065815715996, AUC 0.6946036645110718
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6913029100529101
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 7 idx: 0 First Loss : 2.4912853240966797, Second Loss : 3.0553858280181885
epoch: 7 idx: 200 First Loss : 0.8767145442920019, Second Loss : 0.8820729200978443
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.3742690058479532, recall 0.4444444444444444, F1 0.30839002267573695, AUC 0.6855218855218855
  Second-Tier acc 0.4375, precision 0.3796296296296296, recall 0.4666666666666666, F1 0.3362085489745064, AUC 0.7084848484848485
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4965986394557823, precision 0.4446557971014493, recall 0.46090534979423864, F1 0.36123480450181306, AUC 0.6779712913972172
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6737213403880071
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 8 idx: 0 First Loss : 2.7971115112304688, Second Loss : 3.191671133041382
epoch: 8 idx: 200 First Loss : 0.8855577599400868, Second Loss : 0.8899166469800457
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4444444444444444, precision 0.3888888888888889, recall 0.4711111111111111, F1 0.34221455498051245, AUC 0.6814365881032547
  Second-Tier acc 0.4791666666666667, precision 0.39355742296918766, recall 0.49333333333333335, F1 0.3680911680911681, AUC 0.7026262626262626
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4965986394557823, precision 0.4048286604361371, recall 0.44944150499706054, F1 0.3618244679867621, AUC 0.676868998628258
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6630291005291006
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 9 idx: 0 First Loss : 2.7090253829956055, Second Loss : 3.6791248321533203
epoch: 9 idx: 200 First Loss : 0.8975160019362197, Second Loss : 0.904516474538441
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.37691502521648107, recall 0.4488888888888889, F1 0.3142069440854656, AUC 0.6728843995510662
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6900505050505051
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.44188034188034186, recall 0.45267489711934156, F1 0.35027480310499176, AUC 0.6726741622574955
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6625330687830687
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 10 idx: 0 First Loss : 2.6265928745269775, Second Loss : 2.992612361907959
epoch: 10 idx: 200 First Loss : 0.8783599115718175, Second Loss : 0.8859355471673797
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.36562203228869894, recall 0.43111111111111117, F1 0.29045751633986927, AUC 0.6597306397306397
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.685
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.48299319727891155, precision 0.44188034188034186, recall 0.45267489711934156, F1 0.35027480310499176, AUC 0.6744500783852635
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6746582892416226
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 11 idx: 0 First Loss : 3.1105825901031494, Second Loss : 3.191445827484131
epoch: 11 idx: 200 First Loss : 0.8842869118575368, Second Loss : 0.896135967678914
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4166666666666667, precision 0.37946428571428575, recall 0.4533333333333333, F1 0.31994843699645503, AUC 0.6694893378226711
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7019191919191918
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5034013605442177, precision 0.42976190476190473, recall 0.46502057613168724, F1 0.3657262277951933, AUC 0.668987605330198
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6879409171075838
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 12 idx: 0 First Loss : 2.779113531112671, Second Loss : 3.1266062259674072
epoch: 12 idx: 200 First Loss : 0.8749032925095627, Second Loss : 0.88258397000302
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.3579059829059829, recall 0.4177777777777778, F1 0.2746127946127946, AUC 0.6618799102132435
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6851515151515152
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.48299319727891155, precision 0.5775689223057644, recall 0.47222222222222215, F1 0.3906018056603315, AUC 0.6694591416813639
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6781856261022927
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 13 idx: 0 First Loss : 2.9680538177490234, Second Loss : 3.334812879562378
epoch: 13 idx: 200 First Loss : 0.8918196880147128, Second Loss : 0.9016552731323528
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4583333333333333, precision 0.438507529405191, recall 0.4735016835016835, F1 0.37024967369794953, AUC 0.6714421997755332
  Second-Tier acc 0.4166666666666667, precision 0.4047619047619048, recall 0.4533333333333333, F1 0.3308488612836439, AUC 0.6856060606060607
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5034013605442177, precision 0.4649843311891802, recall 0.46928277483833036, F1 0.40828589500316254, AUC 0.6810454634528709
  Second-Tier acc 0.5306122448979592, precision 0.4271284271284271, recall 0.48148148148148145, F1 0.39370351150320015, AUC 0.6887676366843034
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5)
Current LR: 0.0004658797100247109
epoch: 14 idx: 0 First Loss : 3.1632792949676514, Second Loss : 3.5268056392669678
epoch: 14 idx: 200 First Loss : 0.8782365326271555, Second Loss : 0.8867660749859879
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4375, precision 0.37659574468085105, recall 0.4553535353535354, F1 0.3482369051694625, AUC 0.6765039281705949
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.6976767676767676
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5238095238095238, precision 0.5428861788617886, recall 0.5130805408583187, F1 0.4730750124192747, AUC 0.6816639721732315
  Second-Tier acc 0.5510204081632653, precision 0.6372549019607843, recall 0.5524691358024691, F1 0.49853801169590645, AUC 0.6872795414462081
Test AUC: 0.7521, Test F1: 0.4033 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.2390057849411075, "droprate_2": 0.0, "lr": 8.278505774560614e-05, "weight_decay": 1.1856804192161619e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1583240032196045, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1194060175350649, Second Loss : 1.1136343485087306
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7597362514029179
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.737929292929293{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.0945054108015339, "droprate_2": 0.0, "lr": 5.006621886601801e-05, "weight_decay": 2.6822701041409034e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1367326974868774, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.1139428259721442, Second Loss : 1.1178901066530997{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.0918498466981484, "droprate_2": 0.0, "lr": 6.09319994078689e-05, "weight_decay": 0.0005968359851684867, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.23378783749215937, "droprate_2": 0.0, "lr": 0.0009205918649944789, "weight_decay": 2.766315719308929e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.2804500365414692, "droprate_2": 0.0, "lr": 0.00015100885315281847, "weight_decay": 1.4521226104379745e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.030602428597796993, "droprate_2": 0.0, "lr": 0.0005172805805744846, "weight_decay": 6.46199712295415e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.22174106712255615, "droprate_2": 0.0, "lr": 0.0001438769126741482, "weight_decay": 0.0003553798417181499, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.160300612449646, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.092882120082924, Second Loss : 1.090984763531246{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.2848994607391652, "droprate_2": 0.0, "lr": 1.6297059797320202e-05, "weight_decay": 0.000805299448462896, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1196296215057373, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.075473933522381, Second Loss : 1.071502797639192
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7132733585858585
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7023232323232325
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6238047012786596
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6259920634920634
epoch: 1 idx: 0 First Loss : 1.979123830795288, Second Loss : 1.9645824432373047
epoch: 1 idx: 200 First Loss : 1.098425210560139, Second Loss : 1.097494132853859
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7322411616161616
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.725050505050505
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6691227127425045
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6694223985890653
epoch: 2 idx: 0 First Loss : 2.0644009113311768, Second Loss : 2.0360279083251953
epoch: 2 idx: 200 First Loss : 1.0761028764704568, Second Loss : 1.0812900276919502
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7428156565656566
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7464646464646466
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6926187720458555
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.691247795414462
epoch: 3 idx: 0 First Loss : 2.1606926918029785, Second Loss : 2.128601551055908
epoch: 3 idx: 200 First Loss : 1.0556663510885405, Second Loss : 1.0666531913760882
  First-Tier acc 0.5364583333333334, precision 0.5097001763668431, recall 0.356060606060606, F1 0.27323369898647815, AUC 0.7408017676767676
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7503030303030304
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7046819885361552
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7062389770723104
epoch: 4 idx: 0 First Loss : 2.262906551361084, Second Loss : 2.2435264587402344
epoch: 4 idx: 200 First Loss : 1.0350840037586677, Second Loss : 1.0489553290220042
  First-Tier acc 0.5729166666666666, precision 0.4664088239507234, recall 0.41333333333333333, F1 0.3652141105451802, AUC 0.7399084595959596
  Second-Tier acc 0.5416666666666666, precision 0.5185185185185185, recall 0.3636363636363636, F1 0.29365079365079366, AUC 0.7436868686868686
  First-Tier acc 0.5612244897959183, precision 0.5218150087260035, recall 0.3541666666666667, F1 0.28001836185979406, AUC 0.7098386518959435
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7061838624338624
epoch: 5 idx: 0 First Loss : 2.3974978923797607, Second Loss : 2.38053035736084
epoch: 5 idx: 200 First Loss : 1.0124915058525343, Second Loss : 1.0273663528374772
  First-Tier acc 0.6197916666666666, precision 0.6584718149234279, recall 0.49234848484848487, F1 0.46260210377857436, AUC 0.7410763888888888
  Second-Tier acc 0.5833333333333334, precision 0.5333333333333333, recall 0.4336363636363636, F1 0.4085470085470086, AUC 0.7466161616161616
  First-Tier acc 0.6530612244897959, precision 0.6863466253710157, recall 0.51168430335097, F1 0.5238070551369783, AUC 0.7055362654320988
  Second-Tier acc 0.6530612244897959, precision 0.4523809523809524, recall 0.5416666666666666, F1 0.4830917874396135, AUC 0.7159942680776012
epoch: 6 idx: 0 First Loss : 2.5459389686584473, Second Loss : 2.538689136505127
epoch: 6 idx: 200 First Loss : 0.9914540775231461, Second Loss : 1.0053639030501025
  First-Tier acc 0.6875, precision 0.6820477502295684, recall 0.6173737373737375, F1 0.5832310760027609, AUC 0.7387689393939394
  Second-Tier acc 0.6458333333333334, precision 0.6055555555555555, recall 0.5534343434343435, F1 0.5624183006535948, AUC 0.7484343434343433
  First-Tier acc 0.6173469387755102, precision 0.5809007506255213, recall 0.5827821869488536, F1 0.5817386914161108, AUC 0.7009479717813051
  Second-Tier acc 0.4897959183673469, precision 0.4110704110704111, recall 0.4658289241622575, F1 0.42332264399532654, AUC 0.7016644620811286
epoch: 7 idx: 0 First Loss : 2.694678783416748, Second Loss : 2.7033398151397705
epoch: 7 idx: 200 First Loss : 0.9728562971994058, Second Loss : 0.985159002800486
  First-Tier acc 0.625, precision 0.5974370833989399, recall 0.6098737373737374, F1 0.5835211085211085, AUC 0.745
  Second-Tier acc 0.6666666666666666, precision 0.6554792779049071, recall 0.6245454545454545, F1 0.6143000210837023, AUC 0.7517171717171717
  First-Tier acc 0.5867346938775511, precision 0.558207095547249, recall 0.597718253968254, F1 0.5679026578696856, AUC 0.7033144565696648
  Second-Tier acc 0.5306122448979592, precision 0.4954248366013072, recall 0.5427689594356261, F1 0.4895144571740316, AUC 0.7166005291005292
epoch: 8 idx: 0 First Loss : 2.8338348865509033, Second Loss : 2.8597521781921387
epoch: 8 idx: 200 First Loss : 0.9581045036329262, Second Loss : 0.9685330526041451
  First-Tier acc 0.5885416666666666, precision 0.5893939393939395, recall 0.6124494949494951, F1 0.5735364243521788, AUC 0.752957702020202
  Second-Tier acc 0.5208333333333334, precision 0.5287179487179486, recall 0.5431313131313131, F1 0.4864187495766443, AUC 0.7647979797979798
  First-Tier acc 0.5561224489795918, precision 0.5511011301072153, recall 0.6085207231040565, F1 0.549963924963925, AUC 0.7093942901234568
  Second-Tier acc 0.5306122448979592, precision 0.507177033492823, recall 0.5720899470899471, F1 0.4968974771873323, AUC 0.7240961199294533
epoch: 9 idx: 0 First Loss : 2.9569056034088135, Second Loss : 3.0005738735198975
epoch: 9 idx: 200 First Loss : 0.9477360939968433, Second Loss : 0.9566123838263068
  First-Tier acc 0.53125, precision 0.5720983632517788, recall 0.5866161616161616, F1 0.528303442589157, AUC 0.7582575757575758
  Second-Tier acc 0.5208333333333334, precision 0.5608080808080808, recall 0.5601010101010101, F1 0.49932541236889066, AUC 0.7755555555555556
  First-Tier acc 0.5204081632653061, precision 0.5320452073853841, recall 0.5913800705467372, F1 0.5179837977908878, AUC 0.7162905092592592
  Second-Tier acc 0.4897959183673469, precision 0.49621489621489623, recall 0.5767195767195767, F1 0.4731496685519674, AUC 0.7322530864197532{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.08414102599055034, "droprate_2": 0.0, "lr": 0.0006318163263400628, "weight_decay": 7.724872232320408e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 9, "gamma": 0.16489630044439343, "T_max": 36, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.088794469833374, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0904398055293074, Second Loss : 1.0846383541229352
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7256060606060606
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337878787878788
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7123601466049383
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7261904761904763
epoch: 1 idx: 0 First Loss : 1.994504690170288, Second Loss : 2.019054651260376
epoch: 1 idx: 200 First Loss : 0.9763115164800663, Second Loss : 0.9745365482064622
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6972506313131314
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7014141414141414
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6863632605820106
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7023809523809524
epoch: 2 idx: 0 First Loss : 2.35477876663208, Second Loss : 2.299912214279175
epoch: 2 idx: 200 First Loss : 0.9460578998967782, Second Loss : 0.9436724449864667
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6808459595959596
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6986868686868686
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6714444168871253
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7083884479717814
epoch: 3 idx: 0 First Loss : 2.567045211791992, Second Loss : 2.498472213745117
epoch: 3 idx: 200 First Loss : 0.9332771897315979, Second Loss : 0.9290146423661294{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.01641432690045762, "droprate_2": 0.0, "lr": 0.0001336629672945697, "weight_decay": 3.2062301437692394e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 16, "gamma": 0.422550693620232, "T_max": 3, "patience": 4, "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.089744210243225, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1010294675604622, Second Loss : 1.0935884287478912
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7527272727272726
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7545454545454545
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.712773506393298
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7124669312169312
epoch: 1 idx: 0 First Loss : 1.7105953693389893, Second Loss : 1.9828401803970337
epoch: 1 idx: 200 First Loss : 0.9958534291134545, Second Loss : 0.9901047966521771
  First-Tier acc 0.5677083333333334, precision 0.4290018832391714, recall 0.41, F1 0.36015419445634217, AUC 0.738996212121212
  Second-Tier acc 0.5416666666666666, precision 0.5904761904761905, recall 0.378080808080808, F1 0.33357721197931905, AUC 0.7481313131313131
  First-Tier acc 0.5612244897959183, precision 0.3005847953216374, recall 0.3452380952380953, F1 0.2631161145991196, AUC 0.7078235229276896
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.712742504409171
epoch: 2 idx: 0 First Loss : 2.178339719772339, Second Loss : 2.2746920585632324
epoch: 2 idx: 200 First Loss : 0.9533714387399047, Second Loss : 0.947379629447389
  First-Tier acc 0.6354166666666666, precision 0.6135795135795136, recall 0.584040404040404, F1 0.5420823760891124, AUC 0.7423863636363636
  Second-Tier acc 0.6666666666666666, precision 0.6174382716049382, recall 0.5786868686868688, F1 0.5737179487179488, AUC 0.749141414141414
  First-Tier acc 0.5816326530612245, precision 0.5277466105656848, recall 0.5209986772486772, F1 0.5144172187192381, AUC 0.7129319609788359
  Second-Tier acc 0.4897959183673469, precision 0.43390425999121646, recall 0.4772927689594357, F1 0.4382608695652174, AUC 0.7273478835978836
epoch: 3 idx: 0 First Loss : 2.2163097858428955, Second Loss : 2.199925661087036
epoch: 3 idx: 200 First Loss : 0.9128265719286245, Second Loss : 0.9055226612372778
  First-Tier acc 0.6354166666666666, precision 0.6135795135795136, recall 0.584040404040404, F1 0.5420823760891124, AUC 0.7423863636363636
  Second-Tier acc 0.6666666666666666, precision 0.6174382716049382, recall 0.5786868686868688, F1 0.5737179487179488, AUC 0.749141414141414
  First-Tier acc 0.5816326530612245, precision 0.5277466105656848, recall 0.5209986772486772, F1 0.5144172187192381, AUC 0.7129319609788359
  Second-Tier acc 0.4897959183673469, precision 0.43390425999121646, recall 0.4772927689594357, F1 0.4382608695652174, AUC 0.7273478835978836
epoch: 4 idx: 0 First Loss : 2.2163097858428955, Second Loss : 2.199925661087036
epoch: 4 idx: 200 First Loss : 0.9216424260492349, Second Loss : 0.9159095285840295
  First-Tier acc 0.5572916666666666, precision 0.5774382192039238, recall 0.602020202020202, F1 0.5533910533910534, AUC 0.7522569444444445
  Second-Tier acc 0.5, precision 0.5349650349650349, recall 0.5297979797979798, F1 0.469076732234627, AUC 0.7550505050505051
  First-Tier acc 0.5357142857142857, precision 0.5381288402457757, recall 0.5904431216931217, F1 0.5284185365828117, AUC 0.7099351025132274
  Second-Tier acc 0.5102040816326531, precision 0.4993775287892935, recall 0.5597442680776014, F1 0.48684648684648685, AUC 0.7282848324514991
epoch: 5 idx: 0 First Loss : 2.588813066482544, Second Loss : 2.5333058834075928
epoch: 5 idx: 200 First Loss : 0.9436831964152073, Second Loss : 0.9347556610475873
  First-Tier acc 0.4739583333333333, precision 0.5253611147234625, recall 0.49704545454545457, F1 0.43514612872778047, AUC 0.7509974747474747
  Second-Tier acc 0.5625, precision 0.5990740740740741, recall 0.584949494949495, F1 0.5468253968253968, AUC 0.77989898989899
  First-Tier acc 0.5, precision 0.5370286348054043, recall 0.5006062610229277, F1 0.4764756505011643, AUC 0.7185192074514992
  Second-Tier acc 0.5510204081632653, precision 0.5579322638146168, recall 0.5831128747795414, F1 0.5488215488215488, AUC 0.722773368606702
epoch: 6 idx: 0 First Loss : 3.658287286758423, Second Loss : 3.613067150115967
epoch: 6 idx: 200 First Loss : 0.9569920999512299, Second Loss : 0.9404598842768823
  First-Tier acc 0.484375, precision 0.5358661887694146, recall 0.5134595959595959, F1 0.43292929292929294, AUC 0.7590656565656566
  Second-Tier acc 0.5208333333333334, precision 0.5208333333333334, recall 0.5293939393939394, F1 0.48281068524970966, AUC 0.802070707070707
  First-Tier acc 0.4846938775510204, precision 0.5141382868937049, recall 0.47222222222222227, F1 0.4443822843822844, AUC 0.7235070822310407
  Second-Tier acc 0.5918367346938775, precision 0.5813397129186603, recall 0.5899470899470899, F1 0.5692431561996779, AUC 0.7238756613756614
epoch: 7 idx: 0 First Loss : 4.162395477294922, Second Loss : 4.105888366699219
epoch: 7 idx: 200 First Loss : 0.938237844482157, Second Loss : 0.91893449852206
  First-Tier acc 0.4010416666666667, precision 0.48050566145324214, recall 0.4637373737373738, F1 0.3660388992262673, AUC 0.7390814393939394
  Second-Tier acc 0.4375, precision 0.4857142857142857, recall 0.4785858585858586, F1 0.402974802974803, AUC 0.7783838383838383
  First-Tier acc 0.4489795918367347, precision 0.51427732079906, recall 0.47547398589065254, F1 0.42045439268669754, AUC 0.7138757991622575
  Second-Tier acc 0.5102040816326531, precision 0.5179434092477571, recall 0.5405643738977072, F1 0.49237530213139974, AUC 0.7393077601410933
epoch: 8 idx: 0 First Loss : 3.811941623687744, Second Loss : 3.941409111022949
epoch: 8 idx: 200 First Loss : 0.8989140289217067, Second Loss : 0.8837535329075039
  First-Tier acc 0.3229166666666667, precision 0.4141368144100384, recall 0.4137373737373738, F1 0.28992779773590643, AUC 0.7022979797979798
  Second-Tier acc 0.3125, precision 0.3914141414141414, recall 0.40111111111111114, F1 0.26461769115442274, AUC 0.733939393939394
  First-Tier acc 0.3673469387755102, precision 0.5228070175438596, recall 0.43788580246913583, F1 0.3447196280574085, AUC 0.6905623070987654
  Second-Tier acc 0.46938775510204084, precision 0.5545977011494253, recall 0.5094797178130511, F1 0.4384274640088594, AUC 0.7552358906525574
epoch: 9 idx: 0 First Loss : 2.825888156890869, Second Loss : 3.0211920738220215
epoch: 9 idx: 200 First Loss : 0.8639472300135785, Second Loss : 0.8458952912574272
  First-Tier acc 0.3229166666666667, precision 0.4141368144100384, recall 0.4137373737373738, F1 0.28992779773590643, AUC 0.7022979797979798
  Second-Tier acc 0.3125, precision 0.3914141414141414, recall 0.40111111111111114, F1 0.26461769115442274, AUC 0.733939393939394
  First-Tier acc 0.3673469387755102, precision 0.5228070175438596, recall 0.43788580246913583, F1 0.3447196280574085, AUC 0.6905623070987654
  Second-Tier acc 0.46938775510204084, precision 0.5545977011494253, recall 0.5094797178130511, F1 0.4384274640088594, AUC 0.7552358906525574{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.25497401882095644, "droprate_2": 0.0, "lr": 0.0003941150783234803, "weight_decay": 0.00024997131276062294, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1123074293136597, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0862512569967193, Second Loss : 1.0763163456869362
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7341066919191919
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7387373737373736
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6861979166666666
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.701113315696649
epoch: 1 idx: 0 First Loss : 2.0679454803466797, Second Loss : 2.0623183250427246
epoch: 1 idx: 200 First Loss : 0.9917669654337328, Second Loss : 0.9730188589339233
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7194065656565657
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7255050505050505
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7475577325837742
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7404651675485008
epoch: 2 idx: 0 First Loss : 2.1698355674743652, Second Loss : 2.1410703659057617
epoch: 2 idx: 200 First Loss : 0.9584063018917741, Second Loss : 0.9449072315621732
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7014962121212122
  Second-Tier acc 0.5625, precision 0.40740740740740744, recall 0.393939393939394, F1 0.3333333333333333, AUC 0.7022222222222222
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6878134645061729
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7014991181657848
epoch: 3 idx: 0 First Loss : 3.391749382019043, Second Loss : 2.9472827911376953
epoch: 3 idx: 200 First Loss : 0.9531267210285166, Second Loss : 0.937083796834323
  First-Tier acc 0.4375, precision 0.3607085346215781, recall 0.4581818181818182, F1 0.3356643356643357, AUC 0.6528345959595959
  Second-Tier acc 0.4166666666666667, precision 0.3361344537815126, recall 0.43636363636363634, F1 0.3190883190883191, AUC 0.6673232323232323
  First-Tier acc 0.4846938775510204, precision 0.3703962703962704, recall 0.4193121693121693, F1 0.3531083920405389, AUC 0.6784508652998236
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6925154320987654
epoch: 4 idx: 0 First Loss : 4.029036045074463, Second Loss : 3.900038957595825
epoch: 4 idx: 200 First Loss : 0.9480318401150164, Second Loss : 0.9259278765064085
  First-Tier acc 0.4270833333333333, precision 0.3700109414395129, recall 0.4515151515151515, F1 0.3287035375468064, AUC 0.6773674242424242
  Second-Tier acc 0.4583333333333333, precision 0.3541666666666667, recall 0.46303030303030307, F1 0.3501607109094347, AUC 0.7148989898989898
  First-Tier acc 0.47959183673469385, precision 0.3841137616222811, recall 0.427689594356261, F1 0.34996114996114996, AUC 0.6413552689594356
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.642361111111111
epoch: 5 idx: 0 First Loss : 4.161238670349121, Second Loss : 4.35894775390625
epoch: 5 idx: 200 First Loss : 0.9332913809359787, Second Loss : 0.9116103311175879
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6747001262626263
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7243939393939393
  First-Tier acc 0.45918367346938777, precision 0.4223419892209701, recall 0.43253968253968256, F1 0.33227939062949124, AUC 0.673766121031746
  Second-Tier acc 0.46938775510204084, precision 0.3761904761904762, recall 0.42151675485008816, F1 0.3421270947403352, AUC 0.6860119047619048
epoch: 6 idx: 0 First Loss : 3.7726478576660156, Second Loss : 3.9220058917999268
epoch: 6 idx: 200 First Loss : 0.9234720376483512, Second Loss : 0.9044523516007287
  First-Tier acc 0.359375, precision 0.37733587194132995, recall 0.4166666666666667, F1 0.2709058907238887, AUC 0.6619791666666667
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7042424242424242
  First-Tier acc 0.4489795918367347, precision 0.43775175063518623, recall 0.43209876543209874, F1 0.3217720781113378, AUC 0.681819747574956
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6943342151675486
epoch: 7 idx: 0 First Loss : 3.5077786445617676, Second Loss : 3.9623920917510986
epoch: 7 idx: 200 First Loss : 0.9184865942051106, Second Loss : 0.9029970627483119
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6617550505050506
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7010606060606062
  First-Tier acc 0.4642857142857143, precision 0.4407407407407407, recall 0.441358024691358, F1 0.33487654320987653, AUC 0.7002314814814815
  Second-Tier acc 0.46938775510204084, precision 0.42280701754385963, recall 0.4444444444444444, F1 0.34164934164934163, AUC 0.6940035273368608
epoch: 8 idx: 0 First Loss : 3.4325430393218994, Second Loss : 4.025527477264404
epoch: 8 idx: 200 First Loss : 0.9166341426439725, Second Loss : 0.9080259230611059
  First-Tier acc 0.3958333333333333, precision 0.3829119442022668, recall 0.44, F1 0.3031214466493049, AUC 0.6682228535353536
  Second-Tier acc 0.4375, precision 0.4911764705882353, recall 0.48111111111111104, F1 0.37605820105820104, AUC 0.7065151515151515
  First-Tier acc 0.47959183673469385, precision 0.42937319695777604, recall 0.4506172839506173, F1 0.3469576004325838, AUC 0.703280009920635
  Second-Tier acc 0.5102040816326531, precision 0.5525252525252525, recall 0.5277777777777778, F1 0.45598181768394525, AUC 0.724371693121693
epoch: 9 idx: 0 First Loss : 3.431086540222168, Second Loss : 3.8667304515838623
epoch: 9 idx: 200 First Loss : 0.9144852235407942, Second Loss : 0.9156957139459146
  First-Tier acc 0.359375, precision 0.37959950842188966, recall 0.4166666666666667, F1 0.27369814539020637, AUC 0.6659974747474747
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.711010101010101
  First-Tier acc 0.42857142857142855, precision 0.5305383022774327, recall 0.43154761904761907, F1 0.33563748079877115, AUC 0.7008652998236332
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7290564373897709{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_3", "train_show_freq": 200, "droprate": 0.16755070211433454, "droprate_2": 0.0, "lr": 2.8369711534926223e-05, "weight_decay": 0.00013762698832229733, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "none", "step_size": 6, "gamma": 0.2506418346168021, "T_max": 19, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_3", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0834789276123047, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.114380051173381, Second Loss : 1.1063029850596813
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7298106060606061
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7194444444444444
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6527915564373897
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.646439594356261
epoch: 1 idx: 0 First Loss : 1.9969905614852905, Second Loss : 2.0550098419189453
epoch: 1 idx: 200 First Loss : 1.085028170056604, Second Loss : 1.0829650182925648
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444286616161616
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7434848484848485
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6941447585978837
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6901455026455027
epoch: 2 idx: 0 First Loss : 2.133727788925171, Second Loss : 2.173872232437134
epoch: 2 idx: 200 First Loss : 1.0457117072681883, Second Loss : 1.050443633204669
  First-Tier acc 0.5625, precision 0.43890560091677405, recall 0.4024242424242424, F1 0.3511287178519776, AUC 0.740261994949495
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.7437878787878788
  First-Tier acc 0.5561224489795918, precision 0.23315602836879434, recall 0.33928571428571425, F1 0.2536599099099099, AUC 0.6985918209876543
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.6950507054673721
epoch: 3 idx: 0 First Loss : 2.311812400817871, Second Loss : 2.3619565963745117
epoch: 3 idx: 200 First Loss : 1.0111014977171646, Second Loss : 1.0186310293736742
  First-Tier acc 0.6822916666666666, precision 0.6752063492063493, recall 0.6032070707070708, F1 0.5545946645946647, AUC 0.7384122474747475
  Second-Tier acc 0.6666666666666666, precision 0.6333333333333333, recall 0.5548484848484848, F1 0.562962962962963, AUC 0.7483333333333334
  First-Tier acc 0.576530612244898, precision 0.5603194619588062, recall 0.4790564373897707, F1 0.49285271893967547, AUC 0.6852230764991182
  Second-Tier acc 0.5714285714285714, precision 0.5180541042610008, recall 0.5381393298059964, F1 0.5175711016672114, AUC 0.6830357142857143
epoch: 4 idx: 0 First Loss : 2.5550975799560547, Second Loss : 2.621417284011841
epoch: 4 idx: 200 First Loss : 0.9808561454216639, Second Loss : 0.9864875187179936
  First-Tier acc 0.609375, precision 0.5829461866047232, recall 0.5939141414141414, F1 0.5556379360727187, AUC 0.7458238636363635
  Second-Tier acc 0.6041666666666666, precision 0.5936507936507937, recall 0.5701010101010101, F1 0.5611916264090177, AUC 0.7479797979797981
  First-Tier acc 0.5816326530612245, precision 0.5660087719298246, recall 0.5987654320987654, F1 0.5711727201088903, AUC 0.6981302358906526
  Second-Tier acc 0.5102040816326531, precision 0.4646464646464646, recall 0.5011022927689593, F1 0.4651787136259186, AUC 0.6999559082892416
epoch: 5 idx: 0 First Loss : 2.8137454986572266, Second Loss : 2.908536911010742
epoch: 5 idx: 200 First Loss : 0.9588539139437142, Second Loss : 0.9619675694005703
  First-Tier acc 0.5677083333333334, precision 0.590315068457145, recall 0.6086868686868687, F1 0.562044849784633, AUC 0.7578125
  Second-Tier acc 0.5416666666666666, precision 0.5734343434343434, recall 0.5734343434343434, F1 0.5176085176085176, AUC 0.7608080808080807
  First-Tier acc 0.5408163265306123, precision 0.5448944674488153, recall 0.6037257495590829, F1 0.5354873294346979, AUC 0.713100749559083
  Second-Tier acc 0.4897959183673469, precision 0.4721444133208839, recall 0.5180776014109347, F1 0.4626455026455026, AUC 0.7236000881834216
epoch: 6 idx: 0 First Loss : 3.021299123764038, Second Loss : 3.148674726486206
epoch: 6 idx: 200 First Loss : 0.946403012986281, Second Loss : 0.9462778539077115
  First-Tier acc 0.5260416666666666, precision 0.5779557796851432, recall 0.5867171717171717, F1 0.5260996539547681, AUC 0.7639425505050506
  Second-Tier acc 0.5416666666666666, precision 0.5814982119329946, recall 0.5904040404040404, F1 0.5280423280423281, AUC 0.7842424242424242
  First-Tier acc 0.47959183673469385, precision 0.5106739665563195, recall 0.5654210758377425, F1 0.4780137896974965, AUC 0.7255497685185185
  Second-Tier acc 0.4489795918367347, precision 0.4680451127819549, recall 0.5227072310405644, F1 0.4405901836796146, AUC 0.7277336860670194
epoch: 7 idx: 0 First Loss : 3.1844284534454346, Second Loss : 3.3353538513183594
epoch: 7 idx: 200 First Loss : 0.9398795907056673, Second Loss : 0.9364097865103785
  First-Tier acc 0.4583333333333333, precision 0.5334846313107183, recall 0.518560606060606, F1 0.4581962040677637, AUC 0.7673074494949494
  Second-Tier acc 0.5208333333333334, precision 0.5708333333333333, recall 0.577070707070707, F1 0.5105716360618321, AUC 0.8070707070707072
  First-Tier acc 0.4897959183673469, precision 0.5333590297050056, recall 0.5846560846560847, F1 0.48907526881720426, AUC 0.732204861111111
  Second-Tier acc 0.46938775510204084, precision 0.489573607220666, recall 0.5465167548500882, F1 0.4658758498254958, AUC 0.7353395061728395
epoch: 8 idx: 0 First Loss : 3.2994236946105957, Second Loss : 3.473238468170166
epoch: 8 idx: 200 First Loss : 0.9361249418669746, Second Loss : 0.9295085710357522
  First-Tier acc 0.4270833333333333, precision 0.5121706250738508, recall 0.49133838383838385, F1 0.4271954071937308, AUC 0.7640782828282827
  Second-Tier acc 0.5, precision 0.5605042016806723, recall 0.5518181818181818, F1 0.4961038961038961, AUC 0.8134848484848485
  First-Tier acc 0.4846938775510204, precision 0.5404746734628864, recall 0.5844356261022928, F1 0.48506083474511014, AUC 0.7350019290123457
  Second-Tier acc 0.5102040816326531, precision 0.544551282051282, recall 0.5941358024691358, F1 0.5150326797385621, AUC 0.736221340388007
epoch: 9 idx: 0 First Loss : 3.365652561187744, Second Loss : 3.572190761566162
epoch: 9 idx: 200 First Loss : 0.9332829089487777, Second Loss : 0.9234887304488774
  First-Tier acc 0.4375, precision 0.5196419089340236, recall 0.5090151515151515, F1 0.4382738549618321, AUC 0.7589930555555555
  Second-Tier acc 0.5208333333333334, precision 0.5838468720821662, recall 0.5846464646464646, F1 0.5220032840722496, AUC 0.8181818181818182
  First-Tier acc 0.45918367346938777, precision 0.5382090951711204, recall 0.564539241622575, F1 0.46052660329946465, AUC 0.7365141369047619
  Second-Tier acc 0.4897959183673469, precision 0.5369663016721841, recall 0.5932539682539683, F1 0.4969423558897243, AUC 0.7328593474426809