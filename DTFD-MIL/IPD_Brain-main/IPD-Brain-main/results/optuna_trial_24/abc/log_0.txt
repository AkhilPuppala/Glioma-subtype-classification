{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_24", "train_show_freq": 200, "droprate": 0.3481349548206174, "droprate_2": 0.0, "lr": 1.0260782276543651e-05, "weight_decay": 5.040968814200792e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_24", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0260782276543651e-05
epoch: 0 idx: 0 First Loss : 1.2253209352493286, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0548559547360263, Second Loss : 1.0363134841124217
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6635016835016835
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7507575757575758
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6021825396825397
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.607473544973545
Test AUC: 0.6075, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0260782276543651e-05
epoch: 1 idx: 0 First Loss : 1.9695677757263184, Second Loss : 1.9106526374816895
epoch: 1 idx: 200 First Loss : 1.1022726079421257, Second Loss : 1.089011924851
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.704320987654321
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7587878787878788
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6457292279051537
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6541005291005291
Test AUC: 0.6541, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0260782276543651e-05
epoch: 2 idx: 0 First Loss : 2.124957799911499, Second Loss : 2.0784242153167725
epoch: 2 idx: 200 First Loss : 1.1016373482361361, Second Loss : 1.087443254183774
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7205611672278339
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7605555555555555
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.675760582010582
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6887125220458553
Test AUC: 0.6887, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0260782276543651e-05
epoch: 3 idx: 0 First Loss : 2.1786859035491943, Second Loss : 2.1356399059295654
epoch: 3 idx: 200 First Loss : 1.090724525018711, Second Loss : 1.0768278591075346
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7324186307519641
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7664646464646466
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6934768763472468
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.703097442680776
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 4 idx: 0 First Loss : 2.2469990253448486, Second Loss : 2.195143461227417
epoch: 4 idx: 200 First Loss : 1.080030042659584, Second Loss : 1.0663076387115973
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7407014590347923
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.761010101010101
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7034220066627475
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7102072310405644
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 5 idx: 0 First Loss : 2.319666624069214, Second Loss : 2.2591447830200195
epoch: 5 idx: 200 First Loss : 1.069248266258643, Second Loss : 1.0561092175283835
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7409988776655444
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.751919191919192
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7113707622966882
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7145061728395062
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 6 idx: 0 First Loss : 2.402158498764038, Second Loss : 2.3292086124420166
epoch: 6 idx: 200 First Loss : 1.0565320465398664, Second Loss : 1.0438907420383163
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7381986531986531
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7507070707070707
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7133120223398001
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7143408289241622
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 7 idx: 0 First Loss : 2.493880271911621, Second Loss : 2.414747476577759
epoch: 7 idx: 200 First Loss : 1.042738497479638, Second Loss : 1.0305025191301138
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5833333333333334, precision 0.39837037037037043, recall 0.43555555555555553, F1 0.38712418300653595, AUC 0.7351515151515152
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7515656565656567
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6054421768707483, precision 0.6444444444444445, recall 0.42658730158730157, F1 0.40277777777777773, AUC 0.70814961787184
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7094356261022927
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 8 idx: 0 First Loss : 2.5985429286956787, Second Loss : 2.503706693649292
epoch: 8 idx: 200 First Loss : 1.026186220459084, Second Loss : 1.0150267214917426
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.5813988543864937, recall 0.5251515151515151, F1 0.49519230769230765, AUC 0.7353928170594838
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7553030303030303
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6530612244897959, precision 0.6723773684557998, recall 0.5777483833039389, F1 0.5995558566696778, AUC 0.700960219478738
  Second-Tier acc 0.5918367346938775, precision 0.5317460317460317, recall 0.4561287477954144, F1 0.4539682539682539, AUC 0.7101521164021163
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 9 idx: 0 First Loss : 2.7168080806732178, Second Loss : 2.6082749366760254
epoch: 9 idx: 200 First Loss : 1.0100267841040496, Second Loss : 1.0004982024208824
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6597222222222222, precision 0.6064814814814814, recall 0.5922895622895623, F1 0.592170267067724, AUC 0.7312570145903479
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7543939393939394
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5918367346938775, precision 0.5453613053613053, recall 0.5734126984126984, F1 0.5543559754086069, AUC 0.7029749657064471
  Second-Tier acc 0.6122448979591837, precision 0.5797101449275363, recall 0.5551146384479718, F1 0.5414814814814816, AUC 0.7124669312169312
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 10 idx: 0 First Loss : 2.837592124938965, Second Loss : 2.721763849258423
epoch: 10 idx: 200 First Loss : 0.9954577903657114, Second Loss : 0.9871065000544733
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5833333333333334, precision 0.5492098478735756, recall 0.5584511784511784, F1 0.5471466198419667, AUC 0.7263636363636364
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7548989898989898
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.54421768707483, precision 0.5049357049357049, recall 0.5429159318048207, F1 0.504915942699132, AUC 0.7035383597883597
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.728505291005291
Test AUC: 0.7031, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0260782276543651e-05
epoch: 11 idx: 0 First Loss : 2.9595940113067627, Second Loss : 2.8376693725585938
epoch: 11 idx: 200 First Loss : 0.9832493143702917, Second Loss : 0.9758093882333579
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5208333333333334, precision 0.5023172905525847, recall 0.5054545454545454, F1 0.48460798460798465, AUC 0.7265319865319867
  Second-Tier acc 0.5, precision 0.5636604774535808, recall 0.5330303030303031, F1 0.47076023391812866, AUC 0.7727272727272728
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.47619047619047616, precision 0.4614957204331584, recall 0.5060258671369783, F1 0.4456467661691543, AUC 0.7071575543797767
  Second-Tier acc 0.5918367346938775, precision 0.6046225253386378, recall 0.6192680776014109, F1 0.5883798236739414, AUC 0.7405202821869489
Test AUC: 0.7405, Test F1: 0.5884 (Best Epoch: 11)
Current LR: 1.0260782276543651e-05
epoch: 12 idx: 0 First Loss : 3.0741899013519287, Second Loss : 2.949465751647949
epoch: 12 idx: 200 First Loss : 0.9730587498243175, Second Loss : 0.9667631971895398
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4722222222222222, precision 0.4939370485036119, recall 0.48313131313131313, F1 0.44500946594461316, AUC 0.7270258136924804
  Second-Tier acc 0.4791666666666667, precision 0.5777777777777778, recall 0.5341414141414141, F1 0.4673635307781649, AUC 0.785050505050505
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.44148747427435947, recall 0.4790564373897707, F1 0.40540077630598464, AUC 0.7115606016068979
  Second-Tier acc 0.5918367346938775, precision 0.6126262626262626, recall 0.6779100529100529, F1 0.608994708994709, AUC 0.7583223104056437
Test AUC: 0.7583, Test F1: 0.6090 (Best Epoch: 12)
Current LR: 1.0260782276543651e-05
epoch: 13 idx: 0 First Loss : 3.176192045211792, Second Loss : 3.0556893348693848
epoch: 13 idx: 200 First Loss : 0.9649677650530392, Second Loss : 0.9595829140283724
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4375, precision 0.4754299754299755, recall 0.46090909090909093, F1 0.416017316017316, AUC 0.7292817059483726
  Second-Tier acc 0.4791666666666667, precision 0.5446689113355779, recall 0.5341414141414141, F1 0.4628091969053067, AUC 0.7954040404040404
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.46952799167657905, recall 0.498750734861846, F1 0.42417566277447305, AUC 0.7185356652949245
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7582671957671957
Test AUC: 0.7583, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0260782276543651e-05
epoch: 14 idx: 0 First Loss : 3.263643503189087, Second Loss : 3.1468088626861572
epoch: 14 idx: 200 First Loss : 0.9580988401815814, Second Loss : 0.953510061050047
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4375, precision 0.4956334248530256, recall 0.4713804713804714, F1 0.4195156695156695, AUC 0.7381313131313131
  Second-Tier acc 0.4791666666666667, precision 0.5527065527065527, recall 0.5485858585858586, F1 0.4703762586115527, AUC 0.8025252525252524
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.47151888077635434, recall 0.4943415637860082, F1 0.416044697448872, AUC 0.7235327258475407
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7724867724867724
Test AUC: 0.7725, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0260782276543651e-05
epoch: 15 idx: 0 First Loss : 3.3442776203155518, Second Loss : 3.2318358421325684
epoch: 15 idx: 200 First Loss : 0.9526235402436621, Second Loss : 0.9486252126742655
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.48299781616041293, recall 0.45444444444444443, F1 0.39796461889830836, AUC 0.7417620650953984
  Second-Tier acc 0.4791666666666667, precision 0.5627289377289377, recall 0.563030303030303, F1 0.47544047544047546, AUC 0.8132828282828282
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.4932032186269475, recall 0.5140358612580834, F1 0.43319161979805637, AUC 0.726049627669998
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7726521164021163
Test AUC: 0.7727, Test F1: 0.5320 (Best Epoch: 15)
Current LR: 1.0260782276543651e-05
epoch: 16 idx: 0 First Loss : 3.41562557220459, Second Loss : 3.304011821746826
epoch: 16 idx: 200 First Loss : 0.9480995420153387, Second Loss : 0.9446218793062651
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5136047172492185, recall 0.48474747474747476, F1 0.4239538239538239, AUC 0.744107744107744
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333332, recall 0.563030303030303, F1 0.47474747474747475, AUC 0.8142929292929293
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.43537414965986393, precision 0.5136015325670498, recall 0.5216784244562023, F1 0.43503607503607505, AUC 0.7306608857534783
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7756834215167548
Test AUC: 0.7757, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0260782276543651e-05
epoch: 17 idx: 0 First Loss : 3.4761130809783936, Second Loss : 3.364393711090088
epoch: 17 idx: 200 First Loss : 0.9441859840707325, Second Loss : 0.9410784426770771
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5118008988872065, recall 0.48114478114478115, F1 0.4192817401483526, AUC 0.7468069584736252
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8181818181818182
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5490598290598291, recall 0.5451940035273369, F1 0.4506241777348186, AUC 0.7344331765628063
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7763999118165784
Test AUC: 0.7764, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0260782276543651e-05
epoch: 18 idx: 0 First Loss : 3.527069091796875, Second Loss : 3.4146621227264404
epoch: 18 idx: 200 First Loss : 0.9404883757696965, Second Loss : 0.9378286737911589
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4236111111111111, precision 0.5227272727272728, recall 0.5102693602693603, F1 0.4225521342456826, AUC 0.7514814814814814
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8178787878787879
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.552243018419489, recall 0.5490152851263962, F1 0.4518238442289075, AUC 0.7361172349598276
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7763447971781305
Test AUC: 0.7764, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0260782276543651e-05
epoch: 19 idx: 0 First Loss : 3.5651166439056396, Second Loss : 3.452040195465088
epoch: 19 idx: 200 First Loss : 0.9368110643838768, Second Loss : 0.9344791347156302
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4375, precision 0.5349206349206349, recall 0.5313131313131313, F1 0.4367797310239337, AUC 0.7537093153759821
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8186363636363637
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46258503401360546, precision 0.5748959163787758, recall 0.564888300999412, F1 0.4653303923215428, AUC 0.7396445718204978
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7814153439153438
Test AUC: 0.7814, Test F1: 0.4990 (Best Epoch: 19)