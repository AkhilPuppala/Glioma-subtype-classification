{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.30826768336960997, "droprate_2": 0.0, "lr": 4.79916340064234e-05, "weight_decay": 9.181527591030944e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.79916340064234e-05
epoch: 0 idx: 0 First Loss : 1.1423012018203735, Second Loss : 1.1999109983444214
epoch: 0 idx: 200 First Loss : 1.107344480592813, Second Loss : 1.0917906076902182
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5020931537598204
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4981818181818182
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.42771408975112674
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4580577601410935
 
 test auc: 0.4580577601410935, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.21446340677256556, "droprate_2": 0.0, "lr": 0.0003063952443891709, "weight_decay": 0.00018643006248176563, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0003063952443891709
epoch: 0 idx: 0 First Loss : 0.8873422741889954, Second Loss : 1.035918116569519
epoch: 0 idx: 200 First Loss : 1.0913289720146218, Second Loss : 1.0916811281546432
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5004166666666667
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5038383838383839
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4580164241622575
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.441358024691358
 
 test auc: 0.441358024691358, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0003063952443891709
epoch: 1 idx: 0 First Loss : 1.3837206363677979, Second Loss : 1.7612133026123047
epoch: 1 idx: 200 First Loss : 0.986950543092851, Second Loss : 0.9807696925170386
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.28125, precision 0.41935483870967744, recall 0.37878787878787873, F1 0.21675213675213675, AUC 0.5046338383838384
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5030808080808081
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.464960868606702
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4641754850088183
 
 test auc: 0.441358024691358, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0003063952443891709
epoch: 2 idx: 0 First Loss : 1.8434772491455078, Second Loss : 2.4868016242980957
epoch: 2 idx: 200 First Loss : 0.9532860044149024, Second Loss : 0.954900193755603
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.39646464646464646, F1 0.2642857142857143, AUC 0.5001262626262627
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.39646464646464646, F1 0.2642857142857143, AUC 0.5025252525252525
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.0982456140350877, recall 0.3333333333333333, F1 0.15176151761517614, AUC 0.46684854497354494
  Second-Tier acc 0.2857142857142857, precision 0.09929078014184396, recall 0.3333333333333333, F1 0.15300546448087432, AUC 0.46467151675485013
 
 test auc: 0.441358024691358, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0003063952443891709
epoch: 3 idx: 0 First Loss : 2.696335792541504, Second Loss : 3.1924688816070557
epoch: 3 idx: 200 First Loss : 0.9319449998716365, Second Loss : 0.9388606196538133
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3020833333333333, precision 0.2663817663817664, recall 0.4154040404040404, F1 0.2908496732026144, AUC 0.4870454545454545
  Second-Tier acc 0.2916666666666667, precision 0.18694885361552027, recall 0.41414141414141414, F1 0.2562466772993089, AUC 0.4727272727272727
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2653061224489796, precision 0.14857881136950904, recall 0.2980599647266314, F1 0.16055289739500264, AUC 0.47490906084656076
  Second-Tier acc 0.2857142857142857, precision 0.17857142857142858, recall 0.2072310405643739, F1 0.19047619047619047, AUC 0.47778880070546736
 
 test auc: 0.441358024691358, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0003063952443891709
epoch: 4 idx: 0 First Loss : 3.554856777191162, Second Loss : 4.0169453620910645
epoch: 4 idx: 200 First Loss : 0.9190239497756966, Second Loss : 0.926117785780028
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.14688057040998218, recall 0.3611111111111111, F1 0.17516688918558077, AUC 0.5079924242424242
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.49146464646464644
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3979591836734694, precision 0.1566265060240964, recall 0.24074074074074073, F1 0.1897810218978102, AUC 0.52730930335097
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.5087081128747796
 
 test auc: 0.441358024691358, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0003063952443891709
epoch: 5 idx: 0 First Loss : 3.3281736373901367, Second Loss : 3.6959614753723145
epoch: 5 idx: 200 First Loss : 0.907247726138292, Second Loss : 0.9182407931165204
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.633510101010101
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6422222222222222
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.5036100088183422
  Second-Tier acc 0.3469387755102041, precision 0.1452991452991453, recall 0.20987654320987656, F1 0.1717171717171717, AUC 0.4925044091710758
 
 test auc: 0.4925044091710758, test F1: 0.1717171717171717  :  from epoch 5
 current learn rate 0.0003063952443891709
epoch: 6 idx: 0 First Loss : 3.3234057426452637, Second Loss : 3.63944411277771
epoch: 6 idx: 200 First Loss : 0.9038007475310631, Second Loss : 0.9098436808148723
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.28125, precision 0.48835341365461843, recall 0.3811111111111111, F1 0.21663407501365328, AUC 0.6544696969696969
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6380808080808081
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.457120811287478
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4524360670194003
 
 test auc: 0.4925044091710758, test F1: 0.1717171717171717  :  from epoch 5
 current learn rate 0.0003063952443891709
epoch: 7 idx: 0 First Loss : 3.321897029876709, Second Loss : 3.727020740509033
epoch: 7 idx: 200 First Loss : 0.9061775699325035, Second Loss : 0.9149222215544895
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2604166666666667, precision 0.47404627892432777, recall 0.36777777777777776, F1 0.19013357248651366, AUC 0.647550505050505
  Second-Tier acc 0.25, precision 0.13333333333333333, recall 0.3611111111111111, F1 0.17712418300653596, AUC 0.6492424242424243
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.37755102040816324, precision 0.1522633744855967, recall 0.22839506172839508, F1 0.18271604938271604, AUC 0.4503141534391535
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.44670414462081126
 
 test auc: 0.44670414462081126, test F1: 0.1932367149758454  :  from epoch 7
 current learn rate 0.0003063952443891709
epoch: 8 idx: 0 First Loss : 3.501633405685425, Second Loss : 3.672652006149292
epoch: 8 idx: 200 First Loss : 0.8976238830170283, Second Loss : 0.9105160415533986
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3229166666666667, precision 0.45148005148005144, recall 0.41500000000000004, F1 0.2742352676563203, AUC 0.6501893939393939
  Second-Tier acc 0.2708333333333333, precision 0.1574074074074074, recall 0.3888888888888889, F1 0.2115839243498818, AUC 0.6293434343434343
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3469387755102041, precision 0.26134585289514867, recall 0.2391975308641975, F1 0.2312727272727273, AUC 0.47215332892416223
  Second-Tier acc 0.3469387755102041, precision 0.17378917378917377, recall 0.22134038800705466, F1 0.19400352733686066, AUC 0.46230158730158727
 
 test auc: 0.44670414462081126, test F1: 0.1932367149758454  :  from epoch 7
 current learn rate 0.0003063952443891709
epoch: 9 idx: 0 First Loss : 3.535468339920044, Second Loss : 4.454392433166504
epoch: 9 idx: 200 First Loss : 0.906188684143821, Second Loss : 0.9214942562977368
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3020833333333333, precision 0.4423868312757202, recall 0.39444444444444443, F1 0.24232267193432241, AUC 0.6662121212121211
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6624747474747475
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.35714285714285715, precision 0.19031531531531531, recall 0.24537037037037038, F1 0.21354166666666666, AUC 0.437541335978836
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.44047619047619047
 
 test auc: 0.44047619047619047, test F1: 0.21296296296296294  :  from epoch 9
 current learn rate 0.0003063952443891709
epoch: 10 idx: 0 First Loss : 3.3351478576660156, Second Loss : 3.780740261077881
epoch: 10 idx: 200 First Loss : 0.9018235371561185, Second Loss : 0.9130492447435263
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.45958259847148736, recall 0.40111111111111114, F1 0.2542369272696304, AUC 0.6648737373737373
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6698484848484848
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.1927777777777778, recall 0.2515432098765432, F1 0.21737726098191215, AUC 0.4460841049382716
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4437830687830688
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 11 idx: 0 First Loss : 3.380324363708496, Second Loss : 3.932527542114258
epoch: 11 idx: 200 First Loss : 0.8993066406961697, Second Loss : 0.9107851421549413
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2604166666666667, precision 0.5119047619047619, recall 0.36777777777777776, F1 0.18941598144634197, AUC 0.6659343434343433
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6608080808080808
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.41836734693877553, precision 0.1607843137254902, recall 0.25308641975308643, F1 0.19664268585131894, AUC 0.4382716049382716
  Second-Tier acc 0.46938775510204084, precision 0.17037037037037037, recall 0.2839506172839506, F1 0.21296296296296294, AUC 0.4501763668430336
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 12 idx: 0 First Loss : 3.352404832839966, Second Loss : 4.004438400268555
epoch: 12 idx: 200 First Loss : 0.8890520999607655, Second Loss : 0.9079796162669431
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6551136363636364
  Second-Tier acc 0.25, precision 0.14285714285714288, recall 0.3611111111111111, F1 0.17540181691125087, AUC 0.6508585858585859
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3877551020408163, precision 0.15637860082304525, recall 0.23456790123456792, F1 0.18765432098765433, AUC 0.46299052028218696
  Second-Tier acc 0.3877551020408163, precision 0.26495726495726496, recall 0.2638888888888889, F1 0.24242424242424243, AUC 0.4780643738977073
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 13 idx: 0 First Loss : 3.869248628616333, Second Loss : 3.9795000553131104
epoch: 13 idx: 200 First Loss : 0.8985537326614812, Second Loss : 0.8929878655447948
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.25, precision 0.1776350989834136, recall 0.3611111111111111, F1 0.17514288482030418, AUC 0.662159090909091
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6528282828282829
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4334490740740741
  Second-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.46478174603174605
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 14 idx: 0 First Loss : 3.5528225898742676, Second Loss : 4.090160846710205
epoch: 14 idx: 200 First Loss : 0.876770104365133, Second Loss : 0.888772891786994
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2708333333333333, precision 0.549063670411985, recall 0.3744444444444444, F1 0.20375016926741063, AUC 0.6690909090909091
  Second-Tier acc 0.2708333333333333, precision 0.5277777777777778, recall 0.3744444444444444, F1 0.20341880341880345, AUC 0.6500505050505051
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5, precision 0.17562724014336917, recall 0.30246913580246915, F1 0.2222222222222222, AUC 0.4270695546737214
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.4500661375661375
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 15 idx: 0 First Loss : 3.9869487285614014, Second Loss : 4.121099948883057
epoch: 15 idx: 200 First Loss : 0.8940795781646507, Second Loss : 0.8983828496190531
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.25, precision 0.1776350989834136, recall 0.3611111111111111, F1 0.17514288482030418, AUC 0.6600126262626262
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6425757575757576
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.5204081632653061, precision 0.17894736842105263, recall 0.3148148148148148, F1 0.22818791946308725, AUC 0.44458223104056444
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.46814373897707234
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 16 idx: 0 First Loss : 3.8629226684570312, Second Loss : 4.165769100189209
epoch: 16 idx: 200 First Loss : 0.866812538751581, Second Loss : 0.8802123099271445
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.23958333333333334, precision 0.1379525593008739, recall 0.34722222222222227, F1 0.15435435435435435, AUC 0.6494570707070707
  Second-Tier acc 0.25, precision 0.16666666666666666, recall 0.3611111111111111, F1 0.17500000000000002, AUC 0.6445454545454545
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.5204081632653061, precision 0.17894736842105263, recall 0.3148148148148148, F1 0.22818791946308725, AUC 0.4412477954144621
  Second-Tier acc 0.5102040816326531, precision 0.1773049645390071, recall 0.30864197530864196, F1 0.22522522522522523, AUC 0.46070326278659607
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 17 idx: 0 First Loss : 3.9281668663024902, Second Loss : 4.322417736053467
epoch: 17 idx: 200 First Loss : 0.8742350128537075, Second Loss : 0.8874961337224971
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.25, precision 0.3055555555555555, recall 0.3538888888888889, F1 0.16837606837606836, AUC 0.6429671717171718
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6286363636363635
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.5, precision 0.17562724014336917, recall 0.30246913580246915, F1 0.2222222222222222, AUC 0.44759975749559083
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.4635692239858906
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 18 idx: 0 First Loss : 4.100643157958984, Second Loss : 4.328342437744141
epoch: 18 idx: 200 First Loss : 0.8679613099778574, Second Loss : 0.877560102319401
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2604166666666667, precision 0.28527131782945736, recall 0.35333333333333333, F1 0.1721661054994388, AUC 0.6394570707070707
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6233838383838384
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.43967702821869487
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.47222222222222215
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10
 current learn rate 0.0003063952443891709
epoch: 19 idx: 0 First Loss : 4.184017181396484, Second Loss : 4.369651794433594
epoch: 19 idx: 200 First Loss : 0.8642106115715792, Second Loss : 0.8793498664646194
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2604166666666667, precision 0.28527131782945736, recall 0.35333333333333333, F1 0.1721661054994388, AUC 0.6453156565656566
  Second-Tier acc 0.25, precision 0.15193798449612403, recall 0.3611111111111111, F1 0.17501815541031226, AUC 0.6233838383838384
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4897959183673469, precision 0.17391304347826086, recall 0.2962962962962963, F1 0.2191780821917808, AUC 0.43613591269841273
  Second-Tier acc 0.5306122448979592, precision 0.18055555555555555, recall 0.32098765432098764, F1 0.23111111111111113, AUC 0.48170194003527333
 
 test auc: 0.4437830687830688, test F1: 0.21296296296296294  :  from epoch 10{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.44150447865775133, "droprate_2": 0.0, "lr": 1.8659818082184964e-05, "weight_decay": 0.0001277436273117316, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.8659818082184964e-05
epoch: 0 idx: 0 First Loss : 1.2521498203277588, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0912407977664056, Second Loss : 1.072967158324683
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.693939393939394
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7501515151515151
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6332794434646286
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6275903880070546
Test AUC: 0.6276, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.8659818082184964e-05
epoch: 1 idx: 0 First Loss : 2.1933975219726562, Second Loss : 2.0725350379943848
epoch: 1 idx: 200 First Loss : 1.1038068887309649, Second Loss : 1.0979188585014485
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7260044893378227
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7607575757575757
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6848912404467961
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.691743827160494
Test AUC: 0.6917, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.8659818082184964e-05
epoch: 2 idx: 0 First Loss : 2.2822675704956055, Second Loss : 2.1782772541046143
epoch: 2 idx: 200 First Loss : 1.0797293661764604, Second Loss : 1.0755361158456376
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7380303030303029
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7634848484848485
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7061532431902803
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033179012345677
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.8659818082184964e-05
epoch: 3 idx: 0 First Loss : 2.4012019634246826, Second Loss : 2.2883877754211426
epoch: 3 idx: 200 First Loss : 1.0567531623502275, Second Loss : 1.054894927685237
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410044893378226
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7517171717171718
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7151736723495983
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7083333333333334
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.8659818082184964e-05
epoch: 4 idx: 0 First Loss : 2.528904676437378, Second Loss : 2.4113900661468506
epoch: 4 idx: 200 First Loss : 1.0308050250829155, Second Loss : 1.0320348382663371
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5902777777777778, precision 0.6097883597883599, recall 0.4431313131313131, F1 0.42307510068704096, AUC 0.7374859708193041
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7521717171717173
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6054421768707483, precision 0.6554136253041363, recall 0.4384920634920635, F1 0.4086912705031971, AUC 0.7078617969821673
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7082782186948853
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.8659818082184964e-05
epoch: 5 idx: 0 First Loss : 2.7052953243255615, Second Loss : 2.582491397857666
epoch: 5 idx: 200 First Loss : 1.0034135014782497, Second Loss : 1.0081852653726417
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.625, precision 0.5629762537657275, recall 0.5287878787878788, F1 0.5317027601401474, AUC 0.7340516273849608
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7495959595959597
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5374149659863946, precision 0.45634920634920634, recall 0.49845679012345673, F1 0.45589225589225585, AUC 0.7075800999412111
  Second-Tier acc 0.5306122448979592, precision 0.4416329284750337, recall 0.4420194003527336, F1 0.4310081951591385, AUC 0.7062940917107584
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.8659818082184964e-05
epoch: 6 idx: 0 First Loss : 2.916039228439331, Second Loss : 2.7810325622558594
epoch: 6 idx: 200 First Loss : 0.9765471227244654, Second Loss : 0.9854742008914699
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5416666666666666, precision 0.5248783266024646, recall 0.5049494949494949, F1 0.4682868788131946, AUC 0.7322615039281706
  Second-Tier acc 0.5625, precision 0.5583333333333333, recall 0.5416161616161617, F1 0.49179894179894185, AUC 0.7483838383838384
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5102040816326531, precision 0.48043478260869565, recall 0.5189594356261024, F1 0.45585449033724895, AUC 0.713881540270429
  Second-Tier acc 0.6938775510204082, precision 0.6973684210526315, recall 0.7511022927689593, F1 0.7068295917400776, AUC 0.7266865079365079
Test AUC: 0.7033, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.8659818082184964e-05
epoch: 7 idx: 0 First Loss : 3.1170847415924072, Second Loss : 2.990461587905884
epoch: 7 idx: 200 First Loss : 0.9549131905057685, Second Loss : 0.9677185995031649
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4791666666666667, precision 0.507829933837059, recall 0.47939393939393943, F1 0.4263242846661775, AUC 0.7394332210998877
  Second-Tier acc 0.5208333333333334, precision 0.581876456876457, recall 0.5727272727272728, F1 0.5166137566137566, AUC 0.763939393939394
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.47736079328756675, recall 0.5251322751322751, F1 0.4251952834253927, AUC 0.7203483245149912
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7420634920634921
Test AUC: 0.7421, Test F1: 0.6002 (Best Epoch: 7)
Current LR: 1.8659818082184964e-05
epoch: 8 idx: 0 First Loss : 3.275663375854492, Second Loss : 3.1561625003814697
epoch: 8 idx: 200 First Loss : 0.9392967563659991, Second Loss : 0.9554390067058565
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4444444444444444, precision 0.49004120879120877, recall 0.46764309764309764, F1 0.40502803193214554, AUC 0.7419472502805835
  Second-Tier acc 0.5, precision 0.5685185185185185, recall 0.5662626262626262, F1 0.49589408412937824, AUC 0.7873232323232324
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.42857142857142855, precision 0.4746046355953477, recall 0.5163139329805997, F1 0.4126494201605709, AUC 0.7252780227317265
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7634479717813051
Test AUC: 0.7634, Test F1: 0.4712 (Best Epoch: 8)
Current LR: 1.8659818082184964e-05
epoch: 9 idx: 0 First Loss : 3.3823063373565674, Second Loss : 3.277921199798584
epoch: 9 idx: 200 First Loss : 0.9271067125046283, Second Loss : 0.9477577991042268
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4097222222222222, precision 0.4808747266479225, recall 0.45023569023569027, F1 0.37312827523353836, AUC 0.7463019079685745
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7932828282828283
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.4945753834642724, recall 0.5121987066431511, F1 0.4070509607351713, AUC 0.7334104938271605
  Second-Tier acc 0.5102040816326531, precision 0.5736185383244207, recall 0.6170634920634921, F1 0.5154954954954954, AUC 0.765542328042328
Test AUC: 0.7655, Test F1: 0.5155 (Best Epoch: 9)
Current LR: 1.8659818082184964e-05
epoch: 10 idx: 0 First Loss : 3.424048662185669, Second Loss : 3.4191486835479736
epoch: 10 idx: 200 First Loss : 0.9190271526843828, Second Loss : 0.9419148699913303
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4097222222222222, precision 0.4861111111111111, recall 0.45023569023569027, F1 0.37320574162679426, AUC 0.7484848484848484
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.798030303030303
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4013605442176871, precision 0.503641456582633, recall 0.49985302763080536, F1 0.3900692097215516, AUC 0.73487409367039
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7734788359788359
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 11 idx: 0 First Loss : 3.497980833053589, Second Loss : 3.515983819961548
epoch: 11 idx: 200 First Loss : 0.9128126829111977, Second Loss : 0.9380017145495139
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3611111111111111, precision 0.44675477353176757, recall 0.40865319865319866, F1 0.3235084572260788, AUC 0.7504489337822671
  Second-Tier acc 0.4375, precision 0.5297334244702666, recall 0.5168686868686869, F1 0.4371537960247638, AUC 0.7957575757575759
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4013605442176871, precision 0.5194645247657296, recall 0.5074955908289241, F1 0.3950109320904203, AUC 0.7387137468155988
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7836199294532628
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 12 idx: 0 First Loss : 3.5503225326538086, Second Loss : 3.5833194255828857
epoch: 12 idx: 200 First Loss : 0.907332959608059, Second Loss : 0.9341599916047718
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.45320039140263857, recall 0.4151515151515152, F1 0.33419354838709675, AUC 0.7511054994388328
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.7918181818181819
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.5420466058763931, recall 0.5271898883009993, F1 0.4125006061539602, AUC 0.7463808054085832
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7898478835978836
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 13 idx: 0 First Loss : 3.5708091259002686, Second Loss : 3.627964496612549
epoch: 13 idx: 200 First Loss : 0.9018762816295065, Second Loss : 0.9304909803811924
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.484616186900292, recall 0.46121212121212124, F1 0.37386306846576717, AUC 0.751026936026936
  Second-Tier acc 0.4375, precision 0.5307142857142857, recall 0.5193939393939394, F1 0.43452380952380953, AUC 0.7888383838383838
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5489220563847429, recall 0.5327013521457965, F1 0.41657830941465185, AUC 0.7489834411130708
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.79293430335097
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 14 idx: 0 First Loss : 3.5653865337371826, Second Loss : 3.6457648277282715
epoch: 14 idx: 200 First Loss : 0.8966118036514491, Second Loss : 0.9270468362136767
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4027777777777778, precision 0.5011291172988729, recall 0.4830976430976431, F1 0.3953084619769626, AUC 0.7521043771043772
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.7856060606060606
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.564236111111111, recall 0.5565108759553204, F1 0.4375868296003316, AUC 0.7549541936116011
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.8008156966490301
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 15 idx: 0 First Loss : 3.545987129211426, Second Loss : 3.642716646194458
epoch: 15 idx: 200 First Loss : 0.891811176670011, Second Loss : 0.9237806356549078
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4027777777777778, precision 0.5052083333333334, recall 0.4912794612794613, F1 0.3993618065783014, AUC 0.7506621773288441
  Second-Tier acc 0.3541666666666667, precision 0.4581491305629237, recall 0.4227272727272728, F1 0.33752688172043016, AUC 0.7834343434343435
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5767624662245149, recall 0.5702527924750148, F1 0.4494713991099533, AUC 0.7588183421516755
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.8031305114638448
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 16 idx: 0 First Loss : 3.5156257152557373, Second Loss : 3.631066083908081
epoch: 16 idx: 200 First Loss : 0.8875696181686854, Second Loss : 0.9206371860386369
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.375, precision 0.4833333333333334, recall 0.4655555555555555, F1 0.37062515908512417, AUC 0.7443771043771044
  Second-Tier acc 0.3541666666666667, precision 0.4486111111111111, recall 0.42525252525252527, F1 0.32317170201641315, AUC 0.7727272727272728
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5756686236138291, recall 0.5661375661375662, F1 0.44440052700922267, AUC 0.7622721928277483
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8061618165784833
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 17 idx: 0 First Loss : 3.4751765727996826, Second Loss : 3.602545738220215
epoch: 17 idx: 200 First Loss : 0.8840287680417966, Second Loss : 0.9181018953445594
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3819444444444444, precision 0.4881673881673882, recall 0.47734006734006734, F1 0.37591213059377854, AUC 0.7386026936026936
  Second-Tier acc 0.3541666666666667, precision 0.4486111111111111, recall 0.42525252525252527, F1 0.32317170201641315, AUC 0.7683838383838384
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4421768707482993, precision 0.5823312489979157, recall 0.5737801293356849, F1 0.4433707926734003, AUC 0.7630805408583186
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.8048941798941799
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 18 idx: 0 First Loss : 3.435368537902832, Second Loss : 3.5702974796295166
epoch: 18 idx: 200 First Loss : 0.8812406169307367, Second Loss : 0.9166518656736174
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3888888888888889, precision 0.4934758713612027, recall 0.48828282828282826, F1 0.38104232394236265, AUC 0.7298092031425365
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7460101010101009
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4421768707482993, precision 0.5790598290598291, recall 0.5640064667842446, F1 0.44342403628117916, AUC 0.7634724671761709
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.8048390652557319
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.8659818082184964e-05
epoch: 19 idx: 0 First Loss : 3.390291929244995, Second Loss : 3.539141893386841
epoch: 19 idx: 200 First Loss : 0.8783365271154986, Second Loss : 0.9150311159432185
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.375, precision 0.48181261247463336, recall 0.4745791245791246, F1 0.3656126482213439, AUC 0.7193939393939394
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7330808080808081
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.42857142857142855, precision 0.5734775838046061, recall 0.5438712522045855, F1 0.4247511415525114, AUC 0.7615924456202233
  Second-Tier acc 0.46938775510204084, precision 0.5738284703801945, recall 0.5388007054673721, F1 0.4502855405728183, AUC 0.7999338624338624
Test AUC: 0.7735, Test F1: 0.4919 (Best Epoch: 10){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.49683736258851785, "droprate_2": 0.0, "lr": 2.5632662614731955e-05, "weight_decay": 0.00026924249673115414, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.5632662614731955e-05
epoch: 0 idx: 0 First Loss : 1.2697123289108276, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1263451289329955, Second Loss : 1.098748080098807
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7072615039281706
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7458585858585859
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6532615618263766
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6389440035273368
Test AUC: 0.6389, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.5632662614731955e-05
epoch: 1 idx: 0 First Loss : 2.131301164627075, Second Loss : 2.1281862258911133
epoch: 1 idx: 200 First Loss : 1.0977393991096103, Second Loss : 1.0914272433193168
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.733641975308642
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7608585858585859
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6992271702919851
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7008928571428571
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5632662614731955e-05
epoch: 2 idx: 0 First Loss : 2.23161244392395, Second Loss : 2.2523903846740723
epoch: 2 idx: 200 First Loss : 1.0642968809871531, Second Loss : 1.0632440241340975
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7397586980920314
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530808080808081
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7170904369978444
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7118606701940035
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5632662614731955e-05
epoch: 3 idx: 0 First Loss : 2.338207721710205, Second Loss : 2.3963446617126465
epoch: 3 idx: 200 First Loss : 1.0308870720626109, Second Loss : 1.0356465523589904
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5625, precision 0.5038461538461538, recall 0.4044107744107744, F1 0.36259217243335223, AUC 0.7351346801346801
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7490404040404041
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5782312925170068, precision 0.524822695035461, recall 0.3888888888888889, F1 0.3384813384813385, AUC 0.7120015187144816
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.708829365079365
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5632662614731955e-05
epoch: 4 idx: 0 First Loss : 2.527801275253296, Second Loss : 2.6106035709381104
epoch: 4 idx: 200 First Loss : 0.9948095834410903, Second Loss : 1.0058384338273338
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6805555555555556, precision 0.6475928702315509, recall 0.607912457912458, F1 0.6198706643151087, AUC 0.7308024691358025
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7454545454545455
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.564625850340136, precision 0.512119385537107, recall 0.5416666666666666, F1 0.5189359698681733, AUC 0.7083639525769154
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7031525573192239
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5632662614731955e-05
epoch: 5 idx: 0 First Loss : 2.7324740886688232, Second Loss : 2.8683934211730957
epoch: 5 idx: 200 First Loss : 0.9624127436484864, Second Loss : 0.9791418994725937
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5277777777777778, precision 0.49424977538185083, recall 0.5017171717171717, F1 0.4678437281621244, AUC 0.7277104377104378
  Second-Tier acc 0.6041666666666666, precision 0.587719298245614, recall 0.6116161616161616, F1 0.5787878787878787, AUC 0.747171717171717
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.47619047619047616, precision 0.44866026416616256, recall 0.4983833039388595, F1 0.43515201309474905, AUC 0.7117259455222418
  Second-Tier acc 0.6326530612244898, precision 0.6239316239316239, recall 0.6911375661375662, F1 0.6319444444444443, AUC 0.7181437389770723
Test AUC: 0.7009, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.5632662614731955e-05
epoch: 6 idx: 0 First Loss : 2.93335223197937, Second Loss : 3.1176841259002686
epoch: 6 idx: 200 First Loss : 0.9390079506408813, Second Loss : 0.9596587275595065
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4375, precision 0.4669071669071669, recall 0.4575420875420875, F1 0.3924162257495591, AUC 0.7338103254769921
  Second-Tier acc 0.5, precision 0.562962962962963, recall 0.5543434343434344, F1 0.49901477832512314, AUC 0.7674747474747474
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.48457883490778225, recall 0.5245443856554967, F1 0.4235435435435435, AUC 0.718652018420537
  Second-Tier acc 0.4897959183673469, precision 0.509181450357921, recall 0.5703262786596119, F1 0.4873812261695818, AUC 0.7430004409171076
Test AUC: 0.7430, Test F1: 0.4874 (Best Epoch: 6)
Current LR: 2.5632662614731955e-05
epoch: 7 idx: 0 First Loss : 3.087803840637207, Second Loss : 3.3425891399383545
epoch: 7 idx: 200 First Loss : 0.9238598110589815, Second Loss : 0.949987111390749
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4236111111111111, precision 0.48197929111907606, recall 0.4591245791245791, F1 0.3858769129846961, AUC 0.7388776655443321
  Second-Tier acc 0.5208333333333334, precision 0.5873015873015873, recall 0.5990909090909091, F1 0.5225889728932325, AUC 0.7834848484848486
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.42857142857142855, precision 0.497192513368984, recall 0.520135214579659, F1 0.4158082497212932, AUC 0.7294116206153243
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7567239858906526
Test AUC: 0.7567, Test F1: 0.4712 (Best Epoch: 7)
Current LR: 2.5632662614731955e-05
epoch: 8 idx: 0 First Loss : 3.1941394805908203, Second Loss : 3.4969394207000732
epoch: 8 idx: 200 First Loss : 0.9143480613586766, Second Loss : 0.9436637389413383
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3958333333333333, precision 0.4553555191853065, recall 0.4356902356902357, F1 0.3552798739239417, AUC 0.7408585858585859
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.7933333333333333
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.5178314586022497, recall 0.5119047619047619, F1 0.40485960522657766, AUC 0.7344209288653732
  Second-Tier acc 0.4897959183673469, precision 0.5831244778613199, recall 0.5932539682539683, F1 0.49188712522045847, AUC 0.7662037037037036
Test AUC: 0.7662, Test F1: 0.4919 (Best Epoch: 8)
Current LR: 2.5632662614731955e-05
epoch: 9 idx: 0 First Loss : 3.2650387287139893, Second Loss : 3.621868848800659
epoch: 9 idx: 200 First Loss : 0.9082136208432453, Second Loss : 0.9403710236809962
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3888888888888889, precision 0.4735367831343063, recall 0.43858585858585863, F1 0.3654066270903659, AUC 0.7466498316498317
  Second-Tier acc 0.5208333333333334, precision 0.5924185463659147, recall 0.6160606060606061, F1 0.5224625285109156, AUC 0.7939898989898989
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.5312529550827424, recall 0.5313051146384479, F1 0.4189417316404809, AUC 0.7414817264354302
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7800374779541447
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 10 idx: 0 First Loss : 3.2840213775634766, Second Loss : 3.695497512817383
epoch: 10 idx: 200 First Loss : 0.90098450125765, Second Loss : 0.9369138646500176
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.4800509294626942, recall 0.45195286195286194, F1 0.36892626295872216, AUC 0.7504264870931537
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.792979797979798
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.5678790983606558, recall 0.5647413286302175, F1 0.4517547924097281, AUC 0.7485057809131884
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7834545855379188
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 11 idx: 0 First Loss : 3.2713050842285156, Second Loss : 3.7301487922668457
epoch: 11 idx: 200 First Loss : 0.8940851836203509, Second Loss : 0.9339653891210088
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3958333333333333, precision 0.5003815628815629, recall 0.482020202020202, F1 0.3929086786229643, AUC 0.7483221099887766
  Second-Tier acc 0.3958333333333333, precision 0.4920634920634921, recall 0.46383838383838377, F1 0.3854588394062078, AUC 0.7840404040404042
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4489795918367347, precision 0.5745264207377866, recall 0.5723838918283363, F1 0.45220305163046426, AUC 0.7534477268273565
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.7870921516754851
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 12 idx: 0 First Loss : 3.2168636322021484, Second Loss : 3.7463016510009766
epoch: 12 idx: 200 First Loss : 0.8874947920867905, Second Loss : 0.9312391937200666
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.375, precision 0.48577586206896556, recall 0.45508417508417515, F1 0.37300439696638826, AUC 0.7480190796857463
  Second-Tier acc 0.3541666666666667, precision 0.4463203463203463, recall 0.4082828282828283, F1 0.32931247790738777, AUC 0.7791919191919191
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4489795918367347, precision 0.5802348336594912, recall 0.5740740740740741, F1 0.45019762845849803, AUC 0.7598410248873212
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7935405643738976
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 13 idx: 0 First Loss : 3.1517326831817627, Second Loss : 3.7406909465789795
epoch: 13 idx: 200 First Loss : 0.8819719429547199, Second Loss : 0.9282254531727038
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3888888888888889, precision 0.4963713080168777, recall 0.48262626262626257, F1 0.38318567737172393, AUC 0.7428170594837261
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.7642929292929294
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4421768707482993, precision 0.5783713142203708, recall 0.5640064667842446, F1 0.4426134089999636, AUC 0.7657137958063885
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7964616402116401
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 14 idx: 0 First Loss : 3.078036308288574, Second Loss : 3.6842763423919678
epoch: 14 idx: 200 First Loss : 0.8764153594152297, Second Loss : 0.9244984686235661
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.375, precision 0.4845469051818258, recall 0.46892255892255896, F1 0.36777712070438273, AUC 0.7325589225589226
  Second-Tier acc 0.3333333333333333, precision 0.43333333333333335, recall 0.394949494949495, F1 0.3094239006906198, AUC 0.7484343434343433
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4217687074829932, precision 0.5652777777777778, recall 0.5321134626690182, F1 0.419546692205134, AUC 0.7666262492651382
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7957451499118166
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 15 idx: 0 First Loss : 3.0004665851593018, Second Loss : 3.6414308547973633
epoch: 15 idx: 200 First Loss : 0.8716457416905804, Second Loss : 0.9217057256311855
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.375, precision 0.48498964803312633, recall 0.4697643097643098, F1 0.3663244584044804, AUC 0.7185353535353536
  Second-Tier acc 0.3541666666666667, precision 0.4459107201042685, recall 0.42525252525252527, F1 0.32422805494334245, AUC 0.737929292929293
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.43537414965986393, precision 0.572958500669344, recall 0.542034097589653, F1 0.4287804505536464, AUC 0.7622783166764648
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.789351851851852
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 16 idx: 0 First Loss : 2.9191267490386963, Second Loss : 3.6007611751556396
epoch: 16 idx: 200 First Loss : 0.8676064148092346, Second Loss : 0.9206207141532697
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3611111111111111, precision 0.46993609227651784, recall 0.45606060606060606, F1 0.350085657314573, AUC 0.7081200897867564
  Second-Tier acc 0.3541666666666667, precision 0.45286195286195285, recall 0.42525252525252527, F1 0.3225340967276451, AUC 0.7139393939393939
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5638882058847635, recall 0.5240299823633157, F1 0.4118196347031963, AUC 0.757299627669998
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7855489417989419
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 17 idx: 0 First Loss : 2.8587725162506104, Second Loss : 3.556842088699341
epoch: 17 idx: 200 First Loss : 0.865139059848685, Second Loss : 0.9203476389442612
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3541666666666667, precision 0.4637418847137518, recall 0.4468013468013468, F1 0.3421210868503138, AUC 0.6982884399551067
  Second-Tier acc 0.3541666666666667, precision 0.45476190476190476, recall 0.44222222222222224, F1 0.314975845410628, AUC 0.6993434343434344
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.40816326530612246, precision 0.5555555555555555, recall 0.5060258671369783, F1 0.39541166462579586, AUC 0.753178277483833
  Second-Tier acc 0.4489795918367347, precision 0.5650793650793651, recall 0.5264550264550264, F1 0.42763034067381894, AUC 0.7776675485008818
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 18 idx: 0 First Loss : 2.8037917613983154, Second Loss : 3.516099452972412
epoch: 18 idx: 200 First Loss : 0.8628600419910778, Second Loss : 0.9214430127744053
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3402777777777778, precision 0.449950308089843, recall 0.4282828282828283, F1 0.32578351205802186, AUC 0.6892592592592592
  Second-Tier acc 0.3541666666666667, precision 0.45476190476190476, recall 0.44222222222222224, F1 0.314975845410628, AUC 0.6895959595959597
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4013605442176871, precision 0.5540616246498599, recall 0.5019106407995296, F1 0.38803146546349443, AUC 0.7493018812463257
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7775573192239859
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9)
Current LR: 2.5632662614731955e-05
epoch: 19 idx: 0 First Loss : 2.7507927417755127, Second Loss : 3.4835879802703857
epoch: 19 idx: 200 First Loss : 0.860495165876282, Second Loss : 0.9220623374312528
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.4423371647509578, recall 0.42383838383838385, F1 0.31773094934014473, AUC 0.682351290684624
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444444, recall 0.44222222222222224, F1 0.31616161616161614, AUC 0.6789393939393941
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5651998710509348, recall 0.5216049382716049, F1 0.39696408392455645, AUC 0.7464971585341957
  Second-Tier acc 0.46938775510204084, precision 0.5873015873015873, recall 0.5681216931216931, F1 0.45661584792019577, AUC 0.7775573192239859
Test AUC: 0.7800, Test F1: 0.4919 (Best Epoch: 9){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.23865852695145226, "droprate_2": 0.0, "lr": 0.00037648778671269304, "weight_decay": 0.00047225441932820884, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00037648778671269304
epoch: 0 idx: 0 First Loss : 1.1587673425674438, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0941083222553505, Second Loss : 1.0843966295247647
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7374017957351291
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7382828282828283
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7157493141289438
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7110339506172839
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 1 idx: 0 First Loss : 1.8602094650268555, Second Loss : 1.8202067613601685
epoch: 1 idx: 200 First Loss : 0.9907493296992126, Second Loss : 0.9814823090437039
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7260662177328845
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7276262626262625
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7451376641191456
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7437169312169312
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 2 idx: 0 First Loss : 2.633236885070801, Second Loss : 2.9491958618164062
epoch: 2 idx: 200 First Loss : 0.9493532200431942, Second Loss : 0.9559176706556064
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7218125701459036
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7298989898989898
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18493150684931506, recall 0.3333333333333333, F1 0.23788546255506607, AUC 0.7345740250832843
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7298280423280423
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 3 idx: 0 First Loss : 3.313718557357788, Second Loss : 3.67451548576355
epoch: 3 idx: 200 First Loss : 0.9242583615520034, Second Loss : 0.9379471356132582
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5277777777777778, precision 0.5081585081585082, recall 0.3434343434343434, F1 0.24896564130239252, AUC 0.7131705948372614
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7295454545454545
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.3412698412698412, F1 0.2533893385240583, AUC 0.6746154223006074
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6795083774250442
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 4 idx: 0 First Loss : 3.8892107009887695, Second Loss : 4.408409595489502
epoch: 4 idx: 200 First Loss : 0.9167322138537518, Second Loss : 0.9262065692105104
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3958333333333333, precision 0.3805418719211822, recall 0.44, F1 0.3029908125366521, AUC 0.7239618406285073
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7291919191919192
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46258503401360546, precision 0.42487143525011684, recall 0.4288653733098178, F1 0.3382241431604489, AUC 0.7051305604546346
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.709049823633157
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 5 idx: 0 First Loss : 3.4591033458709717, Second Loss : 3.715740919113159
epoch: 5 idx: 200 First Loss : 0.8988264771062529, Second Loss : 0.9096283517773286
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3888888888888889, precision 0.42876942876942875, recall 0.44037037037037036, F1 0.3134961751989152, AUC 0.6942368125701459
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7096464646464646
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4557823129251701, precision 0.48484848484848486, recall 0.43452380952380953, F1 0.3573271413828689, AUC 0.6749154908877131
  Second-Tier acc 0.46938775510204084, precision 0.456140350877193, recall 0.4444444444444444, F1 0.3461538461538461, AUC 0.6657297178130511
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 6 idx: 0 First Loss : 3.809842348098755, Second Loss : 3.962845802307129
epoch: 6 idx: 200 First Loss : 0.909508376422834, Second Loss : 0.9222312492065928
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.4644324601951721, recall 0.42703703703703705, F1 0.2929462233449398, AUC 0.6781537598204265
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6998484848484848
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.44808743169398907, recall 0.43209876543209874, F1 0.32311265969802555, AUC 0.6694530178326473
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6649581128747796
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 7 idx: 0 First Loss : 3.5430526733398438, Second Loss : 3.783808946609497
epoch: 7 idx: 200 First Loss : 0.8906877802925842, Second Loss : 0.903653553324469
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4027777777777778, precision 0.43425076452599387, recall 0.44925925925925925, F1 0.32577325925902373, AUC 0.6780808080808081
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6963131313131313
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.46258503401360546, precision 0.5151515151515152, recall 0.4522339800117577, F1 0.37552760405687113, AUC 0.6709533607681756
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.673776455026455
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 8 idx: 0 First Loss : 3.4783945083618164, Second Loss : 3.8417787551879883
epoch: 8 idx: 200 First Loss : 0.8874795930303717, Second Loss : 0.8995885759393977
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3819444444444444, precision 0.4621434322521279, recall 0.4407407407407407, F1 0.3174081893293716, AUC 0.6664646464646465
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6777777777777777
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4489795918367347, precision 0.49568965517241376, recall 0.4418724279835391, F1 0.34548442064264845, AUC 0.6637578385263571
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.6609347442680776
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 9 idx: 0 First Loss : 3.657942533493042, Second Loss : 3.8256688117980957
epoch: 9 idx: 200 First Loss : 0.8799531767616832, Second Loss : 0.8953310893014518
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4513888888888889, precision 0.3844753392916253, recall 0.47555555555555556, F1 0.3470639417669404, AUC 0.6643153759820427
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6749999999999999
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4897959183673469, precision 0.3964953271028037, recall 0.445326278659612, F1 0.3563148261134838, AUC 0.6714616402116403
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6711309523809524
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 10 idx: 0 First Loss : 3.9022300243377686, Second Loss : 3.8172435760498047
epoch: 10 idx: 200 First Loss : 0.8745891236200863, Second Loss : 0.8876143578994227
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.42869520897043834, recall 0.4274074074074074, F1 0.30037161392849704, AUC 0.6620258136924804
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6754040404040405
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.5103386809269163, recall 0.43349500293944737, F1 0.35184632070395744, AUC 0.6741438859494414
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6766975308641975
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 11 idx: 0 First Loss : 3.3538620471954346, Second Loss : 3.709460735321045
epoch: 11 idx: 200 First Loss : 0.8748816920327664, Second Loss : 0.8979742345648478
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5138888888888888, precision 0.40051169590643276, recall 0.5155555555555555, F1 0.39409722222222215, AUC 0.6744725028058363
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6819191919191919
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5238095238095238, precision 0.7224209271337401, recall 0.47185479129923574, F1 0.40379265818114746, AUC 0.6819579169116207
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6883267195767196
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 12 idx: 0 First Loss : 3.9755289554595947, Second Loss : 4.275242328643799
epoch: 12 idx: 200 First Loss : 0.8651156564641614, Second Loss : 0.884097593928938
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.4232858522452921, recall 0.422962962962963, F1 0.29404578041077895, AUC 0.6684680134680135
  Second-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.6803030303030303
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3945578231292517, precision 0.4902534113060429, recall 0.41490299823633153, F1 0.31112637362637363, AUC 0.6802493631197336
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6748236331569665
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 13 idx: 0 First Loss : 3.427680015563965, Second Loss : 3.725271224975586
epoch: 13 idx: 200 First Loss : 0.8608089795544126, Second Loss : 0.8791168892506478
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.40683848382423954, recall 0.4096296296296296, F1 0.2744100969453082, AUC 0.6690852974186307
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6779292929292929
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.5032163742690058, recall 0.4205614344503233, F1 0.3128668022285043, AUC 0.6836787184009406
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6684854497354497
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00037648778671269304
epoch: 14 idx: 0 First Loss : 3.6021926403045654, Second Loss : 3.825791835784912
epoch: 14 idx: 200 First Loss : 0.8531796198534431, Second Loss : 0.8767548979631825
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.3934561245882, recall 0.4007407407407408, F1 0.2628926072625046, AUC 0.6701066217732885
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.6801515151515152
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3741496598639456, precision 0.49678197908286403, recall 0.40850970017636684, F1 0.3015427769985975, AUC 0.6858343131491281
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6727292768959435
Test AUC: 0.7110, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.15461777255345385, "droprate_2": 0.0, "lr": 0.00026844422449345454, "weight_decay": 4.646375586372632e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.26589829898265116, "droprate_2": 0.0, "lr": 1.0568045711195023e-05, "weight_decay": 0.00029840920561098334, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.052908432817697165, "droprate_2": 0.0, "lr": 5.094447899357573e-05, "weight_decay": 1.2176909686291049e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.00407445351187943, "droprate_2": 0.0, "lr": 3.8385026395142e-05, "weight_decay": 7.79580379557046e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.015745235845469288, "droprate_2": 0.0, "lr": 1.0980886777532187e-05, "weight_decay": 0.00025529035390660387, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0898857116699219, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.063221336004153, Second Loss : 1.0560832923621088
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7056944444444445
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.692979797979798
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6109078758818342
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6137566137566137
epoch: 1 idx: 0 First Loss : 1.8354581594467163, Second Loss : 1.8737707138061523
epoch: 1 idx: 200 First Loss : 1.1016992931787055, Second Loss : 1.0972717123393396
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7211900252525251
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7161616161616161
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6510451113315697
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.64048721340388
epoch: 2 idx: 0 First Loss : 1.9877088069915771, Second Loss : 2.0115015506744385
epoch: 2 idx: 200 First Loss : 1.0916624772756254, Second Loss : 1.0891359197114832
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7370738636363635
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7300505050505052
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6768904320987654
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6754298941798941
epoch: 3 idx: 0 First Loss : 2.0513195991516113, Second Loss : 2.06972599029541
epoch: 3 idx: 200 First Loss : 1.0785389137060488, Second Loss : 1.0785934419477756
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7422222222222222
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7492424242424244
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6944134424603176
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6899801587301587
epoch: 4 idx: 0 First Loss : 2.122885227203369, Second Loss : 2.1353180408477783
epoch: 4 idx: 200 First Loss : 1.0666984809720101, Second Loss : 1.0689276654773683
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7409438131313131
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7498484848484849
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7020502645502645
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7007826278659612
epoch: 5 idx: 0 First Loss : 2.2057712078094482, Second Loss : 2.2161169052124023
epoch: 5 idx: 200 First Loss : 1.0537541689193664, Second Loss : 1.0575680818723803
  First-Tier acc 0.5677083333333334, precision 0.4611111111111111, recall 0.40575757575757576, F1 0.3547619047619048, AUC 0.7392992424242424
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7466161616161616
  First-Tier acc 0.5510204081632653, precision 0.18652849740932642, recall 0.3333333333333333, F1 0.23920265780730898, AUC 0.7042892967372133
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.705136684303351
epoch: 6 idx: 0 First Loss : 2.2971816062927246, Second Loss : 2.310330867767334
epoch: 6 idx: 200 First Loss : 1.0393009257331416, Second Loss : 1.0437917220800077
  First-Tier acc 0.5885416666666666, precision 0.38641975308641974, recall 0.44878787878787874, F1 0.3974279623134585, AUC 0.7385006313131314
  Second-Tier acc 0.5625, precision 0.3904761904761904, recall 0.4109090909090909, F1 0.3638059701492537, AUC 0.7413636363636363
  First-Tier acc 0.5969387755102041, precision 0.684871311989956, recall 0.3913690476190476, F1 0.3449056712214607, AUC 0.7020847111992946
  Second-Tier acc 0.6122448979591837, precision 0.7000000000000001, recall 0.44047619047619047, F1 0.425, AUC 0.7109788359788359
epoch: 7 idx: 0 First Loss : 2.4013705253601074, Second Loss : 2.413296937942505
epoch: 7 idx: 200 First Loss : 1.0245807407358987, Second Loss : 1.0285166175433653
  First-Tier acc 0.6666666666666666, precision 0.599749373433584, recall 0.573888888888889, F1 0.5139576684641062, AUC 0.739977904040404
  Second-Tier acc 0.6666666666666666, precision 0.6333333333333333, recall 0.5548484848484848, F1 0.562962962962963, AUC 0.7485353535353535
  First-Tier acc 0.5918367346938775, precision 0.6056487304914978, recall 0.4650573192239859, F1 0.4759831867205296, AUC 0.6946752369929454
  Second-Tier acc 0.673469387755102, precision 0.6835585585585585, recall 0.5884038800705468, F1 0.579861111111111, AUC 0.7014440035273369
epoch: 8 idx: 0 First Loss : 2.515148878097534, Second Loss : 2.5227420330047607
epoch: 8 idx: 200 First Loss : 1.009782683345216, Second Loss : 1.012924366403575
  First-Tier acc 0.6458333333333334, precision 0.6100606909430439, recall 0.5870959595959595, F1 0.5439727463312369, AUC 0.7386931818181819
  Second-Tier acc 0.6666666666666666, precision 0.6127220480668757, recall 0.5837373737373738, F1 0.591971070994717, AUC 0.7456565656565656
  First-Tier acc 0.5867346938775511, precision 0.5469102048049416, recall 0.5256834215167548, F1 0.5261667812939347, AUC 0.693438602292769
  Second-Tier acc 0.5510204081632653, precision 0.5083527583527584, recall 0.5372574955908289, F1 0.5174802026837777, AUC 0.697585978835979
epoch: 9 idx: 0 First Loss : 2.634070873260498, Second Loss : 2.638251543045044
epoch: 9 idx: 200 First Loss : 0.9970038843651613, Second Loss : 0.9981950508124793
  First-Tier acc 0.6041666666666666, precision 0.5807733096889723, recall 0.5833585858585859, F1 0.5416406667945415, AUC 0.7408459595959597
  Second-Tier acc 0.625, precision 0.5792838874680307, recall 0.568989898989899, F1 0.5651593063117564, AUC 0.7530303030303029
  First-Tier acc 0.576530612244898, precision 0.554319827173931, recall 0.5545634920634921, F1 0.5445350882700161, AUC 0.6980165619488536
  Second-Tier acc 0.5714285714285714, precision 0.5397727272727273, recall 0.5725308641975309, F1 0.5486812268767155, AUC 0.7072310405643739{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.19232354325474027, "droprate_2": 0.0, "lr": 6.12496732301685e-05, "weight_decay": 0.0005107895676375246, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 11, "gamma": 0.49874378803544833, "T_max": 10, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0857194662094116, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1172058644579417, Second Loss : 1.1128521252479127
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7445643939393939
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7429797979797979
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6881958223104055
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6865079365079364
epoch: 1 idx: 0 First Loss : 1.993278980255127, Second Loss : 2.01686954498291
epoch: 1 idx: 200 First Loss : 1.0267396733090652, Second Loss : 1.0322319576841088
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7397253787878788
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7461111111111111
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7091187169312171
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7045855379188711
epoch: 2 idx: 0 First Loss : 2.294163942337036, Second Loss : 2.334348440170288
epoch: 2 idx: 200 First Loss : 0.9763248438636462, Second Loss : 0.9848632264641387
  First-Tier acc 0.6927083333333334, precision 0.7064377369495479, recall 0.6170959595959596, F1 0.5824587165417214, AUC 0.734826388888889
  Second-Tier acc 0.6666666666666666, precision 0.6333333333333333, recall 0.5548484848484848, F1 0.562962962962963, AUC 0.7447979797979798
  First-Tier acc 0.6173469387755102, precision 0.622390520875833, recall 0.5419973544973545, F1 0.5667293532148335, AUC 0.6925981040564375
  Second-Tier acc 0.5918367346938775, precision 0.5370370370370371, recall 0.5504850088183422, F1 0.5350453428256632, AUC 0.6899250440917107
epoch: 3 idx: 0 First Loss : 2.7508931159973145, Second Loss : 2.7070388793945312
epoch: 3 idx: 200 First Loss : 0.9439499138377199, Second Loss : 0.9478313049570245
  First-Tier acc 0.5729166666666666, precision 0.5664843231978782, recall 0.5732070707070706, F1 0.5543842347486073, AUC 0.7462657828282829
  Second-Tier acc 0.5833333333333334, precision 0.5741731035848683, recall 0.5856565656565657, F1 0.5516339869281045, AUC 0.7583333333333333
  First-Tier acc 0.5102040816326531, precision 0.5023809523809524, recall 0.5476190476190476, F1 0.4900623170616562, AUC 0.7081300981040565
  Second-Tier acc 0.5306122448979592, precision 0.5072055137844612, recall 0.5542328042328043, F1 0.5031055900621119, AUC 0.7287808641975309
epoch: 4 idx: 0 First Loss : 3.02394437789917, Second Loss : 3.039958953857422
epoch: 4 idx: 200 First Loss : 0.924237903161206, Second Loss : 0.9243854630868233
  First-Tier acc 0.4947916666666667, precision 0.5570436507936508, recall 0.5478535353535353, F1 0.4912962962962963, AUC 0.7582007575757576
  Second-Tier acc 0.4791666666666667, precision 0.5267115600448934, recall 0.5164646464646464, F1 0.45037185037185035, AUC 0.7761616161616162
  First-Tier acc 0.44387755102040816, precision 0.4865219449516467, recall 0.5282186948853616, F1 0.4343176557116866, AUC 0.7238033234126983
  Second-Tier acc 0.42857142857142855, precision 0.4385964912280702, recall 0.4810405643738977, F1 0.4147053457398285, AUC 0.7299382716049383
epoch: 5 idx: 0 First Loss : 3.162111759185791, Second Loss : 3.256105899810791
epoch: 5 idx: 200 First Loss : 0.9120435462013554, Second Loss : 0.9124372266325637
  First-Tier acc 0.421875, precision 0.5108730158730159, recall 0.48358585858585856, F1 0.41419803600654664, AUC 0.7606470959595959
  Second-Tier acc 0.4583333333333333, precision 0.5337301587301587, recall 0.5201010101010101, F1 0.44068950373298205, AUC 0.8019696969696971
  First-Tier acc 0.40816326530612246, precision 0.4916728258191673, recall 0.5024801587301587, F1 0.39623396123523874, AUC 0.7241856812169312
  Second-Tier acc 0.40816326530612246, precision 0.4544444444444445, recall 0.48655202821869487, F1 0.3892773892773893, AUC 0.7356701940035274
epoch: 6 idx: 0 First Loss : 3.16184139251709, Second Loss : 3.272122859954834
epoch: 6 idx: 200 First Loss : 0.9030477419097106, Second Loss : 0.9022420460534333
  First-Tier acc 0.4270833333333333, precision 0.5239400863163239, recall 0.5051515151515151, F1 0.4242649327311602, AUC 0.7562752525252526
  Second-Tier acc 0.5, precision 0.5757469654528478, recall 0.5976767676767677, F1 0.4953703703703704, AUC 0.8072222222222222
  First-Tier acc 0.4030612244897959, precision 0.5079312865497075, recall 0.5076609347442681, F1 0.40249418822647165, AUC 0.7250296241181657
  Second-Tier acc 0.46938775510204084, precision 0.5394736842105262, recall 0.5694444444444444, F1 0.47024297024297024, AUC 0.7298831569664904
epoch: 7 idx: 0 First Loss : 3.120659112930298, Second Loss : 3.2473325729370117
epoch: 7 idx: 200 First Loss : 0.8949599263874527, Second Loss : 0.8937756455369035
  First-Tier acc 0.4166666666666667, precision 0.5151215888852313, recall 0.5103030303030304, F1 0.41102700682179233, AUC 0.7499147727272727
  Second-Tier acc 0.4791666666666667, precision 0.5842490842490843, recall 0.5774747474747475, F1 0.4826068376068376, AUC 0.8049494949494949
  First-Tier acc 0.42857142857142855, precision 0.524716492458428, recall 0.5179673721340388, F1 0.42685235715932457, AUC 0.7228457065696648
  Second-Tier acc 0.4897959183673469, precision 0.5639859808657762, recall 0.6047178130511464, F1 0.496976976976977, AUC 0.7379850088183422
epoch: 8 idx: 0 First Loss : 3.1000704765319824, Second Loss : 3.215479612350464
epoch: 8 idx: 200 First Loss : 0.8864065911620855, Second Loss : 0.8827521306652557
  First-Tier acc 0.375, precision 0.49153439153439155, recall 0.4632323232323232, F1 0.36130042881811036, AUC 0.7463226010101011
  Second-Tier acc 0.375, precision 0.47899159663865537, recall 0.4385858585858586, F1 0.34332358674463936, AUC 0.8038888888888889
  First-Tier acc 0.42346938775510207, precision 0.5240129123749813, recall 0.49988977072310403, F1 0.4192136205098702, AUC 0.7213817239858907
  Second-Tier acc 0.5102040816326531, precision 0.6181818181818182, recall 0.5928130511463845, F1 0.5096377306903622, AUC 0.7432208994708994
epoch: 9 idx: 0 First Loss : 3.0752367973327637, Second Loss : 3.1982719898223877
epoch: 9 idx: 200 First Loss : 0.8612273386795426, Second Loss : 0.8546737953279149
  First-Tier acc 0.3697916666666667, precision 0.48966408268733846, recall 0.4562878787878788, F1 0.3550640402978816, AUC 0.7459343434343434
  Second-Tier acc 0.375, precision 0.4681467181467181, recall 0.44111111111111106, F1 0.3194444444444444, AUC 0.8019696969696971
  First-Tier acc 0.4336734693877551, precision 0.5371189094593349, recall 0.49840167548500885, F1 0.4197583059541488, AUC 0.7205102237654321
  Second-Tier acc 0.4897959183673469, precision 0.5956989247311828, recall 0.5511463844797179, F1 0.4783068783068783, AUC 0.7445987654320988{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.19625150071544503, "droprate_2": 0.0, "lr": 5.8210335021260544e-05, "weight_decay": 0.0005514101306611265, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0906003713607788, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1172585628222471, Second Loss : 1.112850462026264
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7436679292929292
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7377272727272728
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6828014770723104
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6865079365079364
epoch: 1 idx: 0 First Loss : 1.9783905744552612, Second Loss : 2.053915023803711
epoch: 1 idx: 200 First Loss : 1.0278382310968133, Second Loss : 1.0353010080347014
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7398895202020203
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7462626262626261
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7086674658289241
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7062389770723104
epoch: 2 idx: 0 First Loss : 2.2970430850982666, Second Loss : 2.3434700965881348
epoch: 2 idx: 200 First Loss : 0.9757522389440987, Second Loss : 0.9863033349537731
  First-Tier acc 0.6770833333333334, precision 0.6986642380085003, recall 0.5962626262626263, F1 0.5409732658021187, AUC 0.7340025252525253
  Second-Tier acc 0.625, precision 0.4970899470899471, recall 0.4992929292929293, F1 0.47500000000000003, AUC 0.7485858585858587
  First-Tier acc 0.5918367346938775, precision 0.5758484848484848, recall 0.5029761904761905, F1 0.5207986956913996, AUC 0.6924258708112875
  Second-Tier acc 0.6326530612244898, precision 0.6123737373737373, recall 0.5981040564373897, F1 0.602251461988304, AUC 0.6949955908289241
epoch: 3 idx: 0 First Loss : 2.7325644493103027, Second Loss : 2.737239122390747
epoch: 3 idx: 200 First Loss : 0.9425066180193602, Second Loss : 0.9492397602110063
  First-Tier acc 0.5833333333333334, precision 0.5626021370207416, recall 0.5819444444444445, F1 0.5542062457316695, AUC 0.74375
  Second-Tier acc 0.5833333333333334, precision 0.5631578947368422, recall 0.5762626262626264, F1 0.5606060606060606, AUC 0.7612626262626262
  First-Tier acc 0.5561224489795918, precision 0.5434106446872405, recall 0.58206569664903, F1 0.5451932677751598, AUC 0.7048714451058201
  Second-Tier acc 0.5510204081632653, precision 0.5286179249027546, recall 0.5601851851851852, F1 0.5266590974865869, AUC 0.7297729276895945
epoch: 4 idx: 0 First Loss : 3.1739633083343506, Second Loss : 3.169090747833252
epoch: 4 idx: 200 First Loss : 0.9299944367222673, Second Loss : 0.9310736069687415
  First-Tier acc 0.546875, precision 0.5776370076761584, recall 0.5887626262626262, F1 0.5396239217493164, AUC 0.7563131313131314
  Second-Tier acc 0.5833333333333334, precision 0.6153846153846153, recall 0.6416161616161616, F1 0.585610661268556, AUC 0.7834343434343435
  First-Tier acc 0.5, precision 0.5158045977011495, recall 0.5570436507936508, F1 0.4981520854660471, AUC 0.7210475914902998
  Second-Tier acc 0.5510204081632653, precision 0.5549019607843136, recall 0.6009700176366842, F1 0.5538324420677362, AUC 0.7261353615520282
epoch: 5 idx: 0 First Loss : 3.4679758548736572, Second Loss : 3.5179343223571777
epoch: 5 idx: 200 First Loss : 0.9239714658490165, Second Loss : 0.9229344793164463
  First-Tier acc 0.4947916666666667, precision 0.553816716139922, recall 0.5547979797979797, F1 0.4932925051035287, AUC 0.7627272727272727
  Second-Tier acc 0.5, precision 0.6001277139208174, recall 0.5619191919191919, F1 0.49682539682539684, AUC 0.810959595959596
  First-Tier acc 0.49489795918367346, precision 0.5366552511415525, recall 0.5714836860670194, F1 0.49170464819319787, AUC 0.7242166832010583
  Second-Tier acc 0.5714285714285714, precision 0.5833333333333334, recall 0.6362433862433862, F1 0.5817580126025658, AUC 0.732418430335097
epoch: 6 idx: 0 First Loss : 3.591747760772705, Second Loss : 3.7232820987701416
epoch: 6 idx: 200 First Loss : 0.9219528223985611, Second Loss : 0.9173822076296183
  First-Tier acc 0.4427083333333333, precision 0.5195887445887445, recall 0.5002525252525252, F1 0.44334442913988364, AUC 0.7571811868686869
  Second-Tier acc 0.4583333333333333, precision 0.5361111111111111, recall 0.5063636363636363, F1 0.43403019744483157, AUC 0.816969696969697
  First-Tier acc 0.4642857142857143, precision 0.521073521073521, recall 0.5399029982363316, F1 0.4608391608391608, AUC 0.7249193948412698
  Second-Tier acc 0.5306122448979592, precision 0.5388888888888889, recall 0.5529100529100529, F1 0.5140629351155667, AUC 0.7410714285714285
epoch: 7 idx: 0 First Loss : 3.6569578647613525, Second Loss : 3.8347928524017334
epoch: 7 idx: 200 First Loss : 0.9198421257992845, Second Loss : 0.9138021317417201
  First-Tier acc 0.453125, precision 0.5318112633181126, recall 0.5124242424242424, F1 0.4519844913784308, AUC 0.7474968434343435
  Second-Tier acc 0.4583333333333333, precision 0.5361111111111111, recall 0.5063636363636363, F1 0.43403019744483157, AUC 0.8133838383838384
  First-Tier acc 0.4489795918367347, precision 0.5260006355896767, recall 0.5099206349206349, F1 0.44263038548752837, AUC 0.7221326609347442
  Second-Tier acc 0.4897959183673469, precision 0.5109557109557109, recall 0.5282186948853616, F1 0.47795771479982, AUC 0.7474096119929454
epoch: 8 idx: 0 First Loss : 3.6763596534729004, Second Loss : 3.924455165863037
epoch: 8 idx: 200 First Loss : 0.9156192580390888, Second Loss : 0.9104923712464967
  First-Tier acc 0.453125, precision 0.5328860540200016, recall 0.5172979797979799, F1 0.45239266824446367, AUC 0.7349779040404041
  Second-Tier acc 0.4375, precision 0.4979091995221028, recall 0.4955555555555556, F1 0.39813258636788046, AUC 0.7881818181818181
  First-Tier acc 0.4642857142857143, precision 0.5429223861012414, recall 0.5233134920634921, F1 0.4551930757543206, AUC 0.718636326058201
  Second-Tier acc 0.5102040816326531, precision 0.5400155400155401, recall 0.5520282186948854, F1 0.49462438146648674, AUC 0.7611882716049383
epoch: 9 idx: 0 First Loss : 3.658933639526367, Second Loss : 3.938422441482544
epoch: 9 idx: 200 First Loss : 0.9110158351898675, Second Loss : 0.9051220497042312
  First-Tier acc 0.4375, precision 0.5179346796993856, recall 0.5013383838383838, F1 0.43233658859793156, AUC 0.7212247474747474
  Second-Tier acc 0.4375, precision 0.49259259259259264, recall 0.4955555555555556, F1 0.3992165972079889, AUC 0.7571717171717172
  First-Tier acc 0.4642857142857143, precision 0.5457963936224806, recall 0.5290454144620812, F1 0.45515554956856236, AUC 0.7195250496031745
  Second-Tier acc 0.5306122448979592, precision 0.5723905723905723, recall 0.5758377425044091, F1 0.5109114249037227, AUC 0.7700066137566138{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_19", "train_show_freq": 200, "droprate": 0.12598769054973097, "droprate_2": 0.0, "lr": 9.51601915753195e-05, "weight_decay": 2.2375428687280432e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 3, "gamma": 0.37968858907125186, "T_max": 12, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_19", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.082688570022583, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1099249938530709, Second Loss : 1.1079577642738523
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7480429292929293
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7479797979797981
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7033867945326279
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7090498236331569
epoch: 1 idx: 0 First Loss : 1.8134676218032837, Second Loss : 1.954658031463623
epoch: 1 idx: 200 First Loss : 1.0021146433566934, Second Loss : 1.0033291553086903
  First-Tier acc 0.5729166666666666, precision 0.37225826382452887, recall 0.42606060606060603, F1 0.3739348370927318, AUC 0.7333838383838384
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.745
  First-Tier acc 0.5816326530612245, precision 0.325, recall 0.36904761904761907, F1 0.3055555555555555, AUC 0.6945477843915344
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.7055224867724866
epoch: 2 idx: 0 First Loss : 2.394160747528076, Second Loss : 2.509735584259033
epoch: 2 idx: 200 First Loss : 0.9530100404326596, Second Loss : 0.955037179277904
  First-Tier acc 0.5677083333333334, precision 0.5035919540229885, recall 0.5353787878787879, F1 0.45846434267486896, AUC 0.729665404040404
  Second-Tier acc 0.6041666666666666, precision 0.4798474945533769, recall 0.5198989898989899, F1 0.4775641025641026, AUC 0.7487373737373737
  First-Tier acc 0.5255102040816326, precision 0.4988795518207283, recall 0.458994708994709, F1 0.43638235885071325, AUC 0.6948784722222223
  Second-Tier acc 0.5918367346938775, precision 0.5740740740740741, recall 0.5963403880070547, F1 0.5830065359477125, AUC 0.7193011463844797
epoch: 3 idx: 0 First Loss : 3.1423301696777344, Second Loss : 3.0953848361968994
epoch: 3 idx: 200 First Loss : 0.9150770468016466, Second Loss : 0.9124178705153181
  First-Tier acc 0.421875, precision 0.5036758563074353, recall 0.48358585858585856, F1 0.41259435144117734, AUC 0.7467676767676767
  Second-Tier acc 0.4583333333333333, precision 0.5248677248677248, recall 0.5056565656565657, F1 0.4437095919448861, AUC 0.7887373737373737
  First-Tier acc 0.413265306122449, precision 0.47547829718372353, recall 0.5084325396825397, F1 0.40349279152170814, AUC 0.7235105268959435
  Second-Tier acc 0.42857142857142855, precision 0.4577089577089577, recall 0.5103615520282186, F1 0.4174603174603175, AUC 0.7417879188712523
epoch: 4 idx: 0 First Loss : 2.788029909133911, Second Loss : 2.8666718006134033
epoch: 4 idx: 200 First Loss : 0.8983516480718086, Second Loss : 0.892763360713919
  First-Tier acc 0.40625, precision 0.4989651798162436, recall 0.4638383838383839, F1 0.3891802641802642, AUC 0.7514109848484848
  Second-Tier acc 0.4583333333333333, precision 0.5361111111111111, recall 0.5226262626262627, F1 0.4497994497994498, AUC 0.7925757575757576
  First-Tier acc 0.39285714285714285, precision 0.4846096096096096, recall 0.4976851851851852, F1 0.38132786753476405, AUC 0.7218639770723104
  Second-Tier acc 0.4489795918367347, precision 0.5237076648841354, recall 0.5456349206349206, F1 0.4467499757822339, AUC 0.73423721340388
epoch: 5 idx: 0 First Loss : 3.0187277793884277, Second Loss : 3.1437177658081055
epoch: 5 idx: 200 First Loss : 0.9033405717916378, Second Loss : 0.8948489346110554
  First-Tier acc 0.4270833333333333, precision 0.5284327209614567, recall 0.5045202020202021, F1 0.4248485719073954, AUC 0.7563604797979798
  Second-Tier acc 0.4375, precision 0.5273410799726589, recall 0.5118181818181818, F1 0.43480392156862746, AUC 0.7942424242424243
  First-Tier acc 0.3877551020408163, precision 0.49869431643625184, recall 0.5015983245149912, F1 0.38460718965728496, AUC 0.7201898699294532
  Second-Tier acc 0.46938775510204084, precision 0.5477582846003898, recall 0.5809082892416225, F1 0.4706838499941948, AUC 0.7364969135802469
epoch: 6 idx: 0 First Loss : 3.1393814086914062, Second Loss : 3.3192217350006104
epoch: 6 idx: 200 First Loss : 0.8995808815787458, Second Loss : 0.8879684737202391
  First-Tier acc 0.3489583333333333, precision 0.4641473224686998, recall 0.44169191919191925, F1 0.3351119982257707, AUC 0.7476420454545455
  Second-Tier acc 0.3541666666666667, precision 0.4682539682539682, recall 0.42525252525252527, F1 0.3226298565488054, AUC 0.7862626262626263
  First-Tier acc 0.3877551020408163, precision 0.5260914760914761, recall 0.47828483245149905, F1 0.3783582962940099, AUC 0.7184813161375662
  Second-Tier acc 0.46938775510204084, precision 0.5496296296296296, recall 0.5630511463844797, F1 0.47590734547256286, AUC 0.746362433862434
epoch: 7 idx: 0 First Loss : 2.977064847946167, Second Loss : 3.1959869861602783
epoch: 7 idx: 200 First Loss : 0.8872109114178526, Second Loss : 0.8749142940971648
  First-Tier acc 0.3333333333333333, precision 0.4486341545165075, recall 0.42148989898989897, F1 0.31285790796358093, AUC 0.7472601010101011
  Second-Tier acc 0.3333333333333333, precision 0.425925925925926, recall 0.3974747474747475, F1 0.2864078903886728, AUC 0.7908080808080807
  First-Tier acc 0.3877551020408163, precision 0.5293216303082722, recall 0.47222222222222215, F1 0.3755339406103649, AUC 0.7139136904761906
  Second-Tier acc 0.4897959183673469, precision 0.5742482294206432, recall 0.5690035273368607, F1 0.49412938029829095, AUC 0.748015873015873
epoch: 8 idx: 0 First Loss : 3.050109386444092, Second Loss : 3.2800683975219727
epoch: 8 idx: 200 First Loss : 0.8891748495687225, Second Loss : 0.8754440830645165
  First-Tier acc 0.34375, precision 0.45668725559286427, recall 0.4366414141414141, F1 0.3208273208273208, AUC 0.7462089646464646
  Second-Tier acc 0.3125, precision 0.4123123123123124, recall 0.3841414141414141, F1 0.26481481481481484, AUC 0.7948484848484849
  First-Tier acc 0.37755102040816324, precision 0.5220487881402462, recall 0.4603174603174603, F1 0.36690628704344924, AUC 0.7112371858465609
  Second-Tier acc 0.5102040816326531, precision 0.6181818181818182, recall 0.5928130511463845, F1 0.5096377306903622, AUC 0.7588183421516755
epoch: 9 idx: 0 First Loss : 3.081498861312866, Second Loss : 3.3320815563201904
epoch: 9 idx: 200 First Loss : 0.8830261299252251, Second Loss : 0.8675450320814305
  First-Tier acc 0.3385416666666667, precision 0.45965106472696604, recall 0.43095959595959593, F1 0.3073984299408485, AUC 0.7443276515151515
  Second-Tier acc 0.3125, precision 0.4505420054200542, recall 0.40111111111111114, F1 0.25443560271146476, AUC 0.7925252525252525
  First-Tier acc 0.39285714285714285, precision 0.5363981002278875, recall 0.4631834215167548, F1 0.36832566715594744, AUC 0.7106757054673721
  Second-Tier acc 0.4897959183673469, precision 0.6064814814814815, recall 0.5511463844797179, F1 0.4831567409572524, AUC 0.7664241622574957