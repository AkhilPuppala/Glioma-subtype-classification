{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_31", "train_show_freq": 200, "droprate": 0.2807521692938719, "droprate_2": 0.0, "lr": 1.0128084044821196e-05, "weight_decay": 4.0655161295938285e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_31", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0128084044821196e-05
epoch: 0 idx: 0 First Loss : 1.2456421852111816, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0514219805079312, Second Loss : 1.036082972341509
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6629236812570146
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7508080808080808
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6047729276895943
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6079144620811288
Test AUC: 0.6079, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0128084044821196e-05
epoch: 1 idx: 0 First Loss : 1.9812394380569458, Second Loss : 1.9100055694580078
epoch: 1 idx: 200 First Loss : 1.0974727310796282, Second Loss : 1.0873712054384288
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7046632996632997
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7564141414141415
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6459925533999609
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6538249559082893
Test AUC: 0.6538, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0128084044821196e-05
epoch: 2 idx: 0 First Loss : 2.1432926654815674, Second Loss : 2.080289125442505
epoch: 2 idx: 200 First Loss : 1.098500079628247, Second Loss : 1.0866350286190782
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7207687991021324
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7618686868686869
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6748848716441308
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6959325396825397
Test AUC: 0.6959, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0128084044821196e-05
epoch: 3 idx: 0 First Loss : 2.199296712875366, Second Loss : 2.140279769897461
epoch: 3 idx: 200 First Loss : 1.0883775785639511, Second Loss : 1.076211682451305
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7318574635241303
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7665151515151515
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6927726337448559
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7042548500881834
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 4 idx: 0 First Loss : 2.2684848308563232, Second Loss : 2.2038638591766357
epoch: 4 idx: 200 First Loss : 1.078143102909202, Second Loss : 1.0657559801541752
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7414029180695847
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7027238879090731
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7116953262786595
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 5 idx: 0 First Loss : 2.3385982513427734, Second Loss : 2.27103590965271
epoch: 5 idx: 200 First Loss : 1.0668359709468054, Second Loss : 1.0552290008954741
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7409259259259259
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7530303030303029
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.711713697824809
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7159942680776014
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 6 idx: 0 First Loss : 2.4231491088867188, Second Loss : 2.345472574234009
epoch: 6 idx: 200 First Loss : 1.0554147796399558, Second Loss : 1.0442670004358932
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7390404040404039
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.751969696969697
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7132752792475016
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7152226631393299
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 7 idx: 0 First Loss : 2.514540910720825, Second Loss : 2.421924114227295
epoch: 7 idx: 200 First Loss : 1.0412246865493742, Second Loss : 1.0316130205321667
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5763888888888888, precision 0.4014550264550265, recall 0.4254545454545455, F1 0.3781771415033675, AUC 0.7369135802469136
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7534343434343436
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5986394557823129, precision 0.6318627450980393, recall 0.41269841269841273, F1 0.3824686159224535, AUC 0.7095397315304725
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7122464726631392
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 8 idx: 0 First Loss : 2.614546537399292, Second Loss : 2.505141019821167
epoch: 8 idx: 200 First Loss : 1.026379890795519, Second Loss : 1.0180664535852808
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6458333333333334, precision 0.6116599910992434, recall 0.5344107744107744, F1 0.5125649544254195, AUC 0.7370931537598203
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7553030303030303
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6802721088435374, precision 0.7254256965944273, recall 0.5844356261022927, F1 0.6086701434159062, AUC 0.7026014109347442
  Second-Tier acc 0.6122448979591837, precision 0.5460030165912518, recall 0.46847442680776014, F1 0.46618093503339403, AUC 0.7108686067019399
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 9 idx: 0 First Loss : 2.724409818649292, Second Loss : 2.6033167839050293
epoch: 9 idx: 200 First Loss : 1.0112654337131266, Second Loss : 1.0030416620904534
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6666666666666666, precision 0.6206498058160462, recall 0.6023905723905724, F1 0.6026293703430771, AUC 0.7336475869809203
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7554545454545454
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5986394557823129, precision 0.5598290598290598, recall 0.5813492063492064, F1 0.567978880347853, AUC 0.706483931020968
  Second-Tier acc 0.5918367346938775, precision 0.5361111111111111, recall 0.531305114638448, F1 0.5208647561588738, AUC 0.7137896825396824
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 10 idx: 0 First Loss : 2.841038703918457, Second Loss : 2.7167599201202393
epoch: 10 idx: 200 First Loss : 0.9973478782644023, Second Loss : 0.9901707791422137
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6111111111111112, precision 0.575036075036075, recall 0.5852525252525252, F1 0.5766903073286053, AUC 0.7318911335578001
  Second-Tier acc 0.6041666666666666, precision 0.5489177489177489, recall 0.5682828282828283, F1 0.5212505214851898, AUC 0.7535858585858586
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5782312925170068, precision 0.5425058033753686, recall 0.5766460905349794, F1 0.5508046567368602, AUC 0.7066247795414462
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.730489417989418
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 11 idx: 0 First Loss : 2.9575250148773193, Second Loss : 2.8299691677093506
epoch: 11 idx: 200 First Loss : 0.9850798120712908, Second Loss : 0.9794758312330021
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5694444444444444, precision 0.5608000776068004, recall 0.577003367003367, F1 0.5531675296381179, AUC 0.7318181818181818
  Second-Tier acc 0.5416666666666666, precision 0.5790123456790123, recall 0.5596969696969697, F1 0.5032163742690058, AUC 0.7627272727272727
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5170068027210885, precision 0.4976593052680009, recall 0.5400499706055262, F1 0.49375586798189364, AUC 0.7080822555359593
  Second-Tier acc 0.6530612244897959, precision 0.6565656565656566, recall 0.7149470899470899, F1 0.6639146886824906, AUC 0.7390873015873015
Test AUC: 0.7043, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0128084044821196e-05
epoch: 12 idx: 0 First Loss : 3.0698394775390625, Second Loss : 2.9362831115722656
epoch: 12 idx: 200 First Loss : 0.974417684192014, Second Loss : 0.970152633162725
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5138888888888888, precision 0.5416988218346453, recall 0.5445791245791246, F1 0.5041894472994347, AUC 0.7318742985409652
  Second-Tier acc 0.5, precision 0.5524475524475525, recall 0.5474747474747474, F1 0.4813073943508726, AUC 0.7773232323232323
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46938775510204084, precision 0.4844762820953297, recall 0.5269694297472075, F1 0.45894993894993896, AUC 0.7149042230060748
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7554563492063492
Test AUC: 0.7555, Test F1: 0.5841 (Best Epoch: 12)
Current LR: 1.0128084044821196e-05
epoch: 13 idx: 0 First Loss : 3.1655075550079346, Second Loss : 3.0328192710876465
epoch: 13 idx: 200 First Loss : 0.9653814704301049, Second Loss : 0.9622179762233253
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4652777777777778, precision 0.507509881422925, recall 0.5021548821548821, F1 0.45642728829845014, AUC 0.7351571268237934
  Second-Tier acc 0.5, precision 0.5724867724867725, recall 0.5763636363636363, F1 0.49589408412937824, AUC 0.7904040404040403
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4557823129251701, precision 0.4891636141636142, recall 0.5225602586713697, F1 0.4495862884160757, AUC 0.7205381638252009
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7639440035273367
Test AUC: 0.7639, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0128084044821196e-05
epoch: 14 idx: 0 First Loss : 3.2529046535491943, Second Loss : 3.1218924522399902
epoch: 14 idx: 200 First Loss : 0.9584225369756346, Second Loss : 0.9560884039070624
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4722222222222222, precision 0.5325634956176828, recall 0.5227272727272727, F1 0.46680829930471246, AUC 0.7464309764309766
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.7956565656565656
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.4966051492367282, recall 0.52608759553204, F1 0.4482163406214039, AUC 0.7248922202625906
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7705577601410935
Test AUC: 0.7706, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0128084044821196e-05
epoch: 15 idx: 0 First Loss : 3.332819700241089, Second Loss : 3.201749086380005
epoch: 15 idx: 200 First Loss : 0.9526315146028551, Second Loss : 0.9511780577632992
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4444444444444444, precision 0.5168924607730578, recall 0.5049494949494949, F1 0.4402474776318294, AUC 0.7491638608305276
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.811969696969697
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5032925913617173, recall 0.52608759553204, F1 0.4493209856102667, AUC 0.7301587301587302
  Second-Tier acc 0.5306122448979592, precision 0.5907608695652175, recall 0.6408730158730159, F1 0.5367867867867869, AUC 0.7749118165784833
Test AUC: 0.7749, Test F1: 0.5368 (Best Epoch: 15)
Current LR: 1.0128084044821196e-05
epoch: 16 idx: 0 First Loss : 3.4033401012420654, Second Loss : 3.27260160446167
epoch: 16 idx: 200 First Loss : 0.9478724750722596, Second Loss : 0.946941005293076
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4444444444444444, precision 0.5298952771421307, recall 0.5106060606060606, F1 0.4419803476946334, AUC 0.7517732884399551
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8128787878787879
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4557823129251701, precision 0.5280547409579668, recall 0.5416666666666666, F1 0.4571150995201629, AUC 0.7351557907113463
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7744157848324517
Test AUC: 0.7744, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0128084044821196e-05
epoch: 17 idx: 0 First Loss : 3.4635941982269287, Second Loss : 3.333833694458008
epoch: 17 idx: 200 First Loss : 0.9435815566256457, Second Loss : 0.9430436814222393
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4375, precision 0.5296508262609957, recall 0.5078451178451179, F1 0.43796723337553506, AUC 0.753973063973064
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8156565656565656
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4557823129251701, precision 0.5417422084088751, recall 0.5493092298647855, F1 0.4579607210822953, AUC 0.7378931510875955
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7786596119929453
Test AUC: 0.7787, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0128084044821196e-05
epoch: 18 idx: 0 First Loss : 3.515979051589966, Second Loss : 3.3849005699157715
epoch: 18 idx: 200 First Loss : 0.9396131797716837, Second Loss : 0.9394371791080159
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4305555555555556, precision 0.52929907595222, recall 0.5203703703703704, F1 0.43004636771158244, AUC 0.7569360269360269
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8135353535353534
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4557823129251701, precision 0.5575013419216318, recall 0.5569517930629041, F1 0.4585750585750586, AUC 0.7394424848128551
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7820216049382717
Test AUC: 0.7787, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0128084044821196e-05
epoch: 19 idx: 0 First Loss : 3.5596368312835693, Second Loss : 3.428386688232422
epoch: 19 idx: 200 First Loss : 0.9358079640764687, Second Loss : 0.936145841322413
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5428764251457454, recall 0.5414141414141413, F1 0.44453486702182227, AUC 0.7602188552188552
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8141919191919192
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46938775510204084, precision 0.5756673881673882, recall 0.5804673721340388, F1 0.47431324201741104, AUC 0.7430922986478542
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7845017636684304
Test AUC: 0.7787, Test F1: 0.5320 (Best Epoch: 17)