{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_34", "train_show_freq": 200, "droprate": 0.29643167538774506, "droprate_2": 0.0, "lr": 2.016668053805085e-05, "weight_decay": 0.0001424141418026363, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_34", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 2.016668053805085e-05
epoch: 0 idx: 0 First Loss : 1.2460771799087524, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.097127842814175, Second Loss : 1.0810691712804101
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6968911335578002
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7457070707070708
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6388031550068587
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.640542328042328
Test AUC: 0.6405, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 2.016668053805085e-05
epoch: 1 idx: 0 First Loss : 2.145458936691284, Second Loss : 2.064335346221924
epoch: 1 idx: 200 First Loss : 1.097859414804041, Second Loss : 1.088692741533417
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7297194163860831
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7641414141414141
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6874816284538506
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6998456790123457
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 2 idx: 0 First Loss : 2.254228353500366, Second Loss : 2.1694765090942383
epoch: 2 idx: 200 First Loss : 1.0733308056693764, Second Loss : 1.064036074933128
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7413748597081931
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7604545454545454
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7062267293748775
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7087191358024691
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 3 idx: 0 First Loss : 2.3996927738189697, Second Loss : 2.287792444229126
epoch: 3 idx: 200 First Loss : 1.0480981127391407, Second Loss : 1.0413250972085923
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5277777777777778, precision 0.5119047619047619, recall 0.3434343434343434, F1 0.25216598267213863, AUC 0.7381257014590347
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.7507070707070707
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7138876641191456
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7144510582010583
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 4 idx: 0 First Loss : 2.5766711235046387, Second Loss : 2.4365785121917725
epoch: 4 idx: 200 First Loss : 1.0220996016886696, Second Loss : 1.016734033674743
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.625, precision 0.6480895915678525, recall 0.4942424242424242, F1 0.5001063264221158, AUC 0.7365488215488215
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7493434343434343
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6462585034013606, precision 0.7547363031233999, recall 0.5256466784244562, F1 0.4830582245216391, AUC 0.7012480403684108
  Second-Tier acc 0.5918367346938775, precision 0.33638211382113825, recall 0.3924162257495591, F1 0.3458110516934046, AUC 0.7083333333333334
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 5 idx: 0 First Loss : 2.777176856994629, Second Loss : 2.6363699436187744
epoch: 5 idx: 200 First Loss : 0.9939253664024137, Second Loss : 0.9911305820430393
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5902777777777778, precision 0.5485485485485485, recall 0.5241414141414141, F1 0.5149583770868525, AUC 0.7306734006734006
  Second-Tier acc 0.6458333333333334, precision 0.5912280701754385, recall 0.594949494949495, F1 0.5499999999999999, AUC 0.7468181818181817
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5102040816326531, precision 0.45396825396825397, recall 0.4896384479717813, F1 0.44725721978817284, AUC 0.699974279835391
  Second-Tier acc 0.6530612244897959, precision 0.6437400318979266, recall 0.6677689594356261, F1 0.6482426303854875, AUC 0.7153880070546736
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 6 idx: 0 First Loss : 3.013627052307129, Second Loss : 2.8677117824554443
epoch: 6 idx: 200 First Loss : 0.9707087359914732, Second Loss : 0.9704264868699496
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5138888888888888, precision 0.5113247863247864, recall 0.49764309764309766, F1 0.4587086764530373, AUC 0.7316329966329965
  Second-Tier acc 0.5833333333333334, precision 0.5927350427350427, recall 0.6127272727272728, F1 0.5702150537634408, AUC 0.7552525252525252
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.4680307254934121, recall 0.5277042915931806, F1 0.44006169269327167, AUC 0.7051489320007839
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7341820987654321
Test AUC: 0.6998, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 2.016668053805085e-05
epoch: 7 idx: 0 First Loss : 3.2286317348480225, Second Loss : 3.080415725708008
epoch: 7 idx: 200 First Loss : 0.953570873425597, Second Loss : 0.9554729119721633
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.4552215519034741, recall 0.4474410774410775, F1 0.37940705128205127, AUC 0.7388271604938271
  Second-Tier acc 0.5208333333333334, precision 0.5807017543859648, recall 0.5846464646464646, F1 0.5212493599590373, AUC 0.7753535353535354
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.48127380645931495, recall 0.5166078777189888, F1 0.4140693133992737, AUC 0.7147082598471487
  Second-Tier acc 0.4897959183673469, precision 0.5189102564102565, recall 0.58179012345679, F1 0.49836601307189543, AUC 0.7594246031746031
Test AUC: 0.7594, Test F1: 0.4984 (Best Epoch: 7)
Current LR: 2.016668053805085e-05
epoch: 8 idx: 0 First Loss : 3.4018194675445557, Second Loss : 3.2437665462493896
epoch: 8 idx: 200 First Loss : 0.9423249199875255, Second Loss : 0.9457873018152678
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4305555555555556, precision 0.48297035692679974, recall 0.4579124579124579, F1 0.3859993647909534, AUC 0.7469753086419754
  Second-Tier acc 0.5208333333333334, precision 0.5873015873015873, recall 0.5990909090909091, F1 0.5225889728932325, AUC 0.7862626262626263
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.47202380952380957, recall 0.5042621987066431, F1 0.39778239778239777, AUC 0.723649078973153
  Second-Tier acc 0.4897959183673469, precision 0.5316993464052288, recall 0.58179012345679, F1 0.49486173956762186, AUC 0.7640542328042329
Test AUC: 0.7641, Test F1: 0.4949 (Best Epoch: 8)
Current LR: 2.016668053805085e-05
epoch: 9 idx: 0 First Loss : 3.5386226177215576, Second Loss : 3.375251054763794
epoch: 9 idx: 200 First Loss : 0.9353057442566575, Second Loss : 0.9400416429418681
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4027777777777778, precision 0.45879790460435627, recall 0.44013468013468016, F1 0.3618718521438269, AUC 0.7501739618406283
  Second-Tier acc 0.5208333333333334, precision 0.5913299663299664, recall 0.6135353535353536, F1 0.5214006187637019, AUC 0.7971717171717172
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3945578231292517, precision 0.48794982887213884, recall 0.4859641387419165, F1 0.38365497430917994, AUC 0.7315059768763472
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.76956569664903
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 10 idx: 0 First Loss : 3.634350538253784, Second Loss : 3.4713213443756104
epoch: 10 idx: 200 First Loss : 0.9292847503657773, Second Loss : 0.9355355203939388
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3611111111111111, precision 0.4438961988304093, recall 0.40865319865319866, F1 0.3249639469332691, AUC 0.7537822671156005
  Second-Tier acc 0.4791666666666667, precision 0.5619047619047619, recall 0.5724242424242424, F1 0.47886119257086995, AUC 0.7940909090909091
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3945578231292517, precision 0.5136991869918699, recall 0.49360670194003525, F1 0.38870992483509736, AUC 0.7357742994317068
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7819113756613757
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 11 idx: 0 First Loss : 3.7084171772003174, Second Loss : 3.5456371307373047
epoch: 11 idx: 200 First Loss : 0.9240556894732055, Second Loss : 0.9320686282891205
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.375, precision 0.46905684754521965, recall 0.4353535353535354, F1 0.3536530887718561, AUC 0.7613860830527498
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7939898989898989
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3945578231292517, precision 0.5135467214134627, recall 0.49147560258671374, F1 0.3917246299268771, AUC 0.7403671859690378
  Second-Tier acc 0.4897959183673469, precision 0.5928571428571429, recall 0.6047178130511464, F1 0.49047619047619045, AUC 0.7895171957671958
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 12 idx: 0 First Loss : 3.7527453899383545, Second Loss : 3.5915944576263428
epoch: 12 idx: 200 First Loss : 0.9199224032243871, Second Loss : 0.9282388740094073
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4027777777777778, precision 0.4979530273647921, recall 0.48141414141414146, F1 0.3907090100649291, AUC 0.7613804713804714
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7913636363636364
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.5473377846259202, recall 0.5270429159318049, F1 0.4225561714747526, AUC 0.7441272290809328
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7918871252204586
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 13 idx: 0 First Loss : 3.7989883422851562, Second Loss : 3.6242923736572266
epoch: 13 idx: 200 First Loss : 0.9147133978225049, Second Loss : 0.9252981359500494
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4236111111111111, precision 0.5207463630613535, recall 0.515084175084175, F1 0.4204348581311221, AUC 0.7629685746352414
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7906060606060606
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.5554435483870968, recall 0.5388007054673721, F1 0.4306584415249206, AUC 0.7494121105232217
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.7915564373897707
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 14 idx: 0 First Loss : 3.8220489025115967, Second Loss : 3.6366097927093506
epoch: 14 idx: 200 First Loss : 0.9098235077041651, Second Loss : 0.9220366103190057
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4305555555555556, precision 0.5284820031298905, recall 0.5228956228956229, F1 0.4289554531490016, AUC 0.7599270482603817
  Second-Tier acc 0.375, precision 0.4777777777777778, recall 0.4505050505050505, F1 0.36418705066130075, AUC 0.7855050505050505
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4557823129251701, precision 0.5763555105826798, recall 0.5764991181657848, F1 0.4588347995327234, AUC 0.755480844601215
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.794863315696649
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 15 idx: 0 First Loss : 3.817127227783203, Second Loss : 3.628709554672241
epoch: 15 idx: 200 First Loss : 0.9053755865770563, Second Loss : 0.9192571838337705
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4027777777777778, precision 0.5046230517523466, recall 0.4980134680134681, F1 0.3952380952380952, AUC 0.7559652076318745
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7723737373737375
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46258503401360546, precision 0.5841750841750842, recall 0.5823045267489712, F1 0.46453226268662845, AUC 0.7567056143445033
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.7941468253968255
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 16 idx: 0 First Loss : 3.804138422012329, Second Loss : 3.6185238361358643
epoch: 16 idx: 200 First Loss : 0.901154240621694, Second Loss : 0.9170978980611509
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3958333333333333, precision 0.4980280228334199, recall 0.4944107744107744, F1 0.385518887142774, AUC 0.7502861952861953
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.75989898989899
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5800231711353856, recall 0.5681216931216931, F1 0.44955609362389026, AUC 0.7614087301587302
  Second-Tier acc 0.4897959183673469, precision 0.5767195767195767, recall 0.5511463844797179, F1 0.46871502481258576, AUC 0.7931547619047619
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 17 idx: 0 First Loss : 3.7821292877197266, Second Loss : 3.591667413711548
epoch: 17 idx: 200 First Loss : 0.8974488369132443, Second Loss : 0.9157442465107146
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3888888888888889, precision 0.49402852049910867, recall 0.48515151515151517, F1 0.3777306967984934, AUC 0.7433277216610549
  Second-Tier acc 0.3541666666666667, precision 0.4444444444444445, recall 0.42525252525252527, F1 0.3256840632922458, AUC 0.7440404040404042
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5806668346350886, recall 0.5600382128159906, F1 0.44433913447325696, AUC 0.762639623750735
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7897376543209877
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 18 idx: 0 First Loss : 3.7489817142486572, Second Loss : 3.553074598312378
epoch: 18 idx: 200 First Loss : 0.8938997208160483, Second Loss : 0.9141570144936452
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.48286435786435783, recall 0.4714478114478114, F1 0.3618347377285069, AUC 0.7352469135802467
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.723080808080808
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5738119312436805, recall 0.5399029982363316, F1 0.42410714285714285, AUC 0.7591429061336469
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7871472663139331
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)
Current LR: 2.016668053805085e-05
epoch: 19 idx: 0 First Loss : 3.710520029067993, Second Loss : 3.5093564987182617
epoch: 19 idx: 200 First Loss : 0.8907628837446984, Second Loss : 0.9133520894811318
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3541666666666667, precision 0.46137863942741997, recall 0.4484848484848485, F1 0.3368352514693978, AUC 0.7265488215488215
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7126767676767676
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.43537414965986393, precision 0.5729466074383764, recall 0.5339506172839507, F1 0.42158719759978736, AUC 0.7540723593964334
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7862103174603176
Test AUC: 0.7696, Test F1: 0.5109 (Best Epoch: 9)