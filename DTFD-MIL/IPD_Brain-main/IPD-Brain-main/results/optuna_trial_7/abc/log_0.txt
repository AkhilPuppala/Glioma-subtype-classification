{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.22614746713028172, "droprate_2": 0.0, "lr": 0.00022497400394167735, "weight_decay": 1.1687746179684866e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00022497400394167735
epoch: 0 idx: 0 First Loss : 0.9186561107635498, Second Loss : 1.0359247922897339
epoch: 0 idx: 200 First Loss : 1.0973990592938752, Second Loss : 1.0824195905333727
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4945044191919192
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5019696969696971
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4581025407848325
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4534832451499118
 
 test auc: 0.4534832451499118, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.22746752037160461, "droprate_2": 0.0, "lr": 1.8804392312806076e-05, "weight_decay": 0.0002771368129613356, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.8804392312806076e-05
epoch: 0 idx: 0 First Loss : 1.0722143650054932, Second Loss : 1.1648532152175903
epoch: 0 idx: 200 First Loss : 1.0679836497081452, Second Loss : 1.0668289278870198
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5281060606060607
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5054545454545455
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.43138916446208114
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46301807760141095
 
 test auc: 0.46301807760141095, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.8804392312806076e-05
epoch: 1 idx: 0 First Loss : 1.7769445180892944, Second Loss : 1.8041402101516724
epoch: 1 idx: 200 First Loss : 1.0669984336367888, Second Loss : 1.0708178741421865
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5164583333333334
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.503030303030303
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4399147100970018
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4510582010582011
 
 test auc: 0.46301807760141095, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 1.8804392312806076e-05
epoch: 2 idx: 0 First Loss : 1.8327367305755615, Second Loss : 1.8717856407165527
epoch: 2 idx: 200 First Loss : 1.0461647886393675, Second Loss : 1.051735869020372
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5085700757575758
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5083838383838384
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44585675705467365
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44246031746031744
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 3 idx: 0 First Loss : 1.886491298675537, Second Loss : 1.9255833625793457
epoch: 3 idx: 200 First Loss : 1.0299595786416116, Second Loss : 1.0383224222642273
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5036805555555556
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5023232323232323
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4508067405202822
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4486882716049383
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 4 idx: 0 First Loss : 1.946061134338379, Second Loss : 1.9808311462402344
epoch: 4 idx: 200 First Loss : 1.015412237587853, Second Loss : 1.025583141478733
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.25, precision 0.08465608465608465, recall 0.3333333333333333, F1 0.1350210970464135, AUC 0.4996180555555556
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5008080808080808
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45958719135802467
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4528218694885362
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 5 idx: 0 First Loss : 1.9968388080596924, Second Loss : 2.0352375507354736
epoch: 5 idx: 200 First Loss : 1.0018250713152672, Second Loss : 1.0127184878089535
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2708333333333333, precision 0.30836454431960053, recall 0.3648989898989899, F1 0.2111649134524406, AUC 0.4928535353535353
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.4912121212121212
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3010204081632653, precision 0.43005181347150256, recall 0.3645833333333333, F1 0.20707592273857334, AUC 0.46755125661375657
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46461640211640215
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 6 idx: 0 First Loss : 2.053483009338379, Second Loss : 2.1006641387939453
epoch: 6 idx: 200 First Loss : 0.989687623669259, Second Loss : 1.0015624979538704
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.265625, precision 0.2529979035639413, recall 0.3623737373737374, F1 0.24798711755233493, AUC 0.48418560606060607
  Second-Tier acc 0.2708333333333333, precision 0.24166666666666667, recall 0.37121212121212127, F1 0.2557354925775978, AUC 0.4816666666666667
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.30612244897959184, precision 0.31915544675642593, recall 0.41517857142857145, F1 0.3073615411076711, AUC 0.47943190586419754
  Second-Tier acc 0.2653061224489796, precision 0.09629629629629628, recall 0.30952380952380953, F1 0.14689265536723164, AUC 0.47536375661375657
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 7 idx: 0 First Loss : 2.105146884918213, Second Loss : 2.1602251529693604
epoch: 7 idx: 200 First Loss : 0.9768804838853096, Second Loss : 0.9882167050642754
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.28125, precision 0.25679012345679014, recall 0.3907828282828283, F1 0.2929125478397904, AUC 0.47940025252525253
  Second-Tier acc 0.2916666666666667, precision 0.2538902538902539, recall 0.404040404040404, F1 0.29066171923314776, AUC 0.4692929292929293
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3469387755102041, precision 0.4644403215831787, recall 0.4564594356261023, F1 0.3860347717741055, AUC 0.49127810846560843
  Second-Tier acc 0.24489795918367346, precision 0.42276422764227645, recall 0.30357142857142855, F1 0.2074074074074074, AUC 0.48897707231040566
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 8 idx: 0 First Loss : 2.1648547649383545, Second Loss : 2.2274646759033203
epoch: 8 idx: 200 First Loss : 0.9647912558779788, Second Loss : 0.9759844351393073
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3072916666666667, precision 0.31485559741137836, recall 0.418459595959596, F1 0.3198060826343902, AUC 0.4770991161616161
  Second-Tier acc 0.3541666666666667, precision 0.2713472485768501, recall 0.49747474747474746, F1 0.34662236987818384, AUC 0.4658585858585858
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.336734693877551, precision 0.4043291543291543, recall 0.4072971781305115, F1 0.3802491171503148, AUC 0.5080708498677249
  Second-Tier acc 0.2857142857142857, precision 0.28306342780026994, recall 0.2709435626102293, F1 0.25700483091787435, AUC 0.49140211640211634
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 9 idx: 0 First Loss : 2.213071346282959, Second Loss : 2.2905983924865723
epoch: 9 idx: 200 First Loss : 0.9533707140690059, Second Loss : 0.9645348117496837
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2916666666666667, precision 0.3163728632478633, recall 0.38318181818181823, F1 0.3079398017145612, AUC 0.47897411616161617
  Second-Tier acc 0.3333333333333333, precision 0.24440411373260737, recall 0.4696969696969697, F1 0.3197831978319783, AUC 0.46893939393939393
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.32142857142857145, precision 0.3633184718943964, recall 0.3897707231040564, F1 0.36067182596123865, AUC 0.5198447145061729
  Second-Tier acc 0.2857142857142857, precision 0.27976190476190477, recall 0.2594797178130512, F1 0.25438596491228066, AUC 0.5084876543209876
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 10 idx: 0 First Loss : 2.2572519779205322, Second Loss : 2.3503150939941406
epoch: 10 idx: 200 First Loss : 0.9417233712860008, Second Loss : 0.9529027059600128
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3125, precision 0.3336531390556325, recall 0.39840909090909093, F1 0.32313515087237715, AUC 0.48282828282828283
  Second-Tier acc 0.3125, precision 0.533816425120773, recall 0.4274747474747475, F1 0.2957935310876488, AUC 0.46484848484848484
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.33163265306122447, precision 0.3580977845683728, recall 0.39021164021164023, F1 0.3605035315561631, AUC 0.5277881117724869
  Second-Tier acc 0.24489795918367346, precision 0.242063492063492, recall 0.21186067019400354, F1 0.2172735760971055, AUC 0.519620811287478
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 11 idx: 0 First Loss : 2.2945268154144287, Second Loss : 2.404280424118042
epoch: 11 idx: 200 First Loss : 0.9312504365373013, Second Loss : 0.9426140108363545
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3177083333333333, precision 0.32957957957957956, recall 0.39217171717171717, F1 0.3207416298321213, AUC 0.48634785353535354
  Second-Tier acc 0.3125, precision 0.4126043039086517, recall 0.413030303030303, F1 0.3025210084033614, AUC 0.4694444444444445
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3520408163265306, precision 0.372763037581737, recall 0.4245480599647266, F1 0.3841759310371275, AUC 0.5344432043650793
  Second-Tier acc 0.2653061224489796, precision 0.29444444444444445, recall 0.2535273368606702, F1 0.2659627953745601, AUC 0.5285493827160495
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 12 idx: 0 First Loss : 2.330228090286255, Second Loss : 2.455076217651367
epoch: 12 idx: 200 First Loss : 0.9209530716437605, Second Loss : 0.9325078862964811
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.328125, precision 0.33675066566632833, recall 0.399469696969697, F1 0.32660795159414974, AUC 0.4892171717171718
  Second-Tier acc 0.2708333333333333, precision 0.2708333333333333, recall 0.3405050505050505, F1 0.2558441558441558, AUC 0.47484848484848485
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.36731348573453837, recall 0.43540564373897706, F1 0.3838963571969258, AUC 0.5402922453703703
  Second-Tier acc 0.2857142857142857, precision 0.3059649122807018, recall 0.26587301587301587, F1 0.27855477855477856, AUC 0.5352733686067018
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 13 idx: 0 First Loss : 2.3600239753723145, Second Loss : 2.5008325576782227
epoch: 13 idx: 200 First Loss : 0.9113012479052911, Second Loss : 0.9232233919907565
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3489583333333333, precision 0.34182769726247986, recall 0.4098232323232323, F1 0.33438314224452026, AUC 0.49243371212121206
  Second-Tier acc 0.2916666666666667, precision 0.27409781576448244, recall 0.37080808080808075, F1 0.2627113237639553, AUC 0.4771212121212121
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.37755102040816324, precision 0.3661380234757663, recall 0.43584656084656087, F1 0.38451826718219834, AUC 0.5443362819664903
  Second-Tier acc 0.2857142857142857, precision 0.3059649122807018, recall 0.26587301587301587, F1 0.27855477855477856, AUC 0.546957671957672
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 14 idx: 0 First Loss : 2.3891446590423584, Second Loss : 2.5385375022888184
epoch: 14 idx: 200 First Loss : 0.9026772307037417, Second Loss : 0.9148575095506153
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.3163398692810458, recall 0.3841161616161617, F1 0.3143197651451086, AUC 0.495770202020202
  Second-Tier acc 0.3125, precision 0.30199430199430194, recall 0.3841414141414141, F1 0.28527821939586645, AUC 0.49146464646464655
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3826530612244898, precision 0.3636553504974558, recall 0.4360670194003528, F1 0.38219645207004754, AUC 0.548797123015873
  Second-Tier acc 0.3469387755102041, precision 0.3100529100529101, recall 0.3029100529100529, F1 0.3060025542784163, AUC 0.546792328042328
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 15 idx: 0 First Loss : 2.4115867614746094, Second Loss : 2.5698506832122803
epoch: 15 idx: 200 First Loss : 0.8945343571330481, Second Loss : 0.9067949447688178
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3385416666666667, precision 0.32493848603271097, recall 0.38744949494949493, F1 0.3156598549822162, AUC 0.4989835858585859
  Second-Tier acc 0.3125, precision 0.2993827160493827, recall 0.3841414141414141, F1 0.28164774681802546, AUC 0.4969191919191919
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3673469387755102, precision 0.3450114351057747, recall 0.4137455908289242, F1 0.3646306566494572, AUC 0.5524140211640213
  Second-Tier acc 0.3673469387755102, precision 0.34457671957671954, recall 0.34457671957671954, F1 0.34457671957671954, AUC 0.5499338624338624
 
 test auc: 0.44246031746031744, test F1: 0.14814814814814814  :  from epoch 2
 current learn rate 1.8804392312806076e-05
epoch: 16 idx: 0 First Loss : 2.429718017578125, Second Loss : 2.5967636108398438
epoch: 16 idx: 200 First Loss : 0.8869375178766488, Second Loss : 0.8989690716531294
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.34375, precision 0.3261526832955404, recall 0.3950252525252526, F1 0.3169337644301739, AUC 0.501373106060606
  Second-Tier acc 0.3333333333333333, precision 0.3234064785788924, recall 0.4144444444444444, F1 0.29312692138779095, AUC 0.5084848484848484
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3469387755102041, precision 0.32084110857695763, recall 0.37654320987654327, F1 0.337426055477095, AUC 0.5550457451499118
  Second-Tier acc 0.3673469387755102, precision 0.3384615384615384, recall 0.3624338624338624, F1 0.3484742604239459, AUC 0.5517526455026455
 
 test auc: 0.5517526455026455, test F1: 0.3484742604239459  :  from epoch 16
 current learn rate 1.8804392312806076e-05
epoch: 17 idx: 0 First Loss : 2.446903705596924, Second Loss : 2.6243348121643066
epoch: 17 idx: 200 First Loss : 0.8793610645393234, Second Loss : 0.8912872329762029
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3697916666666667, precision 0.34537281930775005, recall 0.41593434343434343, F1 0.33547669089911647, AUC 0.5056628787878789
  Second-Tier acc 0.3541666666666667, precision 0.33095238095238094, recall 0.42777777777777776, F1 0.3135753135753136, AUC 0.513080808080808
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3520408163265306, precision 0.3183300231711354, recall 0.3767636684303351, F1 0.3365393902919258, AUC 0.5571022100970017
  Second-Tier acc 0.3673469387755102, precision 0.3384615384615384, recall 0.3624338624338624, F1 0.3484742604239459, AUC 0.5575947971781304
 
 test auc: 0.5575947971781304, test F1: 0.3484742604239459  :  from epoch 17
 current learn rate 1.8804392312806076e-05
epoch: 18 idx: 0 First Loss : 2.458925247192383, Second Loss : 2.650841474533081
epoch: 18 idx: 200 First Loss : 0.8726914291877058, Second Loss : 0.8851868778615448
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.3494699319781828, recall 0.4192676767676768, F1 0.33946945549379626, AUC 0.5076767676767676
  Second-Tier acc 0.3541666666666667, precision 0.3206509539842873, recall 0.42777777777777776, F1 0.3158780790359738, AUC 0.518989898989899
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.35714285714285715, precision 0.3183343571542329, recall 0.37251984126984133, F1 0.33564040502932563, AUC 0.5576705798059965
  Second-Tier acc 0.3673469387755102, precision 0.3384615384615384, recall 0.3624338624338624, F1 0.3484742604239459, AUC 0.5629960317460316
 
 test auc: 0.5629960317460316, test F1: 0.3484742604239459  :  from epoch 18
 current learn rate 1.8804392312806076e-05
epoch: 19 idx: 0 First Loss : 2.466521739959717, Second Loss : 2.6732585430145264
epoch: 19 idx: 200 First Loss : 0.8661283036202785, Second Loss : 0.878858887715571
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3854166666666667, precision 0.35987574200024225, recall 0.42593434343434344, F1 0.3463193407444279, AUC 0.5107859848484848
  Second-Tier acc 0.375, precision 0.3395061728395062, recall 0.44111111111111106, F1 0.3328365959944907, AUC 0.5248989898989899
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3520408163265306, precision 0.3126404712082462, recall 0.36210317460317465, F1 0.32872153575940594, AUC 0.5583216214726631
  Second-Tier acc 0.3673469387755102, precision 0.3384615384615384, recall 0.3624338624338624, F1 0.3484742604239459, AUC 0.5599096119929453
 
 test auc: 0.5599096119929453, test F1: 0.3484742604239459  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.4209677031901822, "droprate_2": 0.0, "lr": 4.8719587830121946e-05, "weight_decay": 0.0003665025067844818, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.8719587830121946e-05
epoch: 0 idx: 0 First Loss : 0.8916556239128113, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.105058612959895, Second Loss : 1.0974215902202757
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.494270482603816
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.48388888888888887
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4474206349206349
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4532076719576719
 
 test auc: 0.4532076719576719, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.8719587830121946e-05
epoch: 1 idx: 0 First Loss : 1.8669037818908691, Second Loss : 2.138059616088867
epoch: 1 idx: 200 First Loss : 1.045052250448744, Second Loss : 1.0447260551339952
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4992929292929293
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5018181818181818
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.452056388398981
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.45447530864197533
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 2 idx: 0 First Loss : 1.978310227394104, Second Loss : 2.242868661880493
epoch: 2 idx: 200 First Loss : 1.0111392398749417, Second Loss : 1.0132257675205296
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.4970089786756453
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.49631313131313126
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.46659440525181267
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.4728835978835979
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 3 idx: 0 First Loss : 2.087075710296631, Second Loss : 2.381530523300171
epoch: 3 idx: 200 First Loss : 0.9775903341707899, Second Loss : 0.9842011504505405
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2916666666666667, precision 0.24986508364813817, recall 0.404040404040404, F1 0.2894493051981472, AUC 0.47854096520763195
  Second-Tier acc 0.3541666666666667, precision 0.2927170868347339, recall 0.494949494949495, F1 0.35594202898550725, AUC 0.472020202020202
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.2585034013605442, precision 0.3331141152113019, recall 0.30798059964726626, F1 0.2207014624555854, AUC 0.49595825984714875
  Second-Tier acc 0.2653061224489796, precision 0.3357142857142857, recall 0.29298941798941797, F1 0.2403976975405547, AUC 0.49266975308641975
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 4 idx: 0 First Loss : 2.203277349472046, Second Loss : 2.5142788887023926
epoch: 4 idx: 200 First Loss : 0.9490732491683604, Second Loss : 0.9593339651748909
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3055555555555556, precision 0.3703865155478059, recall 0.4108754208754209, F1 0.30039007705463, AUC 0.4830078563411897
  Second-Tier acc 0.2916666666666667, precision 0.21794871794871795, recall 0.41414141414141414, F1 0.2852292020373514, AUC 0.4625757575757576
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.272108843537415, precision 0.2983600527898574, recall 0.26315402704291596, F1 0.266979566001457, AUC 0.5138582696453068
  Second-Tier acc 0.30612244897959184, precision 0.35797101449275365, recall 0.31900352733686066, F1 0.32840439223417944, AUC 0.517526455026455
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 5 idx: 0 First Loss : 2.322685480117798, Second Loss : 2.653444290161133
epoch: 5 idx: 200 First Loss : 0.9244708644587603, Second Loss : 0.939542802708659
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3055555555555556, precision 0.3262914862914863, recall 0.4029292929292929, F1 0.2898902318377974, AUC 0.49077441077441075
  Second-Tier acc 0.2916666666666667, precision 0.3070728291316527, recall 0.3682828282828283, F1 0.2799055829228243, AUC 0.471969696969697
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3197278911564626, precision 0.3168105079869786, recall 0.29027042915931806, F1 0.29892151982744314, AUC 0.5250771604938271
  Second-Tier acc 0.3469387755102041, precision 0.3650793650793651, recall 0.3908730158730158, F1 0.3726851851851852, AUC 0.5385251322751322
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 6 idx: 0 First Loss : 2.4492170810699463, Second Loss : 2.781909465789795
epoch: 6 idx: 200 First Loss : 0.9043083989167985, Second Loss : 0.9244106987963862
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3055555555555556, precision 0.3013888888888889, recall 0.38367003367003366, F1 0.28229116189060294, AUC 0.4984343434343434
  Second-Tier acc 0.2916666666666667, precision 0.27182539682539686, recall 0.37080808080808075, F1 0.25932400932400934, AUC 0.4760606060606061
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3469387755102041, precision 0.3189599483204134, recall 0.3186360964138742, F1 0.3187837453822108, AUC 0.5312928669410152
  Second-Tier acc 0.3673469387755102, precision 0.36553030303030304, recall 0.40321869488536155, F1 0.37815968492660224, AUC 0.5426587301587301
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 7 idx: 0 First Loss : 2.5588977336883545, Second Loss : 2.871216297149658
epoch: 7 idx: 200 First Loss : 0.8866546850799772, Second Loss : 0.9125195473284271
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3194444444444444, precision 0.30710586881472957, recall 0.3764309764309765, F1 0.2925225645813881, AUC 0.5038496071829406
  Second-Tier acc 0.3125, precision 0.2857142857142857, recall 0.3841414141414141, F1 0.2774336774336774, AUC 0.4821212121212121
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3741496598639456, precision 0.330812324929972, recall 0.34700176366843033, F1 0.33746321317659306, AUC 0.5375514403292181
  Second-Tier acc 0.40816326530612246, precision 0.3824786324786325, recall 0.42791005291005285, F1 0.39760348583877997, AUC 0.5561618165784833
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 8 idx: 0 First Loss : 2.633214235305786, Second Loss : 2.913985013961792
epoch: 8 idx: 200 First Loss : 0.8724500341943248, Second Loss : 0.9015270135740736
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3333333333333333, precision 0.317526455026455, recall 0.38531986531986534, F1 0.3030608041669989, AUC 0.5063355780022446
  Second-Tier acc 0.3333333333333333, precision 0.3075998075998076, recall 0.3974747474747475, F1 0.29527879527879525, AUC 0.48373737373737374
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.36054421768707484, precision 0.3008578431372549, recall 0.33708112874779544, F1 0.3153566647542551, AUC 0.547000538898687
  Second-Tier acc 0.3877551020408163, precision 0.34632034632034636, recall 0.40410052910052907, F1 0.361711229946524, AUC 0.564539241622575
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 9 idx: 0 First Loss : 2.69476318359375, Second Loss : 2.9796483516693115
epoch: 9 idx: 200 First Loss : 0.8587268599267326, Second Loss : 0.8941591922101096
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3402777777777778, precision 0.32337985502542466, recall 0.3841077441077441, F1 0.30888376856118793, AUC 0.5096913580246913
  Second-Tier acc 0.3541666666666667, precision 0.32716049382716045, recall 0.41080808080808073, F1 0.3152927363453679, AUC 0.4880808080808081
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.36054421768707484, precision 0.2916495621237, recall 0.333259847148736, F1 0.30873015873015874, AUC 0.5530141583382324
  Second-Tier acc 0.32653061224489793, precision 0.25071225071225073, recall 0.3148148148148148, F1 0.2751322751322751, AUC 0.5679012345679012
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 10 idx: 0 First Loss : 2.74151611328125, Second Loss : 3.0085813999176025
epoch: 10 idx: 200 First Loss : 0.848171856323841, Second Loss : 0.888419810867873
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3402777777777778, precision 0.32405982905982905, recall 0.3841077441077441, F1 0.30821928848912744, AUC 0.5137654320987655
  Second-Tier acc 0.3541666666666667, precision 0.32370370370370366, recall 0.3938383838383838, F1 0.3180708180708181, AUC 0.48919191919191923
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.26897590361445783, recall 0.3451646090534979, F1 0.29801829268292684, AUC 0.5543981481481483
  Second-Tier acc 0.32653061224489793, precision 0.25071225071225073, recall 0.3148148148148148, F1 0.2751322751322751, AUC 0.5725859788359788
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 11 idx: 0 First Loss : 2.7592475414276123, Second Loss : 3.0292463302612305
epoch: 11 idx: 200 First Loss : 0.8381454678882488, Second Loss : 0.879151155398371
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3680555555555556, precision 0.34476755128929043, recall 0.4018855218855219, F1 0.3316250383049984, AUC 0.5184006734006733
  Second-Tier acc 0.3541666666666667, precision 0.319645732689211, recall 0.37686868686868685, F1 0.3186900776570791, AUC 0.4926262626262627
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.36054421768707484, precision 0.2638171734557277, recall 0.3451646090534979, F1 0.2939147573293915, AUC 0.5554024593376445
  Second-Tier acc 0.3469387755102041, precision 0.27289377289377287, recall 0.35648148148148145, F1 0.3024585477415666, AUC 0.5706569664902998
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 12 idx: 0 First Loss : 2.772303819656372, Second Loss : 3.075295925140381
epoch: 12 idx: 200 First Loss : 0.8311041851078544, Second Loss : 0.8729114654422993
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3680555555555556, precision 0.344168226891339, recall 0.39622895622895626, F1 0.33111361522968896, AUC 0.5178002244668911
  Second-Tier acc 0.3958333333333333, precision 0.34408939014202167, recall 0.4035353535353536, F1 0.35151515151515156, AUC 0.49646464646464655
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.2634736064968623, recall 0.3492798353909465, F1 0.2950097994874114, AUC 0.5526528512639624
  Second-Tier acc 0.3469387755102041, precision 0.26495726495726496, recall 0.35648148148148145, F1 0.29587093245829915, AUC 0.5697751322751322
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 13 idx: 0 First Loss : 2.7969837188720703, Second Loss : 3.051105260848999
epoch: 13 idx: 200 First Loss : 0.8202618301952657, Second Loss : 0.8673797217313552
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.375, precision 0.34641443792128723, recall 0.39501683501683504, F1 0.3363936886240759, AUC 0.5196015712682379
  Second-Tier acc 0.3958333333333333, precision 0.34408939014202167, recall 0.4035353535353536, F1 0.35151515151515156, AUC 0.4905050505050505
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.38095238095238093, precision 0.2753623188405797, recall 0.37705761316872427, F1 0.3105463044113351, AUC 0.5516362923770332
  Second-Tier acc 0.3469387755102041, precision 0.26495726495726496, recall 0.35648148148148145, F1 0.29587093245829915, AUC 0.572475749559083
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 14 idx: 0 First Loss : 2.7951488494873047, Second Loss : 3.0363807678222656
epoch: 14 idx: 200 First Loss : 0.8123274457742882, Second Loss : 0.8617414013084154
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4027777777777778, precision 0.3680366801197046, recall 0.4127946127946129, F1 0.35736976202092485, AUC 0.5204489337822671
  Second-Tier acc 0.3958333333333333, precision 0.33888888888888885, recall 0.38656565656565656, F1 0.3450456435619202, AUC 0.495050505050505
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.27711468604047745, recall 0.38117283950617287, F1 0.3126242115268297, AUC 0.550870811287478
  Second-Tier acc 0.3673469387755102, precision 0.2890499194847021, recall 0.42746913580246915, F1 0.3261538461538462, AUC 0.5713183421516755
 
 test auc: 0.45447530864197533, test F1: 0.14814814814814814  :  from epoch 1
 current learn rate 4.8719587830121946e-05
epoch: 15 idx: 0 First Loss : 2.7528886795043945, Second Loss : 3.05268931388855
epoch: 15 idx: 200 First Loss : 0.8052362113408003, Second Loss : 0.857746433598726
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.3723196881091617, recall 0.41158249158249166, F1 0.36132567505116525, AUC 0.522003367003367
  Second-Tier acc 0.3958333333333333, precision 0.33888888888888885, recall 0.38656565656565656, F1 0.3450456435619202, AUC 0.5067171717171717
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3741496598639456, precision 0.2765594541910331, recall 0.40226337448559674, F1 0.3093681917211329, AUC 0.5507667058592984
  Second-Tier acc 0.3673469387755102, precision 0.2890499194847021, recall 0.42746913580246915, F1 0.3261538461538462, AUC 0.5718694885361552
 
 test auc: 0.5718694885361552, test F1: 0.3261538461538462  :  from epoch 15
 current learn rate 4.8719587830121946e-05
epoch: 16 idx: 0 First Loss : 2.7198753356933594, Second Loss : 3.00618839263916
epoch: 16 idx: 200 First Loss : 0.7986726336695477, Second Loss : 0.8532747986833032
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4097222222222222, precision 0.37508968499680573, recall 0.41158249158249166, F1 0.36079794094082424, AUC 0.525679012345679
  Second-Tier acc 0.4166666666666667, precision 0.354040404040404, recall 0.3998989898989898, F1 0.357787437403086, AUC 0.5142929292929294
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3741496598639456, precision 0.27474457215836523, recall 0.40226337448559674, F1 0.3075615069876189, AUC 0.5512811091514794
  Second-Tier acc 0.3673469387755102, precision 0.2890499194847021, recall 0.42746913580246915, F1 0.3261538461538462, AUC 0.5677358906525574
 
 test auc: 0.5677358906525574, test F1: 0.3261538461538462  :  from epoch 16
 current learn rate 4.8719587830121946e-05
epoch: 17 idx: 0 First Loss : 2.660404920578003, Second Loss : 2.98689341545105
epoch: 17 idx: 200 First Loss : 0.7909259604109423, Second Loss : 0.848629929417216
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.3704044870220257, recall 0.4014814814814815, F1 0.35427688105475647, AUC 0.5263692480359147
  Second-Tier acc 0.4166666666666667, precision 0.354040404040404, recall 0.3998989898989898, F1 0.357787437403086, AUC 0.5204040404040404
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.38095238095238093, precision 0.28174603174603174, recall 0.4161522633744856, F1 0.3141490591821718, AUC 0.5492541152263374
  Second-Tier acc 0.3673469387755102, precision 0.2890499194847021, recall 0.42746913580246915, F1 0.3261538461538462, AUC 0.5679563492063493
 
 test auc: 0.5679563492063493, test F1: 0.3261538461538462  :  from epoch 17
 current learn rate 4.8719587830121946e-05
epoch: 18 idx: 0 First Loss : 2.6007039546966553, Second Loss : 2.9788174629211426
epoch: 18 idx: 200 First Loss : 0.7849733714021242, Second Loss : 0.8455809157767996
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4097222222222222, precision 0.36350111439206234, recall 0.40111111111111103, F1 0.35045751633986927, AUC 0.5243434343434344
  Second-Tier acc 0.4166666666666667, precision 0.354040404040404, recall 0.3998989898989898, F1 0.357787437403086, AUC 0.5277272727272727
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.38095238095238093, precision 0.28190164954870833, recall 0.4161522633744856, F1 0.31114196816580525, AUC 0.5498848716441309
  Second-Tier acc 0.3877551020408163, precision 0.30701754385964913, recall 0.46913580246913583, F1 0.3471907281431091, AUC 0.5681216931216931
 
 test auc: 0.5681216931216931, test F1: 0.3471907281431091  :  from epoch 18
 current learn rate 4.8719587830121946e-05
epoch: 19 idx: 0 First Loss : 2.574659585952759, Second Loss : 2.944344997406006
epoch: 19 idx: 200 First Loss : 0.7799464278050527, Second Loss : 0.8413640098548981
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4027777777777778, precision 0.35786924939467313, recall 0.39666666666666667, F1 0.3457896127585942, AUC 0.5214029180695847
  Second-Tier acc 0.3958333333333333, precision 0.34494949494949495, recall 0.38656565656565656, F1 0.3414141414141414, AUC 0.5338383838383839
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.38095238095238093, precision 0.28089449898706564, recall 0.4161522633744856, F1 0.3117312661498708, AUC 0.549358220654517
  Second-Tier acc 0.3877551020408163, precision 0.2962962962962963, recall 0.4398148148148148, F1 0.3363499245852187, AUC 0.5696649029982362
 
 test auc: 0.5696649029982362, test F1: 0.3363499245852187  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.32329480618025913, "droprate_2": 0.0, "lr": 0.00037566797219251285, "weight_decay": 0.00016170943551289252, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00037566797219251285
epoch: 0 idx: 0 First Loss : 1.2373260259628296, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.077228430640045, Second Loss : 1.0647241851657778
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7330190796857464
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7493939393939394
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7123260826964531
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7102623456790123
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 1 idx: 0 First Loss : 1.7977720499038696, Second Loss : 1.842198133468628
epoch: 1 idx: 200 First Loss : 0.9768553070761078, Second Loss : 0.9764115906028605
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7218855218855218
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.73
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7424003037428965
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7500551146384479
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 2 idx: 0 First Loss : 2.2897634506225586, Second Loss : 2.210573196411133
epoch: 2 idx: 200 First Loss : 0.9497569167791907, Second Loss : 0.9466981211334319
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7215993265993266
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7282828282828282
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7409305800509505
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7482363315696648
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 3 idx: 0 First Loss : 3.106001615524292, Second Loss : 3.086928606033325
epoch: 3 idx: 200 First Loss : 0.925388811295157, Second Loss : 0.9367452743857061
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4930555555555556, precision 0.3687290969899666, recall 0.4909090909090909, F1 0.3753070866141732, AUC 0.6889001122334456
  Second-Tier acc 0.5, precision 0.3854166666666667, recall 0.5066666666666667, F1 0.381924749480053, AUC 0.7111111111111111
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.54421768707483, precision 0.39493177387914224, recall 0.4591416813639036, F1 0.39393939393939387, AUC 0.6980636390358613
  Second-Tier acc 0.5306122448979592, precision 0.3853801169590643, recall 0.44708994708994715, F1 0.38405797101449274, AUC 0.7022707231040565
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 4 idx: 0 First Loss : 3.5287885665893555, Second Loss : 3.5220372676849365
epoch: 4 idx: 200 First Loss : 0.9011967561360615, Second Loss : 0.9197985184800566
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.6858249158249158
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7180808080808081
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.4215686274509804, recall 0.42445620223397995, F1 0.32465287670712484, AUC 0.684640162649422
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.707010582010582
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 5 idx: 0 First Loss : 3.775691270828247, Second Loss : 3.696929454803467
epoch: 5 idx: 200 First Loss : 0.8983832312260166, Second Loss : 0.9119010541231293
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.7002020202020202
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.71989898989899
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7079720262590633
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.732583774250441
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 6 idx: 0 First Loss : 3.5914125442504883, Second Loss : 3.5140228271484375
epoch: 6 idx: 200 First Loss : 0.8834650280337494, Second Loss : 0.899836067587545
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6908305274971941
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6862121212121212
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6943648344111307
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7094907407407408
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 7 idx: 0 First Loss : 3.7204885482788086, Second Loss : 3.6363348960876465
epoch: 7 idx: 200 First Loss : 0.884792834115203, Second Loss : 0.9058373453517199
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3541666666666667, precision 0.3773809523809524, recall 0.41333333333333333, F1 0.2687908496732026, AUC 0.7154320987654321
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7328787878787878
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.4490358126721763, recall 0.4279835390946502, F1 0.3192150385401919, AUC 0.6644682049774643
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6742173721340388
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 8 idx: 0 First Loss : 4.034645080566406, Second Loss : 3.9683568477630615
epoch: 8 idx: 200 First Loss : 0.8995655681371784, Second Loss : 0.9172732151647455
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.685695847362514
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.717979797979798
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.44808743169398907, recall 0.43621399176954734, F1 0.3279644117195889, AUC 0.6840706447187929
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6646825396825397
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 9 idx: 0 First Loss : 3.7486941814422607, Second Loss : 3.633960723876953
epoch: 9 idx: 200 First Loss : 0.8749891787073697, Second Loss : 0.8959129310027112
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3611111111111111, precision 0.3780427223050174, recall 0.4177777777777778, F1 0.27251967631083024, AUC 0.6795622895622895
  Second-Tier acc 0.4375, precision 0.7324324324324324, recall 0.48111111111111104, F1 0.3754884004884005, AUC 0.7145454545454545
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6620309131883206
  Second-Tier acc 0.5306122448979592, precision 0.7927927927927928, recall 0.5108024691358025, F1 0.45006306616213737, AUC 0.6570767195767195
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 10 idx: 0 First Loss : 3.6781866550445557, Second Loss : 3.560594081878662
epoch: 10 idx: 200 First Loss : 0.8701749350134989, Second Loss : 0.8930705229665468
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.3574475065616798, recall 0.39111111111111113, F1 0.23273809523809522, AUC 0.6663131313131313
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6931818181818183
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.41496598639455784, precision 0.4444444444444444, recall 0.4115226337448559, F1 0.29333333333333333, AUC 0.6599365569272977
  Second-Tier acc 0.4897959183673469, precision 0.5705705705705706, recall 0.4861111111111111, F1 0.4102792632204397, AUC 0.654376102292769
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 11 idx: 0 First Loss : 3.911696434020996, Second Loss : 3.713958740234375
epoch: 11 idx: 200 First Loss : 0.8721413832929319, Second Loss : 0.8939423874220104
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3125, precision 0.3546666666666667, recall 0.38666666666666666, F1 0.2281293952180028, AUC 0.6622671156004489
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6881818181818181
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.40816326530612246, precision 0.49477351916376305, recall 0.4171810699588478, F1 0.306848604544457, AUC 0.6580687830687831
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6619819223985891
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 12 idx: 0 First Loss : 3.849538564682007, Second Loss : 3.7088119983673096
epoch: 12 idx: 200 First Loss : 0.8615774470350308, Second Loss : 0.8915670662710764
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6559539842873177
  Second-Tier acc 0.3333333333333333, precision 0.3742690058479532, recall 0.39999999999999997, F1 0.25718674566600835, AUC 0.6815151515151516
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5147540983606557, recall 0.4295267489711934, F1 0.3257334143843316, AUC 0.6603284832451499
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6715167548500881
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 13 idx: 0 First Loss : 3.7424662113189697, Second Loss : 3.566422939300537
epoch: 13 idx: 200 First Loss : 0.8614540290489919, Second Loss : 0.8903138635275232
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3402777777777778, precision 0.44180421697869354, recall 0.4140740740740741, F1 0.2767742692303591, AUC 0.6521717171717171
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.670151515151515
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3945578231292517, precision 0.4777777777777778, recall 0.4089506172839506, F1 0.29552469135802467, AUC 0.6617185969037821
  Second-Tier acc 0.3877551020408163, precision 0.45, recall 0.3950617283950617, F1 0.2770061728395062, AUC 0.6742724867724869
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 14 idx: 0 First Loss : 3.8015384674072266, Second Loss : 3.6169590950012207
epoch: 14 idx: 200 First Loss : 0.8665798408852895, Second Loss : 0.8928742798963677
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3402777777777778, precision 0.41947398428397903, recall 0.4140740740740741, F1 0.2788008735358348, AUC 0.6549214365881032
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6713131313131314
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3741496598639456, precision 0.46918767507002807, recall 0.38896237507348624, F1 0.2814209436635066, AUC 0.6733784048598864
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.691247795414462
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 15 idx: 0 First Loss : 3.89298152923584, Second Loss : 3.7309749126434326
epoch: 15 idx: 200 First Loss : 0.8558468798737295, Second Loss : 0.8935411363639725
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.4252747252747253, recall 0.42407407407407405, F1 0.28894130647286326, AUC 0.6480695847362514
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.664949494949495
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3673469387755102, precision 0.5047355047355047, recall 0.4141681363903586, F1 0.300885345591228, AUC 0.6663114834411131
  Second-Tier acc 0.3673469387755102, precision 0.4444444444444444, recall 0.38271604938271603, F1 0.25268817204301075, AUC 0.6746031746031745
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 16 idx: 0 First Loss : 4.065798282623291, Second Loss : 3.965989828109741
epoch: 16 idx: 200 First Loss : 0.8637023803981738, Second Loss : 0.8979111171223243
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3194444444444444, precision 0.40740740740740744, recall 0.41037037037037044, F1 0.26943833048015, AUC 0.6674074074074073
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.680959595959596
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.36054421768707484, precision 0.512977262977263, recall 0.41982657260435036, F1 0.29831959673334424, AUC 0.6633291691162061
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6802799823633157
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 17 idx: 0 First Loss : 4.504292011260986, Second Loss : 4.134776592254639
epoch: 17 idx: 200 First Loss : 0.8632198654833669, Second Loss : 0.90390338971388
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3611111111111111, precision 0.4021294021294021, recall 0.4225925925925926, F1 0.2906735151470839, AUC 0.6713468013468012
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6847474747474748
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.41496598639455784, precision 0.4881642512077295, recall 0.4234273956496178, F1 0.33230095833362533, AUC 0.67517881638252
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.6893187830687831
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 18 idx: 0 First Loss : 4.712894916534424, Second Loss : 4.248941898345947
epoch: 18 idx: 200 First Loss : 0.8335878084462661, Second Loss : 0.8816815460316375
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3125, precision 0.44091743119266064, recall 0.40111111111111114, F1 0.258304698004808, AUC 0.657070707070707
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6674747474747474
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3197278911564626, precision 0.4830827067669173, recall 0.37176660787771904, F1 0.24388789505068575, AUC 0.6652336860670195
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6690917107583774
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.00037566797219251285
epoch: 19 idx: 0 First Loss : 4.551903247833252, Second Loss : 4.178162097930908
epoch: 19 idx: 200 First Loss : 0.8451177126811495, Second Loss : 0.8772250008626541
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2986111111111111, precision 0.3856190476190476, recall 0.3825925925925926, F1 0.22370989953948547, AUC 0.6625589225589226
  Second-Tier acc 0.2916666666666667, precision 0.34401709401709396, recall 0.37333333333333335, F1 0.21563218390804598, AUC 0.6395959595959596
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.5235368956743002, recall 0.39403292181069954, F1 0.2634414712822844, AUC 0.6706043013913385
  Second-Tier acc 0.32653061224489793, precision 0.4900284900284901, recall 0.3873456790123457, F1 0.2391258390148512, AUC 0.6619268077601411
 
 test auc: 0.7102623456790123, test F1: 0.23684210526315788  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.27537332376215046, "droprate_2": 0.0, "lr": 1.3810053094824734e-05, "weight_decay": 0.0002213398741929297, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.3810053094824734e-05
epoch: 0 idx: 0 First Loss : 1.240153193473816, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0651095337535612, Second Loss : 1.0501648851888097
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6804433221099888
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7465151515151516
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6185454634528709
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6195987654320988
 
 test auc: 0.6195987654320988, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.3810053094824734e-05
epoch: 1 idx: 0 First Loss : 2.066042184829712, Second Loss : 2.0139594078063965
epoch: 1 idx: 200 First Loss : 1.1051777008161023, Second Loss : 1.0931188106833405
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7210437710437709
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7584848484848484
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6660236625514403
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6766975308641975
 
 test auc: 0.6766975308641975, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.3810053094824734e-05
epoch: 2 idx: 0 First Loss : 2.1409595012664795, Second Loss : 2.1131932735443115
epoch: 2 idx: 200 First Loss : 1.0935734359927438, Second Loss : 1.0812351398207063
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7317452300785634
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7633838383838384
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6929624730550655
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7057429453262786
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 3 idx: 0 First Loss : 2.2076900005340576, Second Loss : 2.1979775428771973
epoch: 3 idx: 200 First Loss : 1.0761287605288017, Second Loss : 1.0649548433906404
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7403928170594837
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7631818181818182
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7049345972957085
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7136794532627865
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 4 idx: 0 First Loss : 2.3101348876953125, Second Loss : 2.275970697402954
epoch: 4 idx: 200 First Loss : 1.0601768544064232, Second Loss : 1.050023256731567
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7398709315375981
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7531818181818181
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7140468841857731
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7216159611992946
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 5 idx: 0 First Loss : 2.4129724502563477, Second Loss : 2.3745737075805664
epoch: 5 idx: 200 First Loss : 1.0417426432024186, Second Loss : 1.0327880527101345
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5694444444444444, precision 0.41794871794871796, recall 0.41535353535353536, F1 0.3678331565924355, AUC 0.7353086419753087
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7503535353535353
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5782312925170068, precision 0.5234741784037559, recall 0.3888888888888889, F1 0.3373905616058082, AUC 0.7134589947089948
  Second-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.716876102292769
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 6 idx: 0 First Loss : 2.5348291397094727, Second Loss : 2.4978952407836914
epoch: 6 idx: 200 First Loss : 1.0215464534228713, Second Loss : 1.013840939423338
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6527777777777778, precision 0.6838179519595449, recall 0.5363299663299663, F1 0.5419536094836742, AUC 0.7362177328843996
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7486868686868687
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6802721088435374, precision 0.7489439853076217, recall 0.5691504997060552, F1 0.583577225647093, AUC 0.707384136782285
  Second-Tier acc 0.673469387755102, precision 0.746588693957115, recall 0.52336860670194, F1 0.5449275362318841, AUC 0.7131834215167547
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 7 idx: 0 First Loss : 2.6730825901031494, Second Loss : 2.6395812034606934
epoch: 7 idx: 200 First Loss : 1.0006683197113413, Second Loss : 0.9947387748096713
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6527777777777778, precision 0.6042174796747967, recall 0.5918181818181819, F1 0.596558368570358, AUC 0.7347474747474747
  Second-Tier acc 0.6666666666666666, precision 0.5961663417803769, recall 0.5938383838383838, F1 0.5296703296703297, AUC 0.7518686868686868
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5714285714285714, precision 0.5172672672672672, recall 0.5496031746031745, F1 0.5243976189507654, AUC 0.7093866353125612
  Second-Tier acc 0.6326530612244898, precision 0.6117724867724867, recall 0.6146384479717814, F1 0.6083333333333333, AUC 0.7221671075837742
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 8 idx: 0 First Loss : 2.819373369216919, Second Loss : 2.793447256088257
epoch: 8 idx: 200 First Loss : 0.9827442589906318, Second Loss : 0.9781213791957543
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5555555555555556, precision 0.5280103995621237, recall 0.5333333333333333, F1 0.5156225159473494, AUC 0.7342536475869809
  Second-Tier acc 0.5625, precision 0.5423786739576214, recall 0.556060606060606, F1 0.5143540669856459, AUC 0.7468686868686868
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5034013605442177, precision 0.4692307692307693, recall 0.5067607289829512, F1 0.46440767008142897, AUC 0.7087375073486184
  Second-Tier acc 0.673469387755102, precision 0.668261562998405, recall 0.7272927689594356, F1 0.6795182950789358, AUC 0.7351190476190476
 
 test auc: 0.7057429453262786, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.3810053094824734e-05
epoch: 9 idx: 0 First Loss : 2.9587669372558594, Second Loss : 2.942668914794922
epoch: 9 idx: 200 First Loss : 0.9676246413618178, Second Loss : 0.9656109568009625
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5, precision 0.5018331152052082, recall 0.49922558922558924, F1 0.45635262096544293, AUC 0.737598204264871
  Second-Tier acc 0.5833333333333334, precision 0.6323232323232323, recall 0.6585858585858585, F1 0.5847362514029181, AUC 0.7736363636363636
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.43537414965986393, precision 0.4376108156028369, recall 0.48346560846560843, F1 0.4083624708624709, AUC 0.7160677542621987
  Second-Tier acc 0.5714285714285714, precision 0.589010989010989, recall 0.6541005291005292, F1 0.5841269841269842, AUC 0.7533619929453262
 
 test auc: 0.7533619929453262, test F1: 0.5841269841269842  :  from epoch 9
 current learn rate 1.3810053094824734e-05
epoch: 10 idx: 0 First Loss : 3.080575942993164, Second Loss : 3.068539619445801
epoch: 10 idx: 200 First Loss : 0.9561838083135993, Second Loss : 0.9557595283386127
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4444444444444444, precision 0.47483455242075934, recall 0.46764309764309764, F1 0.4048637854799601, AUC 0.7418742985409651
  Second-Tier acc 0.5833333333333334, precision 0.6390151515151515, recall 0.673030303030303, F1 0.5877344877344877, AUC 0.7890404040404041
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.4787227992707444, recall 0.5245443856554967, F1 0.4242186221567665, AUC 0.7204095630021555
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7664792768959435
 
 test auc: 0.7664792768959435, test F1: 0.5454545454545454  :  from epoch 10
 current learn rate 1.3810053094824734e-05
epoch: 11 idx: 0 First Loss : 3.174513816833496, Second Loss : 3.17600154876709
epoch: 11 idx: 200 First Loss : 0.9475793861714539, Second Loss : 0.9487097887368641
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4375, precision 0.484129586028075, recall 0.468013468013468, F1 0.39871968709256844, AUC 0.7481593714927048
  Second-Tier acc 0.5208333333333334, precision 0.5873015873015873, recall 0.6016161616161616, F1 0.522140522875817, AUC 0.7986363636363635
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.42857142857142855, precision 0.47804232804232805, recall 0.520135214579659, F1 0.41700542005420055, AUC 0.7259822653341171
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.767361111111111
 
 test auc: 0.767361111111111, test F1: 0.5177655677655677  :  from epoch 11
 current learn rate 1.3810053094824734e-05
epoch: 12 idx: 0 First Loss : 3.259488821029663, Second Loss : 3.271514892578125
epoch: 12 idx: 200 First Loss : 0.9408795380946341, Second Loss : 0.9434243199410871
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.47269305962854347, recall 0.45107744107744113, F1 0.37958333333333333, AUC 0.7508698092031425
  Second-Tier acc 0.5, precision 0.5761784511784512, recall 0.5882828282828282, F1 0.501010101010101, AUC 0.8043434343434344
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.4975664968873797, recall 0.5160199882422104, F1 0.4108943089430894, AUC 0.729907652361356
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7713293650793651
 
 test auc: 0.7713293650793651, test F1: 0.49188712522045847  :  from epoch 12
 current learn rate 1.3810053094824734e-05
epoch: 13 idx: 0 First Loss : 3.326343536376953, Second Loss : 3.345931053161621
epoch: 13 idx: 200 First Loss : 0.9352970788422138, Second Loss : 0.9388655506871382
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4027777777777778, precision 0.4874911909795631, recall 0.4531313131313131, F1 0.3814751404085011, AUC 0.7552918069584736
  Second-Tier acc 0.5, precision 0.5785714285714285, recall 0.6027272727272727, F1 0.5, AUC 0.8101515151515152
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.5068634958450325, recall 0.5097736625514403, F1 0.4094119096956513, AUC 0.735388496962571
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7780533509700177
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 14 idx: 0 First Loss : 3.3826005458831787, Second Loss : 3.40848708152771
epoch: 14 idx: 200 First Loss : 0.9306619607204043, Second Loss : 0.9349863806100034
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.487491877842755, recall 0.45999999999999996, F1 0.37965344348323066, AUC 0.7608585858585859
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.8073737373737373
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.42857142857142855, precision 0.5375371360665478, recall 0.5371105232216343, F1 0.4287898515150868, AUC 0.7380217519106408
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7790454144620812
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 15 idx: 0 First Loss : 3.42836594581604, Second Loss : 3.4592764377593994
epoch: 15 idx: 200 First Loss : 0.9263964015318646, Second Loss : 0.9315311919911695
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.5091503267973856, recall 0.49595959595959593, F1 0.40675468094822936, AUC 0.7650561167227834
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8051010101010102
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.42857142857142855, precision 0.5522540983606558, recall 0.5349794238683128, F1 0.42983230361871133, AUC 0.741187781697041
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7868165784832453
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 16 idx: 0 First Loss : 3.4659316539764404, Second Loss : 3.5024466514587402
epoch: 16 idx: 200 First Loss : 0.9228092041329958, Second Loss : 0.928139339462942
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.5255048287971905, recall 0.5243434343434343, F1 0.42674419132431907, AUC 0.7678731762065095
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.7997474747474748
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4421768707482993, precision 0.5624892997774354, recall 0.5508524397413287, F1 0.4450127009295723, AUC 0.7426942484812855
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.788745590828924
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 17 idx: 0 First Loss : 3.492619276046753, Second Loss : 3.527890205383301
epoch: 17 idx: 200 First Loss : 0.9185475671214436, Second Loss : 0.9248280010732882
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4444444444444444, precision 0.5377984278659302, recall 0.5453872053872054, F1 0.4417595950540818, AUC 0.7705892255892256
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.7997979797979798
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5714285714285715, recall 0.562610229276896, F1 0.4527310924369748, AUC 0.7458970213599843
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7934854497354497
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 18 idx: 0 First Loss : 3.5060203075408936, Second Loss : 3.5464022159576416
epoch: 18 idx: 200 First Loss : 0.9144183507441678, Second Loss : 0.9216525664921406
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4513888888888889, precision 0.5444243338360986, recall 0.5588552188552188, F1 0.4471282877079979, AUC 0.7702469135802469
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.7938383838383839
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5876645876645877, recall 0.5864197530864197, F1 0.47361303868189736, AUC 0.7500061238487165
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7935405643738976
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13
 current learn rate 1.3810053094824734e-05
epoch: 19 idx: 0 First Loss : 3.5114078521728516, Second Loss : 3.5519187450408936
epoch: 19 idx: 200 First Loss : 0.9105135417214377, Second Loss : 0.9185679498017391
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4375, precision 0.5353714322530765, recall 0.5420202020202021, F1 0.42961019490254876, AUC 0.7692929292929294
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.7879797979797981
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46938775510204084, precision 0.5891350210970464, recall 0.5783362727807172, F1 0.46947876605842404, AUC 0.7544642857142857
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7959656084656084
 
 test auc: 0.7780533509700177, test F1: 0.49188712522045847  :  from epoch 13{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.3782058935342169, "droprate_2": 0.0, "lr": 1.9805531054030883e-05, "weight_decay": 4.0749036033865344e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.9805531054030883e-05
epoch: 0 idx: 0 First Loss : 1.2336653470993042, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0971380487010254, Second Loss : 1.0790079671945145
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6969696969696969
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.748030303030303
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6399666862629826
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.638888888888889
Test AUC: 0.6389, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.9805531054030883e-05
epoch: 1 idx: 0 First Loss : 2.1031382083892822, Second Loss : 2.068869113922119
epoch: 1 idx: 200 First Loss : 1.1018587207764536, Second Loss : 1.0911645010039581
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7289001122334455
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6900107779737409
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6981371252204586
Test AUC: 0.6981, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9805531054030883e-05
epoch: 2 idx: 0 First Loss : 2.195904016494751, Second Loss : 2.1719274520874023
epoch: 2 idx: 200 First Loss : 1.077706118128193, Second Loss : 1.0670269620952322
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7405892255892255
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7584848484848484
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7071881736233587
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7088293650793651
Test AUC: 0.6981, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9805531054030883e-05
epoch: 3 idx: 0 First Loss : 2.3111636638641357, Second Loss : 2.296037435531616
epoch: 3 idx: 200 First Loss : 1.0542864218650765, Second Loss : 1.044532962847705
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5347222222222222, precision 0.5106382978723404, recall 0.35353535353535354, F1 0.2695767195767196, AUC 0.7375140291806958
  Second-Tier acc 0.5833333333333334, precision 0.5185185185185185, recall 0.42424242424242425, F1 0.38095238095238093, AUC 0.754040404040404
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7127425044091712
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7088293650793651
Test AUC: 0.6981, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9805531054030883e-05
epoch: 4 idx: 0 First Loss : 2.4612631797790527, Second Loss : 2.442939281463623
epoch: 4 idx: 200 First Loss : 1.0275760295230951, Second Loss : 1.0193065681045328
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.625, precision 0.643859649122807, recall 0.49340067340067345, F1 0.497046880767811, AUC 0.7354433221099889
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7528787878787879
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.6394557823129252, precision 0.7535370684776458, recall 0.519400352733686, F1 0.49767606270602643, AUC 0.6976839604154419
  Second-Tier acc 0.5714285714285714, precision 0.34385964912280703, recall 0.39153439153439146, F1 0.3572649572649573, AUC 0.7035934744268078
Test AUC: 0.6981, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9805531054030883e-05
epoch: 5 idx: 0 First Loss : 2.6418697834014893, Second Loss : 2.642547845840454
epoch: 5 idx: 200 First Loss : 0.9982614199357542, Second Loss : 0.9945953969116235
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5833333333333334, precision 0.5545464492832914, recall 0.5140404040404041, F1 0.5025461938872521, AUC 0.7315544332210999
  Second-Tier acc 0.6458333333333334, precision 0.5666666666666668, recall 0.594949494949495, F1 0.5519945909398243, AUC 0.7486363636363635
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5102040816326531, precision 0.45459718478586403, recall 0.49559082892416223, F1 0.44450178225012665, AUC 0.7025034293552812
  Second-Tier acc 0.6326530612244898, precision 0.6162337662337662, recall 0.6261022927689593, F1 0.6111511271175137, AUC 0.7188602292768959
Test AUC: 0.6981, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.9805531054030883e-05
epoch: 6 idx: 0 First Loss : 2.8273746967315674, Second Loss : 2.8676576614379883
epoch: 6 idx: 200 First Loss : 0.9719231030092904, Second Loss : 0.9725185557458531
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5138888888888888, precision 0.5113247863247864, recall 0.49764309764309766, F1 0.4587086764530373, AUC 0.7364646464646466
  Second-Tier acc 0.5833333333333334, precision 0.6038961038961038, recall 0.6296969696969698, F1 0.5738150738150738, AUC 0.763939393939394
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.47619047619047616, precision 0.47324414715719065, recall 0.5277042915931806, F1 0.4392741816590813, AUC 0.7114871154223006
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7415674603174601
Test AUC: 0.7416, Test F1: 0.6002 (Best Epoch: 6)
Current LR: 1.9805531054030883e-05
epoch: 7 idx: 0 First Loss : 3.0109870433807373, Second Loss : 3.075343132019043
epoch: 7 idx: 200 First Loss : 0.9530786136304265, Second Loss : 0.9566876009310508
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4583333333333333, precision 0.5, recall 0.4708754208754209, F1 0.4098313429708779, AUC 0.7402637485970819
  Second-Tier acc 0.5208333333333334, precision 0.5796296296296296, recall 0.5821212121212122, F1 0.5198481116584565, AUC 0.7827272727272727
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.43537414965986393, precision 0.4842185592185593, recall 0.5166078777189888, F1 0.41404151404151407, AUC 0.7188357338820301
  Second-Tier acc 0.4897959183673469, precision 0.5164721759149004, recall 0.58179012345679, F1 0.49474747474747477, AUC 0.7621803350970019
Test AUC: 0.7622, Test F1: 0.4947 (Best Epoch: 7)
Current LR: 1.9805531054030883e-05
epoch: 8 idx: 0 First Loss : 3.14774227142334, Second Loss : 3.240328550338745
epoch: 8 idx: 200 First Loss : 0.9406858714232545, Second Loss : 0.9464588950003557
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4375, precision 0.4996370235934664, recall 0.468013468013468, F1 0.3985779811431547, AUC 0.7446969696969697
  Second-Tier acc 0.4791666666666667, precision 0.5524366471734893, recall 0.541010101010101, F1 0.47908496732026146, AUC 0.7971717171717172
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.41496598639455784, precision 0.4742523373347747, recall 0.5042621987066431, F1 0.3976734072624484, AUC 0.7272131589261219
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7631723985890653
Test AUC: 0.7632, Test F1: 0.5178 (Best Epoch: 8)
Current LR: 1.9805531054030883e-05
epoch: 9 idx: 0 First Loss : 3.258425712585449, Second Loss : 3.371033191680908
epoch: 9 idx: 200 First Loss : 0.932585501352983, Second Loss : 0.9404355616109511
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4027777777777778, precision 0.47222222222222227, recall 0.4457912457912458, F1 0.3664717348927875, AUC 0.748675645342312
  Second-Tier acc 0.5, precision 0.575, recall 0.5857575757575758, F1 0.5009571521668296, AUC 0.8100505050505049
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4013605442176871, precision 0.49870522587543437, recall 0.49985302763080536, F1 0.39000819000819, AUC 0.7324857926709779
  Second-Tier acc 0.5102040816326531, precision 0.5993265993265994, recall 0.6170634920634921, F1 0.5128205128205128, AUC 0.7702821869488536
Test AUC: 0.7703, Test F1: 0.5128 (Best Epoch: 9)
Current LR: 1.9805531054030883e-05
epoch: 10 idx: 0 First Loss : 3.335923910140991, Second Loss : 3.4697134494781494
epoch: 10 idx: 200 First Loss : 0.9264341084407041, Second Loss : 0.935942130154045
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3888888888888889, precision 0.476505208825103, recall 0.43858585858585863, F1 0.36460199004975125, AUC 0.7506228956228956
  Second-Tier acc 0.5208333333333334, precision 0.5924185463659147, recall 0.6160606060606061, F1 0.5224625285109156, AUC 0.8125252525252525
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3945578231292517, precision 0.5125647451963241, recall 0.4995590828924162, F1 0.38674586536221756, AUC 0.7362029688418578
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7841159611992946
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 11 idx: 0 First Loss : 3.384470224380493, Second Loss : 3.547294855117798
epoch: 11 idx: 200 First Loss : 0.9209410718350268, Second Loss : 0.9322939758902573
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5026433929942701, recall 0.48020202020202024, F1 0.396969460799248, AUC 0.7549607182940515
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8085353535353536
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.5317051883953293, recall 0.5351263962375074, F1 0.4209850868305516, AUC 0.745866402116402
  Second-Tier acc 0.4897959183673469, precision 0.5925039872408294, recall 0.6047178130511464, F1 0.49188712522045847, AUC 0.7942570546737212
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 12 idx: 0 First Loss : 3.420016050338745, Second Loss : 3.603015422821045
epoch: 12 idx: 200 First Loss : 0.9157839240737964, Second Loss : 0.9285224258357575
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.5041279669762643, recall 0.4915151515151515, F1 0.39906832298136646, AUC 0.754736251402918
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.8071717171717171
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.5555555555555556, recall 0.5388007054673721, F1 0.43019414662416694, AUC 0.7473912404467958
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7958553791887124
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 13 idx: 0 First Loss : 3.4394073486328125, Second Loss : 3.6320548057556152
epoch: 13 idx: 200 First Loss : 0.9110030748496823, Second Loss : 0.9248083598161144
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4236111111111111, precision 0.5213682695300342, recall 0.5159259259259259, F1 0.42100219285338064, AUC 0.7545735129068464
  Second-Tier acc 0.4166666666666667, precision 0.5098809523809523, recall 0.4916161616161616, F1 0.41071428571428575, AUC 0.7994444444444445
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4489795918367347, precision 0.5700483091787439, recall 0.556657848324515, F1 0.4497896589399857, AUC 0.7545194003527337
  Second-Tier acc 0.5102040816326531, precision 0.605, recall 0.6106701940035273, F1 0.5070818070818071, AUC 0.798666225749559
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 14 idx: 0 First Loss : 3.438896894454956, Second Loss : 3.6397626399993896
epoch: 14 idx: 200 First Loss : 0.9061183015438288, Second Loss : 0.9215101122413646
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3958333333333333, precision 0.5009970089730807, recall 0.47888888888888886, F1 0.39403221786709564, AUC 0.7481762065095398
  Second-Tier acc 0.375, precision 0.48015873015873023, recall 0.4505050505050505, F1 0.36393713813068657, AUC 0.7985858585858585
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46938775510204084, precision 0.5852502800034461, recall 0.5804673721340388, F1 0.4698730084919343, AUC 0.7599267587693513
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7983906525573192
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 15 idx: 0 First Loss : 3.4254627227783203, Second Loss : 3.630275249481201
epoch: 15 idx: 200 First Loss : 0.9019863686271808, Second Loss : 0.9188134509453837
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3958333333333333, precision 0.5018059855521156, recall 0.48141414141414146, F1 0.3922855086218359, AUC 0.7439842873176206
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7978282828282829
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5898701298701298, recall 0.5842886537330981, F1 0.47125159938205946, AUC 0.7634112286890065
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8009259259259259
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 16 idx: 0 First Loss : 3.4053802490234375, Second Loss : 3.6111884117126465
epoch: 16 idx: 200 First Loss : 0.8983781271867816, Second Loss : 0.9169311453588307
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4027777777777778, precision 0.5048101265822784, recall 0.5028282828282828, F1 0.3950904392764858, AUC 0.7378843995510662
  Second-Tier acc 0.375, precision 0.46964338343648687, recall 0.45303030303030306, F1 0.35419354838709677, AUC 0.7827272727272727
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5891156462585033, recall 0.578042328042328, F1 0.4604590708340989, AUC 0.765138154027043
  Second-Tier acc 0.4897959183673469, precision 0.5787545787545788, recall 0.5511463844797179, F1 0.4698412698412698, AUC 0.8009259259259259
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 17 idx: 0 First Loss : 3.382532835006714, Second Loss : 3.583487033843994
epoch: 17 idx: 200 First Loss : 0.8948046010681451, Second Loss : 0.9155183710002651
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.5051202214149801, recall 0.5036700336700336, F1 0.3935510156568302, AUC 0.7301122334455666
  Second-Tier acc 0.3958333333333333, precision 0.48333333333333334, recall 0.48333333333333334, F1 0.3697220036716496, AUC 0.7629292929292929
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.46258503401360546, precision 0.5867724867724867, recall 0.566137566137566, F1 0.45569567308697745, AUC 0.7638521457965902
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.7998236331569665
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 18 idx: 0 First Loss : 3.345778226852417, Second Loss : 3.5439982414245605
epoch: 18 idx: 200 First Loss : 0.8913864750937508, Second Loss : 0.9140909029106002
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.48148148148148145, recall 0.4657912457912458, F1 0.3636593858816081, AUC 0.716986531986532
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7474242424242424
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.43537414965986393, precision 0.5753968253968254, recall 0.5458553791887125, F1 0.4269179894179895, AUC 0.7627008622378991
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8017526455026455
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10)
Current LR: 1.9805531054030883e-05
epoch: 19 idx: 0 First Loss : 3.3032119274139404, Second Loss : 3.4969732761383057
epoch: 19 idx: 200 First Loss : 0.888159949465108, Second Loss : 0.9131353242399255
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3611111111111111, precision 0.46891674217255613, recall 0.4520875420875421, F1 0.3475930821766909, AUC 0.7098035914702582
  Second-Tier acc 0.375, precision 0.4566634082763115, recall 0.45555555555555555, F1 0.3401010708163583, AUC 0.7262121212121212
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4217687074829932, precision 0.5626895854398383, recall 0.5180776014109347, F1 0.409375, AUC 0.7594184793258867
  Second-Tier acc 0.46938775510204084, precision 0.5714285714285715, recall 0.5388007054673721, F1 0.448943213649096, AUC 0.8006503527336862
Test AUC: 0.7841, Test F1: 0.4919 (Best Epoch: 10){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.2871305967763505, "droprate_2": 0.0, "lr": 0.00011159916364857691, "weight_decay": 0.00016435613021170396, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00011159916364857691
epoch: 0 idx: 0 First Loss : 1.2427250146865845, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.1030655617441112, Second Loss : 1.1039346210769754
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7447081930415264
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.762979797979798
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7186213991769548
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.714726631393298
Test AUC: 0.7147, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00011159916364857691
epoch: 1 idx: 0 First Loss : 2.0629241466522217, Second Loss : 1.8601635694503784
epoch: 1 idx: 200 First Loss : 1.0005691815816349, Second Loss : 1.0137801360876406
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7399775533108865
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7472727272727272
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7212791495198903
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.720734126984127
Test AUC: 0.7147, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00011159916364857691
epoch: 2 idx: 0 First Loss : 2.5641186237335205, Second Loss : 2.2915658950805664
epoch: 2 idx: 200 First Loss : 0.9530849211399828, Second Loss : 0.9661094492199409
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5833333333333334, precision 0.5292207792207793, recall 0.5329292929292929, F1 0.5257421150278293, AUC 0.7292312008978676
  Second-Tier acc 0.6458333333333334, precision 0.41798941798941797, recall 0.583030303030303, F1 0.4775641025641026, AUC 0.7354545454545454
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5986394557823129, precision 0.568048713738369, recall 0.5928130511463845, F1 0.576807771159889, AUC 0.7191786694101509
  Second-Tier acc 0.5918367346938775, precision 0.6098484848484849, recall 0.531305114638448, F1 0.5286195286195287, AUC 0.7299933862433864
Test AUC: 0.7147, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00011159916364857691
epoch: 3 idx: 0 First Loss : 3.246915578842163, Second Loss : 3.1202714443206787
epoch: 3 idx: 200 First Loss : 0.9297009319048467, Second Loss : 0.9430828730283833
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4305555555555556, precision 0.5023369813041495, recall 0.4546464646464647, F1 0.4118238120936448, AUC 0.7199214365881031
  Second-Tier acc 0.4166666666666667, precision 0.5346320346320347, recall 0.45080808080808077, F1 0.3592132505175983, AUC 0.7497979797979797
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4965986394557823, precision 0.5488211382113821, recall 0.5246913580246914, F1 0.495621122349233, AUC 0.7209668332353519
  Second-Tier acc 0.5306122448979592, precision 0.7224462365591399, recall 0.5057319223985891, F1 0.4978466838931956, AUC 0.7574955908289241
Test AUC: 0.7147, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00011159916364857691
epoch: 4 idx: 0 First Loss : 3.836136817932129, Second Loss : 3.9200990200042725
epoch: 4 idx: 200 First Loss : 0.9213369763155111, Second Loss : 0.9406188499247331
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.5062310606060606, recall 0.47969696969696973, F1 0.4244303462860164, AUC 0.7314814814814815
  Second-Tier acc 0.3958333333333333, precision 0.3631578947368421, recall 0.44, F1 0.3020408163265306, AUC 0.7521212121212121
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46258503401360546, precision 0.5234533984533986, recall 0.5398295120517344, F1 0.46276901693762423, AUC 0.7354007446600038
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.7680224867724869
Test AUC: 0.7147, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00011159916364857691
epoch: 5 idx: 0 First Loss : 4.080623149871826, Second Loss : 4.3186936378479
epoch: 5 idx: 200 First Loss : 0.9166272126905045, Second Loss : 0.939646349762293
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3611111111111111, precision 0.46716791979949884, recall 0.4296969696969697, F1 0.3299355107135427, AUC 0.7341975308641975
  Second-Tier acc 0.375, precision 0.5460526315789473, recall 0.4241414141414141, F1 0.3250876108018965, AUC 0.7691414141414142
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4897959183673469, precision 0.5919452887537994, recall 0.5413727219282775, F1 0.47472893366345087, AUC 0.7445926415833823
  Second-Tier acc 0.4897959183673469, precision 0.5705705705705706, recall 0.4861111111111111, F1 0.4102792632204397, AUC 0.798941798941799
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 6 idx: 0 First Loss : 4.1410441398620605, Second Loss : 4.1977996826171875
epoch: 6 idx: 200 First Loss : 0.9061070968998152, Second Loss : 0.9343007007105257
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3611111111111111, precision 0.4476767676767677, recall 0.4296969696969697, F1 0.32936962376134077, AUC 0.7445061728395062
  Second-Tier acc 0.375, precision 0.4928678678678678, recall 0.4241414141414141, F1 0.32474747474747473, AUC 0.7685858585858586
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.43537414965986393, precision 0.5112457912457912, recall 0.4438565549676661, F1 0.3767985644885341, AUC 0.7416654418969234
  Second-Tier acc 0.42857142857142855, precision 0.5307017543859649, recall 0.43761022927689597, F1 0.35947712418300654, AUC 0.7882495590828924
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 7 idx: 0 First Loss : 4.015873432159424, Second Loss : 4.103521347045898
epoch: 7 idx: 200 First Loss : 0.8980873235943264, Second Loss : 0.9290298946040789
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3472222222222222, precision 0.43157894736842106, recall 0.4151515151515152, F1 0.31803070599613154, AUC 0.7243041526374859
  Second-Tier acc 0.3541666666666667, precision 0.4591377091377091, recall 0.41080808080808073, F1 0.3055555555555556, AUC 0.737929292929293
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3945578231292517, precision 0.5136125136125137, recall 0.42937977660199883, F1 0.36357040141336944, AUC 0.7151920438957475
  Second-Tier acc 0.40816326530612246, precision 0.506006006006006, recall 0.42526455026455023, F1 0.33876580935404466, AUC 0.7503306878306878
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 8 idx: 0 First Loss : 3.972947835922241, Second Loss : 4.090310096740723
epoch: 8 idx: 200 First Loss : 0.8976870903286872, Second Loss : 0.9282032648337175
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3194444444444444, precision 0.3978593272171254, recall 0.3950841750841751, F1 0.26293315448245025, AUC 0.702598204264871
  Second-Tier acc 0.375, precision 0.4384920634920635, recall 0.44111111111111106, F1 0.325, AUC 0.714949494949495
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3741496598639456, precision 0.47635220125786165, recall 0.38727219282774833, F1 0.30384318675923977, AUC 0.6880144032921812
  Second-Tier acc 0.3877551020408163, precision 0.4941798941798942, recall 0.41291887125220456, F1 0.3202531012404962, AUC 0.7165454144620811
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 9 idx: 0 First Loss : 3.892929792404175, Second Loss : 3.9802393913269043
epoch: 9 idx: 200 First Loss : 0.8998778453735294, Second Loss : 0.9262560392244584
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3402777777777778, precision 0.41947398428397903, recall 0.4140740740740741, F1 0.2788008735358348, AUC 0.6882884399551067
  Second-Tier acc 0.3541666666666667, precision 0.42569444444444454, recall 0.42777777777777776, F1 0.30837254768237515, AUC 0.6921717171717172
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.38095238095238093, precision 0.46881091617933723, recall 0.39307760141093473, F1 0.2909798534798535, AUC 0.6703409758965314
  Second-Tier acc 0.3877551020408163, precision 0.49411764705882355, recall 0.41291887125220456, F1 0.32175925925925924, AUC 0.6878858024691358
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 10 idx: 0 First Loss : 4.036479949951172, Second Loss : 3.9366254806518555
epoch: 10 idx: 200 First Loss : 0.902049837667053, Second Loss : 0.926660789532873
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3055555555555556, precision 0.3803030303030303, recall 0.3918518518518519, F1 0.2458001768346596, AUC 0.6760942760942762
  Second-Tier acc 0.3125, precision 0.3967181467181467, recall 0.40111111111111114, F1 0.2568310143174027, AUC 0.6920202020202021
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.464556277056277, recall 0.37691064079952974, F1 0.2755225040146409, AUC 0.6714493925142073
  Second-Tier acc 0.3877551020408163, precision 0.4953703703703704, recall 0.41291887125220456, F1 0.31916666666666665, AUC 0.6706900352733687
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 11 idx: 0 First Loss : 3.835580587387085, Second Loss : 3.8218259811401367
epoch: 11 idx: 200 First Loss : 0.902066718926103, Second Loss : 0.9195152028207204
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3194444444444444, precision 0.39715608465608465, recall 0.4007407407407408, F1 0.2588124997010442, AUC 0.6800448933782267
  Second-Tier acc 0.2916666666666667, precision 0.362987987987988, recall 0.3877777777777778, F1 0.2337301587301587, AUC 0.7036363636363637
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3469387755102041, precision 0.4742326424283611, recall 0.37463256907701353, F1 0.273624355203258, AUC 0.6739785420340976
  Second-Tier acc 0.3673469387755102, precision 0.49074074074074076, recall 0.40057319223985893, F1 0.29857052498418724, AUC 0.6560846560846562
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 12 idx: 0 First Loss : 3.744706153869629, Second Loss : 3.7116200923919678
epoch: 12 idx: 200 First Loss : 0.899692458588468, Second Loss : 0.9131324023382063
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3194444444444444, precision 0.4017403691316735, recall 0.4055555555555555, F1 0.2656842496366478, AUC 0.6828395061728395
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.7027272727272728
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.35374149659863946, precision 0.48619615425931895, recall 0.38852145796590243, F1 0.2874683653487933, AUC 0.6691100823045266
  Second-Tier acc 0.3877551020408163, precision 0.5011261261261262, recall 0.4243827160493827, F1 0.3106947079907232, AUC 0.6523919753086419
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 13 idx: 0 First Loss : 3.7097222805023193, Second Loss : 3.685455083847046
epoch: 13 idx: 200 First Loss : 0.9034507226750799, Second Loss : 0.9108947634722879
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3194444444444444, precision 0.39609158030210656, recall 0.4007407407407408, F1 0.25941720576552035, AUC 0.6791750841750842
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.701010101010101
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.36054421768707484, precision 0.48742768135291503, recall 0.392636684303351, F1 0.2945054152025358, AUC 0.667309670781893
  Second-Tier acc 0.3469387755102041, precision 0.456140350877193, recall 0.3703703703703704, F1 0.24615384615384617, AUC 0.6598324514991182
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 14 idx: 0 First Loss : 3.8914363384246826, Second Loss : 3.8426434993743896
epoch: 14 idx: 200 First Loss : 0.8996473340707577, Second Loss : 0.9037364450873135
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3194444444444444, precision 0.39405964405964405, recall 0.4007407407407408, F1 0.26141387828677104, AUC 0.6768013468013468
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.7024242424242425
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.4873129472999349, recall 0.392636684303351, F1 0.29492852560411903, AUC 0.6688467568097197
  Second-Tier acc 0.3673469387755102, precision 0.456140350877193, recall 0.38271604938271603, F1 0.2655086848635236, AUC 0.666060405643739
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 15 idx: 0 First Loss : 3.9281556606292725, Second Loss : 3.8531014919281006
epoch: 15 idx: 200 First Loss : 0.8947867703884538, Second Loss : 0.8985495880414197
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3125, precision 0.39211717075494174, recall 0.3962962962962963, F1 0.2505746724075565, AUC 0.6738945005611671
  Second-Tier acc 0.2708333333333333, precision 0.3162393162393162, recall 0.36000000000000004, F1 0.19428571428571428, AUC 0.6924747474747476
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.36054421768707484, precision 0.4782282282282282, recall 0.38668430335097, F1 0.2837339236769977, AUC 0.669250930825005
  Second-Tier acc 0.3469387755102041, precision 0.452991452991453, recall 0.3703703703703704, F1 0.2427672955974843, AUC 0.656305114638448
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 16 idx: 0 First Loss : 3.98712420463562, Second Loss : 3.8950586318969727
epoch: 16 idx: 200 First Loss : 0.8925237705854887, Second Loss : 0.8948787521381855
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3402777777777778, precision 0.42173539518900344, recall 0.4237037037037037, F1 0.2973353443941679, AUC 0.6721941638608305
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.694040404040404
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.38095238095238093, precision 0.5093943412908931, recall 0.4207084068195179, F1 0.33008846748559173, AUC 0.6742663629237704
  Second-Tier acc 0.3673469387755102, precision 0.4471544715447155, recall 0.38271604938271603, F1 0.25571847507331374, AUC 0.6624228395061729
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 17 idx: 0 First Loss : 3.797236680984497, Second Loss : 3.8118090629577637
epoch: 17 idx: 200 First Loss : 0.877148573734701, Second Loss : 0.8881091272844277
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.4272081413210446, recall 0.42814814814814817, F1 0.3073999552872792, AUC 0.6687766554433221
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6926767676767677
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4013605442176871, precision 0.5211107317628314, recall 0.43900646678424454, F1 0.3589501244487767, AUC 0.6767465216539291
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6764770723104055
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 18 idx: 0 First Loss : 3.8372573852539062, Second Loss : 3.8139617443084717
epoch: 18 idx: 200 First Loss : 0.8700540469774194, Second Loss : 0.8775333452176076
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.41622036783327104, recall 0.4192592592592593, F1 0.2935298587137898, AUC 0.6695959595959596
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6907575757575758
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3741496598639456, precision 0.5063316993464052, recall 0.41659318048206934, F1 0.3230186873803895, AUC 0.6765873015873015
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.685515873015873
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5)
Current LR: 0.00011159916364857691
epoch: 19 idx: 0 First Loss : 3.9046976566314697, Second Loss : 3.803581953048706
epoch: 19 idx: 200 First Loss : 0.8631085076767342, Second Loss : 0.8739893809028697
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3194444444444444, precision 0.39877136752136755, recall 0.4055555555555555, F1 0.2718360071301248, AUC 0.66841189674523
  Second-Tier acc 0.2916666666666667, precision 0.3416666666666666, recall 0.37333333333333335, F1 0.2127563669145819, AUC 0.6913636363636364
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.35374149659863946, precision 0.49457514233537436, recall 0.39447383891828336, F1 0.29557270877034575, AUC 0.6792144326866549
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6922949735449735
Test AUC: 0.7989, Test F1: 0.4103 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.2221111978625608, "droprate_2": 0.0, "lr": 0.00035658445242585114, "weight_decay": 1.1765661047495902e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00035658445242585114
epoch: 0 idx: 0 First Loss : 1.2510004043579102, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0858841400537917, Second Loss : 1.0664908110502347
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.743030303030303
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7448989898989898
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7051550558495002
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6951609347442681
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 1 idx: 0 First Loss : 1.7398653030395508, Second Loss : 1.6886286735534668
epoch: 1 idx: 200 First Loss : 0.9787810045984847, Second Loss : 0.9843537081681674
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7297586980920313
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7352020202020202
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7389893200078386
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7389770723104055
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 2 idx: 0 First Loss : 2.059906244277954, Second Loss : 2.2188215255737305
epoch: 2 idx: 200 First Loss : 0.9443562210940603, Second Loss : 0.9508918982684909
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7145791245791244
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7275252525252526
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7127486282578875
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.722773368606702
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 3 idx: 0 First Loss : 2.508483409881592, Second Loss : 2.4920997619628906
epoch: 3 idx: 200 First Loss : 0.935771592795404, Second Loss : 0.9445787065694877
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.5925534413906507, recall 0.5296296296296296, F1 0.4241901888960713, AUC 0.7084848484848485
  Second-Tier acc 0.4583333333333333, precision 0.3697478991596639, recall 0.48, F1 0.350997150997151, AUC 0.6951515151515152
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5306122448979592, precision 0.484439199230702, recall 0.44922104644326866, F1 0.40581023914357245, AUC 0.6873224083872232
  Second-Tier acc 0.5102040816326531, precision 0.37753882915173237, recall 0.4347442680776014, F1 0.3703703703703704, AUC 0.6964285714285715
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 4 idx: 0 First Loss : 3.1632373332977295, Second Loss : 3.2118380069732666
epoch: 4 idx: 200 First Loss : 0.9100813791016812, Second Loss : 0.9302141070226903
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.375, precision 0.3764912280701755, recall 0.4266666666666667, F1 0.28965986394557824, AUC 0.7133613916947251
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7268686868686869
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.46736014794267217, recall 0.4325396825396825, F1 0.3673648239891434, AUC 0.6653132961003331
  Second-Tier acc 0.5102040816326531, precision 0.4280626780626781, recall 0.4576719576719577, F1 0.37333333333333335, AUC 0.7035934744268078
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 5 idx: 0 First Loss : 3.407226800918579, Second Loss : 3.5985758304595947
epoch: 5 idx: 200 First Loss : 0.899151827257349, Second Loss : 0.9136988974282917
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.736307519640853
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6970202020202021
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.6732865471291397
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.7409611992945325
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 6 idx: 0 First Loss : 3.7955238819122314, Second Loss : 3.631512403488159
epoch: 6 idx: 200 First Loss : 0.8954926711236085, Second Loss : 0.917300407898691
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.3815217391304348, recall 0.4222222222222222, F1 0.2798452714419101, AUC 0.6796127946127947
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6495959595959596
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.4490358126721763, recall 0.43209876543209874, F1 0.3241600934852469, AUC 0.6896984616892023
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.708994708994709
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 7 idx: 0 First Loss : 3.8657643795013428, Second Loss : 3.6688718795776367
epoch: 7 idx: 200 First Loss : 0.892885077701863, Second Loss : 0.9194008439364588
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.38031576266870387, recall 0.4177777777777778, F1 0.27532103454512574, AUC 0.6721997755331088
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.6967171717171717
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4421768707482993, precision 0.4490358126721763, recall 0.4279835390946502, F1 0.3192150385401919, AUC 0.649421908681168
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6541005291005292
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 8 idx: 0 First Loss : 3.9872238636016846, Second Loss : 3.738656759262085
epoch: 8 idx: 200 First Loss : 0.8980457062065017, Second Loss : 0.9213886499846243
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3611111111111111, precision 0.37878787878787873, recall 0.4177777777777778, F1 0.2734413352970054, AUC 0.6400561167227833
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6937878787878787
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4421768707482993, precision 0.4471544715447155, recall 0.4279835390946502, F1 0.3171328671328671, AUC 0.6879715363511659
  Second-Tier acc 0.4897959183673469, precision 0.452991452991453, recall 0.4567901234567901, F1 0.35628080911099785, AUC 0.683752204585538
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 9 idx: 0 First Loss : 3.847676992416382, Second Loss : 3.607020616531372
epoch: 9 idx: 200 First Loss : 0.8904526238955224, Second Loss : 0.9170976095668976
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3680555555555556, precision 0.5122679580306699, recall 0.4318518518518519, F1 0.3032156894416626, AUC 0.6551964085297418
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7021212121212121
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.43537414965986393, precision 0.43550724637681154, recall 0.4238683127572016, F1 0.3138651471984805, AUC 0.6851790613364687
  Second-Tier acc 0.5102040816326531, precision 0.7894736842105262, recall 0.49845679012345673, F1 0.4337414337414338, AUC 0.6819334215167548
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 10 idx: 0 First Loss : 3.8715298175811768, Second Loss : 3.5975773334503174
epoch: 10 idx: 200 First Loss : 0.8903938448774763, Second Loss : 0.9181350686967336
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3472222222222222, precision 0.40830280830280835, recall 0.4137037037037037, F1 0.27445124439004487, AUC 0.6165319865319865
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6563131313131313
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4217687074829932, precision 0.4341269841269841, recall 0.4156378600823045, F1 0.30355846042120554, AUC 0.6471499608073682
  Second-Tier acc 0.5102040816326531, precision 0.7894736842105262, recall 0.49845679012345673, F1 0.4337414337414338, AUC 0.6305114638447972
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 11 idx: 0 First Loss : 3.8810694217681885, Second Loss : 3.5783846378326416
epoch: 11 idx: 200 First Loss : 0.890574120681858, Second Loss : 0.914748932760115
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.4297282754909873, recall 0.4181481481481481, F1 0.2800110823955922, AUC 0.6605274971941639
  Second-Tier acc 0.4166666666666667, precision 0.5620620620620621, recall 0.4677777777777778, F1 0.3572595704948646, AUC 0.6884343434343435
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.4374846475067551, recall 0.4238683127572016, F1 0.316025641025641, AUC 0.6407995296884186
  Second-Tier acc 0.5102040816326531, precision 0.7894736842105262, recall 0.49845679012345673, F1 0.4337414337414338, AUC 0.6315586419753086
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 12 idx: 0 First Loss : 3.682305097579956, Second Loss : 3.452383518218994
epoch: 12 idx: 200 First Loss : 0.8886848986379059, Second Loss : 0.9203991327356661
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3680555555555556, precision 0.4368565717141429, recall 0.42703703703703705, F1 0.29316286999330754, AUC 0.6720202020202021
  Second-Tier acc 0.3958333333333333, precision 0.47685185185185186, recall 0.45444444444444443, F1 0.33910917687513437, AUC 0.6891919191919191
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4421768707482993, precision 0.43747188484030586, recall 0.42034097589653147, F1 0.32670341081556037, AUC 0.6457231040564374
  Second-Tier acc 0.5102040816326531, precision 0.6261261261261262, recall 0.49845679012345673, F1 0.42985338279455926, AUC 0.6416997354497355
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 13 idx: 0 First Loss : 3.769806146621704, Second Loss : 3.515362024307251
epoch: 13 idx: 200 First Loss : 0.8861347493816651, Second Loss : 0.9242804257257231
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.46433904259991216, recall 0.42777777777777776, F1 0.29872872185844046, AUC 0.66824354657688
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.6731818181818182
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.48412698412698413, recall 0.4275426219870664, F1 0.3389668467067848, AUC 0.6508365177346659
  Second-Tier acc 0.3877551020408163, precision 0.5085470085470086, recall 0.4243827160493827, F1 0.3097411819262093, AUC 0.6590057319223985
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 14 idx: 0 First Loss : 4.068159580230713, Second Loss : 3.8383474349975586
epoch: 14 idx: 200 First Loss : 0.8746441565977984, Second Loss : 0.9100002052985822
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3541666666666667, precision 0.45694223635400105, recall 0.43259259259259264, F1 0.3055091044221479, AUC 0.6624747474747474
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6758080808080807
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.5127996749288907, recall 0.43503821281599064, F1 0.34688049145118566, AUC 0.658344356261023
  Second-Tier acc 0.3673469387755102, precision 0.5006105006105006, recall 0.41203703703703703, F1 0.28721174004192873, AUC 0.677414021164021
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 15 idx: 0 First Loss : 4.4326066970825195, Second Loss : 4.206810474395752
epoch: 15 idx: 200 First Loss : 0.8769253270297827, Second Loss : 0.9137913430184819
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.4477411477411477, recall 0.4184175084175084, F1 0.2916861461742247, AUC 0.6671324354657688
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6730808080808082
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.38095238095238093, precision 0.5274509803921569, recall 0.4478982951205173, F1 0.3329116740133689, AUC 0.66413139329806
  Second-Tier acc 0.3673469387755102, precision 0.5006105006105006, recall 0.41203703703703703, F1 0.28721174004192873, AUC 0.691468253968254
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 16 idx: 0 First Loss : 4.28593635559082, Second Loss : 4.1923933029174805
epoch: 16 idx: 200 First Loss : 0.8680315138235574, Second Loss : 0.8948100857704884
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3263888888888889, precision 0.413015873015873, recall 0.4091582491582492, F1 0.2832020466556244, AUC 0.6744388327721662
  Second-Tier acc 0.3125, precision 0.3583333333333334, recall 0.38666666666666666, F1 0.23267973856209148, AUC 0.6759595959595961
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3877551020408163, precision 0.5333515333515334, recall 0.45796590241034685, F1 0.34681086964946783, AUC 0.6622881148344111
  Second-Tier acc 0.3673469387755102, precision 0.530214424951267, recall 0.441358024691358, F1 0.30389556353045194, AUC 0.6946649029982362
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 17 idx: 0 First Loss : 4.339777946472168, Second Loss : 4.3199462890625
epoch: 17 idx: 200 First Loss : 0.8661463856060663, Second Loss : 0.9045521405209933
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3263888888888889, precision 0.4370254051105114, recall 0.40831649831649836, F1 0.29172509258260526, AUC 0.6754208754208754
  Second-Tier acc 0.3125, precision 0.36068376068376073, recall 0.38666666666666666, F1 0.23555555555555555, AUC 0.6765656565656566
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3741496598639456, precision 0.5310270449643272, recall 0.4535567313345091, F1 0.3276906613985266, AUC 0.6731028316676465
  Second-Tier acc 0.3469387755102041, precision 0.5228070175438596, recall 0.4290123456790123, F1 0.27737077737077737, AUC 0.6973104056437389
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 18 idx: 0 First Loss : 4.494654655456543, Second Loss : 4.490449905395508
epoch: 18 idx: 200 First Loss : 0.8652036537882488, Second Loss : 0.9016260416106109
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3194444444444444, precision 0.42396783367657154, recall 0.41037037037037044, F1 0.27193618814685844, AUC 0.6859652076318742
  Second-Tier acc 0.3125, precision 0.3631578947368421, recall 0.38666666666666666, F1 0.2385487528344671, AUC 0.6754545454545454
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3197278911564626, precision 0.47239326765188827, recall 0.3619929453262787, F1 0.2399654130298242, AUC 0.6625024495394866
  Second-Tier acc 0.32653061224489793, precision 0.5092592592592593, recall 0.4052028218694885, F1 0.26380952380952377, AUC 0.6898699294532628
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00035658445242585114
epoch: 19 idx: 0 First Loss : 4.502608776092529, Second Loss : 4.465484142303467
epoch: 19 idx: 200 First Loss : 0.8690287714290259, Second Loss : 0.8993782136534599
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.35133565621370505, recall 0.38222222222222224, F1 0.22342264477095938, AUC 0.6774635241301907
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6780303030303031
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.36054421768707484, precision 0.47690288713910767, recall 0.3883744855967079, F1 0.25854838977010924, AUC 0.6608551342347639
  Second-Tier acc 0.30612244897959184, precision 0.43478260869565216, recall 0.345679012345679, F1 0.17936507936507937, AUC 0.6733906525573191
Test AUC: 0.6952, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.4012371540524372, "droprate_2": 0.0, "lr": 1.0314304767911298e-05, "weight_decay": 2.345460956053845e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0314304767911298e-05
epoch: 0 idx: 0 First Loss : 1.260959506034851, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0534000828194974, Second Loss : 1.0362696324414875
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.664057239057239
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7460606060606061
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.604656574563982
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6063712522045855
Test AUC: 0.6064, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0314304767911298e-05
epoch: 1 idx: 0 First Loss : 2.000365972518921, Second Loss : 1.9045640230178833
epoch: 1 idx: 200 First Loss : 1.098780606887234, Second Loss : 1.090465340299986
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.704388327721661
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7582828282828283
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6472846854791299
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6477072310405644
Test AUC: 0.6477, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0314304767911298e-05
epoch: 2 idx: 0 First Loss : 2.154230833053589, Second Loss : 2.0818800926208496
epoch: 2 idx: 200 First Loss : 1.0983993675726562, Second Loss : 1.0902253554679862
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7223961840628507
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7619696969696971
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6771262002743484
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6878306878306878
Test AUC: 0.6878, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0314304767911298e-05
epoch: 3 idx: 0 First Loss : 2.203223943710327, Second Loss : 2.1403069496154785
epoch: 3 idx: 200 First Loss : 1.0874095461261806, Second Loss : 1.0798160124625733
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7336307519640853
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7688888888888888
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6968327454438565
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.704916225749559
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 4 idx: 0 First Loss : 2.2630648612976074, Second Loss : 2.1953060626983643
epoch: 4 idx: 200 First Loss : 1.0764979851705518, Second Loss : 1.0690317381525514
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7398709315375983
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.762979797979798
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7064043209876543
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7079475308641975
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 5 idx: 0 First Loss : 2.3271496295928955, Second Loss : 2.260199546813965
epoch: 5 idx: 200 First Loss : 1.0663846644818487, Second Loss : 1.0590245339333715
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7410942760942761
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7566666666666665
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7143653243190281
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7122464726631393
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 6 idx: 0 First Loss : 2.3958635330200195, Second Loss : 2.3253846168518066
epoch: 6 idx: 200 First Loss : 1.0548233328692949, Second Loss : 1.0476857903065966
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7404545454545454
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7541919191919191
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7142183519498335
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7094356261022927
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 7 idx: 0 First Loss : 2.4792630672454834, Second Loss : 2.402409553527832
epoch: 7 idx: 200 First Loss : 1.0420589084871372, Second Loss : 1.035818237459185
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5902777777777778, precision 0.41534391534391535, recall 0.44565656565656564, F1 0.3989854648326993, AUC 0.7381593714927047
  Second-Tier acc 0.5833333333333334, precision 0.3666666666666667, recall 0.4412121212121212, F1 0.3865047233468286, AUC 0.7514646464646465
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5918367346938775, precision 0.6386890487609912, recall 0.41071428571428564, F1 0.37521188900499247, AUC 0.7078495492847344
  Second-Tier acc 0.5918367346938775, precision 0.32041343669250644, recall 0.38095238095238093, F1 0.3238095238095238, AUC 0.7121362433862434
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 8 idx: 0 First Loss : 2.5714540481567383, Second Loss : 2.488257646560669
epoch: 8 idx: 200 First Loss : 1.0259462020068026, Second Loss : 1.021447303876355
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6388888888888888, precision 0.5837191358024691, recall 0.525993265993266, F1 0.48685722292279676, AUC 0.7381144781144782
  Second-Tier acc 0.6875, precision 0.4495798319327731, recall 0.5927272727272728, F1 0.5111864406779661, AUC 0.7564646464646465
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6598639455782312, precision 0.6829997699562917, recall 0.548721340388007, F1 0.5703067191788996, AUC 0.7030239564961788
  Second-Tier acc 0.5918367346938775, precision 0.5317460317460317, recall 0.4561287477954144, F1 0.4539682539682539, AUC 0.7060736331569665
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 9 idx: 0 First Loss : 2.66343092918396, Second Loss : 2.58429217338562
epoch: 9 idx: 200 First Loss : 1.0100738145225676, Second Loss : 1.0068694818857593
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6666666666666666, precision 0.6288770053475936, recall 0.6057575757575758, F1 0.5879392666157371, AUC 0.7343883277216611
  Second-Tier acc 0.6666666666666666, precision 0.42857142857142855, recall 0.5963636363636363, F1 0.4917833231892879, AUC 0.7562121212121212
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.6122448979591837, precision 0.5800723666577325, recall 0.5972222222222222, F1 0.5873974854424956, AUC 0.7053877621007251
  Second-Tier acc 0.5918367346938775, precision 0.4963768115942029, recall 0.5134479717813051, F1 0.48592592592592604, AUC 0.7094356261022927
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 10 idx: 0 First Loss : 2.760446548461914, Second Loss : 2.6903622150421143
epoch: 10 idx: 200 First Loss : 0.9944794948643713, Second Loss : 0.9924843857685725
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6180555555555556, precision 0.5825757575757575, recall 0.5945117845117845, F1 0.5858219046793806, AUC 0.7297755331088664
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7492424242424242
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5782312925170068, precision 0.5417608925071612, recall 0.5766460905349794, F1 0.550178085061806, AUC 0.7084741818538115
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.7255291005291005
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 11 idx: 0 First Loss : 2.8582804203033447, Second Loss : 2.8031680583953857
epoch: 11 idx: 200 First Loss : 0.9807656291983465, Second Loss : 0.9803159844074676
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5763888888888888, precision 0.5653166278166278, recall 0.5814478114478114, F1 0.5588562793287203, AUC 0.7302020202020202
  Second-Tier acc 0.5208333333333334, precision 0.5714285714285714, recall 0.5463636363636364, F1 0.48717948717948717, AUC 0.7622727272727273
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5238095238095238, precision 0.5081686429512516, recall 0.5518077601410935, F1 0.5041507512095748, AUC 0.7119586517734665
  Second-Tier acc 0.6326530612244898, precision 0.6455314009661836, recall 0.6554232804232805, F1 0.6287537537537538, AUC 0.7389219576719576
Test AUC: 0.7049, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0314304767911298e-05
epoch: 12 idx: 0 First Loss : 2.9513986110687256, Second Loss : 2.910144090652466
epoch: 12 idx: 200 First Loss : 0.9690631371158273, Second Loss : 0.9697898950483372
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.5069444444444444, precision 0.5291117388575016, recall 0.5305050505050505, F1 0.49647753720980264, AUC 0.7300897867564534
  Second-Tier acc 0.5, precision 0.5702260702260702, recall 0.5474747474747474, F1 0.4831094831094831, AUC 0.7717676767676768
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.494335122242099, recall 0.5387272192827748, F1 0.47002974147792265, AUC 0.7168332353517538
  Second-Tier acc 0.5918367346938775, precision 0.6126262626262626, recall 0.6779100529100529, F1 0.608994708994709, AUC 0.7539131393298059
Test AUC: 0.7539, Test F1: 0.6090 (Best Epoch: 12)
Current LR: 1.0314304767911298e-05
epoch: 13 idx: 0 First Loss : 3.0388481616973877, Second Loss : 3.0132811069488525
epoch: 13 idx: 200 First Loss : 0.9589402461748812, Second Loss : 0.9610759201575423
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4791666666666667, precision 0.5171612606395215, recall 0.5118855218855218, F1 0.47069002258875675, AUC 0.7314870931537598
  Second-Tier acc 0.5, precision 0.5670940170940172, recall 0.5619191919191919, F1 0.4904976404976405, AUC 0.7873232323232323
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.48299319727891155, precision 0.5143467643467644, recall 0.5543062904174015, F1 0.4804988662131519, AUC 0.7217813051146384
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7604717813051147
Test AUC: 0.7605, Test F1: 0.5455 (Best Epoch: 13)
Current LR: 1.0314304767911298e-05
epoch: 14 idx: 0 First Loss : 3.1178855895996094, Second Loss : 3.106788158416748
epoch: 14 idx: 200 First Loss : 0.9505375077280758, Second Loss : 0.9541636435639355
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4722222222222222, precision 0.5353361198188785, recall 0.5244107744107743, F1 0.47023115773115776, AUC 0.7384736251402918
  Second-Tier acc 0.5, precision 0.5724867724867725, recall 0.5763636363636363, F1 0.49589408412937824, AUC 0.7997474747474748
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.47619047619047616, precision 0.5205920619613966, recall 0.5578336272780717, F1 0.477950377562028, AUC 0.7266558886929259
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7671957671957671
Test AUC: 0.7672, Test F1: 0.5455 (Best Epoch: 14)
Current LR: 1.0314304767911298e-05
epoch: 15 idx: 0 First Loss : 3.1840121746063232, Second Loss : 3.193432092666626
epoch: 15 idx: 200 First Loss : 0.9440337098829115, Second Loss : 0.9487229659180365
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4444444444444444, precision 0.5220388166572452, recall 0.5066329966329967, F1 0.4449645390070922, AUC 0.7400224466891133
  Second-Tier acc 0.5, precision 0.5805555555555556, recall 0.5908080808080808, F1 0.4994388327721661, AUC 0.8075757575757576
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.47619047619047616, precision 0.5267763019186169, recall 0.5578336272780717, F1 0.4780304719435155, AUC 0.7321673525377229
  Second-Tier acc 0.5306122448979592, precision 0.5907608695652175, recall 0.6408730158730159, F1 0.5367867867867869, AUC 0.7779982363315696
Test AUC: 0.7780, Test F1: 0.5368 (Best Epoch: 15)
Current LR: 1.0314304767911298e-05
epoch: 16 idx: 0 First Loss : 3.240178346633911, Second Loss : 3.2660794258117676
epoch: 16 idx: 200 First Loss : 0.9383462075218187, Second Loss : 0.943906433597689
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4375, precision 0.5156873822975517, recall 0.49653198653198655, F1 0.4373023957743822, AUC 0.7420763187429853
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.8114646464646466
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.46258503401360546, precision 0.5359261919965943, recall 0.553424456202234, F1 0.46462300801923445, AUC 0.7341147364295512
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7774470899470899
Test AUC: 0.7774, Test F1: 0.5320 (Best Epoch: 16)
Current LR: 1.0314304767911298e-05
epoch: 17 idx: 0 First Loss : 3.2780771255493164, Second Loss : 3.3324711322784424
epoch: 17 idx: 200 First Loss : 0.933506417486687, Second Loss : 0.9404460791711561
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4652777777777778, precision 0.5548123374210331, recall 0.5434343434343435, F1 0.46819940097251017, AUC 0.7455274971941638
  Second-Tier acc 0.4791666666666667, precision 0.5618580765639588, recall 0.5774747474747475, F1 0.47639573070607555, AUC 0.8131313131313131
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.5102040816326531, precision 0.591062076569323, recall 0.6030276308054087, F1 0.5100833181292951, AUC 0.7379360180286105
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7780533509700177
Test AUC: 0.7781, Test F1: 0.5320 (Best Epoch: 17)
Current LR: 1.0314304767911298e-05
epoch: 18 idx: 0 First Loss : 3.3183205127716064, Second Loss : 3.3845081329345703
epoch: 18 idx: 200 First Loss : 0.9292046230202958, Second Loss : 0.9368042469196096
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4444444444444444, precision 0.5451461988304094, recall 0.5422558922558922, F1 0.44484286209166973, AUC 0.7507800224466892
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8158585858585857
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4897959183673469, precision 0.5840783612522743, recall 0.5906819517930629, F1 0.49112978524743234, AUC 0.7418307858122674
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7775573192239859
Test AUC: 0.7776, Test F1: 0.5320 (Best Epoch: 18)
Current LR: 1.0314304767911298e-05
epoch: 19 idx: 0 First Loss : 3.342750310897827, Second Loss : 3.4244368076324463
epoch: 19 idx: 200 First Loss : 0.9247453998477749, Second Loss : 0.9334189377618555
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4444444444444444, precision 0.5466183574879228, recall 0.543939393939394, F1 0.4434503294504826, AUC 0.7506341189674522
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8153535353535354
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4897959183673469, precision 0.6, recall 0.5945032333921222, F1 0.49117125346287543, AUC 0.7434168626298255
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7833994708994708
Test AUC: 0.7776, Test F1: 0.5320 (Best Epoch: 18){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.020081392527013454, "droprate_2": 0.0, "lr": 0.00021050378634232216, "weight_decay": 0.00021353057619947512, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.17672910628133254, "droprate_2": 0.0, "lr": 0.00010868337093247477, "weight_decay": 0.0002714040450263032, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00010868337093247477
epoch: 0 idx: 0 First Loss : 1.1435414552688599, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.104061199027804, Second Loss : 1.102558153889962
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.761341189674523
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7565151515151515
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7063737017440722
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6962632275132276
Test AUC: 0.6963, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010868337093247477
epoch: 1 idx: 0 First Loss : 1.8053827285766602, Second Loss : 1.9001548290252686
epoch: 1 idx: 200 First Loss : 1.0031670705596012, Second Loss : 1.0056136509968867
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7436475869809204
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7518686868686869
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7192399078973152
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7202932098765432
Test AUC: 0.6963, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010868337093247477
epoch: 2 idx: 0 First Loss : 2.3720948696136475, Second Loss : 2.49745774269104
epoch: 2 idx: 200 First Loss : 0.9592001462605462, Second Loss : 0.9614494816951491
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5902777777777778, precision 0.5258890272588902, recall 0.5457912457912458, F1 0.4688202615031883, AUC 0.7365263748597082
  Second-Tier acc 0.6041666666666666, precision 0.4821937321937322, recall 0.5198989898989899, F1 0.47709601081812036, AUC 0.7454040404040404
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5782312925170068, precision 0.5701991907874261, recall 0.5094797178130511, F1 0.501933239681584, AUC 0.7231101802861062
  Second-Tier acc 0.6326530612244898, precision 0.6337719298245613, recall 0.6146384479717814, F1 0.6147186147186147, AUC 0.7293320105820106
Test AUC: 0.6963, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010868337093247477
epoch: 3 idx: 0 First Loss : 3.004450798034668, Second Loss : 3.065087080001831
epoch: 3 idx: 200 First Loss : 0.9305717090784169, Second Loss : 0.9358531871986626
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4513888888888889, precision 0.5022695506566475, recall 0.47700336700336693, F1 0.4046296296296296, AUC 0.738226711560045
  Second-Tier acc 0.4166666666666667, precision 0.5303030303030303, recall 0.44828282828282834, F1 0.3863636363636364, AUC 0.7554040404040405
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4965986394557823, precision 0.5601107074900536, recall 0.48515579071134624, F1 0.45866816672023997, AUC 0.7343780619243582
  Second-Tier acc 0.5306122448979592, precision 0.580599647266314, recall 0.5529100529100529, F1 0.5308555942702284, AUC 0.7531966490299823
Test AUC: 0.6963, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00010868337093247477
epoch: 4 idx: 0 First Loss : 3.6746551990509033, Second Loss : 3.692535638809204
epoch: 4 idx: 200 First Loss : 0.9235233820057405, Second Loss : 0.9295300475798955
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4236111111111111, precision 0.5412242581724236, recall 0.48498316498316507, F1 0.4000723079911483, AUC 0.7480751964085298
  Second-Tier acc 0.4166666666666667, precision 0.5313725490196078, recall 0.46525252525252525, F1 0.38386243386243385, AUC 0.762070707070707
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46938775510204084, precision 0.5191508182220257, recall 0.468694885361552, F1 0.4305587103190438, AUC 0.7358355379188714
  Second-Tier acc 0.5510204081632653, precision 0.6194125159642401, recall 0.5881834215167548, F1 0.5358917128662971, AUC 0.7496141975308642
Test AUC: 0.7496, Test F1: 0.5359 (Best Epoch: 4)
Current LR: 0.00010868337093247477
epoch: 5 idx: 0 First Loss : 3.9545555114746094, Second Loss : 4.024406909942627
epoch: 5 idx: 200 First Loss : 0.9205476791639604, Second Loss : 0.9286145189271972
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4027777777777778, precision 0.5008684786004373, recall 0.4603367003367003, F1 0.38067197170645445, AUC 0.7550561167227835
  Second-Tier acc 0.3958333333333333, precision 0.4764038231780167, recall 0.434949494949495, F1 0.3663865546218487, AUC 0.7625757575757576
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.46938775510204084, precision 0.5494736842105263, recall 0.48611111111111116, F1 0.4322210636079249, AUC 0.7339065255731922
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7668650793650794
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 6 idx: 0 First Loss : 3.984454393386841, Second Loss : 4.105254650115967
epoch: 6 idx: 200 First Loss : 0.9157188341904209, Second Loss : 0.9297183164434776
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3958333333333333, precision 0.47954391979637423, recall 0.4607070707070707, F1 0.3759855113019604, AUC 0.7379068462401795
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7494949494949493
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.42857142857142855, precision 0.5302832244008715, recall 0.4597295708406819, F1 0.40100608204056476, AUC 0.7186152753282382
  Second-Tier acc 0.46938775510204084, precision 0.564373897707231, recall 0.5273368606701939, F1 0.4524548622109597, AUC 0.7406305114638448
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 7 idx: 0 First Loss : 3.9124042987823486, Second Loss : 4.060546875
epoch: 7 idx: 200 First Loss : 0.9109019875324873, Second Loss : 0.9267915595920562
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3680555555555556, precision 0.43813700918964077, recall 0.43498316498316497, F1 0.33159722222222227, AUC 0.710297418630752
  Second-Tier acc 0.3541666666666667, precision 0.4269179894179895, recall 0.41080808080808073, F1 0.3117847914359542, AUC 0.7134343434343434
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4013605442176871, precision 0.5024379432624113, recall 0.41776895943562603, F1 0.3585434173669468, AUC 0.6890983245149912
  Second-Tier acc 0.4489795918367347, precision 0.5063131313131314, recall 0.44995590828924165, F1 0.37844478216818644, AUC 0.7183641975308642
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 8 idx: 0 First Loss : 3.8459384441375732, Second Loss : 4.049960613250732
epoch: 8 idx: 200 First Loss : 0.9091083685808412, Second Loss : 0.9246543217655989
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.43155136268343813, recall 0.42777777777777776, F1 0.3015145487296798, AUC 0.6918799102132436
  Second-Tier acc 0.3958333333333333, precision 0.46309523809523806, recall 0.45444444444444443, F1 0.34005011754372366, AUC 0.6846969696969697
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.48090858416945376, recall 0.4037330981775426, F1 0.3293317673358709, AUC 0.6628576327650402
  Second-Tier acc 0.4489795918367347, precision 0.5084033613445378, recall 0.44995590828924165, F1 0.3773809523809524, AUC 0.6791225749559082
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 9 idx: 0 First Loss : 3.8267667293548584, Second Loss : 4.022202014923096
epoch: 9 idx: 200 First Loss : 0.905564247417398, Second Loss : 0.9240083253093351
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3611111111111111, precision 0.4253527579256002, recall 0.4274074074074074, F1 0.3015983354612947, AUC 0.6851459034792368
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.6941414141414141
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.4217687074829932, precision 0.47425997425997424, recall 0.4139476778365668, F1 0.3298733221784711, AUC 0.6578850676072898
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.6524470899470899
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 10 idx: 0 First Loss : 3.730388641357422, Second Loss : 3.8290934562683105
epoch: 10 idx: 200 First Loss : 0.9043427610011721, Second Loss : 0.9142995245820745
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3819444444444444, precision 0.4621434322521279, recall 0.4407407407407407, F1 0.3174081893293716, AUC 0.6815488215488216
  Second-Tier acc 0.375, precision 0.39076576576576577, recall 0.4266666666666667, F1 0.29419191919191917, AUC 0.6930808080808081
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.42857142857142855, precision 0.4771825396825396, recall 0.4180629041740153, F1 0.33478558478558473, AUC 0.6552395649617871
  Second-Tier acc 0.40816326530612246, precision 0.456140350877193, recall 0.40740740740740744, F1 0.3006993006993007, AUC 0.6579034391534392
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 11 idx: 0 First Loss : 3.6647865772247314, Second Loss : 3.7254116535186768
epoch: 11 idx: 200 First Loss : 0.90197372156895, Second Loss : 0.908905263097936
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3819444444444444, precision 0.4621434322521279, recall 0.4407407407407407, F1 0.3174081893293716, AUC 0.6772727272727274
  Second-Tier acc 0.375, precision 0.3881578947368421, recall 0.4266666666666667, F1 0.29107400535971967, AUC 0.6917171717171717
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.43537414965986393, precision 0.4899425287356322, recall 0.4259994121105232, F1 0.33704560207724765, AUC 0.6511917009602195
  Second-Tier acc 0.42857142857142855, precision 0.456140350877193, recall 0.4197530864197531, F1 0.3167420814479638, AUC 0.65625
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 12 idx: 0 First Loss : 3.55021595954895, Second Loss : 3.526758909225464
epoch: 12 idx: 200 First Loss : 0.8933849038132837, Second Loss : 0.8969249793829915
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.4309523809523809, recall 0.4274074074074074, F1 0.2998110661268556, AUC 0.6763804713804712
  Second-Tier acc 0.3333333333333333, precision 0.3717948717948718, recall 0.39999999999999997, F1 0.2541935483870968, AUC 0.689949494949495
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.47593342330184435, recall 0.41365373309817755, F1 0.32097139027832094, AUC 0.6578666960611405
  Second-Tier acc 0.42857142857142855, precision 0.452991452991453, recall 0.4197530864197531, F1 0.3133555308916019, AUC 0.6532186948853617
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 13 idx: 0 First Loss : 3.5639045238494873, Second Loss : 3.4859206676483154
epoch: 13 idx: 200 First Loss : 0.89234787220612, Second Loss : 0.8902925977889398
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3541666666666667, precision 0.43019809138230186, recall 0.422962962962963, F1 0.2924101995897405, AUC 0.6745286195286195
  Second-Tier acc 0.3333333333333333, precision 0.36944444444444446, recall 0.39999999999999997, F1 0.2513177313936327, AUC 0.6858080808080809
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.41496598639455784, precision 0.47593342330184435, recall 0.41365373309817755, F1 0.32097139027832094, AUC 0.6612409367038996
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.6593915343915344
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5)
Current LR: 0.00010868337093247477
epoch: 14 idx: 0 First Loss : 3.5402228832244873, Second Loss : 3.4376609325408936
epoch: 14 idx: 200 First Loss : 0.8891236498435428, Second Loss : 0.884903338175329
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.4307203389830508, recall 0.4096296296296296, F1 0.2699189667228827, AUC 0.6725476992143659
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6817171717171716
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.40816326530612246, precision 0.4815126050420169, recall 0.41335978835978837, F1 0.3105922210781546, AUC 0.6643151087595532
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6639660493827161
Test AUC: 0.7669, Test F1: 0.4931 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.25924051445077706, "droprate_2": 0.0, "lr": 4.678451916323437e-05, "weight_decay": 1.5729471579087017e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.160719394683838, Second Loss : 1.03431236743927{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.12102512729486507, "droprate_2": 0.0, "lr": 0.0005058877037313063, "weight_decay": 6.91185875668779e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.10118943679818446, "droprate_2": 0.0, "lr": 0.00021889314571804208, "weight_decay": 0.00019946261410867051, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.2592018007977242, "droprate_2": 0.0, "lr": 2.1688064922751707e-05, "weight_decay": 7.880942490632663e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.017933640528411586, "droprate_2": 0.0, "lr": 0.00011996994831121774, "weight_decay": 0.0009651408285846969, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.2851078405857968, "droprate_2": 0.0, "lr": 1.4846137574605899e-05, "weight_decay": 9.026320924143211e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1196260452270508, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0701344652258935, Second Loss : 1.0658127905717536
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7101546717171718
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6988383838383839
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6206183862433862
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6226851851851852
epoch: 1 idx: 0 First Loss : 1.9687753915786743, Second Loss : 1.9489141702651978
epoch: 1 idx: 200 First Loss : 1.0995477439455725, Second Loss : 1.098921927646618
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7291224747474748
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7263636363636364
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6652233520723104
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6617063492063492
epoch: 2 idx: 0 First Loss : 2.0630462169647217, Second Loss : 2.0316002368927
epoch: 2 idx: 200 First Loss : 1.0797467892294499, Second Loss : 1.084821215464701
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7422253787878788
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7474747474747474
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6897252535273369
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6895392416225748
epoch: 3 idx: 0 First Loss : 2.143620252609253, Second Loss : 2.113523483276367
epoch: 3 idx: 200 First Loss : 1.0621871554584645, Second Loss : 1.0713264428412737
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7425157828282828
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7497474747474747
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7023430610670194
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7043099647266313
epoch: 4 idx: 0 First Loss : 2.234438419342041, Second Loss : 2.2153356075286865
epoch: 4 idx: 200 First Loss : 1.044359179649187, Second Loss : 1.0560704087143513
  First-Tier acc 0.5625, precision 0.43890560091677405, recall 0.4024242424242424, F1 0.3511287178519776, AUC 0.7395833333333334
  Second-Tier acc 0.5416666666666666, precision 0.5144927536231884, recall 0.3636363636363636, F1 0.2902973395931142, AUC 0.7468181818181817
  First-Tier acc 0.5612244897959183, precision 0.5724417426545086, recall 0.34970238095238093, F1 0.274027274027274, AUC 0.6983679177689593
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.697420634920635
epoch: 5 idx: 0 First Loss : 2.3454220294952393, Second Loss : 2.3363583087921143
epoch: 5 idx: 200 First Loss : 1.0248749184964308, Second Loss : 1.0377855153745086
  First-Tier acc 0.6510416666666666, precision 0.5910602503912363, recall 0.5433080808080807, F1 0.48518624985028147, AUC 0.7402556818181818
  Second-Tier acc 0.5833333333333334, precision 0.5146520146520147, recall 0.4336363636363636, F1 0.4065452091767881, AUC 0.7493939393939394
  First-Tier acc 0.6020408163265306, precision 0.5921658986175116, recall 0.46009700176366847, F1 0.4704672044118778, AUC 0.6875551146384481
  Second-Tier acc 0.6530612244897959, precision 0.7698412698412698, recall 0.5238095238095238, F1 0.49579020013802627, AUC 0.6923500881834216
epoch: 6 idx: 0 First Loss : 2.4835476875305176, Second Loss : 2.481954336166382
epoch: 6 idx: 200 First Loss : 1.0043435312103277, Second Loss : 1.0177559952682524
  First-Tier acc 0.6510416666666666, precision 0.6130368814192343, recall 0.5904292929292929, F1 0.5471174004192872, AUC 0.7389393939393939
  Second-Tier acc 0.6458333333333334, precision 0.5822386425834701, recall 0.5534343434343435, F1 0.5586419753086419, AUC 0.7491414141414142
  First-Tier acc 0.6071428571428571, precision 0.5942684766214178, recall 0.5660824514991182, F1 0.5747978436657681, AUC 0.6880408123897707
  Second-Tier acc 0.5102040816326531, precision 0.4481074481074481, recall 0.4896384479717813, F1 0.4523081512417033, AUC 0.699294532627866
epoch: 7 idx: 0 First Loss : 2.622406482696533, Second Loss : 2.6255319118499756
epoch: 7 idx: 200 First Loss : 0.9862537445380023, Second Loss : 0.9987184037987272
  First-Tier acc 0.6041666666666666, precision 0.5793650793650794, recall 0.5912121212121212, F1 0.5481582125603864, AUC 0.7429955808080809
  Second-Tier acc 0.625, precision 0.6035543403964456, recall 0.5834343434343433, F1 0.5755103078370065, AUC 0.7621717171717172
  First-Tier acc 0.5867346938775511, precision 0.5733492420912242, recall 0.5900573192239859, F1 0.5725104447617536, AUC 0.6943996638007054
  Second-Tier acc 0.5510204081632653, precision 0.5146464646464647, recall 0.5665784832451499, F1 0.519805246513321, AUC 0.7060736331569665
epoch: 8 idx: 0 First Loss : 2.748791217803955, Second Loss : 2.773651361465454
epoch: 8 idx: 200 First Loss : 0.9701471178241037, Second Loss : 0.9813983438916467
  First-Tier acc 0.5677083333333334, precision 0.566753533917713, recall 0.5823232323232322, F1 0.5371296608365718, AUC 0.7528188131313133
  Second-Tier acc 0.5625, precision 0.5671497584541062, recall 0.5723232323232323, F1 0.5341269841269841, AUC 0.7652020202020201
  First-Tier acc 0.5663265306122449, precision 0.5651418623323803, recall 0.6188271604938271, F1 0.5649956756664184, AUC 0.7034040178571429
  Second-Tier acc 0.5510204081632653, precision 0.5286179249027546, recall 0.5958994708994709, F1 0.5275147611379496, AUC 0.7196318342151674
epoch: 9 idx: 0 First Loss : 2.8666863441467285, Second Loss : 2.901729106903076
epoch: 9 idx: 200 First Loss : 0.9577744375284186, Second Loss : 0.9675665742425776
  First-Tier acc 0.5416666666666666, precision 0.5822786131996659, recall 0.5951767676767677, F1 0.5346920450217008, AUC 0.7595517676767676
  Second-Tier acc 0.5208333333333334, precision 0.5670054583098061, recall 0.5626262626262627, F1 0.508994708994709, AUC 0.7748484848484849
  First-Tier acc 0.5459183673469388, precision 0.5543619216033009, recall 0.6138117283950617, F1 0.5458224749269526, AUC 0.7132282021604938
  Second-Tier acc 0.5102040816326531, precision 0.5181286549707602, recall 0.6005291005291006, F1 0.5029495834093535, AUC 0.7253086419753086{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.25008528681736747, "droprate_2": 0.0, "lr": 0.00019142685828853242, "weight_decay": 0.0001143312517782765, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "ReduceLROnPlateau", "step_size": 8, "gamma": 0.6708402629018868, "T_max": 6, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.111943244934082, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0889301808245146, Second Loss : 1.0800905344053287
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7536773989898989
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7478282828282828
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7199866347001764
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7308752204585538
epoch: 1 idx: 0 First Loss : 1.6061099767684937, Second Loss : 1.7791005373001099
epoch: 1 idx: 200 First Loss : 0.9853829366354206, Second Loss : 0.9804244819861739
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7335037878787878
  Second-Tier acc 0.5416666666666666, precision 0.27272727272727276, recall 0.3611111111111111, F1 0.2832125603864734, AUC 0.7387373737373738
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7112165178571429
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7228284832451499
epoch: 2 idx: 0 First Loss : 2.573636293411255, Second Loss : 2.290391683578491
epoch: 2 idx: 200 First Loss : 0.9414923849205176, Second Loss : 0.9425098413406913
  First-Tier acc 0.578125, precision 0.38797221016065997, recall 0.5354545454545455, F1 0.43052127196166695, AUC 0.7241193181818182
  Second-Tier acc 0.625, precision 0.398989898989899, recall 0.5187878787878788, F1 0.45103448275862074, AUC 0.7262121212121212
  First-Tier acc 0.5204081632653061, precision 0.36064536539069914, recall 0.42658730158730157, F1 0.372960372960373, AUC 0.6946201223544973
  Second-Tier acc 0.5918367346938775, precision 0.706959706959707, recall 0.5198412698412699, F1 0.5311769991015273, AUC 0.7091049382716049
epoch: 3 idx: 0 First Loss : 3.4487016201019287, Second Loss : 3.6363301277160645
epoch: 3 idx: 200 First Loss : 0.9314561757856785, Second Loss : 0.9232035584247379
  First-Tier acc 0.4479166666666667, precision 0.4953327618347825, recall 0.4871464646464647, F1 0.391017501017501, AUC 0.7431597222222223
  Second-Tier acc 0.4583333333333333, precision 0.45634920634920634, recall 0.47747474747474744, F1 0.3923024807171149, AUC 0.7517676767676768
  First-Tier acc 0.4642857142857143, precision 0.44671481567155874, recall 0.4244929453262787, F1 0.37250551827235207, AUC 0.7255015432098766
  Second-Tier acc 0.5306122448979592, precision 0.5523627075351213, recall 0.47641093474426804, F1 0.4446167097329888, AUC 0.7148919753086419
epoch: 4 idx: 0 First Loss : 3.700900077819824, Second Loss : 3.800262928009033
epoch: 4 idx: 200 First Loss : 0.926464194021841, Second Loss : 0.9150145044596634
  First-Tier acc 0.3802083333333333, precision 0.4046670224752416, recall 0.42936868686868684, F1 0.30538650455391464, AUC 0.7431313131313132
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7654040404040403
  First-Tier acc 0.4489795918367347, precision 0.4451409024579756, recall 0.42223324514991184, F1 0.3482038011902097, AUC 0.7049093364197532
  Second-Tier acc 0.46938775510204084, precision 0.4039938556067588, recall 0.41005291005291006, F1 0.3580849141824751, AUC 0.7077821869488536
epoch: 5 idx: 0 First Loss : 3.8139710426330566, Second Loss : 3.96990966796875
epoch: 5 idx: 200 First Loss : 0.9228421762036577, Second Loss : 0.9087986751003144
  First-Tier acc 0.3697916666666667, precision 0.41444444444444445, recall 0.4269444444444444, F1 0.2956471935853379, AUC 0.6988383838383839
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7139393939393939
  First-Tier acc 0.44387755102040816, precision 0.45123367780181045, recall 0.4220127865961199, F1 0.34328569843285694, AUC 0.6625502921075838
  Second-Tier acc 0.46938775510204084, precision 0.4305555555555555, recall 0.42151675485008816, F1 0.36194723151244884, AUC 0.6621472663139331
epoch: 6 idx: 0 First Loss : 3.6336052417755127, Second Loss : 3.8575034141540527
epoch: 6 idx: 200 First Loss : 0.9171570863097498, Second Loss : 0.9036691980175813
  First-Tier acc 0.3802083333333333, precision 0.4529569892473118, recall 0.4336111111111111, F1 0.30139644285846995, AUC 0.6663825757575758
  Second-Tier acc 0.3958333333333333, precision 0.39814814814814814, recall 0.44, F1 0.31289111389236546, AUC 0.6733838383838383
  First-Tier acc 0.4489795918367347, precision 0.477902272019919, recall 0.43083112874779544, F1 0.34356043566569877, AUC 0.6608210703262788
  Second-Tier acc 0.46938775510204084, precision 0.4304812834224599, recall 0.4329805996472664, F1 0.3559941520467836, AUC 0.6943342151675486
epoch: 7 idx: 0 First Loss : 3.4191160202026367, Second Loss : 3.823668956756592
epoch: 7 idx: 200 First Loss : 0.9153196985166709, Second Loss : 0.9044128042293611
  First-Tier acc 0.3854166666666667, precision 0.42774410774410776, recall 0.4369444444444444, F1 0.3082620640949453, AUC 0.6613573232323232
  Second-Tier acc 0.375, precision 0.39351851851851855, recall 0.4266666666666667, F1 0.2974425102084677, AUC 0.6813636363636365
  First-Tier acc 0.45408163265306123, precision 0.5033407703840115, recall 0.44411375661375657, F1 0.35985037288103405, AUC 0.6794739307760141
  Second-Tier acc 0.46938775510204084, precision 0.5238095238095238, recall 0.46230158730158727, F1 0.3948194662480377, AUC 0.7124118165784833
epoch: 8 idx: 0 First Loss : 3.391054391860962, Second Loss : 3.880441904067993
epoch: 8 idx: 200 First Loss : 0.9175416487245937, Second Loss : 0.9020178975002836
  First-Tier acc 0.390625, precision 0.43886693750347816, recall 0.44027777777777777, F1 0.31180229389184616, AUC 0.6621275252525252
  Second-Tier acc 0.3541666666666667, precision 0.3822055137844611, recall 0.41333333333333333, F1 0.27465986394557823, AUC 0.6858585858585858
  First-Tier acc 0.4642857142857143, precision 0.4774561403508772, recall 0.44295634920634924, F1 0.35580750986390036, AUC 0.6727671682098766
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.7113646384479718
epoch: 9 idx: 0 First Loss : 3.2269389629364014, Second Loss : 3.7792036533355713
epoch: 9 idx: 200 First Loss : 0.9087861440131737, Second Loss : 0.8938171276391197
  First-Tier acc 0.375, precision 0.451006341328922, recall 0.43027777777777776, F1 0.2966498631715397, AUC 0.6590151515151513
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.6763131313131313
  First-Tier acc 0.44387755102040816, precision 0.5011697860962567, recall 0.4379409171075838, F1 0.3508756033847833, AUC 0.6655333719135802
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.70679012345679{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.025546878979226296, "droprate_2": 0.0, "lr": 3.6654057238520305e-05, "weight_decay": 0.0005007622937085063, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.089849591255188, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1218336773897284, Second Loss : 1.1137961990649428
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7309753787878788
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7276262626262625
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6649994488536155
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6646825396825397
epoch: 1 idx: 0 First Loss : 2.011669635772705, Second Loss : 2.066626787185669
epoch: 1 idx: 200 First Loss : 1.0656804996936475, Second Loss : 1.064964923173634
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7395359848484847
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7418181818181818
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7018642526455027
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6996803350970017
epoch: 2 idx: 0 First Loss : 2.211573839187622, Second Loss : 2.215102195739746
epoch: 2 idx: 200 First Loss : 1.0212911372235165, Second Loss : 1.0244638854591408
  First-Tier acc 0.5833333333333334, precision 0.3753086419753086, recall 0.4412121212121212, F1 0.3884189533044495, AUC 0.7380050505050505
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7417676767676767
  First-Tier acc 0.6071428571428571, precision 0.6367231638418079, recall 0.4166666666666667, F1 0.3913703176861072, AUC 0.7012373236331569
  Second-Tier acc 0.6122448979591837, precision 0.7000000000000001, recall 0.44047619047619047, F1 0.425, AUC 0.708884479717813
epoch: 3 idx: 0 First Loss : 2.5036377906799316, Second Loss : 2.4763338565826416
epoch: 3 idx: 200 First Loss : 0.9842923003716848, Second Loss : 0.9850630680868282
  First-Tier acc 0.6302083333333334, precision 0.5853635775703044, recall 0.5824242424242424, F1 0.5612439418898535, AUC 0.7369223484848485
  Second-Tier acc 0.6666666666666666, precision 0.5952380952380952, recall 0.5913131313131313, F1 0.5575937572792918, AUC 0.7378787878787879
  First-Tier acc 0.6122448979591837, precision 0.5785664163724467, recall 0.613150352733686, F1 0.58997150997151, AUC 0.6955605158730158
  Second-Tier acc 0.5714285714285714, precision 0.5444444444444444, recall 0.5725308641975309, F1 0.5552550522124559, AUC 0.6981922398589065
epoch: 4 idx: 0 First Loss : 2.8278164863586426, Second Loss : 2.8299152851104736
epoch: 4 idx: 200 First Loss : 0.9614093617828035, Second Loss : 0.9571238538222526
  First-Tier acc 0.5729166666666666, precision 0.5691919191919192, recall 0.5823232323232324, F1 0.5577031472719488, AUC 0.7472032828282829
  Second-Tier acc 0.5625, precision 0.573202614379085, recall 0.5773737373737373, F1 0.5499999999999999, AUC 0.7581818181818182
  First-Tier acc 0.5306122448979592, precision 0.5262585337536042, recall 0.5787588183421517, F1 0.5172558922558923, AUC 0.7113853064373896
  Second-Tier acc 0.5714285714285714, precision 0.5501949317738791, recall 0.583994708994709, F1 0.5507246376811594, AUC 0.7183641975308642
epoch: 5 idx: 0 First Loss : 3.0987699031829834, Second Loss : 3.171623468399048
epoch: 5 idx: 200 First Loss : 0.9477375727702877, Second Loss : 0.9402338653543398
  First-Tier acc 0.5052083333333334, precision 0.5485604916382103, recall 0.5413383838383838, F1 0.5004687490844745, AUC 0.7578503787878788
  Second-Tier acc 0.5416666666666666, precision 0.5961675579322638, recall 0.5954545454545455, F1 0.5426193713179254, AUC 0.777828282828283
  First-Tier acc 0.4897959183673469, precision 0.5125393125393126, recall 0.5731922398589065, F1 0.48562211276032996, AUC 0.7246644896384479
  Second-Tier acc 0.4897959183673469, precision 0.503968253968254, recall 0.5524691358024691, F1 0.49367625838214074, AUC 0.7269620811287477
epoch: 6 idx: 0 First Loss : 3.3085532188415527, Second Loss : 3.4087975025177
epoch: 6 idx: 200 First Loss : 0.9424721721133485, Second Loss : 0.9317314832364741
  First-Tier acc 0.4583333333333333, precision 0.5300906401652671, recall 0.5113383838383839, F1 0.4578286960210532, AUC 0.7632765151515152
  Second-Tier acc 0.5416666666666666, precision 0.6034547152194211, recall 0.6124242424242424, F1 0.544991789819376, AUC 0.8097979797979797
  First-Tier acc 0.4897959183673469, precision 0.5316993464052288, recall 0.58179012345679, F1 0.48814447201543976, AUC 0.7327732308201057
  Second-Tier acc 0.5102040816326531, precision 0.5252747252747253, recall 0.576278659611993, F1 0.5174603174603175, AUC 0.7331349206349206
epoch: 7 idx: 0 First Loss : 3.436004161834717, Second Loss : 3.5537164211273193
epoch: 7 idx: 200 First Loss : 0.9390722178293401, Second Loss : 0.9254231019112379
  First-Tier acc 0.4479166666666667, precision 0.524290211037199, recall 0.5065656565656566, F1 0.4488338772204732, AUC 0.7640656565656565
  Second-Tier acc 0.5416666666666666, precision 0.6055555555555555, recall 0.6174747474747475, F1 0.5413919413919414, AUC 0.8233838383838382
  First-Tier acc 0.4846938775510204, precision 0.5366766050486981, recall 0.5828373015873015, F1 0.4854266337608939, AUC 0.7360801091269842
  Second-Tier acc 0.5102040816326531, precision 0.5317460317460317, recall 0.576278659611993, F1 0.5130609228170203, AUC 0.7412918871252204
epoch: 8 idx: 0 First Loss : 3.5100553035736084, Second Loss : 3.641958236694336
epoch: 8 idx: 200 First Loss : 0.9369610388165535, Second Loss : 0.9197220090609878
  First-Tier acc 0.4583333333333333, precision 0.5394945011305189, recall 0.5272222222222221, F1 0.45837670121455526, AUC 0.7554387626262625
  Second-Tier acc 0.5416666666666666, precision 0.6128205128205129, recall 0.6174747474747475, F1 0.5432804232804233, AUC 0.8203535353535353
  First-Tier acc 0.4642857142857143, precision 0.5399373732707066, recall 0.5586970899470899, F1 0.46382323105202544, AUC 0.73824680335097
  Second-Tier acc 0.4897959183673469, precision 0.5196969696969697, recall 0.5753968253968255, F1 0.4944258639910814, AUC 0.7412918871252204
epoch: 9 idx: 0 First Loss : 3.5430831909179688, Second Loss : 3.694063186645508
epoch: 9 idx: 200 First Loss : 0.934115348402318, Second Loss : 0.9143034207880201
  First-Tier acc 0.453125, precision 0.5363783826554834, recall 0.5245202020202021, F1 0.4518962289860123, AUC 0.7465372474747475
  Second-Tier acc 0.5, precision 0.5670940170940172, recall 0.5619191919191919, F1 0.4904976404976405, AUC 0.8135353535353534
  First-Tier acc 0.45918367346938777, precision 0.5433583959899749, recall 0.5511463844797179, F1 0.45808879851433043, AUC 0.7375372023809524
  Second-Tier acc 0.5510204081632653, precision 0.6028571428571429, recall 0.6468253968253969, F1 0.5491085491085491, AUC 0.7490630511463845{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_7", "train_show_freq": 200, "droprate": 0.25708440578556657, "droprate_2": 0.0, "lr": 4.0704568108217786e-05, "weight_decay": 1.2962466304608983e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 14, "gamma": 0.27749784060557814, "T_max": 18, "patience": 6, "disable_writer": true, "num": 0, "p_name": "optuna_trial_7", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1133325099945068, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.117828807724056, Second Loss : 1.1130284500211032
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7380334595959596
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7273232323232324
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6706590332892416
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.66413139329806
epoch: 1 idx: 0 First Loss : 1.9896222352981567, Second Loss : 2.060718297958374
epoch: 1 idx: 200 First Loss : 1.0553540971445208, Second Loss : 1.0584420630736138
  First-Tier acc 0.53125, precision 0.5087719298245613, recall 0.34848484848484845, F1 0.2588705647176412, AUC 0.7418276515151515
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7494949494949493
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.700913525132275
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6962632275132274
epoch: 2 idx: 0 First Loss : 2.1748597621917725, Second Loss : 2.2309017181396484
epoch: 2 idx: 200 First Loss : 1.0090255583103616, Second Loss : 1.0198027355531556
  First-Tier acc 0.671875, precision 0.676920768307323, recall 0.5795707070707071, F1 0.5455401472350625, AUC 0.736802398989899
  Second-Tier acc 0.625, precision 0.5680680680680681, recall 0.4992929292929293, F1 0.4723502304147465, AUC 0.7487373737373737
  First-Tier acc 0.6071428571428571, precision 0.6280941280941281, recall 0.5202270723104057, F1 0.5462778920946252, AUC 0.6803040950176368
  Second-Tier acc 0.6530612244897959, precision 0.6858974358974358, recall 0.54673721340388, F1 0.5541125541125541, AUC 0.6773037918871253
epoch: 3 idx: 0 First Loss : 2.439225673675537, Second Loss : 2.540715456008911
epoch: 3 idx: 200 First Loss : 0.9709279672126865, Second Loss : 0.9818369268777951
  First-Tier acc 0.6197916666666666, precision 0.5868120221061397, recall 0.605909090909091, F1 0.5814483213864019, AUC 0.7448516414141415
  Second-Tier acc 0.625, precision 0.6064578005115089, recall 0.5859595959595959, F1 0.5863581367211131, AUC 0.7543939393939394
  First-Tier acc 0.576530612244898, precision 0.5525546058879393, recall 0.5988756613756614, F1 0.5613008983297232, AUC 0.6925671020723104
  Second-Tier acc 0.46938775510204084, precision 0.4027173913043478, recall 0.4534832451499118, F1 0.4077777777777778, AUC 0.6963183421516755
epoch: 4 idx: 0 First Loss : 2.762922525405884, Second Loss : 2.9031243324279785
epoch: 4 idx: 200 First Loss : 0.9455860546461089, Second Loss : 0.9533635536718428
  First-Tier acc 0.5416666666666666, precision 0.5684748427672957, recall 0.5737878787878788, F1 0.5358768620365942, AUC 0.7551294191919192
  Second-Tier acc 0.5208333333333334, precision 0.5465811965811965, recall 0.5431313131313131, F1 0.4864187495766443, AUC 0.7647979797979797
  First-Tier acc 0.4744897959183674, precision 0.48749878911169237, recall 0.5260141093474426, F1 0.46174511804508606, AUC 0.7113060791446207
  Second-Tier acc 0.4897959183673469, precision 0.4721444133208839, recall 0.5180776014109347, F1 0.4626455026455026, AUC 0.7249228395061728
epoch: 5 idx: 0 First Loss : 3.001685857772827, Second Loss : 3.1778006553649902
epoch: 5 idx: 200 First Loss : 0.9305734998958918, Second Loss : 0.9363576231422412
  First-Tier acc 0.4791666666666667, precision 0.547949505351604, recall 0.5355050505050505, F1 0.4789069497672643, AUC 0.762878787878788
  Second-Tier acc 0.5, precision 0.548015873015873, recall 0.5467676767676767, F1 0.48179894179894184, AUC 0.7881313131313131
  First-Tier acc 0.45918367346938777, precision 0.5024430664374022, recall 0.5416115520282186, F1 0.45344788397794983, AUC 0.7231419477513228
  Second-Tier acc 0.42857142857142855, precision 0.4388888888888889, recall 0.4810405643738977, F1 0.41733821733821735, AUC 0.730379188712522
epoch: 6 idx: 0 First Loss : 3.145904779434204, Second Loss : 3.3767361640930176
epoch: 6 idx: 200 First Loss : 0.9231320773598863, Second Loss : 0.9245765494432912
  First-Tier acc 0.4583333333333333, precision 0.5395850096310926, recall 0.5336363636363637, F1 0.45869285274273935, AUC 0.7663731060606059
  Second-Tier acc 0.4791666666666667, precision 0.5348484848484848, recall 0.518989898989899, F1 0.4662724348998859, AUC 0.8083333333333335
  First-Tier acc 0.44387755102040816, precision 0.5044194177915109, recall 0.535218253968254, F1 0.44117180230967107, AUC 0.7252121913580246
  Second-Tier acc 0.42857142857142855, precision 0.4472455648926237, recall 0.4925044091710758, F1 0.4239746615828441, AUC 0.7270171957671958
epoch: 7 idx: 0 First Loss : 3.184657335281372, Second Loss : 3.464836359024048
epoch: 7 idx: 200 First Loss : 0.9171657810747549, Second Loss : 0.9155074918772377
  First-Tier acc 0.4427083333333333, precision 0.5341251679924449, recall 0.5200252525252526, F1 0.441562493553644, AUC 0.7637720959595958
  Second-Tier acc 0.4583333333333333, precision 0.5347222222222222, recall 0.5226262626262627, F1 0.4500561167227834, AUC 0.808030303030303
  First-Tier acc 0.42857142857142855, precision 0.5156199321833996, recall 0.5272266313932981, F1 0.42903392903392906, AUC 0.7268931878306878
  Second-Tier acc 0.46938775510204084, precision 0.5394736842105263, recall 0.5694444444444444, F1 0.47225657029578594, AUC 0.7319223985890653
epoch: 8 idx: 0 First Loss : 3.1748006343841553, Second Loss : 3.4971084594726562
epoch: 8 idx: 200 First Loss : 0.9104324934462001, Second Loss : 0.9076026762854216
  First-Tier acc 0.4270833333333333, precision 0.5221928277483833, recall 0.505959595959596, F1 0.4268960838470773, AUC 0.7571433080808081
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.8028787878787877
  First-Tier acc 0.42857142857142855, precision 0.5260912698412699, recall 0.5329585537918872, F1 0.42967738819665796, AUC 0.7270068617724869
  Second-Tier acc 0.4897959183673469, precision 0.5566137566137566, recall 0.5932539682539683, F1 0.494030294030294, AUC 0.7437720458553793
epoch: 9 idx: 0 First Loss : 3.146585702896118, Second Loss : 3.507615327835083
epoch: 9 idx: 200 First Loss : 0.9031374107128871, Second Loss : 0.899760684705066
  First-Tier acc 0.4166666666666667, precision 0.5144278606965175, recall 0.502449494949495, F1 0.4120000000000001, AUC 0.7499368686868687
  Second-Tier acc 0.4791666666666667, precision 0.5624287992709045, recall 0.5749494949494949, F1 0.47886119257086995, AUC 0.7991414141414142
  First-Tier acc 0.42346938775510207, precision 0.5246848670026322, recall 0.5222111992945325, F1 0.4220662268107523, AUC 0.7264281580687831
  Second-Tier acc 0.5306122448979592, precision 0.6155157715260017, recall 0.6408730158730159, F1 0.5335135135135135, AUC 0.7660383597883597