{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.25269118153241343, "droprate_2": 0.0, "lr": 1.7302729068877977e-05, "weight_decay": 1.6369119789588597e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.7302729068877977e-05
epoch: 0 idx: 0 First Loss : 1.0605502128601074, Second Loss : 1.1648786067962646
epoch: 0 idx: 200 First Loss : 1.0588827517198687, Second Loss : 1.062532933048941
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5245566778900113
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5048484848484849
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4292695473251029
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4557429453262786
 
 test auc: 0.4557429453262786, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.47252194088963106, "droprate_2": 0.0, "lr": 0.0002230576490704705, "weight_decay": 1.4602342485805419e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0002230576490704705
epoch: 0 idx: 0 First Loss : 0.9982719421386719, Second Loss : 1.0701088905334473
epoch: 0 idx: 200 First Loss : 1.081375382618228, Second Loss : 1.075052602337071
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5008964646464646
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49858585858585863
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4577477402998236
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4526014109347442
 
 test auc: 0.4526014109347442, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0002230576490704705
epoch: 1 idx: 0 First Loss : 1.6239689588546753, Second Loss : 1.9406344890594482
epoch: 1 idx: 200 First Loss : 0.9759022635013903, Second Loss : 0.979201226907583
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2552083333333333, precision 0.41798941798941797, recall 0.3409090909090909, F1 0.14983591186122833, AUC 0.4862910353535353
  Second-Tier acc 0.25, precision 0.0851063829787234, recall 0.3333333333333333, F1 0.13559322033898305, AUC 0.4871212121212121
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.47151951058201064
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4720017636684302
 
 test auc: 0.4526014109347442, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0002230576490704705
epoch: 2 idx: 0 First Loss : 2.1468417644500732, Second Loss : 2.457500696182251
epoch: 2 idx: 200 First Loss : 0.9373222484220913, Second Loss : 0.946592754355414
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.296875, precision 0.33207070707070707, recall 0.40755050505050505, F1 0.29360314737673227, AUC 0.47245580808080806
  Second-Tier acc 0.3125, precision 0.2484848484848485, recall 0.43686868686868685, F1 0.30883190883190886, AUC 0.4806565656565656
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.20545385202135777, recall 0.2502204585537919, F1 0.21033562166285277, AUC 0.4898279045414462
  Second-Tier acc 0.2857142857142857, precision 0.1984126984126984, recall 0.2416225749559083, F1 0.20634920634920637, AUC 0.49140211640211645
 
 test auc: 0.4526014109347442, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.0002230576490704705
epoch: 3 idx: 0 First Loss : 3.1884138584136963, Second Loss : 3.67777943611145
epoch: 3 idx: 200 First Loss : 0.9283971617841602, Second Loss : 0.9318912910269712
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2864583333333333, precision 0.33255473543243325, recall 0.38742424242424245, F1 0.23712893221089945, AUC 0.5094381313131313
  Second-Tier acc 0.2916666666666667, precision 0.3263888888888889, recall 0.38525252525252524, F1 0.2565713267397309, AUC 0.513939393939394
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3520408163265306, precision 0.3171558478463849, recall 0.2973985890652557, F1 0.3042317447603791, AUC 0.5358692956349206
  Second-Tier acc 0.3469387755102041, precision 0.35521885521885527, recall 0.36155202821869487, F1 0.35541716686674674, AUC 0.5065586419753086
 
 test auc: 0.5065586419753086, test F1: 0.35541716686674674  :  from epoch 3
 current learn rate 0.0002230576490704705
epoch: 4 idx: 0 First Loss : 3.1242239475250244, Second Loss : 3.705230236053467
epoch: 4 idx: 200 First Loss : 0.897620682553643, Second Loss : 0.9179759402689871
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2604166666666667, precision 0.4757712001998251, recall 0.37138888888888894, F1 0.19318804832794892, AUC 0.5388636363636364
  Second-Tier acc 0.25, precision 0.13253968253968254, recall 0.3611111111111111, F1 0.18719806763285027, AUC 0.5497474747474748
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.37755102040816324, precision 0.1910775707171826, recall 0.2427248677248677, F1 0.2112762112762113, AUC 0.5301029265873015
  Second-Tier acc 0.32653061224489793, precision 0.2972222222222222, recall 0.24977954144620806, F1 0.257097288676236, AUC 0.4925044091710758
 
 test auc: 0.4925044091710758, test F1: 0.257097288676236  :  from epoch 4
 current learn rate 0.0002230576490704705
epoch: 5 idx: 0 First Loss : 3.2119195461273193, Second Loss : 3.803812026977539
epoch: 5 idx: 200 First Loss : 0.8926378541176592, Second Loss : 0.9148904638137872
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.28125, precision 0.47495923596552525, recall 0.3811111111111111, F1 0.21779058359409695, AUC 0.608125
  Second-Tier acc 0.2708333333333333, precision 0.4668615984405458, recall 0.3744444444444444, F1 0.2070469213326356, AUC 0.627070707070707
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.3520408163265306, precision 0.1975067538977313, recall 0.2260251322751323, F1 0.20223729273995594, AUC 0.48194651124338633
  Second-Tier acc 0.30612244897959184, precision 0.18145161290322584, recall 0.20811287477954143, F1 0.19386973180076628, AUC 0.43964947089947093
 
 test auc: 0.43964947089947093, test F1: 0.19386973180076628  :  from epoch 5
 current learn rate 0.0002230576490704705
epoch: 6 idx: 0 First Loss : 3.1816744804382324, Second Loss : 3.6671864986419678
epoch: 6 idx: 200 First Loss : 0.8868984575105359, Second Loss : 0.9129301154145053
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2864583333333333, precision 0.43330280830280826, recall 0.3844444444444444, F1 0.22496426250812215, AUC 0.6299147727272727
  Second-Tier acc 0.2916666666666667, precision 0.4694694694694695, recall 0.3877777777777778, F1 0.23390652557319222, AUC 0.6292424242424243
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.34183673469387754, precision 0.1469298245614035, recall 0.20679012345679013, F1 0.17179487179487177, AUC 0.4430217978395062
  Second-Tier acc 0.2857142857142857, precision 0.13333333333333333, recall 0.1728395061728395, F1 0.15053763440860216, AUC 0.4481922398589065
 
 test auc: 0.4481922398589065, test F1: 0.15053763440860216  :  from epoch 6
 current learn rate 0.0002230576490704705
epoch: 7 idx: 0 First Loss : 3.200009822845459, Second Loss : 3.5942492485046387
epoch: 7 idx: 200 First Loss : 0.8844411797747387, Second Loss : 0.9042451684484815
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.328125, precision 0.4438337028151477, recall 0.41111111111111104, F1 0.2734923045803875, AUC 0.6381092171717172
  Second-Tier acc 0.2708333333333333, precision 0.4668615984405458, recall 0.3744444444444444, F1 0.2070469213326356, AUC 0.6368686868686869
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.35714285714285715, precision 0.1917770419426049, recall 0.23070987654320987, F1 0.20280995280995281, AUC 0.4329254850088183
  Second-Tier acc 0.30612244897959184, precision 0.24444444444444446, recall 0.21450617283950615, F1 0.21114369501466276, AUC 0.4532627865961199
 
 test auc: 0.4532627865961199, test F1: 0.21114369501466276  :  from epoch 7
 current learn rate 0.0002230576490704705
epoch: 8 idx: 0 First Loss : 3.2352330684661865, Second Loss : 3.7624471187591553
epoch: 8 idx: 200 First Loss : 0.8776531549070994, Second Loss : 0.9009449965458373
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.34375, precision 0.4583838383838384, recall 0.42111111111111105, F1 0.2892979872361316, AUC 0.6423863636363637
  Second-Tier acc 0.2708333333333333, precision 0.4668615984405458, recall 0.3744444444444444, F1 0.2070469213326356, AUC 0.6506060606060605
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3469387755102041, precision 0.1776341558950255, recall 0.22453703703703706, F1 0.19611742424242426, AUC 0.4253196649029983
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.42846119929453264
 
 test auc: 0.42846119929453264, test F1: 0.1791044776119403  :  from epoch 8
 current learn rate 0.0002230576490704705
epoch: 9 idx: 0 First Loss : 3.2482237815856934, Second Loss : 3.826484441757202
epoch: 9 idx: 200 First Loss : 0.8747654152809369, Second Loss : 0.8987862562971533
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3541666666666667, precision 0.4649563709966395, recall 0.42777777777777776, F1 0.2999231435557738, AUC 0.6433049242424241
  Second-Tier acc 0.3125, precision 0.4774436090225564, recall 0.40111111111111114, F1 0.25617615467239524, AUC 0.6579292929292929
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3622448979591837, precision 0.19379194630872484, recall 0.24112654320987656, F1 0.21210857884009635, AUC 0.4253644455467372
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.4080136684303351
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 10 idx: 0 First Loss : 3.194251537322998, Second Loss : 3.8510313034057617
epoch: 10 idx: 200 First Loss : 0.8700172215548404, Second Loss : 0.8962459290777773
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.390625, precision 0.4585765488991295, recall 0.4511111111111111, F1 0.3354722130029133, AUC 0.6352809343434344
  Second-Tier acc 0.2916666666666667, precision 0.48055555555555557, recall 0.3877777777777778, F1 0.23021060275962238, AUC 0.6487878787878788
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.32653061224489793, precision 0.19257191927866035, recall 0.23418209876543208, F1 0.21104926819212533, AUC 0.4347236000881834
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.4083994708994709
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 11 idx: 0 First Loss : 3.308155059814453, Second Loss : 4.03698205947876
epoch: 11 idx: 200 First Loss : 0.8651920657428862, Second Loss : 0.8914111584412809
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3854166666666667, precision 0.4680813439434129, recall 0.4477777777777778, F1 0.3304453564371485, AUC 0.6388257575757577
  Second-Tier acc 0.2708333333333333, precision 0.4873015873015873, recall 0.3744444444444444, F1 0.20322149178974927, AUC 0.6477777777777778
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.35714285714285715, precision 0.18936243936243935, recall 0.23804012345679013, F1 0.20896192528735633, AUC 0.4325086805555556
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4035493827160494
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 12 idx: 0 First Loss : 3.2021915912628174, Second Loss : 4.031198978424072
epoch: 12 idx: 200 First Loss : 0.8560666199617172, Second Loss : 0.8787805963595328
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4114583333333333, precision 0.47169372707130147, recall 0.46444444444444444, F1 0.3540595759501232, AUC 0.638655303030303
  Second-Tier acc 0.2916666666666667, precision 0.5297157622739018, recall 0.3877777777777778, F1 0.22962962962962963, AUC 0.6373737373737375
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.35714285714285715, precision 0.19339080459770117, recall 0.24537037037037038, F1 0.21557971014492752, AUC 0.4376446759259259
  Second-Tier acc 0.42857142857142855, precision 0.1627906976744186, recall 0.25925925925925924, F1 0.19999999999999998, AUC 0.40399029982363316
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 13 idx: 0 First Loss : 3.2858409881591797, Second Loss : 4.198011875152588
epoch: 13 idx: 200 First Loss : 0.8493705284512435, Second Loss : 0.8678768943628616
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.40625, precision 0.477967646388699, recall 0.4611111111111111, F1 0.34959722472957216, AUC 0.644352904040404
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.633888888888889
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.37244897959183676, precision 0.2003394276016354, recall 0.2546296296296296, F1 0.22270417384278454, AUC 0.4307622354497354
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4207451499118166
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 14 idx: 0 First Loss : 3.288421392440796, Second Loss : 4.2992658615112305
epoch: 14 idx: 200 First Loss : 0.8438802599766181, Second Loss : 0.8630763969910247
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3802083333333333, precision 0.476458067262665, recall 0.4444444444444444, F1 0.32565210394452326, AUC 0.6526104797979798
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6340404040404041
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3877551020408163, precision 0.21645021645021645, recall 0.2638888888888889, F1 0.23258882291961172, AUC 0.4293637014991181
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4231701940035273
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 15 idx: 0 First Loss : 3.328728199005127, Second Loss : 4.405447959899902
epoch: 15 idx: 200 First Loss : 0.8441084412438273, Second Loss : 0.8589039383982007
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.390625, precision 0.48237211803455, recall 0.4511111111111111, F1 0.3353642475401321, AUC 0.6477872474747475
  Second-Tier acc 0.3958333333333333, precision 0.5157657657657658, recall 0.45444444444444443, F1 0.34027777777777773, AUC 0.6058585858585858
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.37244897959183676, precision 0.19298692477500423, recall 0.24729938271604937, F1 0.21466293880086984, AUC 0.43443424823633153
  Second-Tier acc 0.3877551020408163, precision 0.2094017094017094, recall 0.2638888888888889, F1 0.2294372294372294, AUC 0.4310515873015874
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 16 idx: 0 First Loss : 3.568716287612915, Second Loss : 4.567573547363281
epoch: 16 idx: 200 First Loss : 0.846683286300997, Second Loss : 0.8526716566326394
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3541666666666667, precision 0.4590424795904248, recall 0.42777777777777776, F1 0.3007126194356566, AUC 0.6553472222222222
  Second-Tier acc 0.375, precision 0.5131578947368421, recall 0.44111111111111106, F1 0.320358788676761, AUC 0.628030303030303
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.39285714285714285, precision 0.20711252653927814, recall 0.2596450617283951, F1 0.2246250604741171, AUC 0.42804439484126994
  Second-Tier acc 0.3673469387755102, precision 0.21578947368421053, recall 0.2515432098765432, F1 0.22564102564102564, AUC 0.42438271604938277
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 17 idx: 0 First Loss : 3.7768359184265137, Second Loss : 4.741028785705566
epoch: 17 idx: 200 First Loss : 0.8480258565244035, Second Loss : 0.8539140435640914
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.359375, precision 0.4647271293234026, recall 0.43111111111111106, F1 0.3054940377376848, AUC 0.6641414141414141
  Second-Tier acc 0.5, precision 0.49126984126984125, recall 0.5211111111111111, F1 0.425656660412758, AUC 0.6184343434343434
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.39285714285714285, precision 0.20711252653927814, recall 0.2596450617283951, F1 0.2246250604741171, AUC 0.41942584325396837
  Second-Tier acc 0.32653061224489793, precision 0.22874493927125505, recall 0.34413580246913583, F1 0.26182156999767064, AUC 0.4314373897707231
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 18 idx: 0 First Loss : 3.6587483882904053, Second Loss : 4.77817964553833
epoch: 18 idx: 200 First Loss : 0.8458053271391672, Second Loss : 0.84319529596761
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.359375, precision 0.46693898867811906, recall 0.43111111111111106, F1 0.30524625898432894, AUC 0.6704608585858587
  Second-Tier acc 0.5, precision 0.4616920842411038, recall 0.5041414141414141, F1 0.42345446950710103, AUC 0.6242929292929293
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3826530612244898, precision 0.19932241671372106, recall 0.2534722222222222, F1 0.21956974323386538, AUC 0.41488233024691357
  Second-Tier acc 0.32653061224489793, precision 0.22826086956521738, recall 0.37345679012345673, F1 0.25833333333333336, AUC 0.4622464726631393
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9
 current learn rate 0.0002230576490704705
epoch: 19 idx: 0 First Loss : 3.5971055030822754, Second Loss : 4.865805149078369
epoch: 19 idx: 200 First Loss : 0.8428626148941213, Second Loss : 0.8441068515064841
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3802083333333333, precision 0.4739858906525573, recall 0.4444444444444444, F1 0.32590930759002024, AUC 0.6751420454545455
  Second-Tier acc 0.4375, precision 0.4005263157894737, recall 0.4302020202020202, F1 0.3716329966329966, AUC 0.6266161616161616
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3826530612244898, precision 0.1925770308123249, recall 0.2534722222222222, F1 0.21724137931034482, AUC 0.4097945601851852
  Second-Tier acc 0.3469387755102041, precision 0.25308641975308643, recall 0.4151234567901234, F1 0.275177304964539, AUC 0.46913580246913583
 
 test auc: 0.4080136684303351, test F1: 0.1791044776119403  :  from epoch 9{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.3178500852415266, "droprate_2": 0.0, "lr": 0.00010998147032887581, "weight_decay": 1.0339097413122689e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00010998147032887581
epoch: 0 idx: 0 First Loss : 0.8966442942619324, Second Loss : 1.0359355211257935
epoch: 0 idx: 200 First Loss : 1.1216726578883272, Second Loss : 1.1000759202004664
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49794051627384955
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4951515151515151
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44906795022535756
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4523258377425044
 
 test auc: 0.4523258377425044, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00010998147032887581
epoch: 1 idx: 0 First Loss : 1.5252491235733032, Second Loss : 2.1296725273132324
epoch: 1 idx: 200 First Loss : 1.01129111981214, Second Loss : 1.0028644936594797
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.2986111111111111, precision 0.4209245742092458, recall 0.40404040404040403, F1 0.25539499036608865, AUC 0.48920314253647584
  Second-Tier acc 0.2916666666666667, precision 0.4202898550724638, recall 0.393939393939394, F1 0.24049513704686118, AUC 0.48666666666666664
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.47424309229864786
  Second-Tier acc 0.2857142857142857, precision 0.09722222222222222, recall 0.3333333333333333, F1 0.15053763440860216, AUC 0.47172619047619047
 
 test auc: 0.4523258377425044, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00010998147032887581
epoch: 2 idx: 0 First Loss : 1.9057669639587402, Second Loss : 2.523651361465454
epoch: 2 idx: 200 First Loss : 0.956656277439191, Second Loss : 0.9621199433928105
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.2847222222222222, precision 0.28817204301075267, recall 0.37094276094276096, F1 0.2853562477622628, AUC 0.48613355780022444
  Second-Tier acc 0.22916666666666666, precision 0.18091168091168094, recall 0.32323232323232326, F1 0.2310949788263763, AUC 0.4825252525252526
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.3469387755102041, precision 0.39414783890906485, recall 0.37896825396825395, F1 0.3809989963421189, AUC 0.5086774936311974
  Second-Tier acc 0.32653061224489793, precision 0.36428571428571427, recall 0.34920634920634913, F1 0.3514690982776089, AUC 0.513613315696649
 
 test auc: 0.4523258377425044, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00010998147032887581
epoch: 3 idx: 0 First Loss : 2.530229330062866, Second Loss : 3.0953433513641357
epoch: 3 idx: 200 First Loss : 0.9260793389724706, Second Loss : 0.9357119869088653
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.2777777777777778, precision 0.26188192668371696, recall 0.314983164983165, F1 0.26772072039176065, AUC 0.4954882154882155
  Second-Tier acc 0.20833333333333334, precision 0.14393939393939395, recall 0.29797979797979796, F1 0.1820020222446916, AUC 0.4846969696969697
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.3877551020408163, precision 0.3565166438973438, recall 0.4236478542034097, F1 0.3761029968624905, AUC 0.5260508524397414
  Second-Tier acc 0.42857142857142855, precision 0.44166666666666665, recall 0.44025573192239853, F1 0.44082086315332897, AUC 0.533123897707231
 
 test auc: 0.4523258377425044, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00010998147032887581
epoch: 4 idx: 0 First Loss : 3.123782157897949, Second Loss : 3.6159827709198
epoch: 4 idx: 200 First Loss : 0.9227963923221797, Second Loss : 0.9308841037818819
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3194444444444444, precision 0.29312620570616305, recall 0.34814814814814815, F1 0.2958602150537634, AUC 0.5043322109988777
  Second-Tier acc 0.3333333333333333, precision 0.3621933621933622, recall 0.41191919191919196, F1 0.30390597384234713, AUC 0.48414141414141404
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3469387755102041, precision 0.3046594982078853, recall 0.39726631393298056, F1 0.3211035539802663, AUC 0.5354203409758965
  Second-Tier acc 0.3673469387755102, precision 0.3624338624338624, recall 0.3624338624338624, F1 0.3624338624338624, AUC 0.5472332451499118
 
 test auc: 0.4523258377425044, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00010998147032887581
epoch: 5 idx: 0 First Loss : 3.41555118560791, Second Loss : 3.9232161045074463
epoch: 5 idx: 200 First Loss : 0.9197290861383729, Second Loss : 0.9320212857200028
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3819444444444444, precision 0.357487922705314, recall 0.40511784511784515, F1 0.3427694164725495, AUC 0.524337822671156
  Second-Tier acc 0.3333333333333333, precision 0.34047619047619043, recall 0.394949494949495, F1 0.3096903096903097, AUC 0.5176262626262627
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.32653061224489793, precision 0.2504018912529551, recall 0.3343621399176955, F1 0.27675454436017816, AUC 0.5254997060552616
  Second-Tier acc 0.32653061224489793, precision 0.25396825396825395, recall 0.3148148148148148, F1 0.2787878787878788, AUC 0.5451940035273368
 
 test auc: 0.5451940035273368, test F1: 0.2787878787878788  :  from epoch 5
 current learn rate 0.00010998147032887581
epoch: 6 idx: 0 First Loss : 3.5252974033355713, Second Loss : 3.9962286949157715
epoch: 6 idx: 200 First Loss : 0.9133838778384845, Second Loss : 0.9327661855486847
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4375, precision 0.41096246748420656, recall 0.45764309764309763, F1 0.38658611385884106, AUC 0.5745342312008979
  Second-Tier acc 0.4166666666666667, precision 0.4301404853128991, recall 0.4677777777777778, F1 0.3674603174603175, AUC 0.5556060606060607
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3197278911564626, precision 0.22971014492753625, recall 0.3009259259259259, F1 0.2538302277432712, AUC 0.5059095140113659
  Second-Tier acc 0.3469387755102041, precision 0.26164874551971323, recall 0.2978395061728395, F1 0.27856659905341447, AUC 0.5354938271604938
 
 test auc: 0.5354938271604938, test F1: 0.27856659905341447  :  from epoch 6
 current learn rate 0.00010998147032887581
epoch: 7 idx: 0 First Loss : 3.4855258464813232, Second Loss : 4.085727214813232
epoch: 7 idx: 200 First Loss : 0.9082162353408231, Second Loss : 0.9334119107378461
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4513888888888889, precision 0.4155193236714976, recall 0.4673737373737374, F1 0.38994666428294744, AUC 0.6048653198653198
  Second-Tier acc 0.4166666666666667, precision 0.4305555555555556, recall 0.4677777777777778, F1 0.36457607433217193, AUC 0.5993939393939395
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.3129251700680272, precision 0.21907013396375097, recall 0.28703703703703703, F1 0.24204486176317164, AUC 0.489718058005095
  Second-Tier acc 0.2653061224489796, precision 0.16606929510155316, recall 0.1898148148148148, F1 0.17714672075726842, AUC 0.5216049382716049
 
 test auc: 0.5216049382716049, test F1: 0.17714672075726842  :  from epoch 7
 current learn rate 0.00010998147032887581
epoch: 8 idx: 0 First Loss : 3.5975685119628906, Second Loss : 4.015066623687744
epoch: 8 idx: 200 First Loss : 0.9048310958911243, Second Loss : 0.9256487228080574
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4375, precision 0.4642224899956859, recall 0.4754545454545454, F1 0.37694207027540366, AUC 0.6401402918069584
  Second-Tier acc 0.4375, precision 0.46589861751152073, recall 0.48111111111111104, F1 0.3811194653299916, AUC 0.6265656565656567
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.2925170068027211, precision 0.17533490937746254, recall 0.21604938271604937, F1 0.193015873015873, AUC 0.46803350970017626
  Second-Tier acc 0.32653061224489793, precision 0.1984126984126984, recall 0.22685185185185186, F1 0.20890937019969277, AUC 0.5022045855379189
 
 test auc: 0.5022045855379189, test F1: 0.20890937019969277  :  from epoch 8
 current learn rate 0.00010998147032887581
epoch: 9 idx: 0 First Loss : 3.415780782699585, Second Loss : 3.9212052822113037
epoch: 9 idx: 200 First Loss : 0.8967769689364498, Second Loss : 0.9213008951761792
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4236111111111111, precision 0.4813382410469789, recall 0.47222222222222215, F1 0.364393330147593, AUC 0.6568294051627385
  Second-Tier acc 0.375, precision 0.4411764705882353, recall 0.44111111111111106, F1 0.3230506822612086, AUC 0.6347979797979798
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.18112537843198664, recall 0.2309670781893004, F1 0.20303030303030303, AUC 0.4453079071134627
  Second-Tier acc 0.3469387755102041, precision 0.2037037037037037, recall 0.2391975308641975, F1 0.2169312169312169, AUC 0.48203262786596124
 
 test auc: 0.48203262786596124, test F1: 0.2169312169312169  :  from epoch 9
 current learn rate 0.00010998147032887581
epoch: 10 idx: 0 First Loss : 3.3062307834625244, Second Loss : 3.8201677799224854
epoch: 10 idx: 200 First Loss : 0.898962670730413, Second Loss : 0.9185998372835529
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4236111111111111, precision 0.49673721340388005, recall 0.47222222222222215, F1 0.3644856493321966, AUC 0.6618294051627386
  Second-Tier acc 0.375, precision 0.4990990990990991, recall 0.44111111111111106, F1 0.32102572211680375, AUC 0.6484848484848484
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3401360544217687, precision 0.18483577917540184, recall 0.23508230452674897, F1 0.20677361853832443, AUC 0.42961860670194
  Second-Tier acc 0.3469387755102041, precision 0.2037037037037037, recall 0.2391975308641975, F1 0.2169312169312169, AUC 0.4740410052910053
 
 test auc: 0.4740410052910053, test F1: 0.2169312169312169  :  from epoch 10
 current learn rate 0.00010998147032887581
epoch: 11 idx: 0 First Loss : 3.3292462825775146, Second Loss : 3.744281768798828
epoch: 11 idx: 200 First Loss : 0.9016323505923388, Second Loss : 0.9115131746387383
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3819444444444444, precision 0.47851037851037853, recall 0.44555555555555554, F1 0.32660692482121056, AUC 0.6665319865319865
  Second-Tier acc 0.3541666666666667, precision 0.5106837606837606, recall 0.42777777777777776, F1 0.29944444444444446, AUC 0.6534343434343435
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3469387755102041, precision 0.17515151515151514, recall 0.2294238683127572, F1 0.19824055276560884, AUC 0.4259381736233589
  Second-Tier acc 0.32653061224489793, precision 0.14035087719298245, recall 0.19753086419753085, F1 0.1641025641025641, AUC 0.4510582010582011
 
 test auc: 0.4510582010582011, test F1: 0.1641025641025641  :  from epoch 11
 current learn rate 0.00010998147032887581
epoch: 12 idx: 0 First Loss : 3.3185033798217773, Second Loss : 3.563906669616699
epoch: 12 idx: 200 First Loss : 0.89812271675183, Second Loss : 0.9044632849622917
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.4705645059627361, recall 0.43222222222222223, F1 0.3061965985392537, AUC 0.6672446689113355
  Second-Tier acc 0.3125, precision 0.49166666666666664, recall 0.40111111111111114, F1 0.2544351073762839, AUC 0.661969696969697
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.17028985507246377, recall 0.23199588477366254, F1 0.19542362399505256, AUC 0.41627474034881445
  Second-Tier acc 0.3673469387755102, precision 0.15, recall 0.2222222222222222, F1 0.1791044776119403, AUC 0.43016975308641975
 
 test auc: 0.43016975308641975, test F1: 0.1791044776119403  :  from epoch 12
 current learn rate 0.00010998147032887581
epoch: 13 idx: 0 First Loss : 3.299621343612671, Second Loss : 3.480634927749634
epoch: 13 idx: 200 First Loss : 0.8933422400924378, Second Loss : 0.8967258713832351
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.4519704433497536, recall 0.4144444444444444, F1 0.2775386471608476, AUC 0.6697923681257015
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6666161616161617
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.38095238095238093, precision 0.1763029998324116, recall 0.24022633744855967, F1 0.20144534778681122, AUC 0.41497036057221237
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.42476851851851855
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 14 idx: 0 First Loss : 3.34322190284729, Second Loss : 3.4255881309509277
epoch: 14 idx: 200 First Loss : 0.8883678127551945, Second Loss : 0.889325740236968
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3888888888888889, precision 0.4725007080147267, recall 0.44999999999999996, F1 0.33381558809090645, AUC 0.6710942760942761
  Second-Tier acc 0.3125, precision 0.49166666666666664, recall 0.40111111111111114, F1 0.2544351073762839, AUC 0.6641919191919191
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3741496598639456, precision 0.19963441702572138, recall 0.25565843621399176, F1 0.22310874704491723, AUC 0.420279737409367
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.42636684303350975
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 15 idx: 0 First Loss : 3.373398542404175, Second Loss : 3.5125207901000977
epoch: 15 idx: 200 First Loss : 0.8829154483879501, Second Loss : 0.8818595192053217
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3472222222222222, precision 0.4595864661654135, recall 0.42333333333333334, F1 0.2922239665096808, AUC 0.6699607182940518
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.663989898989899
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4013605442176871, precision 0.18468720821662, recall 0.2525720164609053, F1 0.21042735042735042, AUC 0.4200837742504409
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4233906525573192
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 16 idx: 0 First Loss : 3.3407135009765625, Second Loss : 3.4140195846557617
epoch: 16 idx: 200 First Loss : 0.8710214776520612, Second Loss : 0.8765041761953715
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3402777777777778, precision 0.4606395520188624, recall 0.41888888888888887, F1 0.28476362953831796, AUC 0.6657351290684624
  Second-Tier acc 0.2916666666666667, precision 0.503968253968254, recall 0.3877777777777778, F1 0.22941416259026323, AUC 0.6597979797979799
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4013605442176871, precision 0.18333333333333335, recall 0.2525720164609053, F1 0.20946549304758263, AUC 0.4208125122476975
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.4248787477954144
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 17 idx: 0 First Loss : 3.312713384628296, Second Loss : 3.3653876781463623
epoch: 17 idx: 200 First Loss : 0.8627507171195564, Second Loss : 0.869227816188316
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4444444444444444, precision 0.526984126984127, recall 0.4855555555555555, F1 0.38164251207729466, AUC 0.662817059483726
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6547474747474747
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.19104506604506608, recall 0.24897119341563786, F1 0.21615299510036354, AUC 0.4299309229864785
  Second-Tier acc 0.3877551020408163, precision 0.15447154471544716, recall 0.23456790123456792, F1 0.18627450980392157, AUC 0.4226741622574956
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 18 idx: 0 First Loss : 3.3682544231414795, Second Loss : 3.4557600021362305
epoch: 18 idx: 200 First Loss : 0.8641174461854326, Second Loss : 0.8666850367955875
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4375, precision 0.5151067323481117, recall 0.48111111111111104, F1 0.37597547380156077, AUC 0.6660213243546577
  Second-Tier acc 0.3333333333333333, precision 0.5083333333333333, recall 0.4144444444444444, F1 0.27741153932837503, AUC 0.6520707070707071
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3945578231292517, precision 0.21404761904761904, recall 0.27777777777777773, F1 0.2409502661168094, AUC 0.42428473446991966
  Second-Tier acc 0.40816326530612246, precision 0.15873015873015872, recall 0.24691358024691357, F1 0.1932367149758454, AUC 0.41815476190476186
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13
 current learn rate 0.00010998147032887581
epoch: 19 idx: 0 First Loss : 3.394751787185669, Second Loss : 3.434969186782837
epoch: 19 idx: 200 First Loss : 0.8565750608012698, Second Loss : 0.8588294461666435
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.5069444444444444, precision 0.535233918128655, recall 0.5255555555555556, F1 0.43081219806763277, AUC 0.6598204264870932
  Second-Tier acc 0.4791666666666667, precision 0.5277777777777778, recall 0.5077777777777778, F1 0.41203703703703703, AUC 0.6486868686868686
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.29931972789115646, precision 0.16997736987679155, recall 0.2201646090534979, F1 0.19083837510803803, AUC 0.42090436997844405
  Second-Tier acc 0.30612244897959184, precision 0.1610644257703081, recall 0.21450617283950615, F1 0.18330849478390462, AUC 0.40878527336860665
 
 test auc: 0.42476851851851855, test F1: 0.18627450980392157  :  from epoch 13{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.28615629881763144, "droprate_2": 0.0, "lr": 1.4467365140621175e-05, "weight_decay": 9.519776398214795e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.4467365140621175e-05
epoch: 0 idx: 0 First Loss : 1.2272347211837769, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.0622927611740074, Second Loss : 1.050789613184051
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6819753086419752
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.706969696969697
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.5937438761512837
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6056547619047619
 
 test auc: 0.6056547619047619, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.4467365140621175e-05
epoch: 1 idx: 0 First Loss : 1.9783607721328735, Second Loss : 1.947812557220459
epoch: 1 idx: 200 First Loss : 1.0854527005805306, Second Loss : 1.076896451376564
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7251402918069584
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.734949494949495
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6457292279051537
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6396604938271605
 
 test auc: 0.6396604938271605, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.4467365140621175e-05
epoch: 2 idx: 0 First Loss : 2.0130248069763184, Second Loss : 1.9691354036331177
epoch: 2 idx: 200 First Loss : 1.0659426800647185, Second Loss : 1.0591916149083656
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7374466891133559
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7420202020202019
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6757483343131492
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6684854497354498
 
 test auc: 0.6684854497354498, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.4467365140621175e-05
epoch: 3 idx: 0 First Loss : 2.063800096511841, Second Loss : 1.9865344762802124
epoch: 3 idx: 200 First Loss : 1.0510570272729172, Second Loss : 1.0442432116216689
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7476543209876544
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7466666666666667
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6934156378600823
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6852954144620811
 
 test auc: 0.6852954144620811, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.4467365140621175e-05
epoch: 4 idx: 0 First Loss : 2.1046860218048096, Second Loss : 2.0122811794281006
epoch: 4 idx: 200 First Loss : 1.0380676486598912, Second Loss : 1.0330813510056158
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7525869809203142
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7575252525252525
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7006479031941995
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6996803350970019
 
 test auc: 0.6996803350970019, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.4467365140621175e-05
epoch: 5 idx: 0 First Loss : 2.149000406265259, Second Loss : 2.043966770172119
epoch: 5 idx: 200 First Loss : 1.0270775936136198, Second Loss : 1.0237035889234116
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7503815937149271
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7544444444444444
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7051979227905153
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7102072310405644
 
 test auc: 0.6996803350970019, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.4467365140621175e-05
epoch: 6 idx: 0 First Loss : 2.1986653804779053, Second Loss : 2.073610305786133
epoch: 6 idx: 200 First Loss : 1.016241586215757, Second Loss : 1.0136515125261611
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7489450056116723
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7553535353535353
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.710605281207133
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7099316578483245
 
 test auc: 0.6996803350970019, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.4467365140621175e-05
epoch: 7 idx: 0 First Loss : 2.2552225589752197, Second Loss : 2.1088051795959473
epoch: 7 idx: 200 First Loss : 1.0064779455907902, Second Loss : 1.0048865845695656
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5694444444444444, precision 0.47901234567901235, recall 0.40969696969696967, F1 0.36190476190476195, AUC 0.7490628507295174
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7532323232323233
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5510204081632653, precision 0.18493150684931506, recall 0.3333333333333333, F1 0.23788546255506607, AUC 0.7127486282578875
  Second-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.7138447971781305
 
 test auc: 0.6996803350970019, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.4467365140621175e-05
epoch: 8 idx: 0 First Loss : 2.3097431659698486, Second Loss : 2.1468732357025146
epoch: 8 idx: 200 First Loss : 0.99514558889083, Second Loss : 0.9953830969422611
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5833333333333334, precision 0.37853949329359166, recall 0.4412121212121212, F1 0.3891093677895708, AUC 0.7517283950617285
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7553030303030303
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5782312925170068, precision 0.3272101033295063, recall 0.3689006466784244, F1 0.3086680761099366, AUC 0.7072677836566726
  Second-Tier acc 0.5918367346938775, precision 0.3378787878787879, recall 0.38095238095238093, F1 0.3236965653570546, AUC 0.7185846560846562
 
 test auc: 0.6996803350970019, test F1: 0.23684210526315788  :  from epoch 4
 current learn rate 1.4467365140621175e-05
epoch: 9 idx: 0 First Loss : 2.3563339710235596, Second Loss : 2.1856372356414795
epoch: 9 idx: 200 First Loss : 0.9845859082925379, Second Loss : 0.986249193215548
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.625, precision 0.40178571428571425, recall 0.5018181818181818, F1 0.4412998765939942, AUC 0.7499775533108867
  Second-Tier acc 0.6666666666666666, precision 0.4336996336996337, recall 0.5624242424242424, F1 0.48888888888888893, AUC 0.7653030303030303
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5714285714285714, precision 0.49137931034482757, recall 0.39366549088771313, F1 0.3665766563457276, AUC 0.7029198510679993
  Second-Tier acc 0.5306122448979592, precision 0.3062678062678063, recall 0.36684303350970016, F1 0.3315696649029982, AUC 0.7129629629629629
 
 test auc: 0.7129629629629629, test F1: 0.3315696649029982  :  from epoch 9
 current learn rate 1.4467365140621175e-05
epoch: 10 idx: 0 First Loss : 2.397383689880371, Second Loss : 2.2228925228118896
epoch: 10 idx: 200 First Loss : 0.9739295633797028, Second Loss : 0.9770879415582069
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.6666666666666666, precision 0.42907268170426066, recall 0.585050505050505, F1 0.4943089430894309, AUC 0.7504377104377103
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7748989898989898
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.54421768707483, precision 0.5520833333333334, recall 0.41372721928277484, F1 0.40506382088302995, AUC 0.7051917989417991
  Second-Tier acc 0.5510204081632653, precision 0.6745311554748942, recall 0.44290123456790126, F1 0.44167869167869167, AUC 0.7275683421516753
 
 test auc: 0.7275683421516753, test F1: 0.44167869167869167  :  from epoch 10
 current learn rate 1.4467365140621175e-05
epoch: 11 idx: 0 First Loss : 2.4348948001861572, Second Loss : 2.257133960723877
epoch: 11 idx: 200 First Loss : 0.9639656128760298, Second Loss : 0.9680425751565108
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.6527777777777778, precision 0.6667557932263813, recall 0.5906060606060606, F1 0.524621212121212, AUC 0.7512962962962962
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7745959595959594
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.564625850340136, precision 0.5109126984126985, recall 0.46641681363903587, F1 0.4556580930642477, AUC 0.7079903978052126
  Second-Tier acc 0.5714285714285714, precision 0.5477053140096618, recall 0.4896384479717813, F1 0.4690690690690691, AUC 0.7298280423280423
 
 test auc: 0.7275683421516753, test F1: 0.44167869167869167  :  from epoch 10
 current learn rate 1.4467365140621175e-05
epoch: 12 idx: 0 First Loss : 2.4705371856689453, Second Loss : 2.3014113903045654
epoch: 12 idx: 200 First Loss : 0.9544423893094063, Second Loss : 0.9591808115220188
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.6180555555555556, precision 0.5563402385436284, recall 0.5731986531986532, F1 0.5138134391229697, AUC 0.7521212121212121
  Second-Tier acc 0.6666666666666666, precision 0.7612942612942613, recall 0.6108080808080808, F1 0.5341251885369532, AUC 0.7822222222222223
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.5782312925170068, precision 0.5161902789284728, recall 0.49375367430922984, F1 0.47238835725677825, AUC 0.7114564961787183
  Second-Tier acc 0.5714285714285714, precision 0.5063131313131313, recall 0.5011022927689593, F1 0.4712755915763434, AUC 0.736386684303351
 
 test auc: 0.736386684303351, test F1: 0.4712755915763434  :  from epoch 12
 current learn rate 1.4467365140621175e-05
epoch: 13 idx: 0 First Loss : 2.5031473636627197, Second Loss : 2.338444948196411
epoch: 13 idx: 200 First Loss : 0.9453061385942039, Second Loss : 0.9507012710308851
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.5833333333333334, precision 0.5121527777777778, recall 0.5566329966329967, F1 0.4926305080944257, AUC 0.7556004489337823
  Second-Tier acc 0.6041666666666666, precision 0.5782828282828283, recall 0.5708080808080808, F1 0.4934143870314083, AUC 0.7872222222222223
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.5578231292517006, precision 0.4805717011809835, recall 0.47545561434450323, F1 0.443441618336429, AUC 0.7123015873015873
  Second-Tier acc 0.5714285714285714, precision 0.49666666666666665, recall 0.5011022927689593, F1 0.47054009819967263, AUC 0.7387014991181657
 
 test auc: 0.7387014991181657, test F1: 0.47054009819967263  :  from epoch 13
 current learn rate 1.4467365140621175e-05
epoch: 14 idx: 0 First Loss : 2.5330164432525635, Second Loss : 2.367920160293579
epoch: 14 idx: 200 First Loss : 0.935656451875001, Second Loss : 0.942219386275728
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.5555555555555556, precision 0.5286529680365297, recall 0.5541414141414142, F1 0.4912433478471215, AUC 0.7562570145903479
  Second-Tier acc 0.5208333333333334, precision 0.51772030651341, recall 0.5174747474747475, F1 0.4387533875338754, AUC 0.7933838383838383
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.5510204081632653, precision 0.5010053698578288, recall 0.4849353321575543, F1 0.45584021060408797, AUC 0.7155349794238682
  Second-Tier acc 0.5510204081632653, precision 0.4875168690958165, recall 0.4887566137566138, F1 0.45628019323671504, AUC 0.7474647266313933
 
 test auc: 0.7474647266313933, test F1: 0.45628019323671504  :  from epoch 14
 current learn rate 1.4467365140621175e-05
epoch: 15 idx: 0 First Loss : 2.560930013656616, Second Loss : 2.396268606185913
epoch: 15 idx: 200 First Loss : 0.9267550674614622, Second Loss : 0.9343091841620296
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.5486111111111112, precision 0.5401576913833582, recall 0.5593265993265993, F1 0.5008720393655768, AUC 0.7582996632996633
  Second-Tier acc 0.4791666666666667, precision 0.4801587301587302, recall 0.4908080808080808, F1 0.40939649781113197, AUC 0.7954545454545454
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.5374149659863946, precision 0.4805347908796185, recall 0.4767048794826572, F1 0.445951809980587, AUC 0.7187622476974328
  Second-Tier acc 0.5510204081632653, precision 0.49691358024691357, recall 0.4887566137566138, F1 0.45663956639566394, AUC 0.7549603174603176
 
 test auc: 0.7549603174603176, test F1: 0.45663956639566394  :  from epoch 15
 current learn rate 1.4467365140621175e-05
epoch: 16 idx: 0 First Loss : 2.5867981910705566, Second Loss : 2.42364239692688
epoch: 16 idx: 200 First Loss : 0.9182568159121186, Second Loss : 0.9268714302214817
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.5694444444444444, precision 0.5827478727571235, recall 0.5927609427609427, F1 0.5360194377288949, AUC 0.7600224466891135
  Second-Tier acc 0.4791666666666667, precision 0.546415770609319, recall 0.5052525252525253, F1 0.43535972947737656, AUC 0.793939393939394
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.5170068027210885, precision 0.48201404018397476, recall 0.4741328630217519, F1 0.4438380048136146, AUC 0.7231959141681363
  Second-Tier acc 0.5306122448979592, precision 0.4887955182072829, recall 0.47641093474426804, F1 0.44227994227994233, AUC 0.7588183421516755
 
 test auc: 0.7549603174603176, test F1: 0.45663956639566394  :  from epoch 15
 current learn rate 1.4467365140621175e-05
epoch: 17 idx: 0 First Loss : 2.6087775230407715, Second Loss : 2.45015811920166
epoch: 17 idx: 200 First Loss : 0.9102304512588539, Second Loss : 0.9198734077499874
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.5486111111111112, precision 0.5755253518411413, recall 0.5842424242424242, F1 0.5237629096759018, AUC 0.762401795735129
  Second-Tier acc 0.4583333333333333, precision 0.540530303030303, recall 0.4919191919191919, F1 0.41865531742412726, AUC 0.7943434343434342
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4965986394557823, precision 0.48197621403488355, recall 0.4715608465608465, F1 0.4390081239845019, AUC 0.7251739173035471
  Second-Tier acc 0.46938775510204084, precision 0.46351766513056836, recall 0.439373897707231, F1 0.39738030713640476, AUC 0.7605268959435626
 
 test auc: 0.7549603174603176, test F1: 0.45663956639566394  :  from epoch 15
 current learn rate 1.4467365140621175e-05
epoch: 18 idx: 0 First Loss : 2.6267669200897217, Second Loss : 2.4733991622924805
epoch: 18 idx: 200 First Loss : 0.9024730583198777, Second Loss : 0.913448910103805
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.5138888888888888, precision 0.5529381099001353, recall 0.562020202020202, F1 0.49404761904761907, AUC 0.7627553310886643
  Second-Tier acc 0.4375, precision 0.5152777777777777, recall 0.4785858585858586, F1 0.400541405192568, AUC 0.79479797979798
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4965986394557823, precision 0.4983019564414914, recall 0.48133450911228687, F1 0.4483933032320129, AUC 0.7296198314716834
  Second-Tier acc 0.42857142857142855, precision 0.41984126984126985, recall 0.4146825396825397, F1 0.364957264957265, AUC 0.7583223104056437
 
 test auc: 0.7549603174603176, test F1: 0.45663956639566394  :  from epoch 15
 current learn rate 1.4467365140621175e-05
epoch: 19 idx: 0 First Loss : 2.644747018814087, Second Loss : 2.497274398803711
epoch: 19 idx: 200 First Loss : 0.8955770865434882, Second Loss : 0.9077083155864951
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.5138888888888888, precision 0.5529381099001353, recall 0.562020202020202, F1 0.49404761904761907, AUC 0.7645117845117846
  Second-Tier acc 0.4375, precision 0.5152777777777777, recall 0.4785858585858586, F1 0.400541405192568, AUC 0.7903030303030304
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.46258503401360546, precision 0.47896930655551345, recall 0.4569370958259847, F1 0.42131782945736435, AUC 0.7320509994121105
  Second-Tier acc 0.42857142857142855, precision 0.4431216931216932, recall 0.43253968253968256, F1 0.3910076851253322, AUC 0.7705026455026456
 
 test auc: 0.7549603174603176, test F1: 0.45663956639566394  :  from epoch 15{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.3674972211114842, "droprate_2": 0.0, "lr": 4.8556790110468683e-05, "weight_decay": 1.7039355830579517e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.8556790110468683e-05
epoch: 0 idx: 0 First Loss : 1.2252813577651978, Second Loss : 1.1571635007858276
epoch: 0 idx: 200 First Loss : 1.1222568424186896, Second Loss : 1.1025578985315057
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7263524130190797
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7463636363636365
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6598079561042524
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6617614638447972
 
 test auc: 0.6617614638447972, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 4.8556790110468683e-05
epoch: 1 idx: 0 First Loss : 2.1372556686401367, Second Loss : 2.0269172191619873
epoch: 1 idx: 200 First Loss : 1.0607710648235398, Second Loss : 1.0448754630723402
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7468294051627385
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7552525252525252
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6995027434842248
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7027116402116403
 
 test auc: 0.7027116402116403, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 4.8556790110468683e-05
epoch: 2 idx: 0 First Loss : 2.2142045497894287, Second Loss : 2.096719741821289
epoch: 2 idx: 200 First Loss : 1.0230174411217965, Second Loss : 1.009954455109378
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5625, precision 0.47303921568627444, recall 0.39959595959595956, F1 0.34762840519400456, AUC 0.7464758698092031
  Second-Tier acc 0.5625, precision 0.386046511627907, recall 0.4109090909090909, F1 0.3602941176470589, AUC 0.7616161616161615
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6938810503625318
  Second-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.7048059964726633
 
 test auc: 0.7048059964726633, test F1: 0.28579102874026324  :  from epoch 2
 current learn rate 4.8556790110468683e-05
epoch: 3 idx: 0 First Loss : 2.358552932739258, Second Loss : 2.2163047790527344
epoch: 3 idx: 200 First Loss : 0.992104277644881, Second Loss : 0.9838308583741164
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6597222222222222, precision 0.42036994397114125, recall 0.5579797979797979, F1 0.47946570972886765, AUC 0.7446632996632997
  Second-Tier acc 0.7083333333333334, precision 0.4583333333333333, recall 0.623030303030303, F1 0.5276153346328785, AUC 0.7744444444444444
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5306122448979592, precision 0.3162393162393162, recall 0.3744855967078189, F1 0.3417417417417417, AUC 0.6908313737017441
  Second-Tier acc 0.5714285714285714, precision 0.5261437908496732, recall 0.4552469135802469, F1 0.4511224297302396, AUC 0.7116402116402116
 
 test auc: 0.7116402116402116, test F1: 0.4511224297302396  :  from epoch 3
 current learn rate 4.8556790110468683e-05
epoch: 4 idx: 0 First Loss : 2.5834481716156006, Second Loss : 2.3719868659973145
epoch: 4 idx: 200 First Loss : 0.9624066527803146, Second Loss : 0.9590945689387582
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.6180555555555556, precision 0.5223280423280423, recall 0.5692255892255892, F1 0.4909126984126984, AUC 0.7480920314253648
  Second-Tier acc 0.6666666666666666, precision 0.7592592592592592, recall 0.6108080808080808, F1 0.5355665839536807, AUC 0.7705555555555555
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5714285714285714, precision 0.5010270774976656, recall 0.4896384479717813, F1 0.4675898053381497, AUC 0.7014440035273367
  Second-Tier acc 0.5714285714285714, precision 0.48517786561264825, recall 0.5011022927689593, F1 0.47144082858368574, AUC 0.732473544973545
 
 test auc: 0.7116402116402116, test F1: 0.4511224297302396  :  from epoch 3
 current learn rate 4.8556790110468683e-05
epoch: 5 idx: 0 First Loss : 2.740327835083008, Second Loss : 2.5130183696746826
epoch: 5 idx: 200 First Loss : 0.9378888288800099, Second Loss : 0.9394660728302464
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5625, precision 0.5604938271604939, recall 0.5634006734006733, F1 0.5040786340375943, AUC 0.7582659932659933
  Second-Tier acc 0.5416666666666666, precision 0.48931623931623935, recall 0.5308080808080807, F1 0.4544049863817306, AUC 0.7822222222222223
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5238095238095238, precision 0.4453102453102453, recall 0.4548794826572604, F1 0.4209229791207263, AUC 0.71422447579855
  Second-Tier acc 0.5714285714285714, precision 0.5640336134453782, recall 0.5597442680776014, F1 0.5334887334887335, AUC 0.7447089947089948
 
 test auc: 0.7447089947089948, test F1: 0.5334887334887335  :  from epoch 5
 current learn rate 4.8556790110468683e-05
epoch: 6 idx: 0 First Loss : 2.862173080444336, Second Loss : 2.6141605377197266
epoch: 6 idx: 200 First Loss : 0.9171004806788852, Second Loss : 0.9213434166983882
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5416666666666666, precision 0.5759362633330712, recall 0.574983164983165, F1 0.5139457999627491, AUC 0.7660381593714928
  Second-Tier acc 0.5, precision 0.5496031746031745, recall 0.5330303030303031, F1 0.4691383691383692, AUC 0.790959595959596
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.48299319727891155, precision 0.4705328546791961, recall 0.45950911228689, F1 0.42740740740740746, AUC 0.7221181167940426
  Second-Tier acc 0.5102040816326531, precision 0.5198717948717949, recall 0.5112433862433862, F1 0.48214285714285715, AUC 0.7622354497354497
 
 test auc: 0.7622354497354497, test F1: 0.48214285714285715  :  from epoch 6
 current learn rate 4.8556790110468683e-05
epoch: 7 idx: 0 First Loss : 2.9300167560577393, Second Loss : 2.6939291954040527
epoch: 7 idx: 200 First Loss : 0.8972684896147963, Second Loss : 0.9092257639291275
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5138888888888888, precision 0.5602586713697825, recall 0.5676767676767677, F1 0.4939526847421584, AUC 0.7747643097643097
  Second-Tier acc 0.5, precision 0.5337606837606838, recall 0.5330303030303031, F1 0.4692874692874693, AUC 0.8064646464646464
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.47619047619047616, precision 0.5016123642439433, recall 0.4847148736037625, F1 0.4465341692232448, AUC 0.7345372819909857
  Second-Tier acc 0.4489795918367347, precision 0.47345679012345676, recall 0.47420634920634924, F1 0.4275588909735251, AUC 0.7699514991181658
 
 test auc: 0.7699514991181658, test F1: 0.4275588909735251  :  from epoch 7
 current learn rate 4.8556790110468683e-05
epoch: 8 idx: 0 First Loss : 2.9733359813690186, Second Loss : 2.7524120807647705
epoch: 8 idx: 200 First Loss : 0.8819799388744938, Second Loss : 0.897307093028183
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5138888888888888, precision 0.5724358810986229, recall 0.5724915824915825, F1 0.49785292538915726, AUC 0.7767957351290685
  Second-Tier acc 0.4791666666666667, precision 0.5358974358974359, recall 0.5341414141414141, F1 0.4632804232804233, AUC 0.8116666666666666
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.48299319727891155, precision 0.5222222222222223, recall 0.5121987066431511, F1 0.4641839641839642, AUC 0.7418124142661179
  Second-Tier acc 0.4897959183673469, precision 0.5379310344827587, recall 0.5218253968253969, F1 0.45931978490118025, AUC 0.7708884479717814
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 9 idx: 0 First Loss : 3.0090038776397705, Second Loss : 2.8065922260284424
epoch: 9 idx: 200 First Loss : 0.8672293117408877, Second Loss : 0.8874821371829776
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4861111111111111, precision 0.5608126169473403, recall 0.5547138047138047, F1 0.4728614522732169, AUC 0.7774859708193042
  Second-Tier acc 0.4583333333333333, precision 0.5190476190476191, recall 0.5063636363636363, F1 0.43327783327783326, AUC 0.8022222222222223
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.5347917439129898, recall 0.5100676072898295, F1 0.4555848081517235, AUC 0.748903831079757
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7794863315696648
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 10 idx: 0 First Loss : 3.042759656906128, Second Loss : 2.86808180809021
epoch: 10 idx: 200 First Loss : 0.8562206331204938, Second Loss : 0.8793147611269607
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4861111111111111, precision 0.550734861845973, recall 0.5595286195286195, F1 0.4739297078102522, AUC 0.7764085297418631
  Second-Tier acc 0.4375, precision 0.5112388250319285, recall 0.493030303030303, F1 0.4144385026737967, AUC 0.7975757575757575
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4897959183673469, precision 0.5743720190779014, recall 0.5570987654320988, F1 0.4767469330793905, AUC 0.7499816284538507
  Second-Tier acc 0.4897959183673469, precision 0.5595238095238095, recall 0.5218253968253969, F1 0.45714285714285713, AUC 0.7814704585537919
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 11 idx: 0 First Loss : 3.031177520751953, Second Loss : 2.8827006816864014
epoch: 11 idx: 200 First Loss : 0.8464425679606696, Second Loss : 0.872725803877658
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4722222222222222, precision 0.5360082304526749, recall 0.5458249158249159, F1 0.4578316706799679, AUC 0.7707575757575756
  Second-Tier acc 0.4375, precision 0.513888888888889, recall 0.51, F1 0.41118502094111853, AUC 0.7942929292929293
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.48299319727891155, precision 0.5722204762902438, recall 0.5529835390946501, F1 0.4703999154306531, AUC 0.7532762590632961
  Second-Tier acc 0.46938775510204084, precision 0.5318704284221526, recall 0.4801587301587302, F1 0.4228886168910649, AUC 0.793044532627866
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 12 idx: 0 First Loss : 3.0208911895751953, Second Loss : 2.8870651721954346
epoch: 12 idx: 200 First Loss : 0.8380279397123971, Second Loss : 0.8663883244535372
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4652777777777778, precision 0.5308556419667531, recall 0.5413804713804714, F1 0.45107048556333645, AUC 0.76516835016835
  Second-Tier acc 0.4375, precision 0.513888888888889, recall 0.51, F1 0.41118502094111853, AUC 0.7876767676767678
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.47619047619047616, precision 0.5778050778050778, recall 0.5429159318048207, F1 0.4581577476054637, AUC 0.7556768077601411
  Second-Tier acc 0.4489795918367347, precision 0.5268199233716475, recall 0.4678130511463845, F1 0.405094130675526, AUC 0.8010361552028219
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 13 idx: 0 First Loss : 2.9978809356689453, Second Loss : 2.880934715270996
epoch: 13 idx: 200 First Loss : 0.8297565233620319, Second Loss : 0.8606810412040694
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4444444444444444, precision 0.5175536881419235, recall 0.5232323232323232, F1 0.42814715147014026, AUC 0.7550729517396185
  Second-Tier acc 0.4166666666666667, precision 0.4895833333333333, recall 0.4822222222222223, F1 0.37862344373972284, AUC 0.7826767676767677
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.48299319727891155, precision 0.5803589433353499, recall 0.5508524397413286, F1 0.46264155035522636, AUC 0.7558605232216342
  Second-Tier acc 0.4489795918367347, precision 0.5268199233716475, recall 0.4678130511463845, F1 0.405094130675526, AUC 0.8075947971781305
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 14 idx: 0 First Loss : 2.978639841079712, Second Loss : 2.8724799156188965
epoch: 14 idx: 200 First Loss : 0.8224342846710105, Second Loss : 0.8548464477849911
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4305555555555556, precision 0.5041083099906629, recall 0.5038720538720539, F1 0.41310776259451365, AUC 0.7450673400673401
  Second-Tier acc 0.4166666666666667, precision 0.4895833333333333, recall 0.4822222222222223, F1 0.37862344373972284, AUC 0.7598484848484848
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.48299319727891155, precision 0.5803589433353499, recall 0.5508524397413286, F1 0.46264155035522636, AUC 0.755646188516559
  Second-Tier acc 0.46938775510204084, precision 0.5383838383838384, recall 0.4916225749559083, F1 0.4195260879471406, AUC 0.8119488536155203
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 15 idx: 0 First Loss : 2.946272611618042, Second Loss : 2.8783257007598877
epoch: 15 idx: 200 First Loss : 0.8159855234758715, Second Loss : 0.8503072659985454
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4305555555555556, precision 0.507168458781362, recall 0.5055555555555555, F1 0.40452140452140456, AUC 0.7360157126823793
  Second-Tier acc 0.3958333333333333, precision 0.4743716931216932, recall 0.4688888888888889, F1 0.35903469915097824, AUC 0.749090909090909
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.46938775510204084, precision 0.5656084656084656, recall 0.5230746619635508, F1 0.4422578591576452, AUC 0.7537416715657456
  Second-Tier acc 0.4489795918367347, precision 0.5354166666666667, recall 0.47927689594356265, F1 0.3997347731363076, AUC 0.8107914462081128
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 16 idx: 0 First Loss : 2.975850820541382, Second Loss : 2.853548049926758
epoch: 16 idx: 200 First Loss : 0.8111454660376414, Second Loss : 0.8465764173839371
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4097222222222222, precision 0.49674185463659154, recall 0.48740740740740734, F1 0.3802083333333333, AUC 0.7275196408529743
  Second-Tier acc 0.3958333333333333, precision 0.4801587301587302, recall 0.4688888888888889, F1 0.35833333333333334, AUC 0.7267171717171718
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4217687074829932, precision 0.5243055555555556, recall 0.4551734273956496, F1 0.37683919944789507, AUC 0.7525781403096218
  Second-Tier acc 0.4489795918367347, precision 0.5354166666666667, recall 0.47927689594356265, F1 0.3997347731363076, AUC 0.8099647266313932
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 17 idx: 0 First Loss : 2.9310333728790283, Second Loss : 2.8606181144714355
epoch: 17 idx: 200 First Loss : 0.806881061531557, Second Loss : 0.84213158696547
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3958333333333333, precision 0.487568058076225, recall 0.47286195286195287, F1 0.3680161943319838, AUC 0.720331088664422
  Second-Tier acc 0.375, precision 0.46296296296296297, recall 0.45555555555555555, F1 0.33768561187916024, AUC 0.7025757575757576
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.40816326530612246, precision 0.5231910946196661, recall 0.4507642563198118, F1 0.3610934552877038, AUC 0.7481873407799333
  Second-Tier acc 0.4489795918367347, precision 0.5354166666666667, recall 0.47927689594356265, F1 0.3997347731363076, AUC 0.8098544973544973
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 18 idx: 0 First Loss : 2.8866891860961914, Second Loss : 2.838569164276123
epoch: 18 idx: 200 First Loss : 0.8028642000255188, Second Loss : 0.8389185780650051
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3888888888888889, precision 0.48187134502923973, recall 0.46841750841750845, F1 0.36094992477971205, AUC 0.7191358024691358
  Second-Tier acc 0.375, precision 0.4689542483660131, recall 0.45555555555555555, F1 0.3371565113500597, AUC 0.6929292929292928
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.5250850340136054, recall 0.4548794826572604, F1 0.3680272108843537, AUC 0.7428840877914952
  Second-Tier acc 0.4489795918367347, precision 0.5387205387205388, recall 0.47927689594356265, F1 0.4000834376303713, AUC 0.8075947971781305
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8
 current learn rate 4.8556790110468683e-05
epoch: 19 idx: 0 First Loss : 2.8315813541412354, Second Loss : 2.8500919342041016
epoch: 19 idx: 200 First Loss : 0.799731826353517, Second Loss : 0.8368984733346794
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.4740007234581298, recall 0.45915824915824915, F1 0.35049440807419535, AUC 0.7175308641975309
  Second-Tier acc 0.3541666666666667, precision 0.44858387799564275, recall 0.44222222222222224, F1 0.3153439153439153, AUC 0.6846969696969697
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5163484748738205, recall 0.44510582010582006, F1 0.3627705627705628, AUC 0.7347026259063295
  Second-Tier acc 0.42857142857142855, precision 0.5348583877995643, recall 0.4669312169312169, F1 0.3801990493166964, AUC 0.7999889770723104
 
 test auc: 0.7708884479717814, test F1: 0.45931978490118025  :  from epoch 8{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 5, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.30212323303726124, "droprate_2": 0.0, "lr": 0.0004051844853126966, "weight_decay": 1.1197772101976162e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0004051844853126966
epoch: 0 idx: 0 First Loss : 1.24288010597229, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.087868965976867, Second Loss : 1.069430237645237
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7383052749719416
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7538888888888889
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7180457573976092
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7142305996472663
Test AUC: 0.7142, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004051844853126966
epoch: 1 idx: 0 First Loss : 1.6787456274032593, Second Loss : 1.7017786502838135
epoch: 1 idx: 200 First Loss : 0.9840666128331749, Second Loss : 0.9822920898892986
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7252244668911336
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7344444444444443
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7251739173035469
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7221119929453264
Test AUC: 0.7142, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004051844853126966
epoch: 2 idx: 0 First Loss : 2.080857038497925, Second Loss : 2.1604902744293213
epoch: 2 idx: 200 First Loss : 0.9522710402880735, Second Loss : 0.951546064174887
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.70652076318743
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7337878787878788
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.681853811483441
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6932319223985891
Test AUC: 0.7142, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004051844853126966
epoch: 3 idx: 0 First Loss : 2.8199970722198486, Second Loss : 3.0058510303497314
epoch: 3 idx: 200 First Loss : 0.9505211951220361, Second Loss : 0.9488701453960654
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3819444444444444, precision 0.5022512708787219, recall 0.4204040404040404, F1 0.35715323166303564, AUC 0.6636644219977553
  Second-Tier acc 0.5625, precision 0.5984126984126984, recall 0.6257575757575758, F1 0.5671265671265672, AUC 0.7257575757575759
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5102040816326531, precision 0.5967272132220586, recall 0.5243974132863022, F1 0.48757492679596376, AUC 0.675913678228493
  Second-Tier acc 0.4897959183673469, precision 0.5123321123321123, recall 0.5295414462081128, F1 0.4677370309554218, AUC 0.685736331569665
Test AUC: 0.7142, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0004051844853126966
epoch: 4 idx: 0 First Loss : 3.525554656982422, Second Loss : 3.6827874183654785
epoch: 4 idx: 200 First Loss : 0.9317173236837397, Second Loss : 0.9332019993965861
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6699270482603817
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7208080808080807
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4421768707482993, precision 0.4320218579234973, recall 0.42416225749559083, F1 0.31761006289308175, AUC 0.6766791593180482
  Second-Tier acc 0.46938775510204084, precision 0.4170653907496013, recall 0.4329805996472664, F1 0.3421052631578947, AUC 0.6762566137566136
Test AUC: 0.7142, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.49586368340585985, "droprate_2": 0.0, "lr": 0.00021816290685056842, "weight_decay": 0.00047847035008629626, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00021816290685056842
epoch: 0 idx: 0 First Loss : 1.2689154148101807, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0975383380752297, Second Loss : 1.0868461283655901
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7376936026936027
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7383838383838383
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7065451695081325
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.720844356261023
Test AUC: 0.7208, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021816290685056842
epoch: 1 idx: 0 First Loss : 1.3759422302246094, Second Loss : 1.8118070363998413
epoch: 1 idx: 200 First Loss : 0.9678039173433437, Second Loss : 0.9920827882058585
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7269977553310886
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7320202020202021
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7372501469723692
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7433862433862434
Test AUC: 0.7208, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021816290685056842
epoch: 2 idx: 0 First Loss : 1.6704672574996948, Second Loss : 2.1983020305633545
epoch: 2 idx: 200 First Loss : 0.9232252525230545, Second Loss : 0.954883421497855
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5972222222222222, precision 0.41409897292250236, recall 0.4444444444444444, F1 0.39542288557213934, AUC 0.7293434343434343
  Second-Tier acc 0.5625, precision 0.5144927536231884, recall 0.393939393939394, F1 0.3373058866016612, AUC 0.7315151515151515
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.19424460431654678, recall 0.3333333333333333, F1 0.24545454545454545, AUC 0.7396445718204978
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7422288359788359
Test AUC: 0.7208, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021816290685056842
epoch: 3 idx: 0 First Loss : 2.3329906463623047, Second Loss : 3.1838862895965576
epoch: 3 idx: 200 First Loss : 0.9002735907517707, Second Loss : 0.9464555614400859
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4236111111111111, precision 0.38128342245989305, recall 0.45212121212121215, F1 0.32655417976518897, AUC 0.730117845117845
  Second-Tier acc 0.5625, precision 0.38578088578088576, recall 0.5296969696969697, F1 0.4213149319532299, AUC 0.7309090909090911
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.48299319727891155, precision 0.38032716315109777, recall 0.42210464432686656, F1 0.3527338802929354, AUC 0.7066309033901627
  Second-Tier acc 0.5510204081632653, precision 0.3849206349206349, recall 0.4594356261022927, F1 0.3968253968253968, AUC 0.7215057319223986
Test AUC: 0.7208, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00021816290685056842
epoch: 4 idx: 0 First Loss : 2.7514734268188477, Second Loss : 3.7430408000946045
epoch: 4 idx: 200 First Loss : 0.8900149081722458, Second Loss : 0.9430325650494193
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.7482547699214366
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7576262626262626
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.43537414965986393, precision 0.4305555555555556, recall 0.4200470311581423, F1 0.3116883116883117, AUC 0.6964836860670195
  Second-Tier acc 0.4489795918367347, precision 0.41414141414141414, recall 0.4091710758377425, F1 0.33543859649122804, AUC 0.7319223985890653
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 5 idx: 0 First Loss : 2.8444631099700928, Second Loss : 3.8993337154388428
epoch: 5 idx: 200 First Loss : 0.88439866170213, Second Loss : 0.9328935598417079
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3402777777777778, precision 0.35537634408602153, recall 0.40444444444444444, F1 0.25240809028941785, AUC 0.7346408529741865
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.7267676767676767
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.44623655913978494, recall 0.4238683127572016, F1 0.3110695208016532, AUC 0.6638435724083872
  Second-Tier acc 0.4489795918367347, precision 0.4473684210526316, recall 0.42063492063492064, F1 0.3333333333333333, AUC 0.6958774250440917
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 6 idx: 0 First Loss : 2.8053953647613525, Second Loss : 3.984133005142212
epoch: 6 idx: 200 First Loss : 0.8823104996780925, Second Loss : 0.9304092857414458
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3402777777777778, precision 0.35537634408602153, recall 0.40444444444444444, F1 0.25240809028941785, AUC 0.6987934904601572
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.7129292929292929
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.41496598639455784, precision 0.4444444444444444, recall 0.4115226337448559, F1 0.29333333333333333, AUC 0.6513203017832648
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6647927689594356
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 7 idx: 0 First Loss : 2.88212513923645, Second Loss : 3.8379032611846924
epoch: 7 idx: 200 First Loss : 0.8763488756906269, Second Loss : 0.9201919458724271
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3125, precision 0.35260416666666666, recall 0.38666666666666666, F1 0.22553485162180817, AUC 0.6733333333333332
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6969696969696969
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.38095238095238093, precision 0.44020356234096686, recall 0.3909465020576131, F1 0.2600953250177467, AUC 0.6431572114442485
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6646274250440918
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 8 idx: 0 First Loss : 3.055694580078125, Second Loss : 3.857038736343384
epoch: 8 idx: 200 First Loss : 0.8753512581660926, Second Loss : 0.9168669805333217
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.6616442199775533
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6826262626262626
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3945578231292517, precision 0.44020356234096686, recall 0.3991769547325103, F1 0.27181534672149055, AUC 0.6446085635900451
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6577380952380952
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 9 idx: 0 First Loss : 3.1478097438812256, Second Loss : 3.9091906547546387
epoch: 9 idx: 200 First Loss : 0.8775491812222971, Second Loss : 0.920081411644733
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6629180695847362
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6828787878787878
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6395502645502645
  Second-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6702491181657848
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 10 idx: 0 First Loss : 2.9853973388671875, Second Loss : 3.752647876739502
epoch: 10 idx: 200 First Loss : 0.8715261936674835, Second Loss : 0.9077353363744313
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6582379349046016
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6739393939393938
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6433837938467568
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.6683752204585538
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 11 idx: 0 First Loss : 2.940675973892212, Second Loss : 3.5840976238250732
epoch: 11 idx: 200 First Loss : 0.8525879186075945, Second Loss : 0.8990294990240971
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.662631874298541
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6733333333333332
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.4435695538057743, recall 0.4156378600823045, F1 0.2976936746929131, AUC 0.6484114736429551
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.6686507936507936
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 12 idx: 0 First Loss : 2.836090087890625, Second Loss : 3.505901575088501
epoch: 12 idx: 200 First Loss : 0.8403260337487987, Second Loss : 0.8896316245127445
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4097222222222222, precision 0.3853801169590643, recall 0.4488888888888889, F1 0.31473922902494333, AUC 0.6650224466891134
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.6845454545454546
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.48299319727891155, precision 0.4229133439659756, recall 0.4488536155202822, F1 0.35065227170490326, AUC 0.6678608171663728
  Second-Tier acc 0.5306122448979592, precision 0.4373219373219373, recall 0.48148148148148145, F1 0.3866666666666667, AUC 0.6803350970017638
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 13 idx: 0 First Loss : 2.893237829208374, Second Loss : 3.7094123363494873
epoch: 13 idx: 200 First Loss : 0.8360198628747707, Second Loss : 0.8855548191844429
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3472222222222222, precision 0.3993558776167472, recall 0.4137037037037037, F1 0.27574416521784945, AUC 0.6558754208754208
  Second-Tier acc 0.3333333333333333, precision 0.41111111111111115, recall 0.4144444444444444, F1 0.28585858585858587, AUC 0.6717676767676769
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.42236467236467234, recall 0.4159318048206937, F1 0.3115902964959569, AUC 0.6610204781501078
  Second-Tier acc 0.40816326530612246, precision 0.5575757575757575, recall 0.4953703703703704, F1 0.362406015037594, AUC 0.6828703703703703
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 14 idx: 0 First Loss : 2.824556350708008, Second Loss : 3.5935115814208984
epoch: 14 idx: 200 First Loss : 0.8328040082136008, Second Loss : 0.891421644984676
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4097222222222222, precision 0.445361875637105, recall 0.45370370370370366, F1 0.32991989879657346, AUC 0.6553872053872054
  Second-Tier acc 0.375, precision 0.4411764705882353, recall 0.44111111111111106, F1 0.3230506822612086, AUC 0.6691919191919192
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.46258503401360546, precision 0.4014308426073132, recall 0.4288653733098178, F1 0.3380505825518613, AUC 0.6690794630609446
  Second-Tier acc 0.4897959183673469, precision 0.6095238095238095, recall 0.5447530864197531, F1 0.4610644257703081, AUC 0.6807208994708995
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 15 idx: 0 First Loss : 2.955244302749634, Second Loss : 4.015076637268066
epoch: 15 idx: 200 First Loss : 0.8259739881291873, Second Loss : 0.891762227735102
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.35683060109289616, recall 0.40444444444444444, F1 0.2542161856253537, AUC 0.6578787878787878
  Second-Tier acc 0.3125, precision 0.3914141414141414, recall 0.40111111111111114, F1 0.26461769115442274, AUC 0.6733333333333333
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.42142076502732245, recall 0.4279835390946502, F1 0.31538579536738764, AUC 0.6663604742308445
  Second-Tier acc 0.40816326530612246, precision 0.562962962962963, recall 0.4953703703703704, F1 0.3644444444444444, AUC 0.6891534391534391
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 16 idx: 0 First Loss : 2.9424808025360107, Second Loss : 3.8132660388946533
epoch: 16 idx: 200 First Loss : 0.826181092571582, Second Loss : 0.8919940202142053
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.375, precision 0.4009174311926606, recall 0.4314814814814814, F1 0.30275566442131047, AUC 0.6585353535353535
  Second-Tier acc 0.2916666666666667, precision 0.35784313725490197, recall 0.37333333333333335, F1 0.23192848020434229, AUC 0.672979797979798
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.43537414965986393, precision 0.40404040404040403, recall 0.40858318636096413, F1 0.3228228228228228, AUC 0.6733906525573192
  Second-Tier acc 0.3877551020408163, precision 0.5594594594594595, recall 0.48302469135802467, F1 0.3400946585530764, AUC 0.6819885361552028
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 17 idx: 0 First Loss : 2.9189460277557373, Second Loss : 3.732980966567993
epoch: 17 idx: 200 First Loss : 0.8241965212714898, Second Loss : 0.8883711911525554
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.5, precision 0.3854166666666667, recall 0.5066666666666667, F1 0.381924749480053, AUC 0.6646071829405162
  Second-Tier acc 0.3125, precision 0.3685185185185185, recall 0.38666666666666666, F1 0.24491725768321512, AUC 0.6717676767676767
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.48299319727891155, precision 0.3506747638326586, recall 0.4297472075249853, F1 0.35062107824305294, AUC 0.6753747795414462
  Second-Tier acc 0.40816326530612246, precision 0.5705705705705706, recall 0.4953703703703704, F1 0.3673202614379085, AUC 0.6746031746031745
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 18 idx: 0 First Loss : 2.9285316467285156, Second Loss : 3.841857671737671
epoch: 18 idx: 200 First Loss : 0.8236880103930034, Second Loss : 0.8845803543191861
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3958333333333333, precision 0.44753086419753085, recall 0.44962962962962966, F1 0.3294488480971585, AUC 0.6621604938271605
  Second-Tier acc 0.2916666666666667, precision 0.35185185185185186, recall 0.37333333333333335, F1 0.22499388603570555, AUC 0.6678282828282828
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.43920454545454546, recall 0.4104203409758966, F1 0.332761832870244, AUC 0.673623358808544
  Second-Tier acc 0.3673469387755102, precision 0.5446127946127947, recall 0.45921516754850095, F1 0.32457350272232305, AUC 0.675650352733686
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4)
Current LR: 0.00021816290685056842
epoch: 19 idx: 0 First Loss : 2.9542324542999268, Second Loss : 3.763747215270996
epoch: 19 idx: 200 First Loss : 0.8142536620604702, Second Loss : 0.8827265684024155
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3680555555555556, precision 0.40885306925129933, recall 0.42703703703703705, F1 0.2941349354219695, AUC 0.661705948372615
  Second-Tier acc 0.2916666666666667, precision 0.35185185185185186, recall 0.37333333333333335, F1 0.22499388603570555, AUC 0.6586868686868687
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.40816326530612246, precision 0.4611111111111111, recall 0.41166960611405057, F1 0.3298459925818416, AUC 0.6742908583186361
  Second-Tier acc 0.3673469387755102, precision 0.5446127946127947, recall 0.45921516754850095, F1 0.32457350272232305, AUC 0.6825396825396824
Test AUC: 0.7319, Test F1: 0.3354 (Best Epoch: 4){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.3610119794633575, "droprate_2": 0.0, "lr": 1.3119539111485342e-05, "weight_decay": 0.0001103881697819722, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.3119539111485342e-05
epoch: 0 idx: 0 First Loss : 1.2331303358078003, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0644520490027185, Second Loss : 1.0464615864836755
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6763131313131313
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7456060606060606
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6149875073486185
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.615189594356261
Test AUC: 0.6152, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.3119539111485342e-05
epoch: 1 idx: 0 First Loss : 2.0460779666900635, Second Loss : 1.9986238479614258
epoch: 1 idx: 200 First Loss : 1.109364550801652, Second Loss : 1.0956778037755643
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7152132435465769
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7563131313131314
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.664186507936508
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.667713844797178
Test AUC: 0.6677, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.3119539111485342e-05
epoch: 2 idx: 0 First Loss : 2.1151742935180664, Second Loss : 2.1014621257781982
epoch: 2 idx: 200 First Loss : 1.0956610175062769, Second Loss : 1.0843198906574676
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7282603815937149
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7615151515151516
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6919091710758377
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7001763668430335
Test AUC: 0.7002, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.3119539111485342e-05
epoch: 3 idx: 0 First Loss : 2.2020018100738525, Second Loss : 2.1741795539855957
epoch: 3 idx: 200 First Loss : 1.0828809031651387, Second Loss : 1.0701927657595915
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.739236812570146
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7621212121212121
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7040711346266902
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7094356261022927
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 4 idx: 0 First Loss : 2.2798101902008057, Second Loss : 2.2531116008758545
epoch: 4 idx: 200 First Loss : 1.067615567192213, Second Loss : 1.0546629021120308
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7401290684624017
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7524747474747474
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7121056241426612
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7128527336860669
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 5 idx: 0 First Loss : 2.3701868057250977, Second Loss : 2.3390448093414307
epoch: 5 idx: 200 First Loss : 1.0505300278761494, Second Loss : 1.0388931060089401
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5763888888888888, precision 0.5171568627450981, recall 0.41414141414141414, F1 0.3670481254575579, AUC 0.7357687991021323
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7514141414141413
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.564625850340136, precision 0.5195402298850574, recall 0.3611111111111111, F1 0.29022010437939644, AUC 0.7126751420732903
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7141754850088183
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 6 idx: 0 First Loss : 2.4768645763397217, Second Loss : 2.448843002319336
epoch: 6 idx: 200 First Loss : 1.0306568004895205, Second Loss : 1.0214898591833328
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.6319444444444444, precision 0.6571889493849566, recall 0.5068686868686869, F1 0.5068644560791157, AUC 0.7337037037037036
  Second-Tier acc 0.625, precision 0.41052631578947363, recall 0.5018181818181818, F1 0.4444444444444444, AUC 0.7529292929292929
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6530612244897959, precision 0.7301202734273601, recall 0.5216784244562022, F1 0.5226356654928084, AUC 0.7036730844601214
  Second-Tier acc 0.5918367346938775, precision 0.33638211382113825, recall 0.3924162257495591, F1 0.3458110516934046, AUC 0.7109788359788359
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 7 idx: 0 First Loss : 2.603017807006836, Second Loss : 2.5732102394104004
epoch: 7 idx: 200 First Loss : 1.0105399078138135, Second Loss : 1.0029745769700897
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6736111111111112, precision 0.6308275058275058, recall 0.5994949494949495, F1 0.6094542177520238, AUC 0.7321436588103255
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7541919191919192
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.5714285714285714, precision 0.5222203956381172, recall 0.5496031746031745, F1 0.5278248587570622, AUC 0.7028831079757006
  Second-Tier acc 0.5918367346938775, precision 0.5361111111111111, recall 0.531305114638448, F1 0.5208647561588738, AUC 0.7128527336860669
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 8 idx: 0 First Loss : 2.742480993270874, Second Loss : 2.713118553161621
epoch: 8 idx: 200 First Loss : 0.9914153810794377, Second Loss : 0.9854998661029102
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.5555555555555556, precision 0.5112368809090121, recall 0.5155218855218856, F1 0.4916946004626361, AUC 0.7261616161616162
  Second-Tier acc 0.6041666666666666, precision 0.5757575757575758, recall 0.5682828282828283, F1 0.5204706640876854, AUC 0.7468181818181817
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5034013605442177, precision 0.45384615384615384, recall 0.49529688418577306, F1 0.44742850276375873, AUC 0.7044691847932588
  Second-Tier acc 0.6122448979591837, precision 0.5927536231884059, recall 0.5844356261022927, F1 0.5680056956652701, AUC 0.728505291005291
Test AUC: 0.7094, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.3119539111485342e-05
epoch: 9 idx: 0 First Loss : 2.8805248737335205, Second Loss : 2.8593807220458984
epoch: 9 idx: 200 First Loss : 0.9751742366163885, Second Loss : 0.9710680947486144
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5069444444444444, precision 0.49337629788757603, recall 0.49319865319865325, F1 0.4532671629445823, AUC 0.7299382716049383
  Second-Tier acc 0.5, precision 0.5702260702260702, recall 0.5474747474747474, F1 0.4831094831094831, AUC 0.7664646464646466
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46258503401360546, precision 0.45066413662239085, recall 0.5097001763668431, F1 0.43095582508067204, AUC 0.7096377131099354
  Second-Tier acc 0.5918367346938775, precision 0.6003205128205128, recall 0.6664462081128748, F1 0.6002431980544155, AUC 0.7461970899470899
Test AUC: 0.7462, Test F1: 0.6002 (Best Epoch: 9)
Current LR: 1.3119539111485342e-05
epoch: 10 idx: 0 First Loss : 3.0061848163604736, Second Loss : 3.0008232593536377
epoch: 10 idx: 200 First Loss : 0.9624842184211188, Second Loss : 0.9600252696122993
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4652777777777778, precision 0.5010250286112355, recall 0.4866329966329966, F1 0.4286277408228627, AUC 0.7314197530864197
  Second-Tier acc 0.5208333333333334, precision 0.5871794871794872, recall 0.5896969696969697, F1 0.5166137566137566, AUC 0.7805050505050505
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4489795918367347, precision 0.4832997582594681, recall 0.5286596119929453, F1 0.4295121590292507, AUC 0.7168577307466196
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7567791005291005
Test AUC: 0.7568, Test F1: 0.5624 (Best Epoch: 10)
Current LR: 1.3119539111485342e-05
epoch: 11 idx: 0 First Loss : 3.1190576553344727, Second Loss : 3.1201415061950684
epoch: 11 idx: 200 First Loss : 0.9531963850876585, Second Loss : 0.9520105260299213
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4444444444444444, precision 0.49920817369093234, recall 0.4781144781144781, F1 0.41002834968352203, AUC 0.7386363636363636
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.8005050505050505
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.46546636759326016, recall 0.5121987066431511, F1 0.4081115810497254, AUC 0.7202809621791104
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7675264550264552
Test AUC: 0.7675, Test F1: 0.5455 (Best Epoch: 11)
Current LR: 1.3119539111485342e-05
epoch: 12 idx: 0 First Loss : 3.212029218673706, Second Loss : 3.2250585556030273
epoch: 12 idx: 200 First Loss : 0.946029743128711, Second Loss : 0.9460656407303107
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4166666666666667, precision 0.48050642168289226, recall 0.45636363636363636, F1 0.3913118584585731, AUC 0.7438552188552189
  Second-Tier acc 0.5, precision 0.5805555555555556, recall 0.5908080808080808, F1 0.4994388327721661, AUC 0.8025757575757576
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4217687074829932, precision 0.47733698130414953, recall 0.5062463256907701, F1 0.411169759300575, AUC 0.7248983441113072
  Second-Tier acc 0.5306122448979592, precision 0.6155157715260017, recall 0.6408730158730159, F1 0.5335135135135135, AUC 0.7730379188712523
Test AUC: 0.7730, Test F1: 0.5335 (Best Epoch: 12)
Current LR: 1.3119539111485342e-05
epoch: 13 idx: 0 First Loss : 3.288909912109375, Second Loss : 3.3173649311065674
epoch: 13 idx: 200 First Loss : 0.9404414725485281, Second Loss : 0.9412728719394746
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4236111111111111, precision 0.5033068783068783, recall 0.47212121212121216, F1 0.4046991655687308, AUC 0.7445061728395063
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.807878787878788
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.5099616858237548, recall 0.5256466784244562, F1 0.425030446307042, AUC 0.730893592004703
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7719907407407408
Test AUC: 0.7720, Test F1: 0.5120 (Best Epoch: 13)
Current LR: 1.3119539111485342e-05
epoch: 14 idx: 0 First Loss : 3.3466079235076904, Second Loss : 3.390817165374756
epoch: 14 idx: 200 First Loss : 0.9357651331142258, Second Loss : 0.9371620892542437
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4166666666666667, precision 0.5057413600891861, recall 0.4846464646464647, F1 0.40444148345547415, AUC 0.7485241301907969
  Second-Tier acc 0.4583333333333333, precision 0.545778697952611, recall 0.5471717171717172, F1 0.45702614379084966, AUC 0.8130808080808082
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.5420792808723843, recall 0.5450470311581422, F1 0.4366684501515962, AUC 0.7360498726239467
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7765101410934744
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.3119539111485342e-05
epoch: 15 idx: 0 First Loss : 3.3920772075653076, Second Loss : 3.447190284729004
epoch: 15 idx: 200 First Loss : 0.9311251335763442, Second Loss : 0.9334634034153055
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3888888888888889, precision 0.4893868260065443, recall 0.4580808080808081, F1 0.3818117868464567, AUC 0.7511447811447812
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.808030303030303
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.546957671957672, recall 0.5470311581422692, F1 0.4444444444444445, AUC 0.7393138839898099
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7808641975308642
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.3119539111485342e-05
epoch: 16 idx: 0 First Loss : 3.428060531616211, Second Loss : 3.4934558868408203
epoch: 16 idx: 200 First Loss : 0.9271885162886622, Second Loss : 0.9300068467994457
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4166666666666667, precision 0.515370018975332, recall 0.504983164983165, F1 0.41341731427147294, AUC 0.7547755331088665
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.807020202020202
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.43537414965986393, precision 0.5607555443123365, recall 0.5467372134038802, F1 0.43857025511652653, AUC 0.7402630805408584
  Second-Tier acc 0.5102040816326531, precision 0.607890499194847, recall 0.6285273368606702, F1 0.512048312048312, AUC 0.7848324514991182
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.3119539111485342e-05
epoch: 17 idx: 0 First Loss : 3.4534084796905518, Second Loss : 3.525831937789917
epoch: 17 idx: 200 First Loss : 0.9227289603165911, Second Loss : 0.9262598871290498
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5235838779956427, recall 0.5184511784511785, F1 0.4213515952646387, AUC 0.7559203142536476
  Second-Tier acc 0.4166666666666667, precision 0.5158730158730159, recall 0.5085858585858586, F1 0.4066721808657292, AUC 0.8071212121212121
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5784117450784118, recall 0.5702527924750148, F1 0.4527792513999411, AUC 0.7454377327062511
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.788745590828924
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.3119539111485342e-05
epoch: 18 idx: 0 First Loss : 3.4720823764801025, Second Loss : 3.546844959259033
epoch: 18 idx: 200 First Loss : 0.9186124070385351, Second Loss : 0.9227646249207432
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4444444444444444, precision 0.5412668048249111, recall 0.5512794612794614, F1 0.4375380211129003, AUC 0.7569472502805836
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.8013636363636364
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.46938775510204084, precision 0.5933867217773184, recall 0.5881099353321576, F1 0.47098154647345175, AUC 0.7494488536155203
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7885802469135802
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14)
Current LR: 1.3119539111485342e-05
epoch: 19 idx: 0 First Loss : 3.4768259525299072, Second Loss : 3.5524370670318604
epoch: 19 idx: 200 First Loss : 0.9145665247947793, Second Loss : 0.9190268235533633
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4375, precision 0.5360720660419456, recall 0.5468350168350168, F1 0.4297776156013704, AUC 0.7551346801346801
  Second-Tier acc 0.3958333333333333, precision 0.49528440907751253, recall 0.4808080808080808, F1 0.38086021505376344, AUC 0.7967676767676769
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4489795918367347, precision 0.5789609053497943, recall 0.5562169312169313, F1 0.4466412088363308, AUC 0.7542621987066432
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7911706349206349
Test AUC: 0.7765, Test F1: 0.5120 (Best Epoch: 14){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.24138068006427416, "droprate_2": 0.0, "lr": 8.977319697162506e-05, "weight_decay": 0.0005418906173158051, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 8.977319697162506e-05
epoch: 0 idx: 0 First Loss : 1.2441092729568481, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.109646942929842, Second Loss : 1.1081869456157163
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7446801346801347
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7591414141414141
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7085537918871253
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7041446208112875
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.977319697162506e-05
epoch: 1 idx: 0 First Loss : 1.9942296743392944, Second Loss : 1.9867746829986572
epoch: 1 idx: 200 First Loss : 1.0048278571657874, Second Loss : 1.0151761492983025
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.739668911335578
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7516666666666666
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7235021066039584
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7264109347442681
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.977319697162506e-05
epoch: 2 idx: 0 First Loss : 2.4788191318511963, Second Loss : 2.304220199584961
epoch: 2 idx: 200 First Loss : 0.9562851932659671, Second Loss : 0.9670135643500001
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.6319444444444444, precision 0.5049486461251167, recall 0.5215488215488217, F1 0.4809357457343731, AUC 0.7330695847362514
  Second-Tier acc 0.6666666666666666, precision 0.440422322775264, recall 0.5624242424242424, F1 0.4934086629001883, AUC 0.7399999999999999
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.7142857142857143, precision 0.7676719576719577, recall 0.6241181657848324, F1 0.6617746688445824, AUC 0.7178252988438173
  Second-Tier acc 0.7346938775510204, precision 0.8201754385964911, recall 0.6011904761904762, F1 0.6405594405594406, AUC 0.7191909171075839
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.977319697162506e-05
epoch: 3 idx: 0 First Loss : 3.1723709106445312, Second Loss : 3.0087411403656006
epoch: 3 idx: 200 First Loss : 0.925871808109666, Second Loss : 0.9415369529962836
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5069444444444444, precision 0.5540935672514621, recall 0.5284511784511784, F1 0.492120344443517, AUC 0.7338439955106622
  Second-Tier acc 0.4166666666666667, precision 0.5147058823529412, recall 0.45080808080808077, F1 0.3579293579293579, AUC 0.7484343434343433
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5374149659863946, precision 0.5654079063754508, recall 0.5846560846560847, F1 0.5457992775485169, AUC 0.7251126788163824
  Second-Tier acc 0.5714285714285714, precision 0.610312273057371, recall 0.5597442680776014, F1 0.5448291545852522, AUC 0.7558972663139331
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.977319697162506e-05
epoch: 4 idx: 0 First Loss : 3.8635520935058594, Second Loss : 3.8039917945861816
epoch: 4 idx: 200 First Loss : 0.922162428366215, Second Loss : 0.9416845618186528
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3958333333333333, precision 0.5142555039462257, recall 0.4437373737373737, F1 0.3838110126802154, AUC 0.7322053872053873
  Second-Tier acc 0.3958333333333333, precision 0.553053053053053, recall 0.4374747474747474, F1 0.34337068160597567, AUC 0.7580808080808081
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5102040816326531, precision 0.5854307191516493, recall 0.5775279247501469, F1 0.5227170490328384, AUC 0.729907652361356
  Second-Tier acc 0.5306122448979592, precision 0.6110835401157981, recall 0.5465167548500881, F1 0.514957264957265, AUC 0.7662588183421516
Test AUC: 0.7041, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 8.977319697162506e-05
epoch: 5 idx: 0 First Loss : 4.121869087219238, Second Loss : 4.1086530685424805
epoch: 5 idx: 200 First Loss : 0.9198029302315444, Second Loss : 0.9406595035242983
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3888888888888889, precision 0.4942279942279943, recall 0.44579124579124585, F1 0.36912779634548515, AUC 0.7384680134680135
  Second-Tier acc 0.3958333333333333, precision 0.5509259259259259, recall 0.4519191919191919, F1 0.3665914463786804, AUC 0.7694444444444445
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.48299319727891155, precision 0.589855072463768, recall 0.5393885949441505, F1 0.4745350814063853, AUC 0.7374706055261612
  Second-Tier acc 0.5510204081632653, precision 0.6458333333333334, recall 0.611111111111111, F1 0.5362318840579711, AUC 0.7856040564373897
Test AUC: 0.7856, Test F1: 0.5362 (Best Epoch: 5)
Current LR: 8.977319697162506e-05
epoch: 6 idx: 0 First Loss : 4.200938701629639, Second Loss : 4.126286029815674
epoch: 6 idx: 200 First Loss : 0.9149411593955381, Second Loss : 0.936397414079946
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3680555555555556, precision 0.5511599511599512, recall 0.44148148148148153, F1 0.32096287229702164, AUC 0.7461111111111111
  Second-Tier acc 0.375, precision 0.46875, recall 0.4216161616161616, F1 0.34761569180173835, AUC 0.7706565656565657
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4489795918367347, precision 0.4902534113060429, recall 0.4380511463844798, F1 0.3477966477966478, AUC 0.7366806290417403
  Second-Tier acc 0.5102040816326531, precision 0.5924764890282131, recall 0.5634920634920635, F1 0.4930640554875561, AUC 0.7903439153439153
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 7 idx: 0 First Loss : 4.3981032371521, Second Loss : 4.175586223602295
epoch: 7 idx: 200 First Loss : 0.9106769174620027, Second Loss : 0.9357592954377955
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.375, precision 0.47434343434343434, recall 0.4482154882154881, F1 0.35122754725860855, AUC 0.7428058361391695
  Second-Tier acc 0.375, precision 0.47899159663865537, recall 0.4385858585858586, F1 0.34332358674463936, AUC 0.7638888888888888
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.5702087286527514, recall 0.5207965902410346, F1 0.43622776070710517, AUC 0.7405509014305309
  Second-Tier acc 0.4897959183673469, precision 0.5878787878787879, recall 0.5511463844797179, F1 0.4745500113921166, AUC 0.7734788359788359
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 8 idx: 0 First Loss : 4.208829879760742, Second Loss : 4.131559371948242
epoch: 8 idx: 200 First Loss : 0.9053439898636488, Second Loss : 0.9294538700035704
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3472222222222222, precision 0.45047306557031414, recall 0.41996632996632993, F1 0.32097181768944294, AUC 0.7228956228956229
  Second-Tier acc 0.375, precision 0.45743145743145747, recall 0.4385858585858586, F1 0.34557264050901376, AUC 0.7303535353535353
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.40816326530612246, precision 0.5331598226335069, recall 0.460978835978836, F1 0.38339984859509474, AUC 0.7186336468743876
  Second-Tier acc 0.46938775510204084, precision 0.5531135531135531, recall 0.5094797178130511, F1 0.43809523809523804, AUC 0.7614638447971781
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 9 idx: 0 First Loss : 4.16387414932251, Second Loss : 4.054744243621826
epoch: 9 idx: 200 First Loss : 0.903166638860428, Second Loss : 0.9250843847562578
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3333333333333333, precision 0.4267399267399267, recall 0.41757575757575766, F1 0.30239700374531836, AUC 0.7022671156004489
  Second-Tier acc 0.3333333333333333, precision 0.41527777777777786, recall 0.3974747474747475, F1 0.2928686717133829, AUC 0.7093939393939394
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.5138047138047138, recall 0.4226925338036449, F1 0.33964286412799, AUC 0.6969429747207525
  Second-Tier acc 0.42857142857142855, precision 0.5024509803921569, recall 0.43761022927689597, F1 0.35947712418300654, AUC 0.7243716931216931
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 10 idx: 0 First Loss : 4.048454284667969, Second Loss : 4.015621662139893
epoch: 10 idx: 200 First Loss : 0.9002140892897755, Second Loss : 0.922743468204819
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3194444444444444, precision 0.40250166949196076, recall 0.3998989898989899, F1 0.27100578058938934, AUC 0.6922222222222222
  Second-Tier acc 0.3541666666666667, precision 0.42728758169934644, recall 0.42777777777777776, F1 0.30382317801672637, AUC 0.6947474747474747
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3673469387755102, precision 0.4916666666666667, recall 0.39506172839506176, F1 0.31610496311200537, AUC 0.6801085145992554
  Second-Tier acc 0.40816326530612246, precision 0.4988095238095238, recall 0.42526455026455023, F1 0.3397495361781076, AUC 0.7096009700176366
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 11 idx: 0 First Loss : 4.043631553649902, Second Loss : 3.971640110015869
epoch: 11 idx: 200 First Loss : 0.9064271746534015, Second Loss : 0.9178866897110216
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3194444444444444, precision 0.3945682248434543, recall 0.4007407407407408, F1 0.26071839407560415, AUC 0.6811672278338946
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6956060606060607
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3741496598639456, precision 0.4803703703703704, recall 0.3949147560258672, F1 0.29878983172216256, AUC 0.6726557907113463
  Second-Tier acc 0.40816326530612246, precision 0.5013227513227513, recall 0.42526455026455023, F1 0.338989898989899, AUC 0.7005070546737214
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 12 idx: 0 First Loss : 4.030594348907471, Second Loss : 3.908602237701416
epoch: 12 idx: 200 First Loss : 0.9078715549818407, Second Loss : 0.9143732450914046
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3055555555555556, precision 0.3803030303030303, recall 0.3918518518518519, F1 0.2458001768346596, AUC 0.6776262626262626
  Second-Tier acc 0.3333333333333333, precision 0.4130952380952381, recall 0.4144444444444444, F1 0.2816425120772947, AUC 0.6936363636363637
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.3673469387755102, precision 0.4792660550458716, recall 0.3907995296884186, F1 0.29159489637760133, AUC 0.6698510679992161
  Second-Tier acc 0.40816326530612246, precision 0.5013227513227513, recall 0.42526455026455023, F1 0.338989898989899, AUC 0.6846340388007054
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 13 idx: 0 First Loss : 3.925703287124634, Second Loss : 3.7684662342071533
epoch: 13 idx: 200 First Loss : 0.9040667057778053, Second Loss : 0.9060442286873825
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2986111111111111, precision 0.37086900638302506, recall 0.3874074074074074, F1 0.24066373736291213, AUC 0.675213243546577
  Second-Tier acc 0.3333333333333333, precision 0.41613756613756614, recall 0.4144444444444444, F1 0.2800049769814607, AUC 0.6952020202020203
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.4755229194481531, recall 0.3787477954144621, F1 0.281684902382023, AUC 0.6679832941407016
  Second-Tier acc 0.40816326530612246, precision 0.5013227513227513, recall 0.42526455026455023, F1 0.338989898989899, AUC 0.6730048500881834
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 14 idx: 0 First Loss : 3.910923957824707, Second Loss : 3.894831895828247
epoch: 14 idx: 200 First Loss : 0.8979061671408312, Second Loss : 0.900906948452359
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.3803030303030303, recall 0.3918518518518519, F1 0.2458001768346596, AUC 0.6747306397306397
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6956565656565656
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.4772907464038963, recall 0.38256907701352144, F1 0.27803936624078557, AUC 0.6662869880462473
  Second-Tier acc 0.40816326530612246, precision 0.5070785070785071, recall 0.4367283950617284, F1 0.3316176470588235, AUC 0.6695326278659612
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 15 idx: 0 First Loss : 3.8164966106414795, Second Loss : 3.6994192600250244
epoch: 15 idx: 200 First Loss : 0.8895051965741891, Second Loss : 0.8954825428893616
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.3815476190476191, recall 0.3918518518518519, F1 0.2444991789819376, AUC 0.6718069584736251
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6936868686868687
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.4792368125701459, recall 0.38639035861258075, F1 0.2748424606009745, AUC 0.6684303350970019
  Second-Tier acc 0.40816326530612246, precision 0.5070785070785071, recall 0.4367283950617284, F1 0.3316176470588235, AUC 0.6773589065255731
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 16 idx: 0 First Loss : 3.7805745601654053, Second Loss : 3.719413995742798
epoch: 16 idx: 200 First Loss : 0.8834472238000011, Second Loss : 0.8923359151880712
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3125, precision 0.39079242619065635, recall 0.3962962962962963, F1 0.2511338652891164, AUC 0.669887766554433
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6900000000000001
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3673469387755102, precision 0.48313492063492064, recall 0.3984420928865373, F1 0.2849771001944915, AUC 0.6728762492651382
  Second-Tier acc 0.3673469387755102, precision 0.4964964964964966, recall 0.41203703703703703, F1 0.2888888888888889, AUC 0.6765873015873017
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 17 idx: 0 First Loss : 3.76446270942688, Second Loss : 3.6867270469665527
epoch: 17 idx: 200 First Loss : 0.8787832775598954, Second Loss : 0.8879527132200895
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3055555555555556, precision 0.3937190260719672, recall 0.3918518518518519, F1 0.24091324370038394, AUC 0.6683894500561167
  Second-Tier acc 0.2916666666666667, precision 0.3611111111111111, recall 0.3877777777777778, F1 0.23539344815940558, AUC 0.6913131313131314
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.35374149659863946, precision 0.4693766937669377, recall 0.3842592592592593, F1 0.2534576534576534, AUC 0.674970605526161
  Second-Tier acc 0.3673469387755102, precision 0.49780701754385964, recall 0.41203703703703703, F1 0.28782051282051285, AUC 0.6746582892416226
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 18 idx: 0 First Loss : 3.7120296955108643, Second Loss : 3.736532211303711
epoch: 18 idx: 200 First Loss : 0.8727936717863467, Second Loss : 0.8880247662971452
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3055555555555556, precision 0.40151515151515155, recall 0.3918518518518519, F1 0.2401914544247633, AUC 0.6695286195286195
  Second-Tier acc 0.2916666666666667, precision 0.362987987987988, recall 0.3877777777777778, F1 0.2337301587301587, AUC 0.6975757575757576
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3469387755102041, precision 0.4435695538057743, recall 0.3703703703703704, F1 0.23234714003944776, AUC 0.6799982853223595
  Second-Tier acc 0.3469387755102041, precision 0.4946581196581197, recall 0.3996913580246913, F1 0.26374430709173713, AUC 0.6833112874779541
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6)
Current LR: 8.977319697162506e-05
epoch: 19 idx: 0 First Loss : 3.584217071533203, Second Loss : 3.5372848510742188
epoch: 19 idx: 200 First Loss : 0.8679691527084659, Second Loss : 0.8778499802913156
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.4220430107526882, recall 0.3918518518518519, F1 0.23939593607944146, AUC 0.669388327721661
  Second-Tier acc 0.2916666666666667, precision 0.3717948717948718, recall 0.3877777777777778, F1 0.2313227513227513, AUC 0.6959090909090909
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3401360544217687, precision 0.441025641025641, recall 0.3662551440329218, F1 0.2227157913073774, AUC 0.6826315402704292
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6858465608465609
Test AUC: 0.7903, Test F1: 0.4931 (Best Epoch: 6){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.025101367497751235, "droprate_2": 0.0, "lr": 2.8944576517527432e-05, "weight_decay": 1.0439612163621597e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.10362743847671006, "droprate_2": 0.0, "lr": 1.0199434864500976e-05, "weight_decay": 3.101951561296034e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.0199434864500976e-05
epoch: 0 idx: 0 First Loss : 1.141993522644043, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.042282883059326, Second Loss : 1.0506080697424969
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7462401795735129
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.673888888888889
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6472479423868313
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.5625551146384479
Test AUC: 0.5626, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.0199434864500976e-05
epoch: 1 idx: 0 First Loss : 1.8061801195144653, Second Loss : 1.8811864852905273
epoch: 1 idx: 200 First Loss : 1.0878222933159538, Second Loss : 1.094487995798908
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7536644219977554
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.708989898989899
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6712289339604154
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6305114638447972
Test AUC: 0.6305, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.0199434864500976e-05
epoch: 2 idx: 0 First Loss : 1.9886103868484497, Second Loss : 2.0530595779418945
epoch: 2 idx: 200 First Loss : 1.082153398154387, Second Loss : 1.0906427954115085
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.760813692480359
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7256060606060606
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6875857338820303
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6624779541446207
Test AUC: 0.6625, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.0199434864500976e-05
epoch: 3 idx: 0 First Loss : 2.050056219100952, Second Loss : 2.124194383621216
epoch: 3 idx: 200 First Loss : 1.0710564582650342, Second Loss : 1.0808039498862936
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7591806958473626
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444949494949494
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7026565255731922
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6825396825396824
Test AUC: 0.6825, Test F1: 0.2368 (Best Epoch: 3)
Current LR: 1.0199434864500976e-05
epoch: 4 idx: 0 First Loss : 2.101651430130005, Second Loss : 2.1872076988220215
epoch: 4 idx: 200 First Loss : 1.0599831036519056, Second Loss : 1.0707203799219274
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7554377104377105
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7468686868686869
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7122587203605723
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002314814814815
Test AUC: 0.7002, Test F1: 0.2368 (Best Epoch: 4)
Current LR: 1.0199434864500976e-05
epoch: 5 idx: 0 First Loss : 2.1530444622039795, Second Loss : 2.2587904930114746
epoch: 5 idx: 200 First Loss : 1.0493488361438115, Second Loss : 1.0602732655865637
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7518911335578004
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7477777777777778
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.719637958063884
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7104828042328043
Test AUC: 0.7105, Test F1: 0.2368 (Best Epoch: 5)
Current LR: 1.0199434864500976e-05
epoch: 6 idx: 0 First Loss : 2.217768907546997, Second Loss : 2.337289333343506
epoch: 6 idx: 200 First Loss : 1.0377286231858813, Second Loss : 1.0484938172262106
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5902777777777778, precision 0.42689516751582524, recall 0.44565656565656564, F1 0.40092409240924093, AUC 0.7508193041526375
  Second-Tier acc 0.5208333333333334, precision 0.18115942028985507, recall 0.3333333333333333, F1 0.23474178403755866, AUC 0.7473737373737374
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5714285714285714, precision 0.29708029197080293, recall 0.35714285714285715, F1 0.2861679604798871, AUC 0.7239613952576915
  Second-Tier acc 0.5714285714285714, precision 0.5208333333333334, recall 0.375, F1 0.31407407407407406, AUC 0.7146715167548501
Test AUC: 0.7105, Test F1: 0.2368 (Best Epoch: 5)
Current LR: 1.0199434864500976e-05
epoch: 7 idx: 0 First Loss : 2.301767110824585, Second Loss : 2.4293019771575928
epoch: 7 idx: 200 First Loss : 1.0248109164522654, Second Loss : 1.0347596197875577
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6458333333333334, precision 0.42406417112299466, recall 0.5321212121212121, F1 0.4684146833400565, AUC 0.752732884399551
  Second-Tier acc 0.6041666666666666, precision 0.6813186813186812, recall 0.46393939393939393, F1 0.45782726045883937, AUC 0.7488383838383837
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6190476190476191, precision 0.37324929971988796, recall 0.42416225749559083, F1 0.3838095238095238, AUC 0.7200360082304527
  Second-Tier acc 0.6530612244897959, precision 0.7698412698412698, recall 0.5238095238095238, F1 0.49579020013802627, AUC 0.7209545855379188
Test AUC: 0.7210, Test F1: 0.4958 (Best Epoch: 7)
Current LR: 1.0199434864500976e-05
epoch: 8 idx: 0 First Loss : 2.3943657875061035, Second Loss : 2.531524896621704
epoch: 8 idx: 200 First Loss : 1.0110018768194895, Second Loss : 1.0203452678906977
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6666666666666666, precision 0.7590934924694516, recall 0.5898653198653198, F1 0.5077053101005197, AUC 0.7557856341189675
  Second-Tier acc 0.6458333333333334, precision 0.5887896825396826, recall 0.5415151515151515, F1 0.5494291283764968, AUC 0.7531313131313131
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.5782312925170068, precision 0.6988610178418592, recall 0.474647266313933, F1 0.46759368888187264, AUC 0.7170536939055457
  Second-Tier acc 0.6122448979591837, precision 0.5632183908045977, recall 0.574294532627866, F1 0.5621693121693122, AUC 0.7193011463844797
Test AUC: 0.7193, Test F1: 0.5622 (Best Epoch: 8)
Current LR: 1.0199434864500976e-05
epoch: 9 idx: 0 First Loss : 2.489582061767578, Second Loss : 2.638618230819702
epoch: 9 idx: 200 First Loss : 0.9976370543686311, Second Loss : 1.0041568030172319
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6111111111111112, precision 0.733703924293561, recall 0.5647811447811447, F1 0.48138695971513307, AUC 0.7652469135802469
  Second-Tier acc 0.6875, precision 0.6628815628815629, recall 0.6259595959595959, F1 0.6325344952795934, AUC 0.7610606060606061
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5850340136054422, precision 0.7236842105263158, recall 0.5055114638447972, F1 0.4830529539891388, AUC 0.7312059082892416
  Second-Tier acc 0.5714285714285714, precision 0.5372960372960373, recall 0.5725308641975309, F1 0.5430839002267573, AUC 0.7305445326278659
Test AUC: 0.7305, Test F1: 0.5431 (Best Epoch: 9)
Current LR: 1.0199434864500976e-05
epoch: 10 idx: 0 First Loss : 2.5962436199188232, Second Loss : 2.756199598312378
epoch: 10 idx: 200 First Loss : 0.9852176029327794, Second Loss : 0.989554996236195
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5555555555555556, precision 0.5468069787690041, recall 0.5501683501683502, F1 0.4727907023708551, AUC 0.7741582491582492
  Second-Tier acc 0.6041666666666666, precision 0.587719298245614, recall 0.6015151515151514, F1 0.5795512730996601, AUC 0.7542424242424243
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.564625850340136, precision 0.6244824553602308, recall 0.512713109935332, F1 0.49979786297988765, AUC 0.7370174407211444
  Second-Tier acc 0.5918367346938775, precision 0.5693922305764411, recall 0.6320546737213404, F1 0.5691856452726017, AUC 0.7452050264550264
Test AUC: 0.7305, Test F1: 0.5431 (Best Epoch: 9)
Current LR: 1.0199434864500976e-05
epoch: 11 idx: 0 First Loss : 2.7047882080078125, Second Loss : 2.8720808029174805
epoch: 11 idx: 200 First Loss : 0.973985467347043, Second Loss : 0.9769867751840039
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5277777777777778, precision 0.5600529100529101, recall 0.5468350168350169, F1 0.4792525557231439, AUC 0.7845061728395062
  Second-Tier acc 0.6041666666666666, precision 0.6282051282051282, recall 0.6473737373737373, F1 0.5928792569659443, AUC 0.7645959595959596
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.5170068027210885, precision 0.5407209037461138, recall 0.4898589065255732, F1 0.47083776690075907, AUC 0.7439986282578875
  Second-Tier acc 0.5510204081632653, precision 0.5453431372549019, recall 0.607363315696649, F1 0.5398989898989899, AUC 0.7550154320987654
Test AUC: 0.7550, Test F1: 0.5399 (Best Epoch: 11)
Current LR: 1.0199434864500976e-05
epoch: 12 idx: 0 First Loss : 2.804724931716919, Second Loss : 2.9810426235198975
epoch: 12 idx: 200 First Loss : 0.9646313821164826, Second Loss : 0.9665293399596688
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4791666666666667, precision 0.5267379679144385, recall 0.5261952861952862, F1 0.4456325935144491, AUC 0.7914309764309765
  Second-Tier acc 0.5416666666666666, precision 0.5927536231884059, recall 0.6073737373737373, F1 0.5347985347985348, AUC 0.7782323232323233
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.48299319727891155, precision 0.5118112014453479, recall 0.4731040564373898, F1 0.44194403046862063, AUC 0.755952380952381
  Second-Tier acc 0.4897959183673469, precision 0.5102707749766573, recall 0.5703262786596119, F1 0.49052845528455286, AUC 0.7608024691358025
Test AUC: 0.7608, Test F1: 0.4905 (Best Epoch: 12)
Current LR: 1.0199434864500976e-05
epoch: 13 idx: 0 First Loss : 2.8966541290283203, Second Loss : 3.0804333686828613
epoch: 13 idx: 200 First Loss : 0.9572715736202785, Second Loss : 0.9583727751965102
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4861111111111111, precision 0.5582013685239492, recall 0.5450841750841751, F1 0.4663384399345933, AUC 0.7958249158249159
  Second-Tier acc 0.5208333333333334, precision 0.5824074074074074, recall 0.594040404040404, F1 0.5144126026478968, AUC 0.7873737373737374
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.48299319727891155, precision 0.5347763347763348, recall 0.5062463256907701, F1 0.463768115942029, AUC 0.7622905643738976
  Second-Tier acc 0.46938775510204084, precision 0.49715099715099714, recall 0.5579805996472663, F1 0.4711538461538461, AUC 0.7647156084656084
Test AUC: 0.7647, Test F1: 0.4712 (Best Epoch: 13)
Current LR: 1.0199434864500976e-05
epoch: 14 idx: 0 First Loss : 2.9787209033966064, Second Loss : 3.168015718460083
epoch: 14 idx: 200 First Loss : 0.95235686808528, Second Loss : 0.9518131224151275
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4652777777777778, precision 0.5495970695970696, recall 0.5317508417508418, F1 0.44760139581290354, AUC 0.7987598204264871
  Second-Tier acc 0.5208333333333334, precision 0.5824074074074074, recall 0.594040404040404, F1 0.5144126026478968, AUC 0.7940404040404041
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4897959183673469, precision 0.5467981199970625, recall 0.520135214579659, F1 0.4749437622155843, AUC 0.764862580834803
  Second-Tier acc 0.5102040816326531, precision 0.5483660130718954, recall 0.605599647266314, F1 0.5144695827048769, AUC 0.763833774250441
Test AUC: 0.7638, Test F1: 0.5145 (Best Epoch: 14){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.13930129461962204, "droprate_2": 0.0, "lr": 1.638628162200869e-05, "weight_decay": 0.00039036894460427635, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1574887037277222, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0639630427111442, Second Loss : 1.0722905836295133
>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.74831088664422
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7026262626262626{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.03142157850644162, "droprate_2": 0.0, "lr": 0.00045772323366858616, "weight_decay": 3.7038266536613595e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.2161719287480691, "droprate_2": 0.0, "lr": 0.0007125873417786715, "weight_decay": 0.00012001042561494685, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.1414406007442813, "droprate_2": 0.0, "lr": 0.0001385982815095728, "weight_decay": 8.250069026382306e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.29849124933203797, "droprate_2": 0.0, "lr": 0.0006480024827403666, "weight_decay": 2.2981223516243382e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.10505389104260121, "droprate_2": 0.0, "lr": 0.00016072073055187506, "weight_decay": 0.0002790062579011181, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1409457921981812, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0851265883712626, Second Loss : 1.0877923602191963{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.21615339734531158, "droprate_2": 0.0, "lr": 0.0003413327981253564, "weight_decay": 2.6245574347133493e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0907996892929077, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0753091479563595, Second Loss : 1.078139059542127
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7362563131313132
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7424242424242425
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7292975639329806
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7232694003527337
epoch: 1 idx: 0 First Loss : 1.7200371026992798, Second Loss : 1.748693585395813
epoch: 1 idx: 200 First Loss : 0.9772107984444395, Second Loss : 0.9719113198234074
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7207417929292929
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7209090909090908
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7152157738095237
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7125771604938271
epoch: 2 idx: 0 First Loss : 2.4531893730163574, Second Loss : 2.3053512573242188
epoch: 2 idx: 200 First Loss : 0.9546478484103929, Second Loss : 0.9442821963138841
  First-Tier acc 0.6041666666666666, precision 0.38317792870572887, recall 0.5266666666666667, F1 0.4406978105608242, AUC 0.7042897727272727
  Second-Tier acc 0.6458333333333334, precision 0.41010101010101013, recall 0.5490909090909092, F1 0.46949602122015915, AUC 0.7059090909090909
  First-Tier acc 0.5357142857142857, precision 0.337172243951905, recall 0.40432098765432095, F1 0.36644212565491124, AUC 0.6981681272045855
  Second-Tier acc 0.5714285714285714, precision 0.692857142857143, recall 0.46671075837742504, F1 0.4612398494751437, AUC 0.691247795414462
epoch: 3 idx: 0 First Loss : 3.6087679862976074, Second Loss : 3.5337915420532227
epoch: 3 idx: 200 First Loss : 0.9373190198603332, Second Loss : 0.9411172658964917
  First-Tier acc 0.4114583333333333, precision 0.36957411957411956, recall 0.4457575757575758, F1 0.31597222222222227, AUC 0.7157354797979799
  Second-Tier acc 0.4583333333333333, precision 0.3541666666666667, recall 0.46303030303030307, F1 0.3501607109094347, AUC 0.7329292929292929
  First-Tier acc 0.4744897959183674, precision 0.390453834115806, recall 0.4246031746031746, F1 0.34680134680134683, AUC 0.7082644400352733
  Second-Tier acc 0.5102040816326531, precision 0.37753882915173237, recall 0.4347442680776014, F1 0.3703703703703704, AUC 0.7039792768959435
epoch: 4 idx: 0 First Loss : 3.9075512886047363, Second Loss : 3.7904624938964844
epoch: 4 idx: 200 First Loss : 0.9212416302463716, Second Loss : 0.917376554580359
  First-Tier acc 0.3854166666666667, precision 0.3717523975588492, recall 0.42909090909090913, F1 0.29490518284854933, AUC 0.720473484848485
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7322727272727274
  First-Tier acc 0.4744897959183674, precision 0.4192583732057416, recall 0.4389329805996473, F1 0.3453103913630229, AUC 0.6845685901675486
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.6726190476190476
epoch: 5 idx: 0 First Loss : 3.9302496910095215, Second Loss : 3.8806674480438232
epoch: 5 idx: 200 First Loss : 0.9118834026540116, Second Loss : 0.9010549581120838
  First-Tier acc 0.453125, precision 0.4262112325245058, recall 0.4760353535353535, F1 0.3704517282206261, AUC 0.725552398989899
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7137878787878789
  First-Tier acc 0.4897959183673469, precision 0.4876836230675476, recall 0.4558531746031746, F1 0.4032805008049905, AUC 0.6845685901675486
  Second-Tier acc 0.5306122448979592, precision 0.4373219373219373, recall 0.48148148148148145, F1 0.3866666666666667, AUC 0.6883267195767196
epoch: 6 idx: 0 First Loss : 4.026756286621094, Second Loss : 4.0680646896362305
epoch: 6 idx: 200 First Loss : 0.9041369759610307, Second Loss : 0.8933802277836671
  First-Tier acc 0.3489583333333333, precision 0.3728395061728395, recall 0.41, F1 0.2610857853294654, AUC 0.6736868686868687
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7114141414141414
  First-Tier acc 0.4336734693877551, precision 0.43467202141900935, recall 0.42283950617283955, F1 0.3082647865256561, AUC 0.6808483520723104
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7104276895943563
epoch: 7 idx: 0 First Loss : 3.738394021987915, Second Loss : 3.7328662872314453
epoch: 7 idx: 200 First Loss : 0.900954878073393, Second Loss : 0.8895459134031471
  First-Tier acc 0.3385416666666667, precision 0.36782435129740515, recall 0.4033333333333333, F1 0.2510205371248025, AUC 0.6698327020202021
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7046969696969697
  First-Tier acc 0.42346938775510207, precision 0.43253968253968256, recall 0.4166666666666667, F1 0.29901960784313725, AUC 0.6858362268518517
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.732473544973545
epoch: 8 idx: 0 First Loss : 3.7596864700317383, Second Loss : 3.7706186771392822
epoch: 8 idx: 200 First Loss : 0.8929289059336436, Second Loss : 0.8791001806286423
  First-Tier acc 0.34375, precision 0.37040469570590057, recall 0.4066666666666667, F1 0.2560846560846561, AUC 0.6722474747474747
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6997474747474747
  First-Tier acc 0.413265306122449, precision 0.442495126705653, recall 0.4104938271604938, F1 0.28977730670288054, AUC 0.6825155698853616
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7190255731922398
epoch: 9 idx: 0 First Loss : 3.673326253890991, Second Loss : 3.7819244861602783
epoch: 9 idx: 200 First Loss : 0.8929528518119018, Second Loss : 0.8806588627089311
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6735037878787878
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6884343434343435
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6848200507054675
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7176477072310407{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.181208247360157, "droprate_2": 0.0, "lr": 0.00011605457982357232, "weight_decay": 6.9207364098849986e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 14, "gamma": 0.6339541299348498, "T_max": 8, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0799951553344727, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1077253991617493, Second Loss : 1.0998452113042423
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.749558080808081
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7547474747474748
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7030285493827161
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7092151675485008
epoch: 1 idx: 0 First Loss : 1.7969367504119873, Second Loss : 2.005882501602173
epoch: 1 idx: 200 First Loss : 0.9993117576956156, Second Loss : 1.00038870731693
  First-Tier acc 0.5729166666666666, precision 0.38716577540106956, recall 0.4218181818181818, F1 0.3708193041526375, AUC 0.7380555555555556
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7512626262626263
  First-Tier acc 0.5816326530612245, precision 0.3406593406593406, recall 0.36904761904761907, F1 0.3054187192118227, AUC 0.6974929728835978
  Second-Tier acc 0.5918367346938775, precision 0.6956521739130435, recall 0.3988095238095238, F1 0.36231608320649417, AUC 0.7055224867724866
epoch: 2 idx: 0 First Loss : 2.4207842350006104, Second Loss : 2.573878049850464
epoch: 2 idx: 200 First Loss : 0.9476395169671495, Second Loss : 0.9510539403898799
  First-Tier acc 0.5729166666666666, precision 0.5521166076721632, recall 0.5650757575757576, F1 0.5332545429324456, AUC 0.7454040404040404
  Second-Tier acc 0.5833333333333334, precision 0.5231244671781756, recall 0.5354545454545455, F1 0.5166666666666667, AUC 0.7524242424242424
  First-Tier acc 0.5408163265306123, precision 0.5255692020397903, recall 0.5345568783068783, F1 0.5177209886887306, AUC 0.7060770778218695
  Second-Tier acc 0.5918367346938775, precision 0.5687830687830687, recall 0.5963403880070547, F1 0.5740740740740741, AUC 0.7267967372134039
epoch: 3 idx: 0 First Loss : 2.9306225776672363, Second Loss : 3.046290636062622
epoch: 3 idx: 200 First Loss : 0.9172795147667476, Second Loss : 0.9167268458957696
  First-Tier acc 0.5104166666666666, precision 0.5700103648051956, recall 0.5732828282828283, F1 0.5086771236631459, AUC 0.7630902777777778
  Second-Tier acc 0.5416666666666666, precision 0.5939393939393939, recall 0.6124242424242424, F1 0.5505050505050505, AUC 0.7821212121212121
  First-Tier acc 0.4642857142857143, precision 0.5006655975178979, recall 0.511849647266314, F1 0.45719366738475015, AUC 0.7229697145061729
  Second-Tier acc 0.5102040816326531, precision 0.5156641604010025, recall 0.5648148148148148, F1 0.5092788348602302, AUC 0.7390873015873015
epoch: 4 idx: 0 First Loss : 3.223950147628784, Second Loss : 3.3853795528411865
epoch: 4 idx: 200 First Loss : 0.9049476783592902, Second Loss : 0.9004964513972921
  First-Tier acc 0.4322916666666667, precision 0.5254349844800349, recall 0.515429292929293, F1 0.4298730561493113, AUC 0.7631565656565656
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333333, recall 0.5554545454545455, F1 0.4794517758227436, AUC 0.7817676767676769
  First-Tier acc 0.4336734693877551, precision 0.5224400871459695, recall 0.5063932980599647, F1 0.428996175860926, AUC 0.724530147707231
  Second-Tier acc 0.4489795918367347, precision 0.505263157894737, recall 0.5392416225749559, F1 0.44915503739033147, AUC 0.7353395061728395
epoch: 5 idx: 0 First Loss : 3.1347789764404297, Second Loss : 3.398264169692993
epoch: 5 idx: 200 First Loss : 0.8885879178267362, Second Loss : 0.8842300986871123
  First-Tier acc 0.3541666666666667, precision 0.46066811398619173, recall 0.44078282828282833, F1 0.3430618724736372, AUC 0.7433491161616161
  Second-Tier acc 0.5, precision 0.582815734989648, recall 0.6027272727272727, F1 0.5014705882352941, AUC 0.7801515151515153
  First-Tier acc 0.37244897959183676, precision 0.5036143996717474, recall 0.46649029982363316, F1 0.3682092095704972, AUC 0.7134658840388006
  Second-Tier acc 0.46938775510204084, precision 0.546087440824283, recall 0.5809082892416225, F1 0.47336860670194003, AUC 0.746141975308642
epoch: 6 idx: 0 First Loss : 2.9193646907806396, Second Loss : 3.229663848876953
epoch: 6 idx: 200 First Loss : 0.8742361686896737, Second Loss : 0.8715152951184456
  First-Tier acc 0.3385416666666667, precision 0.44780319535221497, recall 0.43032828282828284, F1 0.3101075936271467, AUC 0.7372285353535354
  Second-Tier acc 0.2916666666666667, precision 0.3877091377091377, recall 0.37080808080808075, F1 0.24294212542851382, AUC 0.791919191919192
  First-Tier acc 0.3877551020408163, precision 0.5404312668463612, recall 0.46615961199294537, F1 0.3653057530704589, AUC 0.7066971175044091
  Second-Tier acc 0.5102040816326531, precision 0.6101532567049809, recall 0.5928130511463845, F1 0.505094130675526, AUC 0.7606922398589065
epoch: 7 idx: 0 First Loss : 2.8471453189849854, Second Loss : 3.1887755393981934
epoch: 7 idx: 200 First Loss : 0.8594947230714879, Second Loss : 0.8514936702182303
  First-Tier acc 0.328125, precision 0.4302590421816636, recall 0.4183333333333333, F1 0.2801143112023941, AUC 0.7356660353535354
  Second-Tier acc 0.3125, precision 0.4505420054200542, recall 0.40111111111111114, F1 0.25443560271146476, AUC 0.7851515151515152
  First-Tier acc 0.3826530612244898, precision 0.5409356725146198, recall 0.4468143738977073, F1 0.3544810248972685, AUC 0.7059427358906527
  Second-Tier acc 0.4489795918367347, precision 0.5337837837837838, recall 0.44995590828924165, F1 0.37787114845938374, AUC 0.7648809523809524
epoch: 8 idx: 0 First Loss : 2.8110125064849854, Second Loss : 3.1815927028656006
epoch: 8 idx: 200 First Loss : 0.8340917608089078, Second Loss : 0.824674134325718
  First-Tier acc 0.328125, precision 0.4302590421816636, recall 0.4183333333333333, F1 0.2801143112023941, AUC 0.7356660353535354
  Second-Tier acc 0.3125, precision 0.4505420054200542, recall 0.40111111111111114, F1 0.25443560271146476, AUC 0.7851515151515152
  First-Tier acc 0.3826530612244898, precision 0.5409356725146198, recall 0.4468143738977073, F1 0.3544810248972685, AUC 0.7059427358906527
  Second-Tier acc 0.4489795918367347, precision 0.5337837837837838, recall 0.44995590828924165, F1 0.37787114845938374, AUC 0.7648809523809524
epoch: 9 idx: 0 First Loss : 2.8110125064849854, Second Loss : 3.1815927028656006
epoch: 9 idx: 200 First Loss : 0.8510635756350016, Second Loss : 0.8435502066114797
  First-Tier acc 0.3229166666666667, precision 0.4295051353874883, recall 0.41138888888888886, F1 0.27053140096618356, AUC 0.7362342171717171
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.7832828282828282
  First-Tier acc 0.37755102040816324, precision 0.524904214559387, recall 0.4230048500881834, F1 0.32898169664173166, AUC 0.7043478560405644
  Second-Tier acc 0.4489795918367347, precision 0.5584795321637427, recall 0.44995590828924165, F1 0.37965367965367963, AUC 0.765707671957672{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.09066342827424868, "droprate_2": 0.0, "lr": 0.0005530658227640184, "weight_decay": 4.5263469792762865e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0870894193649292, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0875874754801318, Second Loss : 1.0765758294297094
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7316982323232323
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7284848484848485
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7085193452380952
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7229387125220459
epoch: 1 idx: 0 First Loss : 1.8258190155029297, Second Loss : 1.9626938104629517
epoch: 1 idx: 200 First Loss : 0.9749929208067519, Second Loss : 0.9633198037965974
  First-Tier acc 0.546875, precision 0.5115864527629234, recall 0.37121212121212116, F1 0.3003152480504397, AUC 0.7106691919191919
  Second-Tier acc 0.5416666666666666, precision 0.27272727272727276, recall 0.3611111111111111, F1 0.2832125603864734, AUC 0.707979797979798
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.6989569554673721
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7015542328042329
epoch: 2 idx: 0 First Loss : 2.5380144119262695, Second Loss : 2.6260733604431152
epoch: 2 idx: 200 First Loss : 0.9426009012803213, Second Loss : 0.9270496013300928
  First-Tier acc 0.5, precision 0.37595628415300547, recall 0.48969696969696974, F1 0.38025041341837945, AUC 0.6979829545454544
  Second-Tier acc 0.6041666666666666, precision 0.3982608695652174, recall 0.5563636363636363, F1 0.44941176470588234, AUC 0.7102525252525252
  First-Tier acc 0.5153061224489796, precision 0.37543859649122807, recall 0.43209876543209874, F1 0.37285902503293805, AUC 0.677796378968254
  Second-Tier acc 0.4897959183673469, precision 0.3383838383838384, recall 0.39947089947089953, F1 0.35042309606769534, AUC 0.6871141975308642
epoch: 3 idx: 0 First Loss : 3.101576328277588, Second Loss : 3.045090436935425
epoch: 3 idx: 200 First Loss : 0.9291093172922508, Second Loss : 0.9076462948036876
  First-Tier acc 0.4114583333333333, precision 0.375266635450809, recall 0.4457575757575758, F1 0.3163641194729278, AUC 0.7046906565656567
  Second-Tier acc 0.4375, precision 0.34545454545454546, recall 0.4496969696969697, F1 0.3348484848484849, AUC 0.7144444444444445
  First-Tier acc 0.4744897959183674, precision 0.4065315315315315, recall 0.4332010582010582, F1 0.3461538461538461, AUC 0.6860773533950617
  Second-Tier acc 0.5510204081632653, precision 0.4068100358422939, recall 0.4708994708994709, F1 0.39999999999999997, AUC 0.6937279541446207
epoch: 4 idx: 0 First Loss : 3.2373502254486084, Second Loss : 3.2316319942474365
epoch: 4 idx: 200 First Loss : 0.9110115786263747, Second Loss : 0.8907760453702354
  First-Tier acc 0.3645833333333333, precision 0.3628740232513818, recall 0.41575757575757577, F1 0.27655345259700975, AUC 0.6880555555555556
  Second-Tier acc 0.3958333333333333, precision 0.34259259259259256, recall 0.42303030303030303, F1 0.3040061337933679, AUC 0.7106060606060606
  First-Tier acc 0.4642857142857143, precision 0.41630591630591635, recall 0.43276014109347444, F1 0.3371428571428572, AUC 0.6710517250881834
  Second-Tier acc 0.4897959183673469, precision 0.3843137254901961, recall 0.4338624338624338, F1 0.35714285714285715, AUC 0.642416225749559
epoch: 5 idx: 0 First Loss : 3.5864429473876953, Second Loss : 3.2969272136688232
epoch: 5 idx: 200 First Loss : 0.9037515709399065, Second Loss : 0.880201704498955
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.7094507575757575
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7268686868686868
  First-Tier acc 0.44387755102040816, precision 0.4268942144759138, recall 0.4261463844797178, F1 0.3184304604384718, AUC 0.6978615520282188
  Second-Tier acc 0.5102040816326531, precision 0.40952380952380957, recall 0.4576719576719577, F1 0.3719926995188319, AUC 0.636739417989418
epoch: 6 idx: 0 First Loss : 4.072281837463379, Second Loss : 3.6957132816314697
epoch: 6 idx: 200 First Loss : 0.9094544807078307, Second Loss : 0.8828394380618183
  First-Tier acc 0.34375, precision 0.37040469570590057, recall 0.4066666666666667, F1 0.2560846560846561, AUC 0.7071464646464646
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7328282828282827
  First-Tier acc 0.4387755102040816, precision 0.43571195829260345, recall 0.4259259259259259, F1 0.31281400219191163, AUC 0.6634045690035273
  Second-Tier acc 0.5306122448979592, precision 0.4373219373219373, recall 0.48148148148148145, F1 0.3866666666666667, AUC 0.6529982363315696
epoch: 7 idx: 0 First Loss : 3.7711124420166016, Second Loss : 3.583091974258423
epoch: 7 idx: 200 First Loss : 0.90938611149635, Second Loss : 0.8883272063841959
  First-Tier acc 0.328125, precision 0.3621473287025127, recall 0.39666666666666667, F1 0.24069620977899922, AUC 0.6917960858585858
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7123232323232322
  First-Tier acc 0.41836734693877553, precision 0.431441303236175, recall 0.41358024691358025, F1 0.29432098765432096, AUC 0.6323646935626102
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6908068783068783
epoch: 8 idx: 0 First Loss : 3.6073834896087646, Second Loss : 3.482687473297119
epoch: 8 idx: 200 First Loss : 0.9065476194883011, Second Loss : 0.8793391126801089
  First-Tier acc 0.328125, precision 0.3621473287025127, recall 0.39666666666666667, F1 0.24069620977899922, AUC 0.6791224747474748
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7027272727272728
  First-Tier acc 0.4030612244897959, precision 0.441233140655106, recall 0.404320987654321, F1 0.28007600253341774, AUC 0.626877342372134
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6683201058201059
epoch: 9 idx: 0 First Loss : 3.5574522018432617, Second Loss : 3.5721347332000732
epoch: 9 idx: 200 First Loss : 0.9038631173212137, Second Loss : 0.8750982222660441
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6714299242424242
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6847979797979797
  First-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6232259975749559
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6824294532627867{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_6", "train_show_freq": 200, "droprate": 0.2450519915849249, "droprate_2": 0.0, "lr": 0.0005658912507697601, "weight_decay": 0.000176963160750367, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "CosineAnnealingLR", "step_size": 14, "gamma": 0.8617695591732097, "T_max": 18, "patience": 3, "disable_writer": true, "num": 0, "p_name": "optuna_trial_6", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1104472875595093, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0999934009429235, Second Loss : 1.089392503399161
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7432260101010101
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7444444444444445
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6901661706349206
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7163249559082892
epoch: 1 idx: 0 First Loss : 1.5619654655456543, Second Loss : 1.8430603742599487
epoch: 1 idx: 200 First Loss : 0.9952440894954834, Second Loss : 0.975454029529842
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7338036616161615
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7357575757575757
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7216882991622575
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.736331569664903
epoch: 2 idx: 0 First Loss : 2.2255191802978516, Second Loss : 2.4737823009490967
epoch: 2 idx: 200 First Loss : 0.9587396670929829, Second Loss : 0.9396637432017729
  First-Tier acc 0.5625, precision 0.40740740740740744, recall 0.393939393939394, F1 0.3333333333333333, AUC 0.7195801767676767
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7189393939393938
  First-Tier acc 0.5510204081632653, precision 0.18652849740932642, recall 0.3333333333333333, F1 0.23920265780730898, AUC 0.7066454475308642
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7002314814814815
epoch: 3 idx: 0 First Loss : 2.898240566253662, Second Loss : 3.3378446102142334
epoch: 3 idx: 200 First Loss : 0.9369752603717407, Second Loss : 0.9208839396061144
  First-Tier acc 0.5625, precision 0.4784456587735277, recall 0.393939393939394, F1 0.33620019112385274, AUC 0.7033428030303032
  Second-Tier acc 0.5625, precision 0.337979094076655, recall 0.4109090909090909, F1 0.35353535353535354, AUC 0.7225252525252525
  First-Tier acc 0.5612244897959183, precision 0.5189003436426117, recall 0.3452380952380953, F1 0.2613991017736165, AUC 0.6354580026455027
  Second-Tier acc 0.5714285714285714, precision 0.3067632850241546, recall 0.35714285714285715, F1 0.28579102874026324, AUC 0.6489197530864197
epoch: 4 idx: 0 First Loss : 4.085361957550049, Second Loss : 3.5309154987335205
epoch: 4 idx: 200 First Loss : 0.9302516702530137, Second Loss : 0.905867955906882
  First-Tier acc 0.3958333333333333, precision 0.375733199262611, recall 0.4357575757575758, F1 0.3037894557450486, AUC 0.7122443181818182
  Second-Tier acc 0.4375, precision 0.3599439775910364, recall 0.4496969696969697, F1 0.33618233618233617, AUC 0.7654545454545453
  First-Tier acc 0.47959183673469385, precision 0.420701496198185, recall 0.4420194003527336, F1 0.34934166903476366, AUC 0.6648409942680776
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.6508487654320988
epoch: 5 idx: 0 First Loss : 3.0943946838378906, Second Loss : 3.2518796920776367
epoch: 5 idx: 200 First Loss : 0.9175862051773612, Second Loss : 0.8959220427074539
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.7045896464646463
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7364646464646465
  First-Tier acc 0.4489795918367347, precision 0.41951385347611764, recall 0.4263668430335097, F1 0.3237636995455761, AUC 0.6859188988095237
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.6688712522045855
epoch: 6 idx: 0 First Loss : 3.3406200408935547, Second Loss : 3.5792179107666016
epoch: 6 idx: 200 First Loss : 0.9066245250857958, Second Loss : 0.8841542715475482
  First-Tier acc 0.34375, precision 0.37040469570590057, recall 0.4066666666666667, F1 0.2560846560846561, AUC 0.6900757575757576
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6977272727272728
  First-Tier acc 0.4387755102040816, precision 0.43571195829260345, recall 0.4259259259259259, F1 0.31281400219191163, AUC 0.6548032407407407
  Second-Tier acc 0.5306122448979592, precision 0.4373219373219373, recall 0.48148148148148145, F1 0.3866666666666667, AUC 0.6580136684303352
epoch: 7 idx: 0 First Loss : 2.951789379119873, Second Loss : 3.3194644451141357
epoch: 7 idx: 200 First Loss : 0.8904251567196954, Second Loss : 0.8752299467905595
  First-Tier acc 0.390625, precision 0.3886563542614498, recall 0.4366666666666667, F1 0.2990234015109637, AUC 0.6997348484848485
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7033838383838384
  First-Tier acc 0.47959183673469385, precision 0.43632478632478633, recall 0.4506172839506173, F1 0.34727180010198877, AUC 0.6673900462962963
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6626984126984127
epoch: 8 idx: 0 First Loss : 3.3498315811157227, Second Loss : 3.756556272506714
epoch: 8 idx: 200 First Loss : 0.8847250336820528, Second Loss : 0.8686424647793822
  First-Tier acc 0.3489583333333333, precision 0.3728395061728395, recall 0.41, F1 0.2610857853294654, AUC 0.6698863636363637
  Second-Tier acc 0.375, precision 0.38568376068376065, recall 0.4266666666666667, F1 0.2880808080808081, AUC 0.6845454545454546
  First-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6536286100088184
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6752094356261024
epoch: 9 idx: 0 First Loss : 3.038869619369507, Second Loss : 3.443753957748413
epoch: 9 idx: 200 First Loss : 0.8738088408483318, Second Loss : 0.8665698662988693
  First-Tier acc 0.3177083333333333, precision 0.35561125034809243, recall 0.38999999999999996, F1 0.23009802037286184, AUC 0.6585984848484848
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6733838383838383
  First-Tier acc 0.37755102040816324, precision 0.4382022471910112, recall 0.3888888888888889, F1 0.25478225478225475, AUC 0.6458540013227513
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6708553791887125