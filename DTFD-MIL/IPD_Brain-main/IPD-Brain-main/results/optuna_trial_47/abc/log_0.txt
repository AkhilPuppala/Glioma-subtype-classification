{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_47", "train_show_freq": 200, "droprate": 0.4442574509966728, "droprate_2": 0.0, "lr": 1.247633459893494e-05, "weight_decay": 1.3555404545141748e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_47", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 1.247633459893494e-05
epoch: 0 idx: 0 First Loss : 1.2532274723052979, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.061502755281344, Second Loss : 1.0430967564606548
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.674719416386083
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7443939393939395
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6128502841465805
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6064814814814815
Test AUC: 0.6065, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 1.247633459893494e-05
epoch: 1 idx: 0 First Loss : 2.119359254837036, Second Loss : 1.9908862113952637
epoch: 1 idx: 200 First Loss : 1.110362856468158, Second Loss : 1.1009429765874474
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.714040404040404
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7533333333333333
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6616818538114835
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6622023809523809
Test AUC: 0.6622, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 1.247633459893494e-05
epoch: 2 idx: 0 First Loss : 2.214811325073242, Second Loss : 2.1103508472442627
epoch: 2 idx: 200 First Loss : 1.0967395619966498, Second Loss : 1.0888465972089056
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.729203142536476
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7667676767676768
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6901944934352343
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6985780423280423
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 3 idx: 0 First Loss : 2.2853403091430664, Second Loss : 2.17614483833313
epoch: 3 idx: 200 First Loss : 1.0819805429794302, Second Loss : 1.0758952294564366
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7397979797979798
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7647474747474748
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7057000783852635
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7055776014109347
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 4 idx: 0 First Loss : 2.3577523231506348, Second Loss : 2.249753475189209
epoch: 4 idx: 200 First Loss : 1.0674259771606815, Second Loss : 1.063327020302934
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7422446689113356
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7561616161616161
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7155411032725848
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7107032627865962
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 5 idx: 0 First Loss : 2.4448907375335693, Second Loss : 2.3295915126800537
epoch: 5 idx: 200 First Loss : 1.0510462072135798, Second Loss : 1.04792631476821
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5486111111111112, precision 0.5119047619047619, recall 0.3737373737373737, F1 0.3046302116069558, AUC 0.7382828282828283
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.754040404040404
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7149593376445229
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7082231040564374
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 6 idx: 0 First Loss : 2.5686309337615967, Second Loss : 2.4267735481262207
epoch: 6 idx: 200 First Loss : 1.0339736736087657, Second Loss : 1.0325870153989958
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5902777777777778, precision 0.5230339447607, recall 0.4448148148148148, F1 0.40831679766353135, AUC 0.7375869809203142
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7546969696969695
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.6190476190476191, precision 0.7094290452499408, recall 0.44841269841269843, F1 0.4357506043177461, AUC 0.7061226239466981
  Second-Tier acc 0.6122448979591837, precision 0.35714285714285715, recall 0.4047619047619047, F1 0.35610766045548653, AUC 0.7124669312169312
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 7 idx: 0 First Loss : 2.6818768978118896, Second Loss : 2.540686845779419
epoch: 7 idx: 200 First Loss : 1.0144215628356483, Second Loss : 1.0146151550892573
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.6875, precision 0.6491071428571429, recall 0.6004377104377104, F1 0.607608502129641, AUC 0.734769921436588
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7545454545454544
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6258503401360545, precision 0.5900709219858156, recall 0.5787037037037037, F1 0.5774149659863946, AUC 0.705455124436606
  Second-Tier acc 0.5510204081632653, precision 0.4736842105263157, recall 0.45436507936507936, F1 0.4444444444444444, AUC 0.705136684303351
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 8 idx: 0 First Loss : 2.8170650005340576, Second Loss : 2.6740188598632812
epoch: 8 idx: 200 First Loss : 0.9955081143300628, Second Loss : 0.997096469431226
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6111111111111112, precision 0.5748522778789485, recall 0.5665993265993267, F1 0.5654100031423581, AUC 0.7311728395061728
  Second-Tier acc 0.6041666666666666, precision 0.5228370663153271, recall 0.5538383838383838, F1 0.49015151515151506, AUC 0.7480303030303029
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.54421768707483, precision 0.4967923280423281, recall 0.5352733686067019, F1 0.49687205201170076, AUC 0.7114381246325691
  Second-Tier acc 0.5918367346938775, precision 0.5467218771566597, recall 0.5427689594356261, F1 0.522984522984523, AUC 0.7213403880070546
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 9 idx: 0 First Loss : 2.952979326248169, Second Loss : 2.8136303424835205
epoch: 9 idx: 200 First Loss : 0.9786588933633927, Second Loss : 0.982516505546979
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.5347222222222222, precision 0.5109045965142839, recall 0.5126599326599327, F1 0.48581037443933456, AUC 0.7322278338945006
  Second-Tier acc 0.5208333333333334, precision 0.5819444444444444, recall 0.5293939393939394, F1 0.48692390948677294, AUC 0.7534848484848484
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.47619047619047616, precision 0.456032946093798, recall 0.5022045855379188, F1 0.4399431146014246, AUC 0.715626837154615
  Second-Tier acc 0.6326530612244898, precision 0.6455314009661836, recall 0.6554232804232805, F1 0.6287537537537538, AUC 0.7341269841269842
Test AUC: 0.6986, Test F1: 0.2368 (Best Epoch: 2)
Current LR: 1.247633459893494e-05
epoch: 10 idx: 0 First Loss : 3.082388162612915, Second Loss : 2.9462807178497314
epoch: 10 idx: 200 First Loss : 0.9640442864941572, Second Loss : 0.969775026905077
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4861111111111111, precision 0.5030118255728011, recall 0.4951515151515151, F1 0.44564435809830066, AUC 0.7348204264870931
  Second-Tier acc 0.4791666666666667, precision 0.5777777777777778, recall 0.5341414141414141, F1 0.4673635307781649, AUC 0.7724747474747474
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.4421768707482993, precision 0.46025326207328227, recall 0.510949441504997, F1 0.41991341991341985, AUC 0.7204156868508721
  Second-Tier acc 0.5918367346938775, precision 0.6126262626262626, recall 0.6779100529100529, F1 0.608994708994709, AUC 0.7534171075837742
Test AUC: 0.7534, Test F1: 0.6090 (Best Epoch: 10)
Current LR: 1.247633459893494e-05
epoch: 11 idx: 0 First Loss : 3.200230836868286, Second Loss : 3.0663790702819824
epoch: 11 idx: 200 First Loss : 0.9524685882439661, Second Loss : 0.9600514180087183
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4375, precision 0.4696137196137197, recall 0.4575420875420875, F1 0.39228940722032385, AUC 0.7366273849607183
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.7897474747474748
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4421768707482993, precision 0.4804465098582746, recall 0.5245443856554967, F1 0.42392886979353145, AUC 0.7259577699392513
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7631172839506172
Test AUC: 0.7631, Test F1: 0.5455 (Best Epoch: 11)
Current LR: 1.247633459893494e-05
epoch: 12 idx: 0 First Loss : 3.2960052490234375, Second Loss : 3.1763248443603516
epoch: 12 idx: 200 First Loss : 0.9433671719630929, Second Loss : 0.9528743917335621
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4305555555555556, precision 0.48038426767601505, recall 0.45875420875420875, F1 0.3933863537592351, AUC 0.7421464646464647
  Second-Tier acc 0.4791666666666667, precision 0.5527065527065527, recall 0.5485858585858586, F1 0.4703762586115527, AUC 0.8052525252525253
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.42857142857142855, precision 0.4792111997591449, recall 0.520135214579659, F1 0.41663484790632554, AUC 0.7308874681559866
  Second-Tier acc 0.5510204081632653, precision 0.5893719806763286, recall 0.6532186948853616, F1 0.5632415632415633, AUC 0.7673059964726633
Test AUC: 0.7673, Test F1: 0.5632 (Best Epoch: 12)
Current LR: 1.247633459893494e-05
epoch: 13 idx: 0 First Loss : 3.37691593170166, Second Loss : 3.2703230381011963
epoch: 13 idx: 200 First Loss : 0.9360145951635135, Second Loss : 0.9472800108803371
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4166666666666667, precision 0.4847619047619047, recall 0.46202020202020205, F1 0.39490196078431367, AUC 0.742749719416386
  Second-Tier acc 0.5, precision 0.576388888888889, recall 0.5908080808080808, F1 0.4985569985569986, AUC 0.812020202020202
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.42857142857142855, precision 0.4953703703703704, recall 0.5180041152263374, F1 0.4214076041123353, AUC 0.7338207916911621
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7746362433862434
Test AUC: 0.7746, Test F1: 0.5320 (Best Epoch: 13)
Current LR: 1.247633459893494e-05
epoch: 14 idx: 0 First Loss : 3.440471887588501, Second Loss : 3.350687265396118
epoch: 14 idx: 200 First Loss : 0.9303072094778294, Second Loss : 0.9432219864142624
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4236111111111111, precision 0.5, recall 0.47212121212121216, F1 0.4051521354308318, AUC 0.7449438832772167
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.8161111111111111
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4489795918367347, precision 0.5357962932589798, recall 0.5494562022339801, F1 0.447619333623628, AUC 0.7373909954928474
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7787698412698413
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)
Current LR: 1.247633459893494e-05
epoch: 15 idx: 0 First Loss : 3.4899237155914307, Second Loss : 3.4184374809265137
epoch: 15 idx: 200 First Loss : 0.9254541434231793, Second Loss : 0.9395018640525676
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4097222222222222, precision 0.5028356529904517, recall 0.481043771043771, F1 0.40034386417365136, AUC 0.7494276094276094
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8156060606060606
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4557823129251701, precision 0.5580307303601856, recall 0.5688565549676661, F1 0.45768975762202224, AUC 0.7400181265922007
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7835097001763668
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)
Current LR: 1.247633459893494e-05
epoch: 16 idx: 0 First Loss : 3.5260403156280518, Second Loss : 3.466972589492798
epoch: 16 idx: 200 First Loss : 0.9209612509448878, Second Loss : 0.936118985706968
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4027777777777778, precision 0.5040072859744992, recall 0.47912457912457906, F1 0.39971141932312654, AUC 0.7521156004489337
  Second-Tier acc 0.4166666666666667, precision 0.5154248366013072, recall 0.5060606060606061, F1 0.41212458286985537, AUC 0.8104545454545454
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5544848374132262, recall 0.5528365667254556, F1 0.45087412587412584, AUC 0.7416225749559082
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7882495590828924
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)
Current LR: 1.247633459893494e-05
epoch: 17 idx: 0 First Loss : 3.54972767829895, Second Loss : 3.5046308040618896
epoch: 17 idx: 200 First Loss : 0.916576184798032, Second Loss : 0.9329757853272135
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4236111111111111, precision 0.5234983275711836, recall 0.5102693602693603, F1 0.42296547821165814, AUC 0.7528787878787879
  Second-Tier acc 0.3958333333333333, precision 0.5, recall 0.47828282828282837, F1 0.38887840868599216, AUC 0.8057070707070707
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4489795918367347, precision 0.5698285517360213, recall 0.550705467372134, F1 0.44962079693537493, AUC 0.7448192239858907
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.794863315696649
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)
Current LR: 1.247633459893494e-05
epoch: 18 idx: 0 First Loss : 3.558917999267578, Second Loss : 3.527623414993286
epoch: 18 idx: 200 First Loss : 0.9120687302398908, Second Loss : 0.9296302571661066
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4166666666666667, precision 0.5193957864836075, recall 0.5075084175084176, F1 0.41555183946488294, AUC 0.7556172839506172
  Second-Tier acc 0.3958333333333333, precision 0.5, recall 0.47828282828282837, F1 0.38887840868599216, AUC 0.8004545454545454
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.5745454545454546, recall 0.5545267489711935, F1 0.4510381085803334, AUC 0.7496693121693122
  Second-Tier acc 0.5306122448979592, precision 0.6205128205128205, recall 0.6344797178130511, F1 0.5262939958592132, AUC 0.7985008818342152
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)
Current LR: 1.247633459893494e-05
epoch: 19 idx: 0 First Loss : 3.5581588745117188, Second Loss : 3.5384650230407715
epoch: 19 idx: 200 First Loss : 0.9076370432977542, Second Loss : 0.9261759617111057
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4166666666666667, precision 0.5194838056680161, recall 0.5148484848484848, F1 0.41335041105683307, AUC 0.7561616161616161
  Second-Tier acc 0.3541666666666667, precision 0.4581491305629237, recall 0.4227272727272728, F1 0.33752688172043016, AUC 0.7975757575757575
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4557823129251701, precision 0.5833333333333334, recall 0.5662845385067607, F1 0.45726775956284155, AUC 0.752621007250637
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.79701278659612
Test AUC: 0.7788, Test F1: 0.5320 (Best Epoch: 14)