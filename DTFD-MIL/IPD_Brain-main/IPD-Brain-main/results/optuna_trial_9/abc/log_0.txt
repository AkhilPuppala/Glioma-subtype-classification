{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.47193689922800386, "droprate_2": 0.0, "lr": 3.716846960269376e-05, "weight_decay": 1.3329738893109167e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 3.716846960269376e-05
epoch: 0 idx: 0 First Loss : 0.8925186991691589, Second Loss : 1.1262458562850952
epoch: 0 idx: 200 First Loss : 1.099874184795873, Second Loss : 1.094110826502985
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5001402918069585
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.4933838383838384
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4481861160101901
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.44984567901234573
 
 test auc: 0.44984567901234573, test F1: 0.14814814814814814  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.32720091409377716, "droprate_2": 0.0, "lr": 4.151882739101114e-05, "weight_decay": 1.0815290618717438e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 2, "total_instance": 4, "numGroup_test": 2, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 0, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 4.151882739101114e-05
epoch: 0 idx: 0 First Loss : 1.0032628774642944, Second Loss : 1.1648495197296143
epoch: 0 idx: 200 First Loss : 1.0942514348237669, Second Loss : 1.1028299932900947
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.506830808080808
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5077777777777778
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4482611331569664
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4538139329805997
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 1 idx: 0 First Loss : 1.5881576538085938, Second Loss : 1.8955715894699097
epoch: 1 idx: 200 First Loss : 1.040904935171355, Second Loss : 1.060452752667873
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5034469696969697
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5037373737373737
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4466628086419753
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4505621693121693
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 2 idx: 0 First Loss : 1.644606590270996, Second Loss : 2.002808094024658
epoch: 2 idx: 200 First Loss : 1.0010495342277175, Second Loss : 1.0290482410447515
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49098484848484847
  Second-Tier acc 0.2708333333333333, precision 0.41843971631205673, recall 0.3636363636363636, F1 0.1911487758945386, AUC 0.49111111111111105
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.466931216931217
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.47464726631393295
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 3 idx: 0 First Loss : 1.7810604572296143, Second Loss : 2.1367011070251465
epoch: 3 idx: 200 First Loss : 0.9680015164154085, Second Loss : 1.00707439781718
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.22916666666666666, precision 0.25507455507455506, recall 0.30338383838383837, F1 0.2093438376095674, AUC 0.4770833333333333
  Second-Tier acc 0.2708333333333333, precision 0.23684210526315788, recall 0.3737373737373737, F1 0.26539682539682535, AUC 0.46126262626262626
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.29591836734693877, precision 0.2700221589110478, recall 0.4077380952380952, F1 0.2954761151534325, AUC 0.48841214726631393
  Second-Tier acc 0.2653061224489796, precision 0.14518002322880372, recall 0.2980599647266314, F1 0.16506238859180036, AUC 0.4981812169312169
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 4 idx: 0 First Loss : 1.8254103660583496, Second Loss : 2.3017497062683105
epoch: 4 idx: 200 First Loss : 0.9376035738940263, Second Loss : 0.9832043857939208
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.2708333333333333, precision 0.27345983419096626, recall 0.36560606060606055, F1 0.28496518660453085, AUC 0.4718055555555556
  Second-Tier acc 0.2916666666666667, precision 0.20695970695970697, recall 0.4116161616161616, F1 0.27521929824561403, AUC 0.4483333333333333
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.3163265306122449, precision 0.3564861194594715, recall 0.3838183421516755, F1 0.35421303656597775, AUC 0.5149636243386243
  Second-Tier acc 0.2653061224489796, precision 0.26666666666666666, recall 0.24713403880070547, F1 0.24031642116748497, AUC 0.511739417989418
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 5 idx: 0 First Loss : 1.8996758460998535, Second Loss : 2.4490997791290283
epoch: 5 idx: 200 First Loss : 0.9072661732708044, Second Loss : 0.9603178854197708
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.2916666666666667, precision 0.2979096167230662, recall 0.35727272727272724, F1 0.29044452132907905, AUC 0.47366161616161623
  Second-Tier acc 0.2916666666666667, precision 0.33929824561403504, recall 0.38272727272727275, F1 0.2771598071931776, AUC 0.45030303030303037
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.35714285714285715, precision 0.36842436842436843, recall 0.40277777777777773, F1 0.376265726350616, AUC 0.5273506393298061
  Second-Tier acc 0.2857142857142857, precision 0.30427350427350425, recall 0.26587301587301587, F1 0.2782716497339139, AUC 0.5268408289241623
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 6 idx: 0 First Loss : 1.9569902420043945, Second Loss : 2.58608078956604
epoch: 6 idx: 200 First Loss : 0.882739968338416, Second Loss : 0.9430313138893588
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3229166666666667, precision 0.31396413110698823, recall 0.3810606060606061, F1 0.3024230036302471, AUC 0.4821717171717171
  Second-Tier acc 0.2916666666666667, precision 0.3055555555555555, recall 0.37080808080808075, F1 0.254895532826296, AUC 0.45636363636363636
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.37755102040816324, precision 0.3671473354231975, recall 0.4240520282186948, F1 0.3850916489830849, AUC 0.5374503968253969
  Second-Tier acc 0.32653061224489793, precision 0.29770723104056435, recall 0.29056437389770723, F1 0.29365687526607065, AUC 0.5403439153439153
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 7 idx: 0 First Loss : 1.9965872764587402, Second Loss : 2.673454999923706
epoch: 7 idx: 200 First Loss : 0.8623010347509266, Second Loss : 0.9272259152795544
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3333333333333333, precision 0.30790598290598287, recall 0.388989898989899, F1 0.30057330057330056, AUC 0.48901515151515146
  Second-Tier acc 0.3125, precision 0.33133640552995386, recall 0.3841414141414141, F1 0.27236652236652237, AUC 0.47010101010101013
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.35714285714285715, precision 0.32794851589177826, recall 0.3855820105820105, F1 0.34493467235811237, AUC 0.5413084215167548
  Second-Tier acc 0.32653061224489793, precision 0.2629310344827586, recall 0.2612433862433862, F1 0.26144688644688646, AUC 0.546792328042328
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 8 idx: 0 First Loss : 2.0325076580047607, Second Loss : 2.7374415397644043
epoch: 8 idx: 200 First Loss : 0.8436507610465164, Second Loss : 0.9130935747991895
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3541666666666667, precision 0.3256172839506173, recall 0.40232323232323225, F1 0.3140350877192982, AUC 0.4980934343434344
  Second-Tier acc 0.3125, precision 0.33315295815295815, recall 0.3841414141414141, F1 0.2681818181818182, AUC 0.4846464646464647
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3877551020408163, precision 0.3409523809523809, recall 0.4130291005291005, F1 0.3621794871794872, AUC 0.5500027557319224
  Second-Tier acc 0.3469387755102041, precision 0.30043290043290044, recall 0.3029100529100529, F1 0.29952861952861953, AUC 0.5589726631393298
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 9 idx: 0 First Loss : 2.079094409942627, Second Loss : 2.8069517612457275
epoch: 9 idx: 200 First Loss : 0.8293848757201167, Second Loss : 0.9033053544493606
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.34347442680776014, recall 0.4156565656565656, F1 0.3299595141700405, AUC 0.5047853535353535
  Second-Tier acc 0.2916666666666667, precision 0.30952380952380953, recall 0.37080808080808075, F1 0.24453138456238774, AUC 0.5073737373737374
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3469387755102041, precision 0.27886710239651413, recall 0.34755291005291006, F1 0.3024978466838932, AUC 0.5533647486772487
  Second-Tier acc 0.32653061224489793, precision 0.2481182795698925, recall 0.2676366843033509, F1 0.2538023917334262, AUC 0.5637676366843034
 
 test auc: 0.4538139329805997, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 4.151882739101114e-05
epoch: 10 idx: 0 First Loss : 2.0894875526428223, Second Loss : 2.8459067344665527
epoch: 10 idx: 200 First Loss : 0.8144023962578371, Second Loss : 0.8948950526577917
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3958333333333333, precision 0.36297036297036295, recall 0.4374747474747474, F1 0.3459483459483459, AUC 0.5190025252525253
  Second-Tier acc 0.3541666666666667, precision 0.37878787878787884, recall 0.41080808080808073, F1 0.30619924737571796, AUC 0.5160101010101009
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3469387755102041, precision 0.26297840090943536, recall 0.31823192239858905, F1 0.2817460317460318, AUC 0.5549630731922399
  Second-Tier acc 0.30612244897959184, precision 0.2020833333333333, recall 0.24382716049382713, F1 0.22096672944130571, AUC 0.5629409171075838
 
 test auc: 0.5629409171075838, test F1: 0.22096672944130571  :  from epoch 10
 current learn rate 4.151882739101114e-05
epoch: 11 idx: 0 First Loss : 2.09830379486084, Second Loss : 2.866647958755493
epoch: 11 idx: 200 First Loss : 0.8025839638326373, Second Loss : 0.8878960432762752
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4166666666666667, precision 0.3918508392192603, recall 0.45080808080808077, F1 0.3607177632494088, AUC 0.5370454545454546
  Second-Tier acc 0.3541666666666667, precision 0.37878787878787884, recall 0.41080808080808073, F1 0.30619924737571796, AUC 0.5385353535353535
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3469387755102041, precision 0.26297840090943536, recall 0.31823192239858905, F1 0.2817460317460318, AUC 0.5533371913580246
  Second-Tier acc 0.30612244897959184, precision 0.20039100684261976, recall 0.24382716049382713, F1 0.21960072595281308, AUC 0.5612874779541447
 
 test auc: 0.5612874779541447, test F1: 0.21960072595281308  :  from epoch 11
 current learn rate 4.151882739101114e-05
epoch: 12 idx: 0 First Loss : 2.133909225463867, Second Loss : 2.872818946838379
epoch: 12 idx: 200 First Loss : 0.7931717468856542, Second Loss : 0.8811125908584441
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4270833333333333, precision 0.40351793800069663, recall 0.4659595959595959, F1 0.36893939393939396, AUC 0.5524368686868687
  Second-Tier acc 0.3541666666666667, precision 0.37878787878787884, recall 0.41080808080808073, F1 0.30619924737571796, AUC 0.5562626262626263
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.32653061224489793, precision 0.21698542805100182, recall 0.2708333333333333, F1 0.2398550724637681, AUC 0.5480599647266313
  Second-Tier acc 0.32653061224489793, precision 0.2125, recall 0.2561728395061728, F1 0.23226616446955428, AUC 0.5656415343915343
 
 test auc: 0.5656415343915343, test F1: 0.23226616446955428  :  from epoch 12
 current learn rate 4.151882739101114e-05
epoch: 13 idx: 0 First Loss : 2.1445236206054688, Second Loss : 2.880481243133545
epoch: 13 idx: 200 First Loss : 0.7835382791583552, Second Loss : 0.8760889078471902
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4270833333333333, precision 0.4100193591719015, recall 0.4659595959595959, F1 0.3688294811101829, AUC 0.5643813131313131
  Second-Tier acc 0.375, precision 0.39305555555555555, recall 0.4241414141414141, F1 0.3254091300602929, AUC 0.5688888888888889
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.32653061224489793, precision 0.20932539682539683, recall 0.2561728395061728, F1 0.23026416246755232, AUC 0.5419422398589065
  Second-Tier acc 0.30612244897959184, precision 0.20039100684261976, recall 0.24382716049382713, F1 0.21960072595281308, AUC 0.5586970899470899
 
 test auc: 0.5586970899470899, test F1: 0.21960072595281308  :  from epoch 13
 current learn rate 4.151882739101114e-05
epoch: 14 idx: 0 First Loss : 2.1472127437591553, Second Loss : 2.883977174758911
epoch: 14 idx: 200 First Loss : 0.7755818806301377, Second Loss : 0.871092161353659
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4375, precision 0.4198786356978447, recall 0.47262626262626256, F1 0.3765573569495138, AUC 0.5737878787878788
  Second-Tier acc 0.375, precision 0.39305555555555555, recall 0.4241414141414141, F1 0.3254091300602929, AUC 0.5748484848484848
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.32653061224489793, precision 0.19691018591254253, recall 0.24151234567901236, F1 0.216922471467926, AUC 0.5372574955908288
  Second-Tier acc 0.32653061224489793, precision 0.2125, recall 0.2561728395061728, F1 0.23226616446955428, AUC 0.5541225749559083
 
 test auc: 0.5541225749559083, test F1: 0.23226616446955428  :  from epoch 14
 current learn rate 4.151882739101114e-05
epoch: 15 idx: 0 First Loss : 2.148442029953003, Second Loss : 2.872734308242798
epoch: 15 idx: 200 First Loss : 0.7685773165975304, Second Loss : 0.8663381935416985
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4270833333333333, precision 0.4295698924731182, recall 0.4659595959595959, F1 0.36804451510333863, AUC 0.5825252525252526
  Second-Tier acc 0.375, precision 0.39305555555555555, recall 0.4241414141414141, F1 0.3254091300602929, AUC 0.5805555555555556
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.32653061224489793, precision 0.1942786069651741, recall 0.24151234567901236, F1 0.21533516988062443, AUC 0.5306575176366842
  Second-Tier acc 0.3469387755102041, precision 0.22558922558922556, recall 0.26851851851851855, F1 0.2450980392156863, AUC 0.5539021164021164
 
 test auc: 0.5539021164021164, test F1: 0.2450980392156863  :  from epoch 15
 current learn rate 4.151882739101114e-05
epoch: 16 idx: 0 First Loss : 2.1339833736419678, Second Loss : 2.869023323059082
epoch: 16 idx: 200 First Loss : 0.7628747738216684, Second Loss : 0.8626496933808374
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4479166666666667, precision 0.4526468155500414, recall 0.47929292929292927, F1 0.3837719298245614, AUC 0.592550505050505
  Second-Tier acc 0.3541666666666667, precision 0.37878787878787884, recall 0.41080808080808073, F1 0.30619924737571796, AUC 0.5876262626262626
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.32653061224489793, precision 0.19189765458422173, recall 0.24151234567901236, F1 0.21383366837912296, AUC 0.5238370811287478
  Second-Tier acc 0.3469387755102041, precision 0.21818181818181817, recall 0.26851851851851855, F1 0.24074074074074073, AUC 0.5473434744268078
 
 test auc: 0.5473434744268078, test F1: 0.24074074074074073  :  from epoch 16
 current learn rate 4.151882739101114e-05
epoch: 17 idx: 0 First Loss : 2.1286377906799316, Second Loss : 2.8510594367980957
epoch: 17 idx: 200 First Loss : 0.7577428674430757, Second Loss : 0.8586100418901358
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4583333333333333, precision 0.4664021164021164, recall 0.4944444444444444, F1 0.3919934640522876, AUC 0.6089772727272726
  Second-Tier acc 0.3541666666666667, precision 0.3984126984126984, recall 0.42777777777777776, F1 0.30062399355877617, AUC 0.5893939393939394
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3469387755102041, precision 0.1997584541062802, recall 0.25385802469135804, F1 0.2235772357723577, AUC 0.5163966049382717
  Second-Tier acc 0.3469387755102041, precision 0.21818181818181817, recall 0.26851851851851855, F1 0.24074074074074073, AUC 0.5422178130511465
 
 test auc: 0.5422178130511465, test F1: 0.24074074074074073  :  from epoch 17
 current learn rate 4.151882739101114e-05
epoch: 18 idx: 0 First Loss : 2.1194300651550293, Second Loss : 2.8362605571746826
epoch: 18 idx: 200 First Loss : 0.7534749363560638, Second Loss : 0.8557457703325564
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4479166666666667, precision 0.4823232323232323, recall 0.4877777777777777, F1 0.38425925925925924, AUC 0.6237878787878788
  Second-Tier acc 0.3541666666666667, precision 0.4066137566137566, recall 0.42777777777777776, F1 0.2994107217355027, AUC 0.6047979797979798
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.35714285714285715, precision 0.19999999999999998, recall 0.26003086419753085, F1 0.22609706480674222, AUC 0.5089699074074073
  Second-Tier acc 0.3673469387755102, precision 0.2007722007722008, recall 0.2515432098765432, F1 0.22152777777777777, AUC 0.529210758377425
 
 test auc: 0.529210758377425, test F1: 0.22152777777777777  :  from epoch 18
 current learn rate 4.151882739101114e-05
epoch: 19 idx: 0 First Loss : 2.1048362255096436, Second Loss : 2.8234965801239014
epoch: 19 idx: 200 First Loss : 0.7506731602343596, Second Loss : 0.8532066723350343
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4270833333333333, precision 0.487859140605136, recall 0.47444444444444445, F1 0.36709003556829645, AUC 0.6259848484848485
  Second-Tier acc 0.3541666666666667, precision 0.4066137566137566, recall 0.42777777777777776, F1 0.2994107217355027, AUC 0.6124242424242424
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3469387755102041, precision 0.18356807511737092, recall 0.2391975308641975, F1 0.20770370370370372, AUC 0.4948192239858907
  Second-Tier acc 0.3673469387755102, precision 0.20467836257309943, recall 0.2515432098765432, F1 0.221978021978022, AUC 0.5201719576719577
 
 test auc: 0.5201719576719577, test F1: 0.221978021978022  :  from epoch 19{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.2730414743319939, "droprate_2": 0.0, "lr": 0.00019889961154750607, "weight_decay": 1.1887373642565777e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.00019889961154750607
epoch: 0 idx: 0 First Loss : 0.9078599810600281, Second Loss : 1.0359355211257935
epoch: 0 idx: 200 First Loss : 1.1047088359274082, Second Loss : 1.083954603221286
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.49306397306397304
  Second-Tier acc 0.25, precision 0.08333333333333333, recall 0.3333333333333333, F1 0.13333333333333333, AUC 0.5021717171717172
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.4538078091318833
  Second-Tier acc 0.2857142857142857, precision 0.09523809523809523, recall 0.3333333333333333, F1 0.14814814814814814, AUC 0.455136684303351
 
 test auc: 0.455136684303351, test F1: 0.14814814814814814  :  from epoch 0
 current learn rate 0.00019889961154750607
epoch: 1 idx: 0 First Loss : 1.4865809679031372, Second Loss : 1.829549789428711
epoch: 1 idx: 200 First Loss : 0.9862508735994795, Second Loss : 0.9806930069158326
>>>>>>>>>>> Validation Epoch: 1{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.2938366735843556, "droprate_2": 0.0, "lr": 0.0002109072034286695, "weight_decay": 0.00046017808764537723, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": true, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 0.0002109072034286695
epoch: 0 idx: 0 First Loss : 1.248099684715271, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0940841721991699, Second Loss : 1.081991150308011
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7429405162738495
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7630808080808081
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7100786302175192
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7145061728395062
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 1 idx: 0 First Loss : 1.7337232828140259, Second Loss : 1.6699392795562744
epoch: 1 idx: 200 First Loss : 0.9864680556515556, Second Loss : 0.9845314148201871
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7331425364758698
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7423737373737372
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7422472075249854
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7426697530864198
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 2 idx: 0 First Loss : 2.086902618408203, Second Loss : 1.9908947944641113
epoch: 2 idx: 200 First Loss : 0.9468133868788605, Second Loss : 0.9498974471839506
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5694444444444444, precision 0.4444444444444445, recall 0.40404040404040403, F1 0.34920634920634924, AUC 0.7311784511784513
  Second-Tier acc 0.5625, precision 0.40740740740740744, recall 0.393939393939394, F1 0.3333333333333333, AUC 0.7361111111111112
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18881118881118883, recall 0.3333333333333333, F1 0.24107142857142858, AUC 0.7441823437193807
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7465277777777778
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 3 idx: 0 First Loss : 2.9934749603271484, Second Loss : 2.8178675174713135
epoch: 3 idx: 200 First Loss : 0.9247219100390649, Second Loss : 0.9339280923022263
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6111111111111112, precision 0.3964912280701755, recall 0.4872727272727273, F1 0.43033509700176364, AUC 0.7269584736251402
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7393939393939393
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.6258503401360545, precision 0.3679781420765027, recall 0.42063492063492064, F1 0.37546258853515674, AUC 0.7258536645110718
  Second-Tier acc 0.5510204081632653, precision 0.20454545454545456, recall 0.3333333333333333, F1 0.2535211267605634, AUC 0.7279541446208112
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 4 idx: 0 First Loss : 3.6770365238189697, Second Loss : 3.6386606693267822
epoch: 4 idx: 200 First Loss : 0.9141101367836494, Second Loss : 0.9325434320620192
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.4027777777777778, precision 0.38300849575212387, recall 0.4444444444444444, F1 0.30890505890505887, AUC 0.7256172839506174
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7435858585858587
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.3934582682630574, recall 0.4129923574368019, F1 0.32725572697522204, AUC 0.7070595728003136
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.720844356261023
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 5 idx: 0 First Loss : 3.7556350231170654, Second Loss : 3.7137951850891113
epoch: 5 idx: 200 First Loss : 0.9145639176267334, Second Loss : 0.9272002560985437
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3680555555555556, precision 0.36944444444444446, recall 0.4222222222222222, F1 0.2784709843533373, AUC 0.7179573512906847
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7536363636363635
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6862568587105624
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.7199625220458555
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 6 idx: 0 First Loss : 3.906879425048828, Second Loss : 3.8229193687438965
epoch: 6 idx: 200 First Loss : 0.9118745988356506, Second Loss : 0.9228905036197558
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.6814141414141415
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7026767676767678
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.44623655913978494, recall 0.4279835390946502, F1 0.3161105962310781, AUC 0.6476092494611013
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6902557319223986
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 7 idx: 0 First Loss : 3.755035161972046, Second Loss : 3.5672800540924072
epoch: 7 idx: 200 First Loss : 0.9026192858379649, Second Loss : 0.9126222009738139
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.3780427223050174, recall 0.4177777777777778, F1 0.27251967631083024, AUC 0.6648597081930415
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6871212121212121
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.4490358126721763, recall 0.43621399176954734, F1 0.32901184550681023, AUC 0.6552456888105036
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.689484126984127
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 8 idx: 0 First Loss : 4.043216228485107, Second Loss : 3.8686468601226807
epoch: 8 idx: 200 First Loss : 0.8966786992596868, Second Loss : 0.9093915275610817
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3680555555555556, precision 0.38076416337285907, recall 0.4222222222222222, F1 0.27891156462585037, AUC 0.6639113355780023
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6764141414141415
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.6611368312757202
  Second-Tier acc 0.4897959183673469, precision 0.456140350877193, recall 0.4567901234567901, F1 0.3596673596673597, AUC 0.6773589065255732
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 9 idx: 0 First Loss : 3.8105952739715576, Second Loss : 3.603647470474243
epoch: 9 idx: 200 First Loss : 0.8945869201746773, Second Loss : 0.9049085789503164
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.375, precision 0.3848870056497175, recall 0.4266666666666667, F1 0.28710950565255206, AUC 0.6657182940516274
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.68010101010101
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46938775510204084, precision 0.45098039215686275, recall 0.4444444444444444, F1 0.34057971014492755, AUC 0.6681670096021947
  Second-Tier acc 0.4489795918367347, precision 0.456140350877193, recall 0.43209876543209874, F1 0.33186813186813185, AUC 0.6782407407407408
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 10 idx: 0 First Loss : 3.795010805130005, Second Loss : 3.7577457427978516
epoch: 10 idx: 200 First Loss : 0.8890257010674243, Second Loss : 0.9081381208111882
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.375, precision 0.5489587139203508, recall 0.4314814814814814, F1 0.2983351235230935, AUC 0.6558136924803591
  Second-Tier acc 0.3958333333333333, precision 0.39278752436647174, recall 0.44, F1 0.30652260904361744, AUC 0.6779292929292929
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46938775510204084, precision 0.5630885122410546, recall 0.45421810699588483, F1 0.3616851274950963, AUC 0.6670585929845189
  Second-Tier acc 0.4489795918367347, precision 0.452991452991453, recall 0.43209876543209874, F1 0.32848158131177, AUC 0.6783509700176368
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 11 idx: 0 First Loss : 3.7217304706573486, Second Loss : 3.7035622596740723
epoch: 11 idx: 200 First Loss : 0.8875920843544841, Second Loss : 0.9014873873805558
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3541666666666667, precision 0.4842498402869919, recall 0.422962962962963, F1 0.28995805115625944, AUC 0.6460549943883277
  Second-Tier acc 0.3333333333333333, precision 0.4298245614035088, recall 0.4144444444444444, F1 0.2777644391089769, AUC 0.6640404040404041
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.4853107344632768, recall 0.4254115226337449, F1 0.3212745098039216, AUC 0.6639966686262982
  Second-Tier acc 0.40816326530612246, precision 0.5070785070785071, recall 0.4367283950617284, F1 0.3316176470588235, AUC 0.6852954144620812
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 12 idx: 0 First Loss : 3.8767659664154053, Second Loss : 3.952780246734619
epoch: 12 idx: 200 First Loss : 0.8819218544251172, Second Loss : 0.9014371451158328
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.6513692480359147
  Second-Tier acc 0.2708333333333333, precision 0.3507936507936508, recall 0.35747474747474745, F1 0.22284961415396198, AUC 0.6659090909090909
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4421768707482993, precision 0.44623655913978494, recall 0.4279835390946502, F1 0.3161105962310781, AUC 0.6678424456202235
  Second-Tier acc 0.42857142857142855, precision 0.5520833333333334, recall 0.4962522045855379, F1 0.3925724637681159, AUC 0.6900903880070546
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 13 idx: 0 First Loss : 4.017961502075195, Second Loss : 3.7730560302734375
epoch: 13 idx: 200 First Loss : 0.8684941155040916, Second Loss : 0.8914270912932648
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3125, precision 0.3546666666666667, recall 0.38666666666666666, F1 0.2281293952180028, AUC 0.6521043771043771
  Second-Tier acc 0.2916666666666667, precision 0.3663324979114453, recall 0.3877777777777778, F1 0.23236663086287146, AUC 0.6750000000000002
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3877551020408163, precision 0.44533333333333336, recall 0.3950617283950617, F1 0.2718313373253493, AUC 0.6751726925338036
  Second-Tier acc 0.3673469387755102, precision 0.5163398692810458, recall 0.42989417989417994, F1 0.3138888888888889, AUC 0.6965388007054673
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 14 idx: 0 First Loss : 3.6107254028320312, Second Loss : 3.677828788757324
epoch: 14 idx: 200 First Loss : 0.8672603719240405, Second Loss : 0.886035995756165
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.35133565621370505, recall 0.38222222222222224, F1 0.22342264477095938, AUC 0.6553030303030303
  Second-Tier acc 0.2708333333333333, precision 0.3116531165311653, recall 0.36000000000000004, F1 0.18864468864468864, AUC 0.6763636363636364
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.35374149659863946, precision 0.4444444444444444, recall 0.37448559670781895, F1 0.23992673992673993, AUC 0.6774875073486184
  Second-Tier acc 0.3673469387755102, precision 0.49780701754385964, recall 0.41203703703703703, F1 0.28782051282051285, AUC 0.7058531746031745
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 15 idx: 0 First Loss : 3.6516802310943604, Second Loss : 3.6943914890289307
epoch: 15 idx: 200 First Loss : 0.8597178777413975, Second Loss : 0.8765169849166567
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3402777777777778, precision 0.43154761904761907, recall 0.41888888888888887, F1 0.2854237716306682, AUC 0.6564983164983166
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6723737373737374
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3877551020408163, precision 0.5029239766081871, recall 0.416740152851264, F1 0.3156974128822354, AUC 0.6876224769743288
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.7225529100529101
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 16 idx: 0 First Loss : 3.763347864151001, Second Loss : 3.927337169647217
epoch: 16 idx: 200 First Loss : 0.8527516850885629, Second Loss : 0.8781488630235632
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2986111111111111, precision 0.3451199338296112, recall 0.37777777777777777, F1 0.21588496429260762, AUC 0.6595679012345679
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6653030303030304
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3401360544217687, precision 0.441025641025641, recall 0.3662551440329218, F1 0.2227157913073774, AUC 0.6856628453850675
  Second-Tier acc 0.32653061224489793, precision 0.4393939393939394, recall 0.35802469135802467, F1 0.20689655172413793, AUC 0.7232694003527337
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 17 idx: 0 First Loss : 3.792006254196167, Second Loss : 3.7797882556915283
epoch: 17 idx: 200 First Loss : 0.8464088036052954, Second Loss : 0.8742172659910389
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3402777777777778, precision 0.4372093023255814, recall 0.42117845117845115, F1 0.3160278457374511, AUC 0.6605948372615039
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6666161616161617
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3741496598639456, precision 0.5423280423280423, recall 0.47354497354497355, F1 0.3491249491249491, AUC 0.6978309327846365
  Second-Tier acc 0.32653061224489793, precision 0.4326241134751773, recall 0.35802469135802467, F1 0.1989824759751272, AUC 0.7295524691358025
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 18 idx: 0 First Loss : 4.041167736053467, Second Loss : 4.135921955108643
epoch: 18 idx: 200 First Loss : 0.847907912961704, Second Loss : 0.8767471295381215
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6613524130190797
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6562121212121211
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.4385964912280702, recall 0.3621399176954732, F1 0.21303030303030301, AUC 0.6933115324319029
  Second-Tier acc 0.32653061224489793, precision 0.4326241134751773, recall 0.35802469135802467, F1 0.1989824759751272, AUC 0.7261353615520282
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 0.0002109072034286695
epoch: 19 idx: 0 First Loss : 4.0024542808532715, Second Loss : 3.9886579513549805
epoch: 19 idx: 200 First Loss : 0.8422281507067799, Second Loss : 0.8780510172150435
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2986111111111111, precision 0.3423477564102564, recall 0.37777777777777777, F1 0.212403538490495, AUC 0.6659034792368126
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6603535353535352
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.32653061224489793, precision 0.43703703703703706, recall 0.35802469135802467, F1 0.2041691018897331, AUC 0.6967286400156771
  Second-Tier acc 0.32653061224489793, precision 0.4326241134751773, recall 0.35802469135802467, F1 0.1989824759751272, AUC 0.7274029982363316
 
 test auc: 0.7145061728395062, test F1: 0.23684210526315788  :  from epoch 0{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.349335196202011, "droprate_2": 0.0, "lr": 1.0548479407744163e-05, "weight_decay": 1.7207283249158415e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
training slides: 385, validation slides: 48, test slides: 49
 current learn rate 1.0548479407744163e-05
epoch: 0 idx: 0 First Loss : 1.2322258949279785, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0552842913575433, Second Loss : 1.0371091952964442
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.6644276094276094
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7494949494949495
 
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6053179502253575
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6079144620811288
 
 test auc: 0.6079144620811288, test F1: 0.23684210526315788  :  from epoch 0
 current learn rate 1.0548479407744163e-05
epoch: 1 idx: 0 First Loss : 1.9784283638000488, Second Loss : 1.9232749938964844
epoch: 1 idx: 200 First Loss : 1.1031069961649862, Second Loss : 1.0899384001001198
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7067227833894499
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7587878787878788
 
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6486196844993141
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6580136684303352
 
 test auc: 0.6580136684303352, test F1: 0.23684210526315788  :  from epoch 1
 current learn rate 1.0548479407744163e-05
epoch: 2 idx: 0 First Loss : 2.1207008361816406, Second Loss : 2.080101251602173
epoch: 2 idx: 200 First Loss : 1.1007535027627329, Second Loss : 1.086946337970335
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7231874298540966
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7649494949494949
 
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6781243876151283
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6936177248677248
 
 test auc: 0.6936177248677248, test F1: 0.23684210526315788  :  from epoch 2
 current learn rate 1.0548479407744163e-05
epoch: 3 idx: 0 First Loss : 2.174738645553589, Second Loss : 2.139570951461792
epoch: 3 idx: 200 First Loss : 1.0895477316865874, Second Loss : 1.0762109880275395
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7335353535353536
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7688888888888888
 
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6961407505388987
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7025462962962963
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 4 idx: 0 First Loss : 2.241291046142578, Second Loss : 2.1999754905700684
epoch: 4 idx: 200 First Loss : 1.0784654529830116, Second Loss : 1.0648611319154055
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7419584736251403
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7605050505050506
 
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7052101704879483
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.708884479717813
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 5 idx: 0 First Loss : 2.314517021179199, Second Loss : 2.2668447494506836
epoch: 5 idx: 200 First Loss : 1.0673145406059366, Second Loss : 1.053975645434204
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408585858585859
  Second-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7524242424242424
 
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.712105624142661
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7098765432098766
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 6 idx: 0 First Loss : 2.3959686756134033, Second Loss : 2.3398406505584717
epoch: 6 idx: 200 First Loss : 1.0534315170785087, Second Loss : 1.041233266689884
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.5555555555555556, precision 0.5144927536231884, recall 0.38383838383838387, F1 0.32246108228317266, AUC 0.7373737373737373
  Second-Tier acc 0.6041666666666666, precision 0.4604651162790698, recall 0.4545454545454546, F1 0.411764705882353, AUC 0.7536363636363635
 
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7132446600039192
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7119157848324514
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 7 idx: 0 First Loss : 2.488905668258667, Second Loss : 2.426044464111328
epoch: 7 idx: 200 First Loss : 1.037921933911333, Second Loss : 1.0272697125427166
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.5694444444444444, precision 0.37215990796663795, recall 0.421010101010101, F1 0.3718599505401536, AUC 0.7366105499438832
  Second-Tier acc 0.6041666666666666, precision 0.39031339031339035, recall 0.4715151515151515, F1 0.4166666666666667, AUC 0.7564141414141415
 
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.6326530612244898, precision 0.7230639730639731, recall 0.4761904761904762, F1 0.47069284393228056, AUC 0.7040588869292573
  Second-Tier acc 0.6122448979591837, precision 0.35714285714285715, recall 0.4047619047619047, F1 0.35610766045548653, AUC 0.7099316578483245
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 8 idx: 0 First Loss : 2.5946223735809326, Second Loss : 2.5176749229431152
epoch: 8 idx: 200 First Loss : 1.0212262394045717, Second Loss : 1.0113364532960587
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.6875, precision 0.6458333333333334, recall 0.6021212121212122, F1 0.5997750787224471, AUC 0.7335521885521885
  Second-Tier acc 0.6666666666666666, precision 0.4296296296296296, recall 0.5963636363636363, F1 0.4965517241379311, AUC 0.7547979797979799
 
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.6326530612244898, precision 0.6088888888888889, recall 0.5692239858906526, F1 0.577952310451498, AUC 0.7005805408583187
  Second-Tier acc 0.5918367346938775, precision 0.5446998722860792, recall 0.4790564373897707, F1 0.4714285714285715, AUC 0.7043099647266313
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 9 idx: 0 First Loss : 2.71223521232605, Second Loss : 2.6303138732910156
epoch: 9 idx: 200 First Loss : 1.0054583910722934, Second Loss : 0.996562092180424
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.6111111111111112, precision 0.555050505050505, recall 0.5546801346801347, F1 0.5548281999172774, AUC 0.7309203142536477
  Second-Tier acc 0.625, precision 0.5869565217391305, recall 0.5841414141414141, F1 0.5075863678804855, AUC 0.7547474747474747
 
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.5782312925170068, precision 0.5296283125230494, recall 0.5613609641387419, F1 0.5365379120682882, AUC 0.7046039094650206
  Second-Tier acc 0.5918367346938775, precision 0.5424242424242425, recall 0.5427689594356261, F1 0.5239548810977382, AUC 0.7240961199294533
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 10 idx: 0 First Loss : 2.830270767211914, Second Loss : 2.7504076957702637
epoch: 10 idx: 200 First Loss : 0.9911834737517644, Second Loss : 0.9835791025699964
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.5486111111111112, precision 0.5191697334345854, recall 0.5249158249158249, F1 0.5114697198379908, AUC 0.7271212121212121
  Second-Tier acc 0.5, precision 0.5326797385620915, recall 0.5016161616161617, F1 0.4475772765246449, AUC 0.7546969696969695
 
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.5170068027210885, precision 0.48569739952718677, recall 0.522633744855967, F1 0.4815499698299351, AUC 0.7063737017440722
  Second-Tier acc 0.6326530612244898, precision 0.6305982347172278, recall 0.6261022927689593, F1 0.6078600339469905, AUC 0.7358906525573192
 
 test auc: 0.7025462962962963, test F1: 0.23684210526315788  :  from epoch 3
 current learn rate 1.0548479407744163e-05
epoch: 11 idx: 0 First Loss : 2.94539737701416, Second Loss : 2.8672525882720947
epoch: 11 idx: 200 First Loss : 0.9789709048484688, Second Loss : 0.972321360580512
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.5, precision 0.4930555555555555, recall 0.4921212121212122, F1 0.4685261621846988, AUC 0.7265544332210999
  Second-Tier acc 0.5, precision 0.5846394984326019, recall 0.5474747474747474, F1 0.4851851851851852, AUC 0.7715151515151515
 
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4557823129251701, precision 0.4499070847851336, recall 0.4936801881246326, F1 0.43173763757319356, AUC 0.7098030570252792
  Second-Tier acc 0.6122448979591837, precision 0.6240079365079366, recall 0.6902557319223986, F1 0.625359911406423, AUC 0.7517636684303352
 
 test auc: 0.7517636684303352, test F1: 0.625359911406423  :  from epoch 11
 current learn rate 1.0548479407744163e-05
epoch: 12 idx: 0 First Loss : 3.057460069656372, Second Loss : 2.9806838035583496
epoch: 12 idx: 200 First Loss : 0.9695945365623159, Second Loss : 0.9639383625721012
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4513888888888889, precision 0.4835263835263836, recall 0.4697979797979798, F1 0.4276292335115865, AUC 0.7266554433221101
  Second-Tier acc 0.4791666666666667, precision 0.5523809523809523, recall 0.5341414141414141, F1 0.4635808635808636, AUC 0.7865151515151515
 
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.43537414965986393, precision 0.4657816583511523, recall 0.49492945326278653, F1 0.42174688057040993, AUC 0.7156084656084656
  Second-Tier acc 0.5510204081632653, precision 0.5714285714285714, recall 0.6417548500881834, F1 0.5624115721676697, AUC 0.7605268959435625
 
 test auc: 0.7605268959435625, test F1: 0.5624115721676697  :  from epoch 12
 current learn rate 1.0548479407744163e-05
epoch: 13 idx: 0 First Loss : 3.154717206954956, Second Loss : 3.084075927734375
epoch: 13 idx: 200 First Loss : 0.9615186902680504, Second Loss : 0.9571273565866906
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.4375, precision 0.4841153470185729, recall 0.46572390572390576, F1 0.41567027473072615, AUC 0.7311952861952862
  Second-Tier acc 0.5, precision 0.5724867724867725, recall 0.5763636363636363, F1 0.49589408412937824, AUC 0.7986868686868687
 
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4217687074829932, precision 0.46139345867606735, recall 0.49647266313932975, F1 0.41191576784797124, AUC 0.7224365569272977
  Second-Tier acc 0.5306122448979592, precision 0.5594405594405595, recall 0.6294091710758377, F1 0.5454545454545454, AUC 0.7641093474426809
 
 test auc: 0.7641093474426809, test F1: 0.5454545454545454  :  from epoch 13
 current learn rate 1.0548479407744163e-05
epoch: 14 idx: 0 First Loss : 3.242661714553833, Second Loss : 3.175666093826294
epoch: 14 idx: 200 First Loss : 0.9550755125428758, Second Loss : 0.9514575892345822
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.4444444444444444, precision 0.50061674562582, recall 0.4806397306397307, F1 0.4252445692991624, AUC 0.7388327721661055
  Second-Tier acc 0.5208333333333334, precision 0.5907407407407407, recall 0.6041414141414142, F1 0.5201784417470692, AUC 0.80510101010101
 
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.43537414965986393, precision 0.4827876984126984, recall 0.522119341563786, F1 0.4294612794612795, AUC 0.7264476778365667
  Second-Tier acc 0.5306122448979592, precision 0.5732103645147123, recall 0.6408730158730159, F1 0.5409734677469231, AUC 0.7727623456790123
 
 test auc: 0.7727623456790123, test F1: 0.5409734677469231  :  from epoch 14
 current learn rate 1.0548479407744163e-05
epoch: 15 idx: 0 First Loss : 3.31805682182312, Second Loss : 3.2544729709625244
epoch: 15 idx: 200 First Loss : 0.9495920680824723, Second Loss : 0.9467220525697466
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.4166666666666667, precision 0.48760760760760763, recall 0.4637037037037037, F1 0.4037140637140637, AUC 0.7410157126823794
  Second-Tier acc 0.4791666666666667, precision 0.5583333333333332, recall 0.563030303030303, F1 0.47474747474747475, AUC 0.8143434343434343
 
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4489795918367347, precision 0.5146412389260837, recall 0.5456349206349206, F1 0.447949615417855, AUC 0.7305322849304332
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7763999118165784
 
 test auc: 0.7763999118165784, test F1: 0.53203007518797  :  from epoch 15
 current learn rate 1.0548479407744163e-05
epoch: 16 idx: 0 First Loss : 3.3812923431396484, Second Loss : 3.3211588859558105
epoch: 16 idx: 200 First Loss : 0.9451784317877459, Second Loss : 0.9428917732349231
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.4305555555555556, precision 0.513888888888889, recall 0.48474747474747476, F1 0.42330714552936777, AUC 0.7448484848484848
  Second-Tier acc 0.4583333333333333, precision 0.544047619047619, recall 0.5496969696969697, F1 0.4530423280423281, AUC 0.814949494949495
 
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.4489795918367347, precision 0.5337559557457805, recall 0.543503821281599, F1 0.4492174851592013, AUC 0.7329389574759944
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7781635802469135
 
 test auc: 0.7781635802469135, test F1: 0.53203007518797  :  from epoch 16
 current learn rate 1.0548479407744163e-05
epoch: 17 idx: 0 First Loss : 3.437241792678833, Second Loss : 3.3777408599853516
epoch: 17 idx: 200 First Loss : 0.9413729417577978, Second Loss : 0.9393431128776488
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.4027777777777778, precision 0.5000700280112045, recall 0.46781144781144784, F1 0.3983244628424995, AUC 0.7478563411896745
  Second-Tier acc 0.4375, precision 0.530982905982906, recall 0.5363636363636364, F1 0.43056420475775314, AUC 0.8153030303030303
 
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.4421768707482993, precision 0.546588564692013, recall 0.5410787771898883, F1 0.44380547143255145, AUC 0.7356640701548108
  Second-Tier acc 0.5306122448979592, precision 0.6233660130718954, recall 0.6523368606701939, F1 0.53203007518797, AUC 0.7748567019400353
 
 test auc: 0.7748567019400353, test F1: 0.53203007518797  :  from epoch 17
 current learn rate 1.0548479407744163e-05
epoch: 18 idx: 0 First Loss : 3.4830057621002197, Second Loss : 3.423025608062744
epoch: 18 idx: 200 First Loss : 0.9374742644320043, Second Loss : 0.9360386250744486
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.4236111111111111, precision 0.5214804429105551, recall 0.5046127946127946, F1 0.4227535278204284, AUC 0.751969696969697
  Second-Tier acc 0.4166666666666667, precision 0.5123456790123456, recall 0.5085858585858586, F1 0.4064222683351149, AUC 0.8177777777777777
 
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.4489795918367347, precision 0.552243018419489, recall 0.5490152851263962, F1 0.4518238442289075, AUC 0.7403181951793062
  Second-Tier acc 0.5510204081632653, precision 0.6391666666666667, recall 0.6761463844797179, F1 0.5519536019536019, AUC 0.7827932098765432
 
 test auc: 0.7827932098765432, test F1: 0.5519536019536019  :  from epoch 18
 current learn rate 1.0548479407744163e-05
epoch: 19 idx: 0 First Loss : 3.5140602588653564, Second Loss : 3.4561593532562256
epoch: 19 idx: 200 First Loss : 0.9338825683304067, Second Loss : 0.932579714677468
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.4305555555555556, precision 0.5301587301587302, recall 0.5212121212121211, F1 0.4303072391145486, AUC 0.7548204264870932
  Second-Tier acc 0.4166666666666667, precision 0.5158730158730159, recall 0.5085858585858586, F1 0.4066721808657292, AUC 0.8161111111111111
 
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.4489795918367347, precision 0.5675324675324676, recall 0.5528365667254556, F1 0.4515418985586123, AUC 0.7430678032529885
  Second-Tier acc 0.5102040816326531, precision 0.6005291005291006, recall 0.5928130511463845, F1 0.4990180551156161, AUC 0.7901785714285715
 
 test auc: 0.7827932098765432, test F1: 0.5519536019536019  :  from epoch 18{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 30, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.3368924464789325, "droprate_2": 0.0, "lr": 0.000299725417841107, "weight_decay": 1.844101509264814e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "disable_writer": true}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.000299725417841107
epoch: 0 idx: 0 First Loss : 1.2241932153701782, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0837243580773694, Second Loss : 1.0750563111693705
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7374915824915824
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7555555555555555
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7074331275720165
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7124118165784833
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.000299725417841107
epoch: 1 idx: 0 First Loss : 1.828935980796814, Second Loss : 1.723060965538025
epoch: 1 idx: 200 First Loss : 0.9692929090552069, Second Loss : 0.984740420138065
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5347222222222222, precision 0.5093896713615024, recall 0.35353535353535354, F1 0.26850998463901693, AUC 0.7321212121212121
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7408585858585859
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7176170879874584
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7246472663139331
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.000299725417841107
epoch: 2 idx: 0 First Loss : 2.5090677738189697, Second Loss : 2.3890867233276367
epoch: 2 idx: 200 First Loss : 0.9407521500368023, Second Loss : 0.9632978118696616
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.36656034024455075, recall 0.48484848484848486, F1 0.3954280261131715, AUC 0.7221043771043772
  Second-Tier acc 0.625, precision 0.7056451612903226, recall 0.5036363636363637, F1 0.47222222222222215, AUC 0.7404040404040404
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.564625850340136, precision 0.708095419363025, recall 0.471928277483833, F1 0.4460188933873144, AUC 0.7041568685087203
  Second-Tier acc 0.5510204081632653, precision 0.34072580645161293, recall 0.4799382716049383, F1 0.3917624521072797, AUC 0.71086860670194
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.000299725417841107
epoch: 3 idx: 0 First Loss : 3.260425567626953, Second Loss : 3.0707128047943115
epoch: 3 idx: 200 First Loss : 0.9205489209505604, Second Loss : 0.9416880399053592
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3888888888888889, precision 0.3779677113010447, recall 0.43555555555555553, F1 0.2969934640522876, AUC 0.7114534231200897
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7377272727272728
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4489795918367347, precision 0.3934582682630574, recall 0.4129923574368019, F1 0.32725572697522204, AUC 0.6849708504801097
  Second-Tier acc 0.4897959183673469, precision 0.42267267267267267, recall 0.445326278659612, F1 0.35796882855706386, AUC 0.7068452380952381
Test AUC: 0.7124, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.000299725417841107
epoch: 4 idx: 0 First Loss : 3.838285446166992, Second Loss : 3.639890670776367
epoch: 4 idx: 200 First Loss : 0.9209347050741259, Second Loss : 0.9304374355257521
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.721391694725028
  Second-Tier acc 0.375, precision 0.35327635327635326, recall 0.4266666666666667, F1 0.283921568627451, AUC 0.7637373737373737
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4421768707482993, precision 0.4320218579234973, recall 0.42416225749559083, F1 0.31761006289308175, AUC 0.6786387909073094
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.7221671075837742
Test AUC: 0.7222, Test F1: 0.3395 (Best Epoch: 4)
Current LR: 0.000299725417841107
epoch: 5 idx: 0 First Loss : 3.7066690921783447, Second Loss : 3.631077527999878
epoch: 5 idx: 200 First Loss : 0.910836988017519, Second Loss : 0.9209929933303513
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3472222222222222, precision 0.3600052042674993, recall 0.40888888888888886, F1 0.2599910394265233, AUC 0.702283950617284
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7846969696969698
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.4471544715447155, recall 0.4197530864197531, F1 0.306951871657754, AUC 0.6472785616304134
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7058531746031745
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 6 idx: 0 First Loss : 3.6561195850372314, Second Loss : 3.734487771987915
epoch: 6 idx: 200 First Loss : 0.9028773708422483, Second Loss : 0.9203774882770093
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3333333333333333, precision 0.36577777777777776, recall 0.39999999999999997, F1 0.246767388049544, AUC 0.6901459034792369
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7246464646464646
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3945578231292517, precision 0.4427083333333333, recall 0.3991769547325103, F1 0.27467151809177276, AUC 0.6222932588673329
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6787918871252204
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 7 idx: 0 First Loss : 3.782773971557617, Second Loss : 3.987678050994873
epoch: 7 idx: 200 First Loss : 0.9007456661749339, Second Loss : 0.9180495705176377
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3055555555555556, precision 0.34920634920634924, recall 0.38222222222222224, F1 0.22076178361953222, AUC 0.6718911335578003
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.717929292929293
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.38095238095238093, precision 0.44020356234096686, recall 0.3909465020576131, F1 0.2600953250177467, AUC 0.6267391730354693
  Second-Tier acc 0.3877551020408163, precision 0.4471544715447155, recall 0.3950617283950617, F1 0.27386363636363636, AUC 0.654265873015873
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 8 idx: 0 First Loss : 3.8589906692504883, Second Loss : 4.088939666748047
epoch: 8 idx: 200 First Loss : 0.9019927977977711, Second Loss : 0.9256605839609303
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2986111111111111, precision 0.34302442963860286, recall 0.37777777777777777, F1 0.21325757575757576, AUC 0.6660998877665544
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.7066666666666667
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.44020356234096686, recall 0.38271604938271603, F1 0.24787121635900303, AUC 0.6245713305898491
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6494157848324514
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 9 idx: 0 First Loss : 3.838796854019165, Second Loss : 4.042934894561768
epoch: 9 idx: 200 First Loss : 0.8992920053448566, Second Loss : 0.9243890922124189
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2986111111111111, precision 0.34441025641025647, recall 0.37777777777777777, F1 0.2149980820866897, AUC 0.6661335578002244
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.7042929292929293
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.35374149659863946, precision 0.4385964912280702, recall 0.37448559670781895, F1 0.23326007326007325, AUC 0.6278230942582795
  Second-Tier acc 0.40816326530612246, precision 0.4444444444444444, recall 0.40740740740740744, F1 0.2878787878787879, AUC 0.6542107583774252
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 10 idx: 0 First Loss : 3.7875802516937256, Second Loss : 3.8860182762145996
epoch: 10 idx: 200 First Loss : 0.8914139988935234, Second Loss : 0.9133133777762289
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2986111111111111, precision 0.34371184371184377, recall 0.37777777777777777, F1 0.2141223556317896, AUC 0.668148148148148
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6973737373737374
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.35374149659863946, precision 0.44020356234096686, recall 0.37448559670781895, F1 0.2351097842427322, AUC 0.6437695963158926
  Second-Tier acc 0.3877551020408163, precision 0.4444444444444444, recall 0.3950617283950617, F1 0.2708333333333333, AUC 0.6598324514991182
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 11 idx: 0 First Loss : 3.772364616394043, Second Loss : 3.889906406402588
epoch: 11 idx: 200 First Loss : 0.8813126186305362, Second Loss : 0.908411282920506
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2986111111111111, precision 0.34371184371184377, recall 0.37777777777777777, F1 0.2141223556317896, AUC 0.6618125701459036
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6792424242424242
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3401360544217687, precision 0.44186046511627913, recall 0.3662551440329218, F1 0.22366778369143833, AUC 0.6414241622574955
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6585648148148149
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 12 idx: 0 First Loss : 3.7234535217285156, Second Loss : 3.8156135082244873
epoch: 12 idx: 200 First Loss : 0.8709554849089877, Second Loss : 0.9016500282973652
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.2847222222222222, precision 0.33042424242424245, recall 0.3688888888888889, F1 0.2012560102050829, AUC 0.6573120089786757
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6712121212121213
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.35374149659863946, precision 0.47387258410880456, recall 0.3842592592592593, F1 0.2513947590870668, AUC 0.6359923084460122
  Second-Tier acc 0.3469387755102041, precision 0.4393939393939394, recall 0.3703703703703704, F1 0.22758620689655173, AUC 0.6484237213403881
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 13 idx: 0 First Loss : 3.876138687133789, Second Loss : 3.94185209274292
epoch: 13 idx: 200 First Loss : 0.864643426862841, Second Loss : 0.8957833533855338
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.2986111111111111, precision 0.3480769230769231, recall 0.37777777777777777, F1 0.21954842543077838, AUC 0.6390460157126824
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6432828282828283
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.4888888888888889, recall 0.3902116402116402, F1 0.2665112665112665, AUC 0.6356861160101901
  Second-Tier acc 0.3469387755102041, precision 0.44186046511627913, recall 0.3703703703703704, F1 0.23040935672514617, AUC 0.6436287477954145
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 14 idx: 0 First Loss : 4.016479015350342, Second Loss : 4.122529029846191
epoch: 14 idx: 200 First Loss : 0.8545110764181791, Second Loss : 0.8844442355112728
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.2847222222222222, precision 0.33113391984359725, recall 0.3688888888888889, F1 0.20214289241100084, AUC 0.654983164983165
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6684343434343435
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3333333333333333, precision 0.468349358974359, recall 0.37191358024691357, F1 0.2287009118652121, AUC 0.6479583088379385
  Second-Tier acc 0.32653061224489793, precision 0.43478260869565216, recall 0.35802469135802467, F1 0.2015325670498084, AUC 0.6512345679012347
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 15 idx: 0 First Loss : 4.107889652252197, Second Loss : 4.327866077423096
epoch: 15 idx: 200 First Loss : 0.8588557864037347, Second Loss : 0.8889070472122698
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.2847222222222222, precision 0.33258817685047193, recall 0.3688888888888889, F1 0.20395098774693673, AUC 0.6491863075196408
  Second-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.6634848484848485
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.3333333333333333, precision 0.4658444022770398, recall 0.37191358024691357, F1 0.2309118728910596, AUC 0.6485155790711347
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6608245149911817
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 16 idx: 0 First Loss : 4.073664665222168, Second Loss : 4.916583061218262
epoch: 16 idx: 200 First Loss : 0.8460573931987534, Second Loss : 0.8851396135196026
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.2847222222222222, precision 0.33042424242424245, recall 0.3688888888888889, F1 0.2012560102050829, AUC 0.6550280583613917
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6635353535353535
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3197278911564626, precision 0.46493055555555557, recall 0.3636831275720165, F1 0.21317244846656613, AUC 0.6464028512639625
  Second-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6589506172839507
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 17 idx: 0 First Loss : 4.004655361175537, Second Loss : 4.3827691078186035
epoch: 17 idx: 200 First Loss : 0.8480403198487529, Second Loss : 0.8866399092005643
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.3956349206349206, recall 0.3781481481481481, F1 0.21626139306494466, AUC 0.6562289562289562
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6648484848484849
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3197278911564626, precision 0.46493055555555557, recall 0.3636831275720165, F1 0.21317244846656613, AUC 0.6501383989809916
  Second-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6560846560846562
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 18 idx: 0 First Loss : 3.9238693714141846, Second Loss : 4.213515758514404
epoch: 18 idx: 200 First Loss : 0.838987678270296, Second Loss : 0.8684647148820421
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2777777777777778, precision 0.37063492063492065, recall 0.36925925925925923, F1 0.2010503045817396, AUC 0.6558024691358024
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6617171717171718
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.30612244897959184, precision 0.4640130861504907, recall 0.3554526748971194, F1 0.19545782765989425, AUC 0.6535065157750343
  Second-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6548721340388007
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 19 idx: 0 First Loss : 4.068463325500488, Second Loss : 4.325283527374268
epoch: 19 idx: 200 First Loss : 0.8431027796612067, Second Loss : 0.8743402836899732
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.2638888888888889, precision 0.3715956558061821, recall 0.3603703703703703, F1 0.1817120937831422, AUC 0.6692480359147025
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6891919191919191
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.29931972789115646, precision 0.43123543123543123, recall 0.3415637860082305, F1 0.16741560837946382, AUC 0.6649213697824808
  Second-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6590057319223986
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 20 idx: 0 First Loss : 3.9531610012054443, Second Loss : 4.2145185470581055
epoch: 20 idx: 200 First Loss : 0.8334787048189374, Second Loss : 0.8658660139566687
>>>>>>>>>>> Validation Epoch: 20
  First-Tier acc 0.2638888888888889, precision 0.39230279898218834, recall 0.3603703703703703, F1 0.1826311899482631, AUC 0.6733389450056116
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6904040404040405
>>>>>>>>>>> Test Epoch: 20
  First-Tier acc 0.30612244897959184, precision 0.4824016563146998, recall 0.3554526748971194, F1 0.19312518892775402, AUC 0.6714310209680581
  Second-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6543761022927689
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 21 idx: 0 First Loss : 3.8895671367645264, Second Loss : 4.140350818634033
epoch: 21 idx: 200 First Loss : 0.8177360356579884, Second Loss : 0.8381281943873625
>>>>>>>>>>> Validation Epoch: 21
  First-Tier acc 0.2638888888888889, precision 0.3445305770887166, recall 0.3603703703703703, F1 0.18353909465020576, AUC 0.6750701459034794
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6662121212121211
>>>>>>>>>>> Test Epoch: 21
  First-Tier acc 0.29931972789115646, precision 0.43405275779376495, recall 0.3415637860082305, F1 0.17076038962479753, AUC 0.6797288359788359
  Second-Tier acc 0.30612244897959184, precision 0.4393939393939394, recall 0.345679012345679, F1 0.1847290640394089, AUC 0.6749338624338624
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 22 idx: 0 First Loss : 4.118439197540283, Second Loss : 4.384055137634277
epoch: 22 idx: 200 First Loss : 0.8334597200322564, Second Loss : 0.8507000096634783
>>>>>>>>>>> Validation Epoch: 22
  First-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6765768799102133
  Second-Tier acc 0.2708333333333333, precision 0.30952380952380953, recall 0.36000000000000004, F1 0.18598382749326148, AUC 0.6718686868686868
>>>>>>>>>>> Test Epoch: 22
  First-Tier acc 0.30612244897959184, precision 0.4305555555555556, recall 0.345679012345679, F1 0.17434715821812596, AUC 0.6875367430922986
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6752094356261024
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 23 idx: 0 First Loss : 3.837369203567505, Second Loss : 4.143078804016113
epoch: 23 idx: 200 First Loss : 0.8168649153639618, Second Loss : 0.8415463754084755
>>>>>>>>>>> Validation Epoch: 23
  First-Tier acc 0.2569444444444444, precision 0.3037037037037037, recall 0.3511111111111111, F1 0.16387419165196943, AUC 0.6757856341189674
  Second-Tier acc 0.2708333333333333, precision 0.30749354005167956, recall 0.36000000000000004, F1 0.18342151675485008, AUC 0.6741414141414142
>>>>>>>>>>> Test Epoch: 23
  First-Tier acc 0.29931972789115646, precision 0.4305555555555556, recall 0.3415637860082305, F1 0.16660189143671458, AUC 0.6709349892220263
  Second-Tier acc 0.32653061224489793, precision 0.5085271317829457, recall 0.3873456790123457, F1 0.2388342651500546, AUC 0.667989417989418
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 24 idx: 0 First Loss : 4.017093181610107, Second Loss : 4.226743221282959
epoch: 24 idx: 200 First Loss : 0.8221522116969661, Second Loss : 0.8471277743308167
>>>>>>>>>>> Validation Epoch: 24
  First-Tier acc 0.2777777777777778, precision 0.36313131313131314, recall 0.36925925925925923, F1 0.20412180936631677, AUC 0.6682210998877665
  Second-Tier acc 0.2708333333333333, precision 0.350564468211527, recall 0.35747474747474745, F1 0.22475270301357253, AUC 0.6613131313131313
>>>>>>>>>>> Test Epoch: 24
  First-Tier acc 0.3197278911564626, precision 0.49533333333333335, recall 0.38323045267489714, F1 0.22918347314134055, AUC 0.6782407407407408
  Second-Tier acc 0.3469387755102041, precision 0.5416666666666666, recall 0.46472663139329806, F1 0.3088336783988958, AUC 0.6789572310405644
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 25 idx: 0 First Loss : 4.179390907287598, Second Loss : 4.482843399047852
epoch: 25 idx: 200 First Loss : 0.8456150821088358, Second Loss : 0.8477260400821353
>>>>>>>>>>> Validation Epoch: 25
  First-Tier acc 0.2708333333333333, precision 0.33208955223880593, recall 0.36000000000000004, F1 0.17992929803044513, AUC 0.6789842873176207
  Second-Tier acc 0.2708333333333333, precision 0.35202991452991456, recall 0.35747474747474745, F1 0.22932447397563674, AUC 0.6492424242424242
>>>>>>>>>>> Test Epoch: 25
  First-Tier acc 0.30612244897959184, precision 0.4326241134751773, recall 0.345679012345679, F1 0.17681498829039813, AUC 0.6829193611601019
  Second-Tier acc 0.3673469387755102, precision 0.5535353535353535, recall 0.48853615520282184, F1 0.3241487159155984, AUC 0.7036485890652556
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 26 idx: 0 First Loss : 4.028711795806885, Second Loss : 4.323713779449463
epoch: 26 idx: 200 First Loss : 0.8154459880637511, Second Loss : 0.8276980128067307
>>>>>>>>>>> Validation Epoch: 26
  First-Tier acc 0.2777777777777778, precision 0.36156095366621677, recall 0.36925925925925923, F1 0.20698064987221612, AUC 0.6610157126823794
  Second-Tier acc 0.3333333333333333, precision 0.42841458058849363, recall 0.43828282828282833, F1 0.32212885154061627, AUC 0.6434848484848484
>>>>>>>>>>> Test Epoch: 26
  First-Tier acc 0.3333333333333333, precision 0.5055555555555556, recall 0.4012345679012346, F1 0.25220458553791886, AUC 0.6825335586909661
  Second-Tier acc 0.3469387755102041, precision 0.553623188405797, recall 0.5004409171075838, F1 0.32378195281421085, AUC 0.6944995590828924
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 27 idx: 0 First Loss : 4.255548000335693, Second Loss : 4.499607563018799
epoch: 27 idx: 200 First Loss : 0.8395537591481997, Second Loss : 0.8583772519056683
>>>>>>>>>>> Validation Epoch: 27
  First-Tier acc 0.2569444444444444, precision 0.30310457516339867, recall 0.3511111111111111, F1 0.16309932549248787, AUC 0.6870426487093154
  Second-Tier acc 0.3125, precision 0.40009337068160594, recall 0.413030303030303, F1 0.28752473580059784, AUC 0.6723737373737374
>>>>>>>>>>> Test Epoch: 27
  First-Tier acc 0.3129251700680272, precision 0.43123543123543123, recall 0.3497942386831276, F1 0.1827239003709592, AUC 0.6829132373113854
  Second-Tier acc 0.3673469387755102, precision 0.5592592592592592, recall 0.5063932980599647, F1 0.3338328338328338, AUC 0.7170414462081128
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 28 idx: 0 First Loss : 4.22346305847168, Second Loss : 4.569646835327148
epoch: 28 idx: 200 First Loss : 0.8074774824061384, Second Loss : 0.8286458280495037
>>>>>>>>>>> Validation Epoch: 28
  First-Tier acc 0.2986111111111111, precision 0.36648745519713266, recall 0.37777777777777777, F1 0.21675574102545334, AUC 0.6375533108866441
  Second-Tier acc 0.2708333333333333, precision 0.3849206349206349, recall 0.34737373737373733, F1 0.26291486291486293, AUC 0.6206565656565657
>>>>>>>>>>> Test Epoch: 28
  First-Tier acc 0.3877551020408163, precision 0.5453333333333333, recall 0.4243827160493827, F1 0.3125097054467914, AUC 0.6824417009602195
  Second-Tier acc 0.3469387755102041, precision 0.547878787878788, recall 0.5068342151675486, F1 0.33553930105654245, AUC 0.7013888888888888
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.000299725417841107
epoch: 29 idx: 0 First Loss : 4.088466167449951, Second Loss : 3.76322340965271
epoch: 29 idx: 200 First Loss : 0.7809785966638672, Second Loss : 0.7940954566963527
>>>>>>>>>>> Validation Epoch: 29
  First-Tier acc 0.2638888888888889, precision 0.31957671957671957, recall 0.35555555555555557, F1 0.171602787456446, AUC 0.6667059483726151
  Second-Tier acc 0.2916666666666667, precision 0.39589169000933705, recall 0.3802020202020202, F1 0.27632520735969013, AUC 0.646969696969697
>>>>>>>>>>> Test Epoch: 29
  First-Tier acc 0.29931972789115646, precision 0.4305555555555556, recall 0.3415637860082305, F1 0.16660189143671458, AUC 0.6716882226141485
  Second-Tier acc 0.3469387755102041, precision 0.5524475524475524, recall 0.5004409171075838, F1 0.3238095238095238, AUC 0.7242614638447972
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.49468212732940336, "droprate_2": 0.0, "lr": 0.0001627201044126089, "weight_decay": 6.294209584566105e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0001627201044126089
epoch: 0 idx: 0 First Loss : 1.2687053680419922, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.109911536028729, Second Loss : 1.0947845084453696
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7372222222222223
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7462626262626261
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7182172251616695
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7160493827160493
Test AUC: 0.7160, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001627201044126089
epoch: 1 idx: 0 First Loss : 1.5551940202713013, Second Loss : 1.918308973312378
epoch: 1 idx: 200 First Loss : 0.9779169487567684, Second Loss : 0.9979702005931987
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7301571268237934
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.737979797979798
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7192154125024496
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7180335097001764
Test AUC: 0.7160, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001627201044126089
epoch: 2 idx: 0 First Loss : 2.1733601093292236, Second Loss : 2.5100393295288086
epoch: 2 idx: 200 First Loss : 0.9324453820043536, Second Loss : 0.9614010697499437
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5208333333333334, precision 0.517415642493042, recall 0.5121885521885522, F1 0.49743899743899744, AUC 0.7070707070707071
  Second-Tier acc 0.6458333333333334, precision 0.5888888888888889, recall 0.5898989898989899, F1 0.5794871794871795, AUC 0.7307070707070707
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5306122448979592, precision 0.5176892073443798, recall 0.5440182245737801, F1 0.5177280302503432, AUC 0.699196551048403
  Second-Tier acc 0.5918367346938775, precision 0.573931988254239, recall 0.5963403880070547, F1 0.5814547754585706, AUC 0.7054673721340388
Test AUC: 0.7160, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001627201044126089
epoch: 3 idx: 0 First Loss : 2.8803186416625977, Second Loss : 3.505389928817749
epoch: 3 idx: 200 First Loss : 0.9124796921896994, Second Loss : 0.945182498674191
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4305555555555556, precision 0.5296794871794872, recall 0.49232323232323233, F1 0.43569321533923305, AUC 0.7164927048260381
  Second-Tier acc 0.4375, precision 0.5139860139860141, recall 0.47101010101010105, F1 0.4377203290246769, AUC 0.7416161616161615
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.4965986394557823, precision 0.5620015948963318, recall 0.5735596707818931, F1 0.5048501844357497, AUC 0.7100663825200862
  Second-Tier acc 0.5102040816326531, precision 0.5641025641025641, recall 0.5584215167548501, F1 0.5185185185185185, AUC 0.7111441798941799
Test AUC: 0.7160, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0001627201044126089
epoch: 4 idx: 0 First Loss : 3.4198696613311768, Second Loss : 4.066613674163818
epoch: 4 idx: 200 First Loss : 0.9091623942529903, Second Loss : 0.9427255774148513
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3541666666666667, precision 0.5336134453781513, recall 0.43259259259259264, F1 0.3067921780736426, AUC 0.7278563411896745
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.7743434343434344
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.46938775510204084, precision 0.5843188588968132, recall 0.5149911816578483, F1 0.4401335180292056, AUC 0.7196869488536156
  Second-Tier acc 0.4489795918367347, precision 0.41111111111111115, recall 0.42063492063492064, F1 0.32568417474077854, AUC 0.720623897707231
Test AUC: 0.7206, Test F1: 0.3257 (Best Epoch: 4)
Current LR: 0.0001627201044126089
epoch: 5 idx: 0 First Loss : 3.5286571979522705, Second Loss : 4.138461112976074
epoch: 5 idx: 200 First Loss : 0.9116253144801617, Second Loss : 0.936566631786933
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3402777777777778, precision 0.370132648694908, recall 0.40444444444444444, F1 0.25450081833060556, AUC 0.7420314253647587
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7852525252525252
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.4918091168091168, recall 0.4298206937095826, F1 0.33513591215322297, AUC 0.708884479717813
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.7331349206349206
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 6 idx: 0 First Loss : 3.7270915508270264, Second Loss : 3.9869771003723145
epoch: 6 idx: 200 First Loss : 0.9070470407500919, Second Loss : 0.9304231841578171
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.2916666666666667, precision 0.3333333333333333, recall 0.37333333333333335, F1 0.20229885057471264, AUC 0.7015656565656565
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.7298484848484849
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.3673469387755102, precision 0.43781094527363185, recall 0.38271604938271603, F1 0.24511241446725318, AUC 0.6516754850088183
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.7083884479717814
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 7 idx: 0 First Loss : 3.4089810848236084, Second Loss : 4.044283390045166
epoch: 7 idx: 200 First Loss : 0.8963748938401128, Second Loss : 0.9256989116344916
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.2777777777777778, precision 0.31542288557213927, recall 0.3644444444444444, F1 0.1866384877304215, AUC 0.6778787878787879
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.7006565656565656
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.36054421768707484, precision 0.4362745098039216, recall 0.3786008230452675, F1 0.23701351571405307, AUC 0.6347920340975897
  Second-Tier acc 0.3877551020408163, precision 0.4393939393939394, recall 0.3950617283950617, F1 0.26508620689655177, AUC 0.6690365961199295
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 8 idx: 0 First Loss : 3.3292863368988037, Second Loss : 4.075703144073486
epoch: 8 idx: 200 First Loss : 0.8906282616138634, Second Loss : 0.9275727648906577
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.2777777777777778, precision 0.31730279898218827, recall 0.3644444444444444, F1 0.18904830224772837, AUC 0.6622053872053871
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6874242424242425
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3673469387755102, precision 0.4385964912280702, recall 0.38271604938271603, F1 0.24602150537634407, AUC 0.6410199882422104
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6586199294532628
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 9 idx: 0 First Loss : 3.277764320373535, Second Loss : 4.042547702789307
epoch: 9 idx: 200 First Loss : 0.8818203608329647, Second Loss : 0.9194599678615382
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.2708333333333333, precision 0.30619168787107715, recall 0.36000000000000004, F1 0.1817653890824623, AUC 0.6600056116722783
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6829797979797979
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3673469387755102, precision 0.4385964912280702, recall 0.38271604938271603, F1 0.24602150537634407, AUC 0.6510447285910249
  Second-Tier acc 0.3673469387755102, precision 0.43703703703703706, recall 0.38271604938271603, F1 0.24421359577182433, AUC 0.6496362433862434
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 10 idx: 0 First Loss : 3.1129844188690186, Second Loss : 3.7733511924743652
epoch: 10 idx: 200 First Loss : 0.8714469105760516, Second Loss : 0.9093976526875026
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3055555555555556, precision 0.34920634920634924, recall 0.38222222222222224, F1 0.22076178361953222, AUC 0.6630864197530865
  Second-Tier acc 0.2708333333333333, precision 0.3037037037037037, recall 0.36000000000000004, F1 0.17857142857142858, AUC 0.6901010101010101
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.38095238095238093, precision 0.44020356234096686, recall 0.3909465020576131, F1 0.2600953250177467, AUC 0.6494464040760337
  Second-Tier acc 0.3877551020408163, precision 0.44186046511627913, recall 0.3950617283950617, F1 0.2679093567251462, AUC 0.6527226631393298
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 11 idx: 0 First Loss : 3.1399471759796143, Second Loss : 3.7921478748321533
epoch: 11 idx: 200 First Loss : 0.8531185119036082, Second Loss : 0.8982803480597867
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3472222222222222, precision 0.3720430107526882, recall 0.40888888888888886, F1 0.25942563414906694, AUC 0.6634960718294051
  Second-Tier acc 0.3541666666666667, precision 0.44354354354354353, recall 0.42777777777777776, F1 0.2995203457727177, AUC 0.6972222222222223
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.4217687074829932, precision 0.4435695538057743, recall 0.4156378600823045, F1 0.2976936746929131, AUC 0.6487421614736429
  Second-Tier acc 0.4489795918367347, precision 0.5261261261261262, recall 0.46141975308641975, F1 0.371543489190548, AUC 0.6694775132275131
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 12 idx: 0 First Loss : 3.0923573970794678, Second Loss : 3.7058191299438477
epoch: 12 idx: 200 First Loss : 0.8426236908228961, Second Loss : 0.8865953765228038
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6638888888888889
  Second-Tier acc 0.3125, precision 0.35193798449612407, recall 0.38666666666666666, F1 0.22469135802469134, AUC 0.6989393939393939
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.41496598639455784, precision 0.5286666666666667, recall 0.42129629629629634, F1 0.3126863156803276, AUC 0.6519265628061924
  Second-Tier acc 0.40816326530612246, precision 0.4471544715447155, recall 0.40740740740740744, F1 0.2909090909090909, AUC 0.6665564373897707
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 13 idx: 0 First Loss : 2.8501510620117188, Second Loss : 3.571478843688965
epoch: 13 idx: 200 First Loss : 0.8270880562063325, Second Loss : 0.8744533613358337
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3333333333333333, precision 0.43734438219732336, recall 0.4096296296296296, F1 0.269604566972988, AUC 0.6623344556677889
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6995959595959595
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.4013605442176871, precision 0.5212285456187895, recall 0.42283950617283944, F1 0.31426767676767675, AUC 0.653224818734078
  Second-Tier acc 0.40816326530612246, precision 0.45, recall 0.40740740740740744, F1 0.2940516273849607, AUC 0.6762014991181657
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 14 idx: 0 First Loss : 2.823559045791626, Second Loss : 3.604390859603882
epoch: 14 idx: 200 First Loss : 0.8190821536431646, Second Loss : 0.8652340553468383
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3472222222222222, precision 0.46545284780578894, recall 0.4185185185185185, F1 0.2832714757636778, AUC 0.6654994388327721
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7063636363636364
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4013605442176871, precision 0.48148148148148145, recall 0.4092445620223398, F1 0.3023569023569023, AUC 0.655000734861846
  Second-Tier acc 0.42857142857142855, precision 0.5363247863247863, recall 0.4490740740740741, F1 0.3528683056984944, AUC 0.6743827160493828
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 15 idx: 0 First Loss : 2.786550760269165, Second Loss : 3.508852958679199
epoch: 15 idx: 200 First Loss : 0.8083085787485238, Second Loss : 0.8576903537853545
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3611111111111111, precision 0.44928094504365695, recall 0.4225925925925926, F1 0.28607337111126285, AUC 0.6680976430976431
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.7045454545454546
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.41496598639455784, precision 0.46364370093183654, recall 0.41365373309817755, F1 0.31762188119845497, AUC 0.6556682343719381
  Second-Tier acc 0.40816326530612246, precision 0.5196581196581197, recall 0.4367283950617284, F1 0.3315493468795356, AUC 0.6733355379188714
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 16 idx: 0 First Loss : 2.9415369033813477, Second Loss : 3.5372512340545654
epoch: 16 idx: 200 First Loss : 0.8013605156047561, Second Loss : 0.8503389203365961
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3263888888888889, precision 0.4156746031746032, recall 0.41, F1 0.2711581787133899, AUC 0.6698877665544333
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6983333333333333
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3945578231292517, precision 0.5160714285714285, recall 0.4268077601410935, F1 0.33360389610389607, AUC 0.659801832255536
  Second-Tier acc 0.4489795918367347, precision 0.5641025641025641, recall 0.46141975308641975, F1 0.37396159149766256, AUC 0.6789021164021163
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 17 idx: 0 First Loss : 2.79607892036438, Second Loss : 3.6184933185577393
epoch: 17 idx: 200 First Loss : 0.7993949594508479, Second Loss : 0.8493283227858658
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3472222222222222, precision 0.43098279066978473, recall 0.42333333333333334, F1 0.29341588986414463, AUC 0.6713299663299663
  Second-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6997979797979799
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.40816326530612246, precision 0.49844054580896685, recall 0.42908583186360966, F1 0.33670033670033667, AUC 0.6602672447579855
  Second-Tier acc 0.42857142857142855, precision 0.45, recall 0.4197530864197531, F1 0.3100944081336238, AUC 0.6967592592592592
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 18 idx: 0 First Loss : 3.0734500885009766, Second Loss : 3.8622632026672363
epoch: 18 idx: 200 First Loss : 0.7977026217452643, Second Loss : 0.8462392164628774
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.3541666666666667, precision 0.43751873838220307, recall 0.42777777777777776, F1 0.3001923082418226, AUC 0.6730359147025814
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6990909090909091
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.41496598639455784, precision 0.48089226350095915, recall 0.42555849500293946, F1 0.3478365243071126, AUC 0.6626616696061141
  Second-Tier acc 0.42857142857142855, precision 0.5611111111111111, recall 0.4490740740740741, F1 0.3546576879910213, AUC 0.6840828924162258
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5)
Current LR: 0.0001627201044126089
epoch: 19 idx: 0 First Loss : 3.1249887943267822, Second Loss : 3.799595832824707
epoch: 19 idx: 200 First Loss : 0.7940128507350471, Second Loss : 0.8420662215050823
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3194444444444444, precision 0.40006265664160406, recall 0.4007407407407408, F1 0.2576978933319222, AUC 0.6699382716049382
  Second-Tier acc 0.2916666666666667, precision 0.33527131782945735, recall 0.37333333333333335, F1 0.20476798637718177, AUC 0.6990909090909091
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.40816326530612246, precision 0.5029701535786728, recall 0.432907113462669, F1 0.3344708969530517, AUC 0.656305114638448
  Second-Tier acc 0.3469387755102041, precision 0.4976190476190476, recall 0.3996913580246913, F1 0.26326096211153677, AUC 0.6773037918871253
Test AUC: 0.7331, Test F1: 0.3039 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.21395247341309384, "droprate_2": 0.0, "lr": 0.00029131728893407857, "weight_decay": 2.7472683300068268e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.00029131728893407857
epoch: 0 idx: 0 First Loss : 1.2486861944198608, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.0822861186826407, Second Loss : 1.0788016934225808
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7402693602693603
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7449494949494948
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7224365569272977
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7217261904761904
Test AUC: 0.7217, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00029131728893407857
epoch: 1 idx: 0 First Loss : 1.5590782165527344, Second Loss : 1.8871569633483887
epoch: 1 idx: 200 First Loss : 0.9733815508991924, Second Loss : 0.9741537645829851
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7284848484848485
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7332828282828284
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7404590436997845
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7460868606701939
Test AUC: 0.7217, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00029131728893407857
epoch: 2 idx: 0 First Loss : 2.05643892288208, Second Loss : 2.171858787536621
epoch: 2 idx: 200 First Loss : 0.9479398242202565, Second Loss : 0.9473417795342
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5625, precision 0.5519508057675996, recall 0.3914141414141414, F1 0.34121694510044026, AUC 0.7255836139169473
  Second-Tier acc 0.5416666666666666, precision 0.2962962962962963, recall 0.3611111111111111, F1 0.28253968253968254, AUC 0.7275757575757575
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5782312925170068, precision 0.5261904761904762, recall 0.3888888888888889, F1 0.33958198664081013, AUC 0.7175252302567117
  Second-Tier acc 0.5918367346938775, precision 0.524822695035461, recall 0.4166666666666667, F1 0.37657657657657656, AUC 0.7210648148148149
Test AUC: 0.7217, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00029131728893407857
epoch: 3 idx: 0 First Loss : 2.6475322246551514, Second Loss : 2.8998568058013916
epoch: 3 idx: 200 First Loss : 0.9305090479441543, Second Loss : 0.9299984628621915
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.4652777777777778, precision 0.5377707689948967, recall 0.48902356902356897, F1 0.4367028727684465, AUC 0.7192817059483726
  Second-Tier acc 0.4375, precision 0.3796296296296296, recall 0.4666666666666666, F1 0.3362085489745064, AUC 0.7350505050505051
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5034013605442177, precision 0.5325554495642837, recall 0.5033068783068783, F1 0.48421645553664844, AUC 0.680243239271017
  Second-Tier acc 0.5102040816326531, precision 0.40653594771241836, recall 0.4462081128747795, F1 0.373015873015873, AUC 0.703042328042328
Test AUC: 0.7217, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00029131728893407857
epoch: 4 idx: 0 First Loss : 3.378262758255005, Second Loss : 3.5550053119659424
epoch: 4 idx: 200 First Loss : 0.9125523215752855, Second Loss : 0.9188524037321557
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5416666666666666, precision 0.3827770096780565, recall 0.5163636363636364, F1 0.4077079107505071, AUC 0.7093827160493827
  Second-Tier acc 0.4375, precision 0.3611721611721612, recall 0.4666666666666666, F1 0.3348588863463005, AUC 0.7327777777777778
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.5238095238095238, precision 0.38379446640316206, recall 0.44679600235155786, F1 0.3799385425812116, AUC 0.6793001665686851
  Second-Tier acc 0.46938775510204084, precision 0.4170653907496013, recall 0.4329805996472664, F1 0.3421052631578947, AUC 0.6880511463844797
Test AUC: 0.7217, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.00029131728893407857
epoch: 5 idx: 0 First Loss : 3.654742479324341, Second Loss : 3.697087049484253
epoch: 5 idx: 200 First Loss : 0.9149721696108709, Second Loss : 0.914630067369099
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.3541666666666667, precision 0.36289120715350226, recall 0.41333333333333333, F1 0.2656468240771533, AUC 0.7440684624017958
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.7656060606060606
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.43537414965986393, precision 0.44533333333333336, recall 0.4238683127572016, F1 0.31005949266515515, AUC 0.6486441798941799
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.7058531746031745
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 6 idx: 0 First Loss : 3.5008926391601562, Second Loss : 3.5691077709198
epoch: 6 idx: 200 First Loss : 0.9063634284533356, Second Loss : 0.9068862401361378
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.3402777777777778, precision 0.3687017543859649, recall 0.40444444444444444, F1 0.2527156836340785, AUC 0.6883221099887766
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6997979797979799
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4217687074829932, precision 0.4444444444444444, recall 0.4156378600823045, F1 0.2986798679867987, AUC 0.6672790515383108
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.6475418871252204
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 7 idx: 0 First Loss : 3.5090723037719727, Second Loss : 3.5841774940490723
epoch: 7 idx: 200 First Loss : 0.8996038336882516, Second Loss : 0.9068158826974929
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3333333333333333, precision 0.3650793650793651, recall 0.39999999999999997, F1 0.24589166159464396, AUC 0.6675813692480359
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6763636363636363
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.4444444444444444, recall 0.4156378600823045, F1 0.2986798679867987, AUC 0.6513264256319812
  Second-Tier acc 0.4489795918367347, precision 0.4471544715447155, recall 0.43209876543209874, F1 0.322077922077922, AUC 0.6649029982363316
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 8 idx: 0 First Loss : 3.3987395763397217, Second Loss : 3.4843311309814453
epoch: 8 idx: 200 First Loss : 0.8918896820274557, Second Loss : 0.9027174616820962
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3263888888888889, precision 0.36321948134092347, recall 0.3955555555555556, F1 0.2415766638973507, AUC 0.6725645342312009
  Second-Tier acc 0.3958333333333333, precision 0.39031339031339024, recall 0.44, F1 0.3035294117647059, AUC 0.6868181818181819
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4013605442176871, precision 0.4427083333333333, recall 0.40329218106995884, F1 0.2803521408563425, AUC 0.6596242406427592
  Second-Tier acc 0.46938775510204084, precision 0.452991452991453, recall 0.4444444444444444, F1 0.34276729559748426, AUC 0.6444554673721341
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 9 idx: 0 First Loss : 3.3237552642822266, Second Loss : 3.5333006381988525
epoch: 9 idx: 200 First Loss : 0.8901779634480721, Second Loss : 0.9086510614365738
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3125, precision 0.35683060109289616, recall 0.38666666666666666, F1 0.2308243727598566, AUC 0.6685690235690235
  Second-Tier acc 0.3958333333333333, precision 0.3953953953953954, recall 0.44, F1 0.309640522875817, AUC 0.6905555555555556
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.3877551020408163, precision 0.4444444444444444, recall 0.3950617283950617, F1 0.2708333333333333, AUC 0.6615042621987067
  Second-Tier acc 0.4489795918367347, precision 0.45, recall 0.43209876543209874, F1 0.3252204585537919, AUC 0.6576829805996472
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 10 idx: 0 First Loss : 3.314859390258789, Second Loss : 3.5536272525787354
epoch: 10 idx: 200 First Loss : 0.8905688930373519, Second Loss : 0.9064295832057593
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.2916666666666667, precision 0.338, recall 0.37333333333333335, F1 0.20820602357049323, AUC 0.6599382716049383
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6843434343434344
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.36054421768707484, precision 0.4435695538057743, recall 0.3786008230452675, F1 0.2453906183003173, AUC 0.6589812365275328
  Second-Tier acc 0.40816326530612246, precision 0.44186046511627913, recall 0.40740740740740744, F1 0.28495481127060074, AUC 0.6568562610229277
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 11 idx: 0 First Loss : 3.2753264904022217, Second Loss : 3.5712897777557373
epoch: 11 idx: 200 First Loss : 0.8920311583269044, Second Loss : 0.9059092947969675
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.2986111111111111, precision 0.3734972677595629, recall 0.3825925925925926, F1 0.22539375473553544, AUC 0.66347923681257
  Second-Tier acc 0.3541666666666667, precision 0.3751451800232288, recall 0.41333333333333333, F1 0.266025641025641, AUC 0.685050505050505
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3741496598639456, precision 0.47222222222222227, recall 0.396604938271605, F1 0.2759550286432007, AUC 0.6586627963942778
  Second-Tier acc 0.42857142857142855, precision 0.4444444444444444, recall 0.4197530864197531, F1 0.30392156862745096, AUC 0.660218253968254
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 12 idx: 0 First Loss : 3.1141269207000732, Second Loss : 3.47198486328125
epoch: 12 idx: 200 First Loss : 0.8781300812933028, Second Loss : 0.8973231078688789
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6692368125701459
  Second-Tier acc 0.4166666666666667, precision 0.37457912457912457, recall 0.4533333333333333, F1 0.32269503546099293, AUC 0.6876262626262627
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.46938775510204084, precision 0.43907563025210083, recall 0.4444444444444444, F1 0.33905065815715996, AUC 0.6755768665490888
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.6843584656084656
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 13 idx: 0 First Loss : 3.6923773288726807, Second Loss : 3.8397247791290283
epoch: 13 idx: 200 First Loss : 0.8768672720234916, Second Loss : 0.9006953771183104
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3055555555555556, precision 0.38361122787352303, recall 0.387037037037037, F1 0.2325078744433583, AUC 0.6644107744107745
  Second-Tier acc 0.3333333333333333, precision 0.36720867208672087, recall 0.39999999999999997, F1 0.24855252274607112, AUC 0.6753535353535355
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.3673469387755102, precision 0.4727954971857411, recall 0.3924897119341564, F1 0.26742513264252393, AUC 0.6604019694297473
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6765873015873015
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 14 idx: 0 First Loss : 2.9822442531585693, Second Loss : 3.5041663646698
epoch: 14 idx: 200 First Loss : 0.871760789270257, Second Loss : 0.8941778361632845
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.3927389814486588, recall 0.387037037037037, F1 0.23138884026159987, AUC 0.6652637485970819
  Second-Tier acc 0.3125, precision 0.3560975609756098, recall 0.38666666666666666, F1 0.2299145299145299, AUC 0.6714141414141414
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.36054421768707484, precision 0.4709639953542393, recall 0.3883744855967079, F1 0.26050090260616576, AUC 0.6654541446208112
  Second-Tier acc 0.3469387755102041, precision 0.4444444444444444, recall 0.3703703703703704, F1 0.2333333333333333, AUC 0.6678791887125222
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 15 idx: 0 First Loss : 3.240285873413086, Second Loss : 3.739891290664673
epoch: 15 idx: 200 First Loss : 0.8673706010793385, Second Loss : 0.8897716200260234
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3055555555555556, precision 0.3927389814486588, recall 0.387037037037037, F1 0.23138884026159987, AUC 0.6713804713804713
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6741414141414142
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.35374149659863946, precision 0.4700460829493087, recall 0.3842592592592593, F1 0.25288522511097017, AUC 0.6656317362335881
  Second-Tier acc 0.32653061224489793, precision 0.44186046511627913, recall 0.35802469135802467, F1 0.20971970155273242, AUC 0.6838624338624338
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 16 idx: 0 First Loss : 3.218356132507324, Second Loss : 3.8384697437286377
epoch: 16 idx: 200 First Loss : 0.8623382375617484, Second Loss : 0.8814811305900191
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.3055555555555556, precision 0.3927389814486588, recall 0.387037037037037, F1 0.23138884026159987, AUC 0.6647138047138047
  Second-Tier acc 0.2708333333333333, precision 0.3116531165311653, recall 0.36000000000000004, F1 0.18864468864468864, AUC 0.6642424242424242
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.3333333333333333, precision 0.4658444022770398, recall 0.37191358024691357, F1 0.2309118728910596, AUC 0.6720923966294338
  Second-Tier acc 0.32653061224489793, precision 0.4916666666666667, recall 0.3873456790123457, F1 0.23831569664902996, AUC 0.6915784832451499
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 17 idx: 0 First Loss : 3.441398859024048, Second Loss : 4.094742774963379
epoch: 17 idx: 200 First Loss : 0.8757007613323131, Second Loss : 0.8975634156551126
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.2916666666666667, precision 0.40089988751406075, recall 0.3781481481481481, F1 0.21574897400820792, AUC 0.6715095398428731
  Second-Tier acc 0.2708333333333333, precision 0.3116531165311653, recall 0.36000000000000004, F1 0.18864468864468864, AUC 0.6671717171717173
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.3333333333333333, precision 0.4666666666666666, recall 0.37191358024691357, F1 0.22973769525493667, AUC 0.6658705663335294
  Second-Tier acc 0.3469387755102041, precision 0.5228070175438596, recall 0.4290123456790123, F1 0.27737077737077737, AUC 0.6927358906525573
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 18 idx: 0 First Loss : 3.3434674739837646, Second Loss : 4.260593414306641
epoch: 18 idx: 200 First Loss : 0.8645902099383488, Second Loss : 0.8932670074303537
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.2916666666666667, precision 0.40424570912375796, recall 0.38296296296296295, F1 0.22435897435897437, AUC 0.6706509539842873
  Second-Tier acc 0.2708333333333333, precision 0.3138888888888889, recall 0.36000000000000004, F1 0.19140989729225022, AUC 0.6668686868686868
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.3333333333333333, precision 0.465672990063234, recall 0.37191358024691357, F1 0.23154699706423845, AUC 0.6705798059964726
  Second-Tier acc 0.3469387755102041, precision 0.5228070175438596, recall 0.4290123456790123, F1 0.27737077737077737, AUC 0.6984126984126985
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5)
Current LR: 0.00029131728893407857
epoch: 19 idx: 0 First Loss : 3.4606330394744873, Second Loss : 4.5753045082092285
epoch: 19 idx: 200 First Loss : 0.8634000555341764, Second Loss : 0.905798564219088
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3055555555555556, precision 0.42882483370288244, recall 0.3918518518518519, F1 0.23977859013248293, AUC 0.6693153759820426
  Second-Tier acc 0.2916666666666667, precision 0.3394308943089431, recall 0.37333333333333335, F1 0.20999115826702033, AUC 0.6623737373737374
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.3333333333333333, precision 0.4658444022770398, recall 0.37191358024691357, F1 0.2309118728910596, AUC 0.6785224377816971
  Second-Tier acc 0.40816326530612246, precision 0.5513784461152883, recall 0.4660493827160494, F1 0.3543975737524125, AUC 0.7003968253968255
Test AUC: 0.7059, Test F1: 0.3221 (Best Epoch: 5){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 20, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.26224932632360376, "droprate_2": 0.0, "lr": 3.238768288601016e-05, "weight_decay": 7.483623340799152e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 3.238768288601016e-05
epoch: 0 idx: 0 First Loss : 1.2430485486984253, Second Loss : 1.2525205612182617
epoch: 0 idx: 200 First Loss : 1.120291660229365, Second Loss : 1.1079776303388587
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7207744107744108
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7561111111111112
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6661338918283363
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6617614638447972
Test AUC: 0.6618, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 3.238768288601016e-05
epoch: 1 idx: 0 First Loss : 2.1481826305389404, Second Loss : 2.1382644176483154
epoch: 1 idx: 200 First Loss : 1.0744134535392125, Second Loss : 1.071957886367295
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7390123456790123
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7608585858585859
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7046529002547522
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.708664021164021
Test AUC: 0.7087, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.238768288601016e-05
epoch: 2 idx: 0 First Loss : 2.3066279888153076, Second Loss : 2.264096975326538
epoch: 2 idx: 200 First Loss : 1.0366557428789376, Second Loss : 1.032555550818716
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.5277777777777778, precision 0.40359477124183, recall 0.3490909090909091, F1 0.2708443040196595, AUC 0.7357014590347922
  Second-Tier acc 0.5833333333333334, precision 0.41269841269841273, recall 0.4412121212121212, F1 0.3956687152472929, AUC 0.7479292929292929
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5578231292517006, precision 0.5182648401826484, recall 0.34722222222222227, F1 0.2645521292217327, AUC 0.7066492749363119
  Second-Tier acc 0.5510204081632653, precision 0.1875, recall 0.3333333333333333, F1 0.24, AUC 0.7119157848324514
Test AUC: 0.7087, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.238768288601016e-05
epoch: 3 idx: 0 First Loss : 2.5197837352752686, Second Loss : 2.5025482177734375
epoch: 3 idx: 200 First Loss : 0.9963749479224433, Second Loss : 0.9966556699344175
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.6388888888888888, precision 0.5805181558547532, recall 0.552962962962963, F1 0.5565282849942407, AUC 0.7303030303030303
  Second-Tier acc 0.6666666666666666, precision 0.4283121597096189, recall 0.5963636363636363, F1 0.49382716049382713, AUC 0.7471212121212121
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.5374149659863946, precision 0.477460504366598, recall 0.5099206349206349, F1 0.47375621890547265, AUC 0.695479374877523
  Second-Tier acc 0.5510204081632653, precision 0.49943019943019945, recall 0.4836860670194003, F1 0.48306724721819055, AUC 0.7074514991181657
Test AUC: 0.7087, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.238768288601016e-05
epoch: 4 idx: 0 First Loss : 2.8208587169647217, Second Loss : 2.828646183013916
epoch: 4 idx: 200 First Loss : 0.9619003849947334, Second Loss : 0.9677634952376731
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.5347222222222222, precision 0.5229754595951779, recall 0.5174747474747475, F1 0.4874621721090679, AUC 0.7347025813692479
  Second-Tier acc 0.5625, precision 0.5720969089390142, recall 0.5824242424242424, F1 0.5482905982905982, AUC 0.7501515151515151
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.4489795918367347, precision 0.43534827615917676, recall 0.46619635508524393, F1 0.4137642186680444, AUC 0.707329022143837
  Second-Tier acc 0.5918367346938775, precision 0.5953947368421052, recall 0.6664462081128748, F1 0.5954897815362932, AUC 0.7237654320987653
Test AUC: 0.7087, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.238768288601016e-05
epoch: 5 idx: 0 First Loss : 3.1446330547332764, Second Loss : 3.176088809967041
epoch: 5 idx: 200 First Loss : 0.9414029196182738, Second Loss : 0.9516559941555137
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.4513888888888889, precision 0.49335727969348664, recall 0.4777441077441078, F1 0.41670574939716526, AUC 0.7469640852974186
  Second-Tier acc 0.5, precision 0.5648148148148148, recall 0.5543434343434344, F1 0.4997439836149513, AUC 0.7598484848484848
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.42857142857142855, precision 0.4682511458827248, recall 0.5065402704291593, F1 0.41232980533985747, AUC 0.7215057319223986
  Second-Tier acc 0.4897959183673469, precision 0.5164721759149004, recall 0.58179012345679, F1 0.49474747474747477, AUC 0.7555665784832452
Test AUC: 0.7087, Test F1: 0.2368 (Best Epoch: 1)
Current LR: 3.238768288601016e-05
epoch: 6 idx: 0 First Loss : 3.4035730361938477, Second Loss : 3.4618277549743652
epoch: 6 idx: 200 First Loss : 0.929276098580614, Second Loss : 0.9431831621245217
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.4444444444444444, precision 0.49603174603174605, recall 0.4837710437710438, F1 0.4151688656543026, AUC 0.7568686868686868
  Second-Tier acc 0.5, precision 0.5728114478114478, recall 0.5832323232323232, F1 0.4984121130165755, AUC 0.7785353535353535
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.4421768707482993, precision 0.49998671555343005, recall 0.5360082304526749, F1 0.4333435190035504, AUC 0.7326082696453066
  Second-Tier acc 0.5306122448979592, precision 0.5826599326599327, recall 0.6294091710758377, F1 0.5313963642137017, AUC 0.7661485890652558
Test AUC: 0.7661, Test F1: 0.5314 (Best Epoch: 6)
Current LR: 3.238768288601016e-05
epoch: 7 idx: 0 First Loss : 3.5657873153686523, Second Loss : 3.636045455932617
epoch: 7 idx: 200 First Loss : 0.9230401460035005, Second Loss : 0.9401243424265465
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.4305555555555556, precision 0.5019210318685465, recall 0.48787878787878797, F1 0.4167012862665036, AUC 0.759304152637486
  Second-Tier acc 0.5208333333333334, precision 0.5907477025898079, recall 0.6135353535353536, F1 0.5212121212121211, AUC 0.7925757575757576
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4217687074829932, precision 0.5277428674611774, recall 0.5155790711346268, F1 0.41930252286547326, AUC 0.7346720066627475
  Second-Tier acc 0.5102040816326531, precision 0.5989974937343359, recall 0.6170634920634921, F1 0.5109347442680776, AUC 0.7779982363315696
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 8 idx: 0 First Loss : 3.6666476726531982, Second Loss : 3.753291130065918
epoch: 8 idx: 200 First Loss : 0.9180334161536129, Second Loss : 0.9377149743287458
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.4444444444444444, precision 0.5291783380018674, recall 0.5193939393939394, F1 0.43716931216931215, AUC 0.7651178451178451
  Second-Tier acc 0.4791666666666667, precision 0.559001670843776, recall 0.5579797979797979, F1 0.48012381883349625, AUC 0.7874242424242425
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.4557823129251701, precision 0.5547341954022988, recall 0.5590828924162258, F1 0.4581991102929897, AUC 0.7466808739956887
  Second-Tier acc 0.4897959183673469, precision 0.5814151747655584, recall 0.5753968253968255, F1 0.4888288288288288, AUC 0.7964616402116401
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 9 idx: 0 First Loss : 3.734137773513794, Second Loss : 3.811474084854126
epoch: 9 idx: 200 First Loss : 0.9132923942721861, Second Loss : 0.9349215067390223
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.4513888888888889, precision 0.5399174272055628, recall 0.5368350168350169, F1 0.44904426369410394, AUC 0.7667901234567901
  Second-Tier acc 0.4375, precision 0.5283613445378151, recall 0.5193939393939394, F1 0.43435960591133, AUC 0.7765656565656567
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.48299319727891155, precision 0.5901234567901233, recall 0.5946502057613169, F1 0.48504273504273504, AUC 0.7545990103860474
  Second-Tier acc 0.4897959183673469, precision 0.5898692810457516, recall 0.5868606701940036, F1 0.48781954887218043, AUC 0.8003747795414462
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 10 idx: 0 First Loss : 3.7636749744415283, Second Loss : 3.831460952758789
epoch: 10 idx: 200 First Loss : 0.9085789323988283, Second Loss : 0.9318108854731962
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.4513888888888889, precision 0.5411180501344436, recall 0.5385185185185185, F1 0.45041078949253643, AUC 0.7645230078563411
  Second-Tier acc 0.375, precision 0.46978021978021983, recall 0.43606060606060604, F1 0.3588461538461538, AUC 0.7635858585858587
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.46258503401360546, precision 0.5806288032454361, recall 0.5784832451499118, F1 0.46349289161340806, AUC 0.7580589849108367
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.7985008818342152
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 11 idx: 0 First Loss : 3.7696259021759033, Second Loss : 3.83540678024292
epoch: 11 idx: 200 First Loss : 0.9038098392028139, Second Loss : 0.92930240603048
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.4097222222222222, precision 0.5109614258221069, recall 0.4903030303030303, F1 0.4071694516631126, AUC 0.7585409652076317
  Second-Tier acc 0.3958333333333333, precision 0.48214285714285715, recall 0.4493939393939394, F1 0.3785936285936286, AUC 0.750909090909091
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.46938775510204084, precision 0.5864197530864197, recall 0.5864197530864197, F1 0.4719377629594348, AUC 0.7629825592788556
  Second-Tier acc 0.5102040816326531, precision 0.5982905982905983, recall 0.5928130511463845, F1 0.49730848861283644, AUC 0.8022486772486772
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 12 idx: 0 First Loss : 3.8145320415496826, Second Loss : 3.808539390563965
epoch: 12 idx: 200 First Loss : 0.9017469088595583, Second Loss : 0.9270136442773312
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.3958333333333333, precision 0.5012671735360811, recall 0.4822558922558922, F1 0.39093876485180834, AUC 0.7491750841750843
  Second-Tier acc 0.4166666666666667, precision 0.5028083028083028, recall 0.49414141414141405, F1 0.4039456122789456, AUC 0.7281313131313132
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.4557823129251701, precision 0.5848010437051533, recall 0.582010582010582, F1 0.45599472990777334, AUC 0.7624926513815403
  Second-Tier acc 0.4897959183673469, precision 0.5841666666666666, recall 0.5690035273368607, F1 0.4793040293040293, AUC 0.8010361552028219
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 13 idx: 0 First Loss : 3.7181146144866943, Second Loss : 3.737657308578491
epoch: 13 idx: 200 First Loss : 0.8957341250492056, Second Loss : 0.9254028235471794
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3819444444444444, precision 0.49027777777777776, recall 0.46855218855218855, F1 0.37561455260570303, AUC 0.7371885521885521
  Second-Tier acc 0.3958333333333333, precision 0.4805996472663139, recall 0.4663636363636363, F1 0.377361673414305, AUC 0.7159090909090908
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.43537414965986393, precision 0.5727302048056765, recall 0.5479864785420342, F1 0.42937400514720103, AUC 0.7618129041740153
  Second-Tier acc 0.4489795918367347, precision 0.5580246913580247, recall 0.5149911816578483, F1 0.4320587195641778, AUC 0.7915564373897709
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 14 idx: 0 First Loss : 3.6916306018829346, Second Loss : 3.6994082927703857
epoch: 14 idx: 200 First Loss : 0.8926886732815139, Second Loss : 0.9237569133914423
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3680555555555556, precision 0.47571354436948626, recall 0.4556902356902357, F1 0.35786042721611083, AUC 0.7200785634118967
  Second-Tier acc 0.3958333333333333, precision 0.4805996472663139, recall 0.4663636363636363, F1 0.377361673414305, AUC 0.6894949494949495
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.4421768707482993, precision 0.5783891547049441, recall 0.561875367430923, F1 0.43700561285389994, AUC 0.7584325396825397
  Second-Tier acc 0.4489795918367347, precision 0.5580246913580247, recall 0.5149911816578483, F1 0.4320587195641778, AUC 0.7895171957671957
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 15 idx: 0 First Loss : 3.688300371170044, Second Loss : 3.700868844985962
epoch: 15 idx: 200 First Loss : 0.8903539872085977, Second Loss : 0.9230339043094332
>>>>>>>>>>> Validation Epoch: 15
  First-Tier acc 0.3680555555555556, precision 0.47500000000000003, recall 0.4556902356902357, F1 0.35789473684210527, AUC 0.7055331088664422
  Second-Tier acc 0.3541666666666667, precision 0.45566239316239315, recall 0.4227272727272728, F1 0.3411176153111637, AUC 0.6884343434343435
>>>>>>>>>>> Test Epoch: 15
  First-Tier acc 0.4421768707482993, precision 0.5767145135566188, recall 0.5559229864785421, F1 0.4342165118026234, AUC 0.7514268567509307
  Second-Tier acc 0.46938775510204084, precision 0.5787037037037037, recall 0.5566578483245149, F1 0.45844248630626344, AUC 0.7865961199294533
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 16 idx: 0 First Loss : 3.697619676589966, Second Loss : 3.6861612796783447
epoch: 16 idx: 200 First Loss : 0.8897102651492095, Second Loss : 0.9231967502597961
>>>>>>>>>>> Validation Epoch: 16
  First-Tier acc 0.375, precision 0.48123522458628837, recall 0.4601346801346802, F1 0.36558263127698765, AUC 0.6972390572390573
  Second-Tier acc 0.3333333333333333, precision 0.44027777777777777, recall 0.4093939393939394, F1 0.31821219715956556, AUC 0.6840404040404041
>>>>>>>>>>> Test Epoch: 16
  First-Tier acc 0.42857142857142855, precision 0.5688311688311689, recall 0.5379188712522045, F1 0.41845947239655357, AUC 0.7500551146384479
  Second-Tier acc 0.46938775510204084, precision 0.5780392156862745, recall 0.5566578483245149, F1 0.45862242332830566, AUC 0.7886353615520282
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 17 idx: 0 First Loss : 3.6924755573272705, Second Loss : 3.6884348392486572
epoch: 17 idx: 200 First Loss : 0.8877883373203095, Second Loss : 0.9226531982035272
>>>>>>>>>>> Validation Epoch: 17
  First-Tier acc 0.3819444444444444, precision 0.48630058406341264, recall 0.4645791245791246, F1 0.3731911099573361, AUC 0.6865656565656565
  Second-Tier acc 0.3333333333333333, precision 0.44027777777777777, recall 0.4093939393939394, F1 0.31821219715956556, AUC 0.672979797979798
>>>>>>>>>>> Test Epoch: 17
  First-Tier acc 0.42857142857142855, precision 0.5713392717612127, recall 0.541740152851264, F1 0.4168159326054062, AUC 0.7469380756417795
  Second-Tier acc 0.46938775510204084, precision 0.5780392156862745, recall 0.5566578483245149, F1 0.45862242332830566, AUC 0.7899581128747796
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 18 idx: 0 First Loss : 3.671419382095337, Second Loss : 3.6517677307128906
epoch: 18 idx: 200 First Loss : 0.8861965736950833, Second Loss : 0.9224169461821977
>>>>>>>>>>> Validation Epoch: 18
  First-Tier acc 0.375, precision 0.48055555555555557, recall 0.4601346801346802, F1 0.3656412417474364, AUC 0.6852188552188552
  Second-Tier acc 0.3541666666666667, precision 0.4523809523809524, recall 0.4396969696969697, F1 0.3339031339031339, AUC 0.6715151515151515
>>>>>>>>>>> Test Epoch: 18
  First-Tier acc 0.42857142857142855, precision 0.5714622641509434, recall 0.541740152851264, F1 0.4171016214156853, AUC 0.7431841563786007
  Second-Tier acc 0.4489795918367347, precision 0.5725925925925925, recall 0.5443121693121693, F1 0.4374514374514375, AUC 0.7902336860670195
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7)
Current LR: 3.238768288601016e-05
epoch: 19 idx: 0 First Loss : 3.668659210205078, Second Loss : 3.635627508163452
epoch: 19 idx: 200 First Loss : 0.8852594266542806, Second Loss : 0.9228974878100217
>>>>>>>>>>> Validation Epoch: 19
  First-Tier acc 0.3819444444444444, precision 0.48535045092373696, recall 0.4702356902356903, F1 0.37143058449336186, AUC 0.6853423120089787
  Second-Tier acc 0.375, precision 0.4679012345679012, recall 0.45303030303030306, F1 0.3570395522857323, AUC 0.6727777777777778
>>>>>>>>>>> Test Epoch: 19
  First-Tier acc 0.41496598639455784, precision 0.5611744222855334, recall 0.5199147560258671, F1 0.4032662958208529, AUC 0.7436128257887518
  Second-Tier acc 0.4489795918367347, precision 0.572398190045249, recall 0.5443121693121693, F1 0.4378787878787879, AUC 0.7857142857142857
Test AUC: 0.7780, Test F1: 0.5109 (Best Epoch: 7){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.13977469093974593, "droprate_2": 0.0, "lr": 0.00017920887785267362, "weight_decay": 0.00020230540361374752, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 15, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.25799027199878594, "droprate_2": 0.0, "lr": 0.0005209426958244731, "weight_decay": 1.1599849456459661e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Folder name: abc, Fold: 1
Training: 385, Validation: 48, Test: 49
Current LR: 0.0005209426958244731
epoch: 0 idx: 0 First Loss : 1.1660066843032837, Second Loss : 1.03431236743927
epoch: 0 idx: 200 First Loss : 1.0909683245109087, Second Loss : 1.0813241554285162
>>>>>>>>>>> Validation Epoch: 0
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7422334455667788
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7387878787878788
>>>>>>>>>>> Test Epoch: 0
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.718639770723104
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7148368606701941
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 1 idx: 0 First Loss : 1.5649064779281616, Second Loss : 1.7885117530822754
epoch: 1 idx: 200 First Loss : 0.9751588240339981, Second Loss : 0.9698446092024371
>>>>>>>>>>> Validation Epoch: 1
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7243546576879911
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7195959595959596
>>>>>>>>>>> Test Epoch: 1
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7344637958063883
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.734457671957672
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 2 idx: 0 First Loss : 1.9421615600585938, Second Loss : 2.3002724647521973
epoch: 2 idx: 200 First Loss : 0.9406562215134279, Second Loss : 0.9407850570828464
>>>>>>>>>>> Validation Epoch: 2
  First-Tier acc 0.625, precision 0.4019067075246851, recall 0.5583838383838384, F1 0.4641537324464154, AUC 0.6972783389450056
  Second-Tier acc 0.625, precision 0.40227703984819735, recall 0.5527272727272727, F1 0.46428571428571425, AUC 0.7116666666666666
>>>>>>>>>>> Test Epoch: 2
  First-Tier acc 0.5714285714285714, precision 0.36321839080459767, recall 0.43738977072310403, F1 0.3949579831932773, AUC 0.6981861160101901
  Second-Tier acc 0.5510204081632653, precision 0.3531746031746032, recall 0.42504409171075835, F1 0.3826839826839827, AUC 0.6983575837742504
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 3 idx: 0 First Loss : 2.365462064743042, Second Loss : 2.817009210586548
epoch: 3 idx: 200 First Loss : 0.9183004399974696, Second Loss : 0.921386369425266
>>>>>>>>>>> Validation Epoch: 3
  First-Tier acc 0.3958333333333333, precision 0.36321248453706345, recall 0.4343434343434343, F1 0.30335142586370295, AUC 0.7040572390572392
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7154545454545455
>>>>>>>>>>> Test Epoch: 3
  First-Tier acc 0.46938775510204084, precision 0.4083333333333334, recall 0.42915931804820695, F1 0.3426630840423944, AUC 0.6941872427983539
  Second-Tier acc 0.5102040816326531, precision 0.40653594771241836, recall 0.4462081128747795, F1 0.373015873015873, AUC 0.7062389770723104
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 4 idx: 0 First Loss : 2.750659227371216, Second Loss : 3.157829761505127
epoch: 4 idx: 200 First Loss : 0.8953123037420695, Second Loss : 0.9031124063883329
>>>>>>>>>>> Validation Epoch: 4
  First-Tier acc 0.3819444444444444, precision 0.3752716210343329, recall 0.43111111111111117, F1 0.2909098856905558, AUC 0.7167059483726149
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.719040404040404
>>>>>>>>>>> Test Epoch: 4
  First-Tier acc 0.48299319727891155, precision 0.4519774011299435, recall 0.45267489711934156, F1 0.35075757575757577, AUC 0.7138570448755633
  Second-Tier acc 0.5510204081632653, precision 0.46296296296296297, recall 0.49382716049382713, F1 0.4033333333333333, AUC 0.7491181657848324
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 5 idx: 0 First Loss : 3.02276349067688, Second Loss : 3.4239063262939453
epoch: 5 idx: 200 First Loss : 0.8953648589074203, Second Loss : 0.9032237861046002
>>>>>>>>>>> Validation Epoch: 5
  First-Tier acc 0.375, precision 0.37243697478991594, recall 0.4266666666666667, F1 0.2847368421052632, AUC 0.7035858585858584
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.7219191919191918
>>>>>>>>>>> Test Epoch: 5
  First-Tier acc 0.47619047619047616, precision 0.45098039215686275, recall 0.448559670781893, F1 0.34516686610823033, AUC 0.691260043111895
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.705026455026455
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 6 idx: 0 First Loss : 3.042717933654785, Second Loss : 3.4823741912841797
epoch: 6 idx: 200 First Loss : 0.8938732713192182, Second Loss : 0.9017461497621583
>>>>>>>>>>> Validation Epoch: 6
  First-Tier acc 0.375, precision 0.37243697478991594, recall 0.4266666666666667, F1 0.2847368421052632, AUC 0.6891806958473626
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.7277777777777777
>>>>>>>>>>> Test Epoch: 6
  First-Tier acc 0.46258503401360546, precision 0.4490358126721763, recall 0.44032921810699593, F1 0.33377291057469943, AUC 0.6733294140701549
  Second-Tier acc 0.5102040816326531, precision 0.456140350877193, recall 0.46913580246913583, F1 0.3724696356275303, AUC 0.6600529100529101
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 7 idx: 0 First Loss : 3.03045916557312, Second Loss : 3.478278875350952
epoch: 7 idx: 200 First Loss : 0.8972943669280028, Second Loss : 0.904588689750167
>>>>>>>>>>> Validation Epoch: 7
  First-Tier acc 0.3611111111111111, precision 0.3662714097496706, recall 0.4177777777777778, F1 0.272108843537415, AUC 0.6764365881032548
  Second-Tier acc 0.4166666666666667, precision 0.37182637182637185, recall 0.4533333333333333, F1 0.3194444444444444, AUC 0.6974242424242424
>>>>>>>>>>> Test Epoch: 7
  First-Tier acc 0.4557823129251701, precision 0.4362152998516635, recall 0.43621399176954734, F1 0.32754238097968386, AUC 0.6639354301391339
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.662147266313933
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 8 idx: 0 First Loss : 3.1880810260772705, Second Loss : 3.4982287883758545
epoch: 8 idx: 200 First Loss : 0.9001603859363225, Second Loss : 0.9081933593090198
>>>>>>>>>>> Validation Epoch: 8
  First-Tier acc 0.3263888888888889, precision 0.42049306625577815, recall 0.40518518518518515, F1 0.2629530474535406, AUC 0.6539169472502806
  Second-Tier acc 0.3541666666666667, precision 0.3797313797313797, recall 0.41333333333333333, F1 0.27166666666666667, AUC 0.6677777777777777
>>>>>>>>>>> Test Epoch: 8
  First-Tier acc 0.3877551020408163, precision 0.47564102564102567, recall 0.40483539094650206, F1 0.2891031382259452, AUC 0.6732069370958259
  Second-Tier acc 0.40816326530612246, precision 0.452991452991453, recall 0.40740740740740744, F1 0.29731275014293884, AUC 0.6754850088183422
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 9 idx: 0 First Loss : 3.538163423538208, Second Loss : 3.9722394943237305
epoch: 9 idx: 200 First Loss : 0.9207132351658578, Second Loss : 0.9220164041540212
>>>>>>>>>>> Validation Epoch: 9
  First-Tier acc 0.3888888888888889, precision 0.4104938271604938, recall 0.44037037037037036, F1 0.3146340332823437, AUC 0.6715881032547699
  Second-Tier acc 0.3958333333333333, precision 0.47685185185185186, recall 0.45444444444444443, F1 0.33910917687513437, AUC 0.6861616161616162
>>>>>>>>>>> Test Epoch: 9
  First-Tier acc 0.46938775510204084, precision 0.4979280797864869, recall 0.4503968253968254, F1 0.36370392292262665, AUC 0.6559254360180287
  Second-Tier acc 0.46938775510204084, precision 0.5672514619883041, recall 0.4737654320987654, F1 0.3924741924741925, AUC 0.6629739858906526
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 10 idx: 0 First Loss : 3.23193097114563, Second Loss : 3.5427448749542236
epoch: 10 idx: 200 First Loss : 0.9038652859371045, Second Loss : 0.9073424973249706
>>>>>>>>>>> Validation Epoch: 10
  First-Tier acc 0.3472222222222222, precision 0.4393518518518518, recall 0.42814814814814817, F1 0.2988855116514691, AUC 0.6709539842873177
  Second-Tier acc 0.3541666666666667, precision 0.4576023391812865, recall 0.42777777777777776, F1 0.298853412332675, AUC 0.6832828282828283
>>>>>>>>>>> Test Epoch: 10
  First-Tier acc 0.3945578231292517, precision 0.48484848484848486, recall 0.4072604350382128, F1 0.31700192038537905, AUC 0.6564337154614933
  Second-Tier acc 0.4489795918367347, precision 0.5185185185185185, recall 0.46141975308641975, F1 0.37154061624649865, AUC 0.6692019400352733
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 11 idx: 0 First Loss : 3.448678731918335, Second Loss : 3.61273455619812
epoch: 11 idx: 200 First Loss : 0.9031757895818238, Second Loss : 0.9028064686881316
>>>>>>>>>>> Validation Epoch: 11
  First-Tier acc 0.3263888888888889, precision 0.41339869281045755, recall 0.41962962962962963, F1 0.28243353070939275, AUC 0.6763973063973063
  Second-Tier acc 0.3541666666666667, precision 0.44354354354354353, recall 0.42777777777777776, F1 0.2995203457727177, AUC 0.6983838383838384
>>>>>>>>>>> Test Epoch: 11
  First-Tier acc 0.3877551020408163, precision 0.534074074074074, recall 0.45796590241034685, F1 0.34700278968496967, AUC 0.6663359788359788
  Second-Tier acc 0.46938775510204084, precision 0.5539215686274509, recall 0.5030864197530864, F1 0.4150326797385621, AUC 0.6704695767195767
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 12 idx: 0 First Loss : 3.6180286407470703, Second Loss : 3.6722681522369385
epoch: 12 idx: 200 First Loss : 0.8961081379261916, Second Loss : 0.8985469173334133
>>>>>>>>>>> Validation Epoch: 12
  First-Tier acc 0.4236111111111111, precision 0.36206299757701627, recall 0.4577777777777778, F1 0.3253110253110253, AUC 0.6782716049382715
  Second-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6877272727272726
>>>>>>>>>>> Test Epoch: 12
  First-Tier acc 0.48299319727891155, precision 0.3776088252832439, recall 0.43738977072310403, F1 0.35093533657386944, AUC 0.6690733392122281
  Second-Tier acc 0.5306122448979592, precision 0.41904761904761906, recall 0.48148148148148145, F1 0.3855981416957026, AUC 0.6716269841269842
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 13 idx: 0 First Loss : 4.328460216522217, Second Loss : 4.39567756652832
epoch: 13 idx: 200 First Loss : 0.8994063686825111, Second Loss : 0.9009913883222618
>>>>>>>>>>> Validation Epoch: 13
  First-Tier acc 0.3125, precision 0.4035353535353536, recall 0.4050841750841751, F1 0.26868820918997866, AUC 0.6507182940516273
  Second-Tier acc 0.2916666666666667, precision 0.33730158730158727, recall 0.37333333333333335, F1 0.20733029711559314, AUC 0.6476767676767677
>>>>>>>>>>> Test Epoch: 13
  First-Tier acc 0.35374149659863946, precision 0.5254125412541254, recall 0.43738977072310403, F1 0.3064665219837634, AUC 0.6559070644718793
  Second-Tier acc 0.3673469387755102, precision 0.5055555555555556, recall 0.41203703703703703, F1 0.28712522045855376, AUC 0.6709104938271605
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0)
Current LR: 0.0005209426958244731
epoch: 14 idx: 0 First Loss : 3.8209388256073, Second Loss : 3.92081880569458
epoch: 14 idx: 200 First Loss : 0.8822819171150853, Second Loss : 0.9058329878850387
>>>>>>>>>>> Validation Epoch: 14
  First-Tier acc 0.3055555555555556, precision 0.41973544973544974, recall 0.3997979797979798, F1 0.2672820549025145, AUC 0.6667340067340067
  Second-Tier acc 0.3125, precision 0.353968253968254, recall 0.38666666666666666, F1 0.22725366876310274, AUC 0.673030303030303
>>>>>>>>>>> Test Epoch: 14
  First-Tier acc 0.3469387755102041, precision 0.5248655913978495, recall 0.43540564373897706, F1 0.30708812260536394, AUC 0.6569542426023908
  Second-Tier acc 0.3673469387755102, precision 0.4393939393939394, recall 0.38271604938271603, F1 0.24694104560622918, AUC 0.6751543209876543
Test AUC: 0.7148, Test F1: 0.2368 (Best Epoch: 0){"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.2711180246715059, "droprate_2": 0.0, "lr": 0.0009099657660313166, "weight_decay": 0.0006724108649736007, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.017209325764649085, "droprate_2": 0.0, "lr": 0.0005897463618594796, "weight_decay": 0.0001033453250292854, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": false, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.047087770194114704, "droprate_2": 0.0, "lr": 1.1778107885858889e-05, "weight_decay": 6.019171601418278e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv\\splits.csv"}{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.2563307847156822, "droprate_2": 0.0, "lr": 1.73696440218802e-05, "weight_decay": 1.185107821206216e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 3, "total_instance": 4, "numGroup_test": 3, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.28921908908475663, "droprate_2": 0.0, "lr": 2.3531574922195604e-05, "weight_decay": 0.00011506142319473924, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1195437908172607, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.1025864318087326, Second Loss : 1.0984409215734965
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7206123737373739
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7176262626262626
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6445863646384481
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6387235449735449
epoch: 1 idx: 0 First Loss : 1.9979803562164307, Second Loss : 2.012242078781128
epoch: 1 idx: 200 First Loss : 1.0877458140328156, Second Loss : 1.0892919124803733
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7399431818181817
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7481818181818182
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6884266148589065
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.685626102292769
epoch: 2 idx: 0 First Loss : 2.101787805557251, Second Loss : 2.108323812484741
epoch: 2 idx: 200 First Loss : 1.0563881282337861, Second Loss : 1.063438531697093
  First-Tier acc 0.5416666666666666, precision 0.5106382978723404, recall 0.3636363636363636, F1 0.28703703703703703, AUC 0.7408743686868687
  Second-Tier acc 0.5208333333333334, precision 0.1773049645390071, recall 0.3333333333333333, F1 0.23148148148148148, AUC 0.7507575757575756
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7017505787037037
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7027116402116401
epoch: 3 idx: 0 First Loss : 2.2461094856262207, Second Loss : 2.269927501678467
epoch: 3 idx: 200 First Loss : 1.0280615886052449, Second Loss : 1.039509498546669
  First-Tier acc 0.5989583333333334, precision 0.3944508374888122, recall 0.46393939393939393, F1 0.41256418000604045, AUC 0.7369097222222222
  Second-Tier acc 0.6041666666666666, precision 0.6222222222222222, recall 0.46393939393939393, F1 0.4590390002154708, AUC 0.7481818181818181
  First-Tier acc 0.6122448979591837, precision 0.6253997940044452, recall 0.4490740740740741, F1 0.4416638579934839, AUC 0.6882027116402116
  Second-Tier acc 0.6326530612244898, precision 0.787878787878788, recall 0.48214285714285715, F1 0.46463223787167446, AUC 0.6951609347442681
epoch: 4 idx: 0 First Loss : 2.428341865539551, Second Loss : 2.4631056785583496
epoch: 4 idx: 200 First Loss : 0.9985023791443056, Second Loss : 1.0110779217448993
  First-Tier acc 0.65625, precision 0.6183311814890762, recall 0.6039646464646465, F1 0.5784335996917948, AUC 0.7382638888888889
  Second-Tier acc 0.6875, precision 0.6576354679802955, recall 0.6115151515151515, F1 0.6234567901234568, AUC 0.7471717171717173
  First-Tier acc 0.6020408163265306, precision 0.5728149845796905, recall 0.5849867724867724, F1 0.5777098718275189, AUC 0.6869281856261024
  Second-Tier acc 0.4897959183673469, precision 0.4123931623931624, recall 0.4658289241622575, F1 0.419370074825366, AUC 0.6906966490299823
epoch: 5 idx: 0 First Loss : 2.6456496715545654, Second Loss : 2.707988739013672
epoch: 5 idx: 200 First Loss : 0.9733168092458996, Second Loss : 0.9845447994546214
  First-Tier acc 0.578125, precision 0.5541125541125541, recall 0.5731060606060606, F1 0.5521367792903701, AUC 0.7452809343434343
  Second-Tier acc 0.5833333333333334, precision 0.5543859649122806, recall 0.5567676767676768, F1 0.5414513801610575, AUC 0.7588383838383838
  First-Tier acc 0.5459183673469388, precision 0.5283355775422984, recall 0.5790895061728395, F1 0.5314610114904883, AUC 0.6998904596560847
  Second-Tier acc 0.5306122448979592, precision 0.49682539682539684, recall 0.5249118165784833, F1 0.4909255098894321, AUC 0.7059634038800705
epoch: 6 idx: 0 First Loss : 2.849104404449463, Second Loss : 2.9376060962677
epoch: 6 idx: 200 First Loss : 0.9539910865882736, Second Loss : 0.9629668371927975
  First-Tier acc 0.5416666666666666, precision 0.5715223201291313, recall 0.5810101010101011, F1 0.5375573190338717, AUC 0.7549589646464647
  Second-Tier acc 0.5416666666666666, precision 0.5761183261183261, recall 0.575959595959596, F1 0.5276099629040806, AUC 0.7694444444444445
  First-Tier acc 0.5, precision 0.5119233900254944, recall 0.5618386243386243, F1 0.488973374369138, AUC 0.7107377094356261
  Second-Tier acc 0.4897959183673469, precision 0.48366013071895425, recall 0.5295414462081128, F1 0.4719122257053292, AUC 0.7259700176366843
epoch: 7 idx: 0 First Loss : 3.0161027908325195, Second Loss : 3.110915184020996
epoch: 7 idx: 200 First Loss : 0.9417944313884152, Second Loss : 0.9489058868968813
  First-Tier acc 0.4895833333333333, precision 0.549712238665727, recall 0.5421717171717172, F1 0.48733604703753963, AUC 0.7600378787878789
  Second-Tier acc 0.5208333333333334, precision 0.5670054583098061, recall 0.5626262626262627, F1 0.508994708994709, AUC 0.7901010101010101
  First-Tier acc 0.45918367346938777, precision 0.4941130923914281, recall 0.537147266313933, F1 0.45421544983435275, AUC 0.7219776510141093
  Second-Tier acc 0.46938775510204084, precision 0.489573607220666, recall 0.5465167548500882, F1 0.4658758498254958, AUC 0.7334656084656085
epoch: 8 idx: 0 First Loss : 3.1309986114501953, Second Loss : 3.267575263977051
epoch: 8 idx: 200 First Loss : 0.9346802888660511, Second Loss : 0.939116319456133
  First-Tier acc 0.453125, precision 0.5316007869199358, recall 0.5188383838383839, F1 0.4528804891152807, AUC 0.7658964646464647
  Second-Tier acc 0.5, precision 0.5556818181818182, recall 0.5492929292929293, F1 0.4909637929245772, AUC 0.8128787878787879
  First-Tier acc 0.46938775510204084, precision 0.5182840403179787, recall 0.5608465608465608, F1 0.46584761843501754, AUC 0.7280023699294533
  Second-Tier acc 0.4897959183673469, precision 0.5130012531328321, recall 0.5703262786596119, F1 0.49451835427445184, AUC 0.7377645502645502
epoch: 9 idx: 0 First Loss : 3.2109270095825195, Second Loss : 3.3872344493865967
epoch: 9 idx: 200 First Loss : 0.9299940330333155, Second Loss : 0.9318108298208806
  First-Tier acc 0.4427083333333333, precision 0.5247389745987222, recall 0.5128030303030303, F1 0.44285070915483676, AUC 0.7675000000000001
  Second-Tier acc 0.5, precision 0.5631578947368421, recall 0.5518181818181818, F1 0.498310291858679, AUC 0.8184343434343434
  First-Tier acc 0.4642857142857143, precision 0.5212266301869585, recall 0.5634920634920635, F1 0.4636458472177336, AUC 0.7279644786155203
  Second-Tier acc 0.5102040816326531, precision 0.5505952380952381, recall 0.605599647266314, F1 0.5177655677655677, AUC 0.7366622574955909{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.12727726238512302, "droprate_2": 0.0, "lr": 0.000308007757613255, "weight_decay": 1.529257073818656e-05, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 15, "gamma": 0.4007099826415689, "T_max": 12, "patience": 2, "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0794990062713623, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0729042784639853, Second Loss : 1.0752898591074778
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7374021464646464
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486868686868687
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7281229332010583
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7261904761904763
epoch: 1 idx: 0 First Loss : 1.676791787147522, Second Loss : 1.7558743953704834
epoch: 1 idx: 200 First Loss : 0.9780404592183098, Second Loss : 0.9759282735153217
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7242487373737374
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7364141414141415
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.721421337632275
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7174823633156966
epoch: 2 idx: 0 First Loss : 2.133049964904785, Second Loss : 2.188530921936035
epoch: 2 idx: 200 First Loss : 0.9482824629663829, Second Loss : 0.9473464580910715
  First-Tier acc 0.609375, precision 0.3843672456575682, recall 0.5172727272727272, F1 0.44085315832649713, AUC 0.6984532828282829
  Second-Tier acc 0.625, precision 0.3985347985347985, recall 0.5187878787878788, F1 0.45, AUC 0.7151515151515152
  First-Tier acc 0.5663265306122449, precision 0.3442890442890443, recall 0.4113756613756614, F1 0.3748450199752032, AUC 0.683790095899471
  Second-Tier acc 0.5714285714285714, precision 0.3625730994152046, recall 0.43738977072310403, F1 0.39553429027113235, AUC 0.6801146384479718
epoch: 3 idx: 0 First Loss : 3.204139232635498, Second Loss : 3.061750650405884
epoch: 3 idx: 200 First Loss : 0.9386760816163388, Second Loss : 0.9349718615598049
  First-Tier acc 0.4583333333333333, precision 0.5308793720619313, recall 0.47088383838383835, F1 0.3623959269242288, AUC 0.6908049242424242
  Second-Tier acc 0.4583333333333333, precision 0.3541666666666667, recall 0.46303030303030307, F1 0.3501607109094347, AUC 0.7262626262626263
  First-Tier acc 0.47959183673469385, precision 0.3641109552750506, recall 0.4104938271604938, F1 0.35141242937853107, AUC 0.6739762455908288
  Second-Tier acc 0.5102040816326531, precision 0.37753882915173237, recall 0.4347442680776014, F1 0.3703703703703704, AUC 0.6922949735449735
epoch: 4 idx: 0 First Loss : 3.6058030128479004, Second Loss : 3.654890298843384
epoch: 4 idx: 200 First Loss : 0.926744107942361, Second Loss : 0.918792564623447
  First-Tier acc 0.40625, precision 0.7115894039735099, recall 0.44603535353535356, F1 0.3225187510901797, AUC 0.7418718434343434
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7610606060606061
  First-Tier acc 0.47959183673469385, precision 0.4214649432040736, recall 0.43915343915343913, F1 0.3517528223410576, AUC 0.6970382771164022
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.7280092592592592
epoch: 5 idx: 0 First Loss : 3.694549560546875, Second Loss : 3.7655179500579834
epoch: 5 idx: 200 First Loss : 0.9235904341568216, Second Loss : 0.9211399402418429
  First-Tier acc 0.3854166666666667, precision 0.3795101553166069, recall 0.42909090909090913, F1 0.296014385653759, AUC 0.7053724747474748
  Second-Tier acc 0.4583333333333333, precision 0.40740740740740744, recall 0.48, F1 0.35422656699252447, AUC 0.7471212121212121
  First-Tier acc 0.4846938775510204, precision 0.42902711323763953, recall 0.44797178130511467, F1 0.3529014844804319, AUC 0.6832389495149912
  Second-Tier acc 0.5102040816326531, precision 0.3920454545454546, recall 0.4462081128747795, F1 0.371763153554346, AUC 0.7159391534391535
epoch: 6 idx: 0 First Loss : 3.636037826538086, Second Loss : 3.727045774459839
epoch: 6 idx: 200 First Loss : 0.9181017631714682, Second Loss : 0.9113564288697729
  First-Tier acc 0.375, precision 0.38390985324947585, recall 0.4266666666666667, F1 0.28591332039607903, AUC 0.6873169191919192
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7164141414141415
  First-Tier acc 0.45918367346938777, precision 0.43208813909450855, recall 0.43540564373897706, F1 0.33306351519076144, AUC 0.6766596395502645
  Second-Tier acc 0.5510204081632653, precision 0.4428571428571429, recall 0.49382716049382713, F1 0.40185830429732866, AUC 0.6902557319223986
epoch: 7 idx: 0 First Loss : 3.6376051902770996, Second Loss : 3.7541160583496094
epoch: 7 idx: 200 First Loss : 0.9116369558133959, Second Loss : 0.9072838130132503
  First-Tier acc 0.375, precision 0.3833333333333333, recall 0.4266666666666667, F1 0.28520499108734404, AUC 0.6768150252525252
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7044444444444444
  First-Tier acc 0.4387755102040816, precision 0.43710007256415334, recall 0.4259259259259259, F1 0.31435673379104934, AUC 0.6804143242945325
  Second-Tier acc 0.5102040816326531, precision 0.4316816816816817, recall 0.46913580246913583, F1 0.37104072398190047, AUC 0.7099316578483247
epoch: 8 idx: 0 First Loss : 3.5934605598449707, Second Loss : 3.7616329193115234
epoch: 8 idx: 200 First Loss : 0.9146898825414275, Second Loss : 0.9053821326065484
  First-Tier acc 0.3645833333333333, precision 0.37942386831275715, recall 0.42, F1 0.2757281553398058, AUC 0.6701799242424243
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.696868686868687
  First-Tier acc 0.42857142857142855, precision 0.4336155275655586, recall 0.4197530864197531, F1 0.303667092184653, AUC 0.6840071097883597
  Second-Tier acc 0.46938775510204084, precision 0.41965811965811967, recall 0.4444444444444444, F1 0.3382627910929798, AUC 0.7312059082892417
epoch: 9 idx: 0 First Loss : 3.6105170249938965, Second Loss : 3.704392194747925
epoch: 9 idx: 200 First Loss : 0.9053588863024928, Second Loss : 0.8893490610635534
  First-Tier acc 0.4010416666666667, precision 0.456300776848722, recall 0.4505555555555556, F1 0.3300712547218643, AUC 0.6786395202020202
  Second-Tier acc 0.4166666666666667, precision 0.3964912280701755, recall 0.4533333333333333, F1 0.32108843537414966, AUC 0.6742424242424242
  First-Tier acc 0.47959183673469385, precision 0.5327101310322786, recall 0.4595458553791887, F1 0.3809689614567664, AUC 0.6904693011463845
  Second-Tier acc 0.46938775510204084, precision 0.45, recall 0.4444444444444444, F1 0.3395061728395062, AUC 0.730489417989418{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.2779574533214013, "droprate_2": 0.0, "lr": 8.611050604571003e-05, "weight_decay": 6.871750228766917e-06, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.1081703901290894, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.111891988349791, Second Loss : 1.107441860348431
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7467550505050505
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7455050505050504
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7038242669753085
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6984126984126983
epoch: 1 idx: 0 First Loss : 1.855915904045105, Second Loss : 1.9917819499969482
epoch: 1 idx: 200 First Loss : 1.0044676172940885, Second Loss : 1.0131064392440947
  First-Tier acc 0.5729166666666666, precision 0.3782834331337326, recall 0.42606060606060603, F1 0.374966075014927, AUC 0.7343150252525253
  Second-Tier acc 0.5833333333333334, precision 0.3855981416957026, recall 0.4412121212121212, F1 0.39057239057239057, AUC 0.7452020202020201
  First-Tier acc 0.5867346938775511, precision 0.6784217877094972, recall 0.38233024691358025, F1 0.33356503478454697, AUC 0.6876033399470899
  Second-Tier acc 0.5714285714285714, precision 0.2833333333333333, recall 0.35714285714285715, F1 0.28703703703703703, AUC 0.6980820105820106
epoch: 2 idx: 0 First Loss : 2.412524938583374, Second Loss : 2.508772373199463
epoch: 2 idx: 200 First Loss : 0.9534704362723365, Second Loss : 0.9672739366393778
  First-Tier acc 0.5989583333333334, precision 0.5675213675213676, recall 0.5709090909090909, F1 0.5390087239957818, AUC 0.7360858585858585
  Second-Tier acc 0.625, precision 0.4119558154645874, recall 0.5357575757575758, F1 0.4598290598290598, AUC 0.7343434343434344
  First-Tier acc 0.5918367346938775, precision 0.5770535241123477, recall 0.6049382716049383, F1 0.5834320119068935, AUC 0.6902212852733687
  Second-Tier acc 0.5918367346938775, precision 0.6023391812865496, recall 0.5784832451499118, F1 0.5814446990917579, AUC 0.6995701058201059
epoch: 3 idx: 0 First Loss : 3.0123138427734375, Second Loss : 3.1078593730926514
epoch: 3 idx: 200 First Loss : 0.9278331950529298, Second Loss : 0.9362964836963966
  First-Tier acc 0.5520833333333334, precision 0.5765401290582779, recall 0.5806313131313131, F1 0.5408181525961221, AUC 0.7490151515151515
  Second-Tier acc 0.5208333333333334, precision 0.40625, recall 0.52, F1 0.398184912081679, AUC 0.7713636363636364
  First-Tier acc 0.5153061224489796, precision 0.5266761220040285, recall 0.5618386243386243, F1 0.5116565861401589, AUC 0.7124738205467374
  Second-Tier acc 0.5306122448979592, precision 0.7148148148148148, recall 0.47641093474426804, F1 0.4481481481481482, AUC 0.7231040564373897
epoch: 4 idx: 0 First Loss : 3.482017993927002, Second Loss : 3.560224771499634
epoch: 4 idx: 200 First Loss : 0.9216855265505945, Second Loss : 0.9248636755628965
  First-Tier acc 0.4739583333333333, precision 0.5278745371242076, recall 0.5078787878787879, F1 0.44729985412423995, AUC 0.7616508838383839
  Second-Tier acc 0.4375, precision 0.38562091503267976, recall 0.4666666666666666, F1 0.34314314314314315, AUC 0.7909595959595959
  First-Tier acc 0.49489795918367346, precision 0.5264939309056956, recall 0.5239748677248678, F1 0.4806209877990026, AUC 0.7210131448412698
  Second-Tier acc 0.4897959183673469, precision 0.48333333333333334, recall 0.45171957671957674, F1 0.4133192389006343, AUC 0.7313712522045855
epoch: 5 idx: 0 First Loss : 3.7417304515838623, Second Loss : 3.8277440071105957
epoch: 5 idx: 200 First Loss : 0.919390289184744, Second Loss : 0.9242279765691923
  First-Tier acc 0.4270833333333333, precision 0.49087534260833365, recall 0.4821212121212121, F1 0.4052961839832705, AUC 0.7644570707070707
  Second-Tier acc 0.4166666666666667, precision 0.3990990990990991, recall 0.4533333333333333, F1 0.32420634920634916, AUC 0.7891919191919192
  First-Tier acc 0.47959183673469385, precision 0.5234640522875817, recall 0.5191798941798942, F1 0.46511536341444204, AUC 0.7203448798500882
  Second-Tier acc 0.4897959183673469, precision 0.5497835497835498, recall 0.4631834215167548, F1 0.4157412212419996, AUC 0.7428902116402116
epoch: 6 idx: 0 First Loss : 3.6528115272521973, Second Loss : 3.9287352561950684
epoch: 6 idx: 200 First Loss : 0.9140356234135801, Second Loss : 0.9207387008282601
  First-Tier acc 0.4375, precision 0.5001214742594052, recall 0.49366161616161613, F1 0.4108422826299745, AUC 0.7578898358585859
  Second-Tier acc 0.4375, precision 0.4777777777777778, recall 0.48111111111111104, F1 0.3773109243697479, AUC 0.7962626262626262
  First-Tier acc 0.4744897959183674, precision 0.5299425357210383, recall 0.49823633156966496, F1 0.4473239586662406, AUC 0.7085159005731922
  Second-Tier acc 0.5306122448979592, precision 0.5564102564102563, recall 0.564373897707231, F1 0.5148148148148148, AUC 0.7467482363315696
epoch: 7 idx: 0 First Loss : 3.806976795196533, Second Loss : 4.005072593688965
epoch: 7 idx: 200 First Loss : 0.9156101209943215, Second Loss : 0.9184023306637873
  First-Tier acc 0.4114583333333333, precision 0.47733965381024207, recall 0.46616161616161617, F1 0.378245574889813, AUC 0.7405902777777778
  Second-Tier acc 0.4166666666666667, precision 0.4708061002178649, recall 0.4677777777777778, F1 0.35904139433551197, AUC 0.7889393939393939
  First-Tier acc 0.4336734693877551, precision 0.5024765922091202, recall 0.44422398589065254, F1 0.39464657273646037, AUC 0.7000592482363315
  Second-Tier acc 0.5102040816326531, precision 0.5268199233716475, recall 0.5048500881834215, F1 0.4574140329954283, AUC 0.7668099647266313
epoch: 8 idx: 0 First Loss : 3.565251588821411, Second Loss : 3.950780153274536
epoch: 8 idx: 200 First Loss : 0.9109234565600234, Second Loss : 0.9110647611764829
  First-Tier acc 0.3958333333333333, precision 0.4666186186186186, recall 0.4610353535353535, F1 0.35786054066597056, AUC 0.7216761363636364
  Second-Tier acc 0.4166666666666667, precision 0.4562425328554361, recall 0.4677777777777778, F1 0.3647992530345472, AUC 0.7657575757575756
  First-Tier acc 0.4336734693877551, precision 0.48826154845306696, recall 0.4365630511463845, F1 0.37448976603906187, AUC 0.6956845238095237
  Second-Tier acc 0.5102040816326531, precision 0.5203703703703704, recall 0.5048500881834215, F1 0.4572302133277743, AUC 0.7768959435626103
epoch: 9 idx: 0 First Loss : 3.553691864013672, Second Loss : 4.033655166625977
epoch: 9 idx: 200 First Loss : 0.9106716163264152, Second Loss : 0.9111364602345269
  First-Tier acc 0.3802083333333333, precision 0.4521024784182679, recall 0.44742424242424245, F1 0.3401390788873689, AUC 0.6991635101010102
  Second-Tier acc 0.3958333333333333, precision 0.4484064785788924, recall 0.45444444444444443, F1 0.35373298199385156, AUC 0.7210606060606061
  First-Tier acc 0.42857142857142855, precision 0.49549192853769, recall 0.43634259259259256, F1 0.3694810765060448, AUC 0.6898768187830688
  Second-Tier acc 0.46938775510204084, precision 0.5364396654719236, recall 0.4801587301587302, F1 0.42287581699346405, AUC 0.7865961199294533{"name": "abc", "label_col": "Subtype", "isIHC": false, "k_start": -1, "k_end": -1, "isPar": true, "splits_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv", "dataset_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\IPD_Brain_available_features.csv", "num_cls": 3, "data_dir": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\features", "in_chn": 2048, "mDim": 384, "EPOCH": 10, "epoch_step": "[90]", "device": "cpu", "log_dir": "./results\\optuna_trial_9", "train_show_freq": 200, "droprate": 0.20079134164280166, "droprate_2": 0.0, "lr": 0.0004007944606953974, "weight_decay": 0.0007420635430102064, "lr_decay_ratio": 0.2, "batch_size": 1, "batch_size_v": 1, "num_workers": 4, "numGroup": 4, "total_instance": 4, "numGroup_test": 4, "total_instance_test": 4, "grad_clipping": 5, "isSaveModel": false, "debug_DATA_dir": "", "numLayer_Res": 1, "temperature": 1, "num_MeanInference": 1, "distill_type": "AFS", "scheduler": "StepLR", "step_size": 16, "gamma": 0.3406467176007235, "T_max": 2, "patience": 5, "disable_writer": true, "num": 0, "p_name": "optuna_trial_9", "fold_csv": "D:\\IPD\\IPD-Brain-main\\IPD-Brain-main\\datasets\\splits_available\\splits.csv"}
Training: 385, Validation: 48, Test: 49
epoch: 0 idx: 0 First Loss : 1.0927734375, Second Loss : 1.036810040473938
epoch: 0 idx: 200 First Loss : 1.0849727015590194, Second Loss : 1.0748920134125064
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7241603535353537
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7486363636363637
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.6526641038359788
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.683531746031746
epoch: 1 idx: 0 First Loss : 2.253749370574951, Second Loss : 2.332542896270752
epoch: 1 idx: 200 First Loss : 0.9864510239949867, Second Loss : 0.9780304092376386
  First-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7316982323232324
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7470707070707071
  First-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7215884038800705
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7240410052910052
epoch: 2 idx: 0 First Loss : 2.6820602416992188, Second Loss : 3.08219838142395
epoch: 2 idx: 200 First Loss : 0.9581395040697126, Second Loss : 0.9651033618112108
  First-Tier acc 0.5520833333333334, precision 0.5125448028673835, recall 0.37878787878787873, F1 0.3131002331002331, AUC 0.7190183080808081
  Second-Tier acc 0.5208333333333334, precision 0.17361111111111113, recall 0.3333333333333333, F1 0.228310502283105, AUC 0.7233838383838384
  First-Tier acc 0.5510204081632653, precision 0.18461538461538463, recall 0.3333333333333333, F1 0.2376237623762376, AUC 0.7596106150793651
  Second-Tier acc 0.5510204081632653, precision 0.18367346938775508, recall 0.3333333333333333, F1 0.23684210526315788, AUC 0.7608575837742504
epoch: 3 idx: 0 First Loss : 2.7081644535064697, Second Loss : 2.699683666229248
epoch: 3 idx: 200 First Loss : 0.9386460768865116, Second Loss : 0.9242861669566205
  First-Tier acc 0.5885416666666666, precision 0.4323116219667944, recall 0.4318181818181818, F1 0.3830939486696492, AUC 0.7251104797979798
  Second-Tier acc 0.5833333333333334, precision 0.3937984496124031, recall 0.42424242424242425, F1 0.3700980392156863, AUC 0.7297474747474748
  First-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7566757605820106
  Second-Tier acc 0.5510204081632653, precision 0.1914893617021277, recall 0.3333333333333333, F1 0.24324324324324323, AUC 0.7611331569664902
epoch: 4 idx: 0 First Loss : 3.1508450508117676, Second Loss : 3.034531354904175
epoch: 4 idx: 200 First Loss : 0.9161462601255718, Second Loss : 0.9093381653618605
  First-Tier acc 0.6354166666666666, precision 0.4090169992609017, recall 0.5678787878787879, F1 0.4677248677248677, AUC 0.7142329545454545
  Second-Tier acc 0.6666666666666666, precision 0.7542483660130719, recall 0.5938383838383838, F1 0.5322344322344322, AUC 0.7186868686868687
  First-Tier acc 0.5918367346938775, precision 0.3804981452040275, recall 0.4583333333333333, F1 0.4120599760354933, AUC 0.7215367339065256
  Second-Tier acc 0.5714285714285714, precision 0.38674780256930363, recall 0.43738977072310403, F1 0.4101382488479263, AUC 0.7247574955908288
epoch: 5 idx: 0 First Loss : 3.435391902923584, Second Loss : 3.1280438899993896
epoch: 5 idx: 200 First Loss : 0.9095452658609667, Second Loss : 0.89774460372844
  First-Tier acc 0.4166666666666667, precision 0.3712527297994838, recall 0.4448484848484848, F1 0.32088440278779135, AUC 0.7015183080808081
  Second-Tier acc 0.4583333333333333, precision 0.3541666666666667, recall 0.46303030303030307, F1 0.3501607109094347, AUC 0.7203535353535354
  First-Tier acc 0.5, precision 0.4201938246562993, recall 0.4514991181657848, F1 0.36534309584154695, AUC 0.7295938051146384
  Second-Tier acc 0.5306122448979592, precision 0.3995098039215686, recall 0.4585537918871252, F1 0.38603425559947296, AUC 0.7195216049382717
epoch: 6 idx: 0 First Loss : 3.5952963829040527, Second Loss : 3.3631763458251953
epoch: 6 idx: 200 First Loss : 0.9091138256753132, Second Loss : 0.897936901471471
  First-Tier acc 0.4166666666666667, precision 0.37714987714987713, recall 0.44909090909090904, F1 0.32060185185185186, AUC 0.6984690656565657
  Second-Tier acc 0.4583333333333333, precision 0.36767676767676766, recall 0.46303030303030307, F1 0.3515151515151515, AUC 0.7194949494949494
  First-Tier acc 0.5102040816326531, precision 0.76828231292517, recall 0.470734126984127, F1 0.389849613987545, AUC 0.7254498732363316
  Second-Tier acc 0.5714285714285714, precision 0.42953431372549017, recall 0.4947089947089947, F1 0.4156785243741765, AUC 0.7189153439153438
epoch: 7 idx: 0 First Loss : 3.685032367706299, Second Loss : 3.8028981685638428
epoch: 7 idx: 200 First Loss : 0.9128343214128, Second Loss : 0.8934570213001388
  First-Tier acc 0.4322916666666667, precision 0.4417177019539224, recall 0.46568181818181814, F1 0.36786709844252274, AUC 0.682114898989899
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7131313131313132
  First-Tier acc 0.5, precision 0.5068692121270483, recall 0.4779541446208113, F1 0.42024543533977493, AUC 0.7182505235890653
  Second-Tier acc 0.5714285714285714, precision 0.42953431372549017, recall 0.4947089947089947, F1 0.4156785243741765, AUC 0.7373787477954145
epoch: 8 idx: 0 First Loss : 3.3277790546417236, Second Loss : 3.353621006011963
epoch: 8 idx: 200 First Loss : 0.9039387553866572, Second Loss : 0.8927630461064348
  First-Tier acc 0.4166666666666667, precision 0.44385560675883257, recall 0.4592929292929293, F1 0.3636591478696742, AUC 0.6760669191919192
  Second-Tier acc 0.4583333333333333, precision 0.38681318681318677, recall 0.48, F1 0.3524027459954233, AUC 0.7166666666666668
  First-Tier acc 0.47959183673469385, precision 0.5291084187635912, recall 0.49046516754850095, F1 0.42380220078573444, AUC 0.714940200617284
  Second-Tier acc 0.5714285714285714, precision 0.44836601307189544, recall 0.5061728395061729, F1 0.4166666666666667, AUC 0.7311507936507936
epoch: 9 idx: 0 First Loss : 3.443756103515625, Second Loss : 3.533832550048828
epoch: 9 idx: 200 First Loss : 0.9063493651789682, Second Loss : 0.8889089605721195
  First-Tier acc 0.3697916666666667, precision 0.4022487356999067, recall 0.4269444444444444, F1 0.29728349712279, AUC 0.6662752525252525
  Second-Tier acc 0.4375, precision 0.4021294021294021, recall 0.4666666666666666, F1 0.33796296296296297, AUC 0.7033333333333333
  First-Tier acc 0.44387755102040816, precision 0.49053571428571424, recall 0.4379409171075838, F1 0.35136183641882246, AUC 0.7113508597883597
  Second-Tier acc 0.4897959183673469, precision 0.4258373205741626, recall 0.4567901234567901, F1 0.3549257759784075, AUC 0.7284501763668431